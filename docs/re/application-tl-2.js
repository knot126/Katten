if(typeof(console)==="undefined"){console={log:(typeof __underscore_SysLog=="function")?__underscore_SysLog:function(a){}}}function NgAssertError(a){this.why=a;if(Error&&Error.captureStackTrace){Error.captureStackTrace(this,NgAssertError);console.log(a+"\n"+this.stack)}}var assert=typeof assert!=="undefined"?assert:function(a,b){if(!a){throw new NgAssertError(b?b:"Assertion Failed")}};var __ngs=typeof __ngs!=="undefined"?__ngs:{};__ngs.r_=function(a){if(!a._c){if(!a.hasOwnProperty("_c")||!a.hasOwnProperty("_d")){console.log('bad module object, missing _c or _d; got "'+JSON.stringify(a)+'"')}a._d()}return a._c.exports};var require=function(b){if(typeof(b)!=="string"){b=""+b}var a=__ngs[b];if(!a.hasOwnProperty("_c")||!a.hasOwnProperty("_d")){console.log('bad require fallthrough, missing _c or _d; got "'+JSON.stringify(a)+'"');return undefined}return __ngs.r_(a)};__ngs._d6={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var e=__ngs.r_(__ngs._6k).MobageStyle;var a=e.ScaledCorners;var f=e.ScaledTextSize;var b=new (__ngs.r_(__ngs._f).RequireLoader)({CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements}});e.lazyLoad(c,"FullScreenEditorStyle",function(){return{extras:{headerHeightRatio:0.11,cancelWidthRatio:0.2,fieldHeightRatio:0.2,actionHeightRatio:0.17,actionWidthRatio:0.3,insetRatio:0.01},style:{gradient:{gradient:["FF1E4871 0.00","FF143558 0.50"],innerLine:"4484C3E9 2.0"}},children:{title:{style:{textFont:e.defaultRegularFontFace,textSize:f(14),textColor:"FFFFFFFF",textGravity:[0,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}},charCounter:{style:{textFont:e.defaultRegularFontFace,textSize:f(14),textColor:"FFFFFFFF",textGravity:[1,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}},field:b.CommonElements.textBox,cancelButton:{style:{gradient:{corners:a(8),gradient:["FF5AB0E2 0.000","FF2B76BC 1.000"],innerLine:"4484C3E9 2.0"},pressedGradient:{corners:a(8),gradient:["FF3682C3 0.000","FF1C61A8 1.000"],innerLine:"2B003366 2.0"},textFont:e.defaultRegularFontFace,textSize:f(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}},actionButton:{style:{gradient:{corners:a(8),gradient:["FF5AB0E2 0.000","FF2B76BC 1.000"],innerLine:"4484C3E9 2.0"},pressedGradient:{corners:a(8),gradient:["FF3682C3 0.000","FF1C61A8 1.000"],innerLine:"2B003366 2.0"},textFont:e.defaultBoldFontFace,textSize:f(18),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}}}}})}};__ngs._d7={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var f=__ngs.r_(__ngs._59).UI;var c=f.ViewGeometry.Rect;var a=b.GridPanelListViewCell=f.View.subclass({classname:"GridPanelListViewCell",initialize:function($super,g){$super(g);this._entryViews=[]},destroy:function(){for(var g=0;g<this._entryViews.length;g++){if(this._entryViews[g]){this._entryViews[g].release();this._entryViews[g]=null}}},setEntries:function(g){this._entries=g||[];this.layoutSubviews()},layoutSubviews:function(){this.loge("Implement in subclass!")},createEntryView:function(){this.loge("Implement in subclass!")},_entryViewForIndex:function(g){this._entryViews=this._entryViews||[];if(this._entryViews.length<=g){var j=(this._entryViews.length-1);for(var h=0;h<(g-j);h++){this._entryViews.push(this.createEntryView().retain())}}if(!this._entryViews[g].getParent()){this._entryViews[g].cell=this;this.addChild(this._entryViews[g])}return this._entryViews[g]},_clearEntryViews:function(h){if(!this._entries){return}var j=0;if(!this._entries){this._entries=[]}if(h){j=this._entries.length}for(var g=j;g<this._entryViews.length;g++){this._entryViews[g].removeFromParent();this._entryViews[g].setEntry(null);this._entryViews[g].cell=null}},sizeChanged:function(){this.layoutSubviews()}});var e=b.GridPanelListViewItem=f.ListViewItem.subclass({classname:"GridPanelListViewItem",initialize:function(){this.setHeight(100)},setEntries:function(g){this._entries=g||[];if(this.cell){this.cell.setEntries(this._entries)}},_onCreateView:function(){return new a()},_onSetView:function(g){this.cell=g;if(!g){throw new Error("fbartho")}g.item=this;g.setState(f.State.Normal);g.setEntries(this._entries)},_onReleaseView:function(g){if(this.cell==g&&g){this.cell=null;g.item=null}}})}};__ngs._d8={_c:null,_d:function(){var f={exports:{}};var c=f.exports;this._c=f;var h=__ngs.r_(__ngs._5).Core;var g=__ngs.r_(__ngs._59).UI;var e=__ngs.r_(__ngs._2z).Assets;var b=__ngs.r_(__ngs._n).LocalizedString;var a=new (__ngs.r_(__ngs._f).RequireLoader)({UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},VerticalTabViewSizing:function(){return __ngs.r_(__ngs._9g).VerticalTabViewSizing},WallMenu:function(){return __ngs.r_(__ngs._d4).WallMenu}});c.WallCmdView=g.View.subclass({classname:"WallCmdView",_comandCoverView:null,_backgroundView:null,_deleteCmd:null,_commentCmd:null,_viewCmd:null,_reportCmd:null,_commandListBackground:null,_divider:null,_cmds:null,_frame:null,_buttonOffset:null,initialize:function(j,m,l){this._style=a.WallMenu;this._cmds=j;this._frame=m;this._buttonOffset=l;var k=this;this._comandCoverView=(new g.View()).retain();this._backgroundView=(new g.View()).retain();this._deleteCmd=(new d(b("Delete"),e.image("ListModal_Icon_Trash.png"),e.image("ListModal_Icon_Trash_downstate.png"),(function(){this.controller.deleteCmdOnClick()}).bind(this)).retain());this._commentCmd=(new d(b("Comment"),e.image("ListModal_Icon_Comment.png"),e.image("ListModal_Icon_Comment_downstate.png"),(function(){this.controller.commentCmdOnClick()}).bind(this)).retain());this._viewCmd=(new d(b("View"),e.image("ListModal_Icon_View.png"),e.image("ListModal_Icon_View.png"),(function(){this.controller.viewCmdOnClick()}).bind(this)).retain());this._reportCmd=(new d(b("Report"),e.image("ListModal_Icon_Report.png"),e.image("ListModal_Icon_Report_downstate.png"),(function(){this.controller.reportCmdOnClick()}).bind(this)).retain());this._commandListBackground=(new g.Image()).retain();this._divider=(new g.Image()).retain();if(this._cmds.length>3){this._commandListBackground.setImage(e.image("ListModal_Background.png"))}else{if(this._cmds.length>2){this._commandListBackground.setImage(e.image("ListModal_Background_Med.png"))}else{this._commandListBackground.setImage(e.image("ListModal_Background_Small.png"))}}this._divider.setImage(e.image("ListModal_Divider.png"));this._comandCoverView.onclick=this._backgroundView.onclick=(function(){this.controller.destroy()}).bind(this);this._backgroundView.addChild(this._commandListBackground);this._comandCoverView.addChild(this._backgroundView);g.Window.document.addChild(this._comandCoverView);this._style.applyTo(this)},layoutSubviews:function(){var l=g.Window.getWidth();var m=g.Window.getHeight();var k=this._style.extras.viewRatio;var v=this._frame[2]/k.backGroundAspectRatio;var o=(this._frame[1]+(this._frame[3]/2))-(v/2);var n=new g.ViewGeometry.Rect(l-(this._frame[2]+this._buttonOffset),o,this._frame[2],v);this._backgroundView.setFrame(n);this._commandListBackground.setFrame([0,0,this._frame[2],this._backgroundView.getFrame()[3]]);this._commandListBackground.setImageGravity([1,0.5]);var s=new g.ViewGeometry.Rect(0,0,l,m);this._comandCoverView.setFrame(s);var j=this._commandListBackground.getFrame();var t=j[2]/4;var p=j[3]*0.75;var u=t/2;var q=((j[3]-p)/2)+j[1];if(this._deleteCmd){this._deleteCmd.layoutSubviews();this._deleteCmd.setFrame(j[0]+u*0.5,q,t,p)}this._reportCmd.setFrame(j[0]+t,q,t,p);this._divider.setFrame(j[0]+t*1.5,q+p*0.125,t,p*0.75);this._viewCmd.setFrame(j[0]+t*2,q,t,p);this._commentCmd.setFrame(j[0]+t*3-u*0.5,q,t,p);this._reportCmd.layoutSubviews();this._viewCmd.layoutSubviews();this._commentCmd.layoutSubviews();this.createMenuButtons()},destroy:function(){if(this._comandCoverView){this._comandCoverView.release()}if(this._backgroundView){this._backgroundView.release()}if(this._deleteCmd){this._deleteCmd.release()}if(this._commentCmd){this._commentCmd.release()}if(this._viewCmd){this._viewCmd.release()}if(this._reportCmd){this._reportCmd.release()}if(this._commandListBackground){this._commandListBackground.release()}if(this._divider){this._divider.release()}},createMenuButtons:function(){var l=this._cmds;for(var k=0;k<l.length;k++){var o=l.length-k;var j=null;if(l[k]=="comment"){j=this._commentCmd}else{if(l[k]=="delete"){j=this._deleteCmd}else{if(l[k]=="report"){j=this._reportCmd}}}if(j){var m=j.getFrame();var n=this._frame[2]/4;m[0]=(this._backgroundView.getFrame()[2])-(n*o);m[1]=0;m[3]=this._backgroundView.getFrame()[3];j.setFrame(m);this._backgroundView.addChild(j)}}}});var d=g.View.subclass({classname:"CmdIcon",_icon:null,_text:"",initialize:function($super,m,j,k,l){$super();this._style=a.WallMenu;this._icon=(new a.UnspammableButton()).retain();this._text=(new g.Label()).retain();this._icon.setImageFit(g.ViewGeometry.FitModes.Stretch);this._icon.setImage(j);this._icon.setImage(k,g.State.Pressed);this.addChild(this._icon);this._text.setText(m);this._text.setTextGravity(g.ViewGeometry.Gravity.TopCenter);this.addChild(this._text);if((typeof l)=="function"){this._text.onclick=function(){l()};this._icon.onclick=function(){l()}}this._style.applyTo(this)},layoutSubviews:function(){var j=this._style.extras.viewRatio;this._friendsAreaHeight=h.Capabilities.getScreenWidth()*j.wallMenuAreaHFactor*3/4;this._contentWidth=this._getContentWidth();this._icon.setFrame([j.wallIconXFactor*this._contentWidth,j.wallIconYFactor*this._friendsAreaHeight,j.wallIconWFactor*this._friendsAreaHeight,j.wallIconHFactor*this._friendsAreaHeight]);this._text.setFrame([j.wallBalloonLabelXFactor*this._contentWidth,j.wallBalloonLabelYFactor*this._friendsAreaHeight,j.wallBalloonLabelWFactor*this._contentWidth,j.wallBalloonLabelHFactor*this._friendsAreaHeight])},destroy:function(){if(this._icon){this._icon.release();this._icon=null}if(this._text){this._text.release();this._text=null}},_getContentWidth:function(){var j=h.Capabilities.getScreenHeight();return(1-a.VerticalTabViewSizing.buttonContainerRatio-a.VerticalTabViewSizing.insetRatio)*j}})}};__ngs._cq={_c:null,_d:function(){var d={exports:{}};var g=d.exports;this._c=d;var e=__ngs.r_(__ngs._59).UI;var c=e.ViewGeometry.Rect;var b=new (__ngs.r_(__ngs._f).RequireLoader)({Assets:function(){return __ngs.r_(__ngs._2z).Assets},FullScreenEditorStyle:function(){return __ngs.r_(__ngs._d6).FullScreenEditorStyle}});var h=__ngs.r_(__ngs._9h);var a=h.Composite;var j=h.CompositeView;var f=__ngs.r_(__ngs._9i).Components;g.FullScreenEditorView=a({CompositeClass:j},{key:"title",component:f.Label},{key:"charCounter",component:f.Label},{key:"content",component:f.EditTextArea,altKey:"field"},{key:"cancelButton",component:f.Button},{key:"actionButton",component:f.Button},f.AddOrders.Generator("charCounter","title","cancelButton","field","actionButton"),{classname:"FullScreenEditorView",initialize:function($super,k){$super(k);this.actionButton.setOnClick(this.bind(function(){if(this.controller){this.controller._submitted()}}));this.cancelButton.setOnClick(this.bind(function(){if(this.controller){this.controller._canceled()}}));this.field.setOnChange(this.bind(function(){if(this.controller){this.controller._onTextChanged(this.field.getText())}}));b.FullScreenEditorStyle.applyTo(this);this.sizing=b.FullScreenEditorStyle.extras;return this},layoutSubviews:function(){var s=new c(this.getFrame());if(s.isEmpty()){return}var p=this.sizing.headerHeightRatio*s.h;var u=this.sizing.cancelWidthRatio*s.w;var o=this.sizing.fieldHeightRatio*s.h;var l=this.sizing.actionHeightRatio*s.h;var t=this.sizing.actionWidthRatio*s.w;var w=this.sizing.insetRatio*s.w;var n=s.sliceVertical(p);var k=n.sliceHorizontal(-u);n.inset(w,w,w/2,w*3/2);k.inset(w,w,w,w/2);var v=new c(n);var r=n.sliceHorizontal(-u);var q=s.sliceVertical(o);q.inset(w/2,w,w/2,w);var m=s.sliceVertical(l);m.inset(w,(m.w-t)/2,w,(m.w-t)/2);this.title.setFrame(v);this.charCounter.setFrame(r);this.cancelButton.setFrame(k);this.field.setFrame(q);this.actionButton.setFrame(m)}})}};__ngs._cr={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var d=__ngs.r_(__ngs._6k).MobageStyle;var a=d.ScaledCorners;var e=d.ScaledTextSize;d.lazyLoad(b,"TitleStyle",function(){return{style:{gradient:{gradient:["FF134a93 0.0","FF3372bb 1.0"],innerShadow:"FF00 1.0 {0,0}"},selectedGradient:{gradient:["FF6eb6e3 0.000","FF3371bb 1.000"]}},children:{content:{style:{textColor:"FFFFFFFF",textShadow:"FF00 2.0 {0,-1}",textGravity:[0,0.5],textInsets:[10,10,10,10],textSize:e(12)}}},extras:{widthRatio:0.075,insetRatio:0.2}}})}};__ngs._cs={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var f=__ngs.r_(__ngs._6k).MobageStyle;var d=__ngs.r_(__ngs._2z).Assets;var a=f.ScaledCorners;var g=f.ScaledTextSize;var b=new (__ngs.r_(__ngs._f).RequireLoader)({CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements},BalanceButtonProfileStyle:function(){return __ngs.r_(__ngs._86).ProfileStyle},LocText:function(){return __ngs.r_(__ngs._n).LocalizedString}});f.lazyLoad(c,"UserInfoStyle",function(){return{style:{gradient:{gradient:["FFFFFFFF 0.000","FFFFFFFF 1.000"],innerLine:"FFC9D1DA 1.0"}},children:{_labelGamerTag:{style:{textGravity:[0,1],textSize:g(18),textFont:f.defaultBoldFontFace}},_labelName:{style:{textGravity:[0,0],textSize:g(12),textFont:f.defaultRegularFontFace}},_mottoAreaImage:{style:{image:d.image("status_entry_area_gray.png"),imageFit:3}},_labelMotto:{style:{textSize:g(14),textFont:f.defaultRegularFontFace,textGravity:[0,0],disabledTextColor:"FFAAAAAA",disabledText:b.LocText("I haven't written anything yet"),disabledTextFont:f.defaultItalicFontFace,disabledTextSize:g(12)}},_staticAvatar:{style:{imageBorder:{corners:a(4),outerLine:"FFFFFFFF 3",innerLine:"FFB2B2B2 2"},image:d.image("no-user-icon.png")}},_mottoBtn:b.CommonElements.invisibleButton,_balanceButton:b.BalanceButtonProfileStyle,_addFriendButton:b.CommonElements.largeActionButton},extras:{avatarImageSpacerInsetRatio:1/40,avatarImageSizeFactor:7/17,gamertagHeightRatio:3/20,nameHeightRatio:1/10,mottoHeightRatio:5/10,gamertagLeftInsetRatio:1/25,nameLeftInsetRatio:1/25,mottoAreaRightInsetRatio:1/40,mottoInsetRatios:[1/40,1/40,1/60,1/25],balanceButtonInsetRatios:[1/10,1/8,1/10,1/8],addFriendButtonInsetRatios:[1/60,1/40,1/25,1/60]}}})}};__ngs._ct={_c:null,_d:function(){var c={exports:{}};var g=c.exports;this._c=c;var d=__ngs.r_(__ngs._59).UI;var f=__ngs.r_(__ngs._2z).Assets;var b=new (__ngs.r_(__ngs._f).RequireLoader)({FullScreenEditor:function(){return __ngs.r_(__ngs._by).FullScreenEditor},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements}});var k=__ngs.r_(__ngs._n).LocalizedString;var a=__ngs.r_(__ngs._9h).Composite;var m=__ngs.r_(__ngs._9i);var h=__ngs.r_(__ngs._bv).CCViewList;var e=m.Components;var j=a({key:"content",component:e.EditText,altKey:"field"},{key:"submitButton",component:e.UnspammableButton},e.AddOrders.Generator("content","submitButton"),e.Layouts.TwoHorizontalGenerator("content","submitButton"),{classname:"WallPostView",initialize:function($super){$super();this.submitButton.setText(k("Post"));this.content.setPlaceholder(k("Post a Reply"));this.content.setEnterKeyType(d.Commands.EnterKeyType.Done);b.CommonElements.textBox.applyTo(this.content);b.CommonElements.standardButton.applyTo(this.submitButton)}});var l=g.ConversationWallView=h.subclass({classname:"ConversationWallView",initialize:function($super,n){this._compositePrepare();this._compositeInits.footer=function(o){this[o]=(new j()).retain()};$super(n);this._cover=new d.Button().retain();this._postingEnabled=true;this.first=true;return this},destroy:function($super){if(this.fullScreenEditorFloat){this.fullScreenEditorFloat.release();this.submitButtonFloat.release()}if(this.editor){this.editor.release()}if(this._cover){this._cover.release()}$super()},layoutSubviews:function($super){var q=new (d.ViewGeometry.Rect)(this.getFrame());if(q.isEmpty()){return}var p=q.w*(1/9);this.footer.setFrameSize([q.w,p]);if(this.first){if(this.footer.content){this.footer.content.setFrameSize([q.w*(5/6),p])}else{NgLogE("ConversationWallView: footer.content does not exist")}if(this.footer.submitButton){this.footer.submitButton.setFrameSize([q.w*(1/6),p])}else{NgLogE("ConversationWallView: footer.submitButton does not exist")}this.first=false}this._cover.setFrameSize(this.footer.getFrameSize());$super();if(this.fullScreenEditorFloat&&this._postingEnabled){var o=new d.ViewGeometry.Rect(this.footer.getFrame());var r=new d.ViewGeometry.Rect(this.footer.submitButton.getFrame());var n=[o.x,o.y,o.w-r.w,o.h];var s=[n[0]+n[2],o.y,r.w,o.h];this.fullScreenEditorFloat.setFrame(n);this.submitButtonFloat.setFrame(s)}},setScrollPosition:function(n,o){this.content.setScrollPosition([n,o])},getHeaderHeight:function(){var n=this.header.getFrame();return n[3]},setPostingEnabled:function(n){if(this._postingEnabled!=n){if(!n){this.footer.addChild(this._cover)}else{this.footer.removeChild(this._cover)}}this._postingEnabled=n},setPostingDisabledOnClick:function(n){this._cover.onclick=n},useFullScreenEditor:function(n){if(!n&&this.fullScreenEditorFloat){this.fullScreenEditorFloat.removeFromParent();this.submitButtonFloat.removeFromParent()}else{if(!this.editor){this.editor=new b.FullScreenEditor();this.editor.setIsMultiline(false);this.editor.setMaxCharacters(90);this.editor.setup(k("Post a reply"),k("Post"),this._postCb,this._cancelCb);this.fullScreenEditorFloat=(new d.Button()).retain();this.footer.getParent().addChild(this.fullScreenEditorFloat);this.submitButtonFloat=(new d.Button()).retain();this.footer.getParent().addChild(this.submitButtonFloat);this.layoutSubviews();this.fullScreenEditorFloat.setOnClick(this.bind(function(){this.editor.show(this.footer.field.getText());this.footer.field.setEnabled(false)}));this.submitButtonFloat.setOnClick(this.bind(function(){if(this.footer.field.getText()===""){this.editor.show(this.footer.field.getText());this.footer.field.setEnabled(false)}else{this._postCb(this.footer.field.getText())}}))}}}})}};__ngs._cu={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var d=__ngs.r_(__ngs._6k).MobageStyle;var a=new (__ngs.r_(__ngs._f).RequireLoader)({CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements}});d.lazyLoad(b,"HorizontalButtonStyle",function(){return{style:{gradient:{insets:"{0,-2,0,-2}",gradient:["FFDD 0.0","FFF8 1.0"],outerLine:"FFCC 1.0"}},children:{standardButton:a.CommonElements.standardButton},extras:{insetRatios:[1/20,1/30,1/30,1/30],spacerRatio:1/30}}})}};__ngs._cv={_c:null,_d:function(){var c={exports:{}};var a=c.exports;this._c=c;var d=__ngs.r_(__ngs._d0).InteractiveListViewSection;var b=a.GridPanel=d.subclass({classname:"GridPanel",initialize:function($super,e){$super(e);this._entries=[];this._entriesPerRow=1;return this},getEntriesPerRow:function(){return this._entriesPerRow||1},setEntriesPerRow:function(e){if(this._entriesPerRow!=e){this._entriesPerRow=e;this._updateRows()}},getEntries:function(){return this._entries||[]},setEntries:function(e){this._entries=e||[];this._updateRows()},appendEntry:function(f){this._entries.push(f);var e=this._getRightSizedItemsArray();if(!e.length){return}var g=e.length-1;e[g].setEntries(this._entries.slice(g*this._entriesPerRow,(g+1)*this._entriesPerRow));this._mbItems=e;this.updateItems(true)},_updateRows:function(){var e=this._getRightSizedItemsArray();for(var f=0;f<e.length;f++){e[f].setEntries(this._entries.slice(f*this._entriesPerRow,(f+1)*this._entriesPerRow))}this._mbItems=e;this.updateItems(true)},_getRightSizedItemsArray:function(){var e=this.items.slice();var g=this._getNumRowsNeeded();var f=g-e.length;if(f>0){for(f;f>0;f--){e.push(this.createNewRowItem())}}else{if(f<0){e=e.slice(0,g)}}return e},_getNumRowsNeeded:function(){var e=Math.floor((this._entries.length/this._entriesPerRow)|0);var f=(this._entries.length%this._entriesPerRow)?1:0;return e+f},createNewRowItem:function(){return this.loge("Must implement in non-abstract subclass!")}})}};__ngs._cw={_c:null,_d:function(){var c={exports:{}};var f=c.exports;this._c=c;var e=__ngs.r_(__ngs._59).UI;var b=e.ViewGeometry.Rect;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Assets:function(){return __ngs.r_(__ngs._2z).Assets},FriendsGridPanelStyle:function(){return __ngs.r_(__ngs._cc).FriendsGridPanelCell}});var d=__ngs.r_(__ngs._d7);var j=d.GridPanelListViewCell;var k=d.GridPanelListViewItem;var l=__ngs.r_(__ngs._c2).LabeledUserIconButton;var m=l.subclass({classname:"FriendsGridEntryButton",setEntry:function(n){this._entry=n;this.setUser(n)}});var g=f.FriendsGridPanelCell=j.subclass({classname:"FriendsGridPanelCell",createEntryView:function(){var n=new m();n.setOnClick(function(){this.cell.item.entryClicked(this._entry)});return n},setEntries:function($super,n){for(var o=0;o<n.length;o++){this._entryViewForIndex(o).setEntry(n[o])}$super(n)},layoutSubviews:function(){var v=new b(this.getFrame());if(v.isEmpty()){return}v.x=v.y=0;var o=(this._entries||[]).length;var p=a.FriendsGridPanelStyle.numEntriesPerRow;var u=[];for(var r=0;r<4;r++){u.push(a.FriendsGridPanelStyle.insetRatios[r]*v.w)}v.inset.apply(v,u);var w=a.FriendsGridPanelStyle.spacerRatio*v.w;var t=((v.w-((p-1)*w))/p);var q=(v.w/o);for(r=0;r<o;r++){var s=v.sliceHorizontal(q);var x=(q-t)/2;s.inset(0,x,0,x);this._entryViewForIndex(r).setFrame(s)}this._clearEntryViews(true)}});var h=f.FriendsGridPanelItem=k.subclass({classname:"FriendsGridPanelItem",_reuseId:"friendsgridpanelitem",_onCreateView:function(){return new g()},entryClicked:function(n){console.log("Entry Clicked! ",n.gamertag)}})}};__ngs._cx={_c:null,_d:function(){var e={exports:{}};var j=e.exports;this._c=e;var g=__ngs.r_(__ngs._59).UI;var d=g.ViewGeometry.Rect;var c=new (__ngs.r_(__ngs._f).RequireLoader)({GridPanelHeaderStyle:function(){return __ngs.r_(__ngs._cc).GridPanelHeaderCell}});var m=__ngs.r_(__ngs._n).LocalizedString;var k=__ngs.r_(__ngs._9h);var b=k.Composite;var l=__ngs.r_(__ngs._ao).CompositeButton;var o=__ngs.r_(__ngs._9i);var h=o.Components;var f=h.Layouts.TwoHorizontalGenerator("content","button").layoutSubviews;var n=j.GridPanelHeaderCell=b({key:"content",altKey:"title",component:h.Label},{key:"button",component:h.Button},h.AddOrders.Generator("content","button"),{classname:"GridPanelHeaderCell",initialize:function($super){$super();c.GridPanelHeaderStyle.applyTo(this);return this},layoutSubviews:function(){var q=new d(this.getFrame());if(q.isEmpty()){return}q.x=q.y=0;var p=q.w*c.GridPanelHeaderStyle.extras.insetRatio;var r=q.w*c.GridPanelHeaderStyle.extras.buttonWidthRatio;this.setTitleInset([p,p/2,p,p]);this.setButtonInset([p,p,p,p/2]);if(this.button.getFrameSize()[0]!=r){this.button.setFrameSize([r,this.button.getFrameSize()[1]])}f.apply(this)}});var a=j.GridPanelHeaderItem=g.ListViewItem.subclass({classname:"GridPanelHeaderItem",_reuseId:"GridPanelHeaderItem",initialize:function($super,q,p){$super(a._reuseId);this._titleText=q;this._buttonText=m("View All");this._buttonClick=p;return this},setTitleText:function(p){this._titleText=p;if(this.cell){this.cell.title.setText(this._titleText)}},_onCreateView:function(){return new n()},_onSetView:function(p){this.cell=p;p.setState(g.State.Normal);p.title.setText(this._titleText);p.button.setText(this._buttonText);p.button.setOnClick(this._buttonClick)},_onReleaseView:function(p){if(this.cell==p){this.cell=null}}})}};__ngs._cy={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=__ngs.r_(__ngs._87).ReferenceCounting;var a=c.ListViewItemController=b.subclass({classname:"ListViewItemController",initialize:function($super,e){$super();if(e){this.setController(e)}return this},controller:function(){return this._controller},setController:function(e){this._controller=e},reloadList:function(){if(this._controller&&this._controller.reloadRequested){this._controller.reloadRequested(this)}else{this.forceReloadList()}},forceReloadList:function(){this.loge("Must implement in non-abstract subclass!")}})}};__ngs._cz={_c:null,_d:function(){var d={exports:{}};var z=d.exports;this._c=d;var a=__ngs.r_(__ngs._5).Core;var k=__ngs.r_(__ngs._59).UI;var j=k.ViewGeometry.Rect;var f=k.ViewGeometry.Scale;var e=__ngs.r_(__ngs._77).Primitives;var h=__ngs.r_(__ngs._ae).Defines;var w=new (__ngs.r_(__ngs._f).RequireLoader)({OldStyle:function(){return __ngs.r_(__ngs._60).Style},ContactsController:function(){return __ngs.r_(__ngs._6h).ContactsController},WallCmdViewController:function(){return __ngs.r_(__ngs._d1).WallCmdViewController},Session:function(){return __ngs.r_(__ngs._o).Session},Wall:function(){return __ngs.r_(__ngs._ch).Wall},UserCellView:function(){return __ngs.r_(__ngs._ad).UserCellView},UserCellView_ThreeItemMessage_TappableColumnVariant:function(){return __ngs.r_(__ngs._ad).UserCellView_ThreeItemMessage_TappableColumnVariant},TappableUserIconView:function(){return __ngs.r_(__ngs._c2).TappableUserIconView},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},WallStyle:function(){return __ngs.r_(__ngs._d4)},UserProfileStyle:function(){return __ngs.r_(__ngs._b0)},ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells},NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},VerticalTabViewSizing:function(){return __ngs.r_(__ngs._9g).VerticalTabViewSizing}});var t=__ngs.r_(__ngs._9h);var x=t.Composite;var l=__ngs.r_(__ngs._ao).CompositeButton;var o=__ngs.r_(__ngs._9i);var y=o.Components;var p=o.Component;var g=__ngs.r_(__ngs._2z).Assets;var c=__ngs.r_(__ngs._n).LocalizedString;var n=__ngs.r_(__ngs._n).LocalizedDate;var m=z.WallPostArea=k.View.subclass({classname:"WallPostSection",checkedUserDetails:false,userIsMobageUser:false,maxMsgLength:90,initialize:function($super,C,D,B){$super();w.UserProfileStyle;w.WallStyle;this._styleSheet=w.OldStyle.registeredStyle("social.us.userprofile").props();this._styleSheetWall=w.OldStyle.registeredStyle("social.us.wall").props();this._commonSheet=w.OldStyle.registeredStyle("social.us.commonelements").props();this._curUser=C;this._postCallback=D;this._totalHeight=a.Capabilities.getScreenWidth();this._totalWidth=a.Capabilities.getScreenHeight();this._contentWidth=B;this._postAreaHeight=(this._totalHeight+100)*this._styleSheetWall.postAreaHFactor;this._createPostSection();this._curUser.getUserDetails(function(G,E){this.checkedUserDetails=true;this.userIsMobageUser=E.isMobageUser;NgLogD("Mobage/WallPostSection userIsMobageUser = "+this.userIsMobageUser);if(!this.userIsMobageUser&&this._curUser.gamertag!==w.Session.getCurrentSession().user().gamertag){var F=[0,0,this.getFrame()[2],this.getFrame()[3]];this._noPostingButton=(new w.UnspammableButton()).retain();this._noPostingButton.setFrame(F);this._noPostingButton.onclick=function(){var H=(new k.AlertDialog()).retain();H.setTitle(c("Unavailable for %1s",this._curUser.gamertag));H.setText(c("Sorry, the MobaWall is not yet available for iPhone users. Coming soon!"));H.setChoices([c("OK")]);H.onchoice=function(I){H.release();H=null};H.show();return}.bind(this);this._postEdit.setEnabled(false);this.addChild(this._noPostingButton)}}.bind(this))},destroy:function(){if(this._postButton){this._postButton.release()}if(this._headerLabel){this._headerLabel.release()}if(this._postEdit){this._postEdit.release()}if(this._noPostingButton){this._noPostingButton.release()}if(this.postInvisButton){this.postInvisButton.release()}},_cleanViews:function(){if(this._retainedViews){for(var B=0;B<this._retainedViews.length;B++){var C=this._retainedViews[B];if(C&&!C.__destroyed__){C.release()}}}this._retainedViews=new Array()},_createPostSection:function(){var C=this._styleSheetWall.hSpacing*this._contentWidth;this.setFrame([0,0,this._contentWidth,this._postAreaHeight]);this.setAttributes(this._styleSheet.friendsHeader);var F=this._postAreaHeight;this._headerLabel=(new k.Label()).retain();this._headerLabel.setAttributes(this._styleSheetWall.wallHeaderLabel);if(this._curUser.gamertag===w.Session.getCurrentSession().user().gamertag){this._headerLabel.setText(c("Comments"))}else{this._headerLabel.setText(c("Post a public comment"))}this._headerLabel.setFrame([C,this._styleSheetWall.postHeaderLabelYFactor*F,this._contentWidth-2*C,this._styleSheetWall.postHeaderLabelHFactor*F]);this._headerLabel.setTextGravity(k.ViewGeometry.Gravity.Left);this.addChild(this._headerLabel);this._postButton=(new w.UnspammableButton()).retain();this._postButton.setAttributes(this._commonSheet.standardButton);this._postButton.setText(c("Post"));var D=this._styleSheetWall.buttonPostWFactor*this._contentWidth;this._postButton.setFrame([this._contentWidth-D-C,F*this._styleSheetWall.postTextYFactor,D,this._styleSheetWall.buttonPostHFactor*F]);this._replaceTextArea();var E=function(H){if((typeof H)!=="undefined"){if(!w.NetworkUtils.wasNetworkDown()){var G=(new k.AlertDialog()).retain();G.setTitle(c("Error"));G.setText(c("Error accessing system.  Please try again later. Error: %1s",H));G.setChoices([c("OK")]);G.onchoice=function(I){G.release();G=null};G.show()}}this._postCallback(H)}.bind(this);var B=function(H){var G=/^\s*$/.test(H);return G};this._postButton.onclick=function(){this._postEdit.setEnabled(false);this._postEdit.setEnabled(true);if(!this.checkedUserDetails){return}if(!this.userIsMobageUser&&this._curUser.gamertag!==w.Session.getCurrentSession().user().gamertag){return}var G=this._postEdit.getText();if(!B(G)){G=G.substring(0,this.maxMsgLength);w.Wall.postMsg(this._curUser.recordID,G,this.bind(function(H){if((typeof H)==="undefined"){this._postEdit.setText("")}E(H)}),false)}}.bind(this);this.addChild(this._postButton)},_replaceTextArea:function(){var B=this._styleSheetWall.hSpacing*this._contentWidth;if(this._postEdit){this._postEdit.setEnabled(false);this._postEdit.removeFromParent();this._postEdit.release();this._postEdit=null}if(this._curUser.gamertag===w.Session.getCurrentSession().user().gamertag){this._postEdit=(new w.LimitedEditText("wall_post_cur_user")).retain()}else{this._postEdit=(new w.LimitedEditText("wall_post")).retain()}this._postEdit.setTextGravity(k.ViewGeometry.Gravity.TopLeft);this._postEdit.setOnBlur(this.bind(function(){if(m.currentPostEditText==this._postEdit){m.currentPostEditText=null}this._postEdit.setEnabled(false);this._postEdit.setEnabled(true)}));this._postEdit.setTextGravity(k.ViewGeometry.Gravity.Left);var D=this._postAreaHeight;this._postEdit.setAttributes(w.OldStyle.registeredStyle("social.us.commonelements").props().textBox);var C=this._styleSheetWall.buttonPostWFactor*this._contentWidth;this._postEdit.setFrame([B,D*this._styleSheetWall.postTextYFactor,this._contentWidth-C-3*B,this._styleSheetWall.buttonPostHFactor*D]);this.addChild(this._postEdit);this._curUser.getUserDetails(function(G,E){this.checkedUserDetails=true;this.userIsMobageUser=E.isMobageUser;if(!this.userIsMobageUser){var F=[0,0,this.getFrame()[2],this.getFrame()[3]];this._noPostingButton=(new w.UnspammableButton()).retain();this._noPostingButton.setFrame(F);this._noPostingButton.onclick=function(){this._plusUserAlert()}.bind(this);this.addChild(this._noPostingButton);this.postInvisButton=(new w.UnspammableButton()).retain();this.postInvisButton.setFrame([this._styleSheet.postHeaderLabelXFactor*this._contentWidth,D*this._styleSheetWall.postTextYFactor,this._styleSheet.postTextWFactor*this._contentWidth,this._styleSheetWall.postTextHFactor*D]);this.postInvisButton.setOnClick((function(){this._plusUserAlert()}).bind(this));this.addChild(this.postInvisButton)}}.bind(this))},_plusUserAlert:function(){var C=this;var B=new k.AlertDialog();B.setTitle(c("Unavailable for %1s",this._curUser.gamertag));B.setText(c("%1s has not upgraded to Mobage yet. Invite them to upgrade!",this._curUser.gamertag));B.setChoices([c("Invite"),c("Not Now")]);B.show();this._postEdit.setEnabled(false);B.onchoice=function(E){if(E.choice!==0){B.release();B=null}else{var D=C._curUser.recordID;C._curUser.inviteToCurrentGame(function(F,G){NgLogD("Invite to game request sent: "+JSON.stringify(G));if(F&&G&&G.error==h.SERVER_ERRORCODE_MALFORMED_EMAIL){w.UIUtils.showToast(c("%1s has an invalid email address.",C._curUser.gamertag));B.release();B=null}else{if(F){w.UIUtils.showToast(c("Please check your network settings."));B.release();B=null}else{w.UIUtils.showToast(c("Email invite sent!"));B.release();B=null}}})}}}});var u=w.UserCellView_ThreeItemMessage_TappableColumnVariant.subclass({classname:"ConversationCell",insetRatio:null,buttonSizeRatio:null,subtitleHeightRatio:0.75,rightInsetRatio:null,initialize:function($super,B){this._compositePrepare();this._compositeInits.icon=function(D){this[D]=(new w.TappableUserIconView()).retain()};$super(B);var C=w.ListViewCellStyles.ConversationCell;C.applyTo(this);this.insetRatio=C.extras.buttonInsetRatio;this.rightInsetRatio=C.extras.rightInsetRatio;this.buttonSizeRatio=C.extras.buttonSizeRatio;this.subtitleHeightRatio=C.extras.subtitleHeightRatio;this.setOnClick(this.bind(this.rowTapped));this.getIconView().setOnClick(this.bind(this.avatarTapped))},setAvatarTappedCB:function(B){this._avatarTappedCB=B},setRowTappedCB:function(B){this._rowTappedCB=B},rowTapped:function(){this._rowTappedCB()},avatarTapped:function(){this._avatarTappedCB()},setReplyCount:function(B){var C="";if(B>99){C="99+"}else{if(B>0){C=String(B)}}this.accessoryButton.label.setText(C)},layoutSubviews:function($super){var G=new j(this.getFrame());if(!G.isEmpty()){var E=G.copy();var H=this.insetRatio*G.h;var D=[H,H,H,H];var C=[H/2,H/2,H/2,H/2];this.setIconInset(C);var B=this.rightInsetRatio*G.h;this.icon.setFrameSize([E.h,E.h]);var J=[H/2,H/2,H/2,H/2];this.accessoryButton.setIconInset(J);var F=B*3.5-H;this.accessoryButton.setFrame([0,0,F,B*1.5]);this.content.layoutSubviews();this.content.content.setFrameSize([G.w,G.h*0.25]);var I=this.content.title.getFrame();this.content.subtitle.setFrame([I[0],I[1]+I[3],G.w-F-E.h,G.h*0.75])}$super()}});var v=z.ConversationListItem=e.ListViewItem.subclass({classname:"ConversationListItem",_reuseId:"wall.conversationlistitem",initialize:function($super,F,H,I,C,G,E,D,B){this._idx=I;this._scrollview=G.view().getContentView();this._ypos=C;this._user=F;this._controller=G;this._conversation=H;this._cb=E;this._commandList=null;this._commandListIsShowing=false;this._pushConversationWallFunction=D;this._jumpToUserProfileCB=B},_onCreateView:function(){var B=new u();return B},_onReleaseView:function(B){B.icon.setImage("");if(this.cell==B){this.cell=null}},_onSetView:function(B){this.cell=B;var D=this;B.setRowTappedCB(this.bind(function(){this._pushConversationWallFunction(this._conversation,this._user)}));if(this._conversation.total>0){B.setReplyCount(this._conversation.total-1)}B.setState(k.State.Normal);B.layoutSubviews();B.icon.content.setImage(this._conversation.user.getDefinedIcon());B.setAvatarTappedCB(this.bind(function(){this._jumpToUserProfileCB(this._conversation.user)}));var E=n(this._conversation.date);var C=65;if(this._conversation.message.length>C){B.content.subtitle.setText(this._conversation.message.substring(0,C)+"...")}else{B.content.subtitle.setText(this._conversation.message)}B.content.content.setText(this._conversation.author_gamertag+" "+E);if(this.odd){B.addState(w.ContactsController.OddState)}B.accessoryButton.content.setOnClick((function(){this.showCommandList(this._user,this._conversation,B.getFrame(),this._cb,this._pushConversationWallFunction,B)}).bind(this))},showCommandList:function(G,J,C,F,D,M){var I=C.slice();I[0]+=M.accessoryButton.getFrame()[3]/3;var B=(M.accessoryButton.getFrame()[3]/7.3)*M.accessoryButton.label.getText().length;I[0]-=B;var E=(M.accessoryButton.getFrame()[3]/2)+B;var L=C[1]+(C[3]/2);if(this._scrollview){var H=this._ypos;var K=C[3];H+=this._idx*K+K/2+K/10;H-=this._scrollview.getScrollPosition()[1];I[1]=H}if(this._commandListIsShowing){this._commandListIsShowing=false}else{this._commandListIsShowing=true;this._commandList=null;if(this._commandList===null){this._commandList=new w.WallCmdViewController(G,J,I,F,D,E,true,M)}else{console.log("fix this!")}}}});var s=w.UserCellView.subclass({classname:"DialogCell",insetRatio:null,rightInsetRatio:null,buttonSizeRatio:null,subtitleHeightRatio:0.5,initialize:function($super,B){this._compositePrepare();this._compositeInits.icon=function(D){this[D]=(new w.TappableUserIconView()).retain()};$super(B);var C=w.ListViewCellStyles.DialogCell;C.applyTo(this);this.insetRatio=C.extras.buttonInsetRatio;this.rightInsetRatio=C.extras.rightInsetRatio;this.buttonSizeRatio=C.extras.buttonSizeRatio;this.subtitleHeightRatio=C.extras.subtitleHeightRatio;this.getIconView().setOnClick(this.bind(this.avatarTapped))},setAvatarTappedCB:function(B){this._avatarTappedCB=B},avatarTapped:function(){this._avatarTappedCB()},layoutSubviews:function($super,L){var I=new j(this.getFrame());if(!I.isEmpty()){var G=I.copy();var J=this.insetRatio*I.h;var F=[J,J,J,J];var C=[J/2,J/2,J/2,J/2];var B=this.rightInsetRatio*I.h;this.setIconInset(C);this.setAccessoryButtonInset(F);this.accessoryButton.setFrame([0,0,B*1.3,B*1.3]);this.content.content.setFrameSize([I.w,I.h*0.25]);this.content.subtitle.setFrameSize([I.w,I.h*0.75]);this.icon.setFrameSize([G.h,G.h])}$super();this.content.layoutSubviews();var D=this.content.subtitle.getFrame();if(L){var H=this.icon.getFrame();var K=H[2]/2;this.icon.setFrame([H[0]+K,H[1],H[2],H[3]]);var E=this.content.content.getFrame();this.content.content.setFrame([E[0]+K,E[1],E[2],E[3]]);this.content.subtitle.setFrame([D[0]+K,D[1]*2*0.75,D[2]-K,D[3]])}else{this.content.subtitle.setFrame([D[0],D[1]*2*0.75,D[2],D[3]])}}});var q=z.DialogListItem=e.ListViewItem.subclass({classname:"DialogListItem",_reuseId:"wall.dialoglistitem",_isIndent:false,initialize:function($super,I,G,E,H,D,F,C,J,B){this._isIndent=G;this._post=I;this._idx=H;this._ypos=D;this._user=E;this._scrollview=F;this._jumpToUserProfileCB=C;this._conversationID=J;this._refreshCB=B;this._commandList=null;this._commandListIsShowing=false},_onCreateView:function(){var B=new s();return B},_onReleaseView:function(B){B.icon.setImage("");if(this.cell==B){this.cell=null}},_onSetView:function(B){this.cell=B;B.setState(k.State.Normal);B.layoutSubviews(this._isIndent);B.icon.content.setImage(this._post.user.getDefinedIcon());var D=n(this._post.date);var C=65;if(this._post.message.length>C){B.content.subtitle.setText(this._post.message.substring(0,C)+"…")}else{B.content.subtitle.setText(this._post.message)}B.content.content.setText(c("%1s %2s",this._post.user.gamertag,D));if(this.odd){B.addState(w.ContactsController.OddState)}B.accessoryButton.setOnClick((function(){this.showCommandList(this._user,this._post,B.getFrame(),this._refreshCB,B)}).bind(this));B.setAvatarTappedCB(function(){if(this._jumpToUserProfileCB){this._jumpToUserProfileCB(this._post.user)}}.bind(this))},showCommandList:function(E,H,B,D,K){console.log("Showing commands");var G=B.slice();G[0]+=K.accessoryButton.getFrame()[3]/3;var C=(K.accessoryButton.getFrame()[3]/2);var J=B[1]+(B[3]/2);console.log("initially I'm considering a frame of "+G);if(this._scrollview){var F=this._ypos;var I=B[3];F+=this._idx*I+I/2+I/10;console.log("it's worthy of note that my idx is "+this._idx);console.log("and the scrollPosition is "+this._scrollview.getScrollPosition()[1]);F-=this._scrollview.getScrollPosition()[1];G[1]=F;console.log("but after some thought I'm thinking my y position should be "+F)}this._commandList=null;if(this._commandList===null){this._commandList=new w.WallCmdViewController(E,H,G,D,undefined,C,false,K);this._commandList.setConversationID(this._conversationID)}else{console.log("fix this")}}});var b=y.Layouts.ThreeHorizontalGenerator("leftArrow","content","rightArrow").layoutSubviews;var r=x({key:"leftArrow",component:y.Image,disableViewAccessorRemapping:true},{key:"content",component:y.Label,altKey:"message",disableViewAccessorRemapping:true},{key:"rightArrow",component:y.Image,disableViewAccessorRemapping:true},y.AddOrders.Generator("content","leftArrow","rightArrow"),{classname:"MorePostCell",initialize:function($super,C){$super(C);var B=w.ListViewCellStyles.MorePostCell;B.applyTo(this);this.insetRatio=B.extras.buttonInsetRatio;this.rightInsetRatio=B.extras.rightInsetRatio;this.buttonSizeRatio=B.extras.buttonSizeRatio;this.subtitleHeightRatio=B.extras.subtitleHeightRatio;return this},layoutSubviews:function($super){$super();var E=new j(this.getFrame());if(!E.isEmpty()){var D=E.h/4;var C=D*2;var B=(E.h/2)-(D/2);this.leftArrow.setFrameSize([D+2*C,D]);this.rightArrow.setFrameSize([D+2*C,D]);this.setLeftArrowInset([B,C,B,C]);this.setRightArrowInset([B,C,B,C])}b.call(this)}},l);var A=z.MorePostListItem=e.ListViewItem.subclass({classname:"MorePostListItem",_reuseId:"wall.morepostlistitem",initialize:function($super,B){this._morePostCB=B},destroy:function(){if(this._leftArrow){this._leftArrow.release();this._leftArrow=null}if(this._rightArrow){this._rightArrow.release();this._rightArrow=null}},_onCreateView:function(){var B=new r();return B},_onReleaseView:function(B){if(this.cell==B){this.cell=null}},_onSetView:function(B){this.cell=B;B.setState(k.State.Normal);B.setGradient({gradient:["66000000 0.0","66000000 0.0"]},k.State.Pressed);B.layoutSubviews();B.content.setText(c("See More Posts..."));B.setOnClick((function(){this._morePostCB()}).bind(this))}})}};__ngs._d0={_c:null,_d:function(){var d={exports:{}};var f=d.exports;this._c=d;var j=__ngs.r_(__ngs._7).Capabilities;var e=__ngs.r_(__ngs._59).UI;var c=e.ViewGeometry.Rect;var k=__ngs.r_(__ngs._79).MBListViewSection;var l=__ngs.r_(__ngs._n).LocalizedString;var a=new (__ngs.r_(__ngs._f).RequireLoader)({PendingCellView:function(){return __ngs.r_(__ngs._bu).PendingCellView},ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells}});var g=20;var h=f.PendingCellView=e.View.subclass({classname:"PendingCellView",spinner:null,content:null,initialize:function($super,n){$super(n);this.spinner=new e.Spinner();this.content=new e.Label();this._style=a.ListViewCellStyles.PendingCell;this._style.applyTo(this);this.spinner.setDarkStyle(true);this.addChild(this.spinner);this.addChild(this.content)},layoutSubviews:function($super){console.log("PendingCellView.layoutSubviews");if($super&&typeof $super==="function"){$super()}var y=new c(this.getFrame());if(y.isEmpty()){console.log("rect is empty");return}console.log(y);var o=y.sliceHorizontal(y.w*1/6);var q=o.w;var r=o.h;var z=r/20;var A=q/10;var u=r/20;var n=q/10;var t=q-A-n;var p=r-z-u;var x=Math.min(g*(j.getScreenHeight()/480),Math.min(t,p));var w=o.x+n+(q-x)/2;var v=o.y+z+(r-x)/2;this.spinner.setFrame([w,v,x,x]);var s=y;this.content.setFrame(s)}});var b=f.PendingListViewItem=e.ListViewItem.subclass({classname:"PendingListViewItem",_reuseId:"pendinglistsection_pendinglitem",_parentSection:null,_message:"",initialize:function($super){$super();this.setMessage(l("Talking to the server..."));this.setHeight(60)},setMessage:function(n){this._message=n;if(this.cell){this._onSetView(this.cell)}},_onCreateView:function(){return new a.PendingCellView()},_onSetView:function(n){n.spinner.setVisible(true);n.content.setText(this._message);n.onclick=this.bind(function(){NgLogD("Pending Item Clicked!")});n.setState(e.State.Normal);n.layoutSubviews();this.cell=n},_onReleaseView:function(n){if(this.cell==n){this.cell=null}},hide:function(){if(this.cell){this.cell.removeFromParent();this.cell.spinner.setVisible(false)}}});var m=f.InteractiveListViewSection=k.subclass({classname:"InteractiveListViewSection",_showPending:false,_pendingItem:null,_showHeader:false,_headerRow:null,_showFooter:false,_footerRow:null,_showCustom:false,_customItem:null,_mbItems:null,destroy:function($super){this.__defineGetter__("items",function(){});this.__defineSetter__("items",function(){});$super();this._pendingItem=null;this._headerRow=null;this._footerRow=null;this._customItem=null;this._mbItems=null},showPendingMessage:function(n){this._showPending=true;if(!this._pendingItem){this._pendingItem=new b()}this._pendingItem.setMessage(n);this.updateItems()},hidePendingMessage:function(){this._showPending=false;if(this._pendingItem){this._pendingItem.hide()}this.updateItems()},setHeaderRow:function(n){this._showHeader=true;this._headerRow=n;this.updateItems()},setFooterRow:function(n){this._showFooter=true;this._footerRow=n;this.updateItems()},hideCustomMessage:function(){this._showCustom=false;this.updateItems()},showCustomMessage:function(o,n){this._showCustom=true;this._customItem=o;if(!n){this.loge("The custom item height has to be specific when using it..")}this._customItem.setHeight(n);this.updateItems()},updateItems:function(n){var p=[];if(this._showHeader&&this._headerRow){p.push(this._headerRow)}if(this._showPending&&this._pendingItem){p.push(this._pendingItem)}if(this._showCustom&&this._customItem){p.push(this._customItem)}p=p.concat(this._mbItems||[]);if(this._showFooter&&this._footerRow){p.push(this._footerRow)}var q=false;if(!this._items){q=true}else{if(this._items.length!==p.length){q=true}}for(var o=0;o<p.length;o++){if(!p[o]._height){this.loge("Had to tweak height for item of type:",p[o].classname);p[o].setHeight(100)}if(!q&&p[o]!==this._items[o]){q=true}}if(q||n){this._setItems(p)}},_setItems:null,viewportFrameChanged:function(n){}});m.prototype.__defineSetter__("items",function(n){this._mbItems=n||[];this.updateItems()});m.prototype.__defineGetter__("items",function(){return this._mbItems||[]});m.prototype._setItems=m.prototype.setItems;m.prototype.setItems=function(n){this.items=n}}};__ngs._d1={_c:null,_d:function(){var d={exports:{}};var h=d.exports;this._c=d;var f=__ngs.r_(__ngs._59).UI;var k=__ngs.r_(__ngs._5).Core;var c=__ngs.r_(__ngs._4).Device;var g=__ngs.r_(__ngs._2z).Assets;var a=new (__ngs.r_(__ngs._f).RequireLoader)({ModalDialog:function(){return __ngs.r_(__ngs._5m).ReportUserModalDialog},User:function(){return __ngs.r_(__ngs._30).User},Session:function(){return __ngs.r_(__ngs._o).Session},Wall:function(){return __ngs.r_(__ngs._ch).Wall},WallStyle:function(){return __ngs.r_(__ngs._d4).WallStyle},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},WallCmdView:function(){return __ngs.r_(__ngs._d8).WallCmdView},VerticalTabViewSizing:function(){return __ngs.r_(__ngs._9g).VerticalTabViewSizing},WallMenu:function(){return __ngs.r_(__ngs._d4).WallMenu},NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils}});var l=__ngs.r_(__ngs._n).LocalizedString;var b=__ngs.r_(__ngs._7g).ViewController;var e=k.MessageListener.subclass({classname:"WallCmd_KeyListener"});var j=h.WallCmdViewController=b.subclass({classname:"WallCmdViewController",_user:null,_conversation:null,_containerFrame:null,_cb:null,_pushConversationWallCB:null,_buttonOffset:null,_isWallUI:null,_cmds:null,initialize:function($super,q,s,m,p,r,o,n){$super();this._user=q;this._conversation=s;this._containerFrame=m;this._cb=p;this._pushConversationWallCB=r;this._buttonOffset=o;this._isWallUI=n;var t=new k.MessageListener();a.UnspammableButton.addDeviceKeyListener(t,this.zombieSafeCallback(function(u){NgLogD("WallCmdViewController caught the event");if(u.code===c.KeyEmitter.Keycode.menu){this.destroy()}return false},this.bind(function(){c.KeyEmitter.removeListener(t);t.destroy()})),99999*2);this.kListener=new e();a.UnspammableButton.addDeviceKeyListener(this.kListener,this.onKeyPressed.bind(this),99999);this.view()._headerHeightRatio=0;return this},onKeyPressed:function(m){if(m.code===c.KeyEmitter.Keycode.back){this.destroy()}return false},loadView:function($super){$super();this.setView(new a.WallCmdView(this.getCommandList(),this._containerFrame,this._buttonOffset));this.view().layoutSubviews()},getCommandList:function(){var m=new Array();if(a.Session.getCurrentSession().user().gamertag===this._conversation.author_gamertag||a.Session.getCurrentSession().user().gamertag===this._user.gamertag){m.push("delete")}if(a.Session.getCurrentSession().user().gamertag!==this._conversation.author_gamertag){m.push("report")}if(this._isWallUI){m.push("comment")}return m},destroy:function(){if(this.kListener){c.KeyEmitter.removeListener(this.kListener);this.kListener=undefined}},setConversationID:function(m){this._conversationID=m;NgLogD("xxx conversationID "+m)},deleteCmdOnClick:function(){var n=(new f.AlertDialog()).retain();n.setTitle(l("Error"));n.setText(l("Not able to delete. Please try again later."));n.setChoices([l("OK")]);n.onchoice=(function(o){this._cb();n.release();n=null}).bind(this);var m=(new f.AlertDialog()).retain();m.setTitle(l("Delete This Post"));m.setText(l("Are you sure you want to delete this post?"));m.setChoices([l("Yes"),l("No")]);m.onchoice=(function(o){if(o.choice!==0){return}m.release();m=null;if(this._isWallUI){a.Wall.deleteConversation(this._user.recordID,this._conversation.conversationID,false,(function(p){if(p){if(!a.NetworkUtils.wasNetworkDown()){n.show()}}else{this._cb()}this.destroy()}).bind(this))}else{a.Wall.deletePost(this._user.recordID,this._conversationID,this._conversation.id,(function(p){if(p){if(!a.NetworkUtils.wasNetworkDown()){n.show()}}else{this._cb()}this.destroy()}).bind(this))}}).bind(this);m.show()},commentCmdOnClick:function(){this._pushConversationWallCB(this._conversation,this._user);this.destroy()},viewCmdOnClick:function(){this._pushConversationWallCB(this._conversation,this._user);this.destroy()},_reportCmdOnClickProcessing:false,reportCmdOnClick:function(){NgLogD("reportBtn onClick");var m=this._conversation.author_gamertag;if(m===a.Session.getCurrentSession().user().gamertag){return}if(this._reportCmdOnClickProcessing){return}this._reportCmdOnClickProcessing=true;a.User.getUserWithID(m,function(o,n){this._reportCmdOnClickProcessing=false;if(o){return}var p;if(this._isWallUI){p={content_type:"wall",content_summary:this._conversation.message,content_row_id:this._conversation.conversationID,content_column_id:this._conversation.id}}else{p={content_type:"wall",content_summary:this._conversation.message,content_row_id:this._conversationID,content_column_id:this._conversation.id}}new a.ModalDialog(n,p);this.destroy()}.bind(this))}})}};__ngs._d2={_c:null,_d:function(){var e={exports:{}};var k=e.exports;this._c=e;var h=__ngs.r_(__ngs._59).UI;var c=h.ViewGeometry.Rect;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Assets:function(){return __ngs.r_(__ngs._2z).Assets},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements},RecentlyPlayedGamesGridPanelStyle:function(){return __ngs.r_(__ngs._cc).RecentlyPlayedGamesGridPanelCell}});var f=__ngs.r_(__ngs._d7);var l=f.GridPanelListViewCell;var m=f.GridPanelListViewItem;var d=__ngs.r_(__ngs._6t).LabeledGameIconButton;var b=d.subclass({classname:"RecentlyPlayedGamesGridEntryButton",setEntry:function(n){this._entry=n;this.setGame(n)}});var g=k.RecentlyPlayedGamesGridPanelCell=l.subclass({classname:"RecentlyPlayedGamesGridPanelCell",initialize:function(){a.RecentlyPlayedGamesGridPanelStyle.applyTo(this)},createEntryView:function(){var n=new b();n.setOnClick(function(){this.cell.item.entryClicked(this._entry)});return n},setEntries:function($super,n){for(var o=0;o<n.length;o++){this._entryViewForIndex(o).setEntry(n[o])}$super(n)},layoutSubviews:function(){var v=new c(this.getFrame());if(v.isEmpty()){return}v.x=v.y=0;var o=(this._entries||[]).length;var p=a.RecentlyPlayedGamesGridPanelStyle.extras.numEntriesPerRow;var u=[];for(var r=0;r<4;r++){u.push(a.RecentlyPlayedGamesGridPanelStyle.extras.insetRatios[r]*v.w)}v.inset.apply(v,u);var w=a.RecentlyPlayedGamesGridPanelStyle.extras.spacerRatio*v.w;var t=((v.w-((p-1)*w))/p);var q=(v.w/o);for(r=0;r<o;r++){var s=v.sliceHorizontal(t);var x=(q-t);this._entryViewForIndex(r).setFrame(s);v.sliceHorizontal(w)}this._clearEntryViews(true)}});var j=k.RecentlyPlayedGamesGridPanelItem=m.subclass({classname:"RecentlyPlayedGamesGridPanelItem",_reuseId:"recentlyplayedgamesgridpanelitem",_onCreateView:function(){return new g()},entryClicked:function(n){console.log("Entry Clicked! ",n.name)}})}};__ngs._d3={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=new (__ngs.r_(__ngs._f).RequireLoader)({UI:function(){return __ngs.r_(__ngs._59).UI}});var a=c.VarHeightCell=b.UI.View.subclass({classname:"VarHeightCell",update:function(e){},layoutSubviews:function(e){},$calculateRequiredHeightForWidth:function(f,g,e){e(0.001)}})}};__ngs._d4={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var g={};g.Style=__ngs.r_(__ngs._60).Style;var e=__ngs.r_(__ngs._6k).MobageStyle;var b=e.ScaledCorners;var f=e.ScaledTextSize;var a=__ngs.r_(__ngs._9u).CommonElements;e.lazyLoad(c,"Wall",function(){return{children:{_wallHeaderLabel:{style:{textFont:g.Style.defaultBoldFontFace,textSize:f(13),textColor:"FF000000",textGravity:[0,0]}}},extras:{viewRatio:{wallHeaderTopMargin:2,postAreaHFactor:(85/480),postHeaderLabelYFactor:(0/85),postHeaderLabelHFactor:(30/85),postTextYFactor:(30/85),postTextHFactor:(50/85),buttonPostXFactor:(455/582),buttonPostWFactor:(120/582),buttonPostHFactor:(47/85),refreshButtonYFactor:0.0625,refreshButtonHFactor:(1/3)}}}});e.lazyLoad(c,"WallMenu",function(){return{children:{_text:{style:{textGravity:[0.5,0],textFont:g.Style.defaultBoldFontFace,textSize:f(11),textColor:"FF00319a"}},_icon:{style:{imageInsets:[0,0,0,0]}}},extras:{viewRatio:{wallMenuAreaHFactor:(115/480),backGroundAspectRatio:(533/88),wallBalloonLabelXFactor:(6/582),wallBalloonLabelYFactor:(75/111),wallBalloonLabelWFactor:(105/582),wallBalloonLabelHFactor:(100/111),wallIconXFactor:(32/582),wallIconYFactor:(19/105),wallIconWFactor:(56/105),wallIconHFactor:(56/105)}}}});g.Style.sheet("social.us.wall",{wallHeaderLabel:{textFont:g.Style.defaultBoldFontFace,textSize:f(13),textColor:"FF000000",textGravity:[0,0]},wallHeaderTopMargin:2,postAreaHFactor:(85/480),postHeaderLabelYFactor:(0/85),postHeaderLabelHFactor:(30/85),postTextYFactor:(30/85),postTextHFactor:(50/85),buttonPostWFactor:(116/582),buttonPostHFactor:(47/85),hSpacing:0.0188,refreshButtonYFactor:0.0625,refreshButtonHFactor:(1/3)});g.Style.sheet("social.us.wall.menu",{wallIconLabel:{textGravity:[0.5,0],textFont:g.Style.defaultBoldFontFace,textSize:f(11),textColor:"FF00319a"},wallIconImage:{imageInsets:[0,0,0,0]},screenWidth:800,buttonContainerMarginX:15,buttonContainerMarginY:7,iconMarginTop:20,wallMenuAreaHFactor:(115/480),backGroundAspectRatio:(533/88),wallBalloonLabelXFactor:(6/582),wallBalloonLabelYFactor:(46/111),wallBalloonLabelWFactor:(105/582),wallBalloonLabelHFactor:(30/111),wallIconXFactor:(36/582),wallIconYFactor:(3/105),wallIconWFactor:(40/105),wallIconHFactor:(40/105)})}};__ngs._d5={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=new (__ngs.r_(__ngs._f).RequireLoader)({UI:function(){return __ngs.r_(__ngs._59).UI},LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},LocDate:function(){return __ngs.r_(__ngs._n).LocalizedDate},Layout:function(){return __ngs.r_(__ngs._aj).Layout},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},WallCellStyle:function(){return __ngs.r_(__ngs._65).WallCell},VarHeightCell:function(){return __ngs.r_(__ngs._d3).VarHeightCell}});var d=b.VHWallCell=a.VarHeightCell.subclass({classname:"VHWallCell",initialize:function($super){$super();this._cellStyle=a.WallCellStyle;this._gamertag=null;this._subtitle=null;this._message=null;this._avatar=null;this._avatarOverlay=null;this._commandButton=null;this._clickyOverlay=null;this.initSubviews();this.addSubviews()},destroy:function(){if(this._gamertag){this._gamertag.release();this._gamertag=null}if(this._subtitle){this._subtitle.release();this._subtitle=null}if(this._message){this._message.release();this._message=null}if(this._avatar){this._avatar.release();this._avatar=null}if(this._avatarOverlay){this._avatarOverlay.release();this._avatarOverlay=null}if(this._commandButton){this._commandButton.release();this._commandButton=null}if(this._clickyOverlay){this._clickyOverlay.release();this._clickyOverlay=null}},update:function(f){var e=0;if(f.isPlaceholder){this._commandButton.removeFromParent();this._clickyOverlay.removeFromParent();this._avatarOverlay.removeFromParent();e=this._cellStyle.extras.placeholderOpacity}else{this._clickyOverlay.removeFromParent();this._gamertag.removeFromParent();this._subtitle.removeFromParent();this._message.removeFromParent();this._avatar.removeFromParent();this._avatarOverlay.removeFromParent();this._commandButton.removeFromParent();this.addChild(this._clickyOverlay);this.addChild(this._gamertag);this.addChild(this._subtitle);this.addChild(this._message);this.addChild(this._avatar);this.addChild(this._avatarOverlay);this.addChild(this._commandButton);e=this._cellStyle.extras.normalOpacity}this._gamertag.setAlpha(e);this._subtitle.setAlpha(e);this._message.setAlpha(e);this._avatar.setAlpha(e);this._clickyOverlay.setOnClick(f.onCellClick);this._commandButton.setOnClick(f.onCommandButtonClick);this._avatarOverlay.setOnClick(f.onAvatarClick);this._message.setText(f.post.message);this._gamertag.setText(f.post.user.gamertag);this._subtitle.setText(d._constructSubtitleText(f));this._avatar.setImage(f.post.user.getDefinedIcon())},$_constructSubtitleText:function(e){return a.LocDate(e.post.date)},initSubviews:function(){this._gamertag=(new a.UI.Label()).retain();this._subtitle=(new a.UI.Label()).retain();this._message=(new a.UI.Label()).retain();this._avatar=(new a.UI.Image()).retain();this._avatarOverlay=(new a.UnspammableButton()).retain();this._commandButton=(new a.UnspammableButton()).retain();this._clickyOverlay=(new a.UnspammableButton()).retain()},addSubviews:function(){this.addChild(this._gamertag);this.addChild(this._subtitle);this.addChild(this._message);this.addChild(this._avatar);this.addChild(this._avatarOverlay);this._cellStyle.applyTo(this)},layoutSubviews:function(y){if(!y.metrics.tag||!y.metrics.message||!y.metrics.subtitle){return}var f=new a.UI.ViewGeometry.Rect(this.getFrame());if(f.isEmpty()){return}f.x=f.y=0;var l=this._cellStyle.extras;this._clickyOverlay.setFrame(f);var w=l.avatarImageSizeFactor*f.w;var o=f.copy().sliceHorizontal(w);o.h=w;this._avatar.setFrame(o.inset(f.w*l.avatarImageSpacerInsetRatio));this._avatarOverlay.setFrame(this._avatar.getFrame());var n=l.commandButtonSizeFactor*f.w;var v=f.copy().sliceHorizontal(-n);v.y=(v.h-n)*0.5;v.h=n;this._commandButton.setFrame(v.inset(f.w*l.commandButtonSpacerInsetRatio));var t=f.copy().sliceHorizontal(-(f.w-w));if(!y.isPlaceholder){t=t.sliceHorizontal(f.w-n-w)}var s=a.WallCellStyle.children._gamertag.getTextInsets();var u=s[0]+s[2];var h=s[1]+s[3];s=a.WallCellStyle.children._message.getTextInsets();var j=s[0]+s[2];s=a.WallCellStyle.children._subtitle.getTextInsets();var x=s[0]+s[2];var k=s[1]+s[3];var p=y.metrics.tag.height+u;var m=y.metrics.tag.totalWidth+h;var g=y.metrics.subtitle.height+x;var r=y.metrics.subtitle.totalWidth+k;var q=y.metrics.message.height+j;var e=Math.max(p,g);this._gamertag.setFrame(t.x,t.y,m,p);this._subtitle.setFrame(t.x+m,t.y+e-g,r,g);this._message.setFrame(t.x,t.y+e,t.w,q)},$calculateRequiredHeightForWidth:function(e,m,h){if(!m.post){h(0);return}var r=new a.UI.ViewGeometry.Rect([0,0,e,1]);var k=a.WallCellStyle.extras;var o=k.avatarImageSizeFactor*r.w;var f=k.commandButtonSizeFactor*r.w;var s=r.copy().sliceHorizontal(-(r.w-o));if(!m.isPlaceholder){s=s.sliceHorizontal(r.w-f-o)}var g=a.WallCellStyle.children._gamertag.getTextInsets();var q=g[0]+g[2];var j=g[1]+g[3];g=a.WallCellStyle.children._message.getTextInsets();var t=g[0]+g[2];var l=g[1]+g[3];g=a.WallCellStyle.children._subtitle.getTextInsets();var u=g[0]+g[2];var n=g[1]+g[3];var p={subtitle:{text:d._constructSubtitleText(m),width:s.w,height:500,textFont:a.WallCellStyle.children._subtitle.getNormalTextFont(),textSize:a.WallCellStyle.children._subtitle.getTextSize()},message:{text:m.post.message,width:s.w-l,height:10000,textFont:a.WallCellStyle.children._message.getNormalTextFont(),textSize:a.WallCellStyle.children._message.getTextSize()}};a.Layout.measureStrings(p,m.metrics,function(){p={tag:{text:m.post.user.gamertag,width:s.w-j-m.metrics.subtitle.totalWidth-n,height:500,textFont:a.WallCellStyle.children._gamertag.getNormalTextFont(),textSize:a.WallCellStyle.children._gamertag.getTextSize()}};a.Layout.measureStrings(p,m.metrics,function(){h(Math.ceil(Math.max(Math.max(m.metrics.tag.height+q,m.metrics.subtitle.height+u)+m.metrics.message.height+t,o)))})})}})}};__ngs._bv={_c:null,_d:function(){var a={exports:{}};var e=a.exports;this._c=a;__ngs.r_(__ngs._88);var k=__ngs.r_(__ngs._9i);var f=k.Components;var j=k.Component;var b=k.ComponentInheritForKey;var c=k.ACCESSOR_PASSTHROUGH;var d=__ngs.r_(__ngs._78).AccordionListView;var g=__ngs.r_(__ngs._ai).CCView;var h=e.CCViewList=g.subclass({classname:"CCViewList",initialize:function($super,l){this._compositePrepare();this._compositeInits.content=function(m){this[m]=(new d()).retain()};$super(l);return this},getSections:function(){return this.content.getSections()},setSections:function(l){return this.content.setSections(l)},layoutSubviews:function($super){$super()}})}};__ngs._bw={_c:null,_d:function(){var e={exports:{}};var h=e.exports;this._c=e;var k=__ngs.r_(__ngs._5).Core;var f=__ngs.r_(__ngs._59).UI;var d=f.ViewGeometry.Rect;var c=f.ViewGeometry.Scale;var b=new (__ngs.r_(__ngs._f).RequireLoader)({CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements},ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells}});var a=__ngs.r_(__ngs._9h).Composite;var g=__ngs.r_(__ngs._9i).Components;var j=h.ZeroCaseMessageCell=a({key:"title",component:g.Label},{key:"content",component:g.Label},{key:"actionButton",component:g.UnspammableButton},g.AddOrders.Generator("title","content","actionButton"),{classname:"ZeroCaseMessageCell",initialize:function($super){this._sheet=b.ListViewCellStyles.ZeroCaseMessageCell.extras;$super({});this._totalWidth=k.Capabilities.getScreenHeight();this._totalHeight=k.Capabilities.getScreenWidth();this._zeroCaseHeight=this._totalHeight*b.CommonElements.zeroCase.extras.heightFactor;b.ListViewCellStyles.ZeroCaseMessageCell.applyTo(this);this.content.setMaxLines(2);this.actionButton.setTextGravity([0.5,0.5])},layoutSubviews:function($super){if($super&&typeof $super==="function"){$super()}var o=new d(this.getFrame());if(o.isEmpty()){return}var p=(o.h-this._zeroCaseHeight)/2;var l=[o.w*this._sheet.titleXFactor,p+this._zeroCaseHeight*this._sheet.titleYFactor,o.w*this._sheet.titleWidthFactor,this._zeroCaseHeight*this._sheet.titleHeightFactor];var m=[o.w*this._sheet.contentXFactor,p+this._zeroCaseHeight*this._sheet.contentYFactor,o.w*this._sheet.contentWidthFactor,this._zeroCaseHeight*this._sheet.contentHeightFactor];var n=[o.w*this._sheet.actionButtonXFactor,p+this._zeroCaseHeight*this._sheet.actionButtonYFactor,o.w*this._sheet.actionButtonWidthFactor,this._zeroCaseHeight*this._sheet.actionButtonHeightFactor];this.title.setFrame(l);this.content.setFrame(m);this.actionButton.setFrame(n)},setZeroCaseTexts:function(l){if(!l||l.length<3){return}if(l[0]!==undefined&&l[0]!==null){this.title.setText(l[0]);this.title.getTextMeasurementForState(f.State.Normal)}if(l[1]!==undefined&&l[1]!==null){this.content.setText(l[1]);this.content.getTextMeasurementForState(f.State.Normal)}if(l[2]!==undefined&&l[2]!==null){f.measureText(l[2],this._totalWidth,this._totalHeight,this.actionButton.getStyle().getTextFont(),this.actionButton.getStyle().getTextSize(),function(o){var n=this.actionButton.getFrame();var m=o.totalWidth+this._sheet.actionButtonInset;n[0]+=(n[2]-m)*0.5;n[2]=m;this.actionButton.setFrame(n)}.bind(this));this.actionButton.setText(l[2])}},setZeroCaseButtonCallback:function(l){if(l&&typeof l=="function"){this.getActionButtonView().onclick=l}},setZeroCaseButtonEnabled:function(l){this.getActionButtonView().setEnabled(l)},getButton:function(){return this.getActionButtonView()}})}};__ngs._bx={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var c=__ngs.r_(__ngs._2z).Assets;var a=__ngs.r_(__ngs._60).Style;var e=__ngs.r_(__ngs._6k).MobageStyle;var f=e.ScaledTextSize;e.lazyLoad(b,"GameDownloadButton",function(){return{style:{gradient:{corners:"8.0 8.0 8.0 8.0",gradient:["FF75B624 0.000","FF4D8D1F 1.000"]},pressedGradient:{corners:"8.0 8.0 8.0 8.0",gradient:["FF5B971B 0.000","FF397210 1.000"]},promoGradient:{corners:"8.0 8.0 8.0 8.0",gradient:["FFdee0e0 0.0","FFffffff 0.52","FFeeeeee 0.58","FFafb0b0 1.0"],outerShadow:"FF00 2.0 {0.5,0.866}"},pressedPromoGradient:{corners:"8.0 8.0 8.0 8.0",gradient:["FF8e8080 0.0","FFbfbfbf 0.52","FFbebebe 0.58","FF8f8080 1.0"],outerShadow:"FF00 2.0 {0.5,0.866}"}},children:{_icon:{style:{image:c.image("download_icon.png"),promoImage:c.image("download_icon_moba.png")}},_msgLabel:{style:{textColor:"FFFFFFFF",promoTextColor:"FFC69622",textSize:f(14),textFont:a.defaultBoldFontFace,textShadow:"33000000 1.0 {0.0,-2.0}"}},_timeLabel:{style:{textColor:"FF717272",textSize:f(11),textFont:a.defaultBoldFontFace}}},extras:{xRatio:0,yRatio:0,widthRatio:1,heightRatio:1,promoXRatio:0,promoYRatio:-0.2,iconSize:0.77,characterWidth:0.14,iconSpacing:0.02,iconGravityX:0.45,iconGravityY:0.5}}})}};__ngs._by={_c:null,_d:function(){var d={exports:{}};var f=d.exports;this._c=d;var e=__ngs.r_(__ngs._59).UI;var h=__ngs.r_(__ngs._w).MessageListener;var b=__ngs.r_(__ngs._4).Device;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Assets:function(){return __ngs.r_(__ngs._2z).Assets},FullScreenEditorView:function(){return __ngs.r_(__ngs._cq).FullScreenEditorView}});var j=__ngs.r_(__ngs._n).LocalizedString;var c=__ngs.r_(__ngs._7g).ViewController;var g=f.FullScreenEditor=c.subclass({classname:"FullScreenEditor",initialize:function($super){$super();this._isMultiline=true;this._maxChars=-1;this.listener=new h();this.setup()},loadView:function($super){this.setView(new a.FullScreenEditorView());$super();this.view().setFrame([0,0,e.Window.getWidth(),e.Window.getHeight()])},isMultiline:function(){return this._isMultiline},setIsMultiline:function(k){this._isMultiline=k},maxCharacters:function(){return this._maxChars},setMaxCharacters:function(k){this._maxChars=k;this.view().charCounter.setText("")},setup:function(k,p,m,o,l,n){this.onCompleteCb=m||function(){};this.onCancelCb=o||function(){};this.view().title.setText(k||j("Please enter your message:"));this.view().actionButton.setText(p||j("Done"));this.view().field.setPlaceholder(l||"");this.view().cancelButton.setText(n||j("Cancel"))},show:function(k){if(this._showing){return}this.setText(k);this._onTextChanged(k);this._show()},hide:function(){this.view().removeFromParent();this._showing=false;b.KeyEmitter.removeListener(this.listener)},getText:function(){return this.view().field.getText()},setText:function(k){this.view().field.setText(k)},_show:function(){b.KeyEmitter.addListener(this.listener,this._onKeyPressed.bind(this),1001);e.animate(this.bind(function(){e.Window._getLayer(1).addChild(this.view())}),100,this.bind(function(){this.view().field.focus()}));this._showing=true},_canceled:function(){if(!this._showing){return}this.hide();if(this.onCancelCb){this.onCancelCb(this.getText())}this.setText("")},_submitted:function(){if(!this._showing){return}this.hide();if(this.onCompleteCb){this.onCompleteCb(this.getText())}this.setText("")},_onTextChanged:function(k){if(!this._isMultiline&&k&&k.indexOf("\n")!=-1){k=k.replace("\n"," ");this.view().field.setText(k)}if(this._maxChars!=-1&&typeof(k)=="string"){if(k.length>this._maxChars){this.view().field.setText(k.substr(0,this._maxChars))}this.view().charCounter.setText(j("%1d of %2d",k.length,this._maxChars))}},_onKeyPressed:function(k){if(k.code===b.KeyEmitter.Keycode.back){this._canceled();return true}return false}})}};__ngs._bz={_c:null,_d:function(){var d={exports:{}};var e=d.exports;this._c=d;var c=__ngs.r_(__ngs._t);var b=__ngs.r_(__ngs._28);var g=__ngs.r_(__ngs._30);var l=__ngs.r_(__ngs._1s).SHA1;var f=__ngs.r_(__ngs._1);function h(n,m){var o=new b.PlusRequest();o.setApiMethod("users/search?email_hash="+n.join(","));o.setHttpMethod("GET");o.send(function(q,t,s,p){if((typeof q)=="undefined"){var w=t?t.success:false;if(w){var r=[];for(var v in t.list){if(t.list.hasOwnProperty(v)){var x=t.list[v];var u=g.User.getUserWithData(x);r.push(u)}}m(q,r,n);return}}m(q,[],n)})}var k=false;function a(s,v,u,D,m,n){if(k){NgLogD("Hack: AddressBookScan abort...");if(v&&v.closeResultSet){try{v.closeResultSet()}catch(z){f.SystemBinding._closeContactsResultSetfunction(v)}}return}if((typeof s)!="undefined"){NgLogD("Error getting contacts on phone: "+s);n(s);return}var r=[];var t={};var w=u;var p=[];while(w<(u+D)){var x=v.items[w];x.foundInPlus=false;var q=x.lowercaseEmails;if((!q)||(q.length===0)){p.push(x)}for(var C in q){if(q.hasOwnProperty(C)){var o=l.hex_sha1(q[C]);r.push(o);t[o]=x}}w++}var y=100;var B=Math.min(y,r.length);var A=function(E,O,G){var K=[];var P=p.slice(0);for(var I in O){if(O.hasOwnProperty(I)){var R=O[I];K.push(R);var N=t[R.emailHash];if(N){N.foundInPlus=true;if(R&&!(R.firstName||R.lastName)){R.firstName=N.displayName}}R.contact=N}}var F,M,J,L;for(var S in G){if(G.hasOwnProperty(S)){J=G[S];if(t.hasOwnProperty(J)){L=t[J];if(!L.foundInPlus){F=true;for(M in P){if(P.hasOwnProperty(M)&&P[M]==L){F=false;break}}if(F){P.push(L)}}}}}m(E,K,P);B=Math.min(y,r.length);if(B>0){h(r.splice(0,B),A)}else{var Q=function(U,V,T,W){a(U,V,T,W,m,n)};var H=v.getMore(Q);if(!H){n(E)}}};h(r.splice(0,B),A)}var j=c.Class.subclass({classname:"ContactsScanBase",initialize:function(m){k=false},abortScanning:function(){k=true},searchPlusForPeople:function(o,n){var m=function(q,s,p,r){a(q,s,p,r,o,n)};this.getMore(m)},getMore:function(m){NgLogW("NOT IMPLEMENTED - ContactsSearchBase.getMore")}});e.ContactsScanBase=j}};__ngs._c0={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=a.StringUtils={trim:function(d){return d.replace(/^\s+|\s+$/g,"")},ltrim:function(d){return d.replace(/^\s+/,"")},rtrim:function(d){return d.replace(/\s+$/,"")}}}};__ngs._c1={_c:null,_d:function(){var d={exports:{}};var j=d.exports;this._c=d;var l=__ngs.r_(__ngs._5).Core;var f=__ngs.r_(__ngs._59).UI;var c=f.ViewGeometry.Rect;var m=__ngs.r_(__ngs._79).MBListViewSection;var b=new (__ngs.r_(__ngs._f).RequireLoader)({Destinations:function(){return __ngs.r_(__ngs._2a).Destinations},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements},ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells},LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},Main:function(){return __ngs.r_(__ngs._m).Main}});var a=__ngs.r_(__ngs._9h).Composite;var h=__ngs.r_(__ngs._9i).Components;var g=j.UpgradeUserCell=a({key:"title",component:h.Label},{key:"alreadyLbl",component:h.Label},{key:"supportLbl",component:h.Label},{key:"facebookBtn",component:h.UnspammableButton},{key:"signUpBtn",component:h.UnspammableButton},{key:"startOverBtn",component:h.UnspammableButton},{key:"supportBtn",component:h.UnspammableButton},{key:"alreadyDivLeftView",component:h.View},{key:"alreadyDivRightView",component:h.View},{key:"facebookIconImg",component:h.Image},{key:"facebookIconDivImg",component:h.Image},{key:"signUpIconImg",component:h.Image},{key:"signUpIconDivImg",component:h.Image},{key:"facebookBtnLbl",component:h.Label},{key:"signUpBtnLbl",component:h.Label},h.AddOrders.Generator("title","alreadyLbl","supportLbl","facebookBtn","signUpBtn","startOverBtn","supportBtn","alreadyDivLeftView","alreadyDivRightView","facebookIconImg","facebookBtnLbl","facebookIconDivImg","signUpIconImg","signUpBtnLbl","signUpIconDivImg"),{classname:"UpgradeUserCell",signUpWithFBCb:null,signUpWithEmailCb:null,startOverCb:null,facebookEnabled:null,initialize:function($super){$super({});this.facebookEnabled=b.Main._facebookEnabled&&(b.Main._facebookEnabled==="enabled"||b.Main._facebookEnabled===true);this._totalWidth=l.Capabilities.getScreenHeight();this._totalHeight=l.Capabilities.getScreenWidth();this._zeroCaseHeight=this._totalHeight*b.CommonElements.zeroCase.extras.heightFactor;b.ListViewCellStyles.UpgradeUserCell.applyTo(this);this.title.setText(b.LocText("Create your Mobage name to get the most out of Mobage games."));if(this.facebookEnabled){this.facebookBtnLbl.setText(b.LocText("Sign in with Facebook"))}this.facebookIconImg.setTouchable(false);this.facebookIconDivImg.setTouchable(false);this.facebookBtnLbl.setTouchable(false);this.signUpIconImg.setTouchable(false);this.signUpIconDivImg.setTouchable(false);this.signUpBtnLbl.setTouchable(false);this.signUpBtnLbl.setText(b.LocText("Sign Up with Email"));this.startOverBtn.setText(b.LocText("Start Over & Log In"));this.alreadyLbl.setText(b.LocText("Already have an account?"));this.supportLbl.setText(b.LocText("Questions? Contact")+" ");this.supportBtn.setText(b.LocText("Customer Support")+".");if(this.facebookEnabled){this.facebookBtn.onclick=this._facebookBtn_clickHandler.bind(this)}this.signUpBtn.onclick=this._signUpBtn_clickHandler.bind(this);this.startOverBtn.onclick=this._startOverBtn_clickHandler.bind(this);this.supportBtn.onclick=this._supportBtn_clickHandler.bind(this);if(!this.facebookEnabled){this.facebookBtn.setVisible(false);this.facebookIconImg.setVisible(false);this.facebookIconDivImg.setVisible(false);this.facebookBtnLbl.setVisible(false)}},layoutSubviews:function($super){if($super&&typeof $super==="function"){$super()}var O=new c(this.getFrame());if(O.isEmpty()){return}var o=0;var U=0;var z=O.w;var Z=O.h;var q=o+z;var X=U+Z;var I=(o+q)/2;var H=(U+X)/2;var ab=f.Window.getWidth();var ae=f.Window.getHeight();var L=(ab<ae?ab:ae)/480;var R=12*L;var u=R;var S=70*L;var T=370*L;var M=I-T/2;var v=340*L;var aa=50*L;var ad=10*L;var E=I-v/2;var K=u+S+ad;var Y;if(this.facebookEnabled){var V=K;var G=aa*0.55;var C=V+aa*0.25;var D=E+aa*0.25+4*L;var Q=V+7*L;var af=aa-12*L;var N=D+G+3*L;var W=N+2;var y=E+v-W;Y=V+aa+ad}else{Y=K}var F=aa*0.7;var ac=Y;var J=E+7*L;var A=Y+7*L;var x=aa-12*L;var B=J+F+4*L;var P=B+2;var t=E+v-P;var n=Y+aa+ad+20*L;var r=26*L;var w=n+r+ad;var p=26*L;var s=Z-p-R;this.title.setFrame([M,u,T,S]);if(this.facebookEnabled){this.facebookIconImg.setFrame([D,C,G,G]);this.facebookIconDivImg.setFrame([N,Q,2,af]);this.facebookBtn.setFrame([E,V,v,aa]);this.facebookBtnLbl.setFrame([W,V,y,aa])}this.signUpIconImg.setFrame([J,ac,F,aa]);this.signUpIconDivImg.setFrame([B,A,2,x]);this.signUpBtnLbl.setFrame([P,Y,t,aa]);this.signUpBtn.setFrame([E,Y,v,aa]);this.alreadyLbl.setFrame([o,n,z,r]);this.startOverBtn.setFrame([E,w,v,aa]);this.supportLbl.setFrame([o,s,z,p]);this.supportBtn.setFrame([o,s,z,p]);f.measureText(this.alreadyLbl.getText(),9000,9000,this.alreadyLbl.getStyle().getTextFont(),this.alreadyLbl.getStyle().getTextSize(),function(ag){var ak=330*L;var ai=16*L;var am=n+r/2-1;var al=(ak-ag.totalWidth-ai*2)/2;var aj=I-ak/2;var ah=I+ag.totalWidth/2+ai;this.alreadyDivLeftView.setFrame([aj,am,al,1]);this.alreadyDivRightView.setFrame([ah,am,al,1])}.bind(this));f.measureText(this.supportLbl.getText(),9000,9000,this.supportLbl.getStyle().getTextFont(),this.supportLbl.getStyle().getTextSize(),function(ag){f.measureText(this.supportBtn.getText()+" ",9000,9000,this.supportBtn.getStyle().getTextFont(),this.supportBtn.getStyle().getTextSize(),function(ai){var ah=ag.totalWidth+ai.totalWidth;var ak=I-ah/2;var aj=ak+ag.totalWidth;this.supportLbl.setFrame([ak,s,ag.totalWidth,p]);this.supportBtn.setFrame([aj-8,s-8,ai.totalWidth+16,p+16])}.bind(this))}.bind(this))},_facebookBtn_clickHandler:function(){if(typeof this.signUpWithFBCb=="function"){this.signUpWithFBCb()}},_signUpBtn_clickHandler:function(){if(typeof this.signUpWithEmailCb=="function"){this.signUpWithEmailCb()}},_startOverBtn_clickHandler:function(){if(typeof this.startOverCb=="function"){this.startOverCb()}},_supportBtn_clickHandler:function(){b.Destinations.pushScreen(b.ServiceHost.navController,"SupportWebScreen",{},this)}});var k=j.UpgradeUserListItem=f.ListViewItem.subclass({classname:"UpgradeUserListItem",_reuseId:"upgradeusercell",initialize:function($super){$super()},_signUpWithFBCb:null,_signUpWithEmailCb:null,_startOverCb:null,setSignUpWithFBCb:function(n){this._signUpWithFBCb=n;if(this.cell){this._onSetView(this.cell)}},setSignUpWithEmailCb:function(n){this._signUpWithEmailCb=n;if(this.cell){this._onSetView(this.cell)}},startOverCb:function(n){this._startOverCb=n;if(this.cell){this._onSetView(this.cell)}},_onCreateView:function(){return new g()},_onSetView:function(n){n.signUpWithFBCb=this._signUpWithFBCb;n.signUpWithEmailCb=this._signUpWithEmailCb;n.startOverCb=this._startOverCb;__ngs.r_(__ngs._9u).CommonElements.largeActionButton.applyTo(this);this.cell=n}});var e=j.UpgradeUserSection=m.subclass({classname:"UpgradeUserSection",item:null,initialize:function($super,n){$super();if(!this._items){this._items=[]}this.item=(new k());this.setItems([this.item]);this.currentListItem=this.item;return this},destroy:function(){},calculateRowHeightForListView:function(n){if(!n){return}var p=new c(n.getFrame());if(p.isEmpty()){return}var o=p.h/5;this.setRowHeight(o)}})}};__ngs._c2={_c:null,_d:function(){var f={exports:{}};var k=f.exports;this._c=f;var h=__ngs.r_(__ngs._59).UI;var d=h.ViewGeometry.Rect;var c=h.ViewGeometry.Scale;var b=new (__ngs.r_(__ngs._f).RequireLoader)({CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements}});var n=__ngs.r_(__ngs._77).Primitives;var r=__ngs.r_(__ngs._9i);var j=r.Components;var p=r.Component;var g=r.ComponentInheritForKey;var a=__ngs.r_(__ngs._9h).Composite;var l=__ngs.r_(__ngs._ao).CompositeButton;var e=k.UserIconView=n.Image.subclass({classname:"UserIconView",$Component:p(j.View,g(j.Image,"icon"),{initializeViewWithKey:function(s){this[s]=(new e()).retain()}}),initialize:function($super,s){$super(s);b.CommonElements.UserIconView.applyTo(this);return this},setUser:function(s){if(!s){this.setImage(null)}else{this.setImage(s.getDefinedIcon())}}});var m=k.TappableUserIconView=a({key:"content",component:e.Component,disableViewAccessorRemapping:true},j.AddOrders.One,j.Layouts.One,{classname:"TappableUserIconView",setImage:function(s){this.content.setImage(s)},setUser:function(s){this.content.setUser(s)}},l);var q=j.Layouts.TwoVerticalGenerator("content","label").layoutSubviews;var o=k.LabeledUserIconButton=a({key:"content",component:e.Component,disableViewAccessorRemapping:true},{key:"label",component:j.Label},j.AddOrders.Generator("content","label"),{classname:"LabeledUserIconView",initialize:function($super,s){$super(s);b.CommonElements.LabeledUserIconButton.applyTo(this);return this},setImage:function(s){this.content.setImage(s)},setText:function(s){if(!s){s=""}if(s.length>9){s=s.slice(0,8)+"…"}this.label.setText(s)},setUser:function(s){this._user=s;this.content.setUser(s);this.setText((s?s.gamertag:""))},layoutSubviews:function(){var s=new d(this.getFrame());if(s.isEmpty()){return}s.x=s.y=0;var t=s.h*b.CommonElements.LabeledUserIconButton.extras.labelHeightRatio;this.label.setFrameSize([s.w,t]);q.apply(this)}},l)}};__ngs._c3={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var g=__ngs.r_(__ngs._9i);var a=g.Components;var c=g.Component;var f=__ngs.r_(__ngs._59).UI;var e={textHeight:1/4};var h=b.VerticalLabelImageButton=f.Button.subclass({className:"VerticalLabelImageButton",sizeChanged:function(k,j){this.setTextGravity(f.ViewGeometry.Gravity.TopRight);this.setImageInsets(j*e.textHeight,0,0,0);this.setImageGravity(f.ViewGeometry.Gravity.BottomRight)}});b.VerticalLabelImageButtonComponent=c({initializeViewWithKey:function(j){this[j]=(new h()).retain()}})}};__ngs._c4={_c:null,_d:function(){var d={exports:{}};var h=d.exports;this._c=d;var a=__ngs.r_(__ngs._9h).Composite;var b=__ngs.r_(__ngs._9i);var j=b.Components;var l=b.Component;var f=b.ComponentInheritForKey;var g=b.ACCESSOR_PASSTHROUGH;var e=__ngs.r_(__ngs._59).UI;var k={imageRatio:1/2};var c=h.HorizontalLabelImage=a({key:"label",component:j.Label,disableViewAccessorRemapping:true},{key:"content",component:j.UnspammableButton,altKey:"icon",disableViewAccessorRemapping:true},j.AddOrders.Generator("label","content"),{classname:"HorizontalLabel_ImageButton",layoutSubviews:function(){var p=new e.ViewGeometry.Rect(this.getFrame());if(p.isEmpty()){return}p.x=p.y=0;var o=new e.ViewGeometry.Rect(this.getFrame());var n=o.w*k.imageRatio;o.x=p.w-n;o.w=n;o.y=0;o.inset.apply(o,this._insets.content);var m=new e.ViewGeometry.Rect(this.getFrame());m.x=0;m.y=0;m.w=p.w-n;m.inset.apply(m,this._insets.label);this.content.setFrame(o);this.label.setFrame(m)}});h.HorizontalLabel_ImageButtonComponent=l(j.View,f(j.Label,"label"),f(j.UnspammableButton,"icon"),{initializeViewWithKey:function(m){this[m]=(new c()).retain()},getIconInset:g,setIconInset:g,getLabelInset:g,setLabelInset:g})}};__ngs._c5={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._a3).ContentViewController;var d=a.AccordionCVC=c.subclass({classname:"AccordionCVC",loadView:function($super){$super();NgLogD("AccordionCVC/loadView end.")},batchChangeMode:false,_changedLayout:function(){if(!this.batchChangeMode){this.view().layoutSubviews()}},toggleExpandSectionAtIndex:function(e){var f=this.sectionAtIndex(e);if(!f){return}this.toggleExpandSectionByHeaderView(f.headerView)},toggleExpandSectionByHeaderView:function(e){var g=null;var h=this.view().getSections();var f;for(f in h){if(!h.hasOwnProperty(f)){continue}g=h[f];if(g.getTitleView()===e){break}}if(!g){this.logd("No section with that titleview!");return}g.setExpanded(!g.isExpanded);this._changedLayout(f)},removeSectionAtIndex:function(e,f){var g=this.view().getSections();g.splice(e,1);this.view().setSections(g,this.batchChangeMode||f);if(!f){this._changedLayout(e)}},insertSectionAtIndex:function(g,e){var f=this.view().content.indexOf(g);if(f!=-1){this.removeSectionAtIndex(f,true)}var h=this.view().getSections();h.splice(e,0,g);this.view().setSections(h,this.batchChangeMode);this._changedLayout(e)},sectionAtIndex:function(e){return this.view().getSections()[e]}})}};__ngs._c6={_c:null,_d:function(){var e={exports:{}};var h=e.exports;this._c=e;var f=__ngs.r_(__ngs._59).UI;var d=f.ViewGeometry.Rect;var c=f.ViewGeometry.Scale;var b=new (__ngs.r_(__ngs._f).RequireLoader)({AccordionTitleStyle:function(){return __ngs.r_(__ngs._cr).TitleStyle}});var j=__ngs.r_(__ngs._9h);var a=j.Composite;var l=__ngs.r_(__ngs._ao).ComponentsButton;var n=__ngs.r_(__ngs._9i);var g=n.Components;var m=n.Component;var k=h.AccordionTitleView=a({key:"content",component:g.Label,altKey:"main"},{key:"disclosure",component:g.Image},g.AddOrders.Generator("content","disclosure"),{classname:"AccordionTitleView",_insetRatio:0.1,_controller:null,$_layoutFunc:null,_expanded:false,initialize:function($super,p,o){this.expandedStateFlag=f.State.Selected;$super(p);this._controller=o;this._accessoryText="";this._baseText="";if(!k._layoutFunc){k._layoutFunc=g.Layouts.TwoHorizontalGenerator("content","disclosure").layoutSubviews}b.AccordionTitleStyle.applyTo(this);this.content.setFrameSize([300,30]);return this},destroy:function(){},layoutSubviews:function(){var o=new d(this.content.getFrame());if(o.isEmpty()){return}o.x=o.y=0;this.content.setFrame(o);var p=o.h*this._style.props().disclosure.insetRatio;this.setDisclosureInset([p,p,p,p]);this.getDisclosureView().setFrameSize([o.w*this._style.props().disclosure.widthRatio,o.h]);k._layoutFunc.call(this);this.setText(this._formattedTitle())},_formattedTitle:function(){return""+this._baseText+" ("+this._accessoryText+")"},_baseText:null,setTitle:function(o){this._baseText=o;this.content.setText(this._formattedTitle())},_accessoryText:null,setAccessoryText:function(o){this._accessoryText=o;this.content.setText(this._formattedTitle())}},l)}};__ngs._c7={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var g=__ngs.r_(__ngs._59).UI;var d=__ngs.r_(__ngs._60).Style;var b=__ngs.r_(__ngs._n).LocalizedString;var f=__ngs.r_(__ngs._79).MBListViewSection;var a=c.AccordionListSection=f.subclass({$rowsHiddenPlaceholder:null,classname:"AccordionListSection",isExpanded:null,hiddenItems:null,normalRowHeight:null,initialize:function($super,h){$super(h);if(!a.rowsHiddenPlaceholder){a.rowsHiddenPlaceholder=new (g.ListViewItem.subclass({classname:"AccordionListSectionRowShiddenPlaceholder",_reuseId:"accordionlistsection_rowshiddencell",initialize:function($super){$super();this.setMessage(b("Rows Hidden"))},_message:"",setMessage:function(j){this._message=j},_onCreateView:function(){return new g.CellView({})},_onSetView:function(j){j.setTitle(this._message);j.onclick=function(){this.logd("Rows Hidden Clicked!")};j.setState(g.State.Normal)}}))()}if(!this._items){this.logd("Adding the AccordionListSection hidden placeholder");this.setRowHeight(1);this.setItems([a.rowsHiddenPlaceholder]);this.hiddenItems=[];this.isExpanded=false}this.normalRowHeight=50;return this},destroy:function(){if(this.getTitleView()){this.getTitleView().release()}},setExpanded:function(k){if(k===this.isExpanded){return}var h,j;if(k){this.flush();this.setRowHeight(this.normalRowHeight);this.setItems(this.hiddenItems.slice());h=this.getTitleView();h.addState(h.expandedStateFlag);if(this._listView){this.logd("Setting Sections (empty)");this.logd("Setting Sections (full)");this.logd("ReloadData");this._listView.reloadData();this.logd("Post reloadData")}}else{h=this.getTitleView();h.clearState(h.expandedStateFlag);this.updateVisibleRange();this.flush();this.hiddenItems=this._items;this.setRowHeight(1);this.setItems([a.rowsHiddenPlaceholder]);if(this._listView){this.logd("Setting Sections (empty)");this.logd("Setting Sections (full)");this.logd("ReloadData");this._listView.reloadData();this.logd("Post reloadData")}}this.isExpanded=k},calculateRowHeightForListView:function(h){var j=h.getFrame()[3]/5;this.setRowHeight((this.isExpanded)?j:1)},calculateItemPositions:function($super){if(!this.__rowHeightInited&&this._listView){var h=new g.ViewGeometry.Rect(this._listView.getFrame());if(h.isEmpty()){return}this.normalRowHeight=h.h/5;if(this.isExpanded){this.setRowHeight(this.normalRowHeight)}this.__rowHeightInited=true}if($super){$super()}}})}};__ngs._c8={_c:null,_d:function(){var f={exports:{}};var b=f.exports;this._c=f;var h=__ngs.r_(__ngs._59).UI;var d=h.ViewGeometry.Rect;var e=__ngs.r_(__ngs._w).MessageListener;var c=__ngs.r_(__ngs._2z).Assets;var a=new (__ngs.r_(__ngs._f).RequireLoader)({CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements}});var g=b.PickableAvatar=h.CellView.subclass({classname:"PickableAvatar",_avatarImageListener:null,initialize:function($super,j){this._avatarImageListener=new e();this._user=j;this._user.addListener(this._avatarImageListener,this._userEmitHandler.bind(this));$super(undefined);this._avatarUploadingSpinner=(new h.Spinner()).retain();a.CommonElements.userPhoto.applyTo(this);this.setImage(this._user.getDefinedIcon())},layoutSubviews:function(){var n=this.getFrame();if(!n){return}if(this._ctaImage){var l=new d(n);l.x=l.y=0;var m=l.sliceVertical(-(l.h*1/4));m.inset(0,5,0,5);this._ctaImage.setFrame(m)}var j=n[2];var k=n[3];this._avatarUploadingSpinner.setFrame([j*0.3,k*0.3,j*0.4,k*0.4])},sizeChanged:function(){this.layoutSubviews()},destroy:function(){this._avatarUploadingSpinner.release();if(this._ctaImage){this._ctaImage.release()}if(this._user){this._user.removeListener(this._avatarImageListener);this._user=null;this._avatarImageListener=null}},setImage:function($super,j){$super(j);if(j.indexOf("000/000/001/small/1.png")!=-1){this._showCallToActionImage()}else{if(this._ctaImage){this._ctaImage.removeFromParent()}}},_showCallToActionImage:function(){if(!this._ctaImage){this._ctaImage=(new h.Image()).retain();this._ctaImage.setImage(c.image("default_avatar_calltoaction.png"))}this.addChild(this._ctaImage);this.layoutSubviews()},_userEmitHandler:function(k){if(k){for(var j in k){if(k.hasOwnProperty(j)){switch(j){case"uploadingPhoto":case"updatingAvatarImage":this.addChild(this._avatarUploadingSpinner);break;case"uploadingPhotoComplete":case"updatingAvatarImageComplete":this._avatarUploadingSpinner.removeFromParent();this.setImage(this._user.getDefinedIcon());break}}}}}})}};__ngs._c9={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var f=__ngs.r_(__ngs._6k).MobageStyle;var b=f.ScaledCorners;var g=f.ScaledTextSize;var a=__ngs.r_(__ngs._9u).CommonElements;var d=__ngs.r_(__ngs._2z).Assets;f.lazyLoad(c,"EditProfile",function(){return{children:{_viewHeader:{style:{gradient:{gradient:["FF143558 0.000","FF295D8D 1.000"]}}},_labelPageName:{style:{textFont:f.defaultBoldFontFace,textSize:g(14),textColor:"FFFFFFFF",textShadow:"33000000 1.0 {0.0,-2.0}",textGravity:[0,0]}},_buttonEdit:a.standardButton,_editNameAndMotto:{style:{gradient:{gradient:["FFDBE2EA 0.000","FFE9EFF3 1.000"],innerLine:"FFC9D1DA 1.0"}}},_labelFullName:{style:{textSize:g(12),textFont:f.defaultBoldFontFace,textGravity:[0,0]}},_firstNameEdit:a.textBox,_lastNameEdit:a.textBox,_labelAboutme:{style:{textSize:g(12),textFont:f.defaultBoldFontFace,textGravity:[0,0]}},_editMotto:{style:{gradient:{corners:b(6),gradient:["FFC9C9C9 0.000","FFEDEDED 1.000"],outerLine:"FF000000 2.0"},errorGradient:{corners:b(6),gradient:["FFC9C9C9 0.000","FFEDEDED 1.000"],outerLine:"FFFF0000 2.0"},textFont:f.defaultRegularFontFace,textColor:"FF000000",textSize:g(14),textGravity:[0,0]}},_buttonSaveChanges:a.standardButton,_buttonSupport:a.standardButton,_buttonLogout:a.standardButton,_footerArea:{style:{gradient:{gradient:["FFDBE2EA 0.000","FFE9EFF3 1.000"],innerLine:"FFC9D1DA 1.0"}}}},extras:{viewRatio:{viewHeaderX:0,viewHeaderY:0,viewHeaderH:0.119,avatarImageX:0.01,avatarImageY:0.13,avatarImageW:0.27,footerAreaX:0,footerAreaY:1,footerAreaH:0.208,avatarAreaX:0,avatarAreaY:0.07,avatarAreaW:0.3,labelPageName:[0.0188,0.03,0.675,0.125],avatarBtnEdit:[0.01,0.53,0.28,0.0958],labelFullName:[0.03,0.03,0.756,0.125],editFName:[0.03,0.1,0.455,0.2],editLName:[0.515,0.1,0.455,0.2],labelAboutMe:[0.03,0.32,0.756,0.125],editMotto:[0.03,0.395,0.94,0.425],buttonSaveChanges:[0.25,0.86,0.5,0.0958],buttonSupport:[0.02,0.0417,0.47,0.0958],buttonLogout:[0.51,0.0417,0.47,0.0958],buttonSupportFullSize:[0.02,0.0417,0.96,0.0958]}}}})}};__ngs._ca={_c:null,_d:function(){var c={exports:{}};var g=c.exports;this._c=c;var d=__ngs.r_(__ngs._59).UI;var b=d.ViewGeometry.Rect;var f=__ngs.r_(__ngs._c0).StringUtils;var k=__ngs.r_(__ngs._n).LocalizedString;var a=new (__ngs.r_(__ngs._f).RequireLoader)({OldStyle:function(){return __ngs.r_(__ngs._60).Style},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},Assets:function(){return __ngs.r_(__ngs._2z).Assets},BalanceButton:function(){return __ngs.r_(__ngs._85).BalanceButton},FullScreenEditor:function(){return __ngs.r_(__ngs._by).FullScreenEditor},PickableAvatar:function(){return __ngs.r_(__ngs._c8).PickableAvatar},Session:function(){return __ngs.r_(__ngs._o).Session},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},SpamProtection:function(){return __ngs.r_(__ngs._68)},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},UserInfoStyle:function(){return __ngs.r_(__ngs._cs).UserInfoStyle},ConversationWallView:function(){return __ngs.r_(__ngs._ct).ConversationWallView},Credentials:function(){return __ngs.r_(__ngs._2r).Credentials}});var e=g.UserInfoCell=d.View.subclass({classname:"UserInfoCell",_user:null,initialize:function($super,l){$super();this._hasGameCurrency=a.Session.getCurrentSession().hasGameCurrency();this._sizing=a.UserInfoStyle.extras;this._labelGamerTag=(new d.Label()).retain();this._labelName=(new d.Label()).retain();this._mottoAreaImage=(new d.Image()).retain();this._labelMotto=(new d.Label()).retain();this._mottoBtn=(new a.UnspammableButton()).retain();a.UserInfoStyle.applyTo(this);this.addChild(this._labelGamerTag);this.addChild(this._labelName);this._mottoBtn.setOnClick(this._mottoBtn_clickHandler.bind(this));this.updateUser(l)},destroy:function(){if(this._avatarPicker){this._avatarPicker.release()}if(this._staticAvatar){this._staticAvatar.release()}if(this._balanceButton){this._balanceButton.release()}if(this._addFriendButton){this._addFriendButton.release()}if(this._mottoEditor){this._mottoEditor.release()}this._labelGamerTag.release();this._labelName.release();this._mottoAreaImage.release();this._labelMotto.release();this._mottoBtn.release()},updateUser:function(l){this._user=l;this._isCurrentUser=a.Session.getCurrentSession().user().is(l);if(!this._user){return}if(this._isCurrentUser){if(this._staticAvatar){this._staticAvatar.removeFromParent()}if(!this._avatarPicker){this._avatarPicker=(new a.PickableAvatar(this._user)).retain();this._avatarPicker.onclick=this._avatarPicker_clickHandler.bind(this);this._avatarPicker.setStyle(new a.OldStyle())}this.addChild(this._avatarPicker)}else{if(this._avatarPicker){this._avatarPicker.removeFromParent()}if(!this._staticAvatar){this._staticAvatar=(new d.Image()).retain()}this._staticAvatar.setImage(this._user.getDefinedIcon());this.addChild(this._staticAvatar)}this._labelGamerTag.setText(this._user.gamertag);this._labelName.setText(this._user.getFullName());if(this._user.ageRestricted){this._mottoAreaImage.removeFromParent();this._labelMotto.removeFromParent()}else{this.addChild(this._mottoAreaImage);this.updateMotto(this._user.motto);this.addChild(this._labelMotto)}if(this._isCurrentUser){this.addChild(this._mottoBtn);if(this._addFriendButton){this._addFriendButton.removeFromParent()}if(this._hasGameCurrency){if(!this._balanceButton){this._balanceButton=(new a.BalanceButton()).retain()}this.addChild(this._balanceButton)}}else{this._mottoBtn.removeFromParent();if(this._balanceButton){this._balanceButton.removeFromParent()}if(!this._addFriendButton){this._addFriendButton=(new h()).retain();this._addFriendButton.setOnClick(this.addFriendBtn_clickHandler.bind(this));this._addFriendButton.setVisible(false)}this.addChild(this._addFriendButton);this._user.updateLocalRelation(function(){this._addFriendButton.updateButton(this._user)}.bind(this))}a.UserInfoStyle.applyTo(this);this.layoutSubviews()},layoutSubviews:function(){var u=new b(this.getFrame());if(u.isEmpty()){return}u.x=u.y=0;var p;var s=Math.min(this._sizing.avatarImageSizeFactor*u.w,u.h);var n=u.copy();var w=n.sliceHorizontal(-(u.w-s));var r=w.sliceVertical(u.h*this._sizing.gamertagHeightRatio);r.inset(0,0,0,u.w*this._sizing.gamertagLeftInsetRatio);this._labelGamerTag.setFrame(r);var q=w.sliceVertical(u.h*this._sizing.nameHeightRatio);q.inset(0,0,0,u.w*this._sizing.nameLeftInsetRatio);this._labelName.setFrame(q);var t=this._labelName.getStyle();if(t&&t.getTextFont&&t.getTextSize){d.measureText("x",100,100,t.getTextFont(),t.getTextSize(),function(A){q.h=A.height/A.lineWidths.length;this._labelName.setFrame(q)}.bind(this))}var l=w.sliceVertical(u.h*this._sizing.mottoHeightRatio);l.inset(0,u.w*this._sizing.mottoAreaRightInsetRatio,0,0);this._mottoAreaImage.setFrame(l);var m=[];for(p=0;p<this._sizing.mottoInsetRatios.length;p++){m.push(this._sizing.mottoInsetRatios[p]*(p%2?u.w:u.h))}l.inset.apply(l,m);this._labelMotto.setFrame(l);this._mottoBtn.setFrame(l);var y=(n.h-s)/2;var o=(n.w-s)/2;n.inset(0,o,y*2,o);var z=(s*this._sizing.avatarImageSpacerInsetRatio);n.inset(z);if(this._isCurrentUser){if(this._avatarPicker){this._avatarPicker.setFrame(n);this._avatarPicker.layoutSubviews()}}else{if(this._staticAvatar){this._staticAvatar.setFrame(n)}}if(this._isCurrentUser&&this._hasGameCurrency){var v=[];for(p=0;p<this._sizing.balanceButtonInsetRatios.length;p++){v.push(this._sizing.balanceButtonInsetRatios[p]*(p%2?w.w:w.h))}w.inset.apply(w,v);if(this._balanceButton){this._balanceButton.setFrame(w)}}else{var x=[];for(p=0;p<this._sizing.addFriendButtonInsetRatios.length;p++){x.push(this._sizing.addFriendButtonInsetRatios[p]*(p%2?u.w:u.h))}w.inset.apply(w,x);if(this._addFriendButton){this._addFriendButton.setFrame(w)}}},updateMotto:function(m){var l=m||"";if(f.trim(l).length===0){if(this._labelMotto){this._labelMotto.setState(d.State.Disabled);this._labelMotto.setTextSize(this._labelMotto.getStyle().getDisabledTextSize())}}else{if(this._labelMotto){this._labelMotto.setState(d.State.Normal);this._labelMotto.setTextSize(this._labelMotto.getStyle().getTextSize())}}if(this._labelMotto){this._labelMotto.setText(l)}},_mottoBtn_clickHandler:function(){var l=a.Session.getCurrentSession();if(l.user()&&l.user().usesGuestLogin()){a.Credentials.showRegistration(null,true,true,"tiered",null,"updateMotto");return}if(!this._mottoEditor){this._mottoEditor=(new MottoEditor(this._submitMotto.bind(this))).retain()}this._mottoEditor.show(this._user.motto)},_submitMotto:function(l){this.updateMotto(k("Saving..."));this._user.setMotto(l,function(m){if(m){a.UIUtils.showToast(k("Error Saving your status message: %1s",m))}this.updateMotto(this._user.motto)}.bind(this))},addFriendBtn_clickHandler:function(){var l=a.Session.getCurrentSession();if(l.user()&&l.user().usesGuestLogin()){a.Credentials.showRegistration(null,true,true,"tiered",null,"otherUserProfile_addFriend");return}if(this._user.localRelation==="friend"){NgLogD("UserProfile 'Add' button tapped on someone already your friend");return}this._addFriendButton.setPreparing(true);this._addFriendButton.updateButton(this._user);this._user.addAsBuddyAndUpdateLocalRelation(function(m){if(m){a.UIUtils.showToast(m)}this._addFriendButton.setPreparing(false);this._addFriendButton.updateButton(this._user)}.bind(this))},sizeChanged:function(){this.layoutSubviews()},_avatarPicker_clickHandler:function(){if(!a.SpamProtection.getSpamProtectionLockForName("avatarPicker").acquire()){return}if(typeof this._avatarImage_clickCb=="function"){this._avatarImage_clickCb()}},setAvatarImageOnClick:function(l){this._avatarImage_clickCb=l}});var h=a.AddFriendButton=a.UnspammableButton.subclass({classname:"AddFriendButton",_preparing:false,setPreparing:function(l){this._preparing=l},updateButton:function(l){if(a.Session.getCurrentSessionUser().isInviting(l)||this._preparing){if(l.localRelation==="follower"){this.setText(k("Accepting..."));this.setEnabled(false);this.setVisible(true)}else{this.setText(k("Sending Request..."));this.setEnabled(false);this.setVisible(true)}}else{if((l.invited&&!l.isMutualFriend)||l.localRelation==="requested"){this.setText(k("Request Sent"));this.setEnabled(false);this.setVisible(true)}else{if(l.isMutualFriend||l.localRelation==="friend"){this.setText("Friend!");this.setEnabled(false);this.setVisible(false)}else{if(l.localRelation==="follower"){this.setText(k("Accept"));this.setEnabled(true);this.setVisible(true)}else{if(l.localRelation==="stranger"){this.setText(k("Add User"));this.setEnabled(true);this.setVisible(true)}else{var m="Don't know how we got here..."+l.gamertag+" "+l.localRelation;NgLogE(m)}}}}}}});MottoEditor=a.FullScreenEditor.subclass({classname:"MottoEditor",_submitMottoCb:null,initialize:function($super,l){this._submitMottoCb=(typeof l=="function")?l:function(){};$super();this.view().field.focus();this.setMaxCharacters(140)},setup:function($super){$super(k("About me…"),k("Save"),this._submitMottoCb)}});var j=g.UserInfoListItem=d.ListViewItem.subclass({classname:"UserInfoListItem",_reuseId:"UserInfoListItem",initialize:function(l){this.user=l},updateUser:function(l){this.user=l;if(this.cell){this.cell.updateUser(l)}},addFriendBtn_clickHandler:function(){if(this.cell){this.cell.addFriendBtn_clickHandler()}},_onCreateView:function(){return new e(this.user)},_onSetView:function(l){this.cell=l;this.cell.updateUser(this.user);this.cell.setAvatarImageOnClick(this._avatarImage_clickCb)},_onReleaseView:function(l){this.cell=null},setAvatarImageOnClick:function(l){this._avatarImage_clickCb=l;if(this.cell){this.cell.setAvatarImageOnClick(this._avatarImage_clickCb)}}})}};__ngs._cb={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var f=__ngs.r_(__ngs._59).UI;var c=f.ViewGeometry.Rect;var a=new (__ngs.r_(__ngs._f).RequireLoader)({UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},HorizontalButtonStyle:function(){return __ngs.r_(__ngs._cu).HorizontalButtonStyle}});var g=b.HorizontalButtonCell=f.View.subclass({classname:"HorizontalButtonCell",initialize:function($super){$super();this._buttons=[];a.HorizontalButtonStyle.applyTo(this)},destroy:function(){this.clear()},addStandardButton:function(k,h){var j=(new a.UnspammableButton()).retain();a.HorizontalButtonStyle.children.standardButton.applyTo(j);j.setText(k);j.setOnClick(h);this.addChild(j);this._buttons.push(j)},layoutSubviews:function(){var n=new c(this.getFrame());if(n.isEmpty()){return}n.x=n.y=0;var h=[];for(var l=0;l<4;l++){h.push(a.HorizontalButtonStyle.extras.insetRatios[l]*n.w)}n.inset.apply(n,h);var k=0;for(l=0;l<this._buttons.length;l++){if(this._buttons[l].getEnabled()){k++}}var m=a.HorizontalButtonStyle.extras.spacerRatio*n.w;var o=((n.w-((k-1)*m))/k);for(l=0;l<this._buttons.length;l++){if(!this._buttons[l].getEnabled()){this._buttons[l].removeFromParent();continue}else{this.addChild(this._buttons[l])}var j=n.sliceHorizontal(o);this._buttons[l].setFrame(j);n.inset(0,0,0,m)}},clear:function(){for(var h=0;h<this._buttons.length;h++){this._buttons[h].release()}this._buttons=[]},setVisibleAtIndex:function(h,j){if(h>=0&&h<this._buttons.length){this._buttons[h].setEnabled(j);this.layoutSubviews()}},sizeChanged:function(){this.layoutSubviews()}});var e=b.HorizontalButtonListItem=f.ListViewItem.subclass({classname:"HorizontalButtonListItem",_reuseId:"HorizontalButtonListItem",initialize:function(){this._buttonInfoList=[];this._visibility=[]},_onCreateView:function(){return new g(this.user)},_onSetView:function(h){this.cell=h;this.cell.clear();for(var k=0;k<this._buttonInfoList.length;k++){var j=this._buttonInfoList[k];this.cell.addStandardButton(j[0],j[1],j[2]);this.cell.setVisibleAtIndex(k,this._visibility[k])}this.cell.layoutSubviews()},_onReleaseView:function(h){this.cell=null},addStandardButton:function(j,h){this._visibility[this._buttonInfoList.length]=true;this._buttonInfoList.push([j,h])},setVisibleAtIndex:function(h,j){this._visibility[h]=j;if(this.cell){this.cell.setVisibleAtIndex(h,j)}}})}};__ngs._cc={_c:null,_d:function(){var c={exports:{}};var f=c.exports;this._c=c;var b=__ngs.r_(__ngs._6k).MobageStyle;var d=b.ScaledCorners;var j=b.ScaledTextSize;var e=__ngs.r_(__ngs._2z).Assets;var a=new (__ngs.r_(__ngs._f).RequireLoader)({CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements}});b.lazyLoad(f,"GridPanelHeaderCell",function(){return{style:{gradient:{insets:"{0,-2,0,-2}",gradient:["FFDD 0.0","FFF8 1.0"],outerLine:"FFCC 1.0"}},children:{content:{style:{textSize:j(13),textFont:b.defaultRegularFontFace,textGravity:[0,0.5],textColor:"FF000000"}},button:a.CommonElements.standardButton},extras:{insetRatio:1/40,buttonWidthRatio:1/4}}});var g=f.FriendsGridPanelCell={numEntriesPerRow:5,insetRatios:[1/50,1/60,1/60,1/60],spacerRatio:1/40};var h=f.AchievementsGridPanelCell={numEntriesPerRow:3,insetRatios:[1/50,1/60,1/60,1/60],textInsetRatios:[1/6,0,0,0],imageInsetRatios:[0,0,1/8,0],spacerRatio:1/40,gradient:{corners:"0 0 0 0",gradient:["FF697D92 0.0","FF697D92 1.0"]},textColor:"ECEFF1"};b.lazyLoad(f,"RecentlyPlayedGamesGridPanelCell",function(){return{extras:{numEntriesPerRow:4,insetRatios:[1/40,1/40,1/60,1/40],spacerRatio:1/30,addGameImageBorder:{corners:d(20),innerShadow:"FF8093A6 1.0 {0.0,-2.0}",gradient:["FFB3C3CF 0.000","FFB3C3CF 1.000"],innerLine:"FFC9D1DA 1.0"}}}})}};__ngs._cd={_c:null,_d:function(){var c={exports:{}};var e=c.exports;this._c=c;var d=__ngs.r_(__ngs._59).UI;var b=__ngs.r_(__ngs._25).Rect;var g=__ngs.r_(__ngs._cv).GridPanel;var h=__ngs.r_(__ngs._n).LocalizedString;var a=new (__ngs.r_(__ngs._f).RequireLoader)({FriendsGridPanelItem:function(){return __ngs.r_(__ngs._cw).FriendsGridPanelItem},GridPanelHeaderItem:function(){return __ngs.r_(__ngs._cx).GridPanelHeaderItem},ZeroCaseSection:function(){return __ngs.r_(__ngs._a4).ZeroCaseSection},ZeroCaseMessageCell:function(){return __ngs.r_(__ngs._bw).ZeroCaseMessageCell},Session:function(){return __ngs.r_(__ngs._o).Session},FriendsGridPanelStyle:function(){return __ngs.r_(__ngs._cc).FriendsGridPanelCell},UserProfileStyle:function(){return __ngs.r_(__ngs._b0).UserProfileStyle}});var f=e.ZeroCaseLItem=d.ListViewItem.subclass({classname:"ZeroCaseLItem",_reuseId:"zerocase_messagecell",initialize:function($super){$super()},_texts:["","",""],_buttonCallback:null,_buttonEnabled:true,setZeroCaseTexts:function(k){this._texts=k;if(this.cell){this._onSetView(this.cell)}},setZeroCaseButtonCallback:function(k){this._buttonCallback=k;if(this.cell){this._onSetView(this.cell)}},setZeroCaseButtonEnabled:function(k){this._buttonEnabled=k;if(this.cell){this._onSetView(this.cell)}},_onCreateView:function(){return new a.ZeroCaseMessageCell()},_onSetView:function(k){k.setZeroCaseTexts(this._texts);k.setZeroCaseButtonCallback(this._buttonCallback);k.setZeroCaseButtonEnabled(this._buttonEnabled);__ngs.r_(__ngs._9u).CommonElements.largeActionButton.applyTo(this);k.setState(this._buttonEnabled?d.State.Normal:d.State.Disabled);this.cell=k}});var j=e.FriendsGridPanel=g.subclass({classname:"FriendsGridPanel",initialize:function($super,k){$super(k);this._defaultRowHeight=100;this._showHeader=true;this._headerRow=new a.GridPanelHeaderItem("ENGINEERING %1s's friends. (%2n)",this._header_onClick.bind(this));return this},createNewRowItem:function(){var k=new a.FriendsGridPanelItem();k.entryClicked=this._rowItem_onClick.bind(this);k.setHeight(this._defaultRowHeight);return k},viewportFrameChanged:function(n){this._viewportFrame=new b(n);if(this._viewportFrame.isEmpty()){return}var k=this._viewportFrame.h;this._defaultRowHeight=a.UserProfileStyle.friendsRowHeightRatio*k;if(this._pendingItem){this._pendingItem.setHeight(a.UserProfileStyle.pendingRowHeightRatio*k)}if(this._headerRow){this._headerRow.setHeight(a.UserProfileStyle.sectionHeaderHeightRatio*k)}if(this._customItem){this._customItem.setHeight(a.UserProfileStyle.zeroCaseItemHeightRatio*k)}var l=this.items||[];for(var m=0;m<l.length;m++){l[m].setHeight(this._defaultRowHeight)}},setHeaderText:function(k){this._headerRow.setTitleText(k)},setHeaderOnClick:function(k){this._header_clickCallback=k},_header_onClick:function(){if(typeof this._header_clickCallback=="function"){this._header_clickCallback()}},setRowItemOnClick:function(k){this._rowItem_clickCallback=k},_rowItem_onClick:function(k){if(typeof this._rowItem_clickCallback=="function"){this._rowItem_clickCallback(k)}},showZeroCaseMessage:function(){if(!this._zeroCaseItem){var k=this._zeroCaseItem=new f();k.setZeroCaseTexts([h("You don't have any Friends yet."),h("Have you tried scanning your contacts? People you know may already be on Mobage!"),h("Scan Contacts")]);k.setZeroCaseButtonCallback(this._zeroCaseItem_onClick.bind(this));this.showCustomMessage(k,a.UserProfileStyle.zeroCaseItemHeightRatio*this._viewportFrame.h)}this._showCustom=true},hideZeroCaseMessage:function(){this.hideCustomMessage()},setZeroCaseItemOnClick:function(k){this._zeroCaseItem_callback=k},_zeroCaseItem_onClick:function(){if(typeof this._zeroCaseItem_callback=="function"){this._zeroCaseItem_callback()}}})}};__ngs._ce={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var a=new (__ngs.r_(__ngs._f).RequireLoader)({PendingListItem:function(){return __ngs.r_(__ngs._9r).PendingLItem}});var b=__ngs.r_(__ngs._cy).ListViewItemController;var e=c.ListViewSectionController=b.subclass({classname:"ListViewSectionController",section:function(){if(!this._section){this.loadSection()}if(this._hideSection){return null}return this._section},setSection:function(f){f.retain();if(this._section){this._section.release()}this._section=f;this._section.controller=this;if(this._allItems){this._section.setItems(this._allItems)}},destroy:function(){if(this._section){this._section.release();this._section=null}},loadSection:function(){this.loge("Must implement in non-abstract subclass!")},items:function(){return this._items||[]},setItems:function(f){this._items=f||[];this.updateItems()},updateItems:function(){var g=[];if(this._showHeader&&this._headerRow){g.push(this._headerRow)}if(this._showPending&&this._pendingItem){g.push(this._pendingItem)}if(this._showCustom&&this._customItem){g.push(this._customItem)}g=g.concat(this._items||[]);if(this._showFooter&&this._footerRow){g.push(this._footerRow)}var h=false;if(!this._allItems){h=true}else{if(this._allItems.length!==g.length){h=true}}for(var f=0;f<g.length;f++){if(!g[f]._height){this.loge("Had to tweak height for item of type:",g[f].classname);g[f].setHeight(100)}if(!h&&g[f]!==this._allItems[f]){h=true}}if(h){this._allItems=g;if(this._section){this.logd("Calling setItems");this._section.setItems(g)}this.reloadList()}},hidePendingMessage:function(){this._showPending=false;if(this._pendingItem&&this._pendingItem.cell){this._pendingItem.cell.removeFromParent()}this.updateItems()},showPendingMessage:function(f){this._showPending=true;if(!this._pendingItem){this._pendingItem=new a.PendingListItem();this._pendingItem.setHeight(60)}this._pendingItem.setMessage(f);this.updateItems()},setHeaderRow:function(f){this._showHeader=true;this._headerRow=f;this.updateItems()},setFooterRow:function(f){this._showFooter=true;this._footerRow=f;this.updateItems()},hideCustomMessage:function(){this._showCustom=false;this.updateItems()},showCustomMessage:function(g,f){this._showCustom=true;this._customItem=g;if(!f){this.loge("The custom item height has to be specific when using it..")}this._customItem.setHeight(f);this.updateItems()},forceReloadList:function(){if(this._section&&this._section._listView){this._section._listView.reloadData()}}})}};__ngs._cf={_c:null,_d:function(){var c={exports:{}};var e=c.exports;this._c=c;var h=__ngs.r_(__ngs._5).Core;var d=__ngs.r_(__ngs._59).UI;var b=__ngs.r_(__ngs._4).Device;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Wall:function(){return __ngs.r_(__ngs._ch).Wall},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},Session:function(){return __ngs.r_(__ngs._o).Session},Destinations:function(){return __ngs.r_(__ngs._2a).Destinations},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics},ConversationWallView:function(){return __ngs.r_(__ngs._ct).ConversationWallView},PendingListSection:function(){return __ngs.r_(__ngs._9r).PendingListSection},DialogListItem:function(){return __ngs.r_(__ngs._cz).DialogListItem},MBListViewSection:function(){return __ngs.r_(__ngs._79).MBListViewSection},MorePostListItem:function(){return __ngs.r_(__ngs._cz).MorePostListItem},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils}});var g=__ngs.r_(__ngs._a3).ContentViewController;var l=__ngs.r_(__ngs._n).LocalizedString;var j=__ngs.r_(__ngs._w).MessageListener;var k=j.subclass({classname:"ConView_KeyListener"});var f=e.ConversationViewController=g.subclass({classname:"ConversationViewController",analyticsName:"WallConversation",mainSection:null,profileController:null,morePostSection:null,_hasMorePost:false,conversationsToShow:25,initialize:function($super){$super();this._headerStyle=__ngs.r_(__ngs._9u).CommonElements.header;this.mainSection=(new a.MBListViewSection()).retain();this.mainSection.setRowHeightRatio(1/4)},removeListener:function(){if(this.kListener){b.KeyEmitter.removeListener(this.kListener);this.kListener=undefined}},destroy:function(){this.mainSection.release();this.removeListener()},onKeyPressed:function(m){if(m.code===b.KeyEmitter.Keycode.back){this.backToProfile(true);return true}return false},loadView:function($super){if(!this._view){this.setView(new a.ConversationWallView())}$super();var m=this.view().getHeaderView();m.setFrameSize([100,100]);this._headerStyle.applyTo(m);m.button.setText(l("View Wall"));m.button.setFrameSize([100*(h.Capabilities.getScreenHeight()/480),100]);m.button.setOnClick(this.bind(function(){this.backToProfile(true)}));m.content.setText("ENGINEERING Conversation with someone.")},setConversationInfo:function(q,p){var r=this;this._conversation=q;this._user=p;this.view().layoutSubviews();this.updateConversationTitle();this.updateFooterSizing();this.updateHeaderHeight();this.kListener=new k();a.UnspammableButton.addDeviceKeyListener(this.kListener,this.onKeyPressed.bind(this),99999);this.loadConversation();var s=function(v){if((typeof v)!=="undefined"){if(!a.NetworkUtils.wasNetworkDown()){var u=(new d.AlertDialog()).retain();u.setTitle(l("Error"));u.setText(l("Error accessing system.  Please try again later. Error: %1s",v));u.setChoices([l("OK")]);u.onchoice=function(w){u.release();u=null};u.show()}}else{t.content.setText("");this.loadConversation(true)}}.bind(this);var t=this.view().getFooterView();var m=function(v){var u=/^\s*$/.test(v);return u};var o=90;t.submitButton.setOnClick(function(){var u=t.content.getText();if(!m(u)){u=u.substring(0,o);a.Wall.reply(p.recordID,q.conversationID,u,s,false)}}.bind(this));var n=null;t.content.setOnChange(function(){var u=t.content.getText();if(u.length>o&&n===null){n=(new d.AlertDialog()).retain();n.setTitle(l("Message too long"));n.setText(l("Only %1d characters are allowed. Extra characters will be truncated.",o));n.setChoices([l("OK")]);n.onchoice=function(v){n.release();n=null};n.show()}});this.view()._cancelCb=this.bind(function(u){this.view().footer.field.setText(u)});this.view()._postCb=this.zombieSafeCallback(function(u){this.view().footer.field.setText(u);if(!m(u)){a.Wall.reply(p.recordID,r._conversation.conversationID,u,s,false)}});if(h.Capabilities.isPlatformIOS()){this.view().useFullScreenEditor(true)}else{this.view().footer.getSubmitButtonView().setOnClick(function(){r.view()._postCb(r.view().footer.field.getText())})}},setPostingEnabled:function(m){this.view().setPostingEnabled(m)},setPostingDisabledOnClick:function(m){this.view().setPostingDisabledOnClick(m)},loadConversation:function(q){if(!this._pendingListSection){this._pendingListSection=new a.PendingListSection();this._pendingListSection.setPendingText(l("Getting the gossip..."))}this.view().setSections([this._pendingListSection]);var o=this._conversation;var r,n,m,p;m=[];var s=this.view().getHeaderHeight();a.Wall.posts(this._user.recordID,o.conversationID,this.conversationsToShow,function(x,t){var y=0;this.convoIndex=0;if(x){if(!this._errorSection){this._errorSection=(new a.PendingListSection()).retain()}this._errorSection.showError(x);this.view().setSections([this._errorSection]);console.log("Wall.posts Got Error",JSON.stringify(x))}else{for(var v=0;v<t.length;v++){r=t[v];var u=null;if(this._user.gamertag===r.author_gamertag){u=function(){this.backToProfile(true)}.bind(this)}else{u=this._jumpToUserProfile.bind(this)}if(v>0){m.push(new a.DialogListItem(r,v>0,this._user,v,s,this.view().getContentView(),u,o.conversationID,this.loadConversation.bind(this)))}else{m.push(new a.DialogListItem(r,v>0,this._user,v,s,this.view().getContentView(),u,o.conversationID,function(){this.backToProfile(true)}.bind(this)))}}for(v=0;v<m.length;v++){m[v].odd=(v)%2}this.convoIndex=this.convoIndex+this.conversationsToShow;this.morePostSection=new a.MBListViewSection();this.morePostSection.setRowHeightRatio(1/8);this.morePostSection.setItems(new a.MorePostListItem(this.bind(function(){m=[];this.convoIndex=this.convoIndex+this.conversationsToShow;a.Wall.posts(this._user.recordID,o.conversationID,this.convoIndex,function(C,z){if((typeof C)!=="undefined"){if(!this._errorSection){this._errorSection=(new a.PendingListSection()).retain()}this._errorSection.showError(C);this.view().setSections([this._errorSection])}else{for(var A=0;A<z.length;A++){r=z[A];m.push(new a.DialogListItem(r,A>0,this._user,A,s,this.view().getContentView(),u,o.conversationID,this.loadConversation.bind(this)))}}this.mainSection.setItems(m);if(this.convoIndex==((z.length))){this.view().setSections([this.mainSection,this.morePostSection])}else{this.view().setSections([this.mainSection])}if(q){var B=Math.max(0,(m.length+1)*this.mainSection.getRowHeight()-this.view().getFrame()[3]);this.view().setScrollPosition(0,B)}}.bind(this))})));this.mainSection.setItems(m);if(this.convoIndex==((t.length))){this.view().setSections([this.mainSection,this.morePostSection])}else{this.view().setSections([this.mainSection])}if(q){var w=Math.max(0,(m.length+1)*this.mainSection.getRowHeight()-this.view().getFrame()[3]);this.view().setScrollPosition(0,w)}else{this.view().setScrollPosition(0,0)}}}.bind(this))},updateHeaderHeight:function(){var r=this.view().getHeaderView();var m=r.content;var q=m.getText();var n=function(w){var y=m.getFrame();var C=r.getFrame();var u=this._headerStyle.extras.headerHeightRatio*this.view().getFrame()[3];var s=w.lineWidths.length;var v=w.height;var B=v/s;var x=u+(s-1)*B;y[3]=v;C[3]=x;r.setFrame(C);m.setFrame(y);var A=this.view().getFooterView().getFrame();var z=this.view().getContentView();var t=z.getFrame();t[1]=C[1]+C[3];t[3]=A[1]-t[1];z.setFrame(t)}.bind(this);var p=m.getStyle();var o=m.getFrameSize()[0];d.measureText(q,o,1000,p.getTextFont(),p.getTextSize(),n)},updateFooterSizing:function(){var m=this.view().getFooterView().getFrameSize();this.view().getFooterView().submitButton.setFrameSize([m[0]/6,m[1]])},updateConversationTitle:function(){this.view().getHeaderView().content.setText(l("Conversation with %1s",this._conversation.author_gamertag))},backToProfile:function(m,n){if(!a.ServiceHost.isMenuDrawerClosedOrClosing()){a.ServiceHost.closeMenuDrawer();return}this.removeListener();this.swapViews(this.view(),this.profileController.view(),true);if(!n){a.MobageAnalytics.logNavEvent(this,this.profileController)}this.profileController._showingConversationWall=false;if(m&&this.wallController){this.wallController.loadData()}a.ServiceHost.setBackButtonFunction();if(this.wallClosedCB){this.wallClosedCB()}},_jumpToUserProfile:function(m){this.removeListener();if(m.is(a.Session.getCurrentSession().user())&&this.profileController.classname==="CurrentUserProfileController"){this.backToProfile(true)}else{if(m.gamertag===a.Session.getCurrentSession().user().gamertag){a.Destinations.pushScreen(a.ServiceHost.navController,"MyPage",{tab:"profile"},this.parentController)}else{a.Destinations.pushScreen(a.ServiceHost.navController,"UserProfilePage",{user:m},this.parentController)}}}})}};__ngs._cg={_c:null,_d:function(){var g={exports:{}};var d=g.exports;this._c=g;var h=__ngs.r_(__ngs._d0).InteractiveListViewSection;var c=__ngs.r_(__ngs._n).LocalizedString;var f=__ngs.r_(__ngs._25).Rect;var e=function(k,j){return(k.x==j.x&&k.y==j.y&&k.w==j.w&&k.h==j.h)};var b=new (__ngs.r_(__ngs._f).RequireLoader)({WallSectionHeaderItem:function(){return __ngs.r_(__ngs._co).WallSectionHeaderItem},WallSectionFooterItem:function(){return __ngs.r_(__ngs._co).WallSectionFooterItem},WallConversationItem:function(){return __ngs.r_(__ngs._co).WallConversationItem},WallCmdViewController:function(){return __ngs.r_(__ngs._d1).WallCmdViewController},Session:function(){return __ngs.r_(__ngs._o).Session},UserProfileStyle:function(){return __ngs.r_(__ngs._b0).UserProfileStyle}});var a=d.WallListViewSection=h.subclass({classname:"WallListViewSection",maxMsgCount:0,_defaultRowHeight:0,_hasMorePost:false,_footerMorePosts_callback:null,initialize:function($super,j){$super(j);this.setRowHeight(-1);this._headerRow=new b.WallSectionHeaderItem();this._headerRow.setOnClick(this._headerPostMessage_clickHandler.bind(this));this._headerRow.setPostingDisabledOnClick(this._headerPostingDisabled_clickHandler.bind(this));this._headerRow.maxLength=90;this._headerRow.setPostingEnabled(false);this._footerRow=new b.WallSectionFooterItem();this._footerRow.setOnClick(this._footerMorePosts_clickHandler.bind(this))},setConversationData:function(n,k){this._user=k;this._isCurrentUser=b.Session.getCurrentSession().user().is(k);this._headerRow.setUser(this._user);this._headerRow.setPlaceholder(this._isCurrentUser?c("What's happening?"):c("What are you playing?"));var j=[];this._hasMorePost=false;for(var l=0;l<n.length;l++){if(l===this.maxMsgCount){this._hasMorePost=true;break}var m=new b.WallConversationItem(this,this._user,n[l]);m.setRowOnTapped(this._row_tapHandler.bind(this));m.setAvatarTapped(this._avatar_tapHandler.bind(this));m.setAccessoryBtnOnClick(this._showCommandPopOver_callback.bind(this));m.setHeight(this._defaultRowHeight||100);m.odd=l%2;j.push(m)}this._showHeader=true;this._showFooter=this._hasMorePost;this.setItems(j);this._applyViewportFrame()},viewportFrameChanged:function(k){var j=new f(k);if(j.isEmpty()){return}if(!this._viewportFrame||e(this._viewportFrame,j)){this._viewportFrame=j;this._applyViewportFrame()}},_applyViewportFrame:function(){if(!this._viewportFrame||this._viewportFrame.isEmpty()){return}this._defaultRowHeight=b.UserProfileStyle.wallRowHeightRatio*this._viewportFrame.h;if(this._pendingItem){this._pendingItem.setHeight(b.UserProfileStyle.pendingRowHeightRatio*this._viewportFrame.h)}if(this._headerRow){this._headerRow.setHeight(b.UserProfileStyle.wallHeaderHeightRatio*this._viewportFrame.h)}if(this._footerRow){this._footerRow.setHeight(b.UserProfileStyle.morePostsHeightRatio*this._viewportFrame.h)}var j=this.items||[];for(var k=0;k<j.length;k++){j[k].setHeight(this._defaultRowHeight)}},setHeaderPostMessageOnClick:function(j){this._headerPostMessage_callback=j},_headerPostMessage_clickHandler:function(j){console.log("WallListViewSection._headerPostMessage_clickHandler");if(typeof this._headerPostMessage_callback=="function"){console.log("call callback");this._headerPostMessage_callback(j)}},setHeaderPostingDisabledOnClick:function(j){this._headerPostingDisabled_callback=j},_headerPostingDisabled_clickHandler:function(){if(typeof this._headerPostingDisabled_callback=="function"){this._headerPostingDisabled_callback()}},setFooterMorePostsOnClick:function(j){this._footerMorePosts_callback=j},_footerMorePosts_clickHandler:function(){if(typeof this._footerMorePosts_callback=="function"){this._footerMorePosts_callback()}},setPostingEnabled:function(j){this._headerRow.setPostingEnabled(j)},setPostingMessageFocus:function(){this._headerRow.setPostingMessageFocus()},setPostingMessageBlur:function(){this._headerRow.setPostingMessageBlur()},setRowOnTap:function(j){this._row_callback=j},_row_tapHandler:function(j){if(typeof this._row_callback=="function"){this._row_callback(j)}},setRowAvatarOnTap:function(j){this._row_avatar_tapCallback=j},_avatar_tapHandler:function(j){if(typeof this._row_avatar_tapCallback=="function"){this._row_avatar_tapCallback(j)}},_showCommandPopOver_callback:function(l,s,o){var m=s.getFrame().slice();var r=s.accessoryButton.getFrame()[1];var n=s.accessoryButton.getFrame()[3];m[0]+=n/3;var j=(n/7.3)*s.accessoryButton.label.getText().length;m[0]-=j;var k=(n/2)+j;var q=this._listView;if(q){var p=new f(m);p.y+=r+n/2;p.y+=n*(0.2);p.y-=q.getScrollPosition()[1];m=p.array()}console.log("_showCommandPopOver newFrame",m);var t=new b.WallCmdViewController(l,o,m,this._wallCmdView_invalidateHandler.bind(this),this._wallCmdView_pushHandler.bind(this),k,true)},setWallCmdViewOnInvalidate:function(j){this._wallCmdView_invalidateCallback=j},_wallCmdView_invalidateHandler:function(){if(typeof this._wallCmdView_invalidateCallback=="function"){this._wallCmdView_invalidateCallback()}},setWallCmdViewOnPush:function(j){this._wallCmdView_pushCallback=j},_wallCmdView_pushHandler:function(k,j){if(typeof this._wallCmdView_pushCallback=="function"){this._wallCmdView_pushCallback(k)}}})}};__ngs._ch={_c:null,_d:function(){var c={exports:{}};var e=c.exports;this._c=c;var g=__ngs.r_(__ngs._5).Core;var d=__ngs.r_(__ngs._59).UI;var j=__ngs.r_(__ngs._n).LocalizedString;var b=__ngs.r_(__ngs._28);var h=__ngs.r_(__ngs._30);var f=function(m){var l=m;m=[];for(var k=0;k<l.length;k++){if(l[k]){m.push(l[k])}}};var a=e.Wall=g.Class.subclass({$MAX_MSG_COUNT:4,$create:function(l,k){},$delete:function(l,k){},$showProgress:function(l){var k=(new d.ProgressDialog()).retain();k.setText(l);k.show();return k},$stopProgress:function(k){if(k){k.hide();k.release();k=undefined}},$posts:function(m,o,l,k){k=k||b.PlusRequest.noOp;var n=new b.PlusRequest();n.setPostBody({count:l});this.apiMethod="users/"+m+"/conversations/"+o;n.setApiMethod(this.apiMethod);n.setHttpMethod("GET");n.send(function(s,u,p,t){NgLogD("wall conversations error :"+JSON.stringify(s));NgLogD("wall conversations respond: "+JSON.stringify(u));var q=new Array();var r=s;if((!s)&&u&&(!u.success)){r=u.error_msg}if(!r){var z=u.posts;for(var v=0;v<z.length;v++){var w=0;var x=false;var y=z[v];if(y.author){w++;h.User.getUserWithID(y.author,function(B,A){w--;if(!B){y.user=A;q.push(y)}else{console.log("Wall encountered error trying to fill in posts. Skipping.")}if(x&&!w){k(null,q)}})}}x=true;if(!w){k(null,q)}}else{k(r,q)}})},$postsAppend:function(m,o,l,k){k=k||b.PlusRequest.noOp;var n=new b.PlusRequest();n.setPostBody({after:l,count:5});this.apiMethod="users/"+m+"/conversations/"+o;n.setApiMethod(this.apiMethod);n.setHttpMethod("GET");n.send(function(s,v,p,t){NgLogD("wall conversations error :"+JSON.stringify(s));NgLogD("wall conversations respond: "+JSON.stringify(v));var q=new Array();var r=s;if((!s)&&v&&(!v.success)){r=v.error_msg}if(!r){var w=0;var x=false;var z=v.posts;for(var u=0;u<z.length;u++){var y=z[u];if(y.author){w++;h.User.getUserWithID(y.author,function(B,A){w--;if(!B){y.user=A;q.push(y)}else{console.log("Wall encountered error trying to fill in posts. Skipping.")}if(x&&!w){k(null,q)}})}}x=true;if(!w){k(null,q)}}else{k(s,q)}})},$list:function(m,o,k,l){k=k||b.PlusRequest.noOp;var n=new b.PlusRequest();if(m&&l){this.apiMethod="users/"+m+"/games/"+l+"/conversations"}else{if(m){this.apiMethod="users/"+m+"/conversations"}else{if(l){this.apiMethod="games/"+l+"/conversations"}}}if(o){this.apiMethod+="?count="+o}n.setApiMethod(this.apiMethod);n.setHttpMethod("GET");n.send(function(t,w,q,u){NgLogD("wall conversations error :"+JSON.stringify(t));NgLogD("wall conversations respond: "+JSON.stringify(w));var r=new Array();var s=t;if((!t)&&w&&(!w.success)){s=w.error_msg}if(!s){var x=w.conversations;var y=0;var A=false;var z=function(C){var E=x[C];var D=E.posts[0];h.User.getUserWithID(D.author,function(G,F){y--;if(!G){D.user=F;r[C]=D}else{console.log("Wall encountered error trying to fill in posts. Skipping.")}if(A&&!y){f(r);k(null,r)}})};for(var v=0;v<x.length;v++){var p=x[v];var B=p.posts[0];B.conversationID=p.id;if(B.author){y++;z(v)}B.total=p.total}A=true;if(!y){f(r);k(null,r)}}else{f(r);k(t,r)}})},$postMsg:function(m,r,k,q,l){k=k||b.PlusRequest.noOp;var p=a.showProgress(j("Posting…"));if(q===true){this.apiMethod="users/"+m+"/private_conversations"}else{if(m&&l){this.apiMethod="users/"+m+"/games/"+l+"/conversations"}else{if(m){this.apiMethod="users/"+m+"/conversations"}else{this.apiMethod="games/"+l+"/conversations"}}}var o=new b.PlusRequest();o.setApiMethod(this.apiMethod);o.setHttpMethod("POST");var n={};n.message=r;o.setPostBody(n);NgLogD("posting message:"+JSON.stringify(n));o.send(function(t,v,w,s){a.stopProgress(p);var u=t;if((!t)&&v&&(!v.success)){u=v.error_msg}NgLogD("post conversation err: "+u);NgLogD("post conversation data: "+JSON.stringify(v));k(u,v)})},$reply:function(l,p,r,k,q){k=k||b.PlusRequest.noOp;var o=a.showProgress(j("Posting ..."));if(q===true){this.apiMethod="users/"+l+"/private_conversations/"+p}else{this.apiMethod="users/"+l+"/conversations/"+p}var n=new b.PlusRequest();n.setApiMethod(this.apiMethod);n.setHttpMethod("PUT");var m={};m.message=r;n.setPostBody(m);NgLogD("xxx message:"+JSON.stringify(m));n.send(function(t,u,v,s){a.stopProgress(o);NgLogD("xxx put conversation err: "+JSON.stringify(t));NgLogD("xxx put conversation data: "+JSON.stringify(u));k(t)})},$deleteConversation:function(l,o,p,k){k=k||b.PlusRequest.noOp;var n=a.showProgress(j("Deleting ..."));NgLogD("delete conversationID : "+o);if(p===true){this.apiMethod="users/"+l+"/private_conversations/"+o}else{this.apiMethod="users/"+l+"/conversations/"+o}var m=new b.PlusRequest();m.setApiMethod(this.apiMethod);m.setHttpMethod("DELETE");m.send(function(r,s,t,q){a.stopProgress(n);NgLogD("delete conversation err: "+r);k(r)})},$deletePost:function(m,p,l,k){k=k||b.PlusRequest.noOp;var o=a.showProgress(j("Deleting ..."));this.apiMethod="users/"+m+"/conversations/"+p+"/posts/"+l;var n=new b.PlusRequest();n.setApiMethod(this.apiMethod);n.setHttpMethod("DELETE");n.send(function(r,s,t,q){a.stopProgress(o);NgLogD("delete conversation err: "+r);k(r)})}})}};__ngs._ci={_c:null,_d:function(){var g={exports:{}};var c=g.exports;this._c=g;var h=__ngs.r_(__ngs._59).UI;var d=__ngs.r_(__ngs._25).Rect;var f=__ngs.r_(__ngs._cv).GridPanel;var b=__ngs.r_(__ngs._n).LocalizedString;var a=new (__ngs.r_(__ngs._f).RequireLoader)({RecentlyPlayedGamesGridPanelItem:function(){return __ngs.r_(__ngs._d2).RecentlyPlayedGamesGridPanelItem},GridPanelHeaderItem:function(){return __ngs.r_(__ngs._cx).GridPanelHeaderItem},UserProfileStyle:function(){return __ngs.r_(__ngs._b0).UserProfileStyle}});var e=c.RecentlyPlayedGamesGridPanel=f.subclass({classname:"RecentlyPlayedGamesGridPanel",initialize:function($super,j){$super(j);this._defaultRowHeight=100;this._showHeader=true;this._headerRow=new a.GridPanelHeaderItem("ENGINEERING %1s's games",this._header_onClick.bind(this));return this},createNewRowItem:function(){var j=new a.RecentlyPlayedGamesGridPanelItem();j.entryClicked=this._rowItem_onClick.bind(this);j.setHeight(this._defaultRowHeight);return j},viewportFrameChanged:function(m){this._viewportFrame=new d(m);if(this._viewportFrame.isEmpty()){return}var j=this._viewportFrame.h;this._defaultRowHeight=a.UserProfileStyle.friendsRowHeightRatio*j;if(this._pendingItem){this._pendingItem.setHeight(a.UserProfileStyle.pendingRowHeightRatio*j)}if(this._headerRow){this._headerRow.setHeight(a.UserProfileStyle.sectionHeaderHeightRatio*j)}var k=this.items||[];for(var l=0;l<k.length;l++){k[l].setHeight(this._defaultRowHeight)}},setHeaderText:function(j){this._headerRow.setTitleText(j)},setHeaderOnClick:function(j){this._header_clickCallback=j},_header_onClick:function(){if(typeof this._header_clickCallback=="function"){this._header_clickCallback()}},setRowItemOnClick:function(j){this._rowItem_clickCallback=j},_rowItem_onClick:function(j){if(typeof this._rowItem_clickCallback=="function"){this._rowItem_clickCallback(j)}}})}};__ngs._cj={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var f=__ngs.r_(__ngs._6k).MobageStyle;var b=f.ScaledCorners;var g=f.ScaledTextSize;var d=__ngs.r_(__ngs._2z).Assets;var a=__ngs.r_(__ngs._9u).CommonElements;f.lazyLoad(c,"RegistrationContainer",function(){return{children:{backgroundView:{style:{gradient:{gradient:["CC000000 0.000","CC000000 1.000"]}}},backgroundMatte:{style:{imageFit:5,imageGravity:[0.5,1]}},closeBtn:a.grayButton}}});f.lazyLoad(c,"RegistrationCommon",function(){return{children:{containerMainContainerView:{style:{gradient:{corners:b(6),outerLine:"FF08418D 3.0"}}},containerHeaderAreaView:{style:{gradient:{corners:"10.0 10.0 0.0 0.0",gradient:["FF05284D 0.000","FF021A36 1.000"]}}},containerButtonAreaView:{style:{gradient:{corners:"0.0 0.0 10.0 10.0",gradient:["FFFFFFFF 0.000"]}}},containerButtonAreaBorderView:{style:{gradient:{gradient:["FFE6EDF5 0.000"]}}},titleLbl:{style:{textFont:f.defaultBoldFontFace,textSize:g(22),textColor:"FFFFFFFF",textInsets:[10,0,10,0],textGravity:[0.5,0.5]}},headerImg:{style:{image:d.image("O-LoRes.png"),imageFit:6,imageGravity:[0,1]}}}}});f.lazyLoad(c,"RegistrationStart",function(){return{children:{containerGuestOuterLayerView:{style:{gradient:{corners:b(6),gradient:["66000000 0.000"]}}},containerMainContainerView:{style:{gradient:{corners:b(6),outerLine:"FF08418D 3.0"}}},containerHeaderAreaView:{style:{gradient:{corners:"10.0 10.0 0.0 0.0",gradient:["FF05284D 0.000","FF021A36 1.000"]}}},containerButtonAreaView:{style:{gradient:{corners:"0.0 0.0 10.0 10.0",gradient:["FFFFFFFF 0.000"]}}},containerButtonAreaBorderView:{style:{gradient:{gradient:["FFE6EDF5 0.000"]}}},titleImg:{style:{image:d.image("mobage_logo.png"),imageFit:6}},subtitleLbl:{style:{textFont:f.defaultBoldFontFace,textSize:g(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5]}},facebookIconImg:{style:{image:d.image("registration_icon_facebook.png"),imageFit:6,imageGravity:[0.5,0.5]}},facebookIconDivImg:{style:{image:d.image("FB-Email-Divider-line.png"),imageFit:6,imageGravity:[0.5,0.5]}},facebookBtnLbl:{style:{textFont:f.defaultBoldFontFace,textColor:"FFFFFFFF",textSize:g(16),textGravity:[0.5,0.5]}},facebookBtn:{style:{image:d.image("registration_button_facebook.png"),pressedImage:d.image("registration_button_facebook_down.png"),imageFit:3,imageGravity:[0,0]}},facebookDescLbl:{style:{textFont:f.defaultRegularFontFace,textColor:"FF999999",textSize:g(12),textGravity:[0.5,0.5]}},facebookOrLbl:{style:{textFont:f.defaultRegularFontFace,textColor:"FF999999",textSize:g(12),textGravity:[0.5,0.5]}},facebookOrDivLeftView:{style:{gradient:{gradient:["FF999999 0.000"]}}},facebookOrDivRightView:{style:{gradient:{gradient:["FF999999 0.000"]}}},loginBtn:{style:{gradient:{corners:b(8),gradient:["FF76b332 0.0","FF56912b 1.0"]},pressedGradient:{corners:b(8),gradient:["FF56912b 0.000","FF76b332 1.000"],innerShadow:"23000000 1.0 {0.0,-2.0}"},textFont:f.defaultBoldFontFace,textSize:g(16),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}},signUpBtn:a.blueButton,guestDescLbl:{style:{textFont:f.defaultRegularFontFace,textColor:"FFFFFFFF",textSize:g(12),textGravity:[0,0.5]}},playAsGuestBtn:{style:{gradient:{corners:b(8),gradient:["FF838d93 0.000","FF767c82 1.000"],innerLine:"44acbac0 2.0"},pressedGradient:{corners:b(8),gradient:["FF767c82 0.000","FF838d93 1.000"],innerLine:"44acbac0 2.0"},textFont:f.defaultBoldFontFace,textSize:g(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}}}}});f.lazyLoad(c,"RegistrationSignUp",function(){return{children:{emailInput:a.textBox,passwordInput:a.textBox,backBtn:a.grayButton,signUpBtn:a.blueButton,termsAndLbl:{style:{textFont:f.defaultRegularFontFace,textSize:g(12),textColor:"FF999999",textGravity:[0.5,0.5]}},termsLineLbl:{style:{textFont:f.defaultRegularFontFace,textSize:g(12),textColor:"FF999999",textGravity:[0.5,0]}},termsLink1Btn:{style:{textFont:f.defaultRegularFontFace,textSize:g(12),textColor:"FF266A9F",textGravity:[0.5,0.5],pressedGradient:{corners:b(8),gradient:["33000000 0.000"]}}},termsLink2Btn:{style:{textFont:f.defaultRegularFontFace,textSize:g(12),textColor:"FF266A9F",textGravity:[0.5,0.5],pressedGradient:{corners:b(8),gradient:["33000000 0.000"]}}}}}});f.lazyLoad(c,"RegistrationLogin",function(){return{children:{emailInput:a.textBox,passwordInput:a.textBox,backBtn:a.grayButton,loginBtn:a.blueButton,forgotPassLink:{style:{textFont:f.defaultRegularFontFace,textSize:g(14),textColor:"FF266A9F",textGravity:[0.5,0.5],pressedGradient:{corners:b(8),gradient:["33000000 0.000"]}}}}}});f.lazyLoad(c,"RegistrationFBConfirm",function(){return{children:{confirmDescLbl:{style:{textFont:f.defaultRegularFontFace,textSize:g(14),textColor:"FF000000",textGravity:[0,0.5]}},confirmUserGamertagLbl:{style:{textFont:f.defaultBoldFontFace,textSize:g(14),textColor:"FF000000",textGravity:[0,0.5]}},confirmUserRealNameLbl:{style:{textFont:f.defaultRegularFontFace,textSize:g(14),textColor:"FF000000",textGravity:[0,0.5]}}}}});f.lazyLoad(c,"RegistrationFinish",function(){return{children:{regDesc1Lbl:{style:{textFont:f.defaultBoldFontFace,textSize:g(14),textColor:"FF000000",textGravity:[0.5,0.5]}},regDesc2Lbl:{style:{textFont:f.defaultRegularFontFace,textSize:g(14),textColor:"FF000000",textGravity:[0.5,0.5]}},gamertagInput:a.textBox,gamertagInputImage:{style:{imageFit:1,imageGravity:[1,0.5],imageInsets:[15,15,15,15]}},checkBox:a.checkBox,checkTxt:{style:{textFont:f.defaultRegularFontFace,textSize:g(14),textColor:"FF000000",textGravity:[0,0.5]}},saveBtn:a.greenButton}}});f.lazyLoad(c,"RegistrationFBFinish",function(){return{children:{linkFBTitle:{style:{textFont:f.defaultBoldFontFace,textSize:g(12),textColor:"FF000000",textGravity:[0.5,0]}},linkFBTxt:{style:{textFont:f.defaultRegularFontFace,textSize:g(12),textColor:"FF266A9F",textGravity:[0.5,0.5],pressedGradient:{corners:b(8),gradient:["33000000 0.000"]}}}}}});f.lazyLoad(c,"UpgradeUserStart",function(){return{children:{containerGuestOuterLayerView:{style:{gradient:{corners:b(6),gradient:["66000000 0.000"]}}},containerMainContainerView:{style:{gradient:{corners:b(6),outerLine:"FF08418D 3.0"}}},containerHeaderAreaView:{style:{gradient:{corners:"10.0 10.0 0.0 0.0",gradient:["FF05284D 0.000","FF021A36 1.000"]}}},containerButtonAreaView:{style:{gradient:{corners:"0.0 0.0 10.0 10.0",gradient:["FFFFFFFF 0.000"]}}},containerButtonAreaBorderView:{style:{gradient:{gradient:["FFE6EDF5 0.000"]}}},titleImg:{style:{image:d.image("mobage_logo.png"),imageFit:6}},subtitleLbl:{style:{textFont:f.defaultBoldFontFace,textSize:g(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5]}},facebookIconImg:{style:{image:d.image("registration_icon_facebook.png"),imageFit:6,imageGravity:[0.5,0.5]}},facebookIconDivImg:{style:{image:d.image("FB-Email-Divider-line.png"),imageFit:6,imageGravity:[0.5,0.5]}},signUpIconImg:{style:{image:d.image("email-icon.png"),imageFit:1,imageGravity:[0.5,0.5]}},signUpIconDivImg:{style:{image:d.image("FB-Email-Divider-line.png"),imageFit:6,imageGravity:[0.5,0.5]}},facebookBtn:{style:{image:d.image("registration_button_facebook.png"),pressedImage:d.image("registration_button_facebook_down.png"),imageFit:3,imageGravity:[0,0]}},facebookBtnLbl:{style:{textFont:f.defaultBoldFontFace,textColor:"FFFFFFFF",textSize:g(16),textGravity:[0.5,0.5]}},signUpBtnLbl:{style:{textFont:f.defaultBoldFontFace,textColor:"FFFFFFFF",textSize:g(16),textGravity:[0.5,0.5]}},facebookDescLbl:{style:{textFont:f.defaultRegularFontFace,textColor:"FF999999",textSize:g(12),textGravity:[0.5,0.5]}},signUpBtn:a.blueButton,startOverDescLbl:{style:{textFont:f.defaultRegularFontFace,textColor:"FFFFFFFF",textSize:g(12),textGravity:[0,0.5]}},startOverBtn:{style:{gradient:{corners:b(8),gradient:["FF838d93 0.000","FF767c82 1.000"],innerLine:"44acbac0 2.0"},pressedGradient:{corners:b(8),gradient:["FF767c82 0.000","FF838d93 1.000"],innerLine:"44acbac0 2.0"},textFont:f.defaultBoldFontFace,textSize:g(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}}}}});f.lazyLoad(c,"RegistrationGuest",function(){return{children:{backBtn:a.grayButton,playNowBtn:a.blueButton,termsAndLbl:{style:{textFont:f.defaultRegularFontFace,textSize:g(12),textColor:"FF999999",textGravity:[0.5,0.5]}},termsLineLbl:{style:{textFont:f.defaultRegularFontFace,textSize:g(12),textColor:"FF999999",textGravity:[0.5,0]}},termsLink1Btn:{style:{textFont:f.defaultRegularFontFace,textSize:g(12),textColor:"FF266A9F",textGravity:[0.5,0.5],pressedGradient:{corners:b(8),gradient:["33000000 0.000"]}}},termsLink2Btn:{style:{textFont:f.defaultRegularFontFace,textSize:g(12),textColor:"FF266A9F",textGravity:[0.5,0.5],pressedGradient:{corners:b(8),gradient:["33000000 0.000"]}}},g2AlertView:{style:{gradient:{gradient:["FF666666 0.000"]}}},g2AlertImg:{style:{image:d.image("icon-alert.png"),imageFit:3,imageGravity:[0.5,0.5]}},g2AlertDesc1Lbl:{style:{textFont:f.defaultBoldFontFace,textSize:g(12),textColor:"FFFFFFFF",textGravity:[0,0]}},g2AlertDesc2Lbl:{style:{textFont:f.defaultRegularFontFace,textSize:g(12),textColor:"FFFFFFFF",textGravity:[0,0]}}}}})}};__ngs._ck={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var a=new (__ngs.r_(__ngs._f).RequireLoader)({UI:function(){return __ngs.r_(__ngs._59).UI},Layout:function(){return __ngs.r_(__ngs._aj).Layout},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},VarHeightCell:function(){return __ngs.r_(__ngs._d3).VarHeightCell},UserInfoCellStyle:function(){return __ngs.r_(__ngs._65).UserInfoCell}});var c=b.VHUserInfoCell=a.VarHeightCell.subclass({classname:"VHUserInfoCell",initialize:function($super){$super();this._cellStyle=a.UserInfoCellStyle;this._gamertag=null;this._motto=null;this._avatar=null;this._clickyOverlay=null;this.initSubviews();this.addSubviews()},destroy:function(){if(this._gamertag){this._gamertag.release();this._gamertag=null}if(this._motto){this._motto.release();this._motto=null}if(this._avatar){this._avatar.release();this._avatar=null}if(this._clickyOverlay){this._clickyOverlay.release();this._clickyOverlay=null}},update:function(e){if(e.user){this._clickyOverlay.setOnClick(e.onCellClick);this._motto.setText(e.user.motto);this._gamertag.setText(e.user.gamertag);this._avatar.setImage(e.user.getDefinedIcon())}},initSubviews:function(){this._gamertag=(new a.UI.Label()).retain();this._motto=(new a.UI.Label()).retain();this._avatar=(new a.UI.Image()).retain();this._clickyOverlay=(new a.UnspammableButton()).retain()},addSubviews:function(){this.addChild(this._clickyOverlay);this.addChild(this._gamertag);this.addChild(this._motto);this.addChild(this._avatar);this._cellStyle.applyTo(this)},layoutSubviews:function(g){if(!g.user||!g.metrics.tag||!g.metrics.motto){return}var j=new a.UI.ViewGeometry.Rect(this.getFrame());if(j.isEmpty()){return}j.x=j.y=0;var f=this._cellStyle.extras;this._clickyOverlay.setFrame(j);var h=f.avatarImageSizeFactor*j.w;var m=j.copy().sliceHorizontal(h);m.h=h;this._avatar.setFrame(m.inset(j.w*f.avatarImageSpacerInsetRatio));var l=j.copy().sliceHorizontal(-(j.w-h));var e=a.UserInfoCellStyle.children._gamertag.getTextInsets();var k=e[0]+e[2];e=a.UserInfoCellStyle.children._motto.getTextInsets();var n=e[0]+e[2];this._gamertag.setFrame([l.x,l.y,l.w,g.metrics.tag.height+k]);this._motto.setFrame([l.x,l.y+g.metrics.tag.height+k,l.w,g.metrics.motto.height+n])},$calculateRequiredHeightForWidth:function(e,k,g){if(!k.user){g(0);return}var p=new a.UI.ViewGeometry.Rect([0,0,e,1]);var j=a.UserInfoCellStyle.extras;var m=j.avatarImageSizeFactor*p.w;var q=p.copy().sliceHorizontal(-(p.w-m));var f=a.UserInfoCellStyle.children._gamertag.getTextInsets();var o=f[0]+f[2];var h=f[1]+f[3];f=a.UserInfoCellStyle.children._motto.getTextInsets();var r=f[0]+f[2];var l=f[1]+f[3];var n={tag:{text:k.user.gamertag,width:q.w-h,height:500,textFont:a.UserInfoCellStyle.children._gamertag.getNormalTextFont(),textSize:a.UserInfoCellStyle.children._gamertag.getTextSize()},motto:{text:k.user.motto,width:q.w-l,height:5000,textFont:a.UserInfoCellStyle.children._motto.getNormalTextFont(),textSize:a.UserInfoCellStyle.children._motto.getTextSize()}};a.Layout.measureStrings(n,k.metrics,function(){g(Math.max(k.metrics.tag.height+o+k.metrics.motto.height+r,m))})}})}};__ngs._cl={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=new (__ngs.r_(__ngs._f).RequireLoader)({UI:function(){return __ngs.r_(__ngs._59).UI},VarHeightCell:function(){return __ngs.r_(__ngs._d3).VarHeightCell}});var d=b.VarHeightListItem=a.UI.ListViewItem.subclass({classname:"VarHeightListItem",_reuseId:"VariableHeight.BaseListItem",_cellClass:a.VarHeightCell,initialize:function($super){$super();this._cell=null;this._data=null;this._width=null;this.setHeight(0.001)},update:function(f,e){e=e||function(){};this._width=f;if(this._width){if(this._cell&&this._cell.update){this._cell.update(this._data)}this._cellClass.calculateRequiredHeightForWidth(this._width,this._data,function(g){this.setHeight(g);if(this._cell){this._cell.layoutSubviews(this._data)}e()}.bind(this))}else{e()}},loadData:function(e){e()},_initChangeableData:function(e){this._data=e},_onSetView:function(e){if(e!=this._cell){this._cell=e.retain();this.update(this._width)}},_onReleaseView:function(e){if(this._cell&&this._cell==e){this._cell.release();this._cell=null}},_onCreateView:function(){return new this._cellClass()}})}};__ngs._cm={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=new (__ngs.r_(__ngs._f).RequireLoader)({UI:function(){return __ngs.r_(__ngs._59).UI},Assets:function(){return __ngs.r_(__ngs._2z).Assets},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},Destinations:function(){return __ngs.r_(__ngs._2a).Destinations},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},VarHeightCell:function(){return __ngs.r_(__ngs._d3).VarHeightCell},MobageHeaderStyle:function(){return __ngs.r_(__ngs._65).MobageHeaderCell},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics}});var a=c.VHMobageHeaderCell=b.VarHeightCell.subclass({classname:"VHMobageHeaderCell",initialize:function($super){$super();this._cellStyle=b.MobageHeaderStyle;this._logo=null;this.initSubviews();this.addSubviews()},destroy:function(){if(this._logo){this._logo.release();this._logo=null}},initSubviews:function(){this._logo=(new b.UnspammableButton()).retain();this._logo.setImage(b.Assets.image("mobagelogotm_down.png"),b.UI.State.Pressed);this._logo.setImage(b.Assets.image("mobagelogotm.png"));this._logo.setOnClick(function(){b.MobageAnalytics.reportEvent("VHMobageHeaderCellClickLogo");b.Destinations.pushScreen(b.ServiceHost.navController,"Home",{})}.bind(this))},addSubviews:function(){this.addChild(this._logo);this._cellStyle.applyTo(this)},layoutSubviews:function(h){var g=new b.UI.ViewGeometry.Rect(this.getFrame());if(g.isEmpty()){return}g.x=g.y=0;var f=this._cellStyle.extras;var e=g.h-f.insets[0]-f.insets[2];this._logo.setFrame([f.insets[3],f.insets[0],e*f.logoRatio,e])},$calculateRequiredHeightForWidth:function(g,h,e){var f=b.MobageHeaderStyle.extras;e(f.logoW*(g-f.insets[1]-f.insets[3])/f.logoRatio)}})}};__ngs._cn={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var a=new (__ngs.r_(__ngs._f).RequireLoader)({UI:function(){return __ngs.r_(__ngs._59).UI},Core:function(){return __ngs.r_(__ngs._5).Core},Assets:function(){return __ngs.r_(__ngs._2z).Assets},Layout:function(){return __ngs.r_(__ngs._aj).Layout},LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},StringUtils:function(){return __ngs.r_(__ngs._c0).StringUtils},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},VarHeightCell:function(){return __ngs.r_(__ngs._d3).VarHeightCell},StyleExtras:function(){return __ngs.r_(__ngs._65).GameModuleCell.extras},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics}});var e=-1;var f=2;var b=c.VHGameModuleCell=a.VarHeightCell.subclass({classname:"VHGameModuleCell",initialize:function($super){$super();this._header=null;this._panel=null;this._content=null;this._icon=null;this._buttons=null;this._image=null;this.initSubviews()},destroy:function(){if(this._header){this._header.release();this._header=null}if(this._panel){this._panel.release();this._panel=null}if(this._content){this._content.release();this._content=null}if(this._icon){this._icon.release();this._icon=null}if(this._image){this._image.release();this._image=null}if(this._buttons){for(var g=this._buttons.length-1;g>=0;g--){this._buttons[g].release()}this._buttons=null}},initSubviews:function(){this._header=(new a.UI.Label()).retain();this._panel=(new a.UI.View()).retain();this._content=(new a.UI.Label()).retain();this._icon=(new a.UI.Image()).retain();this._image=(new a.UI.Image()).retain();this._buttons=[];for(var g=0;g<f;g++){this._buttons.push((new a.UnspammableButton()).retain())}},update:function(k){this._panel.removeFromParent();this._image.removeFromParent();this._header.removeFromParent();this._content.removeFromParent();this._icon.removeFromParent();this.addChild(this._panel);if(k.type=="basic"){this.addChild(this._header);if(k.basic.text){this.addChild(this._content)}else{this._content.removeFromParent()}this.addChild(this._icon);this._header.setText(b._constructHeaderText(k));if(k.basic.text){this._content.setText(k.basic.text)}if(k.basic.icon){this._icon.setImage(k.basic.icon)}else{if(k.game){this._icon.setImage(k.game.getDefinedIcon())}}}else{if(k.type=="image"){this.addChild(this._image);if(k.image){var n=this.getFrame()[2];var h=k.lastFrameWidth!=n;var g=a.StyleExtras.panelInsets||[0,0,0,0];var m;k.lastFrameWidth=n;if(k.image.url&&typeof k.image.url=="string"&&(h||k.image.url!=k.image.lastImage)){k.image.lastImage=k.image.url;var j=k.image.url;if(k.image.placeholder&&(k.image.placeholder.width||k.image.placeholder.height)){m=this._getDynamicImageDimensions(n,a.StyleExtras.dynamicImageRatio,g);if(typeof k.image.placeholder.width=="string"){k.image.placeholder.width=a.StringUtils.trim(k.image.placeholder.width);if(k.image.placeholder.width){j=j.replace(k.image.placeholder.width,m[0])}}if(typeof typeof k.image.placeholder.height=="string"){k.image.placeholder.height=a.StringUtils.trim(k.image.placeholder.height);if(k.image.placeholder.height){j=j.replace(k.image.placeholder.height,m[1])}}}if(this._image.getImage()!=j){this._image.setImage(j);this._image.setImageFit(a.UI.FitMode.Stretch)}}}}else{k.show=false;return}}if(k.hasOwnProperty("buttons")){var o=0,l=0;if(k.buttons){l=Math.min(k.numButtonsDefined,f);for(o=0;o<l;o++){var p=e>0?k.buttons[o].label.substr(0,e):k.buttons[o].label;this._buttons[o].setText(p);if(typeof k.actionCB=="function"){(function(q){this._buttons[q].setOnClick(function(){var r=k.buttons[q].id||q;a.MobageAnalytics.reportEvent("VHGameModuleClickButton",{buttonID:r,buttonLabel:p});k.actionCB({buttonClick:{id:r}})})}.bind(this))(o)}this.addChild(this._buttons[o])}}for(o=l;o<this._buttons.length;o++){this._buttons[o].removeFromParent()}}},$_constructHeaderText:function(g){return g.game?a.LocText("in %1s",g.game.name):" "},$_getDynamicImageDimensions:function(j,h,g){g=g||[0,0,0,0];j=Math.round(j-g[1]-g[3]);return[j,Math.floor(j*h)]},layoutSubviews:function(B){if(!B.show){return}var h=new a.UI.ViewGeometry.Rect(this.getFrame());if(h.isEmpty()){return}h.x=h.y=0;var l=a.StyleExtras;var v;var j=JSON.parse(JSON.stringify(l.panelInsets||[0,0,0,0]));var s=Math.min(B.numButtonsDefined,f);var A=h.copy().inset(j[0],j[3],j[2],j[1]);if(s>0){j[2]=l.buttonSpacing}var w;this._panel.setFrame(A);if(B.type=="basic"){var y=(B.basic.text?l.normalIconSizeFactor:l.smallIconSizeFactor)*h.w;var o=l.iconMarginFactor*h.w*2;w=A.copy().sliceHorizontal(-(A.w-y-o));var g=A.copy().sliceHorizontal(y+o);g.h=y+o;this._icon.setFrame(g.inset(o*0.5))}else{w=A.copy();A.h=this._getDynamicImageDimensions(A.w,l.dynamicImageRatio)[1];this._image.setFrame(A)}if(s>0){v=B.styler.getStyle("button").getTextInsets();var n=B.metrics.button.height+v[0]+v[2];var q=A.copy().inset(0,l.buttonSpacing*0.5,0,l.buttonSpacing*0.5);q.y=Math.floor(w.y+w.h-n-j[2]);q.h=n;var x=q.getGrid(1,s,true);for(var z=0;z<s;z++){this._buttons[z].setFrame(x[z].inset(0,l.buttonSpacing*0.5,0,l.buttonSpacing*0.5))}w.h-=n+l.buttonSpacing}if(B.type=="basic"){v=B.styler.getStyle("header").getTextInsets();var k=v[0]+v[2];var p=v[1]+v[3];if(B.basic.text){v=B.styler.getStyle("content").getTextInsets();var m=v[0]+v[2];var t=v[1]+v[3];var u=B.basic.lineLimit?(Math.min(B.basic.lineLimit,B.metrics.content.lineWidths.length)*B.metrics.content.height)/B.metrics.content.lineWidths.length:B.metrics.content.height;this._header.setFrame([w.x,w.y,w.w,B.metrics.header.height+k]);this._content.setFrame([w.x,w.y+B.metrics.header.height+k,w.w,u+m])}else{this._header.setFrame([w.x,w.y,w.w,Math.max(B.metrics.header.height+k,w.h)])}}},$calculateRequiredHeightForWidth:function(u,B,s){if((!B.basic&&!B.image)||!B.show){s(0);return}var g=new a.UI.ViewGeometry.Rect([0,0,u,1]);var l=a.StyleExtras;var j=l.panelInsets||[0,0,0,0];var C=B.buttons&&B.buttons.length>0;var y=B.styler.getStyle("button");var r={text:"X",width:1000,height:1000,textFont:y.getTextFont(),textSize:y.getTextSize()};if(B.type=="image"){var h=function(){var D=b._getDynamicImageDimensions(g.w,l.dynamicImageRatio,j)[1]+j[0]+j[2];if(C){w=y.getTextInsets();var E=w[0]+w[2];D+=B.metrics.button.height+E+l.buttonSpacing*2}s(Math.floor(D))};if(C){a.Layout.measureStrings({button:r},B.metrics,h)}else{h()}}else{var A=g.copy().inset(j[0],j[3],j[2],j[1]);var z=(B.basic.text?l.normalIconSizeFactor:l.smallIconSizeFactor)*g.w;var o=l.iconMarginFactor*g.w*2;var x=A.copy().sliceHorizontal(-(A.w-z-o));var p=B.styler.getStyle("header");var v=B.styler.getStyle("content");var w=p.getTextInsets();var k=w[0]+w[2];var q=w[1]+w[3];w=v.getTextInsets();var m=w[0]+w[2];var t=w[1]+w[3];var n={header:{text:b._constructHeaderText(B),width:x.w-q,height:1000,textFont:p.getTextFont(),textSize:p.getTextSize()}};if(B.basic.text){n.content={text:B.basic.text,width:x.w-t,height:5000,textFont:v.getTextFont(),textSize:v.getTextSize()}}if(C){n.button=r}a.Layout.measureStrings(n,B.metrics,function(){var D=0;if(B.basic.text){var E=B.basic.lineLimit?(Math.min(B.basic.lineLimit,B.metrics.content.lineWidths.length)*B.metrics.content.height)/B.metrics.content.lineWidths.length:B.metrics.content.height;D=Math.max(B.metrics.header.height+k+E+m,z+o)+j[0]+j[2]}else{D=Math.max(B.metrics.header.height+k,z+o)+j[0]+j[2]}if(C){w=y.getTextInsets();var F=w[0]+w[2];D+=B.metrics.button.height+F+l.buttonSpacing}s(Math.floor(D))})}}})}};__ngs._co={_c:null,_d:function(){var c={exports:{}};var u=c.exports;this._c=c;var h=__ngs.r_(__ngs._59).UI;var g=h.ViewGeometry.Rect;var r=new (__ngs.r_(__ngs._f).RequireLoader)({ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells},TappableUserIconView:function(){return __ngs.r_(__ngs._c2).TappableUserIconView},UserCellView:function(){return __ngs.r_(__ngs._ad).UserCellView},UserCellView_ThreeItemMessage_TappableColumnVariant:function(){return __ngs.r_(__ngs._ad).UserCellView_ThreeItemMessage_TappableColumnVariant},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},WallCmdViewController:function(){return __ngs.r_(__ngs._d1).WallCmdViewController},WallStyle:function(){return __ngs.r_(__ngs._d4)},UserProfileStyle:function(){return __ngs.r_(__ngs._b0)},MobageStyle:function(){return __ngs.r_(__ngs._6k).MobageStyle},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils}});var f=__ngs.r_(__ngs._77).Primitives;var b=__ngs.r_(__ngs._n).LocalizedString;var k=__ngs.r_(__ngs._n).LocalizedDate;var p=__ngs.r_(__ngs._9h);var s=p.Composite;var j=__ngs.r_(__ngs._ao).CompositeButton;var l=__ngs.r_(__ngs._9i);var t=l.Components;var n=s({key:"title",component:t.Label},{key:"content",altKey:"field",component:t.EditText},{key:"button",component:t.Button},{key:"cover",component:t.Button},t.AddOrders.Generator("title","content","button","cover"),{classname:"WallPostCell",initialize:function($super,v){$super(v);r.ListViewCellStyles.WallPostCell.applyTo(this);this.field.onchange=function(){var w=this.field.getText();if(this.maxLength&&w.length>this.maxLength){if(!this._alertUp){this._alertUp=true;r.UIUtils.showAlert(b("Message too long"),b("Only %1d characters are allowed. Extra characters will be truncated.",this.maxLength),function(){this._alertUp=false}.bind(this))}this.field.setText(w.slice(0,this.maxLength))}}.bind(this);this.cover.setOnClick(function(){if(!this._alertUp){this._alertUp=true;if(!this.user){throw new Error("No user in WallPostCell [Wall Header Cell]")}r.UIUtils.showAlert(b("Unavailable for %1s!",this.user.gamertag),b("Invite %1s to upgrade to Mobage to connect and play games!",this.user.gamertag),[b("Invite"),b("Not Now")],function(w){if(w.choice===0){this.user.inviteToCurrentGame(function(x,y){NgLogD("Invite to game request sent: "+JSON.stringify(y));if(x){r.UIUtils.showToast(b("Please check your network settings."))}else{r.UIUtils.showToast(b("Email invite sent!"))}})}this._alertUp=false}.bind(this))}}.bind(this));return this},layoutSubviews:function(){var z=new g(this.getFrame());if(z.isEmpty()){return}z.x=z.y=0;this.cover.setFrame(z);var w=r.ListViewCellStyles.WallPostCell.extras;var A=this.title.getText();var C=A?z.h*w.titleHeightRatio:0;var x=z.w*w.insetWidthRatio;var y=z.w*w.postWidthRatio;z.inset.apply(z,[x/2,x,x,x]);var B=z.sliceVertical(C);B.inset.apply(B,[0,0,-B.h,0]);var v=z.sliceHorizontal(0-x/2-y);v.inset.apply(v,[0,0,0,x/2]);z.inset.apply(z,[0,x/2,-3,0]);this.field.setOnFocus(this._field_focusHandler.bind(this));this.title.setFrame(B);this.button.setFrame(v);this.field.setFrame(z)},setPostingEnabled:function(v){this.field.setEnabled(v);if(v){this.cover.removeFromParent()}else{this.addChild(this.cover)}},_field_focusHandler:function(){if(!this.field.getEnabled()){this.field.blur()}},setPostingDisabledOnClick:function(v){this.cover.setOnClick(v)}});var o=u.WallSectionHeaderItem=f.ListViewItem.subclass({classname:"WallSectionHeaderItem",_reuseId:"wallsectionheaderitem",_postingDisabled_clickHandler:null,_onCreateView:function(){return new n()},_onSetView:function(v){this.cell=v;if(!v){return}v.user=this._user;v.maxLength=this.maxLength||140;v.item=this;v.button.setOnClick(function(){if(typeof this._onClick=="function"){this._onClick(v.field)}}.bind(this));v.field.setPlaceholder(this._placeholderText||"");if(typeof this._titleText=="string"){v.title.setText(this._titleText)}v.setPostingEnabled(this._postingEnabled);v.setPostingDisabledOnClick(this._postingDisabled_clickHandler);if(this._fieldFocusEnabled){v.field.focus();this._fieldFocusEnabled=false}if(this._fieldBlurEnabled){v.field.blur();this._fieldBlurEnabled=false}},_onReleaseView:function(v){if(v&&v.item==this&&this.cell==v){this.cell=null;v.item=null}},_onClick:function(){NgLogD("_postOnClick!!")},setOnClick:function(v){this._onClick=v},setPlaceholder:function(v){this._placeholderText=v;if(this.cell){this.cell.field.setPlaceholder(this._placeholderText)}},setTitleText:function(v){this._titleText=v;if(this.cell){this.cell.title.setText(this._titleText)}},setPostingEnabled:function(v){this._postingEnabled=v;if(this.cell){this.cell.setPostingEnabled(v)}},setPostingDisabledOnClick:function(v){this._postingDisabled_clickHandler=v;if(this.cell){this.cell.setPostingDisabledOnClick(v)}},setUser:function(v){this._user=v;if(this.cell){this.cell.user=v}},setPostingMessageFocus:function(){if(this.cell){this.cell.field.focus();this._fieldFocusEnabled=false}else{this._fieldFocusEnabled=true}},setPostingMessageBlur:function(){if(this.cell){this.cell.field.blur();this._fieldBlurEnabled=false}else{this._fieldBlurEnabled=true}}});var a=t.Layouts.ThreeHorizontalGenerator("leftArrow","content","rightArrow").layoutSubviews;var m=s({key:"leftArrow",component:t.Image},{key:"content",component:t.Label,altKey:"message"},{key:"rightArrow",component:t.Image},t.AddOrders.Generator("content","leftArrow","rightArrow"),{classname:"MorePostCell",initialize:function($super,w){$super(w);var v=r.ListViewCellStyles.MorePostCell;v.applyTo(this);this.insetRatio=v.extras.buttonInsetRatio;this.rightInsetRatio=v.extras.rightInsetRatio;this.buttonSizeRatio=v.extras.buttonSizeRatio;this.subtitleHeightRatio=v.extras.subtitleHeightRatio;return this},layoutSubviews:function($super){$super();var y=new g(this.getFrame());if(!y.isEmpty()){var x=y.h/4;var w=x*2;var v=(y.h/2)-(x/2);this.leftArrow.setFrameSize([x+2*w,x]);this.rightArrow.setFrameSize([x+2*w,x]);this.setLeftArrowInset([v,w,v,w]);this.setRightArrowInset([v,w,v,w])}a.call(this)}},j);var e=u.WallSectionFooterItem=f.ListViewItem.subclass({classname:"WallSectionFooterItem",_reuseId:"wallsectionfooteritem",_onCreateView:function(){return new m()},_onSetView:function(v){this.cell=v;if(!v){return}v.item=this;v.setOnClick(function(){this._onClick()}.bind(this))},_onReleaseView:function(v){if(v&&v.item==this&&this.cell==v){this.cell=null;v.item=null}},_onClick:function(){NgLogD("morePostsOnClick!!")},setOnClick:function(v){this._onClick=v}});var q=r.UserCellView_ThreeItemMessage_TappableColumnVariant.subclass({classname:"ConversationCell",insetRatio:null,buttonSizeRatio:null,subtitleHeightRatio:0.75,rightInsetRatio:null,initialize:function($super,v){this._compositePrepare();this._compositeInits.icon=function(x){this[x]=(new r.TappableUserIconView()).retain()};$super(v);var w=r.ListViewCellStyles.ConversationCell;w.applyTo(this);this.insetRatio=w.extras.buttonInsetRatio;this.rightInsetRatio=w.extras.rightInsetRatio;this.buttonSizeRatio=w.extras.buttonSizeRatio;this.subtitleHeightRatio=w.extras.subtitleHeightRatio;this.setOnClick(function(){this.rowTapped()}.bind(this));this.icon.setOnClick(function(){this.avatarTapped()}.bind(this))},setAvatarTapped:function(v){this.avatarTapped=v},setRowTapped:function(v){this.rowTapped=v},setReplyCount:function(v){var w="";if(v>99){w="99+"}else{if(v>0){w=String(v)}}this.accessoryButton.label.setText(w)},layoutSubviews:function($super){var A=new g(this.getFrame());if(!A.isEmpty()){var y=A.copy();var B=this.insetRatio*A.h;var x=[B,B,B,B];var w=[B/2,B/2,B/2,B/2];this.setIconInset(w);var v=this.rightInsetRatio*A.h;this.icon.setFrameSize([y.h,y.h]);var D=[B/2,B/2,B/2,B/2];this.accessoryButton.setIconInset(D);var z=v*3.5-B;this.accessoryButton.setFrame([0,0,z,v*1.5]);this.content.layoutSubviews();this.content.content.setFrameSize([A.w,A.h*0.25]);var C=this.content.title.getFrame();this.content.subtitle.setFrame([C[0],C[1]+C[3],A.w-z-y.h,A.h*0.75])}$super()}});var d=u.WallConversationItem=f.ListViewItem.subclass({classname:"ConversationListItem",_reuseId:"wall.conversationlistitem",initialize:function($super,v,x,w){$super();this.setHeight(100);this.controller=v;this.wallOwner=x;this._conversation=w},_onCreateView:function(){return new q()},_onReleaseView:function(v){if(v){v.icon.content.setImage("")}if(this.cell==v){this.cell=null}},_onSetView:function(v){console.log("WallConversationItem_onSetView",this.wallOwner.gamertag);this.cell=v;v.setRowTapped(this.rowTapped.bind(this));if(this._conversation.total>0){v.setReplyCount(this._conversation.total-1)}v.setState(h.State.Normal);v.layoutSubviews();v.icon.content.setImage(this._conversation.user.getDefinedIcon());v.setAvatarTapped(this._avatar_tapHandler.bind(this));var x=k(this._conversation.date);var w=65;if(this._conversation.message.length>w){v.content.subtitle.setText(this._conversation.message.substring(0,w)+"…")}else{v.content.subtitle.setText(this._conversation.message)}v.content.content.setText(this._conversation.author_gamertag+" "+x);if(this.odd){v.addState(r.MobageStyle.OddState)}v.accessoryButton.content.setOnClick(this._accessoryBtn_clickHandler.bind(this))},setRowOnTapped:function(v){this._rowTapped_callback=v},rowTapped:function(){if(typeof this._rowTapped_callback=="function"){this._rowTapped_callback(this._conversation)}},setAccessoryBtnOnClick:function(v){this._accessoryBtn_callback=v},_accessoryBtn_clickHandler:function(){if(typeof this._accessoryBtn_callback=="function"){this._accessoryBtn_callback(this.wallOwner,this.cell,this._conversation)}},setAvatarTapped:function(v){this._avatar_tapCallback=v},_avatar_tapHandler:function(){if(typeof this._avatar_tapCallback=="function"){this._avatar_tapCallback(this._conversation.user)}}})}};__ngs._cp={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var a=new (__ngs.r_(__ngs._f).RequireLoader)({UI:function(){return __ngs.r_(__ngs._59).UI},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},Destinations:function(){return __ngs.r_(__ngs._2a).Destinations},WallCmdViewController:function(){return __ngs.r_(__ngs._d1).WallCmdViewController},VHWallCell:function(){return __ngs.r_(__ngs._d5).VHWallCell},VarHeightListItem:function(){return __ngs.r_(__ngs._cl).VarHeightListItem},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics}});var b=c.VHWallListItem=a.VarHeightListItem.subclass({classname:"VHWallListItem",_reuseId:"VariableHeight.WallListItem",_cellClass:a.VHWallCell,initialize:function($super,e,j,h,g,f){$super();this._post=null;this._game=null;this._wallOwner=null;this._controller=null;this._cellClickCB=null;this._avatarClickCB=null;this._commandButtonCB=null;this._isPlaceholder=false;this._wallOwner=j;this._controller=e;this._cellClickCB=this._goToConversation.bind(this);this._commandButtonCB=this._showCommandPopOver.bind(this);this._avatarClickCB=this._goToPostAuthorProfile.bind(this);this.setData(h,f,g)},destroy:function(){},isPlaceholder:function(){return this._isPlaceholder},setData:function(g,e,f){if(typeof f=="boolean"){this._isPlaceholder=f}this._post=g;this._game=e;this._initChangeableData({post:this._post,game:this._game,metrics:{},isPlaceholder:this._isPlaceholder,onCellClick:this._cellClickCB,onCommandButtonClick:this._commandButtonCB,onAvatarClick:this._avatarClickCB})},_showCommandPopOver:function(){a.MobageAnalytics.reportEvent("VHWallItemClickCommandsButton",{post:this._createAnalyticsPayloadForPost(this._post)});var l=new a.UI.ViewGeometry.Rect(this._cell.getFrame());var e=this._cell;var j=new a.UI.ViewGeometry.Rect(e._commandButton.getFrame());var g=this._controller.section()._listView.getScrollPosition();l.y-=g[1];l.x-=g[0];var k=new a.WallCmdViewController(this._wallOwner,this._post,l.array(),function(){this._controller._removePost.bind(this._controller)(this)}.bind(this),this._cellClickCB,j.w*1.5,true);var h=k.view()._backgroundView;var f=new a.UI.ViewGeometry.Rect(h.getFrame());f.y+=this._controller.section()._listView.getFrame()[1];h.setFrame(f)},_goToConversation:function(){a.MobageAnalytics.reportEvent("VHWallItemClickCell",{wallOwner:this._wallOwner?{recordID:this._wallOwner.recordID,gamertag:this._wallOwner.gamertag}:null,post:this._createAnalyticsPayloadForPost(this._post)});if(this._post&&this._wallOwner){a.Destinations.pushScreen(a.ServiceHost.navController,"UserProfilePage",{tab:"profile",user:this._wallOwner},null,function(f){if(!f){var e=a.ServiceHost.navController.getTopViewController()._profileController;var g=e.didActivateTab;e.didActivateTab=function(){e.didActivateTab=g;e.didActivateTab();e.view()._wallController._pushConversationWall(this._post)}.bind(this)}}.bind(this))}else{a.MobageAnalytics.reportEvent("VHWallItemGoToConversationFailed",{error:"no post or no wall owner"})}},_goToPostAuthorProfile:function(){a.MobageAnalytics.reportEvent("VHWallItemClickAuthorAvatar",{post:this._createAnalyticsPayloadForPost(this._post)});if(this._post&&this._post.user){a.Destinations.pushScreen(a.ServiceHost.navController,"UserProfilePage",{tab:"profile",user:this._post.user})}else{a.MobageAnalytics.reportEvent("VHWallItemGoToAuthorProfile",{error:"no post or post author"})}},_createAnalyticsPayloadForPost:function(e){return e?{author_recordID:e.author,author_gamertag:e.author_gamertag,wall_type:e.to_wall.type,wall_userID:e.to_wall.user_id,wall_productID:e.to_wall.product_id,id:e.id,conversationID:e.conversationID}:null}})}};__ngs._a1={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var g=__ngs.r_(__ngs._9h).Composite;var b=__ngs.r_(__ngs._9i).Components;var f=__ngs.r_(__ngs._ao).CompositeButton;var a=c.ButtonLibrary={};var e=function(h,j){a.__defineGetter__(h,function(){NgLogD("ButtonLibrary: Delayed Class Generation of "+h);delete this[h];return this[h]=j()})};e("Label_ImageLabelButton",function(){return g({key:"content",component:b.Label},{key:"accessory",component:b.ImageLabel},b.Layouts.TwoHorizontal,b.AddOrders.TwoHorizontal,{classname:"ButtonLibrary_Label_ImageLabelButton"},f)});(function(){var h;NgLogD("ButtonLibrary initialized. Available Buttons:");for(h in a){if(a.hasOwnProperty(h)){NgLogD("\t"+h)}}}())}};__ngs._a2={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var e=__ngs.r_(__ngs._7s).CellView;var c=__ngs.r_(__ngs._25).Rect;var a=b.CustomCellView=e.subclass({classname:"CustomCellView",initialize:function($super,f){$super(f);this._imgW=0;this._mid50=0;this._imgR=0;this._txtW=0;return this},_convertFrameToInsets:function(j,n,x,u,o){if(j instanceof c){j=j.isEmpty()?[0,0,0,0]:j.array()}j=j||[0,0,0,0];var g=n+u;var s=x+o;var p=j[0]+j[2];var m=j[1]+j[3];var k=j[0]-n;var q=j[1]-x;var v=g-p;var f=s-m;var y=[q,v,f,k];return y},setImageFrame:function(f){this._imageFrame=f;this.setImageInsets.apply(this,(this._convertFrameToInsets(f,0,0,this._imgW,this._imgW)))},getImageFrame:function(){return this._imageFrame},setRightImageFrame:function(f){this.setRightImageInsets.apply(this,(this._convertFrameToInsets(this._rightImageFrame=f,this._imgR,0,32,this._frame[3])))},getRightImageFrame:function(){return this._rightImageFrame},setTitleFrame:function(f){this._titleFrame=f;this.setTitleInsets.apply(this,(this._convertFrameToInsets(f,this._imgW,0,this._txtW,this._mid50)))},getTitleFrame:function(){return this._titleFrame},setTextFrame:function(f){this._textFrame=f;this.setTextInsets.apply(this,(this._convertFrameToInsets(f,this._imgW,this._mid50,this._txtW,this._mid50)))},getTextFrame:function(){return this._textFrame},setFrame:function($super){$super.apply(this,Array.prototype.slice.call(arguments,1));if(this._frame[2]*this._frame[3]>0){this._imgW=this._frame[3];this._mid50=Math.round(this._imgW/2)+1;this._imgR=this._frame[2]-32;this._txtW=this._imgR-this._imgW;this.layoutSubviews()}},layoutSubviews:function(){if(this._imageFrame){this.setImageFrame(this._imageFrame)}if(this._rightImageFrame){this.setRightImageFrame(this._rightImageFrame)}if(this._titleFrame){this.setTitleFrame(this._titleFrame)}if(this._textFrame){this.setTextFrame(this._textFrame)}}})}};__ngs._a3={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var f=__ngs.r_(__ngs._59).UI;var a=__ngs.r_(__ngs._7g).ViewController;var b=__ngs.r_(__ngs._bv).CCViewList;var e=c.ContentViewController=a.subclass({classname:"ContentViewController",parentController:null,_realParentView:null,initialize:function($super){$super();return this},destroy:function(){this._undoRootPerformanceHack()},loadView:function($super){if(!this._view){this.setView(new b())}$super()},getDynamicTabTitle:function(){return null},getDynamicPageTitle:function(){return null},getDynamicPageTitleImage:function(){return null},willActivateTab:function(){if(this._keyboardWAViews){for(var h in this._keyboardWAViews){var j=this._keyboardWAViews[h];j.setEnabled(true)}}},didActivateTab:function(){this._rootPerformanceHack()},willDeactivateTab:function(){this._undoRootPerformanceHack();if(this._keyboardWAViews){for(var h in this._keyboardWAViews){NgLogD("xxx enable item "+h);var j=this._keyboardWAViews[h];j.setEnabled(false)}}},didDeactivateTab:function(){},swapViews:function(j,h){var k=j.getParent();if(!k){throw new Error("swapViews fail due to no parent! "+j.classname+" "+h.classname)}if(typeof(k.setContentView)=="function"){j.removeFromParent();j._swapParent=k;k.setContentView(h)}else{j.removeFromParent();k.addChild(h)}},_rootPerformanceHack:function(){if(this.parentController){this.parentController.view().content._rootPerformanceHack()}},_undoRootPerformanceHack:function(){if(this.parentController){this.parentController.view().content._undoRootPerformanceHack()}}});function g(j,h,k){if(j instanceof Array&&h instanceof Array){if(j.length==h.length){for(var l=0;l<j.length;++l){if(false===k(j[l],h[l])){return false}}}else{return false}}else{return false}return true}c.compareArrays=g}};__ngs._a4={_c:null,_d:function(){var c={exports:{}};var f=c.exports;this._c=c;var e=__ngs.r_(__ngs._59).UI;var b=e.ViewGeometry.Rect;var a=e.ViewGeometry.Scale;var g=__ngs.r_(__ngs._60).Style;var k=__ngs.r_(__ngs._79).MBListViewSection;var h=__ngs.r_(__ngs._bw).ZeroCaseMessageCell;var j=f.ZeroCaseLItem=e.ListViewItem.subclass({classname:"ZeroCaseLItem",_reuseId:"zerocase_messagecell",initialize:function($super){$super()},_texts:["","",""],_buttonCallback:null,_buttonEnabled:true,setZeroCaseTexts:function(l){this._texts=l;if(this.cell){this._onSetView(this.cell)}},setZeroCaseButtonCallback:function(l){this._buttonCallback=l;if(this.cell){this._onSetView(this.cell)}},setZeroCaseButtonEnabled:function(l){this._buttonEnabled=l;if(this.cell){this._onSetView(this.cell)}},_onCreateView:function(){return new h()},_onSetView:function(l){l.setZeroCaseTexts(this._texts);l.setZeroCaseButtonCallback(this._buttonCallback);l.setZeroCaseButtonEnabled(this._buttonEnabled);__ngs.r_(__ngs._9u).CommonElements.largeActionButton.applyTo(this);l.setState(this._buttonEnabled?e.State.Normal:e.State.Disabled);this.cell=l}});var d=f.ZeroCaseSection=k.subclass({classname:"ZeroCaseSection",messageListItem:null,initialize:function($super,l,m){$super();if(!this._items){this._items=[]}if(l===undefined){l=3/6}this.setRowHeightRatio(l,m);this.messageListItem=(new j());this.setItems([this.messageListItem]);this.currentListItem=this.messageListItem;return this},destroy:function(){},setZeroCaseTexts:function(l){if(this.messageListItem){this.messageListItem.setZeroCaseTexts(l)}},setZeroCaseButtonCallback:function(l){if(this.messageListItem){this.messageListItem.setZeroCaseButtonCallback(l)}},setZeroCaseButtonEnabled:function(l){if(this.messageListItem){this.messageListItem.setZeroCaseButtonEnabled(l)}},calculateRowHeightForListView:function(l){if(!l){return}var n=new b(l.getFrame());if(n.isEmpty()){return}var m=n.h/5;this.setRowHeight(m)}})}};__ngs._a5={_c:null,_d:function(){var c={exports:{}};var f=c.exports;this._c=c;var g=__ngs.r_(__ngs._5).Core;var e=__ngs.r_(__ngs._59).UI;var d=__ngs.r_(__ngs._2a).Destinations;var b=new (__ngs.r_(__ngs._f).RequireLoader)({MobageStyle:function(){return __ngs.r_(__ngs._6k).MobageStyle},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},Game:function(){return __ngs.r_(__ngs._2e).Game},GameDownloadBar:function(){return __ngs.r_(__ngs._ag).GameDownloadBar},GameDownloadButton:function(){return __ngs.r_(__ngs._a6).GameDownloadButton},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},VerticalTabViewSizing:function(){return __ngs.r_(__ngs._9g).VerticalTabViewSizing}});var j=__ngs.r_(__ngs._n).LocalizedString;var a=f.CatalogCell=e.CellView.subclass({classname:"CatalogCell",_game:null,_product:null,_catalogStyle:null,_gameName:"",_screenWidth:0,_screenHeight:0,_cellWidth:0,_cellHeight:0,initialize:function($super){$super();this._catalogStyle=__ngs.r_(__ngs._a7).CatalogCell;this.initSubviews();this.addSubviews()},initSubviews:function(){this._gameImage=(new b.UnspammableButton()).retain();this._gameTitle=(new e.Label()).retain();this._publisherLabel=(new e.Label()).retain();this._infoLabel=(new e.Label()).retain();this._downloadBar=(new b.GameDownloadBar()).retain()},addSubviews:function(){this.addChild(this._gameImage);this.addChild(this._gameTitle);this.addChild(this._publisherLabel);this.addChild(this._infoLabel);this.addChild(this._downloadBar);this._catalogStyle.applyTo(this)},layoutSubviews:function(){var y=new e.ViewGeometry.Rect(this.getFrame());this._cellWidth=y.w;this._cellHeight=y.h;var o=this._catalogStyle.extras.gameIconWFactor*this._cellHeight;var z=this._catalogStyle.extras.gameIconXFactor*this._cellHeight-(o/2);this._gameImage.setFrame([z,z,o,o]);var l=b.GameDownloadButton.TimeLabelHeight;var A=this._catalogStyle.extras.actionButtonXFactor*this._cellWidth;this._downloadBar.setFrame([A,this._catalogStyle.extras.actionButtonYFactor*this._cellHeight-l*0.5,this._catalogStyle.extras.actionButtonWFactor*this._cellWidth,this._catalogStyle.extras.actionButtonHFactor*this._cellHeight+l]);this._downloadBar.initLayout();var q=0;var p=0;if(g.Capabilities.isPlatformIOS()){q=0.02;p=-0.05}var n=this._catalogStyle.extras.gameTextXSpacing*o;var x=z+o+n;var m=A-n;this._gameTitle.setTextGravity(e.ViewGeometry.Gravity.Left);var r=(this._catalogStyle.extras.gameTitleXFactor+q)*this._cellWidth;if(r<x){r=x}var t=this._catalogStyle.extras.gameTitleWFactor*this._cellWidth;if(t<m-r){t=m-r}this._gameTitle.setFrame([r,(this._catalogStyle.extras.gameTitleYFactor+p)*this._cellHeight,t,this._catalogStyle.extras.gameTitleHFactor*this._cellHeight]);this._publisherLabel.setTextGravity(e.ViewGeometry.Gravity.Left);var v=(this._catalogStyle.extras.publisherNameXFactor+q)*this._cellWidth;if(v-(z+o)<n){v=z+o+n}var w=this._catalogStyle.extras.publisherNameWFactor*this._cellWidth;if(w<m-v){w=m-v}this._publisherLabel.setFrame([v,(this._catalogStyle.extras.publisherNameYFactor+p)*this._cellHeight,w,this._catalogStyle.extras.publisherNameHFactor*this._cellHeight]);p=0.01;this._infoLabel.setTextGravity(e.ViewGeometry.Gravity.Left);var s=(this._catalogStyle.extras.gameDescriptionXFactor+q)*this._cellWidth;if(s-(z+o)<n){s=z+o+n}var u=this._catalogStyle.extras.gameDescriptionWFactor*this._cellWidth;if(u<m-s){u=m-s}this._infoLabel.setFrame([s,(this._catalogStyle.extras.gameDescriptionYFactor+p)*this._cellHeight,u,this._catalogStyle.extras.gameDescriptionHFactor*this._cellHeight])},destroy:function(){this._cleanUp()},_cleanUp:function(){if(this._gameImage){this._gameImage.release()}if(this._gameTitle){this._gameTitle.release()}if(this._publisherLabel){this._publisherLabel.release()}if(this._downloadBar){this._downloadBar.release()}if(this._infoLabel){this._infoLabel.release()}if(this._overlayButton){this._overlayButton.release()}},setOddRow:function(l){if(l){this.addState(b.MobageStyle.OddState)}else{this.clearState(b.MobageStyle.OddState)}},setGame:function(l,n,o,m){this._game=l;if(this._game instanceof b.Game&&!this._game.isLaunchable()){this._product=n}if(l){this._setPicture(l.getDefinedIcon());this._setTitle(l.name);if(this._product){this._setPublisher(this._product.getPromoLabel());this._setInfoLabel(this._product.getPromoDescription());this.addState(b.MobageStyle.PromoState);this._publisherLabel.addState(b.MobageStyle.PromoState)}else{this._setPublisher(l.publisher);this._setInfoLabel(l.description,o);this.clearState(b.MobageStyle.PromoState);this._publisherLabel.clearState(b.MobageStyle.PromoState)}this._setNumPlayers(-1)}else{this._setPicture("")}if(this._downloadBar){this._downloadBar.setGame(this._game,this._product);this._downloadBar.initLayout();this._downloadBar.addGoToAppStoreListener(m)}},_setPicture:function(l){if(this._gameImage){this._gameImage.setImage(l)}},_setTitle:function(l){this._gameName=l;if(this._gameTitle){this._gameTitle.setText(l)}},_setPublisher:function(l){if(this._publisherLabel){this._publisherLabel.setText(l)}},_setInfoLabel:function(m,l){if((!m)||(m.length<=0)){return}if(this._infoLabel){if(typeof l!=="number"||m.length<l){this._infoLabel.setText(m)}else{this._infoLabel.setText(m.substr(0,l)+"...")}}},_setNumPlayers:function(l){var m=parseInt(l,10);this._numPlayers=m;if(this._numPlayersLabel){this._numPlayersLabel.setText(m==1?j("1 Player"):j("%1d Players",m))}},_getContentWidth:function(){return(1-b.VerticalTabViewSizing.buttonContainerRatio-b.VerticalTabViewSizing.insetRatio)*this._screenWidth},sizeChanged:function(){this.layoutSubviews()}});var k=f.CatalogInfoLabelStrLenGetter=g.Class.subclass({classname:"CatalogInfoLabelStrLenGetter",initialize:function(s,q){var t=k.DefaultInfoLabelStrLen;var n=k.IntervalLen;if(typeof s.description!=="string"||s.description.length<t){q(s,t)}else{var r=k.getInfoLabelW();var m=__ngs.r_(__ngs._a7).CatalogCell;var u=m.children._infoLabel;var p=u.getTextFont();var l=u.getTextSize();var o=function(w,v){e.measureText(v.substr(0,w),r,1000,p,l,function(x){if(x.lineWidths.length>1){q(s,w-n)}else{if(w<v.length){o(w+n,v)}else{q(s,w)}}}.bind(this))}.bind(this);o(t+n,s.description)}}});k.DefaultInfoLabelStrLen=27;k.IntervalLen=5;k._infoLabelW=-1;k.getInfoLabelW=function(){if(k._infoLabelW==-1){var m=__ngs.r_(__ngs._a7).CatalogCell;var w=__ngs.r_(__ngs._a7).CatalogList;var l=g.Capabilities.getScreenHeight();var o=l*m.extras.catalogCellWFactor;var u=o*w.extras.catalogCellHFactor2;var q=m.extras.gameIconWFactor*u;var x=m.extras.gameIconXFactor*u-(q/2);var y=m.extras.actionButtonXFactor*o;var r=g.Capabilities.isPlatformIOS()?0:0.02;var p=m.extras.gameTextXSpacing*q;var v=x+q+p;var n=y-p;var s=(m.extras.gameDescriptionXFactor+r)*o;if(s<v){s=v}var t=m.extras.gameDescriptionWFactor*o;if(t<n-s){t=n-s}k._infoLabelW=t}return k._infoLabelW};var h=f.CatalogListItem=e.ListViewItem.subclass({classname:"CatalogListItem",_reuseId:"CatalogListItem",initialize:function($super,l,n,m,o){$super();this.game=l;this.odd=n;this.product=m;this.infoLabelStrLen=o},getGame:function(){return this.game},getProduct:function(){return this.product},_onCreateView:function(){return new a()},_onSetView:function(n){n.setOddRow(this.odd);var m=function(){this.goToAppStoreHandler(this)}.bind(this);n.setGame(this.game,this.product,this.infoLabelStrLen,m);var l=function(){this.rowTappedForGame(this.game)}.bind(this);n._gameImage.setOnClick(l);n.setOnClick(l)},_onReleaseView:function(l){if(l){l.setGame(null)}},rowTappedForGame:function(l){},goToAppStoreHandler:function(l){}})}};__ngs._a6={_c:null,_d:function(){var c={exports:{}};var e=c.exports;this._c=c;var d=__ngs.r_(__ngs._59).UI;var g=__ngs.r_(__ngs._n).LocalizedString;var j=__ngs.r_(__ngs._60).Style;var b=__ngs.r_(__ngs._6k).MobageStyle;var f=b.ScaledTextSize;var a=new (__ngs.r_(__ngs._f).RequireLoader)({GameDownloadButtonStyle:function(){return __ngs.r_(__ngs._bx).GameDownloadButton}});var h=e.GameDownloadButton=d.View.subclass({initialize:function($super,k){$super(k);this._icon=new d.Image();this.addChild(this._icon);this._msgLabel=new d.Label({text:g("FREE")});this.addChild(this._msgLabel);this._timeLabel=new d.Label();this.addChild(this._timeLabel);this.setOnClickDown(function(l){this.addState(d.State.Pressed)}.bind(this));this.setOnClick(function(l){this.clearState(d.State.Pressed);if(typeof this._onClickCb==="function"){this._onClickCb(l)}}.bind(this));this.setOnClickCancel(function(l){this.clearState(d.State.Pressed)}.bind(this));this._style=a.GameDownloadButtonStyle;this._style.applyTo(this)},destroy:function($super){h.removePromoButton(this);this._icon.release();this._msgLabel.release();this._timeLabel.release();this._product=null;this._onClickCb=null;this._icon=null;this._msgLabel=null;this._timeLabel=null;$super.apply(this)},setFrame:function($super){$super.apply(this,Array.prototype.slice.call(arguments,1));this.render()},setProduct:function(k){this._product=k;if(this._product){this.addState(b.PromoState);this._icon.addState(b.PromoState);this._msgLabel.addState(b.PromoState);h.registerPromoButton(this)}else{this.clearState(b.PromoState);this._icon.clearState(b.PromoState);this._msgLabel.clearState(b.PromoState);h.removePromoButton(this)}this.render()},render:function(){if(!this.getFrame()){return}var n=new d.ViewGeometry.Rect(this.getFrame());if(this._product){n.h=n.h-h.TimeLabelHeight}var m=this._style.extras;var l=n.w*(m.widthRatio-this._msgLabel.getText().length*m.characterWidth-m.iconSpacing);var o=n.h*m.heightRatio*m.iconSize;var k=Math.min(o,l);var q=(l>o)?(l-o)*m.iconGravityX:0;var p=(n.h*m.heightRatio-k)*m.iconGravityY;this._icon.setFrame([q,p,k,k]);this._msgLabel.setFrame([q+k,n.h*m.yRatio,n.w*m.widthRatio-q-k,n.h*m.heightRatio]);this._timeLabel.setFrame([0,p+k,n.w,h.TimeLabelHeight]);if(this._product){this.updateTimeLabel(new Date(),true);if(!this._timeLabel.getParent()){this.addChild(this._timeLabel)}}else{if(this._timeLabel.getParent()){this.removeChild(this._timeLabel)}}},updateTimeLabel:function(n,m){if(!this._product||!this._timeLabel){return}if(m||(this.getParent()&&this._timeLabel.getParent())){var k=this._product.getEndsAt();var l=new Date(k.getTime()-n.getTime());var o=h.getTimeString(l);this._timeLabel.setText(o)}},_onClickCb:null,setOnClickCb:function(k){this._onClickCb=k}});h.TimeLabelHeight=0;h.measureTimeLabelHeight=function(){d.measureText("2d 99:99:99",1000,1000,a.GameDownloadButtonStyle.getTextFont(),a.GameDownloadButtonStyle.getTextSize(),function(k){h.TimeLabelHeight=k.height})};h._promoButtons=[];h._timer=0;h.registerPromoButton=function(k){if(!(k in h._promoButtons)){h._promoButtons.push(k)}h.startTimeLabelUpdater()};h.removePromoButton=function(l){var k=h._promoButtons.indexOf(l);if(k!=-1){h._promoButtons.splice(k,1)}if(h._promoButtons.length==0){h.stopTimeLabelUpdater()}};h.startTimeLabelUpdater=function(){if(h._timer==0&&h._promoButtons.length>0){h.timeLabelUpdater();h._timer=setInterval(h.timeLabelUpdater,1000)}};h.stopTimeLabelUpdater=function(){if(h._timer!=0){clearInterval(h._timer);h._timer=0}};h.timeLabelUpdater=function(){if(h._promoButtons.length==0){h.stopTimeLabelUpdater()}else{var n=new Date();for(var m=0,k=h._promoButtons.length;m<k;++m){var l=h._promoButtons[m];l.updateTimeLabel(n)}}};h.getTimeString=function(p){var l=p.getTime();if(l<0){return"Expiring!"}var q="";if(p.getUTCDate()>1){q=""+(p.getDate()-1)+"d "}var o=String(p.getUTCHours());if(o.length==1){o="0"+o}var k=String(p.getUTCMinutes());if(k.length==1){k="0"+k}var n=String(p.getUTCSeconds());if(n.length==1){n="0"+n}return q+o+":"+k+":"+n}}};__ngs._a7={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var e=__ngs.r_(__ngs._6k).MobageStyle;var f=e.ScaledTextSize;var c=__ngs.r_(__ngs._2z).Assets;var a=__ngs.r_(__ngs._9u).CommonElements;e.lazyLoad(b,"CatalogCell",function(){return{style:{gradient:{gradient:["FFE6EDF5 0.0","FFE6EDF5 1.0"]},oddGradient:{gradient:["FFF9FCFD 0.0","FFF9FCFD 1.0"]},promoGradient:{gradient:["FFF9EFB0 0.0","FFF9EFB0 1.0"],insets:"{0,-1.0,0,-1.0}",innerLine:"FFC69622 1.0"},pressedGradient:{gradient:["66000000 0.0","66000000 0.0"]},pressedOddGradient:{gradient:["66000000 0.0","66000000 0.0"]},pressedPromoGradient:{gradient:["66000000 0.0","66000000 0.0"]}},children:{_gameImage:{style:{image:c.image("no-game-icon.png")}},_gameTitle:{style:{textFont:e.defaultBoldFontFace,textSize:f(15),textColor:"FF004AA9"}},_publisherLabel:{style:{textFont:e.defaultBoldFontFace,textSize:f(14),textColor:"FF000000",promoTextColor:"FFC69622"}},_infoLabel:{style:{textSize:f(13),textColor:"FF000000"}}},extras:{catalogCellWFactor:(582/800),catalogCellHFactor:(98/480),actionButtonXFactor:(438/582),actionButtonYFactor:(26/98),actionButtonWFactor:(130/582),actionButtonHFactor:(46/98),gameIconXFactor:(49/98),gameIconYFactor:(49/98),gameIconWFactor:(80/98),gameIconHFactor:(80/98),gameTitleXFactor:(104/582),gameTitleYFactor:(9/98),gameTitleWFactor:(325/582),gameTitleHFactor:(34/98),publisherNameXFactor:(104/582),publisherNameYFactor:(33/98),publisherNameWFactor:(325/582),publisherNameHFactor:(40/98),gameDescriptionXFactor:(104/582),gameDescriptionYFactor:(62/98),gameDescriptionWFactor:(328/582),gameDescriptionHFactor:(30/98),gameTextXSpacing:(8/53.3)}}});e.lazyLoad(b,"CatalogList",function(){return{children:{_listView:{style:{gradient:{corners:"4.0 4.0 4.0 4.0",gradient:["FFCAD2DD 0.0","FF7CA4C8 0.2","FF7CA4C8 1.0"]}}},_friendsButtonArea:{style:{gradient:{gradient:["FF93A2B1 0.000","FFB1BFCD 0.060","FFD0DAE4 0.940","FFADB9C6 1.000"],innerLine:"FFC9D1DA 1.0"}}},_labelFriends:{style:{textColor:"FF000000",textSize:f(12),textFont:e.defaultBoldFontFace}},_buttonAllGames:a.standardButton},extras:{catalogCellHFactor2:(1/5),friendsGamesHeaderHeight:62,friendsButtonAreaXRatio:206,friendsButtonAreaYRatio:433,labelFriendsXInsetFactor:217,labelFriendsYInsetFactor:454,labelFriendsWidthFactor:398,labelFriendsHeightFactor:22,allGamesButtonW:0.27,allGamesButtonAlignH:1-0.0188,allGamesButtonGravityH:1,buttonAllGamesYInsetFactor:439,buttonAllGamesHeightFactor:50}}})}};__ngs._a8={_c:null,_d:function(){var c={exports:{}};var f=c.exports;this._c=c;var d=__ngs.r_(__ngs._59).UI;var b=new (__ngs.r_(__ngs._f).RequireLoader)({SessionUtils:function(){return __ngs.r_(__ngs._ab).SessionUtils},MBListViewSection:function(){return __ngs.r_(__ngs._79).MBListViewSection},ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements},FullScreenEditor:function(){return __ngs.r_(__ngs._by).FullScreenEditor},NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities}});var e=__ngs.r_(__ngs._ae).Defines;var j=__ngs.r_(__ngs._77).Primitives;var a=__ngs.r_(__ngs._9h).Composite;var g=__ngs.r_(__ngs._9i).Components;var l=__ngs.r_(__ngs._n).LocalizedString;var k=a({key:"title",component:g.Label},{key:"content",component:g.EditText,altKey:"addressField"},{key:"button",component:g.UnspammableButton},g.AddOrders.Generator("title","content","button"),{classname:"DirectInviteCell",_ratios:null,insetRatio:0,initialize:function($super,n){$super(n);this.button.setSpamLockName("DirectInviteSpamLock");return this},layoutSubviews:function(){if(!this._ratios){var q=b.ListViewCellStyles.DirectInviteCell;q.applyTo(this);this._ratios=q.extras.ratios;this.button.setText(l("Send"));this.content.setPlaceholder(l("Enter a valid email address"))}var r=new d.ViewGeometry.Rect(this.getFrame());if(r.isEmpty()){return}r.x=r.y=0;var p=r.h*this.insetRatio;r.inset(r.h/5,r.h/5,r.h/5,r.h/5);var t=r.sliceHorizontal(this._ratios.button*r.w*-1);t.inset(p/2,p,p,p/2);var n=this.button.getFrameSize();var o=t.sliceHorizontal(t.w/8);this.button.setFrame(t);this.content.setFrame(r);if(!n||n[0]!=t.w){this.button.getTextMeasurementForState(d.State.Normal)}this.content.setInputType(this.content.InputTypes.Email);this.content.setEnterKeyType(d.Commands.EnterKeyType.Done)}});var m=j.ListViewItem.subclass({_reuseId:"contacts.directinviteitem",section:null,initialize:function($super){$super()},_onCreateView:function(){var n=new k();n.content.setInputType(n.getAddressFieldView().InputTypes.Email);return n},_onReleaseView:function(n){if(this.cell==n){this.cell=null}if(this.editor){this.editor.release()}if(this.fullScreenEditorFloat){this.fullScreenEditorFloat.release()}},_onSetView:function(n){this.cell=n;n.setState(d.State.Normal);n.insetRatio=b.ListViewCellStyles.Generics.extras.insetRatio;var p=new d.ViewGeometry.Rect(n.getFrame());var o=p.h*b.ListViewCellStyles.Generics.imageInsetRatio;n.button.setOnClick(this.bind(this.accessoryClicked));if(b.Capabilities.isPlatformIOS()){console.log("Setting up editor in invite section TRIPLENEW!");this.editor=(new b.FullScreenEditor()).retain();this.editor.setIsMultiline(false);this.editor.setMaxCharacters(240);this.editor.setup(l("You can also invite others to Mobage"),l("Send"),this.bind(function(){this.cell.content.setEnabled(true);this.cell.content.setText(this.editor.getText());this.accessoryClicked()}),this.bind(function(){this.cell.content.setEnabled(true);this.cell.content.setText(this.editor.getText())}));this.fullScreenEditorFloat=(new d.Button()).retain();this.cell.addChild(this.fullScreenEditorFloat);this.fullScreenEditorFloat.setFrame(this.cell.content.getFrame());this.fullScreenEditorFloat.setOnClick(this.bind(function(){console.log("Clicked cell!");this.editor.show(this.cell.content.getText());this.cell.content.setEnabled(false)}))}},accessoryClicked:function(){var o=this;var n=this.cell.content.getText().replace(/^\s+|\s+$/g,"");this.logd("Attempting to invite:"+n);if(b.SessionUtils.User.hasSentFriendInviteToEmail(n)){b.UIUtils.showToast(l("You've already sent an invite to that address!"))}else{this.cell.content.setText("");b.SessionUtils.User.sendFriendInviteToEmailIfPossible(n,function(r,s){if(r&&s&&s.error==e.SERVER_ERRORCODE_MALFORMED_EMAIL){var p=new d.Toast({text:s.error_msg});p.ondisappear=function(){p.destroy()};p.show();o.cell.content.setText(n)}else{if(r){if(b.NetworkUtils.wasNetworkDown()){o.cell.content.setText(n)}else{var q=(new d.AlertDialog()).retain();q.setTitle(l("Error"));q.setText(l("Error when trying to invite a friend. Error: %1s",r));q.setChoices([l("OK")]);q.onchoice=function(t){q.release();q=null};q.show()}}else{b.UIUtils.showToast(l("Email invite sent!"))}}})}}});var h=f.DirectInviteSection=b.MBListViewSection.subclass({classname:"DirectInviteSection",item:null,initialize:function($super,n){$super(n);if(!this._items){this._items=[]}var o=new (__ngs.r_(__ngs._7a).ContactsSectionTitleView)();o.setTitle(l("You can also invite others to Mobage"));this.setSectionHeader(o);this.item=new m();this.setItems([this.item]);this.setRowHeightRatio(1/5);return this},setText:function(n){this.item.cell.setAddressFieldText(n)},destroy:function(){}})}};__ngs._a9={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var f=__ngs.r_(__ngs._6k).MobageStyle;var b=f.ScaledCorners;var g=f.ScaledTextSize;var d=__ngs.r_(__ngs._2z).Assets;var a=__ngs.r_(__ngs._9u).CommonElements;f.lazyLoad(c,"SuggestedFriends",function(){return{children:{_titleHeader:a.header},extras:{headerHeightRatio:1/8,refreshButtonWidthRatio:2.5}}});f.lazyLoad(c,"UserSearchHeader",function(){return{style:{gradient:{gradient:["FF143558 0.0","FF295D8D 1.0"]}},children:{button:{style:{image:d.image("findfriends_usersearch_button.png"),textColor:"FFFFFFFF",gradient:{gradient:["FF7a9de1 0.0","FF7a9de1 1.0"],corners:b(8),innerLine:"4484C3E9 2.0"},pressedGradient:{corners:b(8),gradient:["FF3682C3 0.000","FF1C61A8 1.000"],innerLine:"2B003366 2.0"}}},content:{style:{gradient:{corners:b(6),gradient:["FFC9C9C9 0.000","FFEDEDED 1.000"],outerLine:"FF000000 2.0",insets:"{0.0,0.0,2.0,0.0}"},errorGradient:{corners:b(6),gradient:["FFC9C9C9 0.000","FFEDEDED 1.000"],outerLine:"FFFF0000 2.0",insets:"{0.0,0.0,2.0,0.0}"},textFont:f.defaultRegularFontFace,textColor:"FF000000",textSize:g(14),textGravity:[0,0.5]}}},extras:{headerHeightRatio:0.155}}});f.lazyLoad(c,"ContactsSectionTitle",function(){return{style:{textSize:g(14),textGravity:[0,0.5],textFont:f.defaultBoldFontFace,textColor:"FFFFFFFF",textInsets:[0,0,0,10],gradient:{gradient:["FF143558 0.0","FF295D8D 1.0"],innerShadow:"FF00 1.0 {0,0}"}}}});f.lazyLoad(c,"ContactsSectionSubTitle",function(){return{style:{textSize:g(14),textGravity:[0,0.5],textFont:f.defaultBoldFontFace,textColor:"FF575a5e",textInsets:[0,0,0,10],imageGravity:[1,0.5],image:d.image("ignore_subtitle_x.png"),imageFit:6,gradient:{gradient:["FF9bb1ca 0.0","FFC5D2E1 1.0"],innerShadow:"FF00 1.0 {0,0}"},pressedImage:d.image("ignorePress_subtitle_x.png"),disabledImage:d.image("")}}})}};__ngs._aa={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._1);var d=__ngs.r_(__ngs._bz);var e=d.ContactsScanBase.subclass({classname:"AddressBookScan",initialize:function($super){$super()},getMore:function(f){a.SystemBinding.getContacts(f)}});b.AddressBookScan=e}};__ngs._ab={_c:null,_d:function(){var b={exports:{}};var f=b.exports;this._c=b;var a=__ngs.r_(__ngs._o);var h=__ngs.r_(__ngs._30);var d=__ngs.r_(__ngs._c0).StringUtils;var e=__ngs.r_(__ngs._ae).Defines;var g=null;var c=d.trim;var j=f.SessionUtils={getCurrentSessionStorage:function(){if(!a.Session.getCurrentSession()){NgLogE("SessionStorage: you can't use this without a session!");return null}if(!a.Session.getCurrentSession().localStorage){a.Session.getCurrentSession().localStorage=new Object()}return a.Session.getCurrentSession().localStorage},User:{sendFriendInviteToEmailIfPossible:function(k,l){if(!k){k=""}var m=g();if(c(k).toLowerCase() in m){l("Already Sent Invite")}else{if(!h.User.emailAddressLooksValid(k)){l("Malformed email",{success:false,error:e.SERVER_ERRORCODE_MALFORMED_EMAIL,error_msg:"Please enter a valid email address."})}else{h.User.sendFriendInviteToEmail(k,function(n,o){if(!n){m[c(k).toLowerCase()]=1}l(n,o)})}}},hasSentFriendInviteToEmail:function(k){if(!k){k=""}var l=g();if(c(k).toLowerCase() in l){return true}return false}}};g=function(){var k=j.getCurrentSessionStorage();if(!k.sentInvites){k.sentInvites=new Object()}return k.sentInvites}}};__ngs._ac={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var c=__ngs.r_(__ngs._7g).ViewController;var f=__ngs.r_(__ngs._c1).UpgradeUserSection;var b=new (__ngs.r_(__ngs._f).RequireLoader)({Session:function(){return __ngs.r_(__ngs._o).Session},Credentials:function(){return __ngs.r_(__ngs._2r).Credentials},FacebookRegistration:function(){return __ngs.r_(__ngs._76).FacebookRegistration}});var a=d.UpgradeUserController=c.subclass({classname:"UpgradeUserController",initialize:function($super,g){$super();this._pageName=g},loadView:function(){if(!this._view){var g=new f();g.item.setSignUpWithFBCb(this.signUpWithFB_cbHandler.bind(this));g.item.setSignUpWithEmailCb(this.signUpWithEmail_cbHandler.bind(this));g.item.startOverCb(this.startOver_cbHandler.bind(this));this.setView(g)}},destroy:function($super){$super()},signUpWithFB_cbHandler:function(){var g=b.Session.getCurrentSession();if(g.user()&&g.user().usesGuestLogin()){b.Credentials.showRegistration(null,true,true,"tiered","facebook",this._pageName+"_fbBtn")}},signUpWithEmail_cbHandler:function(){var g=b.Session.getCurrentSession();if(g.user()&&g.user().usesGuestLogin()){b.Credentials.showRegistration(null,true,true,"tiered","signUp",this._pageName+"_emailBtn")}},startOver_cbHandler:function(){var g=b.Session.getCurrentSession();if(g.user()&&g.user().usesGuestLogin()){b.FacebookRegistration.startOver(this._pageName+"_startOverBtn")}}})}};__ngs._ad={_c:null,_d:function(){var b={exports:{}};var I=b.exports;this._c=b;var q=__ngs.r_(__ngs._59).UI;var k=q.ViewGeometry.Rect;var f=q.ViewGeometry.Scale;var C=new (__ngs.r_(__ngs._f).RequireLoader)({UserIconView:function(){return __ngs.r_(__ngs._c2).UserIconView},VerticalLabelImageButtonComponent:function(){return __ngs.r_(__ngs._c3).VerticalLabelImageButtonComponent},HorizontalLabel_ImageButtonComponent:function(){return __ngs.r_(__ngs._c4).HorizontalLabel_ImageButtonComponent},SessionUtils:function(){return __ngs.r_(__ngs._ab).SessionUtils},ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},MobageStyle:function(){return __ngs.r_(__ngs._6k).MobageStyle}});var a=__ngs.r_(__ngs._n).LocalizedString;var j=__ngs.r_(__ngs._ae).Defines;var B=__ngs.r_(__ngs._9h);var E=B.Composite;var s=__ngs.r_(__ngs._ao).CompositeButton;var u=__ngs.r_(__ngs._9i);var H=u.Components;var x=u.Component;var A=u.ComponentInheritForKey;var m=u.ACCESSOR_PASSTHROUGH;var w=E({CompositeClass:B.CompositeLayoutGroup},{key:"content",component:H.Label,altKey:"title"},{key:"subtitle",component:H.Label},H.AddOrders.TwoVerticalContentSubtitle,H.Layouts.TwoVerticalContentSubtitle,{classname:"UserCellView_MessageView"});var D=x(A(H.Label,"title"),A(H.Label,"subtitle"),{initializeViewWithKey:function(J){this[J]=(new w()).retain()}});var h=E({CompositeClass:B.CompositeLayoutGroup},{key:"content",component:H.Label,altKey:"title"},{key:"middleLabel",component:H.Label},{key:"subtitle",component:H.Label},H.AddOrders.Generator("content","middleLabel","subtitle"),{classname:"UserCellView_ThreeItemMessageView",layoutSubviews:function(){var K=new k(this.getFrame());if(K.isEmpty()){NgLogD(this.classname+": abort layoutSubviews, no-frame.");return}K.x=K.y=0;var L=0.3;var J=0.3;var M=K.h*L;var N=K.h*J;this.subtitle.setFrame(K.sliceVertical(0-M));this.middleLabel.setFrame(K.sliceVertical(0-N));this.content.setFrame(K)}});var p=x(A(H.Label,"title"),A(H.Label,"middleLabel"),A(H.Label,"subtitle"),{initializeViewWithKey:function(J){this[J]=(new h()).retain()}});var d=E({key:"content",component:H.EditText,altKey:"field"},{key:"sendButton",component:H.UnspammableButton},H.AddOrders.Generator("content","sendButton"),H.Layouts.TwoHorizontalGenerator("content","sendButton"),{classname:"InviteEmailForm",initialize:function(J){C.ListViewCellStyles.InviteEmailForm.applyTo(this);this._formComponent=null;this._listViewItem=null;this.content.setText("");this.content.setInputType(this.field.InputTypes.Email);this.sendButton.setText(a("Send"))},removeFromOwner:function(){if(this.getFormComponent()){this._formComponent.showCellContents();this.removeFromParent();this._formComponent=null}},setNewOwner:function(K,J){this.removeFromOwner();if(this.getListViewItem()!==null&&this.getListViewItem()!=J){this.getListViewItem().setFormShown(false)}this._formComponent=K;this._listViewItem=J;K.addChild(this)},getFormComponent:function(){return this._formComponent},getListViewItem:function(){return this._listViewItem}});var y=null;function g(){if(y===null){y=new d()}return y}function e(){y=null}var t=x(H.View,A(H.EditText,"field"),A(H.UnspammableButton,"sendButton"),{initializeViewWithKey:function(J){this._inviteEmailFormKey=J;this._formHistory={};this._form=null;this._listViewItem=null},destroy:function(){if(this.$super&&this.$super.destroy){this.$super.destroy()}else{NgLogD("InviteEmailFormComponent: does not have a this.$super.destroy() object")}if(y!==null){e()}},enableForm:function(J){this.showFormForItem(J)},disableForm:function(){if(!y){return}var J=g();if(J.getFormComponent()==this){J.removeFromOwner()}},showFormForItem:function(J){this._listViewItem=J;var K=this[this._inviteEmailFormKey]=g();var L=(K.getListViewItem()!=J);K.setNewOwner(this,J);this.hideCellContents();if(L){this._updateForm(K)}},_updateForm:function(L){L.content.setPlaceholder(a("Enter %1s's email...",this.content.content.getText()));L.sendButton.setText("Send");L.content.setText("");var K=new k(this.getFrame());K.x=K.y=0;if(!K.isEmpty()){var J=K.h*this._style.extras.insetRatio;L.setFieldInset([J,J/2,J,J]);L.setSendButtonInset([J,J,J,J/2]);L.sendButton.setFrameSize([K.w*this._style.extras.buttonWidthRatio,K.h-J*2]);L.setFrame(K);L.sendButton.setOnClick(this.accessoryClicked.bind(this));L.getFieldView().setState(q.State.Normal)}},hideCellContents:function(){C.ListViewCellStyles.InviteCellForm.applyTo(this);this._setCellContentsVisible(false)},showCellContents:function(){C.ListViewCellStyles.Generics.applyTo(this);this._setCellContentsVisible(true)},_setCellContentsVisible:function(K){var L,J=[];for(L in this._compositeDestroys){J.push(L)}J.reverse();for(L in J){var M=J[L];if(this._inviteEmailFormKey!=M&&this.hasOwnProperty(M)&&this[M]&&typeof this[M].removeFromParent=="function"){if(K){this.addChild(this[M])}else{this[M].removeFromParent()}}}},accessoryClicked:function(){this[this._inviteEmailFormKey].content.setState(q.State.Normal);var J=this[this._inviteEmailFormKey].content.getText();var K=g();if(C.SessionUtils.User.hasSentFriendInviteToEmail(J)){C.UIUtils.showToast(a("You've already sent an invite to that address."))}else{C.SessionUtils.User.sendFriendInviteToEmailIfPossible(J,function(M,N){var L;if(M&&N&&N.error==j.SERVER_ERRORCODE_MALFORMED_EMAIL){C.UIUtils.showToast(N.error_msg);this.form.getFieldView().setState(C.MobageStyle.ErrorState)}else{if(M){C.UIUtils.showToast(a("Please type a valid e-mail address"));this.form.getFieldView().setState(C.MobageStyle.ErrorState);this.form.content.setText(J)}else{this.accessoryButton.setText(a("Invited"));this.accessoryButton.setEnabled(false);this._listViewItem.contact.lowercaseEmails.push(J);this._listViewItem.contact.invited=true;this._listViewItem.emailIndex=0;if(this._listViewItem&&K.getListViewItem()==this._listViewItem){K.removeFromOwner();K.content.setText("");this._listViewItem.setFormShown(false)}this._listViewItem._onSetView(this._listViewItem.cell)}}}.bind(this))}}});var G=H.Layouts.ThreeHorizontalGenerator("icon","content","accessoryButton").layoutSubviews;var F=I.UserCellView=E({key:"icon",component:C.UserIconView.Component},{key:"content",component:D,altKey:"message"},{key:"accessoryButton",component:H.UnspammableButton},{key:"emailForm",component:t},H.AddOrders.Generator("content","icon","accessoryButton"),{classname:"UserCellView",layoutSubviews:function($super){if($super&&typeof $super==="function"){$super()}G.call(this);var K=new k(this.icon.getFrame());if(K.isEmpty()){return}var J=(K.w-K.h)/2;K.w=K.h;K.x+=J;this.icon.setFrame(K)}},s);var o=I.UserCellView_TappableRowVariant=E({CompositeClass:B.CompositeView},{key:"icon",component:C.UserIconView.Component},{key:"content",component:p,altKey:"message"},{key:"accessoryButton",component:H.UnspammableButton},{key:"accessoryButtonAlt1",component:H.UnspammableButton},{key:"emailForm",component:t},H.AddOrders.Generator("content","icon","accessoryButton","accessoryButtonAlt1"),{classname:"UserCellView_TappableRowVariant",layoutSubviews:function($super){if($super&&typeof $super==="function"){$super()}G.call(this);this.accessoryButtonAlt1.setFrame(this.getFrame()[2],this.accessoryButton.getFrame()[1],this.accessoryButton.getFrame()[2],this.accessoryButton.getFrame()[3]);var K=new k(this.icon.getFrame());if(K.isEmpty()){return}var J=(K.w-K.h)/2;K.w=K.h;K.x+=J;this.icon.setFrame(K)}},s);var v=I.UserCellView_NonTappableRowVariant=E({CompositeClass:B.CompositeView},{key:"icon",component:C.UserIconView.Component},{key:"content",component:p,altKey:"message"},{key:"accessoryButton",component:H.UnspammableButton},{key:"emailForm",component:t},H.AddOrders.Generator("content","icon","accessoryButton"),{classname:"UserCellView_TappableRowVariant",layoutSubviews:function($super){if($super&&typeof $super==="function"){$super()}G.call(this);var K=new k(this.icon.getFrame());if(K.isEmpty()){return}var J=(K.w-K.h)/2;K.w=K.h;K.x+=J;this.icon.setFrame(K)}});var l=I.UserCellView_OneMessageNoIcon=E({CompositeClass:B.CompositeView},{key:"content",component:H.Label,altKey:"message"},{key:"accessoryButton",component:H.UnspammableButton},H.AddOrders.Generator("content","accessoryButton"),H.Layouts.TwoHorizontalGenerator("content","accessoryButton"),{classname:"UserCellView_OneMessageNoIcon"},s);var n=H.Layouts.ThreeHorizontalGenerator("icon","content","rightAccessory").layoutSubviews;var z=I.UserCellView_ThreeItemMessage_TappableRowVariant=E({CompositeClass:B.CompositeView},{key:"icon",component:C.UserIconView.Component},{key:"content",component:p,altKey:"message"},{key:"rightAccessory",component:C.VerticalLabelImageButtonComponent},H.AddOrders.Generator("content","icon","rightAccessory"),{classname:"UserCellView_ThreeItemMessage_TappableRowVariant",layoutSubviews:function($super){if($super&&typeof $super==="function"){$super()}n.call(this);var K=new k(this.icon.getFrame());if(K.isEmpty()){return}var J=(K.w-K.h)/2;K.w=K.h;K.x+=J;this.icon.setFrame(K)}},s);var c=H.Layouts.ThreeHorizontalGenerator("icon","content","accessoryButton").layoutSubviews;var r=I.UserCellView_ThreeItemMessage_TappableColumnVariant=E({CompositeClass:B.CompositeView},{key:"icon",component:C.UserIconView.Component},{key:"content",component:D,altKey:"message"},{key:"accessoryButton",component:C.HorizontalLabel_ImageButtonComponent},H.AddOrders.Generator("content","icon","accessoryButton"),{classname:"UserCellView_ThreeItemMessage_TappableColumnVariant",layoutSubviews:function($super){if($super&&typeof $super==="function"){$super()}c.call(this);var K=new k(this.icon.getFrame());if(K.isEmpty()){return}var J=(K.w-K.h)/2;K.w=K.h;K.x+=J;this.icon.setFrame(K);this.logd("Squared the UserIcon's frame: ",K)}},s)}};__ngs._ae={_c:null,_d:function(){var c={exports:{}};var a=c.exports;this._c=c;var b=a.Defines={SERVER_ERRORCODE_MALFORMED_EMAIL:103}}};__ngs._af={_c:null,_d:function(){var d={exports:{}};var g=d.exports;this._c=d;var f=__ngs.r_(__ngs._59).UI;var c=__ngs.r_(__ngs._4).Device;var l=__ngs.r_(__ngs._5).Core;var b=f.ViewGeometry.Scale;var a=new (__ngs.r_(__ngs._f).RequireLoader)({OldStyle:function(){return __ngs.r_(__ngs._60).Style},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},GameProfileStyle:function(){return __ngs.r_(__ngs._ak)}});var e=false;var m=false;var j=__ngs.r_(__ngs._5y).NavigableViewController;var h=g.FullScreenshotController=j.subclass({classname:"FullScreenshotController",_overlayButton:null,_screenClose:null,_screenshots:null,_screenIndex:0,_landscapeFrame:null,_portraitFrame:null,_sheet:null,_gameForScreens:null,_retainedViews:null,initialize:function($super,n,o){$super();this._gameForScreens=n;a.GameProfileStyle;this._style=a.GameProfileStyle.GameProfile;this._sheet=a.OldStyle.registeredStyle("social.us.gameprofile").props();this._landscapeFrame=[0,0,l.Capabilities.getScreenHeight(),l.Capabilities.getScreenWidth()];this._portraitFrame=[0,0,l.Capabilities.getScreenWidth(),l.Capabilities.getScreenHeight()];this._screenshots=[];if(o){this._screenIndex=o}},destroy:function(){this.stopOrientationListening();if(this._retainedViews){for(var n=0;n<this._retainedViews.length;n++){var o=this._retainedViews[n];if(o){o.release()}}}this._retainedViews=new Array()},retainView:function(n){if(n){n.retain();if(!this._retainedViews){this._retainedViews=new Array()}this._retainedViews.push(n)}return n},loadView:function($super){if(!this._view){this.setView(new f.View())}$super();var p=this.bind(function(r){var q=r?r.direction:undefined;switch(q){case f.Commands.SwipeDirection.Left:this.setScreenIndex(this._screenIndex+1);break;case f.Commands.SwipeDirection.Right:this.setScreenIndex(this._screenIndex-1);break;default:return}});this.view().setAttributes(this._sheet.screenFullWrapper);for(var o in this._gameForScreens.phone_screenshot_urls){var n=this.retainView(new f.Image());if(m){n.setImage(__ngs.r_(__ngs._2z).Assets.image("no-game-icon.png"))}if(!e){n.setImage(this._gameForScreens.phone_screenshot_urls[o])}this._screenshots[this._screenshots.length]=n;this.view().addChild(n)}this._screenClose=this.retainView(new f.Button());this._screenClose.setText("x");this._screenClose.onclick=this.bind(function(){if(this.navController){this.navController.back()}});this._overlayButton=this.retainView(new f.Button());this._overlayButton.setOnClickDown(function(){});this._overlayButton.setOnSwipe(p);this._overlayButton.setOnClick(function(){});this.view().addChild(this._overlayButton);this.layoutSubviews(this._landscapeFrame);this._style.applyTo(this)},startOrientationListening:function(){if(!this.oListener){this.oListener=new k();c.OrientationEmitter.addListener(this.oListener,this.onOrientationUpdate.bind(this))}},stopOrientationListening:function(){if(this.oListener){c.OrientationEmitter.removeListener(this.oListener);this.oListener.destroy();this.oListener=null}},storeOrientation:function(){this._oldOrientation=c.OrientationEmitter.getInterfaceOrientation()},restoreOrientation:function(){if(this._oldOrientation!==undefined){if(c.OrientationEmitter.getInterfaceOrientation()!=this._oldOrientation){this.setInterfaceOrientation(this._oldOrientation)}}},setScreenIndex:function(p,o){if(p<0||p>=this._gameForScreens.phone_screenshot_urls.length){return}this._screenIndex=p;if(e){this._screenshots[p].setImage(this._gameForScreens.phone_screenshot_urls[p])}var r=o?0:500;var s=this.view().getFrame();var n=s[2];var q=this;f.animate(function(){NgLogD("TRYING TO ANIMATE GAME SCREENSHOTS: "+p+" * "+n);var t=-p*n;for(var u in q._screenshots){q._screenshots[u].setFrame([t,0,s[2],s[3]]);t+=n}},r,function(){NgLogD("Finished Animation")})},layoutSubviews:function(o){this.view().setFrame([0,0,o[2],o[3]]);if(this._overlayButton){this._overlayButton.setFrame([0,0,o[2],o[3]])}var u=0;var z=o[2];for(var p in this._screenshots){var q=this._screenshots[p];if(q){q.setFrame([u,0,o[2],o[3]])}u+=z}if(this._screenClose){var v=Math.max(o[2],o[3]);var n=this._style.extras.viewRatio;var w=o[2]-v*(n.screenCloseWidthRatio+n.screenCloseXRatio);var t=v*n.screenCloseYRatio;var y=v*n.screenCloseWidthRatio;var s=v*n.screenCloseHeightRatio;this._screenClose.setFrame([w,t,y,s])}this.setScreenIndex(this._screenIndex,true)},willPush:function($super,n){$super(n);this.prepareNavController()},didPush:function($super,n){$super(n);f.Window.document.addChild(this._screenClose);this.storeOrientation();this.startOrientationListening()},willPop:function($super,n){$super(n);f.Window.document.removeChild(this._screenClose);this.stopOrientationListening();this.restoreOrientation()},didPop:function($super,n){$super(n);this.restoreNavController()},willReshow:function($super,n){$super(n);this.prepareNavController()},didReshow:function($super,n){$super(n);f.Window.document.addChild(this._screenClose);this.storeOrientation();this.startOrientationListening()},willHide:function($super,n){$super(n);f.Window.document.removeChild(this._screenClose);this.stopOrientationListening();this.restoreOrientation()},didHide:function($super,n){$super(n);this.restoreNavController()},prepareNavController:function(){a.ServiceHost.navController.setLandscapeOnly(false);this.navController._host.resurfaceControls(true)},restoreNavController:function(){a.ServiceHost.navController.setLandscapeOnly(true);this.navController._host.resurfaceControls()},onOrientationUpdate:function(n){if(n){if(n.type==c.OrientationEmitter.OrientationType.Device){this.setInterfaceOrientation(n.orientation)}}},setInterfaceOrientation:function(o){var r=null;var p=o;if(o==c.OrientationEmitter.Orientation.Portrait||o==c.OrientationEmitter.Orientation.PortraitUpsideDown){r=this._portraitFrame;if(l.Capabilities.isPlatformAndroid()){p=c.OrientationEmitter.Orientation.Portrait}}else{r=this._landscapeFrame;if(o!=c.OrientationEmitter.Orientation.LandscapeRight){p=c.OrientationEmitter.Orientation.LandscapeLeft}if(l.Capabilities.isPlatformAndroid()){p=c.OrientationEmitter.Orientation.LandscapeLeft}}if(p==c.OrientationEmitter.getInterfaceOrientation()){return}if(!a.ServiceHost.isMenuDrawerClosedOrClosing()){a.ServiceHost.closeMenuDrawer(false,false)}var n;for(n in this._screenshots){this._screenshots[n].removeFromParent()}if(this._screenClose){this._screenClose.removeFromParent()}var s=Math.max(l.Capabilities.getScreenWidth(),l.Capabilities.getScreenHeight());var q=[0,0,s,s];a.ServiceHost.view().setFrame(q);a.ServiceHost.navController.view().setFrame(q);this.view().setFrame(q);c.OrientationEmitter.setInterfaceOrientation(p);a.ServiceHost.view().setFrame(r);a.ServiceHost.navController.view().setFrame(r);this.view().setFrame(r);this.layoutSubviews(r);if(this.view()){if(this._screenshots){for(n in this._screenshots){this.view().addChild(this._screenshots[n])}}if(this._screenClose){this.view().addChild(this._screenClose)}}}});var k=l.MessageListener.subclass({classname:"FullScreenshotController_orientationListener"})}};__ngs._ag={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var g=__ngs.r_(__ngs._5).Core;var f=__ngs.r_(__ngs._59).UI;var b=new (__ngs.r_(__ngs._f).RequireLoader)({OldStyle:function(){return __ngs.r_(__ngs._60).Style},Session:function(){return __ngs.r_(__ngs._o).Session},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},Game:function(){return __ngs.r_(__ngs._2e).Game},AppConfig:function(){return __ngs.r_(__ngs._29).AppConfig},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},GameDownloadButton:function(){return __ngs.r_(__ngs._a6).GameDownloadButton},GameDownloadStyle:function(){return __ngs.r_(__ngs._bh)},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics}});var a=__ngs.r_(__ngs._n).LocalizedString;var e=c.GameDownloadBar=f.View.subclass({classname:"GameDownloadBar",initialize:function($super){$super();this._game=null;this._product=null;b.GameDownloadStyle;this._sheet=b.OldStyle.registeredStyle("social.us.gamedownload").props();this._totalWidth=g.Capabilities.getScreenHeight();this._totalHeight=g.Capabilities.getScreenWidth();var h=this.onDownloadBarClicked.bind(this);this._download=this.retainView(new b.GameDownloadButton());this._download.setOnClickCb(h);this._play=this.retainView(new b.UnspammableButton());this._play.setFrame([0,0,100,100]);this._play.setText(a("Play"));this._play.setAttributes(this._sheet.playButton);this._play.onclick=h;this._backToMarketButton=this.retainView(new b.UnspammableButton());this._backToMarketButton.setFrame([0,0,100,100]);this._backToMarketButton.setText(a("Back to\nMarket"));this._backToMarketButton.setAttributes(this._sheet.backToMarketButton);this._backToMarketButton.onclick=h},destroy:function(){if(this._retainedViews){for(var h=0;h<this._retainedViews.length;h++){var j=this._retainedViews[h];if(j){j.release()}}}this._retainedViews=new Array();if(this._game){this._game.removeMarketAppDownloadWatcher(this)}this.removeGoToAppStoreListener()},retainView:function(h){if(h){h.retain();if(!this._retainedViews){this._retainedViews=new Array()}this._retainedViews.push(h)}return h},initLayout:function(){var k=new f.ViewGeometry.Rect(this.getFrame());var j=[k.w*this._sheet.downloadPlayXRatio,k.h*this._sheet.downloadPlayYRatio,k.w*this._sheet.downloadPlayWidthRatio,k.h*this._sheet.downloadPlayHeightRatio];var l=b.GameDownloadButton.TimeLabelHeight;var h=[j[0],j[1]+l*0.5,j[2],j[3]-l];this._play.setFrame(h);this._backToMarketButton.setFrame(h);this._download.setFrame((this._product)?j:h)},setGame:function(h,j){if(this._game){this._game.removeMarketAppDownloadWatcher(this)}if(h){h.addMarketAppDownloadWatcher(this)}this._game=h;this._product=j;this._recheckInstall=true;this._download.setProduct(j);if(h){this.update()}},onDownloadBarClicked:function(){if(!this._game){NgLogE("Mobage/GameDownladBar - empty game object, not launching");return}var h=(new Date()).getTime();var j=2000;if(e._lastDownloadBarClickTime){j=Math.abs(h-e._lastDownloadBarClickTime)}e._lastDownloadBarClickTime=h;if(this._downloadBarVerifying||j<600){NgLogD("GameDownloadBar Button Spamming Prevention");return}b.MobageAnalytics.reportEvent("JSGamePlayAndDLButton",{game:this._game.recordID});this._game.canLaunch(function(l){this._downloadBarVerifying=false;if(l){b.MobageAnalytics.reportEvent("JSGameLaunchGame",{game:this._game.recordID});if(this._game.recordID===b.Session.getCurrentSession().appKey()){b.ServiceHost.showLoadingHelper(function(){this._game.checkUpdateAndStartGame()}.bind(this))}else{this._game.checkUpdateAndStartGame()}}else{var m=function(){this._game.goToAppStore();this.update()}.bind(this);if(this._product){var k=new f.ProgressDialog({text:"Please Wait..."});k.show();this._product.acceptOffer(function(n){k.hide();if(n){var o=new f.AlertDialog({title:"Reward System is down.",text:"would you like to download this game anyway ?",choices:["I'll try later","Download"]});o.setOnChoice(function(p){o.hide();if(p.choice==1){m()}});o.show()}else{m()}}.bind(this))}else{m()}this.dispatchEventGoToAppStore()}}.bind(this),true)},update:function(){var h=this._game;if(!this._download||!this._backToMarketButton||!this._play){return}this.hide(this._download);this.hide(this._play);this.hide(this._backToMarketButton);if(!h){return}var j=this._recheckInstall;this._recheckInstall=false;h.canLaunch(this.bind(function(k){if(h!=this._game){return}if(!k){if(h.isWatchingForMarketAppDownload()){this.show(this._backToMarketButton)}else{this.show(this._download)}}else{this.show(this._play)}}),j)},show:function(h){if(h&&!h.getParent()){this.addChild(h)}},hide:function(h){if(h&&h.getParent()){h.removeFromParent()}},onMarketAppDownloaded:function(h){this.update()},beganWatchingMarketAppDownload:function(h){this.update()},_listener:null,addGoToAppStoreListener:function(h){this._listener=h},removeGoToAppStoreListener:function(){this._listener=null},dispatchEventGoToAppStore:function(){if(this._listener){this._listener()}}});e._lastDownloadBarClickTime=0}};__ngs._ah={_c:null,_d:function(){var b={exports:{}};var e=b.exports;this._c=b;var g=__ngs.r_(__ngs._5).Core;var c=__ngs.r_(__ngs._59).UI;var f=__ngs.r_(__ngs._60).Style;var d=__ngs.r_(__ngs._2z).Assets;var h=__ngs.r_(__ngs._2v).ServiceHost;var a=__ngs.r_(__ngs._c2).UserIconView;var j=__ngs.r_(__ngs._3s).Profile;var k=e.UserButton=c.View.subclass({initialize:function($super,m){$super();if(!m){return}this._sheet=f.registeredStyle("social.us.userbutton").props();this._totalWidth=g.Capabilities.getScreenHeight();this._totalHeight=g.Capabilities.getScreenWidth();this._userButtonIcon=this.retainView(new a());this._userButtonIcon.setImage(d.image("no-user-icon.png"));this._userButtonIcon.setFrame([0,0,10,10]);this._userButtonIcon.setImage(m.getDefinedIcon()||d.image("no-user-icon.png"));this.addChild(this._userButtonIcon);var n=m.gamertag;var l=this._sheet.maxFriendNameChars;if(n.length>l){n=n.substring(0,l-2)+".."}this._userButtonLabel=this.retainView(new c.Label());this._userButtonLabel.setFrame([0,0,10,10]);this._userButtonLabel.setText(n);this._userButtonLabel.setTextGravity(c.ViewGeometry.Gravity.Center);this._userButtonLabel.setAttributes(this._sheet.userButtonLabel);this.addChild(this._userButtonLabel);this._clickView=this.retainView(new c.View());this._clickView.setFrame([0,0,10,10]);this._clickView.onclick=function(){h.showLoadingHelper(function(){var o={data:{user:m}};j.showUserProfile(o)})};this.addChild(this._clickView)},destroy:function(){if(this._retainedViews){for(var l=0;l<this._retainedViews.length;l++){var m=this._retainedViews[l];if(m){m.release()}}}this._retainedViews=new Array()},retainView:function(l){if(l){l.retain();if(!this._retainedViews){this._retainedViews=new Array()}this._retainedViews.push(l)}return l},xSize:function(l){return(l/800)*this._totalWidth},ySize:function(l){return(l/480)*this._totalHeight},setUserButtonFrame:function(n){this.setFrame(n);var m=new c.ViewGeometry.Rect(n);if(!m.isEmpty()){if(this._userButtonIcon){var l=this.xSize(this._sheet.userButtonIconWidth);this._userButtonIcon.setFrame([m.w/2-l/2,this.ySize(this._sheet.userButtonIconY),l,l])}if(this._userButtonLabel){this._userButtonLabel.setFrame([0,this.ySize(this._sheet.userButtonLabelY),m.w,this.ySize(this._sheet.userButtonLabelHeight)])}if(this._clickView){this._clickView.setFrame([0,0,m.w,m.h])}}}})}};__ngs._ai={_c:null,_d:function(){var c={exports:{}};var t=c.exports;this._c=c;var j=__ngs.r_(__ngs._59).UI;var b=__ngs.r_(__ngs._5).Core;var g=j.ViewGeometry.Rect;var f=j.ViewGeometry.Scale;var q=__ngs.r_(__ngs._60).Style;__ngs.r_(__ngs._88);var p=__ngs.r_(__ngs._9h);var r=p.Composite;var n=p.CompositeLayoutGroup;var k=__ngs.r_(__ngs._9i);var s=k.Components;var l=k.Component;var o=k.ComponentInheritForKey;var h=k.ACCESSOR_PASSTHROUGH;var e=__ngs.r_(__ngs._77).Primitives;var d=r({key:"content",component:s.Label,altKey:"field"},{key:"button",component:s.UnspammableButton},s.Layouts.TwoHorizontalGenerator("content","button"),s.AddOrders.Generator("content","button"),{classname:"CCViewHeader"});var a=l(s.Label,o(s.UnspammableButton,"button"),{initializeViewWithKey:function(u){this[u]=(new d()).retain()},getContentInset:h,setContentInset:h,getButtonInset:h,setButtonInset:h,setAttributes:h,setGradient:h});var m=t.CCView=r({CompositeClass:n},{key:"header",component:a},{key:"content",component:s.ScrollView},{key:"footer",component:s.View},{classname:"CCView",_headerHeightRatio:null,_footerHeightRatio:1,_insetRatio:null,_borderThicknessRatio:null,_bgHeightGrowthRatio:null,_secretBackgroundView:null,_secretBorderView:null,initialize:function($super,u){$super(u);return this},initSubviews:function($super){this._secretBackgroundView=(new e.View()).retain();this._secretBorderView=(new e.View()).retain();$super();var v=new q();v.defaultsFrom("social.us.ccview");var w=v.props();this._secretBackgroundView.setAttributes(w.bgAttributes);delete w.bgAttributes;this._secretBorderView.setAttributes(w.borderAttributes);delete w.borderAttributes;for(var u in w){if(w.hasOwnProperty(u)){this[u]=w[u]}}},destroy:function(){this._secretBorderView.release();this._secretBackgroundView.release()},addSubviews:function($super){this.addChild(this._secretBackgroundView);this._secretBackgroundView.addChild(this._secretBorderView);this._secretBorderView.addChild(this.header);this._secretBorderView.addChild(this.content);this._secretBorderView.addChild(this.footer)},layoutSubviews:function($super){var D=new g(this.getFrame());if(D.isEmpty()){return}D.x=D.y=0;var z=Math.round(D.h*this._borderThicknessRatio);var C=D.copy();C.h+=D.h*this._bgHeightGrowthRatio;this._secretBackgroundView.setFrame(C);var v=C.copy();v.x=v.y=0;v.inset(z);this._secretBorderView.setFrame(v);var w=v.copy();w.x=w.y=0;var F=1;var A=D.h*this._headerHeightRatio;var G=w.sliceVertical(A).inset(F,F,0,F);var y=Math.round(G.h*this._insetRatio+z);this.header.setContentInset([y,y/2,y,y]);this.header.setButtonInset([y,y,y,y/2]);this.header.button.setImageInsets([y/2,y/2,y/2,y/2]);G.h=Math.round(G.h);G.w=Math.round(G.w);this.header.setFrame(G);var x=0;if(A<F){x=F}var u=w.copy().inset(x,F,F,F);var B=(this.footer.getFrameSize()&&this.footer.getFrameSize().length&&!isNaN(this.footer.getFrameSize()[1]))?this.footer.getFrameSize()[1]:0;B=B*this._footerHeightRatio;var E=u.sliceVertical(0-B);this.content.setFrame(u);if(B>0){this.footer.setFrame(E)}else{this.footer.setFrame([0,0,0,0])}this.logd("CCView layout: our: ",D," header:",new g(this.header.getFrame())," background",C," border:",v," content:",u)},getContentWidth:function(){var u=this.content.getFrame();return u?u[2]:86}})}};__ngs._aj={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=new (__ngs.r_(__ngs._f).RequireLoader)({UI:function(){return __ngs.r_(__ngs._59).UI}});b.Layout=(__ngs.r_(__ngs._5).Core).Class.singleton({classname:"Layout",_genericMetrics:null,initialize:function(){this._genericMetrics=__ngs.r_(__ngs._9u).GenericMetrics},pixelSize:function(d,e){switch(e){case"horz_padding":return this._genericMetrics.hPadding*d;case"vert_padding":return this._genericMetrics.vPadding*d;case"vert_spacing":return this._genericMetrics.vSpacing*d;case"vert_spacing_big":return this._genericMetrics.vSpacingBig*d;case"view_header_height":return this._genericMetrics.viewHeaderH*d;case"view_header_text_x":return this._genericMetrics.viewHeaderTextX*d;case"view_header_text_width":return this._genericMetrics.viewHeaderTextW*d;case"button_height":return this._genericMetrics.buttonH*d;case"text_edit_height":return this._genericMetrics.textEditH*d;default:return NaN}},getPositionInContainer:function(f,e,d,g){return g*f-d*e},measureStrings:function(h,g,e){if(typeof e!="function"){e=function(){}}var k;var f=[];var j=function(m,n){return !m||!m.configUsed||m.configUsed.text!=n.text||m.configUsed.width!=n.width||m.configUsed.height!=n.height||m.configUsed.textFont!=n.textFont||m.configUsed.textSize!=n.textSize};for(k in h){if(typeof h[k].text!="string"){g[k]=null}else{if(j(g[k],h[k])){g[k]=null;f.push(k)}}}var l=f.length;if(l===0){e()}else{for(var d=0;d<f.length;d++){k=f[d];(function(m){a.UI.measureText(h[m].text,h[m].width,h[m].height,h[m].textFont,h[m].textSize,function(n){n.configUsed=h[m];g[m]=n;if(--l<=0){e()}})})(k)}}}})}};__ngs._ak={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var f=__ngs.r_(__ngs._6k).MobageStyle;var b=f.ScaledCorners;var g=f.ScaledTextSize;var a=__ngs.r_(__ngs._9u).CommonElements;var d=__ngs.r_(__ngs._2z).Assets;f.lazyLoad(c,"GameProfile",function(){return{children:{_loadingProgress:{style:{textColor:"FFFFFF00",gradient:{outerShadow:"FF8B8988 0.0 {0.0,-4.0}",corners:"0.0 0.0 0.0 0.0",innerShadow:"FFFFFEFE 2.0 {0.0,-1.0}",gradient:["FFECEBEE 0.000","FFCFD5D2 1.000"],outerLine:"FF8C9094 1.0"}}},_infoArea:{style:{gradient:{gradient:["FFDBE2EA 0.000","FFE9EFF3 1.000"],innerLine:"FFC9D1DA 1.0"}}},_gameName:{style:{textColor:"FF000000",textSize:g(17),textFont:f.defaultBoldFontFace}},_gamePublisher:{style:{textColor:"FF000000",textSize:g(12),textFont:f.defaultBoldFontFace}},_promoLabel:{style:{textColor:"FFC69622",textSize:g(19),textFont:f.defaultBoldFontFace}},_promoDesc:{style:{textColor:"FF000000",textSize:g(18),textFont:f.defaultRegularFontFace}},_gameDesc:{style:{textColor:"FF000000",textSize:g(12),textFont:f.defaultRegularFontFace}},_readMore:{style:{textColor:"FF004AA9",textSize:g(12),textFont:f.defaultBoldFontFace}},_friendArea:{style:{gradient:{gradient:["FFDBE2EA 0.000","FFE9EFF3 1.000"],innerLine:"FFC9D1DA 1.0"}}},_friendCountLabel:{style:{textColor:"FF000000",textSize:g(12),textFont:f.defaultBoldFontFace}},_friendButton:{style:{textColor:"FF333333",textSize:g(11),textFont:f.defaultBoldFontFace,imageBorder:{insets:"{0.0,0.0,0.0,0.0}",corners:"2.0 2.0 2.0 2.0",outerLine:"55676A68 1.5"}}},_showMore:{style:{textColor:"FF004AA9",textSize:g(12),textFont:f.defaultBoldFontFace}},_screenshotArea:{style:{gradient:{gradient:["FFDBE2EA 0.000","FFE9EFF3 1.000"],innerLine:"FFC9D1DA 1.0"}}},_screenshotsHeader:{style:{textColor:"FF000000",textSize:g(12),textFont:f.defaultBoldFontFace}},_screenFullWrapper:{style:{gradient:{gradient:["FFFFFFFF 0.000","FFFFFFFF 1.000"]}}},_screenClose:{style:{gradient:{corners:"6.0 6.0 6.0 6.0",gradient:["FF000000 0.000","FF000000 1.000"]},pressedGradient:{corners:"6.0 6.0 6.0 6.0",gradient:["FF525252 0.000"]},textColor:"FFFFFFFF",textSize:g(26)}},_bottomArea:{style:{gradient:{gradient:["FFDBE2EA 0.000","FFE9EFF3 1.000"],innerLine:"FFC9D1DA 1.0"}}},_support:a.standardButton},extras:{viewRatio:{gameDescLinesDefault:2,maxFriendNameChars:7,maxFriendsPerRow:5,maxScreenshotsPerRow:2,infoAreaHeightRatio:177,friendAreaHeightRatio:(185-88),screenshotAreaHeightRatio:(408-(2*160)-20),bottomAreaHeightRatio:112,infoAreaXRatio:206,infoAreaYRatio:84,gameIconXRatio:220,gameIconYRatio:98,gameIconWidthRatio:130,gameIconHeightRatio:123,gameNameXRatio:370,gameNameYRatio:97,gameNameWidthRatio:239,gameNameHeightRatio:34,gamePublisherXRatio:371,gamePublisherYRatio:128,gamePublisherWidthRatio:239,gamePublisherHeightRatio:23,promoLabelXRatio:370,promoLabelYRatio:165,promoLabelWidthRatio:372,promoLabelHeightRatio:29,promoDescXRatio:370,promoDescYRatio:192,promoDescWidthRatio:372,promoDescHeightRatio:28,gameDescXRatio:370,gameDescYRatio:171,gameDescPromoYRatio:235,gameDescWidthRatio:372,gameDescCharWidthRatio:11,gameDescLineHeightRatio:22,downloadBarXRatio:596,downloadBarYRatio:98,downloadBarWidthRatio:118,downloadBarHeightRatio:46,downloadBarRRatio:780,readMoreAlignH:1-0.0188,readMoreGravityH:1,readMoreXRatio:608,readMoreYRatio:48,readMoreWidthRatio:160,readMoreHeightRatio:(22*2),readMoreImageWidthRatio:12,readMoreTextInsetRatio:20,friendAreaXRatio:206,friendAreaYRatio:261,friendCountLabelXRatio:222,friendCountLabelYRatio:(275-2),friendCountLabelWidthRatio:373,friendCountLabelHeightRatio:22,friendButtonXRatio:(239-17),friendButtonYRatio:307,friendButtonWidthRatio:(62+(2*17)),friendButtonHeightRatio:88,friendButtonXMarginRatio:(50-(2*17)),friendButtonYMarginRatio:(111-88),showMoreAlignH:1-0.0188,showMoreGravityH:1,showMoreXRatio:608,showMoreYRatio:48,showMoreWidthRatio:160,showMoreHeightRatio:(22*2),showMoreImageWidthRatio:12,showMoreTextInsetRatio:20,screenshotAreaXRatio:206,screenshotAreaYRatio:446,screenshotsHeaderXRatio:222,screenshotsHeaderYRatio:(459-2),screenshotsHeaderWidthRatio:355,screenshotsHeaderHeightRatio:22,screenThumbXRatio:226,screenThumbYRatio:489,screenThumbWidthRatio:238,screenThumbHeightRatio:160,screenThumbXMarginRatio:18,screenThumbYMarginRatio:20,bottomAreaXRatio:206,bottomAreaYRatio:854,supportXRatio:(485-(272/2)),supportYRatio:908,supportWidthRatio:254,supportHeightRatio:46,screenCloseXRatio:0.025,screenCloseYRatio:0.025,screenCloseWidthRatio:0.075,screenCloseHeightRatio:0.075}}}});f.lazyLoad(c,"ScreenThumb",function(){return{style:{gradient:{corners:b(4),gradient:["FFFFFFFF 0.000","FFFFFFFF 1.000"],outerLine:"FF627792 1"},imageInsets:[4,4,4,4],imageBorder:{innerLine:"FFD9DEE5 1"}}}})}};__ngs._al={_c:null,_d:function(){var d={exports:{}};var a=d.exports;this._c=d;var f=__ngs.r_(__ngs._59).UI;var e=__ngs.r_(__ngs._77).Primitives;var b=__ngs.r_(__ngs._2z).Assets;var c=a.CornerButton=e.Button.subclass({classname:"CornerButton",initialize:function($super){$super({image:b.image("home-screen-caret.png")})},setButton:function(g,h){this.setText(g);this.setOnClick(h)},sizeChanged:function(){var g=this._frame[3]/3;this.setImageInsets([Math.floor(g),Math.floor(g/4),Math.floor(g),Math.floor(5*this._frame[2]/6)]);this.setTextInsets([0,this._frame[2]/6,0,0])}})}};__ngs._am={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._6k).MobageStyle;c.lazyLoad(a,"Carousel",function(){return{children:{_overlayButton:{style:{pressedGradient:{gradient:["22000000 0.0"]}}}}}})}};__ngs._an={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._77).Primitives;var d=a.ImageLabel=c.Button.subclass({initialize:function(e){if(!e||!("touchable" in e)){this.setTouchable(false);this.setTouchable=function(){}}}})}};__ngs._ao={_c:null,_d:function(){var e={exports:{}};var j=e.exports;this._c=e;var f=__ngs.r_(__ngs._59).UI;var d=f.ViewGeometry.Rect;var c=f.ViewGeometry.Scale;var b=__ngs.r_(__ngs._bf).LayoutGroup;var h=__ngs.r_(__ngs._9h).CompositeLayoutGroup;var g=__ngs.r_(__ngs._77);var m=g.Primitives;var a=g.ButtonEnhancements;var l=__ngs.r_(__ngs._5l).UnspammableButton;var n=0;var k=j.CompositeButton=function(t){if(!t.classname){n++;t.classname="AnonymousCompositeButton("+n+")"}if(!t.CompositeClass){t.CompositeClass=h}t.isCompositeButton=function(){return true};for(var r in a){if(a.hasOwnProperty(r)){t[r]=a[r]}}var s=t.setGradient;if(!s||typeof s!=="function"){s=null}t.setGradient=function($super,w,u){var v=Array.prototype.slice.call(arguments);if(s){s.apply(this,v)}v.shift();this._button.setGradient.apply(this._button,v)};t.setStyle=function($super,u){this._button.setStyle(u);$super(u)};t.setState=function($super,u){$super(u);this._button.setState(u)};t.setOnClick=function(u){this.onclick=u};t.getOnClick=function(){return this.onclick};var o=t.initSubviews;if(!o||typeof o!=="function"){o=null}t.initSubviews=function($super){if(o){o.apply(this,[$super])}else{$super()}this._button=(new l()).retain();this.addChild(this._button);this._compositeDestroys._button=function(){this._button.release();this._button=null};this.performEventCallback=this._button.performEventCallback;this._spamProtectionLock=this._button._spamProtectionLock;this._spamProtectionEnabled=this._button._spamProtectionEnabled;this._spamProtectionLockName=this._button._spamProtectionLockName;this.getSpamLock=this._button.getSpamLock;this.getSpamLockName=this._button.getSpamLockName;this.setSpamLockName=this._button.setSpamLockName;this.getSpamProtectionEnabled=this._button.getSpamProtectionEnabled;this.setSpamProtectionEnabled=this._button.setSpamProtectionEnabled;this._button.performEventCallback=this.performEventCallback.bind(this);this.enableEvent=this.enableEvent.bind(this._button);this._button.setTextColor("00FFFFFF");NgLogD("CompositeButton/initSubviews "+this.classname+" end.")};var p=t.addSubviews;if(!p||typeof p!=="function"){p=function($super){$super.apply(this)}}t.addSubviews=function($super){this.addChild(this._button);p.apply(this,[$super]);var u=this._button;var v=function(z){return z==u||(z instanceof f.Button)||(typeof(z.isCompositeButton)==="function"&&z.isCompositeButton())};var y=function(B){if(v(B)){B.setTouchable(true)}var A=B.getChildren?B.getChildren():[];for(var z=0;A&&z<A.length;z++){if(v(A[z])){A[z].setTouchable(true)}else{A[z].setTouchable(false);y(A[z])}}};var x=this.getChildren();for(var w=0;x&&w<x.length;w++){if(x[w]==this._button){continue}y(x[w])}};var q=t.layoutSubviews;if(!q||typeof q!=="function"){q=function($super){$super.apply(this)}}t.layoutSubviews=function($super){q.apply(this,[$super]);var u=(this.getFrameSize())?(this.getFrameSize()):([0,0]);this._button.setFrameSize(u)};return t}}};__ngs._ap={_c:null,_d:function(){var a={exports:{}};var b=a.exports;this._c=a;var f=__ngs.r_(__ngs._c5).AccordionCVC;var c=__ngs.r_(__ngs._60).Style;var d=__ngs.r_(__ngs._c6).AccordionTitleView;var e=__ngs.r_(__ngs._c7).AccordionListSection;var h=__ngs.r_(__ngs._79).MBListViewSection;var g=__ngs.r_(__ngs._7a).ContactsSectionTitleView;var j=b.MobageAccordionCVC=f.subclass({classname:"MobageAccordionCVC",_accordionSectionStyle:null,initialize:function($super){$super();return this},loadView:function($super){$super();this.setStyle(new c())},destroy:function(){},createAccordionSection:function(){return this.createAccordionSectionWithTitle("")},createAccordionSectionWithTitle:function(k){return this.createAccordionSectionWithTitleAndItems(k,null)},createAccordionSectionWithTitleAndItems:function(m,k){var n=new d({},this);n.setFrameSize([100,40]);n.setTitle(m);n.setAccessoryText((k&&k.length)?k.length:0);NgLogD("createAccordionWithTitleAndItems");var l=new e();l.setSectionHeader(n);if(k){l.hiddenItems=k}else{l.hiddenItems=[]}return l},createSection:function(){return this.createSectionWithTitle(null)},createSectionWithTitle:function(k){return this.createSectionWithTitleAndItems(k,null)},createSectionWithTitleAndItems:function(m,k){if(m){var n=new g();n.setFrameSize([100,40]);n.setTitle(m);n.setAccessoryText((k&&k.length)?k.length:0)}this.logd("createSectionWithTitleAndItems");var l=new h();if(m){l.setSectionHeader(n)}if(k){l.setItems(k)}else{l.setItems([])}return l},setStyle:function(k){if(!k){k=new c()}k.defaultsFrom("social.us.mobageaccordionsection");this._accordionSectionStyle=k}})}};__ngs._aq={_c:null,_d:function(){var d={exports:{}};var g=d.exports;this._c=d;var e=__ngs.r_(__ngs._59).UI;var c=e.ViewGeometry.Rect;var b=e.ViewGeometry.Scale;var j=__ngs.r_(__ngs._n).LocalizedString;var f=__ngs.r_(__ngs._o).Session;var h=__ngs.r_(__ngs._87).ReferenceCounting;var a=new (__ngs.r_(__ngs._f).RequireLoader)({UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils}});var k=g.AddFriendManager=h.subclass({classname:"AddFriendManager",initialize:function($super,l){$super();this._controller=l},destroy:function(){},getCurUser:function(){return(this._controller.getCurUser)?this._controller.getCurUser():null},getButtonAddUser:function(){return(this._controller.getButtonAddUser)?this._controller.getButtonAddUser():null},getButtonUnfriendUser:function(){return(this._controller.getButtonUnfriendUser)?this._controller.getButtonUnfriendUser():null},getZeroCaseObject:function(){return(this._controller.getZeroCaseObject)?this._controller.getZeroCaseObject():null},checkRelationship:function(l){NgLogD("AddFriendManager: API User requested relationship doublecheck");this._checkRelationship(l)},_checkRelationship:function(l){if(this._isLoginUser()||!this.getCurUser()){return}if(!this.getCurUser().localRelation){this.getCurUser().localRelation="stranger"}var m=f.getCurrentSession().user();var n=false;m.getMutualFriendsList().forAll(this.zombieSafeCallback(function(p,o){if(this.getCurUser().is(o)){this.getCurUser().localRelation="friend";p(false);return}p(true)}),this.zombieSafeCallback(function(o){if(this.getCurUser().isMutualFriend){this.updateButtons(false,l);return}m.getInvitesList().forAll(this.zombieSafeCallback(function(q,r,p){if(this.getCurUser().is(r)){if(r.isMutualFriend){this.getCurUser().localRelation="friend"}else{this.getCurUser().localRelation="follower"}q(false);return}q(true)}),this.zombieSafeCallback(function(p){this.updateButtons(false,l)}));m.getFollowersList().forAll(this.zombieSafeCallback(function(q,r,p){if(r===this.getCurUser()){if(r.isMutualFriend){this.getCurUser().localRelation="friend"}else{this.getCurUser().localRelation="requested"}q(false);return}q(true)}),this.zombieSafeCallback(function(p){this.updateButtons(false,l)}))}))},_showErrorToast:function(l){a.UIUtils.showToast(l)},updateButtons:function(o,n){console.log("ffb: updateButtons",o,n);if(this._isLoginUser()){return}var l=this.getButtonAddUser();var m=this.getButtonUnfriendUser();var q=this.getZeroCaseObject();NgLogD("updateButtons: "+this.getCurUser().localRelation+" inviting: "+this.getCurUser().inviting+" invited: "+this.getCurUser().invited+" forceInviting:"+o+" Zero Case:"+q);if(f.getCurrentSession().user().isInviting(this.getCurUser())||o){if(this.getCurUser().localRelation==="follower"){if(l){l.setText(j("Accepting..."));l.setEnabled(false);l.setVisible(true)}if(q){q.setZeroCaseTexts([null,null,j("Accepting...")]);q.setZeroCaseButtonEnabled(false)}}else{if(l){l.setText(j("Sending Request..."));l.setEnabled(false);l.setVisible(true)}if(q){q.setZeroCaseTexts([null,null,j("Sending Request...")]);q.setZeroCaseButtonEnabled(false)}}if(m){m.setVisible(false)}}else{if((this.getCurUser().invited&&!this.getCurUser().isMutualFriend)||this.getCurUser().localRelation==="requested"){if(l){l.setText(j("Request Sent"));l.setEnabled(false);l.setVisible(true)}if(q){q.setZeroCaseTexts([null,null,j("Request Sent")]);q.setZeroCaseButtonEnabled(false)}if(m){m.setVisible(true)}}else{if(this.getCurUser().isMutualFriend||this.getCurUser().localRelation==="friend"){if(l){l.setText("Friend!");l.setEnabled(false);l.setVisible(false)}if(m){m.setVisible(true)}if(q){q.setZeroCaseTexts([null,null,j("You are friends.")]);q.setZeroCaseButtonEnabled(false)}}else{if(this.getCurUser().localRelation==="follower"){if(l){l.setText(j("Accept"));l.setEnabled(true);l.setVisible(true)}if(q){q.setZeroCaseTexts([null,null,j("Accept friend request.")]);q.setZeroCaseButtonEnabled(true)}if(m){m.setVisible(false)}}else{if(this.getCurUser().localRelation==="stranger"){if(l){l.setText(j("Add User"));l.setEnabled(true);l.setVisible(true)}if(q){q.setZeroCaseTexts([null,null,j("Add as Friend")]);q.setZeroCaseButtonEnabled(true)}if(m){m.setVisible(false)}}else{var p="Don't know how we got here..."+this.getCurUser().gamertag+" "+this.getCurUser().localRelation;NgLogE(p)}}}}}if(n){n()}},_isLoginUser:function(){return(f.getCurrentSession().user().is(this.getCurUser()))},getAddFriendButtonCallback:function(){return(function(){if(this.getCurUser().localRelation==="friend"){NgLogD("UserProfile 'Add' button tapped on someone already your friend");return}this.updateButtons(true);f.getCurrentSession().user().addBuddy(this.getCurUser(),function(l,m){NgLogD("Add Buddy Callback");if(l){this._showErrorToast(l);this.updateButtons()}else{this.getCurUser().invited=true;this._checkRelationship()}}.bind(this))}.bind(this))}})}};__ngs._ar={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var a=__ngs.r_(__ngs._5l).UnspammableButton;var b=new (__ngs.r_(__ngs._f).RequireLoader)({ContactsSectionSubTitleStyle:function(){return __ngs.r_(__ngs._a9).ContactsSectionSubTitle}});var e=c.ContactsSectionSubtitleView=a.subclass({classname:"ContactsSectionSubtitleView",initialize:function($super,f){$super(f);this.setFrameSize([300,40]);b.ContactsSectionSubTitleStyle.applyTo(this);return this},_formattedTitle:function(){return""+this._baseText+((this._accessoryText!==null)?(" ("+this._accessoryText+")"):"")},_baseText:null,setTitle:function(f){this._baseText=f;this.setText(this._formattedTitle())},_accessoryText:null,setAccessoryText:function(f){this._accessoryText=f;this.setText(this._formattedTitle())}})}};__ngs._as={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var d=__ngs.r_(__ngs._2z).Assets;var g=__ngs.r_(__ngs._59).UI;var b=__ngs.r_(__ngs._n).LocalizedString;var a=__ngs.r_(__ngs._5l).UnspammableButton;var f=g.View.subclass({classname:"AvatarImagePickerCell",initialize:function($super,j,m,l,o,n,k){if($super&&typeof $super=="function"){$super()}this._maxPerRow=j;this._controller=m;this._finalCB=k;this._choosePhotoCameraCB=l;this._choosePhotoCB=o;this._chooseAvatarCB=n;this.setFrame([15,15,15,15]);this._userAvatars=[];for(var h=0;h<this._maxPerRow;h++){this._userAvatars.push((new g.Button()).retain());this.addChild(this._userAvatars[h])}},setupListItem:function(p,n){var q=this;var m=this.getFrame();var h=m[2];var k=m[3];var j=(70/75)*k;var l=(h-(j*this._maxPerRow))/(this._maxPerRow+1);for(var o=0;o<p.length;o++){this._userAvatars[o].setFrame([l+l*o+o*(j),(k-j)/2,j,j]);if(p[o]){this._userAvatars[o].setImageInsets([2,2,1,1]);if(p[o]==="choosePhotoCamera"){this._userAvatars[o].setImage(d.image("button_outcamera.png"));this._userAvatars[o].onclick=function(){this.setupTransaparentOverlay();this._choosePhotoCameraCB(function(){this.cleanOverlay()}.bind(this))}.bind(this)}else{if(p[o]==="choosePhoto"){this._userAvatars[o].setImage(d.image("button_outgallery.png"));this._userAvatars[o].onclick=function(){this.setupTransaparentOverlay();if(n){this._choosePhotoCB(this._userAvatars[1],function(){this.cleanOverlay()}.bind(this))}else{this._choosePhotoCB(this._userAvatars[0],function(){this.cleanOverlay()}.bind(this))}}.bind(this)}else{this._userAvatars[o].setImage(p[o]);this._userAvatars[o].avatar=p[o];this._userAvatars[o].onclick=function(){q.setupTransaparentOverlay();q._chooseAvatarCB(this.avatar,function(){q.cleanOverlay()})}.bind(this._userAvatars[o])}}}}},setImageBordersWithStyle:function(j){for(var h in this._userAvatars){this._userAvatars[h].setImageBorder(j.props()["iconImageBorder"]);this._userAvatars[h].setImageBorder(j.props()["iconImageBorderPressed"],g.State.Pressed)}},setupTransaparentOverlay:function(){var j=g.Window.getWidth();var h=g.Window.getHeight();this._transparentBase=new a().retain();this._transparentBase.onclick=function(k){};this._transparentBase.setGradient({gradient:["66000000 0.0","66000000 0.0"]});this._transparentBase.setFrame(0,0,j,h);g.Window.document.addChild(this._transparentBase)},cleanUp:function(){if(this._userAvatars){for(var h in this._userAvatars){this._userAvatars[h].release()}this._userAvatars=null}if(this._transparentBase){this._transparentBase.release();this._transparentBase=null}},cleanOverlay:function(){if(this._transparentBase){this._transparentBase.release();this._transparentBase=null}},destroy:function(){this.cleanUp()}});c.AvatarImagePickerCell=f}};__ngs._at={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var d={};d.Style=__ngs.r_(__ngs._60).Style;var c=d.Style.ScaledTextSize;d.Style.sheet("social.us.avatarpicker",{topBarBackgroundPane:{gradient:{gradient:["FF074983 0.0","FF062C52 1.0"]}},borderUnderTopPane:{backgroundColor:"FF2C4B6F"},baseView:{gradient:{gradient:["FF0A1D34 0.0","FF0A1D34 1.0"]}},selectLabel:{textColor:"FFFFFFFF",textFont:d.Style.defaultBoldFontFace,textSize:c(14)},loadingLabel:{textColor:"FFFFFFFF",textFont:d.Style.defaultRegularFontFace,textSize:c(20)},userAvatar:{corners:"2.0 2.0 2.0 2.0",gradient:[],outerLine:"FFFF 2",innerLine:"6000 2"},listContainerBgOuterPane:{gradient:{gradient:["FF051935 0.0","FF073F70 0.2"],corners:"4 4 0 0"}},listContainerBgInnerPane:{gradient:{gradient:["FF051935 0.0","FF073F70 1.0"],innerLine:"FF0E1D3B 2.0",corners:"4 4 0 0"}},iconImageBorder:{corners:"6 6 6 6",innerLine:"FFB2B2B2 2"},iconImageBorderPressed:{corners:"6 6 6 6",outerLine:"FFB2B2B2 3",innerLine:"66000000 6"}})}};__ngs._au={_c:null,_d:function(){var f={exports:{}};var c=f.exports;this._c=f;var h=__ngs.r_(__ngs._5).Core;var g=__ngs.r_(__ngs._59).UI;var e=__ngs.r_(__ngs._2z).Assets;var d=__ngs.r_(__ngs._ai).CCView;var b=__ngs.r_(__ngs._n).LocalizedString;var a=new (__ngs.r_(__ngs._f).RequireLoader)({UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},PickableAvatar:function(){return __ngs.r_(__ngs._c8).PickableAvatar},Session:function(){return __ngs.r_(__ngs._o).Session},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements},EditProfile:function(){return __ngs.r_(__ngs._c9).EditProfile},LimitedEditText:function(){return __ngs.r_(__ngs._8f).LimitedEditText},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities},SpamProtection:function(){return __ngs.r_(__ngs._68)}});c.ProfileSettingsView=d.subclass({classname:"ProfileSettingsView",_viewHeader:null,_labelPageName:null,_buttonEdit:null,_editNameAndMotto:null,_labelFullName:null,_firstNameEdit:null,_lastNameEdit:null,_labelAboutme:null,_editMotto:null,_buttonSaveChanges:null,_footerArea:null,_buttonSupport:null,_buttonLogout:null,_alertDialog:null,initSubviews:function($super){$super();this._style=a.EditProfile;var j=a.Session.getCurrentSession();this._user=j.user();this._initializeContent()},_initializeContent:function(){this._scrollArea=this.getContentView();this._viewHeader=(new g.View()).retain();this._labelPageName=(new g.Label()).retain();this._avatarPicker=(new a.PickableAvatar(this._user)).retain();this._avatarPicker.onclick=this._avatarPicker_clickHandler.bind(this);this._buttonEdit=(new g.Button()).retain();this._editNameAndMotto=(new g.View()).retain();this._labelFullName=(new g.Label()).retain();this._firstNameEdit=(new a.LimitedEditText("first_name")).retain();this._lastNameEdit=(new a.LimitedEditText("last_name")).retain();this._labelAboutme=(new g.Label()).retain();this._editMotto=(new g.EditTextArea()).retain();this._buttonSaveChanges=(new a.UnspammableButton()).retain();this._footerArea=(new g.View()).retain();this._buttonSupport=(new a.UnspammableButton()).retain();this._buttonLogout=(new a.UnspammableButton()).retain();this._alertDialog=(new g.AlertDialog()).retain();this._labelPageName.setText(b("Edit Profile Information"));this._buttonEdit.setText(b("Edit"));this._labelFullName.setText(b("Full Name"));this._firstNameEdit.setText(this._user.firstName);this._lastNameEdit.setText(this._user.lastName);this._labelAboutme.setText(b("About Me"));this._editMotto.setText(this._user.motto);this._buttonSaveChanges.setText(b("Save"));this._buttonSupport.setText(b("Support"));this._buttonLogout.setText(b("Logout"));this._applyKeyboardWorkaround(this._firstNameEdit);this._applyKeyboardWorkaround(this._lastNameEdit);this._applyKeyboardWorkaround(this._editMotto);this._firstNameEdit.setOnFocus(function(){if(this.controller){this.controller.firstNameEditOnFocus()}}.bind(this));this._lastNameEdit.setOnFocus(function(){if(this.controller){this.controller.lastNameEditOnFocus()}}.bind(this));this._editMotto.setOnFocus(function(){if(this.controller){this.controller.editMottoOnFocus()}}.bind(this));this._editMotto.setOnBlur(function(){if(this.controller){this.controller.editMottoOnBlur()}}.bind(this));this._buttonEdit.onclick=this._avatarPicker.onclick;this._buttonSaveChanges.onclick=(function(){if(this.controller){this.controller.buttonSaveChangesOnClick()}}).bind(this);this._buttonSupport.onclick=(function(){if(this.controller){this.controller.buttonSupportOnClick()}}).bind(this);this._buttonLogout.onclick=(function(){if(this.controller){this.controller.buttonLogoutOnClick()}}).bind(this);this._style.applyTo(this)},addSubviews:function($super){$super();this._viewHeader.addChild(this._labelPageName);this._scrollArea.addChild(this._viewHeader);this._scrollArea.addChild(this._avatarPicker);this._scrollArea.addChild(this._buttonEdit);this._editNameAndMotto.addChild(this._labelFullName);this._editNameAndMotto.addChild(this._firstNameEdit);this._editNameAndMotto.addChild(this._lastNameEdit);this._editNameAndMotto.addChild(this._labelAboutme);this._editNameAndMotto.addChild(this._editMotto);this._editNameAndMotto.addChild(this._buttonSaveChanges);this._scrollArea.addChild(this._editNameAndMotto);this._footerArea.addChild(this._buttonSupport);this._footerArea.addChild(this._buttonLogout);this._scrollArea.addChild(this._footerArea)},replaceEditMotto:function(j){this._editMotto.setEnabled(false);this._editMotto.setEnabled(true);this._editMotto.setText("");this._editMotto.setText(j);this._editMotto.blur()},_applyKeyboardWorkaround:function(j){if(this.controller){this.controller.applyKeyboardWorkaround(j)}},destroy:function(){if(this._viewHeader){this._viewHeader.release()}if(this._labelPageName){this._labelPageName.release()}if(this._avatarPicker){this._avatarPicker.release()}if(this._buttonEdit){this._buttonEdit.release()}if(this._editNameAndMotto){this._editNameAndMotto.release()}if(this._labelFullName){this._labelFullName.release()}if(this._firstNameEdit){this._firstNameEdit.release()}if(this._lastNameEdit){this._lastNameEdit.release()}if(this._labelAboutme){this._labelAboutme.release()}if(this._editMotto){this._editMotto.release()}if(this._buttonSaveChanges){this._buttonSaveChanges.release()}if(this._footerArea){this._footerArea.release()}if(this._buttonSupport){this._buttonSupport.release()}if(this._buttonLogout){this._buttonLogout.release()}if(this._alertDialog){this._alertDialog.release()}},layoutSubviews:function($super){$super();var m=this._style.extras.viewRatio;var l=new g.ViewGeometry.Rect(this.content.getFrame());this._viewHeader.setFrame([m.viewHeaderX*l.w|0,(m.viewHeaderY-m.contentAreaY)*l.h|0,l.w,m.viewHeaderH*l.h|0]);this._avatarPicker.setFrame([m.avatarImageX*l.w|0,m.avatarImageY*l.h|0,m.avatarImageW*l.w|0,m.avatarImageW*l.w|0]);this._avatarPicker.layoutSubviews();this._editNameAndMotto.setFrame([m.avatarAreaW*l.w|0,m.viewHeaderH*l.h|0,(1-m.avatarAreaW)*l.w|0,(1-m.viewHeaderH)*l.h|0]);var k=new g.ViewGeometry.Rect(this._editNameAndMotto.getFrame());this._footerArea.setFrame([m.footerAreaX*l.w|0,m.footerAreaY*l.h|0,l.w,m.footerAreaH*l.h|0]);this._labelPageName.setFrame([m.labelPageName[0]*l.w|0,m.labelPageName[1]*l.h|0,m.labelPageName[2]*l.w|0,m.labelPageName[3]*l.h|0]);this._buttonEdit.setFrame([m.avatarBtnEdit[0]*l.w|0,m.avatarBtnEdit[1]*l.h|0,m.avatarBtnEdit[2]*l.w|0,m.avatarBtnEdit[3]*l.h|0]);this._labelFullName.setFrame([m.labelFullName[0]*k.w|0,m.labelFullName[1]*k.h|0,m.labelFullName[2]*k.w|0,m.labelFullName[3]*k.h|0]);this._firstNameEdit.setFrame([m.editFName[0]*k.w|0,m.editFName[1]*k.h|0,m.editFName[2]*k.w|0,m.editFName[3]*k.h|0]);this._lastNameEdit.setFrame([m.editLName[0]*k.w|0,m.editLName[1]*k.h|0,m.editLName[2]*k.w|0,m.editLName[3]*k.h|0]);this._labelAboutme.setFrame([m.labelAboutMe[0]*k.w|0,m.labelAboutMe[1]*k.h|0,m.labelAboutMe[2]*k.w|0,m.labelAboutMe[3]*k.h|0]);this._editMotto.setFrame([m.editMotto[0]*k.w|0,m.editMotto[1]*k.h|0,m.editMotto[2]*k.w|0,m.editMotto[3]*k.h|0]);this._buttonSaveChanges.setFrame([m.buttonSaveChanges[0]*k.w|0,m.buttonSaveChanges[1]*k.h|0,m.buttonSaveChanges[2]*k.w|0,m.buttonSaveChanges[3]*k.h|0]);if(a.Capabilities.meetsBinaryVersion&&a.Capabilities.meetsBinaryVersion("1.6")){this._buttonSupport.setFrame([m.buttonSupport[0]*l.w|0,m.buttonSupport[1]*l.h|0,m.buttonSupport[2]*l.w|0,m.buttonSupport[3]*l.h|0]);this._buttonLogout.setFrame([m.buttonLogout[0]*l.w|0,m.buttonLogout[1]*l.h|0,m.buttonLogout[2]*l.w|0,m.buttonLogout[3]*l.h|0])}else{this._buttonSupport.setFrame([m.buttonSupportFullSize[0]*l.w|0,m.buttonSupportFullSize[1]*l.h|0,m.buttonSupportFullSize[2]*l.w|0,m.buttonSupportFullSize[3]*l.h|0])}var j=this._footerArea.getFrame();this._scrollArea.setContentSize(l.w,j[1]+j[3])},_avatarPicker_clickHandler:function(){if(!a.SpamProtection.getSpamProtectionLockForName("avatarPicker").acquire()){return}this._firstNameEdit.blur();this._lastNameEdit.blur();this._editMotto.blur();if(typeof this._avatarImage_clickCb=="function"){this._avatarImage_clickCb()}},setAvatarImageOnClick:function(j){this._avatarImage_clickCb=j}})}};__ngs._av={_c:null,_d:function(){var d={exports:{}};var g=d.exports;this._c=d;var j=__ngs.r_(__ngs._5).Core;var e=__ngs.r_(__ngs._59).UI;var f=__ngs.r_(__ngs._2z).Assets;var l=__ngs.r_(__ngs._5l).UnspammableButton;var k=__ngs.r_(__ngs._ai).CCView;var m=__ngs.r_(__ngs._n).LocalizedString;var b=__ngs.r_(__ngs._25).Rect;var a=new (__ngs.r_(__ngs._f).RequireLoader)({VerticalTabViewSizing:function(){return __ngs.r_(__ngs._9g).VerticalTabViewSizing},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements},Session:function(){return __ngs.r_(__ngs._o).Session},User:function(){return __ngs.r_(__ngs._30).User},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},AccountSettings:function(){return __ngs.r_(__ngs._aw).AccountSettings},SettingsOption:function(){return __ngs.r_(__ngs._aw).SettingsOption},BlockedUser:function(){return __ngs.r_(__ngs._aw).BlockedUser},LimitedEditText:function(){return __ngs.r_(__ngs._8f).LimitedEditText},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities}});g.AccountSettingsView=k.subclass({classname:"AccountSettingsView",_viewHeader:null,_labelHeader:null,_optionsArea:null,_optPushFriends:null,_optNewsUpdates:null,_optAllowFriendPostsOnly:null,_emailArea:null,_labelEmailAddress:null,_editEmailAddress:null,_buttonSaveChanges:null,_blockedUsersHeader:null,_labelBlockedUsers:null,_viewBlockedUsers:null,_footerArea:null,_buttonSupport:null,_acknowledgementsButton:null,_systemInfoButton:null,_toast:null,_blockedUserUIList:new Array(),_buttonLogout:null,initSubviews:function($super){$super();console.log("Calling initSubviews on AccountSettingsView");this._style=a.AccountSettings;this.totalWidth=this.getContentWidth();this._totalHeight=e.Window.getHeight();var n=a.Session.getCurrentSession();this._curUser=n.user();this._initializeContent()},_initializeContent:function(){this._scrollArea=this.getContentView();this._viewHeader=(new e.View()).retain();this._labelHeader=(new e.Label()).retain();this._optionsArea=(new e.View()).retain();this._optPushFriends=(new c()).retain();this._optNewsUpdates=(new c()).retain();this._optAllowFriendPostsOnly=(new c()).retain();this._emailArea=(new e.View()).retain();this._labelEmailAddress=(new e.Label()).retain();this._editEmailAddress=(new a.LimitedEditText("email_address")).retain();this._buttonSaveChanges=(new a.UnspammableButton()).retain();this._blockedUsersHeader=(new e.View()).retain();this._labelBlockedUsers=(new e.Label()).retain();this._viewBlockedUsers=(new e.View()).retain();this._footerArea=(new e.View()).retain();this._buttonSupport=(new a.UnspammableButton()).retain();this._acknowledgementsButton=(new a.UnspammableButton()).retain();this._systemInfoButton=(new a.UnspammableButton()).retain();this._toast=(new e.Toast()).retain();this._buttonLogout=(new a.UnspammableButton()).retain();this._labelHeader.setText(m("Account Settings"));this._optPushFriends.setText(m("Only receive push notifications from Mobage Friends"));this._optNewsUpdates.setText(m("Send me game news and updates"));this._optAllowFriendPostsOnly.setText(m("Only allow Mobage Friends to post comments on my profile"));this._labelEmailAddress.setText(m("Email Address"));this._editEmailAddress.setText(this._curUser.emailAddress);this._buttonSaveChanges.setText(m("Save"));this._labelBlockedUsers.setText(m("Blocked Users"));this._buttonSupport.setText(m("Support"));this._acknowledgementsButton.setText(m("View Acknowledgements"));this._systemInfoButton.setText(m("Mobage Version"));this._buttonLogout.setText(m("Logout"));this._buttonSaveChanges.onclick=(function(){if(this.controller){this.controller.buttonSaveChangesOnClick()}}).bind(this);this._buttonSupport.onclick=(function(){if(this.controller){this.controller.buttonSupportOnClick()}}).bind(this);this._acknowledgementsButton.onclick=(function(){if(this.controller){this.controller.acknowledgementsButtonOnClick()}}).bind(this);this._systemInfoButton.onclick=(function(){if(this.controller){this.controller.systemInfoButtonOnClick()}}).bind(this);this._buttonLogout.onclick=(function(){if(this.controller){this.controller.buttonLogoutOnClick()}}).bind(this);this._applyKeyboardWorkaround(this._editEmailAddress);this.options=[];this.blockedUserArray=[];this._optPushFriends.setChecked(!!this._curUser.onlyShowFriendNotifications);this.options.push(this._optPushFriends);this._optNewsUpdates.setChecked(!!this._curUser.optsIn);this.options.push(this._optNewsUpdates);this._optAllowFriendPostsOnly.setChecked(!!this._curUser.allowFriendPostsOnly);this.options.push(this._optAllowFriendPostsOnly);this._style.applyTo(this)},addSubviews:function($super){$super();this._viewHeader.addChild(this._labelHeader);this._optionsArea.addChild(this._optPushFriends);this._optionsArea.addChild(this._optNewsUpdates);this._optionsArea.addChild(this._optAllowFriendPostsOnly);this._emailArea.addChild(this._labelEmailAddress);this._emailArea.addChild(this._editEmailAddress);this._emailArea.addChild(this._buttonSaveChanges);this._blockedUsersHeader.addChild(this._labelBlockedUsers);this._footerArea.addChild(this._buttonSupport);this._footerArea.addChild(this._acknowledgementsButton);this._footerArea.addChild(this._systemInfoButton);this._footerArea.addChild(this._buttonLogout);this._scrollArea.addChild(this._viewHeader);this._scrollArea.addChild(this._optionsArea);this._scrollArea.addChild(this._emailArea);this._scrollArea.addChild(this._footerArea)},_applyKeyboardWorkaround:function(n){if(this.controller){this.controller.applyKeyboardWorkaround(n)}},destroy:function(){if(this._viewHeader){this._viewHeader.release()}if(this._labelHeader){this._labelHeader.release()}if(this._optionsArea){this._optionsArea.release()}if(this._optPushFriends){this._optPushFriends.release()}if(this._optNewsUpdates){this._optNewsUpdates.release()}if(this._optAllowFriendPostsOnly){this._optAllowFriendPostsOnly.release()}if(this._emailArea){this._emailArea.release()}if(this._labelEmailAddress){this._labelEmailAddress.release()}if(this._editEmailAddress){this._editEmailAddress.release()}if(this._buttonSaveChanges){this._buttonSaveChanges.release()}if(this._blockedUsersHeader){this._blockedUsersHeader.release()}if(this._labelBlockedUsers){this._labelBlockedUsers.release()}if(this._viewBlockedUsers){this._viewBlockedUsers.release()}if(this._footerArea){this._footerArea.release()}if(this._buttonSupport){this._buttonSupport.release()}if(this._acknowledgementsButton){this._acknowledgementsButton.release()}if(this._systemInfoButton){this._systemInfoButton.release()}if(this._toast){this._toast.release()}if(this._buttonLogout){this._buttonLogout.release()}this._cleanBlockedUserUIList()},refreshOptions:function(){this._optPushFriends.setChecked(this._curUser.onlyShowFriendNotifications);this._optNewsUpdates.setChecked(this._curUser.optsIn);this._optAllowFriendPostsOnly.setChecked(this._curUser.allowFriendPostsOnly);this._editEmailAddress.setText(this._curUser.emailAddress)},_cleanBlockedUserUIList:function(){if(this._blockedUserUIList){var o=this._blockedUserUIList.length;for(var n=0;n<o;n++){var p=this._blockedUserUIList.pop();if(p&&!p.__destroyed__){p.release()}}}this._blockedUserUIList=new Array()},layoutSubviews:function($super){$super();var o=this._style.extras.viewRatio;this._contentWidth=this.getContentWidth();var u=new b(this.content.getFrame());if(u.isEmpty()){return}this._viewHeaderHeight=o.contentHeaderHFactor*u.h;this._viewHeader.setFrame([0,0,this._contentWidth,this._viewHeaderHeight]);this._labelHeader.setFrame([o.labelHeaderXFactor*this._contentWidth,0,this._contentWidth,this._viewHeaderHeight]);var w=3;this._optionsAreaHeight=w*o.optionCellHFactor*u.h;this._optionsArea.setFrame([0,this._viewHeaderHeight,this._contentWidth,this._optionsAreaHeight]);this._emailAreaHeight=o.emailAddressAreaHFactor*u.h;this._emailArea.setFrame([0,this._viewHeaderHeight+this._optionsAreaHeight,this._contentWidth,this._emailAreaHeight]);this._labelEmailAddress.setFrame([o.emailAddressLabelXFactor*this._contentWidth,o.emailAddressLabelYFactor*this._emailAreaHeight,o.emailAddressLabelWFactor*this._contentWidth,o.emailAddressLabelHFactor*this._emailAreaHeight]);this._editEmailAddress.setFrame([o.emailAddressEditBoxXFactor*this._contentWidth,o.emailAddressEditBoxYFactor*this._emailAreaHeight,o.emailAddressEditBoxWFactor*this._contentWidth,o.emailAddressEditBoxHFactor*this._emailAreaHeight]);this._buttonSaveChanges.setFrame([o.saveChangesButtonXFactor*this._contentWidth,o.saveChangesButtonYFactor*this._emailAreaHeight,o.saveChangesButtonWFactor*this._contentWidth,o.saveChangesButtonHFactor*this._emailAreaHeight]);this._blockedUsersHeaderHeight=o.blockedUsersHeaderAreaHFactor*u.h;this._blockedUsersHeader.setFrame([0,this._viewHeaderHeight+this._optionsAreaHeight+this._emailAreaHeight,this._contentWidth,this._blockedUsersHeaderHeight]);this._labelBlockedUsers.setFrame([o.labelBlockedUsersHeaderXFactor*this._contentWidth,o.labelBlockedUsersHeaderYFactor*this._blockedUsersHeaderHeight,o.labelBlockedUsersHeaderWFactor*this._contentWidth,o.labelBlockedUsersHeaderHFactor*this._blockedUsersHeaderHeight]);this._blockedUserCellHeight=o.blockedUserCellHFactor*u.h;var q=o.footerAreaHFactor*u.h;var t=o.buttonSystemInfoWFactor*this._contentWidth;var p=o.buttonAcknowledgementsWFactor*this._contentWidth;var n=o.buttonSystemInfoXFactor*this._contentWidth;this._acknowledgementsButton.setFrame([this._contentWidth-o.buttonAcknowledgementsXFactor-p-n,o.buttonAcknowledgementsYFactor*q,p,o.buttonAcknowledgementsHFactor*q]);this._systemInfoButton.setFrame([n,o.buttonSystemInfoYFactor*q,t,o.buttonSystemInfoHFactor*q]);if(a.Capabilities.meetsBinaryVersion&&a.Capabilities.meetsBinaryVersion("1.6")){this._buttonLogout.setFrame([o.buttonLogoutXFactor*this._contentWidth,o.buttonLogoutYFactor*q,o.buttonLogoutWFactor*this._contentWidth,o.buttonLogoutHFactor*q]);this._buttonSupport.setFrame([o.buttonSupportXFactor*this._contentWidth,o.buttonSupportYFactor*q,o.buttonSupportWFactor*this._contentWidth,o.buttonSupportHFactor*q])}else{this._buttonSupport.setFrame([o.buttonSupportFullLengthXFactor*this._contentWidth,o.buttonSupportFullLengthYFactor*q,o.buttonSupportFullLengthWFactor*this._contentWidth,o.buttonSupportFullLengthHFactor*q])}for(var s=0;s<this.options.length;s++){var v=this._optionsAreaHeight/this.options.length;this.options[s].setFrame([0,s*v,this._contentWidth,v])}},createBlockedUser:function(q,n,o){var p=(new h()).retain();p.setAvatar(n.getDefinedIcon());p.setGamerTag(n.gamertag);p.setGamerName(n.getFullName());p.setIndex(o);this._blockedUserUIList.push(p);this._createBlockedUserCell();p.setOnClick((function(){if(this.controller){this.controller.blockeduserOnClick(n,p)}}).bind(this));this._viewBlockedUsers.addChild(p)},_createBlockedUserCell:function(){var o=this._blockedUserUIList.length;for(var n=0;n<o;n++){this._blockedUserUIList[n].setFrame([0,n*this._blockedUserCellHeight,this._contentWidth,this._blockedUserCellHeight])}},_updateBlockedUserAreaSize:function(s){var p=this._style.extras.viewRatio;var n=0;if(s>0){n=this._blockedUsersHeaderHeight+(s*this._blockedUserCellHeight);this._viewBlockedUsers.setFrame([0,this._viewHeaderHeight+this._optionsAreaHeight+this._emailAreaHeight+this._blockedUsersHeaderHeight,this._contentWidth,n]);if(!this._blockedUsersHeader.getParent()){this._scrollArea.addChild(this._blockedUsersHeader)}if(!this._viewBlockedUsers.getParent()){this._scrollArea.addChild(this._viewBlockedUsers)}}else{if(this._blockedUsersHeader.getParent()){this._blockedUsersHeader.removeFromParent()}if(this._viewBlockedUsers.getParent()){this._viewBlockedUsers.removeFromParent()}}var q=this._viewHeaderHeight+this._optionsAreaHeight+this._emailAreaHeight+n;var o=p.footerAreaHFactor*this._totalHeight;this._footerArea.setFrame([0,q,this._contentWidth,o])},_updateContentSize:function(){var p=this._style.extras.viewRatio;var n=p.scrollViewContentHFactor*this._totalHeight;if(this._footerArea){var o=this._footerArea.getFrame();n=o[1]+o[3]}this._scrollArea.setContentSize(this.getContentWidth(),n)}});var c=e.View.subclass({classname:"SettingsOption",_contentArea:null,_labelText:null,_checkSelect:null,_optionText:"Text for option not set!",_optionChecked:false,_totalWidth:0,_totalHeight:0,_contentWidth:0,initialize:function(){this._style=a.SettingsOption;this.initSubviews();this.addSubviews();this._style.applyTo(this)},initSubviews:function(){this._contentArea=(new e.View()).retain();this._labelText=(new e.Label()).retain();this._checkSelect=(new e.CheckBox()).retain();this._contentHeight=400;this._checkSelect.onclick=this.bind(function(n){if(n.eventType==="click"){this._optionChecked=!this._optionChecked}})},addSubviews:function(){this._contentArea.addChild(this._labelText);this._contentArea.addChild(this._checkSelect);this.addChild(this._contentArea)},layoutSubviews:function(){var o=this._style.extras.viewRatio;var n=new b(this.getFrame());if(n.isEmpty()){return}this._totalHeight=n.h;this._totalWidth=n.w;this._contentArea.setFrame([0,0,n.w,n.h]);this._labelText.setFrame([o.optionLabelXFactor*n.w,o.optionLabelYFactor*n.h,o.optionLabelWFactor*n.w,o.optionLabelHFactor*n.h]);this._checkSelect.setFrame([o.optionCheckBoxXFactor*n.w,o.optionCheckBoxYFactor*n.h,o.optionCheckBoxWFactor*n.w,o.optionCheckBoxHFactor*n.h])},destroy:function(){if(this._contentArea){this._contentArea.release()}if(this._labelText){this._labelText.release()}if(this._checkSelect){this._checkSelect.release()}},setText:function(n){this._optionText=n;if(this._labelText){this._labelText.setText(n)}},setTextSize:function(n){if(this._labelText){this._labelText.setTextSize(n)}},setChecked:function(n){this._optionChecked=n;if(this._checkSelect){this._checkSelect.setChecked(n===true||n===1)}},isChecked:function(){return this._optionChecked},_getContentWidth:function(){return(1-a.VerticalTabViewSizing.buttonContainerRatio-a.VerticalTabViewSizing.insetRatio)*this._totalWidth},sizeChanged:function(n,o){this.layoutSubviews()}});var h=e.View.subclass({classname:"BlockedUser",_contentArea:null,_totalWidth:0,_totalHeight:0,_contentWidth:0,_index:0,_avatarValue:null,_gamerTagValue:"",_gamerNameValue:"",_avatar:null,_gamerTag:null,_gamerName:null,_unblockButton:null,_that:null,initialize:function(){this._style=a.BlockedUser;console.log(this._style);console.log(a);this.initSubviews();this.addSubviews();this._style.applyTo(this)},initSubviews:function(){this._contentArea=(new e.View()).retain();this._avatar=(new e.Image()).retain();this._gamerTag=(new e.Label()).retain();this._gamerName=(new e.Label()).retain();this._unblockButton=(new a.UnspammableButton()).retain();this._unblockButton.setText(m("Unblock"))},addSubviews:function(){this._contentArea.addChild(this._avatar);this._contentArea.addChild(this._gamerTag);this._contentArea.addChild(this._gamerName);this._contentArea.addChild(this._unblockButton);this.addChild(this._contentArea)},layoutSubviews:function(){var o=this._style.extras.viewRatio;var n=new b(this.getFrame());if(n.isEmpty()){return}this.totalWidth=n.w;this.totalHeight=n.h;this._contentArea.setFrame([0,0,n.w,n.h]);this._avatar.setFrame([o.blockedUserAvatarXFactor*n.w,o.blockedUserAvatarYFactor*n.h,o.blockedUserAvatarWFactor*n.w,o.blockedUserAvatarHFactor*n.h]);this._gamerTag.setFrame([o.blockedUserGamerTagXFactor*n.w,o.blockedUserGamerTagYFactor*n.h,o.blockedUserGamerTagWFactor*n.w,o.blockedUserGamerTagHFactor*n.h]);this._gamerTag.setTextSize(o.blockedUserGamerTagHFactor*n.h*0.5);this._gamerName.setFrame([o.blockedUserGamerNameXFactor*n.w,o.blockedUserGamerNameYFactor*n.h,o.blockedUserGamerNameWFactor*n.w,o.blockedUserGamerNameHFactor*n.h]);this._gamerName.setTextSize(o.blockedUserGamerNameHFactor*n.h*0.5);this._unblockButton.setFrame([o.unblockButtonXFactor*n.w,o.unblockButtonYFactor*n.h,o.unblockButtonWFactor*n.w,o.unblockButtonHFactor*n.h])},destroy:function(){if(this._contentArea){this._contentArea.release()}if(this._avatar){this._avatar.release()}if(this._gamerTag){this._gamerTag.release()}if(this._gamerName){this._gamerName.release()}if(this._unblockButton){this._unblockButton.release()}},setGamerTag:function(n){this._gamerTagValue=n;if(this._gamerTag){this._gamerTag.setText(this._gamerTagValue)}},setGamerName:function(n){this._gamerNameValue=n;if(this._gamerName){this._gamerName.setText(this._gamerNameValue)}},setAvatar:function(n){this._avatarValue=n;if(this._avatar){this._avatar.setImage(this._avatarValue);this._avatar.setImageFit(e.FitMode.Fill)}},setIndex:function(n){this._index=n;if(n%2===0){this._contentArea.setBackgroundColor("FFF9FCFD")}else{this._contentArea.setBackgroundColor("FFE6EDF5")}},setOnClick:function(n){this._unblockButton.onclick=n},_getContentWidth:function(){return(1-a.VerticalTabViewSizing.buttonContainerRatio-a.VerticalTabViewSizing.insetRatio)*this._totalWidth},getIndex:function(){return this._index},sizeChanged:function(){this.layoutSubviews()}})}};__ngs._aw={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var g={};g.Style=__ngs.r_(__ngs._60).Style;var e=__ngs.r_(__ngs._6k).MobageStyle;var b=e.ScaledCorners;var f=e.ScaledTextSize;var a=__ngs.r_(__ngs._9u).CommonElements;e.lazyLoad(c,"AccountSettings",function(){return{children:{_viewHeader:{style:{gradient:{gradient:["FF143558 0.000","FF295D8D 1.000"]}}},_optionsArea:{style:{backgroundColor:"FFE6EDF5"}},_labelHeader:{style:{textFont:e.defaultBoldFontFace,textSize:f(14),textColor:"FFFFFFFF",textShadow:"33000000 1.0 {0.0,-2.0}",textGravity:[0,0.5]}},_emailArea:{style:{gradient:{gradient:["FFDBE2EA 0.000","FFE9EFF3 1.000"],innerLine:"FFC9D1DA 1.0"}}},_labelEmailAddress:{style:{textFont:e.defaultBoldFontFace,textColor:"FF000000",textSize:f(12),textGravity:[0,0.5]}},_editEmailAddress:a.textBox,_buttonSaveChanges:a.standardButton,_blockedUsersHeader:{style:{gradient:{gradient:["FFA0B0C0 0.000","FFBFCCD8 0.060","FFDCE5ED 1.000"],innerLine:"FFC9D1DA 1.0"}}},_labelBlockedUsers:{style:{textFont:e.defaultBoldFontFace,textColor:"FF000000",textSize:f(12),textGravity:[0,0.5]}},_acknowledgementsButton:{style:{textFont:e.defaultBoldFontFace,textSize:f(14),textColor:"FF457BBF",textGravity:[1,0.5],pressedGradient:{gradient:["FF3682C3 0.000","FF1C61A8 1.000"]}}},_systemInfoButton:{style:{textFont:e.defaultBoldFontFace,textSize:f(14),textColor:"FF457BBF",textGravity:[0,0.5],pressedGradient:{gradient:["FF3682C3 0.000","FF1C61A8 1.000"]}}},_footerArea:{style:{gradient:{gradient:["FFDBE2EA 0.000","FFE9EFF3 1.000"],innerLine:"FFC9D1DA 1.0"}}},_buttonSupport:a.standardButton,_buttonLogout:a.standardButton},extras:{viewRatio:{scrollViewContentHFactor:((675+10)/480),contentHeaderHFactor:(0.18),contentHeaderWFactor:(0.723),labelHeaderXFactor:(0.024),labelHeaderYFactor:(0.304),labelHeaderWFactor:(0.491),labelHeaderHFactor:(0.446),contentAreaHFactor:(0.875),contentAreaWFactor:(0.723),optionCellHFactor:(0.18),emailAddressAreaHFactor:(0.5),emailAddressLabelXFactor:(0.029),emailAddressLabelYFactor:(0.084),emailAddressLabelWFactor:(0.346),emailAddressLabelHFactor:(0.139),emailAddressEditBoxXFactor:(0.021),emailAddressEditBoxYFactor:(0.265),emailAddressEditBoxWFactor:(0.958),emailAddressEditBoxHFactor:(0.361),saveChangesButtonXFactor:(199/578),saveChangesButtonYFactor:(111/166),saveChangesButtonWFactor:(180/578),saveChangesButtonHFactor:(0.21),blockedUsersHeaderAreaHFactor:(0.1),labelBlockedUsersHeaderXFactor:(13/578),labelBlockedUsersHeaderYFactor:(9/42),labelBlockedUsersHeaderWFactor:(200/578),labelBlockedUsersHeaderHFactor:(23/42),blockedUserCellHFactor:(0.3),footerAreaHFactor:(120/480),buttonSupportXFactor:(12/578),buttonSupportYFactor:(26/130),buttonSupportWFactor:(271/578),buttonSupportHFactor:(0.35),buttonLogoutXFactor:(295/578),buttonLogoutYFactor:(26/130),buttonLogoutWFactor:(271/578),buttonLogoutHFactor:(0.35),buttonSupportFullLengthXFactor:(12/578),buttonSupportFullLengthYFactor:(26/130),buttonSupportFullLengthWFactor:(542/578),buttonSupportFullLengthHFactor:(0.35),buttonAcknowledgementsXFactor:(12/578),buttonAcknowledgementsYFactor:(0.7),buttonAcknowledgementsWFactor:(55/100),buttonAcknowledgementsHFactor:(40/130),buttonSystemInfoXFactor:(12/578),buttonSystemInfoYFactor:(0.7),buttonSystemInfoWFactor:(40/100),buttonSystemInfoHFactor:(40/130)}}}});e.lazyLoad(c,"SettingsOption",function(){return{children:{_labelText:{style:{textFont:e.defaultBoldFontFace,textColor:"FF000000",textSize:f(12),textGravity:[0,0.5]}},_checkSelect:a.checkBox},extras:{viewRatio:{optionCellHFactor:(0.133),optionLabelXFactor:(0.02),optionLabelYFactor:(0.071),optionLabelWFactor:(0.83),optionLabelHFactor:(0.714),optionCheckBoxXFactor:(0.878),optionCheckBoxYFactor:(0.071),optionCheckBoxWFactor:(0.15),optionCheckBoxHFactor:(0.714)}}}});e.lazyLoad(c,"BlockedUser",function(){return{children:{_avatar:{style:{gradient:{corners:"4.0 4.0 4.0 4.0",gradient:["FFFFFFFF 0.000","FFFFFFFF 1.000"],outerLine:"FFFFFFFF 3",innerLine:"FFB2B2B2 2"},imageInsets:[5,5,5,5]}},_gamerName:{style:{textFont:e.defaultBoldFontFace,textColor:"FF000000",textGravity:[0,0.5]}},_gamerTag:{style:{textFont:e.defaultBoldFontFace,textColor:"FF004AA9",textGravity:[0,0.5]}},_unblockButton:a.standardButton,_blockedUserCellOdd:{style:{backgroundColor:"FFE6EDF5"}},_blockedUserCellEven:{style:{backgroundColor:"FFF9FCFD"}}},extras:{viewRatio:{blockedUsersHeaderAreaHFactor:(42/480),blockedUserAvatarXFactor:(7/578),blockedUserAvatarYFactor:(0.15),blockedUserAvatarWFactor:(0.185),blockedUserAvatarHFactor:(0.69),blockedUserGamerTagXFactor:(0.225),blockedUserGamerTagYFactor:(0.17),blockedUserGamerTagWFactor:(350/578),blockedUserGamerTagHFactor:(24/98),blockedUserGamerNameXFactor:(0.225),blockedUserGamerNameYFactor:(0.38),blockedUserGamerNameWFactor:(350/578),blockedUserGamerNameHFactor:(24/98),unblockButtonXFactor:(0.75),unblockButtonYFactor:(0.35),unblockButtonWFactor:(130/578),unblockButtonHFactor:(0.35)}}}})}};__ngs._ax={_c:null,_d:function(){var b={exports:{}};var e=b.exports;this._c=b;var f=__ngs.r_(__ngs._5).Core;var c=__ngs.r_(__ngs._59).UI;var d=__ngs.r_(__ngs._2z).Assets;var h=__ngs.r_(__ngs._5l).UnspammableButton;var g=__ngs.r_(__ngs._ai).CCView;var j=__ngs.r_(__ngs._n).LocalizedString;var a=new (__ngs.r_(__ngs._f).RequireLoader)({UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},PasswordStyle:function(){return __ngs.r_(__ngs._ay).Password},LargeActionButton:function(){return __ngs.r_(__ngs._ay).LargeActionButton},Layout:function(){return __ngs.r_(__ngs._aj).Layout},LimitedEditText:function(){return __ngs.r_(__ngs._8f).LimitedEditText},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities}});e.PasswordView=g.subclass({classname:"PasswordView",_viewHeader:null,_labelHeader:null,_contentChangePass:null,_labelCurrPassword:null,_editCurrPassword:null,_labelNewPassword:null,_editNewPassword:null,_labelReEnterPassword:null,_editReEnterPassword:null,_buttonSavePassword:null,_buttonForgotPassword:null,_contentForgotPass:null,_labelTitle:null,_labelText:null,_labelEmailAddress:null,_editEmailAddress:null,_buttonSendEmail:null,_footerArea:null,_buttonSupport:null,_buttonLogout:null,_progressDialog:null,_toast:null,initSubviews:function($super){$super();this._style=a.PasswordStyle;this._largeActionButtonStyle=a.LargeActionButton;this._totalWidth=f.Capabilities.getScreenHeight();this._totalHeight=f.Capabilities.getScreenWidth();this._initializeContent()},_initializeContent:function(){this._scrollArea=this.getContentView();this._viewHeader=(new c.View()).retain();this._labelHeader=(new c.Label()).retain();this._contentChangePass=(new c.View()).retain();this._labelCurrPassword=(new c.Label()).retain();this._editCurrPassword=(new a.LimitedEditText("current_password_field")).retain();this._labelNewPassword=(new c.Label()).retain();this._editNewPassword=(new a.LimitedEditText("new_password_field")).retain();this._labelReEnterPassword=(new c.Label()).retain();this._editReEnterPassword=(new a.LimitedEditText("new_password_field")).retain();this._buttonSavePassword=(new a.UnspammableButton()).retain();this._buttonForgotPassword=(new a.UnspammableButton()).retain();this._contentForgotPass=(new c.View()).retain();this._labelTitle=(new c.Label()).retain();this._labelText=(new c.Label()).retain();this._labelEmailAddress=(new c.Label()).retain();this._editEmailAddress=(new a.LimitedEditText("email_address")).retain();this._buttonSendEmail=(new a.UnspammableButton()).retain();this._buttonCancel=(new a.UnspammableButton()).retain();this._footerArea=(new c.View()).retain();this._buttonSupport=(new a.UnspammableButton()).retain();this._buttonLogout=(new a.UnspammableButton()).retain();this._progressDialog=(new c.ProgressDialog()).retain();this._toast=(new c.Toast()).retain();this._labelHeader.setText(j("Change Password"));this._labelCurrPassword.setText(j("Current Password"));this._labelNewPassword.setText(j("New Password"));this._labelReEnterPassword.setText(j("Re-enter Password"));this._buttonSavePassword.setText(j("Save"));this._buttonForgotPassword.setText(j("Forgot Password?"));this._labelTitle.setText(j("Forgot your password?"));this._labelText.setText(j("Please enter the email address you used to sign up for Mobage and a password reset will be sent to you."));this._labelEmailAddress.setText(j("Email Address"));this._buttonSendEmail.setText(j("Send"));this._buttonCancel.setText(j("Cancel"));this._buttonSupport.setText(j("Support"));this._buttonLogout.setText(j("Logout"));this._progressDialog.setText(j("Sending request"));this._applyKeyboardWorkaround(this._editCurrPassword);this._applyKeyboardWorkaround(this._editNewPassword);this._applyKeyboardWorkaround(this._editReEnterPassword);this._buttonForgotPassword.setTextColor("FF000000",c.State.Pressed);this._editEmailAddress.setInputType(c.Commands.InputType.None);this._editEmailAddress.setEnterKeyType(c.Commands.EnterKeyType.Done);this._applyKeyboardWorkaround(this._editEmailAddress);this._buttonSavePassword.onclick=(function(){if(this.controller){this.controller.buttonSavePasswordOnClick()}}).bind(this);this._buttonForgotPassword.onclick=(function(){if(this.controller){this.controller.buttonForgotPasswordOnClick()}}).bind(this);this._buttonSendEmail.onclick=(function(){if(this.controller){this.controller.buttonSendEmailOnClick()}}).bind(this);this._buttonCancel.onclick=(function(){if(this.controller){this.controller.buttonCancelForgotPasswordOnClick()}}).bind(this);this._buttonSupport.onclick=(function(){if(this.controller){this.controller.buttonSupportOnClick()}}).bind(this);this._buttonLogout.onclick=(function(){if(this.controller){this.controller.buttonLogoutOnClick()}}).bind(this);this._style.applyTo(this)},addSubviews:function($super){$super();this._viewHeader.addChild(this._labelHeader);this._contentChangePass.addChild(this._labelCurrPassword);this._contentChangePass.addChild(this._editCurrPassword);this._contentChangePass.addChild(this._labelNewPassword);this._contentChangePass.addChild(this._editNewPassword);this._contentChangePass.addChild(this._labelReEnterPassword);this._contentChangePass.addChild(this._editReEnterPassword);this._contentChangePass.addChild(this._buttonSavePassword);this._contentChangePass.addChild(this._buttonForgotPassword);this._contentForgotPass.addChild(this._labelTitle);this._contentForgotPass.addChild(this._labelText);this._contentForgotPass.addChild(this._labelEmailAddress);this._contentForgotPass.addChild(this._editEmailAddress);this._contentForgotPass.addChild(this._buttonSendEmail);this._contentForgotPass.addChild(this._buttonCancel);this._footerArea.addChild(this._buttonSupport);this._footerArea.addChild(this._buttonLogout);this._scrollArea.addChild(this._viewHeader);this._scrollArea.addChild(this._contentChangePass);this._scrollArea.addChild(this._footerArea)},_applyKeyboardWorkaround:function(k){if(this.controller){this.controller.applyKeyboardWorkaround(k)}},destroy:function(){if(this._viewHeader){this._viewHeader.release()}if(this._labelHeader){this._labelHeader.release()}if(this._contentChangePass){this._contentChangePass.release()}if(this._labelCurrPassword){this._labelCurrPassword.release()}if(this._editCurrPassword){this._editCurrPassword.release()}if(this._labelNewPassword){this._labelNewPassword.release()}if(this._editNewPassword){this._editNewPassword.release()}if(this._labelReEnterPassword){this._labelReEnterPassword.release()}if(this._editReEnterPassword){this._editReEnterPassword.release()}if(this._buttonSavePassword){this._buttonSavePassword.release()}if(this._buttonForgotPassword){this._buttonForgotPassword.release()}if(this._contentForgotPass){this._contentForgotPass.release()}if(this._labelTitle){this._labelTitle.release()}if(this._labelText){this._labelText.release()}if(this._labelEmailAddress){this._labelEmailAddress.release()}if(this._editEmailAddress){this._editEmailAddress.release()}if(this._buttonSendEmail){this._buttonSendEmail.release()}if(this._buttonCancel){this._buttonCancel.release()}if(this._footerArea){this._footerArea.release()}if(this._buttonSupport){this._buttonSupport.release()}if(this._buttonLogout){this._buttonLogout.release()}if(this._progressDialog){this._progressDialog.release()}if(this._toast){this._toast.release()}},layoutSubviews:function($super){$super();var w=a.Layout;var l=this._style.extras.viewRatio;var y=new c.ViewGeometry.Rect(this.content.getFrame());var t=w.pixelSize(y.h,"view_header_height");this._viewHeader.setFrame([0,0,y.w,t]);this._labelHeader.setFrame([w.pixelSize(y.w,"view_header_text_x"),0,w.pixelSize(y.w,"view_header_text_width"),t]);var z=w.pixelSize(y.h,"vert_spacing");var x=w.pixelSize(y.h,"vert_spacing_big");var p=w.pixelSize(y.w,"horz_padding");var o=w.pixelSize(y.h,"vert_padding");var s=y.copy();s.x+=p;s.w-=2*p;s.y+=o+t;var k=null;var n=null;var q=w.pixelSize(y.h,"text_edit_height");var m=w.pixelSize(y.h,"button_height");var v=false;var u=function(){if(!v&&k&&n){v=true;var G=0;this._labelTitle.setFrame([0,G,s.w,n.lineHeight]);G+=n.lineHeight+z;this._labelText.setFrame([0,G,s.w,k.height]);G+=k.height+x;this._labelEmailAddress.setFrame([0,G,s.w,n.lineHeight]);G+=n.lineHeight+z;this._editEmailAddress.setFrame([0,G,s.w,q]);G+=q+x;var r=l.sendButtonW*s.w;var D=l.cancelButtonW*s.w;this._buttonSendEmail.setFrame([w.getPositionInContainer(l.sendButtonAlignH,l.sendButtonGravityH,r,s.w),G,r,m]);this._buttonCancel.setFrame([w.getPositionInContainer(l.cancelButtonAlignH,l.cancelButtonGravityH,D,s.w),G,D,m]);G+=m+z;this._contentForgotPass.setFrame([s.x,s.y,s.w,G]);var K=G;G=0;var H=l.passwordInputW*s.w;var F=(s.w-H)*l.passwordInputAlignH;this._buttonForgotPassword.setFrame([0.5*s.w,0,0.5*s.w,m]);this._labelCurrPassword.setFrame([0,G,s.w,n.lineHeight]);G+=n.lineHeight+z;this._editCurrPassword.setFrame([F,G,H,q]);G+=q+x;this._labelNewPassword.setFrame([0,G,s.w,n.lineHeight]);G+=n.lineHeight+z;this._editNewPassword.setFrame([F,G,H,q]);G+=q+x;this._labelReEnterPassword.setFrame([0,G,s.w,n.lineHeight]);G+=n.lineHeight+z;this._editReEnterPassword.setFrame([F,G,H,q]);G+=q+x;var E=l.saveButtonW*s.w;this._buttonSavePassword.setFrame([w.getPositionInContainer(l.saveButtonAlignH,l.saveButtonGravityH,E,s.w),G,E,m]);G+=m+z;this._contentChangePass.setFrame([s.x,s.y,s.w,G]);var I=G;G=s.y+(K>I?K:I)+o;var L=l.vFooterPadding*y.h|0;var J=m+2*L;this._footerArea.setFrame([0,G,y.w,J]);var B=0;var A=0;if(a.Capabilities.meetsBinaryVersion&&a.Capabilities.meetsBinaryVersion("1.6")){B=l.supportLogoutButtonX*y.w;A=l.supportButtonW*y.w;this._buttonSupport.setFrame([B,L,A,m]);var C=l.logoutSupportButtonPadding*y.w;var N=B+A+B;var M=l.logoutButtonW*y.w;this._buttonLogout.setFrame([N,L,M,m])}else{B=l.supportLogoutButtonX*y.w;A=l.supportButtonFullW*y.w;this._buttonSupport.setFrame([B,L,A,m])}this._scrollArea.setContentSize(y.w,G+J)}}.bind(this);c.measureText(this._labelTitle.getText(),s.w,1000,this._labelTitle.getStyle().getTextFont(),this._labelTitle.getStyle().getTextSize(),function(r){r.numLines=r.lineWidths.length;r.lineHeight=r.height/r.numLines;n=r;u()}.bind(this));c.measureText(this._labelText.getText(),s.w,1000,this._labelText.getStyle().getTextFont(),this._labelText.getStyle().getTextSize(),function(r){r.numLines=r.lineWidths.length;r.lineHeight=r.height/r.numLines;k=r;u()}.bind(this))},_adjustForContent:function(k){var n=a.Layout.pixelSize(this.content.getFrame()[3],"vert_padding");var m=k.getFrame();var l=this._footerArea.getFrame();l[1]=m[1]+m[3]+n;this._footerArea.setFrame(l);this._scrollArea.setContentSize(this._scrollArea.getContentSize()[0],l[1]+l[3])},showForgotPass:function(){this._scrollArea.removeChild(this._contentChangePass);this._scrollArea.removeChild(this._footerArea);this._scrollArea.addChild(this._contentForgotPass);this._scrollArea.addChild(this._footerArea);this._adjustForContent(this._contentForgotPass)},showChangePass:function(){this._scrollArea.removeChild(this._contentForgotPass);this._scrollArea.removeChild(this._footerArea);this._scrollArea.addChild(this._contentChangePass);this._scrollArea.addChild(this._footerArea);this._adjustForContent(this._contentChangePass)}})}};__ngs._ay={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var f=__ngs.r_(__ngs._6k).MobageStyle;var b=f.ScaledCorners;var g=f.ScaledTextSize;var a=__ngs.r_(__ngs._9u).CommonElements;var d=__ngs.r_(__ngs._2z).Assets;f.lazyLoad(c,"Password",function(){return{children:{_viewHeader:{style:{gradient:{gradient:["FF143558 0.000","FF295D8D 1.000"]}}},_labelHeader:{style:{textFont:f.defaultBoldFontFace,textSize:g(14),textColor:"FFFFFFFF",textGravity:[0,0.5]}},_contentChangePass:{style:{backgroundColor:"FFE6EDF5"}},_labelCurrPassword:{style:{textFont:f.defaultBoldFontFace,textSize:g(12),textColor:"FF000000",textGravity:[0,0]}},_editCurrPassword:a.textBox,_labelNewPassword:{style:{textFont:f.defaultBoldFontFace,textSize:g(12),textColor:"FF000000",textGravity:[0,0]}},_editNewPassword:a.textBox,_labelReEnterPassword:{style:{textSize:g(12),textFont:f.defaultBoldFontFace,textColor:"FF000000",textGravity:[0,0]}},_editReEnterPassword:a.textBox,_buttonSavePassword:a.standardButton,_buttonForgotPassword:{style:{textSize:g(12),textGravity:[1,0.5],textFont:f.defaultBoldFontFace,textColor:"FF004AA9"}},_contentForgotPass:{style:{backgroundColor:"FFE6EDF5"}},_labelTitle:{style:{textSize:g(12),textFont:f.defaultBoldFontFace,textColor:"FF000000",textGravity:[0,0.5]}},_labelText:{style:{textSize:g(12),textFont:f.defaultRegularFontFace,textColor:"FF000000",textGravity:[0,0]}},_labelEmailAddress:{style:{textSize:g(12),textFont:f.defaultBoldFontFace,textColor:"FF000000",textGravity:[0,0]}},_editEmailAddress:a.textBox,_buttonSendEmail:a.standardButton,_buttonCancel:a.standardButton,_footerArea:{style:{gradient:{gradient:["FFDBE2EA 0.000","FFE9EFF3 1.000"],innerLine:"FFC9D1DA 1.0"}}},_buttonSupport:a.standardButton,_buttonLogout:a.standardButton},extras:{viewRatio:{sendButtonW:0.4,sendButtonAlignH:0.25,sendButtonGravityH:0.5,cancelButtonW:0.4,cancelButtonAlignH:0.75,cancelButtonGravityH:0.5,saveButtonW:0.5,saveButtonAlignH:0,saveButtonGravityH:0,passwordInputW:0.5,passwordInputAlignH:0,supportLogoutButtonX:0.05,supportButtonW:0.425,supportButtonAlignH:0.5,supportButtonGravityH:0.5,supportButtonFullW:0.9,supportButtonFullAlignH:0.5,supportButtonFullGravityH:0.5,logoutButtonW:0.425,logoutButtonAlignH:0.5,logoutButtonGravityH:0.5,vFooterPadding:0.0464}}}});f.lazyLoad(c,"LargeActionButton",function(){return{style:{gradient:{corners:b(8),gradient:["FF75B624 0.000","FF4D8D1F 1.000"],outerLine:"FF233656 2.0",innerLine:"4484C3E9 2.0"},pressedGradient:{corners:b(8),gradient:["FF5B971B 0.000","FF397210 1.000"],outerLine:"FF233656 2.0",innerShadow:"23000000 1.0 {0.0,-2.0}"},textFont:f.defaultBoldFontFace,textSize:g(16),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}}})}};__ngs._az={_c:null,_d:function(){var f={exports:{}};var d=f.exports;this._c=f;var h=__ngs.r_(__ngs._59).UI;var e=h.ViewGeometry.Rect;var b=__ngs.r_(__ngs._n).LocalizedString;var c=__ngs.r_(__ngs._bv).CCViewList;var a=new (__ngs.r_(__ngs._f).RequireLoader)({MBListViewSection:function(){return __ngs.r_(__ngs._79).MBListViewSection},PendingListSection:function(){return __ngs.r_(__ngs._9r).PendingListSection},RecentlyPlayedGamesGridPanelController:function(){return __ngs.r_(__ngs._b3).RecentlyPlayedGamesGridPanelController},UserInfoListItem:function(){return __ngs.r_(__ngs._ca).UserInfoListItem},UserProfileStyle:function(){return __ngs.r_(__ngs._b0).UserProfileStyle},HorizontalButtonListItem:function(){return __ngs.r_(__ngs._cb).HorizontalButtonListItem}});var g=d.ProfileView=c.subclass({classname:"ProfileView",_pendingSection:null,_userInfoSection:null,_wallSection:null,_recentGamesSection:null,_friendsSection:null,initialize:function($super){this._showPending=true;this._batchMode=true;this._pendingSection=(new a.PendingListSection()).retain();this._pendingSection.setPendingText("ENGINEERING Loading a profile");this._userInfoItem=(new a.UserInfoListItem());this._userInfoItem.setAvatarImageOnClick(this._avatarPicker_clickHandler.bind(this));this._userInfoSection=(new a.MBListViewSection()).retain();this._userInfoSection.setItems([this._userInfoItem]);this._buttonsItem=(new a.HorizontalButtonListItem());this._batchMode=false;$super();this._headerHeightRatio=0;this._sizing=a.UserProfileStyle},initSubviews:function($super){$super();this._extrasSection=(new a.MBListViewSection()).retain();this._extrasSection.setRowHeight(-1)},setScrollToSection:function(j){this.loge("Temporarily disabled! Report if this is used by you!")},setWallSection:function(j){this._wallSection=j.retain()},setFriendsPanel:function(j){this._friendsSection=j.retain()},setRecentlyPlayedGamesGridPanel:function(j){this._recentGamesSection=j.retain()},destroy:function(){if(this._pendingSection){this._pendingSection.release();this._pendingSection=null}if(this._userInfoSection){this._userInfoSection.release();this._userInfoSection=null}if(this._userInfoItem){this._userInfoItem=null}if(this._wallSection){this._wallSection.release();this._wallSection=null}if(this._friendsSection){this._friendsSection.release();this._friendsSection=null}if(this._recentGamesSection){this._recentGamesSection.release();this._recentGamesSection=null}if(this._buttonsItem){this._buttonsItem=null}if(this._extrasSection){this._extrasSection.release();this._extrasSection=null}},layoutSubviews:function($super){$super();var j=new e(this.getFrame());if(j.isEmpty()){return}if(this._userInfoSection){this._userInfoSection.setRowHeight(-1)}if(this._userInfoItem){this._userInfoItem.setHeight(j.h*this._sizing.userInfoHeightRatio)}if(this._wallSection){this._wallSection.viewportFrameChanged(new e(this.getFrame()))}if(this._friendsSection){this._friendsSection.viewportFrameChanged(new e(this.getFrame()))}if(this._recentGamesSection){this._recentGamesSection.viewportFrameChanged(new e(this.getFrame()))}if(this._buttonsItem){this._buttonsItem.setHeight(j.h*this._sizing.buttonsItemHeightRatio)}this._checkSectionsOrReload()},updateUser:function(k,j){this._user=k;if(j){this._showPending=false}if(this._userInfoItem){this._userInfoItem.updateUser(this._user)}if(!this._user){return}if(this._pendingSection){this._pendingSection.setPendingText(b("Loading %1s's profile…",this._user.gamertag))}this._checkSectionsOrReload();setTimeout(function(){this._showPending=false;this._checkSectionsOrReload()}.bind(this),2000)},_checkSectionsOrReload:function(){var k=this.content.getSections()||[];var n=[];if(this._showPending){n.push(this._pendingSection)}if(this._userInfoSection){n.push(this._userInfoSection)}if(this._wallSection){n.push(this._wallSection)}if(this._recentGamesSection){n.push(this._recentGamesSection)}if(this._friendsSection){n.push(this._friendsSection)}var l=[];if(this._buttonsItem){l.push(this._buttonsItem)}if(l.length){this._extrasSection.setItems(l);n.push(this._extrasSection)}var m=(k.length!=n.length);for(var j=0;j<k.length&&!m;j++){if(k[j]!=n[j]){m=true}}if(m){this.content.setSections(n)}else{this.content.reloadData()}},setButtons:function(k){if(this._buttonsItem){for(var j=0;j<k.length;j++){this._buttonsItem.addStandardButton(k[j][0],k[j][1])}}},setButtonVisibleAtIndex:function(j,k){if(this._buttonsItem){this._buttonsItem.setVisibleAtIndex(j,k)}},getButtonAtIndex:function(j){if(this._buttonsItem){return this._buttonsItem.getButtonAtIndex(j)}return null},_avatarPicker_clickHandler:function(){if(typeof this._avatarImage_clickCb=="function"){this._avatarImage_clickCb()}},setAvatarImageOnClick:function(j){this._avatarImage_clickCb=j}})}};__ngs._b0={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var f=__ngs.r_(__ngs._6k).MobageStyle;var d=__ngs.r_(__ngs._2z).Assets;var a=f.ScaledCorners;var g=f.ScaledTextSize;var b=new (__ngs.r_(__ngs._f).RequireLoader)({CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements}});c.UserProfileStyle={maxTotalFriendsInGrid:15,maxTotalGamesInGrid:4,userInfoHeightRatio:7/12,sectionHeaderHeightRatio:1/6,wallHeaderHeightRatio:11/48,morePostsHeightRatio:1/8,buttonsItemHeightRatio:3/12,pendingRowHeightRatio:1/6,friendsRowHeightRatio:1/4,gamesRowHeightRatio:1/3,wallRowHeightRatio:3/12,recentlyPlayedGamesHeightRatio:1/2,friendsListHeightRatio:5/6,zeroCaseItemHeightRatio:1/2}}};__ngs._b1={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=new (__ngs.r_(__ngs._f).RequireLoader)({Destinations:function(){return __ngs.r_(__ngs._2a).Destinations},ServiceHostReq:function(){return __ngs.r_(__ngs._2v)},Session:function(){return __ngs.r_(__ngs._o).Session},FriendsGridPanelStyle:function(){return __ngs.r_(__ngs._cc).FriendsGridPanelCell},UserProfileStyle:function(){return __ngs.r_(__ngs._b0).UserProfileStyle}});var g=__ngs.r_(__ngs._cd).FriendsGridPanel;var a=__ngs.r_(__ngs._n).LocalizedString;var e=__ngs.r_(__ngs._ce).ListViewSectionController;var f=c.FriendsGridPanelController=e.subclass({classname:"FriendsGridPanelController",initialize:function($super,h,j){$super(h);this._entriesPerRow=j||b.FriendsGridPanelStyle.numEntriesPerRow;return this},loadSection:function(){if(!this._section){var h=new g();h.setRowHeight(-1);h.setEntriesPerRow(this._entriesPerRow);h.setHeaderOnClick(this._headerViewAllClicked.bind(this));h.setZeroCaseItemOnClick(this._zeroCase_clickCallback.bind(this));h.setRowItemOnClick(this._userClicked.bind(this));this.setSection(h);this._variableHeight=true}},setUser:function(h){var j=false;if(h&&!(h.is(this._user))){j=true}this._user=h;this._isCurrentUser=b.Session.getCurrentSession().user().is(this._user);this._updateHeader(0);if(j){this.loadData()}},loadData:function(){if(!this._user){return}var j=this.section();j.showPendingMessage(a("Loading friends…"));var h=0;this._user.getMutualFriendsList().forAll(this.zombieSafeCallback(function(m,k,l){h++;if(h<=b.UserProfileStyle.maxTotalFriendsInGrid){j.appendEntry(k)}m(true)}),this.zombieSafeCallback(function(k){if(k){this.loge(k)}this._updateHeader(h);if(h===0&&this._isLoginUser()){j.showZeroCaseMessage()}else{j.hideZeroCaseMessage()}j.hidePendingMessage()}),this.zombieSafeCallback(function(l,k){}))},_isLoginUser:function(){return(this._user.is(b.Session.getCurrentSession().user()))},_updateHeader:function(h){if(!this._user){return}var j=isNaN(h)?"?":h;this._section.setHeaderText((this._isCurrentUser)?a("My Friends (%1d)",j):a("%1s's friends (%2d)",this._user.gamertag,j))},headerViewAllOnClick:function(){this.logd("Header View All clicked, and the click went nowhere!")},_headerViewAllClicked:function(){this.headerViewAllOnClick()},_zeroCase_clickCallback:function(){b.Destinations.pushScreen(b.ServiceHostReq.ServiceHost.navController,"FindFriends",{tab:"contacts"},{analyticsName:"FriendsGridPanelControllerZeroFriendsButton"})},_userClicked:function(h){b.Destinations.pushScreen(this._controller.parentController.navController,"UserProfilePage",{user:h},this)}})}};__ngs._b2={_c:null,_d:function(){var d={exports:{}};var f=d.exports;this._c=d;var c=__ngs.r_(__ngs._25).Rect;var b=new (__ngs.r_(__ngs._f).RequireLoader)({ConversationViewController:function(){return __ngs.r_(__ngs._cf).ConversationViewController},WallListViewSection:function(){return __ngs.r_(__ngs._cg).WallListViewSection},DirtyFriendsListener:function(){return __ngs.r_(__ngs._4q).DirtyFriendsListener},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics},AlertDialog:function(){return __ngs.r_(__ngs._i).AlertDialog},Session:function(){return __ngs.r_(__ngs._o).Session},Wall:function(){return __ngs.r_(__ngs._ch).Wall},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils},Credentials:function(){return __ngs.r_(__ngs._2r).Credentials}});var e=__ngs.r_(__ngs._2a).Destinations;var j=__ngs.r_(__ngs._n).LocalizedString;var a=__ngs.r_(__ngs._ce).ListViewSectionController;var g=function(l){var k=/^\s*$/.test(l);return k};var h=f.WallListViewSectionController=a.subclass({classname:"WallListViewSectionController",showFriendsOnlyModalCb:null,initialize:function($super,k,m){$super(k);this._initialMaxMsgCount=4;this._maxMsgCount=0;this.startingNumberOfPosts=m;var l=b.Session.getCurrentSession();this._currentUserGrade=l.user().grade;return this},loadSection:function(){if(!this._section){var k=new b.WallListViewSection();k.showPendingMessage(j("Loading wall…"));k.setFooterMorePostsOnClick(this._footerMorePostsClicked.bind(this));k.setRowOnTap(this._pushConversationWall.bind(this));k.setWallCmdViewOnInvalidate(this._wallCmdViewOnInvalidate.bind(this));k.setWallCmdViewOnPush(this._pushConversationWall.bind(this));k.setRowAvatarOnTap(this._userClicked.bind(this));k.setHeaderPostMessageOnClick(this._headerPostMessageClicked.bind(this));k.setHeaderPostingDisabledOnClick(this._headerPostingDisabled_clickHandler.bind(this));this.setSection(k);this._maxMsgCount=this._initialMaxMsgCount;this._variableHeight=true}},setUser:function(k){var m=(k&&!k.is(this._user));var l=b.Session.getCurrentSession();this._user=k;this._isCurrentUser=l.user().is(this._user);if(this._dirtyFriendsListener){this._dirtyFriendsListener.destroy()}this._dirtyFriendsListener=new b.DirtyFriendsListener(this._dirtyFriendsListener_callback.bind(this),this._user);m|=(this._currentUserGrade!=l.user().grade);if(m){this.loadData()}},checkCanPostOnWall:function(){return this._isCurrentUser?true:(!this._user.allowFriendPostsOnly||this._user.isMutualFriend)},showFriendsOnlyModal:function(){if(typeof this.showFriendsOnlyModalCb=="function"){this.showFriendsOnlyModalCb()}},loadData:function(){if(!this._user){return}if(this._loadingMessages){NgLogD("Loading messages already in flight!");return}this._loadingMessages=true;var o=this._section;o.maxMsgCount=this._maxMsgCount;o.showPendingMessage(j("Loading wall…"));var n=b.Session.getCurrentSession();this._currentUserGrade=n.user().grade;var k;var m=this.zombieSafeCallback(function(){this._loadingMessages=false;if(this._currentUserGrade!==1&&this._user.ageRestricted){this._hideSection=true}o.hidePendingMessage();o.setConversationData(k,this._user);o.setPostingEnabled(this._currentUserGrade!==1&&this._user.isMobageUser&&this.checkCanPostOnWall());o.updateItems(true)});var l=1;b.Wall.list(this._user.recordID,this._maxMsgCount+1,function(q,p){--l;k=p;if(l==0){m()}});if(this._currentUserGrade!==1){++l;this._user.getUserDetails(function(q,p){this._user=p;--l;if(l==0){m()}})}},_headerPostingDisabled_clickHandler:function(){if(this._currentUserGrade===1){b.Credentials.showRegistration(null,true,true,"tiered",null,"profile_wall")}else{if(this.checkCanPostOnWall()){var k=this._section;k.setPostingEnabled(true);k.setPostingMessageFocus()}else{this.showFriendsOnlyModal()}}},_headerPostMessageClicked:function(l){this.logd("Post Message Clicked!");if(this._currentUserGrade===1){this.logd("Guest user is not allowed to post.");return}l.setEnabled(false);l.setEnabled(true);if(!this.checkCanPostOnWall()){this.showFriendsOnlyModal();return}var k=l.getText();this.logd("post message",k);if(!g(k||"")){k=k.substring(0,this.maxLength);b.Wall.postMsg(this._user.recordID,k,function(m){if((typeof m)==="undefined"){l.setText("")}this._finishedPosting(m)}.bind(this),false)}l.setText(k)},_finishedPosting:function(k){if((typeof k)!=="undefined"){if(!b.NetworkUtils.wasNetworkDown()){b.UIUtils.showAlert(j("Error"),j("Error accessing system.  Please try again later. Error: %1s",k))}}else{this.logd("Successful wall post!");this.loadData()}},_footerMorePostsClicked:function(){this._maxMsgCount+=this._initialMaxMsgCount;this.loadData()},_wallCmdViewOnInvalidate:function(){this.loadData()},_dirtyFriendsListener_callback:function(){if(this.isDestroyed()){if(this._dirtyFriendsListener){this._dirtyFriendsListener.destroy();this._dirtyFriendsListener=null}return}this.loadData()},_pushConversationWall:function(k){if(this._showingConversationWall){return}this._showingConversationWall=true;var l=new c(this.controller().view().getFrame());this.logd("_pushConversationWall",l);if(!this._conversationViewController){this._conversationViewController=new b.ConversationViewController()}this._conversationViewController.parentController=this.controller().parentController;this._conversationViewController.profileController=this.controller();this._conversationViewController.wallController=this;this._conversationViewController.wallClosedCB=this._conversationWallSelfClosed.bind(this);this._conversationViewController.view().setFrame(l);var m=b.Session.getCurrentSession();var n=m.user().grade;if(n===1){this._conversationViewController.setPostingEnabled(false);this._conversationViewController.setPostingDisabledOnClick(function(){b.Credentials.showRegistration(null,true,true,"tiered",null,"conversationView")})}else{this._conversationViewController.setPostingEnabled(this.checkCanPostOnWall());this._conversationViewController.setPostingDisabledOnClick(this.showFriendsOnlyModal.bind(this))}this._conversationViewController.setConversationInfo(k,this._user);this.controller().swapViews(this.controller().view(),this._conversationViewController.view(),false);b.MobageAnalytics.logNavEvent(this,this._conversationViewController)},_conversationWallSelfClosed:function(){this._showingConversationWall=false},cleanupTransients:function(){if(this._conversationViewController&&this._showingConversationWall){this._conversationViewController.backToProfile(false,true)}this._showingConversationWall=false},_userClicked:function(k){e.pushScreen(this._controller.parentController.navController,"UserProfilePage",{user:k},this,function(l){if(l){this.logd("NavController aborted push, scroll to top, because we must be the same controller");this._controller.view().getContentView().setScrollPosition([0,0])}}.bind(this))}})}};__ngs._b3={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var b=new (__ngs.r_(__ngs._f).RequireLoader)({Destinations:function(){return __ngs.r_(__ngs._2a).Destinations},Assets:function(){return __ngs.r_(__ngs._2z).Assets},Session:function(){return __ngs.r_(__ngs._o).Session},RecentlyPlayedGamesGridPanelStyle:function(){return __ngs.r_(__ngs._cc).RecentlyPlayedGamesGridPanelCell},UserProfileStyle:function(){return __ngs.r_(__ngs._b0).UserProfileStyle}});var d=__ngs.r_(__ngs._ci).RecentlyPlayedGamesGridPanel;var a=__ngs.r_(__ngs._n).LocalizedString;var g=__ngs.r_(__ngs._ce).ListViewSectionController;var f=c.RecentlyPlayedGamesGridPanelController=g.subclass({classname:"RecentlyPlayedGamesGridPanelController",initialize:function($super,h,j){$super(h);this._entriesPerRow=j||b.RecentlyPlayedGamesGridPanelStyle.extras.numEntriesPerRow;return this},loadSection:function(){if(!this._section){var h=new d();h.setRowHeight(-1);h.setEntriesPerRow(this._entriesPerRow);h.setHeaderOnClick(this._headerViewAllClicked.bind(this));h.setRowItemOnClick(this._gameClicked.bind(this));this.setSection(h);this._variableHeight=true}},setUser:function(h){var j=false;if(h&&!(h.is(this._user))){j=true}this._user=h;this._isCurrentUser=b.Session.getCurrentSession().user().is(this._user);this._updateHeader();if(j){this.loadData()}},loadData:function(){if(!this._user){return}var j=this.section();j.showPendingMessage(a("Loading games…"));var h=0;this._user.getOwnedGamesList().forAll(this.zombieSafeCallback(function(l,k,m){j.appendEntry(k);l(++h<b.UserProfileStyle.maxTotalGamesInGrid)}),this.zombieSafeCallback(function(k){if(k){this.loge(k)}if(h===0){if(this._isCurrentUser){j.appendEntry({isFake:true,name:a("Add Game!"),screen:"Catalog",screenJSON:{tab:"all games"},iconURL:b.Assets.image("addgamebttnplusicon_down.png")})}else{this._hideSection=true}}j.hidePendingMessage()}))},_updateHeader:function(h){if(!this._user){return}this._section.setHeaderText((this._isCurrentUser)?a("My Recently Played Games"):a("%1s's recently played games",this._user.gamertag))},headerViewAllOnClick:function(){this.logd("Header View All clicked, and the click went nowhere!")},_headerViewAllClicked:function(){this.headerViewAllOnClick()},_gameClicked:function(h){if(h&&h.isFake){b.Destinations.pushScreen(this._controller.parentController.navController,h.screen,h.screenJSON,this)}else{b.Destinations.pushScreen(this._controller.parentController.navController,"GameProfile",{game:h},this)}}})}};__ngs._b4={_c:null,_d:function(){var b={exports:{}};var f=b.exports;this._c=b;var d=__ngs.r_(__ngs._59).UI;var a=d.ViewGeometry.Scale;var g=__ngs.r_(__ngs._60).Style;var j=__ngs.r_(__ngs._n).Localization;var l=__ngs.r_(__ngs._n).LocalizedString;var k=__ngs.r_(__ngs._5l).UnspammableButton;var h=__ngs.r_(__ngs._5y).NavigableViewController;var e=__ngs.r_(__ngs._2s).CredentialsHost;var c=f.RegistrationWebScreen=h.subclass({classname:"RegistrationWebScreen",initialize:function($super,m){$super();this._contentUrl=m},destroy:function(){for(var m=0;m<this.retainedViews.length;m++){this.retainedViews[m].release()}},loadView:function($super){$super();var m=this;this.retainedViews=[];var n=function(o){o.retain();m.retainedViews.push(o);return o};this.webView=n(new d.WebView());this.topNav=n(new d.View());this.doneButton=n(new k());this.doneButton.onclick=function(o){this.navController.back()}.bind(this);this._style=__ngs.r_(__ngs._7e).RegistrationWebScreen;this._style.applyTo(this)},_configureHost:function(m){m.setIsFooterEnabled(false)},_unconfigureHost:function(m){m.setIsFooterEnabled(false)},willPush:function($super,n){this.setView(new d.View());$super(n);var w=d.Window.getWidth();var x=d.Window.getHeight();var p=0;var r=0;var u=new d.ViewGeometry.Rect([r,p,w,x]);u.x=0;u.y=0;this.view().setFrame(u);var q=u.copy();var o=u.copy();var v=__ngs.r_(__ngs._7).Capabilities;u.sliceVertical(u.h*(66/800));this._totalWidth=d.Window.getWidth();this._totalHeight=d.Window.getHeight();var s=q.sliceVertical(66/800*this._totalHeight);s.w=this._totalWidth;this.topNav.setFrame(s);this.doneButton.setText(l("Done"));var t=o.sliceVertical(66/800*this._totalHeight);t.w=80/480*this._totalWidth;t.h=s.h-s.h/5;t.y=s.h/10;t.x=(this._totalWidth-t.w)-s.h/10;this.doneButton.setFrame(t);if(!v.isPlatformAndroid()){this.view().addChild(this.topNav);this.topNav.addChild(this.doneButton)}this.webView.setFrame(u);this.view().addChild(this.webView);this.webView.setGradient({gradient:["FFFF 0.0"]});this.webView.loadUrl(this._contentUrl,{"Accept-Language":j.getAcceptLanguage()});for(var m=0;m<this.retainedViews.length;m++){this.view().addChild(this.retainedViews[m])}if(n.host){this._configureHost(n.host)}},willReshow:function($super,m){$super(m);if(m.host){this._configureHost(m.host)}},willHide:function($super,m){$super(m);if(m.host){this._unconfigureHost(m.host)}},willPop:function($super,m){$super(m);if(m.host){this._unconfigureHost(m.host)}}})}};__ngs._b5={_c:null,_d:function(){var c={exports:{}};var a=c.exports;this._c=c;var e=__ngs.r_(__ngs._59).UI;var f=__ngs.r_(__ngs._2e).Game;var b=__ngs.r_(__ngs._2z).Assets;var d=e.View.subclass({classname:"RegistrationContainer",_animateTime:200,_rect:null,_closeBool:false,initialize:function($super,l,g){$super();NgLogD("initialize RegistrationBackground");this._closeBool=g;this.containerFrame=[0,0,100,100];this.backgroundMatte=new e.View();this.backgroundView=new e.Image();this.gameIcon=new e.Image();this.containerView=[new e.View(),new e.View()];this.currentContainerIdx=0;this.inViewAnimation=false;if(g){this.closeBtn=new e.Button()}this.addChild(this.backgroundView);this.addChild(this.backgroundMatte);this.addChild(this.gameIcon);this.addChild(this.containerView[0]);this.addChild(this.containerView[1]);if(g){this.addChild(this.closeBtn)}var h=__ngs.r_(__ngs._cj).RegistrationContainer;h.applyTo(this);if(g){this.closeBtn.setText("X");this.closeBtn.setOnClick(this.bind(function(){NgLogD("closeBtn CLICK");l()}))}var k=e.Window.getWidth();var j=e.Window.getHeight();if(j>k){f.getCurrentGame(function(n,m){if(n||!m){this.gameIcon.setVisible(false)}else{this.gameIcon.setVisible(true);this.gameIcon.setImage(m.iconURL)}}.bind(this))}else{this.gameIcon.setVisible(false)}},destroy:function(){this.backgroundMatte.destroy();this.backgroundView.destroy();this.gameIcon.destroy();this.containerView[0].destroy();this.containerView[1].destroy()},sizeChanged:function(){this.layoutSubviews()},layoutSubviews:function($super){$super();var l=e.Window.getWidth();var o=e.Window.getHeight();var g=0;var h=0;this.containerFrame=[h,g,l,o];this.backgroundMatte.setFrame(this.containerFrame);this.backgroundView.setFrame(this.containerFrame);this.containerView[0].setFrame(this.containerFrame);this.containerView[1].setFrame(this.containerFrame);this.backgroundMatte.setImage(l>o?b.image("footer_landscape_bright_lowres.png"):b.image("footer_portrait_bright_lowres.png"));var j=(l<o?l:o)/480;var k=128*j;this.gameIcon.setFrame([h+l/2-k/2,g+o-k*1.5,k,k]);this._rect=new e.ViewGeometry.Rect([h,g,l,o]);this._rect.sliceVertical(e.Window.getHeight()*0.15);this._rect.y-=e.Window.getHeight()*0.075;if(this._closeBool){var m=40*j;var n=8*j;this.closeBtn.setFrame([l-n-m,n,m,m])}},_clearContainer:function(g){var j=g.getChildren();var h;for(h=j.length-1;h>=0;--h){g.removeChild(j[h])}},shouldAllowTransition:function(){return this.inViewAnimation!==true},animateInNewView:function(m,l){var j=this.containerView[this.currentContainerIdx];if(this.inViewAnimation){NgLogW("Mobage/RegistrationContainer/animateInNewView: Called while animating, canceling animation");this.animationCancelled=true;this._clearContainer(j);j.addChild(m)}else{var g=(this.currentContainerIdx+1)%2;var k=this.containerView[g];this.inViewAnimation=true;this.animationCancelled=false;k.addChild(m);this.currentContainerIdx=g;this._setContainerPositions(k,j,true,l);var h=this;e.animate(function(){h._setContainerPositions(k,j,false,l)},d._animateTime,function(){if(this.animationCancelled!==true){h._clearContainer(j)}h.inViewAnimation=false})}},_setContainerPositions:function(g,j,n,p){var o=e.Window.getWidth();var r=e.Window.getHeight();var l=0;var m=0;var q=m+o*(-1-0.5);var h=m;var k=m+o*(1+0.5);if(n){g.setFrame([p?q:k,l,o,r])}else{g.setFrame([h,l,o,r]);j.setFrame([p?k:q,l,o,r])}}});a.RegistrationContainer=d}};__ngs._b6={_c:null,_d:function(){var c={exports:{}};var h=c.exports;this._c=c;var j=__ngs.r_(__ngs._5).Core;var g=__ngs.r_(__ngs._59).UI;var f=__ngs.r_(__ngs._2e).Game;var m=__ngs.r_(__ngs._n).LocalizedString;var k=__ngs.r_(__ngs._5l).UnspammableButton;var d=__ngs.r_(__ngs._q).MobageAnalytics;var b=__ngs.r_(__ngs._6k).MobageStyle;var l=b.ScaledTextSize;var a=new (__ngs.r_(__ngs._2b).InterfaceLoader)({AB:function(){return __ngs.r_(__ngs._2l).AB}});var e=g.View.subclass({classname:"RegistrationStart",initialize:function($super,at,G,aq,S,v,av,Y){$super();NgLogD("Mobage/RegistrationStart/initialize - allowFacebookLogin="+av+" allowGuestLogin="+Y);var w=this;this.containerMainContainerView=new g.View();this.containerHeaderAreaView=new g.View();this.containerButtonAreaView=new g.View();this.containerButtonAreaBorderView=new g.View();this.titleImg=new g.Image();this.subtitleLbl=new g.Label();this.loginBtn=new k();this.signUpBtn=new k();if(av){this.facebookIconImg=new g.Image();this.facebookIconDivImg=new g.Image();this.facebookBtnLbl=new g.Label();this.facebookBtn=new k();this.facebookDescLbl=new g.Label();this.facebookOrLbl=new g.Label();this.facebookOrDivLeftView=new g.View();this.facebookOrDivRightView=new g.View();this.facebookIconImg.setTouchable(false);this.facebookIconDivImg.setTouchable(false);this.facebookBtnLbl.setTouchable(false)}if(Y){this.containerGuestOuterLayerView=new g.View();this.playAsGuestBtn=new k();this.guestDescLbl=new g.Label()}if(Y){this.addChild(this.containerGuestOuterLayerView)}this.addChild(this.containerHeaderAreaView);this.addChild(this.containerButtonAreaView);this.addChild(this.containerButtonAreaBorderView);this.addChild(this.containerMainContainerView);this.addChild(this.titleImg);this.addChild(this.subtitleLbl);if(av){this.addChild(this.facebookBtn);this.addChild(this.facebookIconImg);this.addChild(this.facebookIconDivImg);this.addChild(this.facebookBtnLbl);this.addChild(this.facebookDescLbl);this.addChild(this.facebookOrLbl);this.addChild(this.facebookOrDivLeftView);this.addChild(this.facebookOrDivRightView)}this.addChild(this.loginBtn);this.addChild(this.signUpBtn);if(Y){this.addChild(this.playAsGuestBtn);this.addChild(this.guestDescLbl)}var ak=__ngs.r_(__ngs._cj).RegistrationStart;ak.applyTo(this);this.setFrame([0,0,at[2],at[3]]);this.subtitleLbl.setText(m("Where the world comes to play."));this.loginBtn.setText(m("Log In"));this.signUpBtn.setText(m("Sign Up"));if(av){this.facebookDescLbl.setText(m("We'll never post without your permission"));this.facebookOrLbl.setText(m("or"));this.facebookBtnLbl.setText(m("Sign in with Facebook"))}if(Y){a.AB.getServiceVariants(function(ax,ay){if(ay&&ay.regFlowTieredVariant=="v2"){w.playAsGuestBtn.setText(m("Play Now!"))}else{w.playAsGuestBtn.setText(m("Play as guest"))}});this.guestDescLbl.setText(m("Don't want to sign up yet?"))}var r=at[0];var ac=at[1];var F=at[2];var ao=at[3];var s=r+F;var aj=ac+ao;var P=(r+s)/2;var O=(ac+aj)/2;var T=(at[2]<at[3]?at[2]:at[3])/480;var t=400*T;var ar=P-(t/2);var am=ac+60*T;var R=113*T;var aw=6*T;if(aw<4){aw=4}var L=am+R+aw;var C=16*T;var ae=165*T;var K=50*T;var X=10*T;var x;if(av){var aa=L+C+K;var ad=40*T;var Z=ae*2+X-4*T;var M=35*T;var ab=(Z-M)/2;var E=P-M/2-ab;var A=P+M/2;var al=aa+ad/2-1;var o=P-M/2;var z=340*T;var q=50*T;var H=P-z/2;var af=aa+ad;var N=q*0.55;var I=af+q*0.25;var J=H+q*0.25+4*T;var W=af+7*T;var au=q-12*T;var U=J+N+3*T;var ah=U+2;var B=H+z-ah;var an=af+q+3*T;var D=28*T;x=(an+D+C)-L}else{x=C*2+K+8*T}var u=R+aw+x;var p=268*T;var V=p/500*148;var Q=P-(p/2);var ai=am+6*T;var ag=28*T;var y=am+R-ag-4*T;var ap=P-ae-X/2;var n=P+X/2;this.containerMainContainerView.setFrame([ar,am,t,u]);this.containerHeaderAreaView.setFrame([ar,am,t,R]);this.containerButtonAreaBorderView.setFrame([ar,am+R,t,aw]);this.containerButtonAreaView.setFrame([ar,L,t,x]);this.titleImg.setFrame([Q,ai,p,V]);this.subtitleLbl.setFrame([ar,y,t,ag]);this.loginBtn.setFrame([ap,L+C,ae,K]);this.signUpBtn.setFrame([n,L+C,ae,K]);if(av){this.facebookIconImg.setFrame([J,I,N,N]);this.facebookIconDivImg.setFrame([U,W,2,au]);this.facebookBtn.setFrame([H,af,z,q]);this.facebookBtnLbl.setFrame([ah,af,B,q]);this.facebookDescLbl.setFrame([ar,an,t,D]);this.facebookOrLbl.setFrame([o,aa,M,ad]);this.facebookOrDivLeftView.setFrame([E,al,ab,2]);this.facebookOrDivRightView.setFrame([A,al,ab,2])}if(av){this.facebookBtn.setOnClick(this.bind(function(){NgLogD("facebookBtn CLICK");d.reportLoginRegEvent("RegStartFBLoginClick");S()}))}this.loginBtn.setOnClick(this.bind(function(){NgLogD("loginBtn CLICK");d.reportLoginRegEvent(av?"RegStartLoginClick":"RegStartLoginClickNOFB");G()}));this.signUpBtn.setOnClick(this.bind(function(){NgLogD("signUpBtn CLICK");d.reportLoginRegEvent(av?"RegStartSignUpClick":"RegStartSignUpClickNOFB");aq()}));if(Y){this.playAsGuestBtn.setOnClick(this.bind(function(){NgLogD("playAsGuestBtn CLICK");d.reportLoginRegEvent("REGGUESTPLAYCLICK");v()}))}g.measureText(this.subtitleLbl.getText(),9000,9000,this.subtitleLbl.getStyle().getTextFont(),this.subtitleLbl.getStyle().getTextSize(),function(ax){if(ax.totalWidth>t){this.subtitleLbl.getStyle().setTextSize(l(12));this.subtitleLbl.getStyle().applyTo(this.subtitleLbl)}}.bind(this));if(av){g.measureText(this.facebookDescLbl.getText(),9000,9000,this.facebookDescLbl.getStyle().getTextFont(),this.facebookDescLbl.getStyle().getTextSize(),function(ax){if(ax.totalWidth>t*0.9){var ay=this.facebookDescLbl.getFrame();ay[1]-=9*T;ay[3]*=2;this.facebookDescLbl.setFrame(ay)}}.bind(this))}if(Y){g.measureText(this.playAsGuestBtn.getText(),9000,9000,this.playAsGuestBtn.getStyle().getTextFont(),this.playAsGuestBtn.getStyle().getTextSize(),function(aH){var aC=148*T;var ay=0;if(aH.totalWidth>aC*0.9){ay=16*T}var aF=68*T+ay;var aG=u+am;var aA=40*T+ay;var aD=aG+aF/2-aA/2;var aB=(aD-aG);var ax=ar+t-aB-aC;var aE=ar+aB;var az=t-aC-aB*2;this.containerGuestOuterLayerView.setFrame([ar,aG-40*T,t,aF+40*T]);this.playAsGuestBtn.setFrame([ax,aD,aC,aA]);this.guestDescLbl.setFrame([aE,aG,az,aF])}.bind(this))}},destroy:function(){this.containerMainContainerView.destroy();this.containerHeaderAreaView.destroy();this.containerButtonAreaView.destroy();this.containerButtonAreaBorderView.destroy();this.titleImg.destroy();this.subtitleLbl.destroy();this.loginBtn.destroy();this.signUpBtn.destroy();if(this.facebookBtn){this.facebookIconImg.destroy();this.facebookIconDivImg.destroy();this.facebookBtn.destroy();this.facebookBtnLbl.destroy();this.facebookDescLbl.destroy();this.facebookOrLbl.destroy();this.facebookOrDivLeftView.destroy();this.facebookOrDivRightView.destroy()}if(this.playAsGuestBtn){this.containerGuestOuterLayerView.destroy();this.playAsGuestBtn.destroy();this.guestDescLbl.destroy()}}});h.RegistrationStart=e}};__ngs._b7={_c:null,_d:function(){var a={exports:{}};var e=a.exports;this._c=a;var f=__ngs.r_(__ngs._5).Core;var d=__ngs.r_(__ngs._59).UI;var c=__ngs.r_(__ngs._2e).Game;var g=__ngs.r_(__ngs._8f).LimitedEditText;var j=__ngs.r_(__ngs._n).LocalizedString;var b=__ngs.r_(__ngs._q).MobageAnalytics;var h=d.View.subclass({classname:"RegistrationStart",initialize:function($super,Z,Y,v,O){$super();NgLogD("Mobage/RegistrationLogin/initialize");this.containerMainContainerView=new d.View();this.containerHeaderAreaView=new d.View();this.containerButtonAreaView=new d.View();this.containerButtonAreaBorderView=new d.View();this.headerImg=new d.Image();this.titleLbl=new d.Label();this.emailInput=new d.EditText();this.passwordInput=new g("new_password_field");this.backBtn=new d.Button();this.loginBtn=new d.Button();this.forgotPassLink=new d.Button();this.passwordInput.setInputType(d.Commands.InputType.Password);this.addChild(this.containerHeaderAreaView);this.addChild(this.containerButtonAreaView);this.addChild(this.containerButtonAreaBorderView);this.addChild(this.headerImg);this.addChild(this.containerMainContainerView);this.addChild(this.titleLbl);this.addChild(this.emailInput);this.addChild(this.passwordInput);this.addChild(this.backBtn);this.addChild(this.loginBtn);this.addChild(this.forgotPassLink);var X=__ngs.r_(__ngs._cj).RegistrationCommon;X.applyTo(this);var T=__ngs.r_(__ngs._cj).RegistrationLogin;T.applyTo(this);this.setFrame([0,0,Z[2],Z[3]]);var l=Z[0];var R=Z[1];var s=Z[2];var V=Z[3];var m=l+s;var S=R+V;var D=(l+m)/2;var B=(R+S)/2;var H=(Z[2]<Z[3]?Z[2]:Z[3])/480;var W=400*H;var F=D-(W/2);var q=R+60*H;var G=58*H;var k=G;var w=G;var K=q;var N=G;if(f.Capabilities.isPlatformIOS()){w-=1;K-=5*H;N+=10*H}var aa=6*H;if(aa<4){aa=4}var A=q+G+aa;var r=16*H;var y=r;var E=W-y*2;var t=F+y;var M=56*H;var L=12*H;var I=10*H;var Q=A+r;var x=Q+M+L;var U=x+M+L;var C=(E-I)/2;var n=50*H;var z=t;var u=z+C+I;var J=U+n+L;var P=28*H;var o=J+P+r;var p=o-A;this.containerHeaderAreaView.setFrame([F,q,W,G]);this.containerButtonAreaView.setFrame([F,A,W,p]);this.containerButtonAreaBorderView.setFrame([F,q+G,W,aa]);this.headerImg.setFrame([F,q,k,w]);this.containerMainContainerView.setFrame([F,q,W,o-q]);this.titleLbl.setFrame([F,K,W,N]);this.emailInput.setFrame([t,Q,E,M]);this.passwordInput.setFrame([t,x,E,M]);this.backBtn.setFrame([z,U,C,n]);this.loginBtn.setFrame([u,U,C,n]);this.titleLbl.setText(j("Log In!"));this.emailInput.setPlaceholder(j("Email or Mobage name"));this.passwordInput.setPlaceholder(j("Password"));this.forgotPassLink.setText(j("Forgot Password?"));this.backBtn.setText(j("Back"));this.loginBtn.setText(j("Log in"));this.forgotPassLink.setOnClick(this.bind(function(){NgLogD("forgotPassLink CLICK");b.reportLoginRegEvent("RegLoginForgotPwdClick");O(this.emailInput.getText())}));this.loginBtn.setOnClick(this.bind(function(){NgLogD("loginBtn CLICK");b.reportLoginRegEvent("RegLoginLoginClick");this.emailInput.blur();this.passwordInput.blur();v(this.emailInput,this.passwordInput)}));this.backBtn.setOnClick(this.bind(function(){NgLogD("backBtn CLICK");b.reportLoginRegEvent("RegLoginBackClick");this.emailInput.blur();this.passwordInput.blur();Y(true)}));d.measureText(this.forgotPassLink.getText(),9000,9000,this.forgotPassLink.getStyle().getTextFont(),this.forgotPassLink.getStyle().getTextSize(),function(ac){var ab=ac.totalWidth+5*H;this.forgotPassLink.setFrame([t+E-ab-6,J-8,ab+12,P+16])}.bind(this))},destroy:function(){this.containerHeaderAreaView.destroy();this.containerButtonAreaView.destroy();this.containerButtonAreaBorderView.destroy();this.headerImg.destroy();this.containerMainContainerView.destroy();this.titleLbl.destroy();this.emailInput.destroy();this.passwordInput.destroy();this.backBtn.destroy();this.loginBtn.destroy();this.forgotPassLink.destroy()},setUserEmail:function(k){this.emailInput.setText(k);this.emailInput.setOnFocus(this.bind(function(){this.emailInput.setText("")}))}});e.RegistrationLogin=h}};__ngs._b8={_c:null,_d:function(){var b={exports:{}};var f=b.exports;this._c=b;var g=__ngs.r_(__ngs._5).Core;var d=__ngs.r_(__ngs._59).UI;var c=__ngs.r_(__ngs._2e).Game;var j=__ngs.r_(__ngs._8f).LimitedEditText;var k=__ngs.r_(__ngs._n).LocalizedString;var h=__ngs.r_(__ngs._5l).UnspammableButton;var a=__ngs.r_(__ngs._q).MobageAnalytics;var e=d.View.subclass({classname:"RegistrationStart",_backFunc:null,initialize:function($super,aa,Z,B,P){$super();NgLogD("Mobage/RegistrationLinkFB/initialize");this.containerMainContainerView=new d.View();this.containerHeaderAreaView=new d.View();this.containerButtonAreaView=new d.View();this.containerButtonAreaBorderView=new d.View();this.headerImg=new d.Image();this.titleLbl=new d.Label();this.emailInput=new d.EditText();this.passwordInput=new j("link_password_field");this.backBtn=new d.Button();this.loginBtn=new d.Button();this.forgotPassLink=new d.Button();this.passwordInput.setInputType(d.Commands.InputType.Password);this.addChild(this.containerHeaderAreaView);this.addChild(this.containerButtonAreaView);this.addChild(this.containerButtonAreaBorderView);this.addChild(this.headerImg);this.addChild(this.containerMainContainerView);this.addChild(this.titleLbl);this.addChild(this.emailInput);this.addChild(this.passwordInput);this.addChild(this.backBtn);this.addChild(this.loginBtn);this.addChild(this.forgotPassLink);var Y=__ngs.r_(__ngs._cj).RegistrationCommon;Y.applyTo(this);var U=__ngs.r_(__ngs._cj).RegistrationLogin;U.applyTo(this);this.setFrame([0,0,aa[2],aa[3]]);var m=aa[0];var S=aa[1];var t=aa[2];var W=aa[3];var n=m+t;var T=S+W;var E=(m+n)/2;var C=(S+T)/2;var I=(aa[2]<aa[3]?aa[2]:aa[3])/480;var X=400*I;var G=E-(X/2);var r=S+60*I;var H=58*I;var l=H;var w=H;var L=r;var O=H;if(g.Capabilities.isPlatformIOS()){w-=1;L-=5*I;O+=10*I}var ab=6*I;if(ab<4){ab=4}var A=r+H+ab;var s=16*I;var y=s;var F=X-y*2;var u=G+y;var N=56*I;var M=12*I;var J=10*I;var R=A+s;var x=R+N+M;var V=x+N+M;var D=(F-J)/2;var o=50*I;var z=u;var v=z+D+J;var K=V+o+M;var Q=28*I;var p=K+Q+s;var q=p-A;this.containerHeaderAreaView.setFrame([G,r,X,H]);this.containerButtonAreaView.setFrame([G,A,X,q]);this.containerButtonAreaBorderView.setFrame([G,r+H,X,ab]);this.headerImg.setFrame([G,r,l,w]);this.containerMainContainerView.setFrame([G,r,X,p-r]);this.titleLbl.setFrame([G,L,X,O]);this.emailInput.setFrame([u,R,F,N]);this.passwordInput.setFrame([u,x,F,N]);this.backBtn.setFrame([z,V,D,o]);this.loginBtn.setFrame([v,V,D,o]);this.titleLbl.setText(k("Link Account"));this.emailInput.setPlaceholder(k("Email or Mobage name"));this.passwordInput.setPlaceholder(k("Password"));this.forgotPassLink.setText(k("Forgot Password?"));this.backBtn.setText(k("Back"));this.loginBtn.setText(k("Link"));this.forgotPassLink.setOnClick(this.bind(function(){NgLogD("forgotPassLink CLICK");a.reportLoginRegEvent("RegLinkFBForgotPwdClick");P(this.emailInput.getText())}));this.loginBtn.setOnClick(this.bind(function(){NgLogD("linkFunc CLICK");this.emailInput.blur();this.passwordInput.blur();a.reportLoginRegEvent("RegLinkFBLoginClick");NgLogD("RegistrationFBLinkLogin");B(this.emailInput,this.passwordInput,false)}));this.backBtn.setOnClick(this.bind(function(){NgLogD("backBtn CLICK");a.reportLoginRegEvent("RegLinkFBBackClick");this.emailInput.blur();this.passwordInput.blur();this._backFunc(true)}));this.emailInput.setOnFocus(this.bind(function(){a.reportLoginRegEvent("RegLinkFBNameClick");NgLogD("RegLinkFBNameTap")}));d.measureText(this.forgotPassLink.getText(),9000,9000,this.forgotPassLink.getStyle().getTextFont(),this.forgotPassLink.getStyle().getTextSize(),function(ad){var ac=ad.totalWidth+5*I;this.forgotPassLink.setFrame([u+F-ac-6,K-8,ac+12,Q+16])}.bind(this))},setBackFunc:function(l){this._backFunc=l},destroy:function(){},setUserEmail:function(l){this.emailInput.setText(l)}});f.RegistrationLinkFB=e}};__ngs._b9={_c:null,_d:function(){var a={exports:{}};var e=a.exports;this._c=a;var f=__ngs.r_(__ngs._5).Core;var d=__ngs.r_(__ngs._59).UI;var c=__ngs.r_(__ngs._2e).Game;var h=__ngs.r_(__ngs._8f).LimitedEditText;var j=__ngs.r_(__ngs._n).LocalizedString;var b=__ngs.r_(__ngs._q).MobageAnalytics;var g=d.View.subclass({classname:"RegistrationSignUp",initialize:function($super,ae,ad,C,P,k,A,S){$super();NgLogD("Mobage/RegistrationSignUp/initialize");this.containerMainContainerView=new d.View();this.containerHeaderAreaView=new d.View();this.containerButtonAreaView=new d.View();this.containerButtonAreaBorderView=new d.View();this.headerImg=new d.Image();this.titleLbl=new d.Label();this.emailInput=new d.EditText();this.passwordInput=new h("new_password_field");this.backBtn=new d.Button();this.signUpBtn=new d.Button();this.termsLineLbl=new d.Label();this.termsLink1Btn=new d.Button();this.termsAndLbl=new d.Label();this.termsLink2Btn=new d.Button();this.passwordInput.setInputType(d.Commands.InputType.Password);this.addChild(this.containerHeaderAreaView);this.addChild(this.containerButtonAreaView);this.addChild(this.containerButtonAreaBorderView);this.addChild(this.headerImg);this.addChild(this.containerMainContainerView);this.addChild(this.titleLbl);this.addChild(this.termsLineLbl);this.addChild(this.termsAndLbl);this.addChild(this.emailInput);this.addChild(this.passwordInput);this.addChild(this.backBtn);this.addChild(this.signUpBtn);this.addChild(this.termsLink1Btn);this.addChild(this.termsLink2Btn);var ab=__ngs.r_(__ngs._cj).RegistrationCommon;ab.applyTo(this);var X=__ngs.r_(__ngs._cj).RegistrationSignUp;X.applyTo(this);this.setFrame([0,0,ae[2],ae[3]]);var m=ae[0];var U=ae[1];var u=ae[2];var Z=ae[3];var n=m+u;var W=U+Z;var G=(m+n)/2;var E=(U+W)/2;var L=(ae[2]<ae[3]?ae[2]:ae[3])/480;var aa=400*L;var I=G-(aa/2);var s=U+60*L;var J=58*L;var l=J;var w=J;var N=s;var R=J;if(f.Capabilities.isPlatformIOS()){w-=1;N-=5*L;R+=10*L}var af=6*L;if(af<4){af=4}var D=s+J+af;var t=16*L;var z=t;var H=aa-z*2;var v=I+z;var Q=56*L;var O=12*L;var M=10*L;var T=D+t;var x=T+Q+O;var Y=x+Q+O;var F=(H-M)/2;var p=50*L;var B=v;var K=B+F+M;var V=Y+p+O;var y=22*L;var ac=V+y*2;var q=ac+y+t;var r=q-D;this.containerHeaderAreaView.setFrame([I,s,aa,J]);this.containerButtonAreaView.setFrame([I,D,aa,r]);this.containerButtonAreaBorderView.setFrame([I,s+J,aa,af]);this.headerImg.setFrame([I,s,l,w]);this.containerMainContainerView.setFrame([I,s,aa,q-s]);this.titleLbl.setFrame([I,N,aa,R]);this.emailInput.setFrame([v,T,H,Q]);this.passwordInput.setFrame([v,x,H,Q]);this.backBtn.setFrame([B,Y,F,p]);this.signUpBtn.setFrame([K,Y,F,p]);this.termsLineLbl.setFrame([v,V,H,y*2]);this.emailInput.setPlaceholder(j("Enter a valid email"));this.titleLbl.setText(j("Quick Sign Up!"));this.passwordInput.setPlaceholder(j("Password (min. 8 characters)"));this.backBtn.setText(j("Back"));this.signUpBtn.setText(j("Sign Up"));this.termsLineLbl.setText(j("By tapping 'Sign Up', you acknowledge that you are at least 14 years old and agree to our"));this.termsLink1Btn.setText(j("Terms of Service"));this.termsAndLbl.setText(j("and"));this.termsLink2Btn.setText(j("Privacy Policy"));var o=this;if(A.length>4){o.emailInput.setText(A)}this.signUpBtn.setOnClick(this.bind(function(){NgLogD("signUpBtn CLICK");b.reportLoginRegEvent(!S?"RegSignUpSignUpClick":"UPGRADESIGNUPSIGNUPCLICK");this.emailInput.blur();this.passwordInput.blur();C(this.emailInput,this.passwordInput)}));this.backBtn.setOnClick(this.bind(function(){NgLogD("backBtn CLICK");b.reportLoginRegEvent(!S?"RegSignUpBackClick":"UPGRADESignUpBackClick");this.emailInput.blur();this.passwordInput.blur();ad(true)}));this.termsLink1Btn.setOnClick(this.bind(function(){NgLogD("termsLink1 CLICK");b.reportLoginRegEvent(!S?"RegSignUpTermsClick":"UPGRADESignUpTermsClick");this.emailInput.blur();this.passwordInput.blur();P()}));this.termsLink2Btn.setOnClick(this.bind(function(){NgLogD("termsLink2 CLICK");b.reportLoginRegEvent(!S?"RegSignUpPrivacyClick":"UPGRADESignUpPrivacyClick");this.emailInput.blur();this.passwordInput.blur();k()}));this.emailInput.setOnFocus(this.bind(function(){b.reportLoginRegEvent(!S?"RegSignUpEmailClick":"UPGRADESignUpEmailClick");NgLogD("RegFinishNameTap")}));d.measureText(this.termsLink1Btn.getText(),9000,9000,this.termsLink1Btn.getStyle().getTextFont(),this.termsLink1Btn.getStyle().getTextSize(),function(ag){d.measureText(this.termsLink2Btn.getText(),9000,9000,this.termsLink2Btn.getStyle().getTextFont(),this.termsLink2Btn.getStyle().getTextSize(),function(ah){d.measureText(" "+this.termsAndLbl.getText()+" ",9000,9000,this.termsAndLbl.getStyle().getTextFont(),this.termsAndLbl.getStyle().getTextSize(),function(aq){var ao=aq.height;var av=ag.totalWidth;var at=aq.totalWidth;var am=ah.totalWidth;var ak=av+at+am;var au=8;ac=V+ao*2;if(ak>aa*0.7){var al=this.termsLineLbl.getFrame();al[1]-=10*L;this.termsLineLbl.setFrame(al);ac-=10*L;var ar=(G-av/2);this.termsLink1Btn.setFrame([ar-au,ac-au,av+au*2,ao+au*2]);var ap=at+am;var aj=(G-ap/2);var an=ac+ao;this.termsAndLbl.setFrame([aj,an,at,ao]);this.termsLink2Btn.setFrame([aj+at-au,an-au,am+au*2,ao+au*2])}else{var ai=G-ak/2;this.termsLink1Btn.setFrame([ai-au,ac-au,av+au*2,ao+au*2]);this.termsAndLbl.setFrame([ai+av,ac,at,ao]);this.termsLink2Btn.setFrame([ai+av+at-au,ac-au,am+au*2,ao+au*2])}}.bind(this))}.bind(this))}.bind(this))},destroy:function(){this.containerHeaderAreaView.destroy();this.containerButtonAreaView.destroy();this.containerButtonAreaBorderView.destroy();this.headerImg.destroy();this.containerMainContainerView.destroy();this.titleLbl.destroy();this.emailInput.destroy();this.passwordInput.destroy();this.backBtn.destroy();this.signUpBtn.destroy();this.termsLineLbl.destroy();this.termsLink1Btn.destroy();this.termsAndLbl.destroy();this.termsLink2Btn.destroy()},setUserEmail:function(k){this.emailInput.setText(k)}});e.RegistrationSignUp=g}};__ngs._ba={_c:null,_d:function(){var a={exports:{}};var e=a.exports;this._c=a;var f=__ngs.r_(__ngs._5).Core;var d=__ngs.r_(__ngs._59).UI;var c=__ngs.r_(__ngs._2e).Game;var g=__ngs.r_(__ngs._8f).LimitedEditText;var j=__ngs.r_(__ngs._n).LocalizedString;var b=__ngs.r_(__ngs._q).MobageAnalytics;var h=d.View.subclass({classname:"RegistrationFinish",initialize:function($super,Z,Q,N){$super();NgLogD("Mobage/RegistrationFinish/initialize");this.containerMainContainerView=new d.View();this.containerHeaderAreaView=new d.View();this.containerButtonAreaView=new d.View();this.containerButtonAreaBorderView=new d.View();this.headerImg=new d.Image();this.titleLbl=new d.Label();this.regDesc1Lbl=new d.Label();this.regDesc2Lbl=new d.Label();this.checkTxt=new d.Label();this.gamertagInput=new d.EditText();this.gamertagInputImage=new d.Image();this.checkBox=new d.CheckBox();this.saveBtn=new d.Button();this.addChild(this.containerHeaderAreaView);this.addChild(this.containerButtonAreaView);this.addChild(this.containerButtonAreaBorderView);this.addChild(this.headerImg);this.addChild(this.containerMainContainerView);this.addChild(this.titleLbl);this.addChild(this.regDesc1Lbl);this.addChild(this.regDesc2Lbl);this.addChild(this.checkTxt);this.addChild(this.gamertagInput);this.addChild(this.gamertagInputImage);this.addChild(this.checkBox);this.addChild(this.saveBtn);var W=__ngs.r_(__ngs._cj).RegistrationCommon;W.applyTo(this);var T=__ngs.r_(__ngs._cj).RegistrationFinish;T.applyTo(this);this.setFrame([0,0,Z[2],Z[3]]);var n=Z[0];var O=Z[1];var u=Z[2];var U=Z[3];var p=n+u;var S=O+U;var D=(n+p)/2;var C=(O+S)/2;var H=(Z[2]<Z[3]?Z[2]:Z[3])/480;var V=400*H;var F=D-(V/2);var s=O+60*H;var G=58*H;var l=G;var w=G;var I=s;var L=G;if(f.Capabilities.isPlatformIOS()){w-=1;I-=5*H;L+=10*H}var ab=6*H;if(ab<4){ab=4}var A=s+G+ab;var t=16*H;var y=t;var E=V-y*2;var v=F+y;var K=56*H;var J=12*H;var P=165*H;var z=50*H;var Y=45*H;var X=24*H;var x=A+t;var R=x+X;var aa=R+X+J;var M=aa+K+J;var m=M+Y+J;var q=m+z+t;var r=q-A;var o=v+Y+5*H;var k=v+E-o;var B=D-P/2;this.containerHeaderAreaView.setFrame([F,s,V,G]);this.containerButtonAreaView.setFrame([F,A,V,r]);this.containerButtonAreaBorderView.setFrame([F,s+G,V,ab]);this.headerImg.setFrame([F,s,l,w]);this.containerMainContainerView.setFrame([F,s,V,q-s]);this.titleLbl.setFrame([F,I,V,L]);this.regDesc1Lbl.setFrame([F,x,V,X]);this.regDesc2Lbl.setFrame([F,R,V,X]);this.checkTxt.setFrame([o,M,k,Y]);this.gamertagInput.setFrame([v,aa,E,K]);this.checkBox.setFrame([v,M,Y,Y]);this.saveBtn.setFrame([B,m,P,z]);this.gamertagInputImage.setFrame(this.gamertagInput.getFrame());this.titleLbl.setText(j("Last Step!"));this.regDesc1Lbl.setText(j("Create your Mobage name!"));this.regDesc2Lbl.setText(j("Be creative. This is how you'll be seen."));this.checkTxt.setText(j("Get Mobage news & updates"));this.gamertagInput.setPlaceholder(j("Enter a Mobage name"));this.saveBtn.setText(j("Save & Play"));this.checkBox.setChecked(true);this.saveBtn.setOnClick(this.bind(function(){NgLogD("saveBtn CLICK");b.reportLoginRegEvent(!N?"RegFinishSaveClick":"UPGRADEFinishSaveClick");this.gamertagInput.blur();Q(this.gamertagInput,this.checkBox.getChecked(),false)}))},getGamertagField:function(){return this.gamertagInput},getGamertagFieldImage:function(){return this.gamertagInputImage},setGamerName:function(k){NgLogD("RegistrationFinish Set Gamer Name: "+k);this.gamertagInput.setText(k)},destroy:function(){}});e.RegistrationFinish=h}};__ngs._bb={_c:null,_d:function(){var c={exports:{}};var f=c.exports;this._c=c;var g=__ngs.r_(__ngs._5).Core;var e=__ngs.r_(__ngs._59).UI;var d=__ngs.r_(__ngs._2e).Game;var j=__ngs.r_(__ngs._8f).LimitedEditText;var k=__ngs.r_(__ngs._n).LocalizedString;var h=__ngs.r_(__ngs._5l).UnspammableButton;var b=__ngs.r_(__ngs._q).MobageAnalytics;var a=e.View.subclass({classname:"RegistrationFBFinish",initialize:function($super,ag,X,E,T){$super();NgLogD("Mobage/RegistrationFBFinish/initialize");this.containerMainContainerView=new e.View();this.containerHeaderAreaView=new e.View();this.containerButtonAreaView=new e.View();this.containerButtonAreaBorderView=new e.View();this.headerImg=new e.Image();this.titleLbl=new e.Label();this.regDesc1Lbl=new e.Label();this.regDesc2Lbl=new e.Label();this.checkTxt=new e.Label();this.gamertagInput=new e.EditText();this.gamertagInputImage=new e.Image();this.checkBox=new e.CheckBox();this.saveBtn=new e.Button();if(!T){this.linkFBTitle=new e.Label();this.linkFBTxt=new h()}this.addChild(this.containerHeaderAreaView);this.addChild(this.containerButtonAreaView);this.addChild(this.containerButtonAreaBorderView);this.addChild(this.headerImg);this.addChild(this.containerMainContainerView);this.addChild(this.titleLbl);this.addChild(this.regDesc1Lbl);this.addChild(this.regDesc2Lbl);this.addChild(this.checkTxt);this.addChild(this.gamertagInput);this.addChild(this.gamertagInputImage);this.addChild(this.checkBox);this.addChild(this.saveBtn);if(!T){this.addChild(this.linkFBTitle);this.addChild(this.linkFBTxt)}var ad=__ngs.r_(__ngs._cj).RegistrationCommon;ad.applyTo(this);var aa=__ngs.r_(__ngs._cj).RegistrationFinish;aa.applyTo(this);var B=__ngs.r_(__ngs._cj).RegistrationFBFinish;B.applyTo(this);this.setFrame([0,0,ag[2],ag[3]]);var o=ag[0];var U=ag[1];var v=ag[2];var ab=ag[3];var q=o+v;var Z=U+ab;var I=(o+q)/2;var H=(U+Z)/2;var M=(ag[2]<ag[3]?ag[2]:ag[3])/480;var ac=400*M;var K=I-(ac/2);var t=U+60*M;var L=58*M;var m=L;var x=L;var N=t;var Q=L;if(g.Capabilities.isPlatformIOS()){x-=1;N-=5*M;Q+=10*M}var ai=6*M;if(ai<4){ai=4}var D=t+L+ai;var u=16*M;var A=u;var J=ac-A*2;var w=K+A;var P=56*M;var O=12*M;var V=165*M;var C=50*M;var af=45*M;var ae=24*M;var S=24*M;var z=D+u;var Y=z+ae;var ah=Y+ae+O;var R=ah+P+O;var n=R+af+O;var y=n+C+26*M;var W=y+S;var G=S*2;var r;if(T){r=n+C+u}else{r=W+G+u}var s=r-D;var p=w+af+5*M;var l=w+J-p;var F=I-V/2;this.containerHeaderAreaView.setFrame([K,t,ac,L]);this.containerButtonAreaView.setFrame([K,D,ac,s]);this.containerButtonAreaBorderView.setFrame([K,t+L,ac,ai]);this.headerImg.setFrame([K,t,m,x]);this.containerMainContainerView.setFrame([K,t,ac,r-t]);this.titleLbl.setFrame([K,N,ac,Q]);this.regDesc1Lbl.setFrame([K,z,ac,ae]);this.regDesc2Lbl.setFrame([K,Y,ac,ae]);this.checkTxt.setFrame([p,R,l,af]);this.gamertagInput.setFrame([w,ah,J,P]);this.checkBox.setFrame([w,R,af,af]);this.saveBtn.setFrame([F,n,V,C]);this.gamertagInputImage.setFrame(this.gamertagInput.getFrame());if(!T){this.linkFBTitle.setFrame([w,y,J,S]);this.linkFBTxt.setFrame([w,W-6,J,G+12])}this.titleLbl.setText(k("Last step!"));this.regDesc1Lbl.setText(k("Create your Mobage name!"));this.regDesc2Lbl.setText(k("Be creative. This is how you'll be seen."));this.checkTxt.setText(k("Get Mobage news & updates"));this.gamertagInput.setPlaceholder(k("Enter a Mobage name"));this.saveBtn.setText(k("Save & Play"));if(!T){this.linkFBTitle.setText(k("Already have a Mobage or Plus+ account?"));this.linkFBTxt.setText(k("Link your Mobage account with Facebook.\nYou'll only need to do this once."))}this.checkBox.setChecked(true);this.saveBtn.setOnClick(this.bind(function(){NgLogD("saveBtn CLICK");b.reportLoginRegEvent(!T?"RegFBFinishSaveClick":"UPGRADEFBFinishSaveClick");this.gamertagInput.blur();X(this.gamertagInput,this.checkBox.getChecked())}));if(!T){this.linkFBTxt.setOnClick(this.bind(function(){NgLogD("linkFBTxt CLICK");b.reportLoginRegEvent("RegFBFinishLinkClick");E()}))}this.gamertagInput.setOnFocus(this.bind(function(){b.reportLoginRegEvent(!T?"RegFBFinishNameClick":"UPGRADEFBFinishNameClick");NgLogD("RegFBFinishNameTap")}))},getGamertagField:function(){return this.gamertagInput},getGamertagFieldImage:function(){return this.gamertagInputImage},setGamerName:function(l){NgLogD("RegistrationFBFinish Set Gamer Name: "+l);this.gamertagInput.setText(l)},destroy:function(){}});f.RegistrationFBFinish=a}};__ngs._bc={_c:null,_d:function(){var b={exports:{}};var f=b.exports;this._c=b;var g=__ngs.r_(__ngs._5).Core;var d=__ngs.r_(__ngs._59).UI;var c=__ngs.r_(__ngs._2e).Game;var j=__ngs.r_(__ngs._8f).LimitedEditText;var k=__ngs.r_(__ngs._n).LocalizedString;var e=__ngs.r_(__ngs._2z).Assets;var a=__ngs.r_(__ngs._q).MobageAnalytics;var h=d.View.subclass({classname:"RegistrationFBConfirm",initialize:function($super,ak,aj,A,Z){$super();NgLogD("Mobage/RegistrationFBConfirm/initialize");this.containerMainContainerView=new d.View();this.containerHeaderAreaView=new d.View();this.containerButtonAreaView=new d.View();this.containerButtonAreaBorderView=new d.View();this.headerImg=new d.Image();this.titleLbl=new d.Label();this.emailInput=new d.EditText();this.passwordInput=new j("fbconfirm_password_field");this.backBtn=new d.Button();this.loginBtn=new d.Button();this.forgotPassLink=new d.Button();this.confirmDescLbl=new d.Label();this.confirmUserImg=new d.Image();this.confirmUserGamertagLbl=new d.Label();this.confirmUserRealNameLbl=new d.Label();this.passwordInput.setInputType(d.Commands.InputType.Password);this.addChild(this.containerHeaderAreaView);this.addChild(this.containerButtonAreaView);this.addChild(this.containerButtonAreaBorderView);this.addChild(this.headerImg);this.addChild(this.containerMainContainerView);this.addChild(this.titleLbl);this.addChild(this.confirmDescLbl);this.addChild(this.confirmUserImg);this.addChild(this.confirmUserGamertagLbl);this.addChild(this.confirmUserRealNameLbl);this.addChild(this.emailInput);this.addChild(this.passwordInput);this.addChild(this.backBtn);this.addChild(this.loginBtn);this.addChild(this.forgotPassLink);var ah=__ngs.r_(__ngs._cj).RegistrationCommon;ah.applyTo(this);var E=__ngs.r_(__ngs._cj).RegistrationLogin;E.applyTo(this);var z=__ngs.r_(__ngs._cj).RegistrationFBConfirm;z.applyTo(this);this.setFrame([0,0,ak[2],ak[3]]);var m=ak[0];var ac=ak[1];var w=ak[2];var af=ak[3];var o=m+w;var ad=ac+af;var M=(m+o)/2;var J=(ac+ad)/2;var R=(ak[2]<ak[3]?ak[2]:ak[3])/480;var ag=400*R;var P=M-(ag/2);var u=ac+60*R;var Q=58*R;var l=Q;var B=Q;var V=u;var Y=Q;if(g.Capabilities.isPlatformIOS()){B-=1;V-=5*R;Y+=10*R}var am=6*R;if(am<4){am=4}var H=u+Q+am;var v=16*R;var F=v;var N=ag-F*2;var x=P+F;var X=56*R;var W=12*R;var T=10*R;var s=60*R;var L=H+v;var p=x;var I=28*R;var D=L+s/2-(I*2)/2;var al=D+I;var O=p+s+10*R;var S=x+N-O;var n=L+s+20*R;var ai=28*R;var ab=n+ai+W;var C=ab+X+W;var ae=C+X+W;var K=(N-T)/2;var q=50*R;var G=x;var y=G+K+T;var U=ae+q+W;var aa=28*R;var r=U+aa+v;var t=r-H;this.containerHeaderAreaView.setFrame([P,u,ag,Q]);this.containerButtonAreaView.setFrame([P,H,ag,t]);this.containerButtonAreaBorderView.setFrame([P,u+Q,ag,am]);this.headerImg.setFrame([P,u,l,B]);this.containerMainContainerView.setFrame([P,u,ag,r-u]);this.titleLbl.setFrame([P,V,ag,Y]);this.emailInput.setFrame([x,ab,N,X]);this.passwordInput.setFrame([x,C,N,X]);this.backBtn.setFrame([G,ae,K,q]);this.loginBtn.setFrame([y,ae,K,q]);this.confirmDescLbl.setFrame([x,n,N,ai]);this.confirmUserImg.setFrame([p,L,s,s]);this.confirmUserGamertagLbl.setFrame([O,D,S,I]);this.confirmUserRealNameLbl.setFrame([O,al,S,I]);this.titleLbl.setText(k("Is this you?"));this.confirmDescLbl.setText(k("Log in to link these accounts"));this.emailInput.setPlaceholder(k("Email Address"));this.passwordInput.setPlaceholder(k("Password"));this.forgotPassLink.setText(k("Forgot Password?"));this.backBtn.setText(k("Cancel"));this.loginBtn.setText(k("Link"));this.forgotPassLink.setOnClick(this.bind(function(){NgLogD("forgotPassLink CLICK");a.reportLoginRegEvent("RegFBConfirmForgotPwdClick");Z(this.emailInput.getText())}));this.loginBtn.setOnClick(this.bind(function(){NgLogD("loginBtn CLICK");this.emailInput.blur();this.passwordInput.blur();a.reportLoginRegEvent("RegFBConfirmLoginClick");NgLogD("RegistrationFBConfirmLogin");A(this.emailInput,this.passwordInput,true)}));this.backBtn.setOnClick(this.bind(function(){NgLogD("backBtn CLICK");a.reportLoginRegEvent("RegFBConfirmBackClick");this.emailInput.blur();this.passwordInput.blur();aj(true)}));d.measureText(this.forgotPassLink.getText(),9000,9000,this.forgotPassLink.getStyle().getTextFont(),this.forgotPassLink.getStyle().getTextSize(),function(ao){var an=ao.totalWidth+5*R;this.forgotPassLink.setFrame([x+N-an-6,U-8,an+12,aa+16])}.bind(this))},setUserEmail:function(l){this.emailInput.setText(l);NgLogD("RegistrationFBConfirm preset user email: "+l)},setProfileValues:function(n,l,m){NgLogD("Setting Profile Values for FBConfirm, userImage: "+n+", userName: "+l+", userGamertag: "+m);if(n!==""){this.confirmUserImg.setImage(n)}else{this.confirmUserImg.setImage(e.image("no-user-icon.png"))}if(l===""||l===undefined){this.confirmUserGamertagLbl.setText(m);this.confirmUserRealNameLbl.setText("")}else{this.confirmUserGamertagLbl.setText(l);this.confirmUserRealNameLbl.setText(m)}},destroy:function(){}});f.RegistrationFBConfirm=h}};__ngs._bd={_c:null,_d:function(){var b={exports:{}};var e=b.exports;this._c=b;var d=__ngs.r_(__ngs._59).UI;var j=__ngs.r_(__ngs._n).LocalizedString;var g=__ngs.r_(__ngs._5l).UnspammableButton;var c=__ngs.r_(__ngs._q).MobageAnalytics;var a=__ngs.r_(__ngs._6k).MobageStyle;var h=a.ScaledTextSize;var f=d.View.subclass({classname:"UpgradeUserStart",initialize:function($super,ah,K,af,q,aj){$super();NgLogD("Mobage/UpgradeUserStart/initialize");this.containerMainContainerView=new d.View();this.containerHeaderAreaView=new d.View();this.containerButtonAreaView=new d.View();this.containerButtonAreaBorderView=new d.View();this.containerGuestOuterLayerView=new d.View();this.titleImg=new d.Image();this.subtitleLbl=new d.Label();if(aj){this.facebookIconImg=new d.Image();this.facebookIconDivImg=new d.Image();this.facebookBtnLbl=new d.Label();this.facebookBtn=new g();this.facebookDescLbl=new d.Label();this.facebookIconImg.setTouchable(false);this.facebookIconDivImg.setTouchable(false);this.facebookBtnLbl.setTouchable(false)}this.signUpIconImg=new d.Image();this.signUpIconDivImg=new d.Image();this.signUpBtnLbl=new d.Label();this.signUpBtn=new g();this.startOverBtn=new g();this.startOverDescLbl=new d.Label();this.signUpIconImg.setTouchable(false);this.signUpIconDivImg.setTouchable(false);this.signUpBtnLbl.setTouchable(false);this.addChild(this.containerGuestOuterLayerView);this.addChild(this.containerMainContainerView);this.addChild(this.containerHeaderAreaView);this.addChild(this.containerButtonAreaView);this.addChild(this.containerButtonAreaBorderView);this.addChild(this.titleImg);this.addChild(this.subtitleLbl);if(aj){this.addChild(this.facebookDescLbl)}this.addChild(this.startOverDescLbl);this.addChild(this.signUpBtn);this.addChild(this.startOverBtn);this.addChild(this.signUpIconImg);this.addChild(this.signUpIconDivImg);this.addChild(this.signUpBtnLbl);if(aj){this.addChild(this.facebookBtn);this.addChild(this.facebookIconImg);this.addChild(this.facebookIconDivImg);this.addChild(this.facebookBtnLbl)}var aa=__ngs.r_(__ngs._cj).UpgradeUserStart;aa.applyTo(this);this.setFrame([0,0,ah[2],ah[3]]);var l=ah[0];var R=ah[1];var w=ah[2];var ad=ah[3];var m=l+w;var Z=R+ad;var G=(l+m)/2;var F=(R+Z)/2;var L=(ah[2]<ah[3]?ah[2]:ah[3])/480;var n=400*L;var ag=G-(n/2);var ac=R+60*L;var I=113*L;var ak=6*L;if(ak<4){ak=4}var D=ac+I+ak;var v=16*L;var Q=340*L;var S=50*L;var y=G-Q/2;var ab;if(aj){var U=D+v;var T=U+S+2*L;var X=26*L;var E=S*0.55;var A=U+S*0.25;var B=y+S*0.2+6*L;var P=U+7*L;var ai=S-12*L;var M=B+E+3*L;var W=M+2;var u=y+Q-W;ab=T+X+14*L}else{ab=D+v}var C=S*0.7;var ae=ab;var J=y+7*L;var x=ab+7*L;var r=S-12*L;var z=J+C+4*L;var O=z+2;var p=y+Q-O;var s=(ab+S+v)-D;var o=I+ak+s;var k=268*L;var N=k/500*148;var H=G-(k/2);var Y=ac+6*L;var V=28*L;var t=ac+I-V-4*L;this.containerMainContainerView.setFrame([ag,ac,n,o]);this.containerHeaderAreaView.setFrame([ag,ac,n,I]);this.containerButtonAreaBorderView.setFrame([ag,ac+I,n,ak]);this.containerButtonAreaView.setFrame([ag,D,n,s]);this.titleImg.setFrame([H,Y,k,N]);this.subtitleLbl.setFrame([ag,t,n,V]);this.signUpIconImg.setFrame([J,ae,C,S]);this.signUpIconDivImg.setFrame([z,x,2,r]);this.signUpBtnLbl.setFrame([O,ab,p,S]);this.signUpBtn.setFrame([y,ab,Q,S]);if(aj){this.facebookIconImg.setFrame([B,A,E,E]);this.facebookIconDivImg.setFrame([M,P,2,ai]);this.facebookBtn.setFrame([y,U,Q,S]);this.facebookBtnLbl.setFrame([W,U,u,S]);this.facebookDescLbl.setFrame([y,T,Q,X])}this.subtitleLbl.setText(j("Where the world comes to play."));this.signUpBtnLbl.setText(j("Sign Up with Email"));this.startOverBtn.setText(j("Start Over & Log In"));this.startOverDescLbl.setText(j("Already have a Mobage account?"));if(aj){this.facebookBtnLbl.setText(j("Sign in with Facebook"));this.facebookDescLbl.setText(j("We'll never post without your permission!"))}if(aj){this.facebookBtn.setOnClick(this.bind(function(){NgLogD("facebookBtn CLICK");c.reportLoginRegEvent("UPGRADEFBSTART");K()}))}this.signUpBtn.setOnClick(this.bind(function(){NgLogD("signUpBtn CLICK");c.reportLoginRegEvent("UPGRADEREGSTART");af()}));this.startOverBtn.setOnClick(this.bind(function(){NgLogD("startOverBtn CLICK");c.reportLoginRegEvent("UPGRADESTARTOVER");q()}));d.measureText(this.subtitleLbl.getText(),9000,9000,this.subtitleLbl.getStyle().getTextFont(),this.subtitleLbl.getStyle().getTextSize(),function(al){if(al.totalWidth>n){this.subtitleLbl.getStyle().setTextSize(h(12));this.subtitleLbl.getStyle().applyTo(this.subtitleLbl)}}.bind(this));if(aj){d.measureText(this.facebookDescLbl.getText(),9000,9000,this.facebookDescLbl.getStyle().getTextFont(),this.facebookDescLbl.getStyle().getTextSize(),function(al){if(al.totalWidth>n*0.9){var am=this.facebookDescLbl.getFrame();am[1]-=9*L;am[3]*=2;this.facebookDescLbl.setFrame(am)}}.bind(this))}d.measureText(this.startOverBtn.getText(),9000,9000,this.startOverBtn.getStyle().getTextFont(),this.startOverBtn.getStyle().getTextSize(),function(am){var ar=220*L;var an=0;if(am.totalWidth>ar*0.9){an=16*L;ar-=40*L}var av=68*L+an;var aw=o+ac;var ap=40*L+an;var at=aw+av/2-ap/2;var aq=(at-aw);var al=ag+n-aq-ar;var au=ag+aq;var ao=n-ar-aq*2;this.containerGuestOuterLayerView.setFrame([ag,aw-40*L,n,av+40*L]);this.startOverBtn.setFrame([al,at,ar,ap]);this.startOverDescLbl.setFrame([au,aw,ao,av])}.bind(this))}});e.UpgradeUserStart=f}};__ngs._be={_c:null,_d:function(){var b={exports:{}};var e=b.exports;this._c=b;var h=__ngs.r_(__ngs._7).Capabilities;var d=__ngs.r_(__ngs._59).UI;var k=__ngs.r_(__ngs._n).LocalizedString;var g=__ngs.r_(__ngs._5l).UnspammableButton;var c=__ngs.r_(__ngs._q).MobageAnalytics;var a=__ngs.r_(__ngs._6k).MobageStyle;var j=a.ScaledTextSize;var f=d.View.subclass({classname:"RegistrationGuest",initialize:function($super,an,am,y,W,m,L){$super();NgLogD("Mobage/RegistrationGuest/initialize");this.containerMainContainerView=new d.View();this.containerHeaderAreaView=new d.View();this.containerButtonAreaView=new d.View();this.containerButtonAreaBorderView=new d.View();this.headerImg=new d.Image();this.titleLbl=new d.Label();this.backBtn=new d.Button();this.playNowBtn=new d.Button();this.termsLineLbl=new d.Label();this.termsLink1Btn=new d.Button();this.termsAndLbl=new d.Label();this.termsLink2Btn=new d.Button();if(L){this.g2AlertView=new d.View();this.g2AlertImg=new d.Image();this.g2AlertDesc1Lbl=new d.Label();this.g2AlertDesc2Lbl=new d.Label()}this.addChild(this.containerHeaderAreaView);this.addChild(this.containerButtonAreaView);this.addChild(this.containerButtonAreaBorderView);this.addChild(this.headerImg);this.addChild(this.containerMainContainerView);this.addChild(this.titleLbl);if(L){this.addChild(this.g2AlertView);this.addChild(this.g2AlertImg);this.addChild(this.g2AlertDesc1Lbl);this.addChild(this.g2AlertDesc2Lbl)}this.addChild(this.termsLineLbl);this.addChild(this.termsAndLbl);this.addChild(this.backBtn);this.addChild(this.playNowBtn);this.addChild(this.termsLink1Btn);this.addChild(this.termsLink2Btn);var aj=__ngs.r_(__ngs._cj).RegistrationCommon;aj.applyTo(this);var ad=__ngs.r_(__ngs._cj).RegistrationGuest;ad.applyTo(this);this.setFrame([0,0,an[2],an[3]]);var o=an[0];var Z=an[1];var x=an[2];var ah=an[3];var p=o+x;var ac=Z+ah;var I=(o+p)/2;var G=(Z+ac)/2;var Q=(an[2]<an[3]?an[2]:an[3])/480;var ai=400*Q;var K=I-(ai/2);var v=Z+60*Q;var M=58*Q;var n=M;var A=M;var T=v;var X=M;if(h.isPlatformIOS()){A-=1;T-=5*Q;X+=10*Q}var ao=6*Q;if(ao<4){ao=4}var F=v+M+ao;var w=16*Q;var D=w;var J=ai-D*2;var z=K+D;var U=12*Q;var ae;if(L){var N=390*Q;var l=(ai-N)/2;var B=100*Q;var Y=K+l+3*Q;N-=6*Q;var af=F+l;var R=54*Q;var O=Y+8*Q;var al=af+B/2-R/2;var t=O+R+8*Q;var ab=Y+N-t;var ag=22*Q;var s=af+B/2-(ag*4)/2;var V=s+ag;ae=af+B+l+U}else{ae=F+w}var S=10*Q;var H=(J-S)/2;var q=50*Q;var E=z;var P=E+H+S;var aa=ae+q+U;var C=22*Q;var ak=aa+C*2;var r=ak+C+w;var u=r-F;this.containerHeaderAreaView.setFrame([K,v,ai,M]);this.containerButtonAreaView.setFrame([K,F,ai,u]);this.containerButtonAreaBorderView.setFrame([K,v+M,ai,ao]);this.headerImg.setFrame([K,v,n,A]);this.containerMainContainerView.setFrame([K,v,ai,r-v]);this.titleLbl.setFrame([K,T,ai,X]);this.backBtn.setFrame([E,ae,H,q]);this.playNowBtn.setFrame([P,ae,H,q]);this.termsLineLbl.setFrame([z,aa,J,C*2]);if(L){this.g2AlertView.setFrame([Y,af,N,B]);this.g2AlertImg.setFrame([O,al,R,R]);this.g2AlertDesc1Lbl.setFrame([t,s,ab,ag]);this.g2AlertDesc2Lbl.setFrame([t,V,ab,ag*3])}this.titleLbl.setText(k("Play as a Guest"));this.backBtn.setText(k("Back"));this.playNowBtn.setText(k("Play Now"));this.termsLineLbl.setText(k("By tapping 'Play Now', you acknowledge that you are at least 14 years old and agree to our"));this.termsLink1Btn.setText(k("Terms of Service"));this.termsAndLbl.setText(k("and"));this.termsLink2Btn.setText(k("Privacy Policy"));if(L){this.g2AlertDesc1Lbl.setText(k("Mobage Account Detected"));this.g2AlertDesc2Lbl.setText(k("You will not be able to link this game to an existing Mobage account if you proceed as a guest."))}this.playNowBtn.setOnClick(this.bind(function(){y()}));this.backBtn.setOnClick(this.bind(function(){am(true)}));this.termsLink1Btn.setOnClick(this.bind(function(){NgLogD("termsLink1 CLICK");c.reportLoginRegEvent("RegSignUpTermsClick");W()}));this.termsLink2Btn.setOnClick(this.bind(function(){NgLogD("termsLink2 CLICK");c.reportLoginRegEvent("RegSignUpPrivacyClick");m()}));if(L){d.measureText(this.g2AlertDesc2Lbl.getText(),this.g2AlertDesc2Lbl.getFrame()[2],9000,this.g2AlertDesc2Lbl.getStyle().getTextFont(),this.g2AlertDesc2Lbl.getStyle().getTextSize(),function(aq){var ap=aq.lineWidths.length;if(ap>3){var ar=this.playNowBtn.getFrame();ar[1]+=5*Q;this.playNowBtn.setFrame(ar);ar=this.backBtn.getFrame();ar[1]+=5*Q;this.backBtn.setFrame(ar);ar=this.g2AlertView.getFrame();ar[3]+=17*Q;this.g2AlertView.setFrame(ar);ar=this.g2AlertDesc2Lbl.getFrame();ar[3]+=22*Q;this.g2AlertDesc2Lbl.setFrame(ar)}}.bind(this))}d.measureText(this.titleLbl.getText(),9000,9000,this.titleLbl.getStyle().getTextFont(),this.titleLbl.getStyle().getTextSize(),function(ap){if(ap.totalWidth>ai*0.7){this.titleLbl.getStyle().setTextSize(j(16));this.titleLbl.getStyle().applyTo(this.titleLbl)}}.bind(this));d.measureText(this.termsLink1Btn.getText(),9000,9000,this.termsLink1Btn.getStyle().getTextFont(),this.termsLink1Btn.getStyle().getTextSize(),function(ap){d.measureText(this.termsLink2Btn.getText(),9000,9000,this.termsLink2Btn.getStyle().getTextFont(),this.termsLink2Btn.getStyle().getTextSize(),function(aq){d.measureText(" "+this.termsAndLbl.getText()+" ",9000,9000,this.termsAndLbl.getStyle().getTextFont(),this.termsAndLbl.getStyle().getTextSize(),function(aA){var ay=aA.height;var aE=ap.totalWidth;var aC=aA.totalWidth;var aw=aq.totalWidth;var au=aE+aC+aw;var aD=8;ak=aa+ay*2;if(au>ai*0.7){var av=this.termsLineLbl.getFrame();av[1]-=10*Q;this.termsLineLbl.setFrame(av);ak-=10*Q;var aB=(I-aE/2);this.termsLink1Btn.setFrame([aB-aD,ak-aD,aE+aD*2,ay+aD*2]);var az=aC+aw;var at=(I-az/2);var ax=ak+ay;this.termsAndLbl.setFrame([at,ax,aC,ay]);this.termsLink2Btn.setFrame([at+aC-aD,ax-aD,aw+aD*2,ay+aD*2])}else{var ar=I-au/2;this.termsLink1Btn.setFrame([ar-aD,ak-aD,aE+aD*2,ay+aD*2]);this.termsAndLbl.setFrame([ar+aE,ak,aC,ay]);this.termsLink2Btn.setFrame([ar+aE+aC-aD,ak-aD,aw+aD*2,ay+aD*2])}}.bind(this))}.bind(this))}.bind(this))},destroy:function(){this.containerHeaderAreaView.destroy();this.containerButtonAreaView.destroy();this.containerButtonAreaBorderView.destroy();this.headerImg.destroy();this.containerMainContainerView.destroy();this.titleLbl.destroy();this.backBtn.destroy();this.playNowBtn.destroy();this.termsLineLbl.destroy();this.termsLink1Btn.destroy();this.termsAndLbl.destroy();this.termsLink2Btn.destroy();if(this.g2AlertView){this.g2AlertView.destroy();this.g2AlertImg.destroy();this.g2AlertDesc1Lbl.destroy();this.g2AlertDesc2Lbl.destroy()}}});e.RegistrationGuest=f}};__ngs._bf={_c:null,_d:function(){var a={exports:{}};var A=a.exports;this._c=a;var j=__ngs.r_(__ngs._59).UI;var e=j.ViewGeometry.Rect;var d=j.Commands;var p=__ngs.r_(__ngs._23).AbstractView;var x=__ngs.r_(__ngs._26).WindowLayer;var t=__ngs.r_(__ngs._87).ReferenceCounting;var z=__ngs.r_(__ngs._2j).Logger;var v=0;var n;var u=function(B){var C="set"+B.charAt(0).toUpperCase()+B.slice(1);return function(G){this["_"+B]=G;var F;var E=this._children;for(var D=0;D<E.length;D++){if((F=E[D])){F[C](G)}}}};var y=function(B){return function(C){this["_"+B]=C}};var b=function(B){return function(){return this["_"+B]}};function f(E,D){if(!D){return}D._parent=E;if(D instanceof n){var C=D.getChildren();for(var B=0;B<C.length;B++){f(E,C[B])}}else{d.addSubview.call(E,D.__objectRegistryId,-1)}}function g(D){if(!D){return}D._parent=undefined;if(D instanceof p){if(D.__objectRegistryId){d.removeFromSuperview.call(D)}}else{if(D instanceof n){var C=D.getChildren();for(var B=0;B<C.length;B++){g(C[B])}}}}function m(B){return function(D,C){if(D instanceof n){f(this,D)}else{return B.apply(this,Array.prototype.slice.call(arguments))}return this}}function o(B){return function(C){if(this instanceof p||this instanceof x){if(C instanceof n){g(C)}else{B.call(this,C)}}else{if(this instanceof n){if(C._layoutGroupParent==this){C._setVisible(false);var D=this._children.indexOf(C);if(D!=-1){this._children.splice(D,1)}}C._layoutGroupParent=null;g(C)}}}}function k(){return this._layoutGroup_virtualFrame?this._layoutGroup_virtualFrame.array():[0,0,0,0]}function h(C){var E=new e(C instanceof Object?C:Array.prototype.slice.call(arguments));var B=this._layoutGroupParent._adjustToGlobalCoords(new e(E));if(B&&!B.isEmpty()){this.constructor.prototype.setFrame.call(this,B);this._layoutGroup_virtualFrame=E}else{var D=("LayoutGroup-childNode: Invalid rect for childNode hooked setFrame. "+JSON.stringify(B)+" frame: "+E);(this.loge||NgLogE)(D)}}function c(){return this._layoutGroupParent||this._parent}var q=j.View.prototype.addChild;var s=x.prototype.addChild;j.View.prototype.addChild=m(q);x.prototype.addChild=m(s);var r=j.View.prototype.removeChild;var w=x.prototype.removeChild;j.View.prototype.removeChild=o(r);x.prototype.removeChild=o(w);var l=o(null);n=A.LayoutGroup=t.subclass({type:"LayoutGroup",classname:"LayoutGroup",_layoutUID:null,_children:null,initialize:function($super,B){this._layoutUID="layout"+(++v);$super(B);this._children=[];return this},destroy:function(){var C=this.getChildren();var B;for(B=C.length-1;B>=0;--B){this.removeChild(C[B])}},getParent:function(){return this._layoutGroupParent||this._parent},getChildren:function(){return this._children},getChildCount:function(){return this._children.length},addChild:function(C,B){if(C instanceof p||C instanceof n){if(C._parent){C.removeFromParent()}if(C instanceof p){this._hookForChild(C)}if(B===0||B>0){B=+B;this._children.splice(B,0,C)}else{B=-1;this._children.push(C)}C._layoutGroupParent=this;C._setVisible(this._visible);if(this._parent&&C instanceof n){f(this._parent,C)}else{if(C._parent&&C instanceof p){d.addSubview.call(C._parent,C.__objectRegistryId,B)}}}else{throw {message:this.type+".addChild: "+C+" is not a view or LayoutGroup!"}}if(C._frame){C.setFrame(C._frame)}},removeChild:function(B){l.call(this,B);this._unhookForChild(B)},removeFromParent:function(){if(this._parent&&!this._parent._destroyed){this._parent.removeChild(this)}return this},setGradient:function(C,B){B=+(B||0);if(!this._gradient){this._gradient=[]}this._gradient[B]=C},setFrame:function($super,H){var I=Array.prototype.slice.call(arguments);I.shift();if(this.sizeChanged){var F=this._frame?this._frame[2]:0;var J=this._frame?this._frame[3]:0}if(H instanceof e){this._frame=H.array()}else{if(H instanceof Array){this._frame=H}else{this._frame=I}}var G,E;var B;var C=this.getChildren();for(var D=0;D<C.length;D++){if((B=C[D])){E=B.getFrame();G=new e(E);if(!G.isEmpty()){B.setFrame(G)}}}if(this.sizeChanged&&((F^this._frame[2])|(J^this._frame[3]))){this.sizeChanged(this._frame[2],this._frame[3],F,J)}},getFrame:b("frame"),setVisible:function(B){this._assignedVisible=B;this._setVisible(B)},getVisible:b("visible"),_setVisible:function(E){var D=this._visible;this._visible=E;if(this._visible!=D){var B=this._children.length;for(var C=0;C<B;C++){this._children[C]._setVisible(E)}}},setVisibleInOrientations:function(B){this._assignedOrientationFlags=B;this._setVisibleInOrientations(B)},getVisibleInOrientations:function(){return this._assignedOrientationFlags},_setVisibleInOrientations:function(C){var B=this._children.length;for(var D=0;D<B;D++){if(this._children[D].setVisibleInOrientations){this._children[D].setVisibleInOrientations(C)}}},_hookForChild:function(B){B._layoutGroupParent=this;B.getFrame=k;B.setFrame=h;B.getParent=c},_unhookForChild:function(B){delete B.getParent;delete B.getFrame;delete B.setFrame;delete B._layoutGroupParent},_adjustToGlobalCoords:function(B){if(!this._frame){return B}if(B instanceof e){B.x+=this._frame[0];B.y+=this._frame[1]}else{if(B instanceof Array){B[0]+=this._frame[0];B[1]+=this._frame[1]}else{B=[0,0,0,0]}}if(this._layoutGroupParent instanceof n){this._layoutGroupParent._adjustToGlobalCoords(B)}return B},setState:u("state"),getState:b("state"),setEnabled:u("enabled"),getEnabled:b("enabled"),setTouchable:u("touchable"),getTouchable:b("touchable"),setAlpha:u("alpha"),getAlpha:b("alpha"),setAttributes:y("attributes"),getAttributes:b("attributes"),setStyle:y("style"),getStyle:b("style"),setImage:y("image"),getImage:b("image"),setImageFit:y("imageFit"),getImageFit:b("imageFit"),setImageBorder:y("imageBorder"),getImageBorder:b("imageBorder"),setImageGravity:y("imageGravity"),getImageGravity:b("imageGravity")})}};__ngs._bg={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c={};c.Style=__ngs.r_(__ngs._60).Style;c.Style.sheet("RedBackground",{gradient:{gradient:["FFFF0000 0.0","FFFF0000 1.0"]}});c.Style.sheet("GreenBackground",{gradient:{gradient:["FF00FF00 0.0","FF00FF00 1.0"]}});c.Style.sheet("BlueBackground",{gradient:{gradient:["FF0000FF 0.0","FF0000FF 1.0"]}});c.Style.sheet("YellowBackground",{gradient:{gradient:["FFFFFF00 0.0","FFFFFF00 1.0"]}});c.Style.sheet("BlackBackground",{gradient:{gradient:["FF000000 0.0","FF000000 1.0"]}});c.Style.sheet("WhiteBackground",{gradient:{gradient:["FFFFFFFF 0.0","FFFFFFFF 1.0"]}})}};__ngs._bh={_c:null,_d:function(){var c={exports:{}};var a=c.exports;this._c=c;var e={};e.Style=__ngs.r_(__ngs._60).Style;var d=e.Style.ScaledTextSize;var b=__ngs.r_(__ngs._2z).Assets;e.Style.sheet("social.us.gamedownload",{playButton:{normalGradient:{corners:"8.0 8.0 8.0 8.0",gradient:["FF5AB0E2 0.000","FF2B76BC 1.000"]},highlightedGradient:{corners:"8.0 8.0 8.0 8.0",gradient:["FF3682C3 0.000","FF1C61A8 1.000"]},textColor:"FFFFFFFF",textSize:d(14),textFont:e.Style.defaultBoldFontFace,textShadow:"33000000 1.0 {0.0,-2.0}",textGravity:[0.5,0.5]},backToMarketButton:{normalGradient:{corners:"8.0 8.0 8.0 8.0",gradient:["FF90B100 0.000","FF6C9100 1.000"]},highlightedGradient:{corners:"8.0 8.0 8.0 8.0",gradient:["FF5B971B 0.000","FF397210 1.000"]},textColor:"FFFFFFFF",textSize:d(11),textFont:e.Style.defaultBoldFontFace,textShadow:"33000000 1.0 {0.0,-2.0}",textGravity:[0.5,0.5]},downloadPlayXRatio:0,downloadPlayYRatio:0,downloadPlayWidthRatio:1,downloadPlayHeightRatio:1});e.Style.sheet("social.us.globalgamedownloadicon",{progressBar:{gradient:{corners:"8.0 8.0 8.0 8.0",gradient:["FF242424 0.0","FF1F1F1F 1.0"]},progressGradient:{corners:"8.0 8.0 8.0 8.0",gradient:["FF75B624 0.0","FF4D8D1F 1.0"]}},clickableBackgroundPressedGradient:{corners:"8.0 8.0 8.0 8.0",gradient:["3FFF 0.0","0FFF 1.0"],innerLine:"6FFF 2.0"},label:{textColor:"FFFFFFFF",textSize:d(11),textFont:e.Style.defaultBoldFontFace,textGravity:[0.5,0]},insetFromBottomRatio:0.15,labelHeightRatio:0.55,progressBarHeightRatio:0.25})}};__ngs._bi={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._5).Core;a.Item=c.Class.subclass({classname:"DataTypeBankItem",initialize:function(d){this._def={id:"string",price:"integer",description:"string",imageUrl:"url",name:"name"};this._data=d},isValid:function(){var d=this._data;if(!this._data){this._err="Item must be an object ";return false}var e=d.id;if(!e){this._err='the "id" field is invalid id. id is required filed ';NgLogD("Item is invalid");return false}if(typeof(e)!=="string"){this._err='The "id" field is invalid. id should be string';NgLogD("Item is invalid");return false}return true},getItemId:function(){NgLogD("item:"+this._data.id);return this._data.id},getErr:function(){return this._err}})}};__ngs._bj={_c:null,_d:function(){var c={exports:{}};var a=c.exports;this._c=c;var d=__ngs.r_(__ngs._5).Core;var b=__ngs.r_(__ngs._bi).Item;a.BillingItem=d.Class.subclass({initialize:function(e){this._data=e},isValid:function(){var f=this._data;if(!this._data){this._err=" BillingItem must be an object) ";return false}var e=new b(f.item);if(!(e&&e.isValid())){this._err='The Field "item" is invalid ( '+e.getErr()+")";return false}var g=this._data.quantity;if(g!==null&&g<0){this._err='The field "quantity" is invalid. quantity should be an integer';return false}return true},getItemId:function(){if(!this.isValid()){return null}var e=new b(this._data.item);var f=e.getItemId();return f},getQuantity:function(){return this._data.quantity},getErr:function(){return this._err}})}};__ngs._bk={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._5).Core;a.Transaction=c.MessageListener.subclass({classname:"DataTypeBankTransaction",initialize:function(d){this._def={id:"string",price:"integer",descript:"string",imageUrl:"url",name:"name"};this._data=d;this._definedState={authorized:true,open:true,closed:true}},isValid:function(){if(!this._data){return false}var e=this._data.id;if(!(e&&typeof(e)==="string")){return false}var d=this._state;if(!(d&&typeof(d)==="string"&&this._definedState[d])){return false}return true}})}};__ngs._bl={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var d=__ngs.r_(__ngs._5).Core;var a=__ngs.r_(__ngs._bm).Integer;b.InAppItem=d.Class.subclass({classname:"DataTypeBankInAppItem",initialize:function(e){this._def={productId:"string",quantity:"integer"};this._data=e},isValid:function(){var f=this._data;if(!this._data){this._err="Item must be an object ";return false}var e=f.productId;if(!e){this._err='the "productId" field is invalid . productId is required field ';return false}if(typeof(e)!=="string"){this._err='The "productId" field is invalid. productId should be string';return false}var g=new a(this._data.quantity);if(!g||!g.isValid()){this._err="The Filed Quantity is invalid ( "+g.getErr()+" ) ";return false}return true},getItemId:function(){NgLogD("item:"+this._data.id);return this._data.id},getErr:function(){return this._err}})}};__ngs._bm={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._5).Core;a.Integer=c.Class.subclass({classname:"DataTypeBasicInteger",initialize:function(d){this._data=d},isValid:function(){var e=this._data;var d=this._data;if(d===null||d===undefined){this._err="Value is not defined";return false}if(typeof(d)!=="number"||parseInt(d,10)!==d||d<0){this._err="Value is not an integer";return false}return true},getErr:function(){return this._err}})}};__ngs._bn={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._97).Dispatcher;var d={getObjectPublicInterface:function(f,g,h){if(f[h]){return f[h]}var e=Array.apply(null,arguments);if(e&&e.length>3){e.splice(0,3)}else{e=[]}var j={forAll:function(l,k){a.callMethodOnRemoteObject(f,[g,"forAll"],[e,[l,k]])},forRange:function(n,m,l,k){a.callMethodOnRemoteObject(f,[g,"forRange"],[e,[n,m,l,k]])},forItem:function(l,m,k){a.callMethodOnRemoteObject(f,[g,"forItem"],[e,[l,m,k]])}};f[h]=j;return j},getClassPublicInterface:function(e,f,g){if(e[g]){return e[g]}var h={forAll:function(k,j){a.callClassMethodOnRemoteObject(e,[f,"forAll"],[[],[k,j]])},forRange:function(m,l,k,j){a.callClassMethodOnRemoteObject(e,[f,"forRange"],[[],[m,l,k,j]])},forItem:function(k,l,j){a.callClassMethodOnRemoteObject(e,[f,"forItem"],[[],[k,l,j]])}};e[g]=h;return h}};b.OrderedList=d}};__ngs._bo={_c:null,_d:function(){var b={exports:{}};var g=b.exports;this._c=b;var e=__ngs.r_(__ngs._59).UI;var a=e.ViewGeometry.Rect;var c=__ngs.r_(__ngs._2j).Logger;var k=g.Layouts={};var m=g.AddOrders={};var h=function(p){var o=Array.prototype.slice.call(arguments);return{addSubviews:function(){for(var q=0;q<o.length;q++){try{this.addChild(this[o[q]])}catch(r){this.loge("Failed Initializing subview '"+o[q]+"' of '"+this.classname+"'");throw r}}}}};m.One=h("content");m.TwoSuperimposed=h("background","content");m.TwoHorizontal=h("content","accessory");m.TwoVerticalContentSubtitle=h("content","subtitle");m.TwoVerticalTitleContent=h("title","content");m.ThreeHorizontal=h("content","leftAccessory","rightAccessory");m.Generator=h;var f=k.SuperimposedGenerator=function(p){var q=Array.prototype.slice.call(arguments);var s=[];var r=function(t){return function(u){if(this[t]){var v=u.copy();if(this._insets[t]){v.inset.apply(v,this._insets[t])}this[t].setFrame(v)}}};for(var o=0;o<q.length;o++){s.push(r(q[o]))}return{layoutSubviews:function($super){if($super&&typeof $super==="function"){$super()}var u=new a(this.getFrame());if(u.isEmpty()){this.logd(this.classname+": abort layoutSubviews, no-frame.");return}u.x=u.y=0;for(var t=0;t<s.length;t++){s[t].apply(this,[u])}}}};var d=k.TwoHorizontalGenerator=function(p,o){return{layoutSubviews:function($super){if($super&&typeof $super==="function"){$super()}var s=new a(this.getFrame());if(s.isEmpty()){NgLogD(this.classname+": abort layoutSubviews, no-frame.");return}s.x=s.y=0;var r=p;if("content"===p){r=o}var q=0;if(this[r]&&this[r].getFrame()){q=this[r].getFrame()[2]}var u=this._insets[r][1]+this._insets[r][3]+q;if(q===0){this[r].setVisible(false);u=0}else{if(!this[r].getVisible()){this[r].setVisible(true)}}if("content"===p){u=-u}var t=s.sliceHorizontal(u);if(this[r]){t.inset.apply(t,this._insets[r]);this[r].setFrame(t)}if(this.content){s.inset.apply(s,this._insets.content);this.content.setFrame(s)}}}};var n=k.TwoVerticalGenerator=function(p,o){return{layoutSubviews:function($super){if($super&&typeof $super==="function"){$super()}var s=new a(this.getFrame());if(s.isEmpty()){return}s.x=s.y=0;var r=p;if("content"===p){r=o}var t=0;if(this[r]&&this[r].getFrame()){t=this[r].getFrame()[3]}var q=this._insets[r][0]+this._insets[r][2]+t;if("content"===p){q=-q}var u=s.sliceVertical(q);if(this[r]){u.inset.apply(u,this._insets[r]);this[r].setFrame(u)}if(this.content){s.inset.apply(s,this._insets.content);this.content.setFrame(s)}}}};var l=k.ThreeVerticalGenerator=function(s,t,r){var o=function(w,y){var x=0;if(this[s]&&this[s].getFrame()){x=this[s].getFrame()[3]}var v=this._insets[s][0]+this._insets[s][2]+x;if(x===0&&!y){this[s].setVisible(false);v=0}else{if(!this[s].getVisible()){this[s].setVisible(true)}}if(y){v=0}if(this[s]){var u=w;if(!y){u=w.sliceVertical(v)}u.inset.apply(u,this._insets[s]);this[s].setFrame(u)}};var p=function(w,y){var v=0;if(this[r]&&this[r].getFrame()){v=this[r].getFrame()[3]}var u=this._insets[r][0]+this._insets[r][2]+v;if(v===0&&!y){this[r].setVisible(false);u=0}else{if(!this[r].getVisible()){this[r].setVisible(true)}}if(y){u=0}if(this[r]){var x=w;if(!y){x=w.sliceVertical(-u)}x.inset.apply(x,this._insets[r]);this[r].setFrame(x)}};var q=function(w,y){var v=0;if(this[t]&&this[t].getFrame()){v=this[t].getFrame()[3]}var u=this._insets[t][0]+this._insets[t][2]+v;if(v===0&&!y){this[t].setVisible(false);u=0}else{if(!this[t].getVisible()){this[t].setVisible(true)}}if(y){u=0}if(s==="content"){u=0-u}if(this[t]){var x=w;if(!y){x=w.sliceVertical(u)}x.inset.apply(x,this._insets[t]);this[t].setFrame(x)}};return{layoutSubviews:function($super){if($super&&typeof $super==="function"){$super()}var v=new a(this.getFrame());if(v.isEmpty()){NgLogD(this.classname+": abort layoutSubviews, no-frame.");return}v.x=v.y=0;var u;if(s!=="content"){o.apply(this,[v,false])}else{u=o}if(r!=="content"){p.apply(this,[v,false])}else{u=p}if(t!=="content"){q.apply(this,[v,false])}else{u=q}u.apply(this,[v,true])}}};var j=k.ThreeHorizontalGenerator=function(t,s,o){var q=function(v,y){var u=0;if(this[t]&&this[t].getFrame()){u=this[t].getFrame()[2]}var x=this._insets[t][1]+this._insets[t][3]+u;if(u===0&&!y){this[t].setVisible(false);x=0}else{if(!this[t].getVisible()){this[t].setVisible(true)}}if(y){x=0}if(this[t]){var w=v;if(!y){w=v.sliceHorizontal(x)}w.inset.apply(w,this._insets[t]);this[t].setFrame(w)}};var r=function(w,y){var u=0;if(this[o]&&this[o].getFrame()){u=this[o].getFrame()[2]}var x=this._insets[o][1]+this._insets[o][3]+u;if(u===0&&!y){this[o].setVisible(false);x=0}else{if(!this[o].getVisible()){this[o].setVisible(true)}}if(y){x=0}if(this[o]){var v=w;if(!y){v=w.sliceHorizontal(-x)}v.inset.apply(v,this._insets[o]);this[o].setFrame(v)}};var p=function(u,y){var x=0;if(this[s]&&this[s].getFrame()){x=this[s].getFrame()[2]}var w=this._insets[s][1]+this._insets[s][3]+x;if(x===0&&!y){this[s].setVisible(false);w=0}else{if(!this[s].getVisible()){this[s].setVisible(true)}}if(y){w=0}if(t==="content"){w=0-w}if(this[s]){var v=u;if(!y){v=u.sliceHorizontal(w)}v.inset.apply(v,this._insets[s]);this[s].setFrame(v)}};return{layoutSubviews:function($super){if($super&&typeof $super==="function"){$super()}var v=new a(this.getFrame());if(v.isEmpty()){NgLogD(this.classname+": abort layoutSubviews, no-frame.");return}v.x=v.y=0;var u;if(t!=="content"){q.apply(this,[v,false])}else{u=q}if(o!=="content"){r.apply(this,[v,false])}else{u=r}if(s!=="content"){p.apply(this,[v,false])}else{u=p}u.apply(this,[v,true])}}};k.One=function($super){this.logd("Layouts.One");if($super&&typeof $super==="function"){$super()}var o=new a(this.getFrame());if(o.isEmpty()){NgLogD(this.classname+": abort layoutSubviews, no-frame.");return}o.x=o.y=0;if(this.content){o.inset.apply(o,this._insets.content);this.content.setFrame(o)}};k.TwoSuperimposed=f("background","content");k.TwoHorizontal=d("content","accessory");k.TwoHorizontal_AccessoryLeft=d("accessory","content");k.TwoVerticalContentSubtitle=n("content","subtitle");k.TwoVerticalTitleContent=n("title","content");k.ThreeHorizontal=j("leftAccessory","content","rightAccessory");(function(){var o;for(o in k){if(k.hasOwnProperty(o)&&typeof k[o]==="function"&&o.indexOf("Generator")===-1){k[o]={layoutSubviews:k[o]}}}}())}};__ngs._bp={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var a=new (__ngs.r_(__ngs._f).RequireLoader)({ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},Destinations:function(){return __ngs.r_(__ngs._2a).Destinations},VHUserInfoCell:function(){return __ngs.r_(__ngs._ck).VHUserInfoCell},VarHeightListItem:function(){return __ngs.r_(__ngs._cl).VarHeightListItem},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics}});var c=b.VHUserInfoListItem=a.VarHeightListItem.subclass({classname:"VHUserInfoListItem",_reuseId:"VariableHeight.UserInfoListItem",_cellClass:a.VHUserInfoCell,initialize:function($super,e){$super();this.setUser(e)},setUser:function(e){this._initChangeableData({user:e,metrics:{},onCellClick:function(){a.MobageAnalytics.reportEvent("VHUserInfoCellClick",{userRecordID:e.recordID,userGamertag:e.gamertag});a.Destinations.pushScreen(a.ServiceHost.navController,"UserProfilePage",{user:e})}})}})}};__ngs._bq={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=new (__ngs.r_(__ngs._f).RequireLoader)({VHMobageHeaderCell:function(){return __ngs.r_(__ngs._cm).VHMobageHeaderCell},VarHeightListItem:function(){return __ngs.r_(__ngs._cl).VarHeightListItem}});var d=b.VHMobageHeaderListItem=a.VarHeightListItem.subclass({classname:"VHMobageHeaderListItem",_reuseId:"VariableHeight.MobageHeaderListItem",_cellClass:a.VHMobageHeaderCell})}};__ngs._br={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var c=new (__ngs.r_(__ngs._f).RequireLoader)({UI:function(){return __ngs.r_(__ngs._59).UI},Core:function(){return __ngs.r_(__ngs._5).Core},Game:function(){return __ngs.r_(__ngs._2e).Game},VHGameModuleCell:function(){return __ngs.r_(__ngs._cn).VHGameModuleCell},VarHeightListItem:function(){return __ngs.r_(__ngs._cl).VarHeightListItem},MobageStyle:function(){return __ngs.r_(__ngs._6k).MobageStyle},GameModuleCellStyle:function(){return __ngs.r_(__ngs._65).GameModuleCell},GameModuleBasicPanelStyle:function(){return __ngs.r_(__ngs._65).GameModuleBasicPanel},GameModuleDynamicImagePanelStyle:function(){return __ngs.r_(__ngs._65).GameModuleDynamicImagePanel},GameModuleHeaderStyle:function(){return __ngs.r_(__ngs._65).GameModuleHeader},GameModuleContentStyle:function(){return __ngs.r_(__ngs._65).GameModuleContent},GameModuleIconStyle:function(){return __ngs.r_(__ngs._65).GameModuleIcon},GameModuleButtonStyle:function(){return __ngs.r_(__ngs._65).GameModuleButton},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics}});var g=-1;var f=3;var a=d.VHGameModuleListItem=c.VarHeightListItem.subclass({classname:"VHGameModuleListItem",_reuseId:"VariableHeight.GameModuleListItem",_cellClass:c.VHGameModuleCell,initialize:function($super){$super();this._styler=new b();this._game=null;this._reapplyStyles=null;this._initChangeableData({show:false,game:this._game,metrics:{},styler:this._styler});this._setCustomStyles(null)},loadData:function(h){if(!this._game){c.Game.getCurrentGame(function(k,j){if(!k){this._data.game=this._game=j}h()}.bind(this))}else{h()}},set:function(k,o){if(k===null){this._initChangeableData({show:false,game:this._game,metrics:{},styler:this._styler});c.MobageAnalytics.reportEvent("GamercardSetConfiguration",null)}else{var j=this._data.type;var h=function(q,p,s){for(var t in s){if(p.hasOwnProperty(s[t])){switch(s[t]){case"text":if(p.text&&g>0){q.text=p.text.substr(0,g)}else{q.text=p.text}q.lineLimit=(f>0?f:null);break;case"width":q.width=p.width;break;case"height":q.height=p.height;break;case"basic":h(q.basic={},p.basic,["text","icon"]);break;case"image":h(q.image={},p.image,["url","placeholder"]);break;case"placeholder":h(q.placeholder={},p.placeholder,["width","height"]);break;case"bgColor":if(p.bgColor&&p.bgColor.length>=2){q.bgColorBottom=p.bgColor[0];q.bgColorTop=p.bgColor[1]}else{q.bgColorBottom=q.bgColorTop=null}break;case"buttonColor":if(p.buttonColor&&p.buttonColor.length>=2){q.buttonColorBottom=p.buttonColor[0];q.buttonColorTop=p.buttonColor[1]}else{q.buttonColorBottom=q.buttonColorTop=null}break;case"buttonColorPressed":if(p.buttonColorPressed&&p.buttonColorPressed.length>=2){q.buttonColorBottomPressed=p.buttonColorPressed[0];q.buttonColorTopPressed=p.buttonColorPressed[1]}else{q.buttonColorBottomPressed=q.buttonColorTopPressed=null}break;case"buttons":if(p.buttons&&p.buttons.length){q.buttons=[];for(var r=0;r<p.buttons.length;r++){h(q.buttons[r]={},p.buttons[r],["label","id"])}q.numButtonsDefined=q.buttons.length}else{q.buttons=null;q.numButtonsDefined=0}break;default:q[s[t]]=p[s[t]];break;break}}}};var l=["basic","image","buttons"];if(k.__allowGameModuleStyling){l=l.concat(["bgColor","buttonColor","buttonColorPressed","cellStyle","panelStyle","buttonStyle","headerStyle","contentStyle","iconStyle"])}var m={actionCB:typeof o=="function"?o:function(){},game:this._game,show:true,metrics:{},basic:null,image:null,buttons:null,styler:this._styler};h(m,k,l);m.type=m.basic?"basic":m.image?"image":null;if(m.type!=j){this._styler.removeStyle("panel")}this._setCustomStyles(m);this._reapplyStyles=true;this._initChangeableData(m);var n={type:m.type,button_0_id:m.buttons?m.buttons[0].id:null,button_0_label:m.buttons?m.buttons[0].label:null,button_1_id:m.buttons?m.buttons[1].id:null,button_1_label:m.buttons?m.buttons[1].label:null};if(m.type=="basic"){n.icon=m.basic.icon;n.msg=m.basic.text}else{if(m.type=="image"){n.msg=m.image.url;n.placeholder_width=m.image.placeholder?m.image.placeholder.width:null;n.placeholder_height=m.image.placeholder?m.image.placeholder.height:null}}c.MobageAnalytics.reportEvent("GamercardSetConfiguration",n)}},_setCustomStyles:function(h){h=h||{};this._styler.reset();if(h.type=="basic"){this._styler.setStyle("panel",h.panelStyle,c.GameModuleBasicPanelStyle);this._styler.setStyle("header",h.headerStyle,c.GameModuleHeaderStyle);this._styler.setStyle("content",h.contentStyle,c.GameModuleContentStyle);this._styler.setStyle("icon",h.iconStyle,c.GameModuleIconStyle);this._styler.setGradient("panel",h.bgColorTop,h.bgColorBottom)}else{if(h.type=="image"){this._styler.setStyle("panel",h.panelStyle,c.GameModuleDynamicImagePanelStyle)}}this._styler.setStyle("cell",h.cellStyle,c.GameModuleCellStyle);this._styler.setStyle("button",h.buttonStyle,c.GameModuleButtonStyle);this._styler.setGradient("button",h.buttonColorTop,h.buttonColorBottom,c.UI.State.Normal);this._styler.setGradient("button",h.buttonColorTopPressed,h.buttonColorBottomPressed,c.UI.State.Pressed)},update:function($super,j,h){if(this._reapplyStyles&&this._cell){this._reapplyStyles=false;this._styler.applyStyle("cell",[this._cell]);this._styler.applyStyle("panel",[this._cell._panel]);this._styler.applyStyle("header",[this._cell._header]);this._styler.applyStyle("content",[this._cell._content]);this._styler.applyStyle("icon",[this._cell._icon]);this._styler.applyStyle("button",this._cell._buttons);this._styler.applyGradient("panel",[this._cell._panel]);this._styler.applyGradient("button",this._cell._buttons,c.UI.State.Normal);this._styler.applyGradient("button",this._cell._buttons,c.UI.State.Pressed);this._cell._styleWasApplied=true}$super(j,h)},_onSetView:function($super,h){if(h!=this._cell){if(!h._styleWasApplied){this._reapplyStyles=true}$super(h)}}});var b=c.Core.Class.subclass({_styles:{},_gradients:{},initialize:function(){this.reset()},reset:function(){this._styles={};this._gradients={}},applyGradient:function(h,n,m){m=m||c.UI.State.Normal;var l=this._gradients;var k=this.getStyle(h);var o={};if(n&&l[h]&&l[h][m]){o=l[h][m]}else{if(k){o=k.getGradient(m)}}for(var j=n.length-1;j>=0;j--){n[j].setGradient(o,m)}},setGradient:function(k,j,h,m){m=m||c.UI.State.Normal;if(j&&h){var l=this.getStyle(k);var n=l?JSON.parse(JSON.stringify(l.getGradient(m))):{};if(j&&h){n.gradient=[j+" 0.0",h+" 1.0"]}if(!this._gradients[k]){this._gradients[k]={}}this._gradients[k][m]=n}else{if(this._gradients[k]){this._gradients[k][m]=null}}},applyStyle:function(h,l){var k=this._styles;if(l&&k[h]){for(var j=l.length-1;j>=0;j--){k[h].mobageStyle.applyTo(l[j])}}},removeStyle:function(h){var j=this._styles;if(j.hasOwnProperty("identifier")){delete j[h]}},setStyle:function(j,k,l,n){var m=this._styles;if(!n&&m[j]&&m[j].propertiesStr==JSON.stringify(k)){return}if(k){var h=JSON.stringify(k);m[j]={propertiesStr:h,mobageStyle:new c.MobageStyle({style:JSON.parse(h)})}}else{m[j]={propertiesStr:"null",mobageStyle:l}}},getStyle:function(h){var j=this._styles;if(j[h]){return j[h].mobageStyle}else{return null}}})}};__ngs._bs={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var a=new (__ngs.r_(__ngs._f).RequireLoader)({UI:function(){return __ngs.r_(__ngs._59).UI},LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},ListViewSectionController:function(){return __ngs.r_(__ngs._ce).ListViewSectionController}});var c=b.VHListViewSectionController=a.ListViewSectionController.subclass({classname:"VHListViewSectionController",initialize:function($super,f,e){$super();this._items=f;this._isLoadingData=null;this._showPending=true;if(typeof e=="boolean"){this._showPending=e}},loadSection:function(){if(!this._section){var e=new a.UI.ListViewSection({items:this._items,rowHeight:-1});this.setSection(e);this.loadData(this._showPending)}},loadData:function(e){if(this._isLoadingData){return}this._isLoadingData=true;if(e){this.showPendingMessage(a.LocText("Loading..."))}var f=this._items;var k=f.length;var j=0;var g=function(){j++;if(j>=k){this._isLoadingData=false;if(e){this.hidePendingMessage()}this.setItems(f)}}.bind(this);if(f.length>0){for(var h=0;h<f.length;h++){if(f[h].loadData){f[h].loadData(this.zombieSafeCallback(g.bind(this)))}else{g.bind(this)()}}}else{g.bind(this)()}},layoutSubviews:function(e){e=e||function(){};var f=this.items();var k=f.length;var j=0;var g=function(){j++;if(j>=k){this.reloadList();e()}};if(k===0){g.bind(this)()}else{if(this.section()._listView){var l=this.section()._listView.getFrame()[2];for(var h=0;h<f.length;h++){if(f[h].update){f[h].update(l,this.zombieSafeCallback(g.bind(this)))}else{g.bind(this)()}}}else{k=0;g.bind(this)()}}}})}};__ngs._bt={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=new (__ngs.r_(__ngs._f).RequireLoader)({UI:function(){return __ngs.r_(__ngs._59).UI},LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},Wall:function(){return __ngs.r_(__ngs._ch).Wall},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},StringUtils:function(){return __ngs.r_(__ngs._c0).StringUtils},Game:function(){return __ngs.r_(__ngs._2e).Game},Session:function(){return __ngs.r_(__ngs._o).Session},Extras:function(){return __ngs.r_(__ngs._65).WallCell.extras},AlertDialog:function(){return __ngs.r_(__ngs._i).AlertDialog},AddFriendManager:function(){return __ngs.r_(__ngs._aq).AddFriendManager},WallSectionFooterItem:function(){return __ngs.r_(__ngs._co).WallSectionFooterItem},WallSectionHeaderItem:function(){return __ngs.r_(__ngs._co).WallSectionHeaderItem},VHWallListItem:function(){return __ngs.r_(__ngs._cp).VHWallListItem},VHListViewSectionController:function(){return __ngs.r_(__ngs._bs).VHListViewSectionController}});var f=true;var g=10;var e=100;var a=c.GamercardWallListViewSectionController=b.VHListViewSectionController.subclass({classname:"GamercardWallListViewSectionController",initialize:function($super,j,h){$super(null,h);this._user=null;this._game=null;this._maxMessageCount=0;this._addFriendManager=null;this._isCurrentUser=false;this._header=null;this._addFriendManager=(new b.AddFriendManager(this)).retain();this.setUser(j)},setUser:function(h){this._user=h;this._isCurrentUser=b.Session.getCurrentSession().user().is(this._user);if(this._headerRow){this._headerRow.setUser(h)}this._maxMessageCount=g},reset:function(){var h=this.items();if(h.length>g){this._maxMessageCount=g;h.splice(-(h.length-g));this._showFooter=true;this.setItems(h);this.layoutSubviews()}},_loadMoreWall:function(h){this._maxMessageCount=Math.min(this._maxMessageCount+g,e);this.loadData(h)},loadData:function(j){if(!this._user){return}if(this._isLoadingData){return}this._isLoadingData=true;var m=this._maxMessageCount;var h=0;var n=false;var k=this.items();if(j){this.showPendingMessage(b.LocText("Loading..."));this._showHeader=false;this._showFooter=false;this.setItems([])}var l=function(){b.Wall.list(this._user.recordID,m+1,this.zombieSafeCallback(function(q,o){this._isLoadingData=false;if(j){this.hidePendingMessage()}if(q){b.UIUtils.showToast(b.LocText("Failed to load wall items."))}else{var r;if(o.length===0){if(k.length>0){k[0].setData(this._createPlaceholderRecord(),this._game,true)}else{k.push(new b.VHWallListItem(this,this._user,this._createPlaceholderRecord(),true,this._game))}if(k.length>1){k.splice(-(k.length-1))}}else{for(var p=0;p<o.length;p++){if(p===m){n=true}else{n=false;r=o[p];if(p<k.length&&k[p]){k[p].setData(r,this._game,false)}else{k.push(new b.VHWallListItem(this,this._user,r,false,this._game))}}}if(o.length<k.length){k.splice(-(k.length-o.length))}}h=k.length;this._showFooter=n&&this._maxMessageCount<e;this._showHeader=true;this.setItems(k);this.layoutSubviews()}}.bind(this)),b.Session.getCurrentSession().appKey())}.bind(this);if(this._game){l()}else{b.Game.getCurrentGame(this.zombieSafeCallback(function(p,o){if(!p){this._game=o}l()}.bind(this)))}},_createPlaceholderRecord:function(){return{message:b.LocText("Your post will appear here and on their Mobage profile."),user:this._user,author_gamertag:this._user.gamertag,date:(new Date()).toISOString()}},_createAndInsertPost:function(l,k){var j=l.posts[0];var h=this.items();j.conversationID=l.id;j.author_gamertag=k.gamertag;j.user=k;j.total=l.total;if(h[0].isPlaceholder()){h[0].setData(j,this._game,false)}else{h.unshift(new b.VHWallListItem(this,this._user,j,false,this._game));this.setItems(h)}this.layoutSubviews()},_removePost:function(k){var h=this.items();var j=h.indexOf(k);if(j>=0){if(h.length>1){h.splice(j,1);this.setItems(h)}else{if(this._showFooter){this.loadData()}else{h[0].setData(this._createPlaceholderRecord(),this._game,true);this.layoutSubviews()}}}},getCurUser:function(){return this._user},getButtonAddUser:function(){return null},_showFriendsOnlyModal:function(){var h=new b.AlertDialog();h.setTitle(b.LocText("Available for Friends"));switch(this._user.localRelation){case"follower":h.setText(b.LocText("To post a comment, accept %1s's Friend request first!",this._user.gamertag));h.setChoices([b.LocText("Accept"),b.LocText("Not Now")]);break;case"requested":h.setText(b.LocText("%1s needs to accept your Friend request first!",this._user.gamertag));h.setChoices([b.LocText("OK")]);break;default:h.setText(b.LocText("To post a comment, send %1s a Friend request first!",this._user.gamertag));h.setChoices([b.LocText("Send"),b.LocText("Not Now")]);break}h.show();h.onchoice=function(j){if(j.choice===0&&this._user.localRelation!="requested"){this._addFriendManager.getAddFriendButtonCallback()()}h.hide()}.bind(this)},_checkCanPostOnWall:function(){if(!this._isCurrentUser&&this._user.allowFriendPostsOnly&&!this._user.isMutualFriend){return false}return true},_postToGameWall:function(k){if(!this._checkCanPostOnWall()){this._showFriendsOnlyModal();return}var l=b.StringUtils.trim(k.getText());if(l.length===0){b.UIUtils.showToast(b.LocText("Please enter a message to post."));return}var j=b.Session.getCurrentSession().appKey();var h=this._user.recordID;b.Wall.postMsg(h,l,function(m,n){if(m){b.UIUtils.showToast(b.LocText("Failed to post to wall."))}else{k.setText("");k.blur();this._createAndInsertPost(n,b.Session.getCurrentSession().user())}}.bind(this),false,j)},layoutSubviews:function($super,h){this._enableHeaderAndFooter();$super(h)},_footerWasEnabled:false,_showFooter:false,_showHeader:false,_enableHeaderAndFooter:function(){var j=this.section()._listView;if(!j){return}if(!this._headerAndFooterCreated){this._headerAndFooterCreated=true;var h=j.getFrame()[2];var m=this._header=new b.WallSectionHeaderItem();m.setHeight(Math.ceil(b.Extras.headerHeightFactor*h));m.setOnClick(this._postToGameWall.bind(this));m.setUser(this._user);m.setPostingEnabled(true);m.setPlaceholder(b.LocText("Leave a comment for %1s…",this._user.gamertag));m.setTitleText("");this._headerRow=m;this._showHeader=false;if(f){var k=m._onSetView.bind(m);m.setOnSetView(function(n){this.section().setTitleView(n);n.removeFromParent();this.section()._listView.addChild(n);this.setHeaderRow(null);k(n);m.setOnSetView(k)}.bind(this))}var l=new b.WallSectionFooterItem();l.setHeight(Math.ceil(b.Extras.footerHeightFactor*h));this._footerRow=l;this._footerRow.setOnClick(this._loadMoreWall.bind(this));this._showFooter=false}this._header.setPostingEnabled(this._checkCanPostOnWall());if(this._footerWasEnabled!=this._showFooter){this._footerWasEnabled=this._showFooter;this.reloadList()}}})}};__ngs._bu={_c:null,_d:function(){var e={exports:{}};var h=e.exports;this._c=e;var f=__ngs.r_(__ngs._59).UI;var d=f.ViewGeometry.Rect;var c=f.ViewGeometry.Scale;var m=__ngs.r_(__ngs._7).Capabilities;var b=new (__ngs.r_(__ngs._f).RequireLoader)({ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells}});var a=__ngs.r_(__ngs._9h).Composite;var g=__ngs.r_(__ngs._9i).Components;var j=20;var l=g.Layouts.TwoHorizontalGenerator("spinner","content").layoutSubviews;var k=h.PendingCellView=a({key:"spinner",component:g.Spinner},{key:"content",component:g.Label,altKey:"message"},g.AddOrders.Generator("content","spinner"),{classname:"PendingCellView",initialize:function($super){$super({});b.ListViewCellStyles.PendingCell.applyTo(this);this.spinner.setDarkStyle(true)},layoutSubviews:function($super){if($super&&typeof $super==="function"){$super()}var r=new d(this.getFrame());if(r.isEmpty()){return}var o=1/6*r.w;this.spinner.setFrameSize([o,o]);this.setSpinnerInset([o/20,o/10,o/20,o/10]);l.call(this);var q=new d(this.spinner.getFrame());if(q.isEmpty()){return}var n=(q.w-q.h)/2;var p=q.h;q.h=j*(m.getScreenHeight()/480);q.w=q.h;q.x+=n;q.y+=(p-q.h)*0.5;this.spinner.setFrame(q)}})}};__ngs._6b={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var f=function(j){if(j&&j.constructor===this.ObjectConstructor){if(this.cursor<this._poolSize){this[this.cursor++]=j;return true}}return false};var b=function(){var j;if(this.cursor>0){j=this[--this.cursor];this[this.cursor]=null}else{j=new this.ObjectConstructor()}j.setAll.apply(j,arguments);return j};var h=function(j){while(this.cursor<j){this[this.cursor++]=new this.ObjectConstructor()}};var d=function(){this.length=this.cursor=0};var g=function(j){this._poolSize=j;if(this.length>j){this.length=j}if(this.cursor>j){this.cursor=j}};var a=function(){return"Pool of "+this.ObjectConstructor.classname+": "+this.cursor+" / "+this.poolSize+" (array size "+this.length+")"};c.Pool={create:function(k,l){var j=new Array();j.ObjectConstructor=k;j._poolSize=l;j.cursor=0;j.reserve=h;j.put=f;j.get=b;j.drain=d;j.setPoolSize=g;j.debugInfo=a;return j}}}};__ngs._6c={_c:null,_d:function(){var c={exports:{}};var f=c.exports;this._c=c;var e=__ngs.r_(__ngs._59).UI;var b=e.ViewGeometry.Rect;var a=e.ViewGeometry.Scale;var h=__ngs.r_(__ngs._77).Primitives;var j;var d=f.ComplexLabel=h.View.subclass({classname:"ComplexLabel",suggestedWidthPerLetter:null,sublabels:null,_oldSetFrame:null,fullLength:null,batchMode:false,initialize:function($super,k){$super(k);this.sublabels=[];this.fullLength=0;this.batchMode=false;return this},destroy:function(){for(var k in this.sublabels){if(!this.sublabels.hasOwnProperty(k)||!this.sublabels[k]){continue}this.sublabels[k].release()}},sizeChanged:function(){this.layoutSubviews()},addTextWithAttributes:function(p,n){NgLogD("ComplexLabel: adding label for '"+p+"'");if(p.indexOf("\n")!=-1){var o=p.split("\n");for(var m in o){if(!o.hasOwnProperty(m)){continue}if(o[m]&&o[m].length){this.addTextWithGradient(o[m],n)}else{this.sublabels.push(false)}}return}var k=(new h.Label()).retain();k.setAttributes(n);k.setText(p);k._ComplexLabel_properties={stopManagingDimensions:false,stopManagingOrigin:false,useCharacterGuessingMode:true,useSuggestedCharacterWidthMode:false};k.setFrame([0,0,50,50]);this.addChild(k);this.sublabels.push(k);this.fullLength+=p.length;if(!this.batchMode){this.layoutSubviews()}},layoutSubviews:function(){NgLogD("ComplexLabel: layoutSubviews");var t;var A=1;for(t in this.sublabels){if(!this.sublabels.hasOwnProperty(t)){continue}if(!this.sublabels[t]){A++}}var m=new b(this.getFrame());var l=Math.floor(m.h/A);var u=(m.w/this.fullLength);t=0;var k,z,y,r,p;var x;var w;var q,o;var n,s;var v;for(q=0;q<A;q++){x=t;t=this.sublabels.indexOf(false,t);if(t==-1){t=this.sublabels.length}k=m.w/(t-x);z=0;for(o=0;o<t-x;o++){w=this.sublabels[x+o];v=w.getFrame();y=w.getText();r=y.length;p=j(y);if(w._ComplexLabel_properties.useCharacterGuessingMode){this.logd("CharacterGuessingMode");v=[z,q*l,u*p,l];w.setFrame(v);z+=v[2]}else{if(!w._ComplexLabel_properties.stopManagingDimensions&&!w._ComplexLabel_properties.stopManagingOrigin){s=[z,q*l,k,l];w.setFrame(s);z+=k}else{if(w._ComplexLabel_properties.stopManagingDimensions&&!w._ComplexLabel_properties.stopManagingOrigin){w.setFrame([z,q*l,v[2],v[3]]);z+=v[2]}else{if(w._ComplexLabel_properties.stopManagingOrigin&&!w._ComplexLabel_properties.stopManagingDimensions){w.setFrame([v[0],v[1],k,l]);z+=k}else{if(w._ComplexLabel_properties.stopManagingOrigin&&w._ComplexLabel_properties.stopManagingDimensions){w.setFrame(v);z+=v[2]}}}}}}}},setStyle:function($super,m){if(!m){$super(m);return}if(!(m instanceof Array)){NgLogD("ComplexLabel had a non array of styles set to it");m=[m]}$super(m);var l;for(var k in this.sublabels){if(!this.sublabels.hasOwnProperty(k)){continue}l=m[k%m.length];this.sublabels[k].setAttributes(l)}},$initializeFromStringSegmentLengthsAndAttributes:function(q,m,p){var l=[];var k=q;var o=q.length;for(var r in m){if(!m.hasOwnProperty(r)){continue}if(m[r]>q.length){break}l.push(q.substr(0,m[r]));q=q.slice(m[r])}if(q.length){l.push(q)}return d.initializeFromComponentsAndAttributes(l,p)},$initializeFromComponentsAndAttributes:function(o,n){var k=new d();k.batchMode=true;var l,m=0;for(l in o){if(!o.hasOwnProperty(l)){continue}k.addTextWithAttributes(o[l],n[l%n.length])}k.batchMode=false;return k}});var g={",":0.8,".":0.8,"'":0.8,"|":0.8,"\\":0.8,"/":0.8,"`":0.8,"!":0.8,r:0.8,j:0.8,i:0.8,m:1.1,M:1.3,A:1.2,l:0.8};j=function(m){var k=0;for(var l=0;l<m.length;l++){if(m[l] in g){k+=g[m[l]]}else{k+=1}}return k}}};__ngs._6d={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var e={};e.Style=__ngs.r_(__ngs._60).Style;var a=e.Style.ScaledCorners;var d=e.Style.ScaledTextSize;e.Style.sheet("social.us.banking",{topAreaView:{gradient:{insets:"{-10.0,0.0,0.0,0.0}",outerLine:"FF607F9B 2.0"},backgroundColor:"0000"},balanceAreaView:{gradient:{insets:"{0.0,1.0,0.0,0.0}",corners:"0.0 6.0 0.0 0.0",gradient:["FF162230 0.000","FF132439 1.000"],outerLine:"FF607F9B 2.0"}},myBalanceLabel:{textColor:"FFFFFFFF",textSize:d(11)},balanceNumLabel:{textColor:"FFF8F07F",textSize:d(15)},balanceNameLabel:{textColor:"FFF8F07F",textSize:d(11)},customerSupportButton:{gradient:{corners:a(4),gradient:["FF0B4B93 0.0","FF093A72 1.0"],outerLine:"FF081426 2.0"},textColor:"FFD6EBFF",textSize:d(12)},customerSupportButtonPressed:{corners:a(4),gradient:["FF062C57 0.000","FF093C76 1.000"],outerLine:"FF081426 2.0"},coinBackgroundView:{gradient:{insets:"{0.0,0.0,0.0,0.0}",corners:"0.0 0.0 0.0 0.0",gradient:["FF183350 0.000","FF5387AC 1.000"]}},coinPackView:{gradient:{insets:"{1.0,1.0,1.0,1.0}",corners:"4.0 4.0 4.0 4.0",gradient:["FFD8DFE6 0.000","FFF1F4F7 1.000"],outerLine:"FF0B223A 1.0"}},coinPackHeaderLabel:{textColor:"FF000000",textSize:d(12)},coinPackHeaderMidLabel:{textColor:"FF1C4064",textSize:d(14)},coinPackAmountLabel:{textColor:"FF6A5100",textSize:d(28),textFont:e.Style.defaultBoldFontFace},coinPackPriceButton:{normalGradient:{innerShadow:"FFE7C633 0.0 {0.0,-2.0}",insets:"{1.0,1.0,1.0,1.0}",corners:"8.0 8.0 8.0 8.0",gradient:["FFE3C130 0.000","FFBE8606 1.000"],outerLine:"FF6A5100 2.0"},highlightedGradient:{innerShadow:"FFE7C633 0.0 {0.0,-2.0}",insets:"{1.0,1.0,1.0,1.0}",corners:"8.0 8.0 8.0 8.0",gradient:["FFBE8606 0.000","FFE3C130 1.000"],outerLine:"FF6A5100 2.0"},textColor:"FFFFFFFF",textSize:d(18),textShadow:"FFA0780E 1.5 {0,-1}"},bottomAreaLabel:{textColor:"FF98D8F2",textShadow:"24000000 2 {0,-1}"},bottomAreaLabelAttributes:[{textColor:"FF98D8F2",textSize:d(12),textShadow:"24000000 2 {0,-1}"},{textColor:"FF98D8F2",textSize:d(12),textShadow:"24000000 2 {0,-1}"},{textColor:"FF98D8F2",textSize:d(12),textShadow:"24000000 2 {0,-1}"},{textColor:"FFFFFFFF",textSize:d(12),textShadow:"24000000 2 {0,-1}"},{textColor:"FF98D8F2",textSize:d(12),textShadow:"24000000 2 {0,-1}"},{textColor:"FF98D8F2",textSize:d(12),textShadow:"24000000 2 {0,-1}"},{textColor:"FFFFFFFF",textSize:d(12),textShadow:"24000000 2 {0,-1}"},{textColor:"FF98D8F2",textSize:d(12),textShadow:"24000000 2 {0,-1}"}],topAreaXRatio:0.01,topAreaYRatio:80/480,topAreaWidthRatio:1.02,topAreaHeightRatio:7/48,coinPacksViewMarginRatio:0.08,coinPacksViewHeightRatio:0.53,coinPackOffsetYRatio:0.35,arrowWidthRatio:0.4,arrowHeightRatio:0.5,arrowSideMarginRatio:0.4,coinPackMarginBigRatio:0.8,coinPackMarginSmallRatio:0.005,bottomAreaHeightRatio:0.13,balanceAreaXRatio:0,balanceAreaYRatio:0.1,balanceAreaWidthRatio:0.45,balanceAreaHeightRatio:0.9,balanceCoinXRatio:0.02,balanceCoinYRatio:0.04,balanceCoinWidthRatio:0.88,balanceCoinHeightRatio:0.85,myBalanceXRatio:0.12,myBalanceWidthRatio:0.4,myBalanceHeightRatio:0.45,balanceNumXRatio:0.12,balanceNumYRatio:0.25,balanceNumWidthRatio:0.4,balanceNumHeightRatio:0.7,balanceNameXRatio:0.28,balanceNameYRatio:0.29,balanceNameWidthRatio:0.4,balanceNameHeightRatio:0.7,supportButtonXRatio:0.78,supportButtonYRatio:0.4,supportButtonWidthRatio:0.21,supportButtonHeightRatio:0.5,coinPackHeader1YRatio:0.03,coinPackHeader1HeightRatio:0.15,coinPackHeader2YRatio:0.125,coinPackHeader2HeightRatio:0.15,coinPackHeader3YRatio:0.22,coinPackHeader3HeightRatio:0.15,coinPackCoinYRatio:0.45,coinPackCoinWidthRatio:0.23,coinPackCoinHeightRatio:0.23,coinPackCoinMarginRatio:0.03,coinPackAmountYRatio:0.45,coinPackAmountWidthRatio:1,coinPackAmountHeightRatio:0.23,coinPackAmountDigitWidthRatio:0.115,coinPackPriceButtonYRatio:0.75,coinPackPriceButtonWidthRatio:0.88,coinPackPriceButtonHeightRatio:0.21})}};__ngs._6e={_c:null,_d:function(){var b={exports:{}};var s=b.exports;this._c=b;var k=__ngs.r_(__ngs._59).UI;var a=__ngs.r_(__ngs._5).Core;var e=__ngs.r_(__ngs._2z).Assets;var p=__ngs.r_(__ngs._60).Style;var g=k.ViewGeometry.Rect;var f=__ngs.r_(__ngs._35).VerticalTabController;var t=__ngs.r_(__ngs._a1).ButtonLibrary;var q=__ngs.r_(__ngs._9h).Composite;var n=__ngs.r_(__ngs._9i);var o=n.Component;var u=n.ComponentInheritForKey;var r=n.Components;var h=n.ACCESSOR_PASSTHROUGH;var d=__ngs.r_(__ngs._a2).CustomCellView;var l=__ngs.r_(__ngs._68);var m=s.MobageTabButton=d.subclass({classname:"MobageTabButton",initialize:function($super,w,v){$super(w);var x=__ngs.r_(__ngs._9g).TabButton;this._sizing=x.extras;this._hasNumber=v;if(this._hasNumber){this.rightAccessory=(new k.Label()).retain();this.addChild(this.rightAccessory)}x.applyTo(this);this.setImageGravity([0,0.5]);this.setTextGravity([0,0.5]);return this},destroy:function(){if(this.rightAccessory){this.rightAccessory.release()}},layoutSubviews:function($super){$super();var D=new g(this.getFrame());if(!D||D.isEmpty()||!this.getParent()||!this.getParent().getFrame()){this.logd("layoutSubviews inputs not ready.");return}D.x=0;D.y=0;var H=this._sizing.leftImageInsetRatio*D.h;var B=H*2/3;var z=H;var C=this._sizing.leftImageWidthRatio*D.w;var I=C;this.setImageFrame([B,z,C,I]);var F=B+C;var E=0;var G=D.w-F;var x=D.h;if(this._hasNumber){var y=this._sizing.rightImageWidthRatio*D.w;var A=this._sizing.numberRightTextSpacingRatio*D.h;this.rightAccessory.setFrame([D.w-(y+A),0,y-A,D.h]);G=G-y}var v=this._sizing.leftTextSpacingRatio*D.w;var w=this._sizing.rightTextSpacingRatio*D.w;F=F+v;G=G-w;this.setTextFrame([F,E,G,x])},getHeightRatio:function(){return this._sizing.heightRatio},_setLeftImageFrame:function(v){this._leftImageFrame=new g(v);var w=[this._leftImageFrame.y,0,this._leftImageFrame.y,this._leftImageFrame.x];this.setImageInsets(w)},_getLeftImageFrame:function(){return this._leftImageFrame},_setRightImageFrame:function(v){this._rightImageFrame=new g(v);var w=[this._righhtImageFrame.y,this._frame[2]-this.rightImageFrame.w-this._rightImageFrame.x,this._frame[3]-this._rightImageFrame.h-this._rightImageFrame.y,32-this._rightImageFrame.x];this.setRightImageInsets(w)},_getRightImageFrame:function(){return this._rightImageFrame},setSelected:function(v){if(v){this.setState(k.State.Selected);this.setTouchable(false)}else{this.setState(k.State.Normal);this.setTouchable(true)}},sizeChanged:function(){this.layoutSubviews()}});var c=s.MobageJumpButton=q({key:"background",component:r.View},{key:"content",component:o(r.Button,u(r.ImageLabel,"accessory"),{initializeViewWithKey:function(v){this[v]=(new t.Label_ImageLabelButton()).retain()},getAccessoryInset:h,setAccessoryInset:h,getContentInset:h,setContentInset:h}),disableViewAccessorRemapping:true},r.AddOrders.TwoSuperimposed,{classname:"MobageJumpButton",initialize:function($super,v){$super(v);var w=__ngs.r_(__ngs._9g).JumpButton;this._options=w.extras;w.applyTo(this);this.content.accessory.setImage(e.image("mobageverticaltab_jumpbutton_arrowright.png"));this.showCaret();this._rightImageWidthMultiplier=1;return this},showCaret:function(){this._caretMode=true;if(this.content.getFrame()){this.layoutSubviews()}},showCustomAccessoryImage:function(v){this._caretMode=false;this.content.accessory.setImage(v);if(this.content.getFrame()){this.layoutSubviews()}},layoutSubviews:function($super){var z=new g(this.getFrame());if(!z||z.isEmpty()){this.logd("layoutSubviews inputs not ready.");return}var y=a.Capabilities.getScreenHeight()/800;var x=(this._options.insetRatio*z.h)*y;var w=(this._options.leftTextSpacingRatio*z.h)*y;this.setContentInset([x*3,x,0,0]);this.getContentView().setContentInset([0,w,0,w]);if(this.content.accessory.getImage()&&this._rightImageWidthMultiplier){var A=this._options.rightImageWidthRatio*z.w*this._rightImageWidthMultiplier;this.content.accessory.setFrameSize([A,z.h])}var v=this._options.rightImageInsetRatio*z.h;if(this._caretMode){this.content.setAccessoryInset([v*2,v,v*2,0])}else{this.content.setAccessoryInset([v,v,v,0])}this.content.accessory.setTextInsets([0,0,0,v]);this.content.layoutSubviews();r.Layouts.TwoSuperimposed.layoutSubviews.call(this,$super)}});var j=s.MobageVerticalTabController=f.subclass({classname:"MobageVerticalTabController",initialize:function(){},addTabWithTextImageAndContent:function(A,y,x,v){this.logd("addTabWithTextImageAndContent: "+A);var w=this;if(x.controller&&x.controller.parentController!=undefined){x.controller.parentController=this}var z={tabView:null,contentView:x};if(v==undefined){v=false}z.tabView=(new m(undefined,v)).retain();z.tabView.onclick=function(){NgLogD("Tab Clicked ("+z.tabView.getText()+")");if(l.getSpamProtectionLockForName("default").acquire()){w.selectTabByView(z.tabView,true)}};var B=new k.ViewGeometry.Rect(0,0,20,20);z.tabView.setFrame(B);if(A){z.tabView.setText(A)}if(y){z.tabView.setImage(y)}if(v){z.tabView.rightAccessory.setText("")}return this.addTabPair(z)},addTabWithTextAndContent:function(w,v){return this.addTabWithTextImageAndContent(w,null,v)},addJumpWithTitleAndCallback:function(z,A){var w=this;var y=new Object({isJumpButton:true,tabView:null});var x=a.Capabilities.getScreenHeight()/800;var v=new k.ViewGeometry.Rect(0,0,200,84*x);y.tabView=(new c()).retain();y.tabView.setFrame(v);y.tabView.content.setOnClick(A);y.tabView.content.content.setText(z);return this.addTabPair(y)},destroy:function($super){$super()}})}};__ngs._6f={_c:null,_d:function(){var e={exports:{}};var v=e.exports;this._c=e;var m=__ngs.r_(__ngs._59).UI;var a=__ngs.r_(__ngs._5).Core;var o=__ngs.r_(__ngs._1k).Analytics;var g=__ngs.r_(__ngs._a3).ContentViewController;var d=__ngs.r_(__ngs._n).LocalizedString;var h=__ngs.r_(__ngs._2e).Game;var f=__ngs.r_(__ngs._6o).MobageBootAB;var l=__ngs.r_(__ngs._6n).CpiProduct;var r=__ngs.r_(__ngs._o).Session;var s=__ngs.r_(__ngs._79).MBListViewSection;var j=__ngs.r_(__ngs._9r).PendingListSection;var p=__ngs.r_(__ngs._2a).Destinations;var k=__ngs.r_(__ngs._a4).ZeroCaseSection;var b=__ngs.r_(__ngs._a5).CatalogListItem;var q=__ngs.r_(__ngs._a5).CatalogInfoLabelStrLenGetter;var t=__ngs.r_(__ngs._a6).GameDownloadButton;var n=__ngs.r_(__ngs._a3).compareArrays;var c=v.CatalogController=g.subclass({classname:"CatalogController",analyticsName:"AllGames",_listView:null,_listItems:null,_catalogStyle:null,_totalGames:0,_totalWidth:0,_maxEntries:null,_sorting:null,_catalogListSection:null,_pendingListSection:null,_zeroCaseSection:null,initialize:function($super,w){if($super&&typeof $super=="function"){$super()}this._listItems=[];this._catalogStyle=__ngs.r_(__ngs._a7).CatalogList;this._variant=w;this.onResult=this.zombieSafeCallback(this.onResult);this.onError=this.zombieSafeCallback(this.onError)},destroy:function(){if(this._catalogListSection){this._catalogListSection.release()}if(this._pendingListSection){this._pendingListSection.release()}if(this._zeroCaseSection){this._zeroCaseSection.release()}this._listItems=[]},setMaxEntries:function(w){this._maxEntries=w},setSorting:function(w){this._sorting=w},loadView:function($super){$super();this.view()._headerHeightRatio=0;this.view()._footerHeightRatio=0},startLoadingProgress:function(){if(!this._pendingListSection){this._pendingListSection=(new j()).retain();this._pendingListSection.setPendingText(d("Loading games..."))}var x;if(this._listView.getSections().indexOf(this._pendingListSection)==-1){var w=[this._pendingListSection];w=w.concat(this._listView.getSections());this._setListViewSections(w)}},stopLoadingProgress:function(){var w,x;if((w=((x=this._listView.getSections()).indexOf(this._pendingListSection)))!=-1){x.splice(w,1);this._setListViewSections(x)}},didActivateTab:function($super){$super();setTimeout(this.bind(function(){this._setupContent()}),50);if(t.TimeLabelHeight==0){t.measureTimeLabelHeight()}},_setupContent:function(){this._createListView();this._createGameList()},_createListView:function(){if(this._listView){NgLogD("CatalogController: _createListView: already have listview");return}var w=(new s()).retain();w.setRowHeightRatio(this._catalogStyle.extras.catalogCellHFactor2);this._listItems=[];this._listView=this.view().getContentView();this._catalogListSection=w;this._setListViewSections([w]);this._catalogStyle.applyTo(this)},_createGameList:function(){if(!this._listView){return}if(!this._listView.getSections()){return}if(!this._listView.getSections()[0].getItems()){return}if(this._totalGames){return}var w=r.getCurrentSession();if(this._variant=="friends"&&!w){return}if(this._refreshing){return}this._refreshing=true;this.startLoadingProgress();this._totalGames=0;var x=new u(this);x.execute()},onResult:function(D){var B,w;var y={};var x;var C=l.getProducts();var A=function(){for(B=0,w=D.length;B<w;++B){x=D[B];var F=C[x.recordID];var E=this._getCatalogListItem(x,this._totalGames%2===1,F,y[x.recordID]);this._listItems.push(E);this._totalGames++}this._refreshing=false;this._setCatalogItems(this._listItems.slice());this._setListViewSections([this._catalogListSection])}.bind(this);if(D.length>0){this._sortGames(D);var z=0;for(B=0,w=D.length;B<w;++B){x=D[B];if(!C.hasOwnProperty(x.recordID)){++z;new q(x,function(E,F){y[E.recordID]=F;--z;if(B==w&&z==0){A()}})}}if(z==0){A()}}else{this._refreshing=false;if(this._variant=="friends"){if(!this._zeroCaseSection){this._zeroCaseSection=(new k(1,this.view().content.getFrame()[3])).retain();this._zeroCaseSection.setZeroCaseTexts([d("No friends' games were found."),d("Have you tried scanning your contacts? People you know may already be on Mobage!"),d("Scan Contacts")]);this._zeroCaseSection.setZeroCaseButtonCallback(function(){p.pushScreen(this.parentController.navController,"FindFriends",{tab:"contacts"},{analyticsName:"CatalogControllerZeroFriendsButton"})}.bind(this))}this._setListViewSections([this._zeroCaseSection])}}},onError:function(x){this._refreshing=false;var w=(new m.AlertDialog()).retain();w.setTitle(d("Error"));w.setText(d("Error accessing system.  Please try again later. Error: %1s",x));w.setChoices([d("OK")]);w.onchoice=function(y){w.release();w=null};w.show()},_getCatalogListItem:function(w,z,y,A){var x=new b(w,z,y,A);x.rowTappedForGame=function(B){if(B){NgLogD("CatalogCell: INIT GAME");p.pushScreen(this.parentController.navController,"GameProfile",{game:B},x)}else{NgLogD("CatalogCell: missing tappedGame")}}.bind(this);x.goToAppStoreHandler=function(D){var C=D.getGame();var F=D.getProduct();var E=f.getProp("GameCarouselTransition","directToMarket");var G=r.getCurrentSession();var B={screen:"catalog",carousel_transition:(E)?"direct":"gameinfo",current_appkey:(G)?G.appKey():"",appkey:C.recordID,is_featured:C.featured,is_incented:Boolean(F),campaign_id:(F&&F.campaign)?F.campaign.recordID:"",incent_amt:(F&&F.hasOwnProperty("mobacoin"))?F.mobacoin:0};B.featured_slotnum=this._getFeaturedSlotNum(D);B.list_slotnum=this._listItems.indexOf(D);o.reportGameEvent("GameClick",B)}.bind(this);return x},_getFeaturedSlotNum:function(z){var x=z.getGame();var B=z.getProduct();if(!x.featured&&!B){return -1}var C=0;for(var y=0,w=this._listItems.length;y<w;++y){var A=this._listItems[y];if(A==z){break}x=A.getGame();B=A.getProduct();if(x.featured||B){++C}}return C},_sortGames:function(w){switch(this._sorting){case"name abc":w.sort(function(A,z){var y=A.name.toLowerCase();var x=z.name.toLowerCase();return(y==x?0:(y<x?-1:+1))});break;case"name cba":w.sort(function(A,z){var y=A.name.toLowerCase();var x=z.name.toLowerCase();return(y==x?0:(y<x?+1:-1))});break;case"publisher abc":w.sort(function(A,z){var y=A.publisher.toLowerCase();var x=z.publisher.toLowerCase();return(y==x?0:(y<x?-1:+1))});break;case"publisher cba":w.sort(function(A,z){var y=A.publisher.toLowerCase();var x=z.publisher.toLowerCase();return(y==x?0:(y<x?+1:-1))});break;default:return}},_setListViewSections:function(x){var y=this._listView.getSections();var w=function(A,z){return(A==z)};if(!n(y,x,w)){this._listView.setSections(x)}},_setCatalogItems:function(x){var w=this._catalogListSection.getItems();var y=function(A,z){if(!A||!z){return false}return(A.getGame().is(z.getGame()))};if(!n(w,x,y)){this._catalogListSection.setItems(x)}}});var u=v.RetrieveCatalogDataCommand=a.Class.subclass({classname:"RetrieveCatalogDataCommand",initialize:function(w){this._responder=w;this._variant=w._variant;this._maxEntries=w._maxEntries},execute:function(){var x=[];var w=2;var z=function(){if(--w==0){var H;var E=0;if(this._variant=="friends"){H=x}else{H=[];var G=l.getProducts();for(var D=0,B=x.length;D<B;++D){var C=x[D];var F=G.hasOwnProperty(C.recordID);if(this._variant!="featured"||C.featured||F){H.push(C)}if(F){++E;C.loadLaunchable(function(){--E;if(D==B&&E==0){this._loadGameDataCompleteCb(H)}}.bind(this))}}}if(E==0){this._loadGameDataCompleteCb(H)}}}.bind(this);l.loadProducts(z);if(this._variant=="friends"){var y=[];var A=r.getCurrentSession();A.user().getMutualFriendsList().forAll(function(C,D,E){for(var G=0,B=D.games.length;G<B;++G){var F=D.games[G].recordID;if(y.indexOf(F)==-1){y.push(F)}}C(this._maxEntries===null||y.length<this._maxEntries)}.bind(this),function(D){if(D){this._loadDataErrorCb(D);return}if(y.length>0){var C=0;for(var E=0,B=y.length;E<B;++E){h.getGameWithAppKey(y[E],function(G,F){if(!G){x.push(F)}++C;if(y.length==C){z()}})}}else{z()}}.bind(this))}else{h.getAllGamesList().forAll(function(C,B){x.push(B);C(this._maxEntries===null||x.length<this._maxEntries)}.bind(this),function(B){if(B){this._loadDataErrorCb(B);return}}.bind(this),function(C,B){if(C){this._loadDataErrorCb(C);return}if(B){x=[];h.getAllGamesList().forAll(function(E,D){x.push(D);E(this._maxEntries===null||x.length<this._maxEntries)}.bind(this),function(D){z()},true)}else{z()}}.bind(this))}},_loadGameDataCompleteCb:function(w){if(this._responder){this._responder.onResult(w);this._responder=null}},_loadDataErrorCb:function(w){if(this._responder){this._responder.onError(w);this._responder=null}}})}};__ngs._6g={_c:null,_d:function(){var b={exports:{}};var g=b.exports;this._c=b;var d=__ngs.r_(__ngs._59).UI;var l=__ngs.r_(__ngs._w).MessageListener;var j=__ngs.r_(__ngs._a3).ContentViewController;var p=__ngs.r_(__ngs._n).LocalizedString;var o=__ngs.r_(__ngs._79).MBListViewSection;var k=__ngs.r_(__ngs._9r).PendingListSection;var h=__ngs.r_(__ngs._a8).DirectInviteSection;var a=__ngs.r_(__ngs._6h).ContactsController;var m=__ngs.r_(__ngs._30).User;var c=__ngs.r_(__ngs._2e).Game;var f=__ngs.r_(__ngs._o).Session;var e=__ngs.r_(__ngs._9s).IdleActor;var n=g.SuggestedFriendsController=j.subclass({classname:"SuggestedFriendsController",analyticsName:"SuggestedFriends",$ListItem:null,initialize:function(){this._suggestedFriendsStyle=__ngs.r_(__ngs._a9).SuggestedFriends;this._idleActor=(new e()).retain()},_suggestedFriendsStyle:null,plusMatchSection:null,pendingSection:null,directInviteSection:null,_idleActor:null,_idleAction:null,loadView:function($super){$super();this._titleHeader=this.view().getHeaderView();this._titleHeader.setFrameSize([100,100]);this._suggestedFriendsStyle.applyTo(this);this._titleHeader.button.setText(p("Refresh"));this._titleHeader.button.setFrameSize([100,100]);this._titleHeader.button.setOnClick(this.bind(this._refreshData))},destroy:function(){if(this.plusMatchSection){this.plusMatchSection.release()}if(this.pendingSection){this.pendingSection.release();this.pendingSection=null}if(this.directInviteSection){this.directInviteSection.release();this.directInviteSection=null}this._idleActor.release()},_dirtyFriendsListenerSetup:function(){var q=f.getCurrentSession().user();var r=new l();q.addListener(r,this.zombieSafeCallback(function(s){if(!s||!s.buddies){return}this._updateFriendsListCache()},this.bind(function(s){q.removeListener(r);r.destroy()})))},_updateFriendsListCache:function(){if(this._friendsListCacheUpdateInProgress){return}this._friendsListCacheUpdateInProgress=true;var r=[];this._friendsListCacheReady=false;var q=f.getCurrentSession().user();q.getFollowersList().forAll(this.zombieSafeCallback(function(t,s){r.push(s);t(true)}),this.zombieSafeCallback(function(v){this.loge("_updateFriendsListCache finished");this._friendsListCacheUpdateInProgress=false;if(v){this.scanState=a.ScanState.NotStarted;this.pendingSection.showError(v,this.bind(function(){this._updateFriendsListCache();this.startSearch()}));return}this._outgoingRelationships=r;this._friendsListCacheReady=true;if(this.plusMatchSection&&this.plusMatchSection.getItems()&&!this.plusMatchSection.getItems().length){if(this._finishedScanning){this._resultsReady()}}else{if(this.plusMatchSection&&this.plusMatchSection.getItems().length===0){this._showNoResultsCase()}else{var u;var s=(this.plusMatchSection&&this.plusMatchSection.getItems())?this.plusMatchSection.getItems():[];for(var t=0;t<s.length;t++){if((u=s[t])&&u.cell){u._onSetView(u.cell)}}}}}))},willActivateTab:function($super){$super();NgLogD("SuggestedFriendsController/willActivateTab begin");var q=new d.ViewGeometry.Rect(this.view().getFrame());var r=new d.ViewGeometry.Rect(this.view().getFrame());q.h=this._suggestedFriendsStyle.extras.headerHeightRatio*r.h;this.view().header.setFrame(q);this.view().header.button.setFrameSize([q.h*this._suggestedFriendsStyle.extras.refreshButtonWidthRatio,q.h]);this.view().layoutSubviews();if(!this._isTitleSet){if(this.parentController.navController._host.isRunningActiveGame()){c.getCurrentGame(function(t,s){if(!t){this._titleHeader.content.setText(p("People playing %1s",s.name));this._isTitleSet=true}else{NgLogD("Home Screen Last played icon: I think an active game is running but I failed to get it, Err: "+t);this._titleHeader.content.setText(p("People on Mobage"));this._isTitleSet=true}}.bind(this))}else{this._titleHeader.content.setText(p("People on Mobage"));this._isTitleSet=true}}},didActivateTab:function($super){$super();this.parentController.navController._host.hideLoadingLabel();NgLogD("Activate suggested friends!");setTimeout(this.bind(function(){this.plusMatchSection=(new o()).retain();this.plusMatchSection.setRowHeightRatio(1/6);this.pendingSection=(new k()).retain();this.pendingSection.setPendingText(p("Getting Friend suggestions..."));this.directInviteSection=(new h()).retain();this._refreshData()}),50)},_refreshData:function(){NgLogD("Suggested users: Refreshing");this.view().getContentView().setScrollPosition([0,0]);this.view().setSections([this.pendingSection,this.directInviteSection]);this._dirtyFriendsListenerSetup();this._updateFriendsListCache();var r=this;this.allPlusUsers=[];this.plusMatchSection.setItems([]);this._finishedScanning=false;if(!this._idleAction){this._idleAction=this.bind(function(){if(this._friendsListCacheReady){this._resultsReady()}})}var q=f.getCurrentSession().user();q.getFeaturedUsersList().forAll(this.zombieSafeCallback(function(t,s){this.allPlusUsers.push(s);this._idleActor.waitForIdleBeforeAction(this._idleAction);t(true)}),this.zombieSafeCallback(function(s){this._finishedScanning=true;if(!s){NgLogD("Finish getFeaturedUsersList");this._idleActor.waitForIdleBeforeAction(this._idleAction)}else{NgLogE("Error SuggestedFriends/getFeaturedUsersList: "+JSON.stringify(s));this.pendingSection.showError(s,true)}}),this.zombieSafeCallback(function(t,s){NgLogD("SuggestedFriends: Cached lookup fully complete, needs UI refresh? "+!!s);if(!t&&s){this.allPlusUsers=[];q.getFeaturedUsersList().forAll(this.zombieSafeCallback(function(v,u){this.allPlusUsers.push(u);v(true)}),this.zombieSafeCallback(function(u){if(!u){NgLogD("SuggestedFriends: Refreshing UI post cache update!");this.plusMatchSection.setItems([]);this.view().getContentView().setScrollPosition(this.view().getContentView().getScrollPosition()||[0,0]);if(this._friendsListCacheReady){this._resultsReady()}}}),true)}}))},_resultsReady:function(){var r,v,x,u,t,y=[];var q=[];var s=0;var w=0;var z=this.plusMatchSection.getItems()||[];x=z.slice();for(u=z.length;u<this.allPlusUsers.length;u++){r=this.allPlusUsers[u];if(!r.isMutualFriend&&this._outgoingRelationships.indexOf(r)!=-1){r.invited=true;s--}x.push(new a.FoundUserListItem(r))}if(!this._plusMatchSort){this._plusMatchSort=function(B,A){return(B.user.invited==A.user.invited)?0:(B.user.invited?1:-1)}}x.sort(this._plusMatchSort);for(u=w;u<x.length;u++){x[u].odd=(u-w)%2}this.plusMatchSection.setItems(x);if(!this._finishedScanning&&this.view().getSections().indexOf(this.plusMatchSection)==-1){this.view().setSections([this.pendingSection,this.plusMatchSection,this.directInviteSection])}else{if(this._finishedScanning&&this.plusMatchSection&&this.plusMatchSection.getItems().length===0){this._showNoResultsCase()}else{if(this._finishedScanning){this.view().setSections([this.plusMatchSection,this.directInviteSection])}}}},_showNoResultsCase:function(){setTimeout(this.bind(function(){this.pendingSection.showError(p("No users found."));this.view().setSections([this.pendingSection,this.directInviteSection])}),1);NgLogD("No Results Case")}})}};__ngs._6h={_c:null,_d:function(){var c={exports:{}};var t=c.exports;this._c=c;var h=__ngs.r_(__ngs._59).UI;var g=h.ViewGeometry.Rect;var s=__ngs.r_(__ngs._w).MessageListener;var o=new (__ngs.r_(__ngs._f).RequireLoader)({Assets:function(){return __ngs.r_(__ngs._2z).Assets},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements},MBListViewSection:function(){return __ngs.r_(__ngs._79).MBListViewSection},ContactsSectionTitleView:function(){return __ngs.r_(__ngs._7a).ContactsSectionTitleView},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},AddressBookScan:function(){return __ngs.r_(__ngs._aa).AddressBookScan},User:function(){return __ngs.r_(__ngs._30).User},IdleActor:function(){return __ngs.r_(__ngs._9s).IdleActor},SessionUtils:function(){return __ngs.r_(__ngs._ab).SessionUtils},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},Session:function(){return __ngs.r_(__ngs._o).Session},SessionListener:function(){return __ngs.r_(__ngs._o).SessionListener},UserListener:function(){return __ngs.r_(__ngs._30).UserListener},Credentials:function(){return __ngs.r_(__ngs._2r).Credentials},UpgradeUserController:function(){return __ngs.r_(__ngs._ac).UpgradeUserController},PendingListSection:function(){return __ngs.r_(__ngs._9r).PendingListSection},DirectInviteSection:function(){return __ngs.r_(__ngs._a8).DirectInviteSection},ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells}});var j=__ngs.r_(__ngs._2a).Destinations;var f=__ngs.r_(__ngs._77).Primitives;var e=__ngs.r_(__ngs._a3).ContentViewController;var n=__ngs.r_(__ngs._ad).UserCellView_TappableRowVariant;var l=__ngs.r_(__ngs._ad).UserCellView_NonTappableRowVariant;var d=__ngs.r_(__ngs._ad).UserCellView_OneMessageNoIcon;var b=__ngs.r_(__ngs._n).LocalizedString;var r={initialize:function(){this.insetRatio=null;this.buttonSizeRatio=null;this.subtitleHeightRatio=0.5;this.accessoryButton.setText("AddOrInvite");var u=this;this.accessoryButton.setOnClick(function(){NgLogD("Default On Click");o.UIUtils.showToast(u.accessoryButton.getText())});var v=o.ListViewCellStyles.FoundFriendCell;v.applyTo(this);this.insetRatio=v.extras.buttonInsetRatio;this.buttonSizeRatio=v.extras.buttonSizeRatio;this.subtitleHeightRatio=v.extras.subtitleHeightRatio},markOdd:function(){this.addState(q.OddState)},markEven:function(){},layoutSubviews:function($super){var z=new g(this.getFrame());if(!z.isEmpty()){var w=z.copy();var x=this.insetRatio*z.h;var v=[x,x,x,x];var u=[x/2,x/2,x/2,x/2];this.setIconInset(u);this.setAccessoryButtonInset(v);this.icon.setFrameSize([w.h,w.h]);var y=z.w*this.buttonSizeRatio;this.accessoryButton.setFrameSize([y,z.h]);this.content.subtitle.setFrameSize([z.w-y-w.h-2*x,z.h*this.subtitleHeightRatio])}$super()}};var a=n.subclass({classname:"AddOrInviteCell",initialize:function($super,u){$super(u);r.initialize.call(this)},markOdd:r.markOdd,markEven:r.markEven,layoutSubviews:r.layoutSubviews});var k=l.subclass({classname:"AddOrInviteCellNonTappable",initialize:function($super,u){$super(u);r.initialize.call(this)},markOdd:r.markOdd,markEven:r.markEven,layoutSubviews:r.layoutSubviews});var m=d.subclass({classname:"AddAllCell",insetRatio:null,buttonSizeRatio:null,initialize:function($super,v){$super(v);this.accessoryButton.setText(b("Add All"));this.content.setText(b("Add all contacts below"));var u=this;this.accessoryButton.setOnClick(function(){NgLogD("Default On Click");o.UIUtils.showToast(u.accessoryButton.getText())});var w=o.ListViewCellStyles.AddAllCell;w.applyTo(this);this.insetRatio=w.extras.buttonInsetRatio;this.buttonSizeRatio=w.extras.buttonSizeRatio;this.subtitleHeightRatio=w.extras.subtitleHeightRatio},layoutSubviews:function($super){var w=new g(this.getFrame());if(!w.isEmpty()){var v=this.insetRatio*w.h;var u=[v,v,v,v];this.setAccessoryButtonInset(u);this.accessoryButton.setFrameSize([w.w*this.buttonSizeRatio,w.h]);this.setMessageInset(u)}$super()}});var p=function(u){var v=new o.ContactsSectionTitleView();v.setTitle(u);v.setAccessoryText(0);return v};var q=t.ContactsController=e.subclass({classname:"ContactsController",analyticsName:"Contacts",$FoundUserListItem:null,$AddAllUsersListItem:null,$InviteUserListItem:null,$OddState:15859712,scanner:null,allPlusUsers:null,allOtherContacts:null,plusMatchSection:null,invitableSection:null,pendingSection:null,scanState:null,$ScanState:{NotStarted:0,Beginning:1,InFlight:2,Complete:3},_idleActor:null,_idleAction:null,initialize:function(){this.scanState=0;this.scanner=new o.AddressBookScan();this.pendingSection=(new o.PendingListSection());this.pendingSection.setPendingText(b("Pulling in contacts..."));this.invitableSection=(new o.MBListViewSection()).retain();this.invitableSection.setSectionHeader(p(b("Invite Contacts to Mobage")));this.plusMatchSection=(new o.MBListViewSection()).retain();this.plusMatchSection.setSectionHeader(p(b("Contacts Already on Mobage")));this._idleActor=(new o.IdleActor()).retain();this._dirtyFriendsListener=new o.UserListener(this._dirtyFriendsListener_callback.bind(this),o.Session.getCurrentSessionUser());if(o.Session.isCurrentSessionValid()&&o.Session.getCurrentSessionUser().usesGuestLogin()){this._sessionListener=new o.SessionListener(this._sessionListener_callback.bind(this))}this._updateFriendsListCache()},loadView:function($super){$super();this.view()._headerHeightRatio=0;this.directInviteSection=(new o.DirectInviteSection()).retain()},destroy:function(){if(this.directInviteSection){this.directInviteSection.release()}if(this.scanner){this.scanner.abortScanning()}this._idleActor.release();this.invitableSection.release();this.plusMatchSection.release();this.pendingSection.release();if(this._errorSection){this._errorSection.release()}if(this.upgradeUserController){this.upgradeUserController.release()}if(this._dirtyFriendsListener){this._dirtyFriendsListener.destroy();this._dirtyFriendsListener=null}if(this._sessionListener){this._sessionListener.destroy();this._sessionListener=null}},didActivateTab:function($super){$super();this.parentController.navController._host.hideLoadingLabel();if(o.Session.getCurrentSession().user().usesGuestLogin()){if(!this.upgradeUserController){this.upgradeUserController=(new o.UpgradeUserController("contacts")).retain()}var u=this.upgradeUserController.view();u.setRowHeightRatio(1,this.view().content.getFrame()[3]);this.view().setSections([u]);return}setTimeout(this.bind(function(){this.startSearch()}),50)},_updateFriendsListCache:function(){if(this._friendsListCacheUpdateInProgress){return}this._friendsListCacheUpdateInProgress=true;var v=[];this._friendsListCacheReady=false;var u=o.Session.getCurrentSession().user();u.getFollowersList().forAll(this.zombieSafeCallback(function(x,w){v.push(w);x(true)}),this.zombieSafeCallback(function(z){this.loge("_updateFriendsListCache finished");this._friendsListCacheUpdateInProgress=false;if(z){this.scanState=q.ScanState.NotStarted;this.pendingSection.showError(z,this.bind(function(){this._updateFriendsListCache();this.startSearch()}));return}this._outgoingRelationships=v;this._friendsListCacheReady=true;if(this.plusMatchSection&&this.plusMatchSection.getItems()&&!this.plusMatchSection.getItems().length){if(this.scanState==q.ScanState.Complete){this._resultsReady()}}else{var y;var w=(this.plusMatchSection&&this.plusMatchSection.getItems())?this.plusMatchSection.getItems():[];for(var x=0;x<w.length;x++){if((y=w[x])&&y.cell){y._onSetView(y.cell)}}}}))},startSearch:function(){var u=this;switch(this.scanState){case q.ScanState.Complete:if(this.allPlusUsers.length===0&&this.allOtherContacts.length===0){this._showNoResultsCase()}break;case q.ScanState.NotStarted:this.scanState=q.ScanState.InFlight;this.allPlusUsers=[];this.allOtherContacts=[];this.scanner.searchPlusForPeople(this.zombieSafeCallback(function(w,y,x){if((typeof w)==="undefined"){this.allPlusUsers=this.allPlusUsers.concat(y);this.allOtherContacts=this.allOtherContacts.concat(x);NgLogD("ContactsController - Got back "+y.length+" plus users and "+x.length+" other contacts.");if(!this._idleAction){this._idleAction=this.bind(function(){if(this._friendsListCacheReady){this._resultsReady()}})}this._idleActor.interval*=(1.3);this._idleActor.waitForIdleBeforeAction(this._idleAction)}}),this.zombieSafeCallback(this._scanFinished));case q.ScanState.InFlight:var v=this.view().getSections();if(!v||!v.length||v[0]!=this.pendingSection){this.view().setSections([this.pendingSection,this.directInviteSection])}break;default:break}},_scanFinished:function(w){this.logd("ContactsController: searchPlusForPeople completed...");this.scanState=q.ScanState.Complete;if((typeof w)!="undefined"){this.loge(JSON.stringify(w));this.scanState=q.ScanState.NotStarted;if(!this._errorSection){this._errorSection=(new o.PendingListSection()).retain()}this._errorSection.showError(w);this.view().setSections([this._errorSection])}else{if(this.allPlusUsers.length===0&&this.allOtherContacts.length===0){this._showNoResultsCase()}else{var v=o.Session.getCurrentSession().user().gamertag;var u=0;while(u!=this.allPlusUsers.length){if(this.allPlusUsers[u].gamertag==v){this.allPlusUsers.splice(u,1)}else{++u}}if(this._friendsListCacheReady){this._resultsReady()}}}},_resultsReady:function(){var v,A,C,z,y,E=[];var u=[];var x=0;var B=0;var G=o.Session.getCurrentSession().user();var F=this.plusMatchSection.getItems()||[];var D=this.invitableSection.getItems()||[];C=F.slice();if(C.length&&C[0] instanceof q.AddAllUsersListItem){B=1}for(z=F.length;z<this.allPlusUsers.length;z++){v=this.allPlusUsers[z];if(G&&G.is(v)){continue}if(!v.isMutualFriend&&this._outgoingRelationships.indexOf(v)!=-1){v.invited=true;x--}if(this._outgoingRelationships.indexOf(v)==-1||!v.isMutualFriend){C.push(new q.FoundUserListItem(v));x++}else{u.push(v)}}if(!this._plusMatchSort){this._plusMatchSort=function(I,H){if(I instanceof q.AddAllUsersListItem){return -1}if(H instanceof q.AddAllUsersListItem){return 1}return(I.user.invited==H.user.invited)?0:(I.user.invited?1:-1)}}C.sort(this._plusMatchSort);for(z=B;z<C.length;z++){C[z].odd=(z-B)%2}if(x>1&&!B){var w=new q.AddAllUsersListItem();w.section=this.plusMatchSection;C.unshift(w)}this.plusMatchSection.setItems(C);this.plusMatchSection.getSectionHeader().setAccessoryText(C.length-B);if(C.length){E.push(this.plusMatchSection)}for(z=u.length-1;z>=0;--z){A=this.allPlusUsers.indexOf(u[z]);if(A!=-1){this.allPlusUsers.splice(A,1)}}C=D.slice();for(z=D.length;z<this.allOtherContacts.length;z++){v=this.allOtherContacts[z];for(y=1;y<v.lowercaseEmails.length;y++){C.push(new q.InviteUserListItem(v,y))}C.push(new q.InviteUserListItem(v,0))}if(!this._contactsSort){this._contactsSort=function(I,H){var J;if(typeof I.contact.isNumber==="undefined"){J=parseInt(I.contact.displayName,10);I.contact.isNumber=isNaN(J)}if(typeof H.contact.isNumber==="undefined"){J=parseInt(H.contact.displayName,10);H.contact.isNumber=isNaN(J)}if(I.contact.isNumber?!H.contact.isNumber:H.contact.isNumber){return I.contact.isNumber?-1:1}return(I.contact.displayName==H.contact.displayName)?((I.contact.lowercaseEmails[I.emailIndex]<H.contact.lowercaseEmails[H.emailIndex])?-1:1):((I.contact.displayName<H.contact.displayName)?-1:1)}}C.sort(this._contactsSort);for(z=0;z<C.length;z++){C[z].odd=(z)%2}this.invitableSection.setItems(C);this.invitableSection.getSectionHeader().setAccessoryText(C.length);if(C.length){E.push(this.invitableSection)}E.push(this.directInviteSection);if(this.scanState!==q.ScanState.Complete){E.unshift(this.pendingSection)}if(E.length-1){this.view().setSections(E)}else{this._showNoResultsCase()}},_showNoResultsCase:function(){this.pendingSection.showError(b("We didn't find any contacts."));NgLogD("No Results Case")},_dirtyFriendsListener_callback:function(u){if(this.isDestroyed()){if(this._dirtyFriendsListener){this._dirtyFriendsListener.destroy();this._dirtyFriendsListener=null}return}if(!u||!u.buddies){return}this._updateFriendsListCache()},_sessionListener_callback:function(u){if(this.isDestroyed()){if(this._sessionListener){this._sessionListener.destroy();this._sessionListener=null}return}this.startSearch()}});q.FoundUserListItem=f.ListViewItem.subclass({classname:"FoundUserListItem",_reuseId:"contacts.founduserlistitem",section:null,mode:null,initialize:function($super,u){if(!(u instanceof o.User)){throw new Error("User argument expected.")}this.user=u;this.user.ignored=false;this._cellProps=o.ListViewCellStyles.Generics.extras;this._requestSentStyle=o.ListViewCellStyles.InviteRequestSent;$super()},_onCreateView:function(){return new a()},_onReleaseView:function(u){if(u===undefined){return}if(this.cell==u){this.cell=null}u.icon.setImage("")},_onSetView:function(B){this.cell=B;B.setState(h.State.Normal);B.layoutSubviews();B.content.content.setTextCutOffOneLine(this.user.gamertag);B.content.middleLabel.setTextCutOffOneLine(this.user.getFullName());B.content.subtitle.setTextCutOffOneLine(this.user.motto,30);var y=this.user.getDefinedIcon();if(y){B.icon.setImage(y)}if(this.odd){B.markOdd()}else{B.markEven()}var x=B.accessoryButton;var u=B.accessoryButtonAlt1;if(x&&this.cell._addOldStyle){x.setImage(null);x.setTextInsets([0,0,0,0]);u.setImage(null);u.setTextInsets([0,0,0,0]);this.cell._addOldStyle.applyTo(x);this.cell._addOldStyle.applyTo(u);this.cell._addOldStyle=null}if(this.mode==="profile"){if(o.Session.getCurrentSession().user().isInviting(this.user)){this.cell.accessoryButton.setText(b("Accepting..."));this.cell.getAccessoryButtonView().setEnabled(false)}else{if(this.user.invited){this.cell.accessoryButton.setText(b("Accepted"));this.cell.getAccessoryButtonView().setEnabled(false)}else{if(this.user.ignored){this.cell.accessoryButton.setText(b("Ignored"));this.cell.getAccessoryButtonView().setEnabled(false)}else{this.cell.accessoryButton.setText(b("Accept"));this.cell.getAccessoryButtonView().setEnabled(true);this.activateAlt1Button(this.cell)}}}}else{if(this.user.isMutualFriend){this.cell.accessoryButton.setText(b("Already Friends!"));this.cell.getAccessoryButtonView().setEnabled(false)}else{if(o.Session.getCurrentSession().user().isInviting(this.user)){this.cell.accessoryButton.setText(b("Sending request..."));this.cell.getAccessoryButtonView().setEnabled(false)}else{if(this.user.invited){this.cell.accessoryButton.setText(b("Request sent"));this.cell.getAccessoryButtonView().setEnabled(false);if(x){var w=new h.ViewGeometry.Rect(x.getFrame());if(!w.isEmpty()){w.x-=w.w*this._requestSentStyle.extras.extensionRatio;w.w*=(1+this._requestSentStyle.extras.extensionRatio);x.setFrame(w);var v=this._requestSentStyle.extras.markRatio*w.w;var A=this._requestSentStyle.extras.marginRatio*w.w;x.setImage(o.Assets.image("request_sent_check.png"));x.setImageGravity(h.ViewGeometry.Gravity.Left);x.setImageInsets([0,w.w-v,0,0]);x.setTextInsets([0,0,0,v+A]);this.cell._addOldStyle=x.getStyle();this._requestSentStyle.applyTo(x)}}}else{this.cell.accessoryButton.setText(b("Add"));this.cell.getAccessoryButtonView().setEnabled(true)}}}}var z=new g(B.getFrame());B.accessoryButton.setOnClick(this.bind(this.accessoryClicked));B.setOnClick(this.bind(this.rowTapped));var C=z.h*this._cellProps.imageInsetRatio;B.setIconInset([C,C,C,C]);B.setAccessoryButtonInset([C,C,C,C])},activateAlt1Button:function(u){var x=new g(u.getFrame());var y=false;var w=this;this.cell.accessoryButtonAlt1.setText(b("Ignore"));u.accessoryButtonAlt1.setOnClick(this.bind(this.accessoryAlt1Clicked));u.accessoryButtonAlt1.setFrame(x.w,this.cell.getAccessoryButtonView().getFrame()[1],this.cell.getAccessoryButtonView().getFrame()[2],this.cell.getAccessoryButtonView().getFrame()[3]);u.setOnClickDown(this.bind(function(){w._isSwipingCell=false}));u.setOnSwipe(function(){if(w.user.invited||o.Session.getCurrentSession().user().isInviting(w.user)){return}var z=new h.ViewGeometry.Rect(u.getAccessoryButtonView().getFrame());if(y){z=new h.ViewGeometry.Rect(x.w,u.getAccessoryButtonView().getFrame()[1],u.getAccessoryButtonView().getFrame()[2],u.getAccessoryButtonView().getFrame()[3]);y=false}else{u.getAccessoryButtonAlt1View().setEnabled(true);y=true}h.animate(function(){u.accessoryButtonAlt1.setFrame(z)}.bind(this),200,function(){NgLogD("COMPLETE ANIM");if(!y){u.getAccessoryButtonAlt1View().setEnabled(false)}}.bind(this));w._isSwipingCell=true});var v=x.h*this._cellProps.imageInsetRatio;u.setAccessoryButtonAlt1Inset([v,v,v,v])},rowTapped:function(){if(this._isSwipingCell){return}j.pushScreen(o.ServiceHost.navController,"UserProfilePage",{user:this.user})},accessoryClicked:function(){if(o.Session.getCurrentSession().user().usesGuestLogin()){o.Credentials.showRegistration(null,true,true,"tiered",null,"addContact");return}if(this.user.invited||o.Session.getCurrentSession().user().isInviting(this.user)){return}this.user.inviting=true;if(this.cell){this._onSetView(this.cell)}o.Session.getCurrentSession().user().addBuddy(this.user,this.bind(function(u,v){NgLogD("Add buddy: "+u+" - "+JSON.stringify(v));if(u){o.UIUtils.showToast(u)}else{this.user.invited=true}if(this.cell){this._onSetView(this.cell)}}));if(this.cell){this._onSetView(this.cell)}},accessoryAlt1Clicked:function(){if(this.user.invited||o.Session.getCurrentSession().user().isInviting(this.user)){return}if(this.cell){this._onSetView(this.cell)}else{return}this.cell.accessoryButton.setText("");this.cell.getAccessoryButtonView().setEnabled(false);o.Session.getCurrentSession().user().ignoreBuddy(this.user,function(u,v){if(u){this.user.ignored=false}else{this.user.ignored=true;this.cell.accessoryButton.setText(b("Ignored"));this.cell.getAccessoryButtonView().setEnabled(false);this.cell.getAccessoryButtonAlt1View().setEnabled(false);this.cell.getAccessoryButtonAlt1View().release();if(this.cell){this._onSetView(this.cell)}}}.bind(this))}});q.AddAllUsersListItem=f.ListViewItem.subclass({classname:"AddAllUsersListItem",_reuseId:"contacts.addallusers",section:null,mode:null,initialize:function($super){$super()},_onCreateView:function(){return new m()},_onReleaseView:function(u){if(this.cell==u){this.cell=null}},_onSetView:function(u){this.cell=u;u.setState(h.State.Normal);u.layoutSubviews();u.accessoryButton.setOnClick(this.bind(this.accessoryClicked));var w=new g(u.getFrame());var v=w.h*u.getStyle().extras.imageInsetRatio;u.setAccessoryButtonInset([v,v,v,v])},accessoryClicked:function(){var u=this.section.getItems();for(var v=0;v<u.length;v++){if(u[v]==this){continue}u[v].accessoryClicked()}this.cell.accessoryButton.setEnabled(false)}});q.InviteUserListItem=f.ListViewItem.subclass({classname:"InviteUserListItem",_reuseId:"contacts.invitablelistitem",_cellProps:null,_mode:null,initialize:function($super,u,v){this.contact=u;this.emailIndex=v;this._cellProps=o.ListViewCellStyles.Generics.extras;this.contact.invited=o.SessionUtils.User.hasSentFriendInviteToEmail(this.contact.lowercaseEmails[this.emailIndex]);this._isFormShown=false;$super()},setFormShown:function(u){this._isFormShown=u},isFormShown:function(){return this._isFormShown},_onCreateView:function(){var u=new k();u.accessoryButton.setText(b("Invite"));return u},_onReleaseView:function(u){if(this.cell==u){this.cell=null}u.icon.setImage("")},_onSetView:function(u){this.cell=u;u.icon.setImage(o.Assets.image("no-user-icon.png"));u.setState(h.State.Normal);u.icon.setFrameSize([0,0]);u.layoutSubviews();u.content.content.setText(this.contact.displayName);var x="";if(this.contact.lowercaseEmails&&this.contact.lowercaseEmails.length&&this.contact.lowercaseEmails.length>this.emailIndex){x=this.contact.lowercaseEmails[this.emailIndex]}if(typeof this._invalidEmail==="undefined"){this._invalidEmail=!o.User.emailAddressLooksValid(x);if(x.length===0){this._invalidEmail=-1}}u.content.subtitle.setText(x);if(this.odd){u.markOdd()}else{u.markEven()}if(this.contact.inviting){this.cell.accessoryButton.setText(b("Inviting..."));this.cell.getAccessoryButtonView().setEnabled(false)}else{if(this.contact.invited){this.cell.accessoryButton.setText(b("Invited"));this.cell.getAccessoryButtonView().setEnabled(false)}else{this.cell.accessoryButton.setText(b("Invite"));this.cell.getAccessoryButtonView().setEnabled(true)}}u.accessoryButton.setOnClick(this.bind(this.accessoryClicked));var w=new g(u.getFrame());var v=w.h*this._cellProps.imageInsetRatio;u.setAccessoryButtonInset([v,v,v,v]);if(this.isFormShown()){u.enableForm(this)}else{u.disableForm()}},accessoryClicked:function(){var u=this;if(this.contact.invited||this.contact.inviting){return}if(this.contact.lowercaseEmails.length&&!this._invalidEmail){this.contact.inviting=true;o.SessionUtils.User.sendFriendInviteToEmailIfPossible(this.contact.lowercaseEmails[this.emailIndex],function(v,w){u.contact.inviting=false;if(v){o.UIUtils.showToast(v)}else{u.contact.invited=true}if(u.cell){u._onSetView(u.cell)}})}else{this.loge("Person with no e-mail address clicked, showing form");this.setFormShown(true);this.cell.showFormForItem(this)}}})}};__ngs._6i={_c:null,_d:function(){var d={exports:{}};var j=d.exports;this._c=d;var n=__ngs.r_(__ngs._7).Capabilities;var l=__ngs.r_(__ngs._w).MessageListener;var g=__ngs.r_(__ngs._59).UI;var a=new (__ngs.r_(__ngs._f).RequireLoader)({MobageStyle:function(){return __ngs.r_(__ngs._6k).MobageStyle},Assets:function(){return __ngs.r_(__ngs._2z).Assets},MBListViewSection:function(){return __ngs.r_(__ngs._79).MBListViewSection},PendingListSection:function(){return __ngs.r_(__ngs._9r).PendingListSection},DirectInviteSection:function(){return __ngs.r_(__ngs._a8).DirectInviteSection},ContactsController:function(){return __ngs.r_(__ngs._6h).ContactsController},User:function(){return __ngs.r_(__ngs._30).User},Session:function(){return __ngs.r_(__ngs._o).Session},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},ZeroCaseSection:function(){return __ngs.r_(__ngs._a4).ZeroCaseSection},SessionUtils:function(){return __ngs.r_(__ngs._ab).SessionUtils},ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells},LimitedEditText:function(){return __ngs.r_(__ngs._8f).LimitedEditText}});var h=__ngs.r_(__ngs._ae).Defines;var e=__ngs.r_(__ngs._2a).Destinations;var m=__ngs.r_(__ngs._77).Primitives;var k=__ngs.r_(__ngs._a3).ContentViewController;var p=__ngs.r_(__ngs._n).LocalizedString;var o=a.MobageStyle.ScaledTextSize;var f=g.ListViewItem.subclass({classname:"EmptyMessageSection_MessageItem",_reuseId:"EmptyMessageSection_MessageItem",initialize:function($super,q){$super();NgLogD("Initing MessageItem: "+q);this.setMessage(q)},_message:"",setMessage:function(q){this._message=q},_onCreateView:function(){return new g.CellView({style:a.ListViewCellStyles.EmptyMessageCell})},_onSetView:function(q){q.setTitle(this._message);q.setState(g.State.Normal)}});var c=a.MBListViewSection.subclass({classname:"EmptyMessageSection",initialize:function($super,s){$super();if(!this._items){this._items=[]}var r=[];for(var q=0;q<s.length;q++){r.push(new f(s[q]))}this.setItems(r);return this},destroy:function(){},calculateRowHeightForListView:function(q){if(!q){return}var s=new g.ViewGeometry.Rect(q.getFrame());if(s.isEmpty()){return}var r=s.h/6-5;this.setRowHeight(r);this.setRowHeightRatio(1/6)}});var b=j.UserSearchController=k.subclass({classname:"UserSearchController",analyticsName:"Search",scanState:null,initialize:function(){this.scanState=0;this._userSearchStyle=__ngs.r_(__ngs._a9).UserSearchHeader;this._dirtyFriendsListenerSetup();this._updateFriendsListCache();this._searchedForSelf=false},destroy:function(){if(this.directInviteSection){this.directInviteSection.release()}if(this.plusMatchSection){this.plusMatchSection.release()}if(this.pendingSection){this.pendingSection.release()}if(this.zeroCaseSection){this.zeroCaseSection.release()}},_userSearchStyle:null,titleHeaderView:null,footerView:null,allPlusUsers:null,pendingSection:null,plusMatchSection:null,directInviteSection:null,loadView:function($super){$super();NgLogD("UserSearchController: loadView");var r=this.view().getHeaderView();this.view()._headerHeightRatio=this._userSearchStyle.extras.headerHeightRatio;this.view().layoutSubviews();this.view()._headerHeightRatio*=1.35;var s=n.getScreenWidth();var q=new a.LimitedEditText("user_search");this.applyKeyboardWorkaround(q);r.setContentView(q);r.setFrameSize([100,100]);r.button.setFrameSize([s*this.view()._headerHeightRatio/1.8,20]);r.button.setOnClick(this.bind(function(){q.setEnabled(false);q.setEnabled(true);if(!q.ensureTextLegalBeforeSubmit()){return}this.scanState=a.ContactsController.ScanState.Beginning;this.startSearch()}));this._userSearchStyle.applyTo(r);NgLogD("UserSearchController: loadView finished.")},didActivateTab:function($super){$super();this.parentController.navController._host.hideLoadingLabel();setTimeout(this.bind(function(){if(!this.pendingSection){this.pendingSection=(new a.PendingListSection()).retain()}if(!this.plusMatchSection){this.plusMatchSection=(new a.MBListViewSection()).retain()}if(!this.directInviteSection){this.directInviteSection=(new a.DirectInviteSection()).retain()}if(!this.zeroCaseSection){this.zeroCaseSection=(new a.ZeroCaseSection()).retain()}}),50)},_dirtyFriendsListenerSetup:function(){var q=a.Session.getCurrentSession().user();var r=new l();q.addListener(r,this.zombieSafeCallback(function(s){if(!s||!s.buddies){return}this._updateFriendsListCache()},this.bind(function(s){q.removeListener(r);r.destroy()})))},_updateFriendsListCache:function(){if(this._friendsListCacheUpdateInProgress){return}this._friendsListCacheUpdateInProgress=true;var r=[];this._friendsListCacheReady=false;var q=a.Session.getCurrentSession().user();q.getFollowersList().forAll(this.zombieSafeCallback(function(t,s){r.push(s);t(true)}),this.zombieSafeCallback(function(v){this.loge("_updateFriendsListCache finished");this._friendsListCacheUpdateInProgress=false;if(v){this.scanState=a.ContactsController.ScanState.NotStarted;if(!this.pendingSection){return}this.pendingSection.showError(v,this.bind(function(){this._updateFriendsListCache();this.startSearch()}));return}this._outgoingRelationships=r;this._friendsListCacheReady=true;if(this.plusMatchSection&&this.plusMatchSection.getItems()&&!this.plusMatchSection.getItems().length){if(this._fuzzySearchScanFinished){this._resultsReady()}}else{var u;var s=(this.plusMatchSection&&this.plusMatchSection.getItems())?this.plusMatchSection.getItems():[];for(var t=0;t<s.length;t++){if((u=s[t])&&u.cell){u._onSetView(u.cell)}}}}))},startSearch:function(){var r;var t;switch(this.scanState){case a.ContactsController.ScanState.Done:break;case a.ContactsController.ScanState.NotStarted:this.logd("ContactsController.ScanState.NotStarted");break;case a.ContactsController.ScanState.Beginning:this.scanState=a.ContactsController.ScanState.InFlight;this.allPlusUsers=[];this._fuzzySearchScanFinished=false;this.view().getContentView().setScrollPosition(0,0);r=this.view().header.content.getText().replace(/^\s+|\s+$/g,"");r=(r)?r.toLowerCase():"";var v=a.Session.getCurrentSession().user();var u=v.emailAddress;var q=""+v.firstName+" "+v.lastName;if(r&&r!==""&&(r.toLowerCase()==v.gamertag.toLowerCase()||r.toLowerCase()==(u?u:"").toLowerCase()||r.toLowerCase()==q.toLowerCase())){this._searchedForSelf=true}else{this._searchedForSelf=false}r=r.replace(/^\s+|\s+$/g,"");a.User.findUsersWithFuzzySearch(r,this.zombieSafeCallback(this._scanFinishedFuzzySearch));if(r==undefined||r===null||r===""){return}t=r;if(r.length>=20){t=r.slice(0,17)}this.pendingSection.setPendingText(p("Searching for '%1s'...",t));if(this._pendingTimeoutId){clearTimeout(this._pendingTimeoutId);this._pendingTimeoutId=null}this._pendingTimeoutId=setTimeout(this.zombieSafeCallback(function(){this._pendingTimeoutId=null;this.pendingSection.showError(p("Sorry. We weren't able to complete your request.\nPlease check your network connection and try again."))}),30*1000);case a.ContactsController.ScanState.InFlight:this.logd("ContactsController.ScanState.InFlight");var s=this.view().getSections();if(!s||!s.length||s[0]!=this.pendingSection){this.view().setSections([this.pendingSection,this.directInviteSection])}break;default:break}NgLogD("ContactsController/startSearch end")},_scanFinishedFuzzySearch:function(q,r){this.scanState=a.ContactsController.ScanState.Done;if(q){NgLogE("Error~~~: "+JSON.stringify(q));this.scanState=a.ContactsController.ScanState.NotStarted;a.UIUtils.showToast(q);this.view().header.content.setText("");return}else{if(r&&r instanceof Array){this.allPlusUsers=this.allPlusUsers.concat(r.slice())}this._fuzzySearchScanFinished=true}if(this._friendsListCacheReady){this._resultsReady()}},_resultsReady:function(){this.scanState=a.ContactsController.ScanState.Done;if(this._pendingTimeoutId){clearTimeout(this._pendingTimeoutId);this._pendingTimeoutId=null}if(this.allPlusUsers.length===0){this._showNoResultsCase()}else{NgLogD("UserSearch/_resultsReady "+this.allPlusUsers.length+" "+this._outgoingRelationships.length);var u,r,q,s,t=[];q=[];for(r in this.allPlusUsers){if(this.allPlusUsers.hasOwnProperty(r)){u=this.allPlusUsers[r];if(!(u instanceof a.User)){NgLogE("Error: Expected imports.User reference, got "+typeof u)}else{NgLogD("Rec is a imports.User reference mutual? "+u.isMutualFriend+" curBuddy?"+this._outgoingRelationships.indexOf(u))}if(!u.isMutualFriend&&this._outgoingRelationships.indexOf(u)!=-1){u.invited=true}}}if((r=this.allPlusUsers.indexOf(a.Session.getCurrentSession().user()))!=-1){this.allPlusUsers.splice(r,1)}if(this.allPlusUsers.length===0){if(this._searchedForSelf){this._showVanitySearchCase()}else{this._showNoResultsCase()}return}this.allPlusUsers.sort(function(w,v){return(w.invited==v.invited)?0:(w.invited?1:-1)});for(r in this.allPlusUsers){if(this.allPlusUsers.hasOwnProperty(r)){u=this.allPlusUsers[r];q.push(new a.ContactsController.FoundUserListItem(u))}}for(s=0;s<q.length;s++){q[s].odd=(s)%2}this.plusMatchSection.setRowHeight(this.pendingSection.getRowHeight());this.plusMatchSection.setItems(q);if(q.length){t.push(this.plusMatchSection)}t.push(this.directInviteSection);if(t.length-1>=0){this.view().setSections(t)}else{this._showNoResultsCase()}}},_sendInvitationEmail:function(q){NgLogD("Attempting to invite: "+q);var r=false;if(a.SessionUtils.User.hasSentFriendInviteToEmail(q)){a.UIUtils.showToast(p("You've already sent an invite to that address!"))}else{a.SessionUtils.User.sendFriendInviteToEmailIfPossible(q,function(t,u){if(t&&u&&u.error==h.SERVER_ERRORCODE_MALFORMED_EMAIL){var s=new g.Toast({text:u.error_msg});s.ondisappear=function(){s.destroy()};s.show()}else{if(t){a.UIUtils.showToast(p("Please enter a valid email address."))}else{a.UIUtils.showToast(p("Email invite sent!"));r=true}}})}return r},_showVanitySearchCase:function(){NgLogD("_showVanitySearchCase");setTimeout(this.bind(function(){this.pendingSection.showError(p("We know, you are awesome."),function(){e.pushScreen(this.parentController.navController,"MyPage",{},this.parentController)}.bind(this));this.view().setSections([this.pendingSection,this.directInviteSection])}),1)},_showNoResultsCase:function(){setTimeout(this.bind(function(){var z=this.view().header.content.getText();var q=p("Sorry, we found no results matching %1s",z);this.pendingSection.showError(q);var u=a.User.emailAddressLooksValid(z);if(u){var t=q;var y=p("You may invite this person to Mobage by emailing an invite to %1s.",z);var v=p("Invite Sent");var w=p("A Mobage invitation email has been sent to %1s.",z);var x=p("Email Invite");var s=x;if(a.SessionUtils.User.hasSentFriendInviteToEmail(z)){this.zeroCaseSection.setZeroCaseTexts([v,w,s]);this.zeroCaseSection.setZeroCaseButtonEnabled(false)}else{this.zeroCaseSection.setZeroCaseTexts([t,y,x]);this.zeroCaseSection.setZeroCaseButtonEnabled(true);var r=this;this.zeroCaseSection.setZeroCaseButtonCallback(function(){r._sendInvitationEmail(z.replace(/^\s+|\s+$/g,""));r.zeroCaseSection.setZeroCaseTexts([v,w,s]);r.zeroCaseSection.setZeroCaseButtonEnabled(true)})}this.view().setSections([this.zeroCaseSection,this.directInviteSection])}else{this.view().setSections([this.pendingSection,this.directInviteSection])}}),1);NgLogD("No Results Case")}})}};__ngs._6j={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var e={};e.Style=__ngs.r_(__ngs._60).Style;var a=e.Style.ScaledCorners;var d=e.Style.ScaledTextSize;__ngs.r_(__ngs._9u);e.Style.sheet("social.us.credentials",{parent:"social.us.commonelements",title:{textFont:e.Style.defaultBoldFontFace,textSize:d(22),textColor:"FFFFFFFF",textGravity:[0,1],textShadow:"CC000000 1.0 {0.0,-2.0}"},subtitle:{textFont:e.Style.defaultBoldFontFace,textSize:d(18),textColor:"FFEDEDED",textGravity:[0.5,1]},inputLabel:{textFont:e.Style.defaultRegularFontFace,textSize:d(17),textColor:"FFFFFFFF",textGravity:[0,1]},inputLabelMinor:{textFont:e.Style.defaultRegularFontFace,textSize:d(12),textColor:"FFBBBBBB",textGravity:[1,1]}});e.Style.sheet("social.us.login",{parent:"social.us.credentials",forgotPwdButton:{gradient:{corners:a(6),gradient:["FFA1B2C2 0.000","FF788A99 1.000"],outerLine:"FF000000 2.0",innerLine:"44BBC7D3 2.0"},gradientPressed:{corners:a(6),gradient:["FFA0A0A0 0.000","FF7C7C7C 1.000"],outerLine:"FF000000 2.0",innerLine:"44FFFFFF 2.0"},textFont:e.Style.defaultBoldFontFace,textSize:d(16),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}});e.Style.sheet("social.us.forgotpassword",{parent:"social.us.credentials",subtitle:{textFont:e.Style.defaultRegularFontFace,textSize:d(14),textColor:"FFFFFFFF",textGravity:[0,0.5]}});e.Style.sheet("social.us.registration",{parent:"social.us.credentials",title:{textFont:e.Style.defaultBoldFontFace,textSize:d(22),textColor:"FFFFFFFF",textGravity:[0,0.5],textShadow:"CC000000 1.0 {0.0,-2.0}"},stepsAreaBackground:{gradient:{gradient:["FFA1B2C2 0.000","FF788A99 1.000"]}},stepHilitedGradient:["FFFFA0A0 0.000","FFFF7C7C 1.000"],stepNormalGradient:["FFA0A0A0 0.000","FF7C7C7C 1.000"],termsText:{textFont:e.Style.defaultRegularFontFace,textSize:d(12),textColor:"FFFFFFFF",textGravity:[0.5,0]},termsLink:{textFont:e.Style.defaultBoldFontFace,textSize:d(12),textColor:"FF85CEF0",textGravity:[0.5,0]},updatesLabel:{textFont:e.Style.defaultRegularFontFace,textSize:d(14),textColor:"FFFFFFFF",textGravity:[0,0.5]},genderRadioGradients:{normal:{outerShadow:"0000 0.0 {0.0,0.0}",insets:"{0.0,0.0,0.0,0.0}",corners:"6.0 6.0 6.0 6.0",innerShadow:"FF7A7E80 7.0 {0.0,-4.0}",gradient:["FFC7 0.000","FFFF 1.000"]},checked:{outerShadow:"0000 1.0 {0.0,0.0}",insets:"{1.0,0.0,0.0,0.0}",corners:"6.0 6.0 6.0 6.0",innerShadow:"FF00 0.0 {0.0,0.0}",gradient:["FF73D100 0.000","FF6FB023 1.000"]}},genderButtonLabel:{textFont:e.Style.defaultBoldFontFace,textSize:d(14),textColor:"FFFFFFFF",textGravity:[0,0.5]},avatarButtonFrame:{gradient:{corners:a(6),outerLine:"F999 2.0",gradient:["F000 0.0"]},pressedGradient:{corners:a(6),outerLine:"F999 2.0",gradient:["FFFF 0.0"]}},avatarButtonWithImage:{imageBorder:{corners:a(6),outerLine:"F999 2.0",innerLine:"6000 2.0"}},avatarPlaceholder:{gradient:{corners:a(6),gradient:["FF5AB0E2 0.000","FF2B76BC 1.000"],innerLine:"4484C3E9 2.0"},imageBorder:{insets:"{6.0,6.0,6.0,6.0}"}}});e.Style.sheet("social.us.registration.header",{parent:"social.us.credentials",stepLabel:{textFont:e.Style.defaultBoldFontFace,textSize:d(12),textColor:"FFFFFFFF",textGravity:[0.5,0.5],gradient:{gradient:["3FFF 0.000"],outerLine:"F000 1.0"}},stepHilitedGradient:{gradient:["FF43AA12 0.000","FF2E8411 1.0"],outerLine:"F000 1.0"},stepsAreaBackground:{gradient:{corners:a(6),outerLine:"F000 2.0",gradient:["0000 0.000"]}}})}};__ngs._6k={_c:null,_d:function(){var d={exports:{}};var g=d.exports;this._c=d;var e=__ngs.r_(__ngs._59).UI;var k=__ngs.r_(__ngs._7).Capabilities;var b=__ngs.r_(__ngs._9j).Color;var f=__ngs.r_(__ngs._9l).DynamicTextSize;var h=__ngs.r_(__ngs._9m).ProportionalCorners;var c=__ngs.r_(__ngs._9n).FontCascade;var a=g.MobageStyle=e.Style.subclass({classname:"MobageStyle",OddState:131072,PromoState:262144,ErrorState:65536,$lazyLoad:function(n,l,m){n.__defineGetter__(l,function(){delete n[l];return n[l]=new a(m())})},initialize:function($super,m){if(m){$super(m.style);if(m.children){for(var l in m.children){if(!(m.children[l] instanceof a)){m.children[l]=new a(m.children[l])}}this.children=m.children}this.extras=m.extras}else{$super()}},applyTo:function(l){if(l.setStyle){l.setStyle(this)}for(var m in this.children){var n=this.children[m];if(l[m]){n.applyTo(l[m])}}},toString:function(){return"<MobageStyle>"}});a.bindPropertyState("gradient","odd",a.OddState);a.bindPropertyState("gradient","pressedOdd",e.State.Pressed|a.OddState);a.bindPropertyState("gradient","promo",a.PromoState);a.bindPropertyState("gradient","pressedPromo",e.State.Pressed|a.PromoState);a.bindPropertyState("gradient","error",a.ErrorState);a.bindPropertyState("textColor","error",a.ErrorState);a.bindPropertyState("textColor","promo",a.PromoState);a.bindPropertyState("gradient","focused",e.State.Focused);a.bindPropertyState("gradient","selected",e.State.Selected);a.bindPropertyState("gradient","checked",e.State.Checked);a.bindPropertyState("gradient","pressedChecked",e.State.Pressed|e.State.Checked);a.bindPropertyState("image","promo",a.PromoState);a.bindPropertyState("textSize","disabled",e.State.Disabled);a.ScaledCorners=function(l){if(!l){return new h()}if(l instanceof String||l instanceof h||l instanceof Array){return new h(l)}return(new h(Array.prototype.slice.call(arguments))).realize()};a.ScaledTextSize=function(l){return(new f(l)).realize()};if(k.meetsBinaryVersion&&!k.meetsBinaryVersion("1.3.6")){a.prototype._applyTo=a.prototype.applyTo;a.prototype.applyTo=function(l){this._applyTo(l);if(this.getTextSize()&&l.setTextSize){l.setTextSize(this.getTextSize())}if(this.getTitleSize()&&l.setTitleSize){l.setTitleSize(this.getTitleSize())}if(this.getTextShadow()&&l.setTextShadow){l.setTextShadow(this.getTextShadow())}if(this.getTitleShadow()&&l.setTitleShadow){l.setTitleShadow(this.getTitleShadow())}}}var j=function(l,m){a.__defineGetter__(l,function(){delete a[l];console.log("MobageStyle: Lazy Font Loading",l);return a[l]=m.realize()})};j("defaultRegularFontFace",c.defaultRegularFontFace);j("defaultBoldFontFace",c.defaultBoldFontFace);j("defaultItalicFontFace",c.defaultItalicFontFace);j("defaultBoldItalicFontFace",c.defaultBoldItalicFontFace)}};__ngs._6l={_c:null,_d:function(){var f={exports:{}};var g=f.exports;this._c=f;var e=__ngs.r_(__ngs._t);var d=__ngs.r_(__ngs._28);var j=__ngs.r_(__ngs._30);var k=__ngs.r_(__ngs._1s).SHA1;var c=__ngs.r_(__ngs._o);var l=__ngs.r_(__ngs._7).Capabilities;var m=__ngs.r_(__ngs._n).LocalizedString;var a=new (__ngs.r_(__ngs._f).RequireLoader)({NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils}});function b(n){this.__value__=n||"";this.regErrorLength=this.__value__.length;this.field=null}b.prototype=new String;b.prototype.toString=function(){return this.__value__};b.prototype.toJSON=b.prototype.toString;b.prototype.valueOf=b.prototype.toString;var h=e.Class.subclass({classname:"RegistrationRecord",gamername:null,password:null,email:null,birthdate:null,gender:null,firstName:null,lastName:null,motto:null,profileImage:null,profileURLString:null,userRecord:null,optIn:false,lite:false,alternateGamernames:null,isUnderage:function(){var n=this.getAge();return(n<14)},getAge:function(){if(!this.birthdate){return -1}var n=new Date();var q=n.getYear();var r=n.getMonth()+1;var p=this.birthdate.getYear();var s=this.birthdate.getMonth()+1;var o=q-p;if(r<s){o-=1}else{if(r==s&&this.birthdate.getDate()<n.getDate()){o-=1}}return o},createUser:function(n){n=n||d.PlusRequest.noOp;var o=this;NgLogD("Creating user from registration record");this.testInformationForCreation(function(v){if(v&&v.regErrorLength>0){n(v,null)}else{NgLogD("Preparing to send user registration request");var q=c.Session.getCurrentSession()._loginParameters();var u={age_restricted:(o.isUnderage()?1:0)};if(o.social_type){var t={social_type:o.social_type,social_id:o.social_id,social_token:o.social_token};q.social_account=t}else{u.password=o.password;u.password_confirmation=o.password}if(o.social_photo_url){u.social_photo_url=o.social_photo_url}if(!o.lite){NgLogD("Populating nonlite data");u.gamertag=o.gamername;u.email=o.email.replace(/^\s+|\s+$/g,"");u.motto=o.motto?o.motto:"";u.first_name=o.firstName?o.firstName:"";u.last_name=o.lastName?o.lastName:"";u.birth_date=""+o.birthdate.getFullYear()+"-"+(o.birthdate.getMonth()+1)+"-"+o.birthdate.getDay();u.opt_in=(o.optIn?1:0);var p="";try{p=l.getBinaryDistributionName();if(!p){p=l.getDistributionName()}}catch(r){p=l.getDistributionName()}if(p&&p.length>0){u.distribution_name=p}}else{NgLogD("Populating lite data");u.lite=1}q.user=u;NgLogD("Got login data");var s=new d.PlusRequest();s.setHttpMethod("POST");s.setApiMethod("users");s.setPostBody(q);NgLogD("Sending registration request for user: "+JSON.stringify(q));s.send(function(x,y,z,w){c.Session.getCurrentSession()._handleLoginResponse(x,y,z,w,function(A,B){n((A?[A]:null),B)})})}});return null},testBasicInformation:function(n){n=n||d.PlusRequest.noOp;this._performTests([this.testLocalGamername,this.testLocalGamernameForIllegalNames,this.testLocalPassword,this.testRemoteGamername],n)},testInformationForCreation:function(n){n=n||d.PlusRequest.noOp;this._performTests([this.testLocalGamername,this.testLocalGamernameForIllegalNames,this.testLocalPassword,this.testLocalEmail,this.testRemoteEmail,this.testRemoteGamername],n)},testBatchChangesForFinalization:function(n){n=n||d.PlusRequest.noOp;this._performTests([this.testUnderageRequirements],n)},_performTests:function(q,n){n=n||d.PlusRequest.noOp;var o=this;var r=[];var p=function(s){if(s){r.push(s)}if(q.length>0){var t=q.shift();t.call(o,p)}else{if(r.regErrorLength>0){NgLogD("Registration tests errored: "+JSON.stringify(r))}else{NgLogD("Registration: No errors!")}n(r)}};p()},testLocalGamername:function(n){n=n||d.PlusRequest.noOp;var o=null;if(!this.gamername){o=new b(m("Please enter a Mobage name."))}else{if(this.gamername.length<3){o=new b(m("Oops! Mobage name must be at least 3 characters."))}else{if(this.gamername.length>15){o=new b(m("Oops! Mobage name can't be more than 15 characters."))}else{if(/^[0-9]/i.test(this.gamername)){o=new b(m("Oops! Mobage name cannot start with a number."))}else{if(!(/^[a-z\:\-\;\(\)][a-z0-9\:\-\;\(\)]+$/i.test(this.gamername))){o=new b(m("Oops! Please don't use spaces or special characters."))}}}}}if(o){o.field="gamername"}n(o)},testLocalGamernameForIllegalNames:function(n){n=n||d.PlusRequest.noOp;if(!this.gamername){n(null);return}var o=null;var p=this.gamername.match(/(mobage|ngmoco)/i);if(p!==null){o=new b("Oops! Your Mobage name can't contain \""+p[0]+'"! ')}if(o){o.field="gamername"}n(o)},testLocalPassword:function(o,n){if(typeof o=="function"){n=o;o=false}n=n||d.PlusRequest.noOp;if(this.social_type){n(null);return}var p=null;if(!this.password){p=new b(m("Please enter a password."))}else{if(this.password.indexOf(" ")>-1){p=new b(m("Password cannot contain spaces."))}else{if(o&&this.password.length<4){p=new b(m("Password must be at least 4 characters."))}else{if(!o&&this.password.length<8){p=new b(m("Password must be at least 8 characters."))}else{if(this.password.length>25){p=new b(m("Password can't be more than 25 characters."))}}}}}if(p){p.field="password"}n(p)},testLocalEmail:function(n){n=n||d.PlusRequest.noOp;var o=null;if(!this.email){o=new b(m("Please enter an email address."))}else{if(j.User.emailAddressLooksValid(this.email)===false){o=new b(m("Please enter a valid email address."))}}if(o){o.field="email"}n(o)},testRemoteEmail:function(n){n=n||d.PlusRequest.noOp;if(!this.email){var o=new b(m("You must enter an email address."));o.field="email";n(o);return}var p=new d.PlusRequest();p.setApiMethod("users/validate");p.setPostBody({field:j.User.EmailAddressKey,value:this.email.replace(/^\s+|\s+$/g,"")});p.setHttpMethod("POST");p.send(function(r,s){var q=null;if((s&&!s.success)){q=new b(s.error_msg);NgLogD("testRemoteEmail ERR: "+JSON.stringify(s.error_msg));q.field="email"}else{if(r){q=new b(r);NgLogD("testRemoteEmail ERR: "+JSON.stringify(r));q.field="email"}}n(q,s)})},testRemoteGamername:function(n){n=n||d.PlusRequest.noOp;if(!this.gamername){var p=new b(m("Please enter a Mobage name."));p.field="gamername";n(p);return}var o=this;var q=new d.PlusRequest();q.setApiMethod("users/validate");NgLogD("testRemoteGamername: "+this.gamername);q.setPostBody({field:j.User.GamertagKey,value:this.gamername});q.setHttpMethod("POST");q.send(function(t,u){o.alternateGamernames=[];var s=(u&&u.suggestions?u.suggestions:[]);for(var r=0;r<s.length;r++){o.alternateGamernames.push(s[r]);NgLogD("name suggestions: "+s[r])}if(t||(u&&!u.success)){p=new b(u?u.error_msg:t);p.field="gamername"}n(p,o.alternateGamernames)})},testLocalAge:function(n){n=n||d.PlusRequest.noOp;var p=null;if(typeof this.birthMonth==="undefined"||typeof this.birthYear==="undefined"||this.birthMonth.toString().length>2||this.birthYear.toString().length!==4||this.birthMonth===""||this.birthYear===""||this.birthYear<1800||this.birthMonth.indexOf(".")!==-1||this.birthMonth.indexOf(",")!==-1||this.birthYear.indexOf(".")!==-1||this.birthYear.indexOf(",")!==-1){p=new b(m("Please enter a valid birth date."));p.field="birthdate"}else{if((this.birthMonth<1||this.birthMonth>12)){p=new b(m("Please enter a valid birth date."));p.field="birthdate"}else{var o=this.getAge();if(isNaN(o)||o<2||o>160){p=new b(m("Please enter a valid birth date."));p.field="birthdate"}else{if(o<14){p=new b(m("Sorry, you must be at least 14 years old to enter Mobage."));p.field="birthdate"}}}}n(p)},testUnderageRequirements:function(n){n=n||d.PlusRequest.noOp;if(this.isUnderage()){this.optIn=false;this.lastName=""}n(null)}});h.createLiteUser=function(n){n=n||d.PlusRequest.noOp;var o=new h();o.lite=true;o.password=k.b64_sha1(a.NetworkUtils.getDeviceIdForPlatformServer()).substr(0,24);o.createUser(n);return null};g.RegistrationRecord=h}};__ngs._6m={_c:null,_d:function(){var d={exports:{}};var k=d.exports;this._c=d;var m=__ngs.r_(__ngs._5).Core;var f=__ngs.r_(__ngs._59).UI;var b=new (__ngs.r_(__ngs._f).RequireLoader)({OldStyle:function(){return __ngs.r_(__ngs._60).Style},Assets:function(){return __ngs.r_(__ngs._2z).Assets},Session:function(){return __ngs.r_(__ngs._o).Session},Game:function(){return __ngs.r_(__ngs._2e).Game},MobageBootAB:function(){return __ngs.r_(__ngs._6o).MobageBootAB},FullScreenshotController:function(){return __ngs.r_(__ngs._af).FullScreenshotController},GameDownloadBar:function(){return __ngs.r_(__ngs._ag).GameDownloadBar},GameDownloadButton:function(){return __ngs.r_(__ngs._a6).GameDownloadButton},UserButton:function(){return __ngs.r_(__ngs._ah).UserButton},CCView:function(){return __ngs.r_(__ngs._ai).CCView},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},Layout:function(){return __ngs.r_(__ngs._aj).Layout},GameProfile:function(){return __ngs.r_(__ngs._ak).GameProfile},ScreenThumb:function(){return __ngs.r_(__ngs._ak).ScreenThumb}});var l=__ngs.r_(__ngs._a3).ContentViewController;var e=__ngs.r_(__ngs._2a).Destinations;var n=__ngs.r_(__ngs._n).LocalizedString;var j=__ngs.r_(__ngs._9h);var a=j.Composite;var h=j.CompositeLayoutGroup;var o=__ngs.r_(__ngs._a6).GameDownloadButton;var c=__ngs.r_(__ngs._a3).compareArrays;var g=k.GameProfileController=l.subclass({classname:"GameProfileController",analyticsName:"GameProfile",initialize:function($super,p,q){$super();if(!p){NgLogE("GameProfileController cannot be initialized without a game");return}this._game=p;if(this._game instanceof b.Game&&!this._game.isLaunchable()){this._product=q}if(this._game.description){this._gameDescription=this._game.description.replace(/\r\n/g,"\n").replace(/\n\n/g,"\n\u00A0\n")}else{this._gameDescription=""}this._sheet=b.OldStyle.registeredStyle("social.us.gameprofile").props();this._style=b.GameProfile;this._totalWidth=m.Capabilities.getScreenHeight();this._totalHeight=m.Capabilities.getScreenWidth();this._showingWholeInfoArea=false;this._showingWholeFriendArea=false;this._friendButtons=new Array();this._totalGameDescLines=this._style.extras.viewRatio.gameDescLinesDefault;this._totalGameDescHeight=1;this._gameDescLineHeight=1;this._isSuggestedFriends=false;this._friendsCache=new Array()},destroy:function(){if(this._loadingSection){this._loadingSection.release();this._loadingSection=null}this.clearFriendList(false);this._cleanViews()},xSize:function(p){return(p/800)*this._totalWidth},ySize:function(p){return(p/480)*this._totalHeight},infoAreaX:function(p){var q=this._style.extras.viewRatio;return this.xSize(p-q.infoAreaXRatio)},infoAreaY:function(p){var q=this._style.extras.viewRatio;return this.ySize(p-q.infoAreaYRatio)},friendAreaX:function(p){var q=this._style.extras.viewRatio;return this.xSize(p-q.friendAreaXRatio)},friendAreaY:function(p){var q=this._style.extras.viewRatio;return this.ySize(p-q.friendAreaYRatio)},screenshotAreaX:function(p){var q=this._style.extras.viewRatio;return this.xSize(p-q.screenshotAreaXRatio)},screenshotAreaY:function(p){var q=this._style.extras.viewRatio;return this.ySize(p-q.screenshotAreaYRatio)},bottomAreaX:function(p){var q=this._style.extras.viewRatio;return this.xSize(p-q.bottomAreaXRatio)},bottomAreaY:function(p){var q=this._style.extras.viewRatio;return this.ySize(p-q.bottomAreaYRatio)},loadView:function($super){NgLogD("GameProfileController: loadView");this.setView(new b.CCView());$super();this.view()._headerHeightRatio=0},_setupContent:function(){this._cleanViews();this._infoArea=this.retainView(new f.View());this._gameIcon=this.retainView(new f.Image());this._gameName=this.retainView(new f.Label());this._gamePublisher=this.retainView(new f.Label());this._downloadBar=this.retainView(new b.GameDownloadBar());this._promoLabel=this.retainView(new f.Label());this._promoDesc=this.retainView(new f.Label());this._gameDesc=this.retainView(new f.Label());this._readMore=this.retainView(new b.UnspammableButton());this._friendArea=this.retainView(new f.View());this._friendCountLabel=this.retainView(new f.Label());this._showMore=this.retainView(new b.UnspammableButton());this._screenshotArea=this.retainView(new f.View());this._screenshotsHeader=this.retainView(new f.Label());this._bottomArea=this.retainView(new f.View());this._support=this.retainView(new b.UnspammableButton());this._style.applyTo(this);this._scrollView=this.view().getContentView();var z=this;var E=this._style.extras.viewRatio;var t=this.getInfoAreaHeight();var u=this.getFriendAreaHeight();var O=this.getScreenshotAreaHeight();var v=this.getBottomAreaHeight();this._gameIcon.setFrame([this.infoAreaX(E.gameIconXRatio),this.infoAreaY(E.gameIconYRatio),this.xSize(E.gameIconWidthRatio),this.ySize(E.gameIconHeightRatio)]);this._gameIcon.setImage(this._game.getDefinedIcon());this._infoArea.addChild(this._gameIcon);this._gameName.setText(this._game.name);this._gameName.setFrame([this.infoAreaX(E.gameNameXRatio),this.infoAreaY(E.gameNameYRatio),this.xSize(E.gameNameWidthRatio),this.ySize(E.gameNameHeightRatio)]);this._gameName.setTextGravity(f.ViewGeometry.Gravity.Left);this._infoArea.addChild(this._gameName);this._gamePublisher.setText(this._game.publisher);this._gamePublisher.setFrame([this.infoAreaX(E.gamePublisherXRatio),this.infoAreaY(E.gamePublisherYRatio),this.xSize(E.gamePublisherWidthRatio),this.ySize(E.gamePublisherHeightRatio)]);this._gamePublisher.setTextGravity(f.ViewGeometry.Gravity.Left);this._infoArea.addChild(this._gamePublisher);var x=this.infoAreaX(E.downloadBarXRatio);var y=this.xSize(E.downloadBarWidthRatio);var B=this.infoAreaX(E.downloadBarRRatio);if(x<B-y){x=B-y}var I=b.GameDownloadButton.TimeLabelHeight;this._downloadBar.setFrame([x,this.infoAreaY(E.downloadBarYRatio)-I*0.5,y,this.ySize(E.downloadBarHeightRatio)+I]);this._downloadBar.setGame(this._game,this._product);this._downloadBar.initLayout();this._infoArea.addChild(this._downloadBar);this._downloadBar.addGoToAppStoreListener(this.goToAppStoreListener);if(this._product){this._promoLabel.setText(this._product.getPromoLabel());this._promoLabel.setFrame([this.infoAreaX(E.promoLabelXRatio),this.infoAreaY(E.promoLabelYRatio),this.xSize(E.promoLabelWidthRatio),this.ySize(E.promoLabelHeightRatio)]);this._promoLabel.setTextGravity(f.ViewGeometry.Gravity.Left);this._infoArea.addChild(this._promoLabel);this._promoDesc.setText(this._product.getPromoDescription());this._promoDesc.setFrame([this.infoAreaX(E.promoDescXRatio),this.infoAreaY(E.promoDescYRatio),this.xSize(E.promoDescWidthRatio),this.ySize(E.promoDescHeightRatio)]);this._promoDesc.setTextGravity(f.ViewGeometry.Gravity.TopLeft);this._infoArea.addChild(this._promoDesc)}this._calculateGameDescriptionMetrics(function(){this._gameDesc.setText(this._gameDescription);this._gameDesc.setFrame([this.infoAreaX(E.gameDescXRatio),this.infoAreaY(this._product?E.gameDescPromoYRatio:E.gameDescYRatio),this.xSize(E.gameDescWidthRatio),this.getCurrentGameDescHeight()]);this._gameDesc.setTextGravity(f.ViewGeometry.Gravity.TopLeft);this._infoArea.addChild(this._gameDesc);if(this._hasExpandableGameDesc()||this._product){var T=this.xSize(E.readMoreWidthRatio);var R=this.ySize(E.readMoreHeightRatio);var Q=this.xSize(E.readMoreImageWidthRatio);var r=T-Q;var S=this.xSize(E.readMoreTextInsetRatio);t=this.getInfoAreaHeight();this._readMore.setFrame([b.Layout.getPositionInContainer(E.readMoreAlignH,E.readMoreGravityH,T,this.view().getContentWidth()),t-this.ySize(E.readMoreYRatio),T,R]);this._readMore.setText(this.getReadMoreText());this._readMore.setTextGravity(f.ViewGeometry.Gravity.Right);this._readMore.setTextInsets([0,S,0,0]);this._readMore.setImage(this.getReadMoreImage());this._readMore.setImageGravity(f.ViewGeometry.Gravity.Right);this._readMore.setImageInsets([0,0,0,r]);this._readMore.setTextColor("FF000000",f.State.Pressed);this._readMore.onclick=function(){z.toggleInfoAreaHeight()};this._infoArea.addChild(this._readMore)}}.bind(this));this._scrollView.addChild(this._infoArea);this._friendCountLabel.setFrame([this.friendAreaX(E.friendCountLabelXRatio),this.friendAreaY(E.friendCountLabelYRatio),this.xSize(E.friendCountLabelWidthRatio),this.ySize(E.friendCountLabelHeightRatio)]);this._friendCountLabel.setTextGravity(f.ViewGeometry.Gravity.Left);this._friendArea.addChild(this._friendCountLabel);var q=this.xSize(E.showMoreWidthRatio);var K=this.ySize(E.showMoreHeightRatio);var p=this.xSize(E.showMoreImageWidthRatio);var D=q-p;var s=this.xSize(E.showMoreTextInsetRatio);this._showMore.setFrame([b.Layout.getPositionInContainer(E.showMoreAlignH,E.showMoreGravityH,q,this.view().getContentWidth()),u-this.ySize(E.showMoreYRatio),q,K]);this._showMore.setText(this.getShowMoreText());this._showMore.setTextGravity(f.ViewGeometry.Gravity.Right);this._showMore.setTextInsets([0,s,0,0]);this._showMore.setImage(this.getShowMoreImage());this._showMore.setImageGravity(f.ViewGeometry.Gravity.Right);this._showMore.setImageInsets([0,0,0,D]);this._showMore.setTextColor("FF000000",f.State.Pressed);this._showMore.onclick=function(){z.toggleFriendAreaHeight()};this._screenshotsHeader.setFrame([this.screenshotAreaX(E.screenshotsHeaderXRatio),this.screenshotAreaY(E.screenshotsHeaderYRatio),this.xSize(E.screenshotsHeaderWidthRatio),this.ySize(E.screenshotsHeaderHeightRatio)]);var M=this.getNumScreenshots();this._screenshotsHeader.setText(M==1?n("1 Screenshot"):n("%1d Screenshots",M));this._screenshotsHeader.setTextGravity(f.ViewGeometry.Gravity.Left);this._screenshotArea.addChild(this._screenshotsHeader);var P=this.getNumScreenshots();var w=E.maxScreenshotsPerRow;for(var J=0;J<P;J++){var F=J%w;var A=Math.floor(J/w);var C=this.screenshotAreaX(E.screenThumbXRatio)+F*this.xSize(E.screenThumbWidthRatio+E.screenThumbXMarginRatio);var G=this.screenshotAreaY(E.screenThumbYRatio)+A*this.ySize(E.screenThumbHeightRatio+E.screenThumbYMarginRatio);var H=this.getThumbnail(J);var L=this.retainView(new b.UnspammableButton());L.setImage(b.Assets.image("no-game-icon.png"));L.setFrame([C,G,this.xSize(E.screenThumbWidthRatio),this.ySize(E.screenThumbHeightRatio)]);b.ScreenThumb.applyTo(L);L.setImage(H);var N=this._game.phone_screenshot_urls;L.onclick=(function(Q,r){return function(){this.parentController.navController.pushViewController(new b.FullScreenshotController(Q,r))}.bind(this)}.bind(this))(z._game,J);this._screenshotArea.addChild(L)}this._scrollView.addChild(this._screenshotArea);this._support.setFrame([this.bottomAreaX(E.supportXRatio),this.bottomAreaY(E.supportYRatio),this.xSize(E.supportWidthRatio),this.ySize(E.supportHeightRatio)]);this._support.setText(n("Support"));this._support.setTextGravity(f.ViewGeometry.Gravity.Center);this._support.onclick=function(){e.pushScreen(this.parentController.navController,"SupportWebScreen",{},this)}.bind(this);this._bottomArea.addChild(this._support);this._scrollView.addChild(this._bottomArea);this.friendCountChanged();this.updateAreaFrames();this.loadFriends()},startLoadingProgess:function(){},stopLoadingProgress:function(){},willActivateTab:function($super){$super();NgLogD("GameProfileController willActivateTab "+this.parentController);setTimeout(this.bind(function(){$super();this._setupContent()}),50);if(o.TimeLabelHeight==0){o.measureTimeLabelHeight()}},didActivateTab:function($super){$super()},toggleInfoAreaHeight:function(){var s=this._style.extras.viewRatio;if(this._infoArea){this._showingWholeInfoArea=!this._showingWholeInfoArea;this.updateAreaFrames();if(this._readMore){var q=new f.ViewGeometry.Rect(this._readMore.getFrame());if(!q.isEmpty()){q.y=this.getInfoAreaHeight()-this.ySize(s.readMoreYRatio);this._readMore.setFrame(q)}this._readMore.setText(this.getReadMoreText());this._readMore.setImage(this.getReadMoreImage())}if(this._gameDesc){var p=new f.ViewGeometry.Rect(this._gameDesc.getFrame());p.h=this.getCurrentGameDescHeight();this._gameDesc.setFrame(p)}if(!this._showingWholeInfoArea){this.view().getContentView().setScrollPosition([0,0])}}},_calculateGameDescriptionMetrics:function(p){var s=this._style.extras.viewRatio;var q=Math.floor(this.xSize(s.gameDescWidthRatio));f.measureText(this._gameDescription,q,10000,this._gameDesc.getStyle().getTextFont(),this._gameDesc.getStyle().getTextSize(),function(r){this._totalGameDescLines=r.lineWidths.length;this._totalGameDescHeight=r.height;this._gameDescLineHeight=r.height/this._totalGameDescLines;if(p){p()}}.bind(this))},toggleFriendAreaHeight:function(){if(this._friendArea){this._showingWholeFriendArea=!this._showingWholeFriendArea;if(this._showMore){this._showMore.setText(this.getShowMoreText());this._showMore.setImage(this.getShowMoreImage())}var p=this.getMaxFriendsToShow();for(var r=0;r<this._friendButtons.length;r++){var q=this._friendButtons[r];if(r<p){if(!q.getParent()){this._friendArea.addChild(q)}}else{if(q.getParent()){q.removeFromParent()}}}this.updateFriendAreaHeight();if(!this._showingWholeFriendArea){this.view().getContentView().setScrollPosition([0,0])}}},friendCountChanged:function(){var p=this._style.extras.viewRatio;if(this._friendCountLabel){if(this._isSuggestedFriends){this._friendCountLabel.setText(this._friendButtons.length==1?n("1 suggested friend"):n("%1d suggested friends",this._friendButtons.length))}else{this._friendCountLabel.setText(this._friendButtons.length==1?n("1 friend plays this game"):n("%1d friends play this game",this._friendButtons.length))}}if(this._friendArea&&this._showMore){var q=p.maxFriendsPerRow;if(this._friendButtons.length>q){if(!this._showMore.getParent()){this._friendArea.addChild(this._showMore)}}else{if(this._showMore.getParent()){this._showMore.removeFromParent()}}}if(this._scrollView&&this._friendArea){if(this._friendButtons.length>0){if(!this._friendArea.getParent()){this._scrollView.addChild(this._friendArea)}}else{if(this._friendArea.getParent()){this._friendArea.removeFromParent()}}}},updateFriendAreaHeight:function(){var q=this._style.extras.viewRatio;this.parentController.navController._host.hideLoadingLabel();this.updateAreaFrames();if(this._showMore){var p=new f.ViewGeometry.Rect(this._showMore.getFrame());if(!p.isEmpty()){p.y=this.getFriendAreaHeight()-this.ySize(q.showMoreYRatio);this._showMore.setFrame(p)}}},loadFriends:function(){this._isSuggestedFriends=false;var u=b.Session.getCurrentSession();var s=new Array();var v;if(u){var p=u.user();if(p){if(this._friendsCache.length>0){this.clearFriendList();var q=this._friendsCache;for(var r in q){this.addFriendToList(q[r])}}var t=this;p.getFriendsListForGame(this._game).forAll(function(y,w,x){clearTimeout(v);s.push(w);y(s.length<t.getMaxFriendsToLoad());if(s.length==t._sheet.maxFriendsPerRow){v=setTimeout(t.zombieSafeCallback(function(){this._fillFriendsList(s)}),"50")}},this.zombieSafeCallback(function(w){if((typeof w)!=="undefined"){this._showErrorAlertDialog(w)}else{if(s.length===0){this.loadSuggestedFriends()}else{this._fillFriendsList(s)}}}))}else{this.loge("Requires Current User!")}}else{this.loge("Requires Session!")}},_fillFriendsList:function(s){this.clearFriendList();if(s.length===0){this.loadSuggestedFriends()}else{if(!c(s,this._friendsCache,this.compareFriendsArray)){for(var r in s){this.addFriendToList(s[r])}this._friendsCache=s}else{var q=this._friendsCache;for(var p in q){this.addFriendToList(q[p])}}}},_showErrorAlertDialog:function(q){var p=(new f.AlertDialog()).retain();p.setTitle(n("Error"));p.setText(n("Error accessing system.  Please try again later. Error: %1s",q));p.setChoices([n("OK")]);p.onchoice=function(r){p.release();p=null};p.show()},loadSuggestedFriends:function(){this._isSuggestedFriends=true;this.clearFriendList();var q=this;var r=b.Session.getCurrentSession();if(r){var p=r.user();if(p){p.getFeaturedUsersList().forAll(function(u,s,t){if(q._friendButtons.length<q.getMaxSuggestedFriendsToLoad()){q.addFriendToList(s);u(true)}else{u(false)}},function(s){if((typeof s)!=="undefined"){q._showErrorAlertDialog(s)}})}}},addFriendToList:function(t){var p=this._style.extras.viewRatio;if(t){var x=p.maxFriendsPerRow;var u=this._friendButtons.length;var A=u%x;var y=Math.floor(u/x);var z=this.xSize(p.friendButtonWidthRatio);var w=this.ySize(p.friendButtonHeightRatio);var v=this.friendAreaX(p.friendButtonXRatio)+A*(z+this.xSize(p.friendButtonXMarginRatio));var q=this.friendAreaY(p.friendButtonYRatio)+y*(w+this.ySize(p.friendButtonYMarginRatio));var s=(new b.UserButton(t)).retain();s.setUserButtonFrame([v,q,z,w]);this._friendButtons.push(s);this.friendCountChanged();if(this._friendArea&&u<this.getMaxFriendsToShow()){this._friendArea.addChild(s);if(A===0){this.updateFriendAreaHeight()}}NgLogD("GameProfileController: added friend "+t.gamertag+" to list")}},clearFriendList:function(r){if(this._friendButtons){for(var q=0;q<this._friendButtons.length;q++){var p=this._friendButtons[q];if(p){if(p.getParent()){p.removeFromParent()}p.release()}}}this._friendButtons=new Array();if(r===undefined||r){this.friendCountChanged()}},updateAreaFrames:function(){var q=this.view().getContentWidth();var t=this.getInfoAreaHeight();var u=this.getFriendAreaHeight();var p=this.getScreenshotAreaHeight();var s=(this.ySize(this._style.extras.viewRatio.bottomAreaHeightRatio));var r=u;if(this._friendArea){if(!this._friendArea.getParent()){r=0}}if(this._infoArea){this._infoArea.setFrame([0,0,q,t])}if(this._friendArea){this._friendArea.setFrame([0,t,q,u])}if(this._screenshotArea){this._screenshotArea.setFrame([0,t+r,q,p])}if(this._bottomArea){this._bottomArea.setFrame([0,t+r+p,q,s])}if(this._scrollView){this._scrollView.setContentSize(q,t+r+p+s)}},getInfoAreaHeight:function(){var p=this._style.extras.viewRatio;return(this.ySize(p.infoAreaHeightRatio)+this.getInfoAreaExtraHeight())},getFriendAreaHeight:function(){var s=this._style.extras.viewRatio;var t=0;for(var q=0;q<this._friendButtons.length;q++){if(this._friendButtons[q].getParent()){t++}else{break}}var p=this.ySize(s.friendAreaHeightRatio);var u=Math.ceil(t/s.maxFriendsPerRow);p+=u*this.ySize(s.friendButtonHeightRatio)+(u-1)*this.ySize(s.friendButtonYMarginRatio);return p},getScreenshotAreaHeight:function(){var t=this._style.extras.viewRatio;var p=this.ySize(t.screenshotAreaHeightRatio);var s=t.maxScreenshotsPerRow;var q=this.getNumScreenshots();var u=Math.ceil(q/s);p+=u*this.ySize(t.screenThumbHeightRatio)+(u-1)*this.ySize(t.screenThumbYMarginRatio);return p},getBottomAreaHeight:function(){var p=this._style.extras.viewRatio;return this.ySize(p.bottomAreaHeightRatio)},_hasExpandableGameDesc:function(){var p=this._style.extras.viewRatio;return this._totalGameDescLines>p.gameDescLinesDefault},getCurrentGameDescHeight:function(){var q=this._style.extras.viewRatio;var p=this._product?0:q.gameDescLinesDefault*this._gameDescLineHeight;return this._showingWholeInfoArea?this._totalGameDescHeight:p},getPromoInfoHeight:function(){var p=this._style.extras.viewRatio;return this._product?this.ySize(p.gameDescPromoYRatio-p.promoLabelYRatio):0},getInfoAreaExtraHeight:function(){var p=this._style.extras.viewRatio;return Math.max(0,this.getPromoInfoHeight()+this.getCurrentGameDescHeight()-(p.gameDescLinesDefault*this._gameDescLineHeight))},getReadMoreText:function(){if(this._showingWholeInfoArea){return n("Hide")}return n("Read More")},getReadMoreImage:function(){if(this._showingWholeInfoArea){return b.Assets.image("show_less_arrow.png")}return b.Assets.image("show_more_arrow.png")},getShowMoreText:function(){if(this._showingWholeFriendArea){return n("Hide")}return n("Show More")},getShowMoreImage:function(){if(this._showingWholeFriendArea){return b.Assets.image("show_less_arrow.png")}return b.Assets.image("show_more_arrow.png")},getMaxFriendsToLoad:function(){return 100},getMaxSuggestedFriendsToLoad:function(){return 20},getMaxFriendsToShow:function(){var p=this._style.extras.viewRatio;if(this._showingWholeFriendArea){return this.getMaxFriendsToLoad()}return p.maxFriendsPerRow},getNumScreenshots:function(){if(!this._game.phone_screenshot_urls){return 0}return this._game.phone_screenshot_urls.length},getThumbnail:function(p){if((this._game.phone_thumbnail_urls)&&(p<this._game.phone_thumbnail_urls.length)){if(this._game.phone_thumbnail_urls[p].length>0){return this._game.phone_thumbnail_urls[p]}}return this._game.phone_screenshot_urls[p]},compareFriendsArray:function(q,p){return q==p},goToAppStoreListener:function(){var q=this._game;var s=this._product;var r=b.MobageBootAB.getProp("GameCarouselTransition","directToMarket");var t=b.Session.getCurrentSession();var p={screen:"gameinfo",carousel_transition:(r)?"direct":"gameinfo",current_appkey:(t)?t.appKey():"",appkey:q.recordID,is_featured:q.featured,is_incented:Boolean(s),campaign_id:(s&&s.campaign)?s.campaign.recordID:"",incent_amt:(s&&s.hasOwnProperty("mobacoin"))?s.mobacoin:0};p.featured_slotnum=-1;p.list_slotnum=-1;m.Analytics.reportGameEvent("GameClick",p)}})}};__ngs._6n={_c:null,_d:function(){var d={exports:{}};var f=d.exports;this._c=d;var g=__ngs.r_(__ngs._5).Core;var c=__ngs.r_(__ngs._4).Device;var e=__ngs.r_(__ngs._59).UI;var a=new (__ngs.r_(__ngs._2b).InterfaceLoader)({PlusRequest:function(){return __ngs.r_(__ngs._28).PlusRequest},DataModel:function(){return __ngs.r_(__ngs._3h).DataModel},Session:function(){return __ngs.r_(__ngs._o).Session},CpiProductsList:function(){return __ngs.r_(__ngs._51).CpiProductsList}});var j=__ngs.r_(__ngs._n).LocalizedString;var h=f.CpiProduct=a.DataModel.subclass({classname:"CpiProduct",initialize:function($super,k){$super(k)},loadData:function(l){this.productId=l.id||this.productId||0;this.offerId=l.offer_id||this.offerId||null;this.appKey=l.app_key||this.appKey||null;this.mobacoin=l.mobacoin||this.mobacoin||0;this.clickUrl=l.click_url||this.clickUrl||null;this.promotionalImage=l.promotion_image_url||this.promotionalImage||null;this.storeUrl=l.store_url||this.storeUrl||null;var k=b.getCampaignWithData(l.campaign);this.campaign=k||this.campaign||null},isValid:function(){return true},getPromoLabel:function(){return j("Get %1d FREE Mobacoin!",this.mobacoin)},getPromoDescription:function(){return j("Download, Log in and Play!")},getEndsAt:function(){if(!this._endsAt){this._endsAt=new Date(this.campaign.endsAt*1000)}return this._endsAt},acceptOffer:function(){var l=new e.ProgressDialog({text:"Please Wait..."});l.show();var k=this;var m=new a.PlusRequest();var n=this.clickUrl.substring(this.clickUrl.indexOf("cpi/"));m.setApiMethod(n);m.setHttpMethod("GET");m.send(function(p,t,u,o){l.hide();var r=o-o%100;if(r!=200){return}if(!k.storeUrl){return}if(g.Capabilities.getPlatformOS().toLowerCase()==="iphone os"){c.IPCEmitter.launch(k.storeUrl)}else{var s=k.storeUrl;if(g.Capabilities.getBinaryDistributionName()=="mobagegamehub-gs2"){var q="?id=";s="samsungapps://ProductDetail/"+s.substring(s.indexOf(q)+q.length)}NgLogD("storeUrl: "+s);c.IPCEmitter.launchIntent(s)}})}});h.getCpiProductWithData=function(m){if(!m){return undefined}var k=m.app_key;if(!k){return undefined}var l=a.Session.getCurrentSession().dataCache().getObjectWithRecordID(h.classname,k);if(!l){l=new h(k)}if(l.loadData){l.loadData(m)}return l};h._products={};h._productList=[];h._service=null;h.getProducts=function(){return this._products};h.getProductList=function(){return this._productList};h.loadProducts=function(k){if(!this._service){this._service=new a.CpiProductsList()}this._products={};this._productList=[];this._service.forAll(function(m,n,l){this._productList.push(n);m(true)}.bind(this),function(l){k()}.bind(this))};var b=f.Campaign=a.DataModel.subclass({classname:"Campaign",initialize:function($super,k){$super(k)},loadData:function(k){this.name=k.name||this.name||null;this.startsAt=k.starts_at||this.startsAt||0;this.endsAt=k.ends_at||this.endsAt||0;this.expiresAt=k.expires_at||this.expiresAt||0},isValid:function(){return true}});b.getCampaignWithData=function(l){if(!l){return undefined}var k=l.id;if(!k){return undefined}var m=a.Session.getCurrentSession().dataCache().getObjectWithRecordID(b.classname,k);if(!m){m=new b(k)}if(m.loadData){m.loadData(l)}return m}}};__ngs._6o={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._2l).AB;a.MobageBootAB={_value:{},getProp:function(){var e=arguments;if(e.length==0){return null}var h=this._value;for(var g=0,d=e.length;g<d;++g){var f=e[g];if(!h.hasOwnProperty(f)){return null}h=h[f]}return h},loadProp:function(d){c.getMobageBootVariants(function(e){if(typeof e==="object"){this._value=e}d()})}}}};__ngs._6p={_c:null,_d:function(){var e={exports:{}};var a=e.exports;this._c=e;var f=__ngs.r_(__ngs._59).UI;var c=__ngs.r_(__ngs._2z).Assets;var d=__ngs.r_(__ngs._2v);var b=__ngs.r_(__ngs._68);a.HomeScreenButton=f.CellView.subclass({classname:"HomeScreenButton",button:null,buttonIcon:null,buttonTextMajor:null,buttonTextCount:null,initialize:function($super,g){$super(g);this.buttonIcon=(new f.Image()).retain();this.buttonTextMajor=(new f.Label()).retain();this.buttonTextCount=(new f.Label()).retain();this.buttonTextBadge=(new f.Label()).retain();this.buttonBadge=(new f.Image()).retain();this.buttonIcon.setTouchable(false);this.buttonTextMajor.setTouchable(false);this.buttonTextCount.setTouchable(false);this.buttonBadge.setTouchable(false)},destroy:function(){this.buttonIcon.release();this.buttonTextMajor.release();this.buttonTextCount.release();this.buttonTextBadge.release();this.buttonBadge.release()},setMainText:function(g){this.buttonTextMajor.setText(g)},setCountText:function(g){this.buttonBadge.setImage("");this.buttonTextBadge.setText("");this.buttonTextCount.setText(g);this.buttonBadge.setVisible(false)},setBadgeCount:function(g){this.buttonBadge.setVisible(true);this.buttonBadge.setImage(c.image("mobageverticaltab_jumpbutton_invitesbubble.png"));var h=new f.ViewGeometry.Rect(this._badgeRect);h.x+=this._badgeRect.w/8;this.buttonTextCount.setText("");this.buttonTextBadge.setFrame(h);this.buttonTextBadge.setText(g)},performEventCallback:function($super,g){if(g.eventType=="click"){if(!b.getSpamProtectionLockForName("default").acquire()){return}}if($super){$super(g)}},layoutSubviews:function($super){var k=new f.ViewGeometry.Rect(this.getFrame());k.x=0;k.y=0;this._elementsRect=k;var g=k.sliceHorizontal(k.w*this.getStyle().extras.buttonIconWidthPct);g.x=g.w/2;g.y=g.h/2;g.w=g.h<g.w?g.h:g.w;g.h=g.w;g.x-=g.w/2;g.y-=g.w/2;this._iconRect=g;var h=new f.ViewGeometry.Rect(g);h.x=k.w;h.x-=h.w/5;this._badgeRect=h;var l=new f.ViewGeometry.Rect(this.getFrame());l.x=0;l.y=0;var j=l.sliceHorizontal(l.w*this.getStyle().extras.buttonBadgeWidthPct);j.x=j.w/2;j.y=j.h/2;j.w=j.h<j.w?j.h:j.w;j.h=j.w;j.x-=j.w/4;j.y-=j.w/2;this.buttonIcon.setFrame(j);this.buttonTextMajor.setFrame(k);this.buttonTextCount.setFrame(k);this.buttonBadge.setFrame(h);this.addChild(this.buttonIcon);this.addChild(this.buttonTextMajor);this.addChild(this.buttonBadge);this.addChild(this.buttonTextBadge);this.addChild(this.buttonTextCount)}})}};__ngs._6q={_c:null,_d:function(){var d={exports:{}};var a=d.exports;this._c=d;var f=__ngs.r_(__ngs._5).Core;var e=__ngs.r_(__ngs._59).UI;var c=__ngs.r_(__ngs._60).Style;var b=__ngs.r_(__ngs._al).CornerButton;a.HomeScreenScrollView=e.View.subclass({classname:"HomeScreenScrollView",cornerButton:null,titleText:null,list:null,_listItems:null,_lastManualScroll:null,_isAutoscrolling:false,_stopAutoscrolling:false,initialize:function($super,g){$super(g);this._listItems=[];this.cornerButton=(new b()).retain();this.list=(new e.ScrollView()).retain();this.addChild(this.list);this.addChild(this.cornerButton)},destroy:function(){this.stopAutoscrolling();this._releaseListItems();this.cornerButton.release();this.list.release()},startAutoscrolling:function(){this._stopAutoscrolling=false;this._startAutoscrolling()},_startAutoscrolling:function(){var k=this.list;if(!k||!k.setScrollIndicatorsVisible){return}if(this._isAutoscrolling){return}var h=this;var l=k.getFrame();var g=k.getContentSize();var j=(g?g[0]:0)-(l?l[2]:0);if(j<=0||(this._lastManualScroll&&(new Date()).getTime()-this._lastManualScroll.getTime()<2000)){setTimeout(function(){h._startAutoscrolling()},100);return}this._isAutoscrolling=true;k.setScrollPosition(0,0);e.animate(function(m){m.animationCurve="Linear";k.setScrollPosition(j,0)},(j-k.getScrollPosition()[0])*35,function(m){h._isAutoscrolling=false;if(h._stopAutoscrolling){NgLogD("[HomeScreenScrollView] Autoscroll stopped because user left home screen.")}else{h._startAutoscrolling()}})},stopAutoscrolling:function(){this._stopAutoscrolling=true},setButton:function(g,h){this.cornerButton.setButton(g,h)},setTitle:function(g){},_releaseListItems:function(){console.log("--- HomeScreenScrollView._releaseListItems ----");NgLogD("HomeScreenScrollView: Releasing "+this._listItems.length+" items.");for(var g=0;g<this._listItems.length;g++){this.removeChild(this._listItems[g]);this._listItems[g].release()}},setListViews:function(m,l){console.log("--- HomeScreenScrollView.setListViews ----");this._releaseListItems();this._listItems=[];var p=new e.ViewGeometry.Rect(this.getFrame());var q=new e.ViewGeometry.Rect(this.list.getFrame());var o=m.length;var j=q.h;var n=j;var g=o*n;this.list.setContentSize([g,Math.floor(q.h)]);this.list.setScrollIndicatorsVisible(false);this.list.setOnScroll(this.bind(function(){this._lastManualScroll=new Date()}));for(var h=0;h<o;h++){var k=m[h];k.setFrame([h*n,0,n,j]);if(l){l(k)}this._listItems[h]=k;this.list.addChild(k)}},setData:function(g){},layoutSubviews:function($super){if(!this._style){return}var g=new e.ViewGeometry.Rect(this.getFrame());g.w=Math.ceil(g.w);this.setFrameSize([g.w,g.h]);g.x=0;g.y=0;if(this._style.extras.cornerButtonHeight<0){var j=(this.getParent()&&this.getParent().getFrame())?this.getParent().getFrame()[3]:-1;if(j<0){return}this._style.extras.cornerButtonHeight=this._style.extras.headerHeightRatio*j}var h=new e.ViewGeometry.Rect(g);h.h=this._style.extras.cornerButtonHeight;var l=h.sliceHorizontal(-this._style.extras.cornerButtonWidthRatio*h.w);l.x=Math.floor(l.x);l.w=Math.ceil(l.w);this.cornerButton.setFrame(l);var k=g;this.list.setFrame(k)}})}};__ngs._6r={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var f=__ngs.r_(__ngs._5).Core;var e=__ngs.r_(__ngs._59).UI;var d=__ngs.r_(__ngs._77).Primitives;var a=new (__ngs.r_(__ngs._f).RequireLoader)({CornerButton:function(){return __ngs.r_(__ngs._al).CornerButton},GameCarouselImageStyle:function(){return __ngs.r_(__ngs._6w).GameCarouselImage},Assets:function(){return __ngs.r_(__ngs._2z).Assets}});b.GameCarousel=d.View.subclass({classname:"GameCarousel",_scrollView:null,cornerButton:null,_onGameClick:null,_isSwipingOverlayButton:false,_isAnimating:false,_selectedGameIndex:0,initialize:function($super,g){$super(g);this._style=__ngs.r_(__ngs._am).Carousel;this._scrollView=(new d.ScrollView()).retain();this.cornerButton=(new a.CornerButton()).retain();this._promoImageView={};this._products=[];this._overlayButton=(new e.Button()).retain();this._overlayButton.setOnClickDown(this.bind(function(){this._isSwipingOverlayButton=false}));this._overlayButton.setOnClick(this.bind(function(){if(this._isSwipingOverlayButton){return}var h=this.selectedGame();this._onGameClick(h)}));this._overlayButton.setOnSwipe(this.bind(function(j){this._isSwipingOverlayButton=true;if(this._isAnimating){return}var k=(j?j.direction:undefined);var h=!!this._autoscrollTimer;if(h){this.stopAutoscrolling()}switch(k){case 1:this.scrollToNextGame();break;case 2:this.scrollToPreviousGame();break}if(h){this.startAutoscrolling()}}));this.addChild(this._scrollView);this.addChild(this._overlayButton);this.addChild(this.cornerButton);this._style.applyTo(this)},destroy:function(){this.stopAutoscrolling();this.setGames([]);this._scrollView.release();this.cornerButton.release();this._overlayButton.release()},setOnGameClick:function(g){this._onGameClick=g},setCornerButton:function(g,h){this.cornerButton.setButton(g,h)},selectedGame:function(){var g=this.selectedGameIndex();return this._products.length>g?this._products[g]:this._products[0]},selectedGameIndex:function(){return this._selectedGameIndex},getFeaturedSlotNum:function(k){for(var h=0,g=this._products.length;h<g;++h){var j=this._products[h];if(j.appKey==k){return h}}return -1},_imageViewForGame:function(j){var h=(new e.Image()).retain();a.GameCarouselImageStyle.applyTo(h);var g=this;(function(l,k){k.setOnClick(function(){if(g._onGameClick){g._onGameClick(l)}})})(j,h);return h},setGames:function(h){var m=this._products;var k={};var j;for(j=0;j<h.length;j++){k[h[j].appKey]=1}var o=h.slice();if(o.length>1){o.push(o[0]);k.duped=1}this._products=o;var n;var p;for(j=0;j<m.length;j++){p=m[j];n=(1<m.length&&j==m.length-1)?"duped":p.appKey;var l=this._promoImageView[n];if(l&&!(n in k)){l.release();delete this._promoImageView[n]}}for(j=0;j<this._products.length;j++){p=this._products[j];if(!p.localPromotionalImage){continue}n=(1<this._products.length&&j==this._products.length-1)?"duped":p.appKey;if(!this._promoImageView.hasOwnProperty(n)){this._promoImageView[n]=this._imageViewForGame(p)}var g=this._promoImageView[n];g.setImage(a.Assets.privSandboxPath()+p.localPromotionalImage);this._scrollView.addChild(g)}this.layoutSubviews()},layoutSubviews:function($super){$super();if(!this.getFrame()){return}var l=new e.ViewGeometry.Rect(this.getFrame());l.w=Math.ceil(l.w);this.setFrameSize([l.w,l.h]);var q=new e.ViewGeometry.Rect(0,0,l.w,l.h);this._scrollView.setFrame(q);this._overlayButton.setFrame(q);if(!this._products){return}var g=l.w;var o;for(var m=0;m<this._products.length;m++){o=(1<this._products.length&&m==this._products.length-1)?"duped":this._products[m].appKey;var k=this._promoImageView[o];var p=new e.ViewGeometry.Rect([Math.floor(g*m),0,Math.floor(g),Math.floor(l.h)]);k.setFrame(p)}this._scrollView.setContentSize([g*this._products.length,Math.floor(l.h)]);if(this._scrollView.setScrollIndicatorsVisible){this._scrollView.setScrollIndicatorsVisible(false)}l=new e.ViewGeometry.Rect(this.getFrame());l.x=0;l.y=0;if(this._style.extras.cornerButtonHeight<0){var n=(this.getParent()&&this.getParent().getFrame())?this.getParent().getFrame()[3]:-1;if(n<0){return}this._style.extras.cornerButtonHeight=this._style.extras.headerHeightRatio*n}var j=new e.ViewGeometry.Rect(l);j.h=this._style.extras.cornerButtonHeight;var h=j.sliceHorizontal(-this.getStyle().extras.cornerButtonWidthRatio*j.w);h.x=Math.floor(h.x);h.w=Math.ceil(h.w);this.cornerButton.setFrame(h)},_easeOutAtPercentage:function(g){return(1-Math.cos(Math.PI*g))/2},hasGame:function(g){return(g in this._promoImageView)},scrollToGame:function(k){for(var h=0,g=this._products.length;h<g;++h){var j=this._products[h];if(j.appKey==k){this.scrollToGameAtIndex(h,true);return}}},scrollToPreviousGame:function(){this.scrollToGameAtIndex(this.selectedGameIndex()-1)},scrollToNextGame:function(){this.scrollToGameAtIndex(this.selectedGameIndex()+1)},scrollToGameAtIndex:function(k,j){if(this._products.length<=1){return}var n=this._scrollView.getFrame();var h=n[2];var m=j?0:750;if(k==this._products.length){k=1;this._scrollView.setScrollPosition(0,0)}else{if(k<0){k=this._products.length-2;this._scrollView.setScrollPosition((this._products.length-1)*h,0)}}var g=this._scrollView;this._isAnimating=true;var l=this;this._selectedGameIndex=k;e.animate(function(){NgLogD("TRYING TO ANIMATE CAROUSEL: "+k+" * "+h);g.setScrollPosition(k*h,0)},m,function(){NgLogD("Finished Animation");l._isAnimating=false})},startAutoscrolling:function(){this._shouldAnimate=true;if(!this._autoscrollTimer){var g=this._autoscrollTimer=setInterval((function(){NgLogI("GameCarousel Autoscroll Timer = "+g);this.scrollToNextGame()}).bind(this),5000)}},stopAutoscrolling:function(){this._shouldAnimate=false;if(this._autoscrollTimer){clearInterval(this._autoscrollTimer);this._autoscrollTimer=null}this._scrollView.clearAnimations()}})}};__ngs._6s={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var f=__ngs.r_(__ngs._59).UI;var b=__ngs.r_(__ngs._5l).UnspammableButton;var c=new (__ngs.r_(__ngs._f).RequireLoader)({Assets:function(){return __ngs.r_(__ngs._2z).Assets},UserPicImageStyle:function(){return __ngs.r_(__ngs._6w).UserPicImage},MobageStyle:function(){return __ngs.r_(__ngs._6k).MobageStyle}});var a=d.UserPicNameView=f.View.subclass({classname:"UserPicNameView",userIconSmall:null,userNameButton:null,initialize:function($super,g){$super(g);this.userNameButton=(new b()).retain();this.userIconOverlay=(new b()).retain();this.userIconSmall=(new f.Image()).retain();this.userIconSmall.setImage(c.Assets.image("no-user-icon.png"));this.userBadgeIcon=(new f.Image()).retain();this.userBadgeText=(new f.Label()).retain();this.userBadgeIcon.setTouchable(false);this.userBadgeText.setTouchable(false);this.userIconSmall.setTouchable(false);c.UserPicImageStyle.applyTo(this.userIconOverlay);this.userBadgeIcon.setImage(c.Assets.image("mobageverticaltab_jumpbutton_invitesbubble.png"))},destroy:function(){this.userNameButton.release();this.userIconOverlay.release();this.userIconSmall.release();this.userBadgeIcon.release();this.userBadgeText.release()},setUserInfo:function(g,p,n){this.userIconSmall.setImage(c.Assets.image("no-user-icon.png"));this.userIconSmall.setImage(p);this.userNameButton.setText(g);if(a.userNameButtonCalcedTextSize==-1){var m={15:0.46,14:0.52,13:0.56,12:0.62,11:0.68,10:0.73,9:0.82,8:0.88,7:0.94};var h=g.length;var q=this.userNameButton.getStyle().getTextSize()*m[(h>15)?15:((h<7)?7:h)];var l=1;a.userNameButtonCalcedTextSize=q*l;this.userNameButton.setTextSize(a.userNameButtonCalcedTextSize);var o=this.userNameButton.getFrame()[2];var k=this.userNameButton.getStyle().getTextFont();var j=function(){f.measureText(g,o,1000,k,q*l,function(r){if(this._destroyed){return}if(r.lineWidths.length==1){a.userNameButtonCalcedTextSize=q*l;this.userNameButton.setTextSize(a.userNameButtonCalcedTextSize)}else{l-=0.1;j()}}.bind(this))}.bind(this);j()}else{this.userNameButton.setTextSize(a.userNameButtonCalcedTextSize)}this.setBadgeCount(n)},setBadgeCount:function(h){var g=h;if(h>99){g="99+"}if(h>0){this.userBadgeText.setText(g);if(!this._showingBadge){f.animate(function(){this.addChild(this.userBadgeIcon);this.addChild(this.userBadgeText)}.bind(this),250,function(){});this._showingBadge=true}}else{if(this._showingBadge){f.animate(function(){this.userBadgeIcon.removeFromParent();this.userBadgeText.removeFromParent()}.bind(this),250,function(){});this._showingBadge=false}}},setClickCallback:function(g){this.userNameButton.onclick=g;this.userIconOverlay.onclick=g},layoutSubviews:function(){var j=new f.ViewGeometry.Rect(this.getFrame());j.x=0;j.y=0;this.userIconSmall.setFrame(j.sliceHorizontal(j.h));this.userIconOverlay.setFrame(this.userIconSmall.getFrame());j.inset(0,0,0,2);this.userNameButton.setFrame(j);var h=new f.ViewGeometry.Rect(this.getFrame());var g=0.3*h.h;h.y=0;h.w=h.h+g;h.x=this.getFrame()[2]-h.w;h.y+=h.h*0.1;h.h-=h.h*0.2;this.userBadgeIcon.setFrame(h);this.userBadgeText.setFrame(h);var k=[0,0,0,g];this.userBadgeText.setTextInsets(k);this.addChild(this.userIconSmall);this.addChild(this.userNameButton);this.addChild(this.userIconOverlay)}});a.userNameButtonCalcedTextSize=-1}};__ngs._6t={_c:null,_d:function(){var a={exports:{}};var s=a.exports;this._c=a;var g=__ngs.r_(__ngs._59).UI;var f=g.ViewGeometry.Rect;var d=g.ViewGeometry.Scale;var p=new (__ngs.r_(__ngs._f).RequireLoader)({CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton}});var e=__ngs.r_(__ngs._2z).Assets;var c=__ngs.r_(__ngs._77).Primitives;var l=__ngs.r_(__ngs._an).ImageLabel;var j=__ngs.r_(__ngs._9i);var r=j.Components;var m=j.Component;var o=j.ComponentInheritForKey;var q=__ngs.r_(__ngs._9h).Composite;var h=__ngs.r_(__ngs._ao).CompositeButton;s.HomeGameIconView=g.View.subclass({iconImage:null,iconCaption:null,iconImageSizePct:1,initialize:function($super,t){$super(t);this.iconImage=(new p.UnspammableButton()).retain();this.iconCaption=(new g.Label()).retain()},destroy:function(){this.iconImage.release();this.iconCaption.release()},setClickCallback:function(t){this.iconImage.onclick=t},setGame:function(w,v,t){var u=e.image("app-default.png");if(!t&&(!w||w=="/images/app-default.png")){w=u}else{this.iconImage.setImage(u)}this.iconImage.setImage(w);this.iconCaption.setText(v)},layoutSubviews:function($super){var v=new g.ViewGeometry.Rect(this.getFrame());v.x=0;v.y=0;var u=v.sliceVertical(v.h*(1-this.getStyle().extras.captionHeightPct));u.w=u.h<u.w?u.h:u.w;u.h=u.w;u.x-=u.w/2;u.y-=u.w/2;var w=u.w*0.1;u.inset(w,w,0,w);u=new g.ViewGeometry.Rect(this.getFrame());u.x=0;u.y=0;var t=[0.02*u.h,0,0.25*u.h,0];this.iconImage.setImageInsets(t);this.iconImage.setFrame(u);this.iconCaption.setFrame(v);this.addChild(this.iconImage);this.addChild(this.iconCaption)},setIconImageSizePct:function(t){this.iconImageSizePct=t}});var n=s.GameIconView=l.subclass({classname:"GameIconView",$Component:m(r.View,o(r.Image,"icon"),{initializeViewWithKey:function(t){this[t]=(new n()).retain()}}),initialize:function($super,t){$super(t);p.CommonElements.GameIconView.applyTo(this);return this},setGame:function(t){this.setImage(null);if(t){var u=t.iconURL;if(u&&u!="/images/app-default.png"){this.setImage(u)}}}});var b=r.Layouts.TwoVerticalGenerator("content","label").layoutSubviews;var k=s.LabeledGameIconButton=q({key:"content",altKey:"image",component:n.Component,disableViewAccessorRemapping:true},{key:"label",component:r.Label},r.AddOrders.Generator("content","label"),{classname:"LabeledGameIconView",initialize:function($super,t){$super(t);p.CommonElements.LabeledGameIconButton.applyTo(this);return this},setImage:function(t){this.content.setImage(t)},setText:function(t){if(!t){t=""}if(t.length>9){t=t.slice(0,8)+"…"}this.label.setText(t)},setGame:function(t){this._game=t;this.content.setGame(t);this.setText((t?t.name:""))},layoutSubviews:function(){var u=new f(this.getFrame());if(u.isEmpty()){return}u.x=u.y=0;var v=u.h*p.CommonElements.LabeledGameIconButton.extras.labelHeightRatio;var t=u.h*p.CommonElements.LabeledGameIconButton.extras.imageInsetRatio;this.label.setFrameSize([u.w,v]);b.apply(this)}},h)}};__ngs._6u={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var d=__ngs.r_(__ngs._5).Core;var c=__ngs.r_(__ngs._5o).Balance;a.Currency=d.Class.singleton({classname:"Currency",_name:null,_iconUrl:null,_waitingOnData:true,initialize:function(){},load:function(e){if(this._waitingOnData){NgLogD("Currency data is not ready in the cache yet...");this.callRemoteServer(e)}else{NgLogD("Loading currency data from the cache...");e(null,this.getName(),this.getIconUrl())}},destory:function(){this._name.release();this._iconUrl.release();this._waitingOnData.release()},callRemoteServer:function(e){NgLogD("Trying to get the currency information from the remote server.");c.get(this.bind(function(h,k,j,g,f){if(h){NgLogD("Unable to call the balance server to get the currency information.")}else{NgLogD("Successfully retrieving currency information from the remote server.")}this.setName(g);this.setIconUrl(f);this.setWaitingOnData(false);if(e!==undefined){e(h,g,f)}}))},setWaitingOnData:function(e){this._waitingOnData=e},setName:function(e){this._name=e},setIconUrl:function(e){this._iconUrl=e},getWaitingOnData:function(){return this._waitingOnData},isWaitingOnData:function(){return !!this._waitingOnData},getName:function(){return this._name},getIconUrl:function(){return this._iconUrl}})}};__ngs._6v={_c:null,_d:function(){var f={exports:{}};var c=f.exports;this._c=f;var g=__ngs.r_(__ngs._59).UI;var d=g.ViewGeometry.Rect;var e=g.ViewGeometry.Scale;__ngs.r_(__ngs._88);var h=__ngs.r_(__ngs._9h).Composite;var b=__ngs.r_(__ngs._9i).Components;var a=c.NavigableView=h({key:"content",component:b.View},b.AddOrders.Generator("content"),{layoutSubviews:function($super){if($super&&typeof $super==="function"){$super()}var j=new d(this.getFrame());var k=__ngs.r_(__ngs._2v).ServiceHost.view();if(k&&!j.isEmpty()){var l=k.standardTitleViewRect.copy();j.x=j.y=0;j.sliceVertical(l.h);this.getContentView().setFrame(j)}}},{classname:"NavigableView"})}};__ngs._6w={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var e=__ngs.r_(__ngs._6k).MobageStyle;var a=e.ScaledCorners;var f=e.ScaledTextSize;var c=__ngs.r_(__ngs._2z).Assets;e.lazyLoad(b,"Home",function(){return{children:{_noGameText:{style:{textGravity:[0.5,0.9],textSize:f(13),textColor:"FFFFFFFF",textShadow:"C000 1 {0,-2}",textFont:e.defaultRegularFontFace}},_leftPaneBackground:{style:{gradient:{gradient:["99FFFFFF 0.0","9966C2FF 1.0"],corners:"4"}}},_userNamePicView:{children:{userIconSmall:{style:{imageBorder:{corners:"4",outerLine:"FF000000 2.0"}}},userNameButton:{style:{textColor:"FFFFFFFF",textGravity:[0.2,0.5],textSize:f(17),textFont:e.defaultBoldFontFace,gradient:{gradient:["FF0D1E36 0.0","FF072748 1.0"],corners:"4"},pressedGradient:{gradient:["FF0B519F 0.0"],corners:"4"}}},userBadgeText:{style:{textColor:"FFFFFFFF",textSize:f(12),textGravity:[0.5,0.5],textFont:e.defaultBoldFontFace}}}},_lastGameIcon:{children:{iconCaption:{style:{textColor:"FFFFFFFF",textGravity:[0.5,0.5],textSize:f(12),textFont:e.defaultRegularFontFace}},iconImage:{style:{gradient:{gradient:["FF0D1E36 0.0","FF072748 1.0"],corners:"4"},pressedGradient:{gradient:["FF0B519F 0.0"],corners:"4"}}}},extras:{captionHeightPct:1/4,iconSizePct:0.9}},_gamesButtonView:b.PageButton,_friendsButtonView:b.PageButton,_bankButtonView:b.PageButton,_gameCarousel:b.ScrollView,_alsoPlayingUsersList:b.ScrollView},extras:{contentInsetPctWidth:12/800,headerHeight:1/6,userNameHeightRatio:1/3.5,leftPaneWidth:1/3.4,leftRightPaneMargin:1/64,rightPaneSectionMargin:1/128}}});e.lazyLoad(b,"PageButton",function(){return{style:{textColor:"FFFFFFFF",gradient:{corners:a(4),gradient:["FF0B4B93 0.0","FF093A72 1.0"],outerLine:"FF081426 2.0"},pressedGradient:{corners:a(4),gradient:["FF062C57 0.0","FF093C76 1.0"],outerLine:"FF081426 2.0"},disabledGradient:{corners:a(4),gradient:["FFA0A0A0 0.000","FF7C7C7C 1.000"],outerLine:"FF081426 2.0"},pressedTextColor:"FFFFFFFF",disabledTextColor:"FFD1CDCD"},children:{buttonTextMajor:{style:{textFont:e.defaultBoldFontFace,textColor:"FFFFFFFF",textSize:f(12),textGravity:[0,0.5]}},buttonTextCount:{style:{textColor:"FF9fa6b9",textSize:f(12),textFont:e.defaultRegularFontFace,textGravity:[0.8,0.5]}},buttonTextBadge:{style:{textColor:"FFFFFFFF",textSize:f(12),textGravity:[0.5,0.5],textFont:e.defaultBoldFontFace}}},extras:{buttonIconWidthPct:1/4,buttonBadgeWidthPct:1/6}}});e.lazyLoad(b,"ScrollView",function(){return{style:{gradient:{gradient:["00000000 0.0","00000000 1.0"],corners:"0",outerLine:"00000000 0.0",innerLine:"00000000 0.0"}},children:{innerBackground:{style:{gradient:{gradient:["00000000 0.0","00000000 1.0"],corners:"0"}}},innerBkgTop:{style:{gradient:{gradient:["00000000 0.0","00000000 1.0"],corners:"0"}}},cornerButton:{style:{textFont:e.defaultBoldFontFace,textSize:f(14),textColor:"FFFFFFFF",pressedTextColor:"FFFFFFFF",disabledTextColor:"FFD1CDCD",gradient:{corners:"0",gradient:["AA000000 0.0","AA000000 1.0"]},pressedGradient:{corners:"0",gradient:["CC000000 0.0","CC000000 1.0"]},disabledGradient:{corners:"0",gradient:["88000000 0.0","88000000 1.0"]}}},titleText:{style:{textFont:e.defaultBoldFontFace,textColor:"FFFFFFFF",textGravity:[0,0.5],textSize:f(14)}}},extras:{headerHeightRatio:1/7.55555,cornerButtonHeight:-1,cornerButtonWidthRatio:1/2.815,listContentInset:[-0.24,0,0,0]}}});e.lazyLoad(b,"FeaturedUser",function(){return{style:{image:c.image("no-user-icon.png"),pressedImageBorder:{gradient:["22000000 0.0","22000000 1.0"]}}}});e.lazyLoad(b,"GameCarouselImage",function(){return{style:{image:c.image("no-game-promo-image.png"),imageFit:2,imageGravity:[0,0.5]}}});e.lazyLoad(b,"UserPicImage",function(){return{style:{gradient:{gradient:["00000000 0.0","00000000 1.0"]},pressedGradient:{gradient:["802020FF 0.0","802020FF 1.0"],corners:a(8),outerLine:"FF000000 2.0"}}}})}};__ngs._6x={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var c=new (__ngs.r_(__ngs._f).RequireLoader)({Destinations:function(){return __ngs.r_(__ngs._2a).Destinations},Session:function(){return __ngs.r_(__ngs._o).Session},Credentials:function(){return __ngs.r_(__ngs._2r).Credentials},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities}});var b=__ngs.r_(__ngs._n).LocalizedString;var a=__ngs.r_(__ngs._75).UserProfileController;var f=d.CurrentUserProfileController=a.subclass({classname:"CurrentUserProfileController",analyticsName:"MyProfile",initialize:function($super,h,g){$super(c.Session.getCurrentSession().user(),h,g);return this},getDynamicTabTitle:function(){return b("My Profile")},_createButtons:function(){var g=[[b("Settings"),this.settingsBtn_callback.bind(this)],[b("Support"),this.supportBtn_callback.bind(this)]];if(c.Capabilities.meetsBinaryVersion&&c.Capabilities.meetsBinaryVersion("1.6")&&!c.Session.getCurrentSession().user().usesGuestLogin()){g.push([b("Logout"),this.logoutBtn_callback.bind(this)])}this.view().setButtons(g)},_checkRelationshipComplete:function(){},settingsBtn_callback:function(){var g=c.Session.getCurrentSession();if(g.user()&&g.user().usesGuestLogin()){c.Credentials.showRegistration(null,true,true,"tiered",null,"profileSettings");return}c.Destinations.pushScreen(this.parentController.navController,"Settings",{tab:"profile",onSaveCallback:function(){this.loaded=false}.bind(this)},this)},supportBtn_callback:function(){c.Destinations.pushScreen(this.parentController.navController,"SupportWebScreen",{},this)},logoutBtn_callback:function(){NgLogD("CurrentUserProfileController - User is being logged out");c.Credentials.askUserForLogout(function(){NgLogD("CurrentUserProfileController - User logged out")})}})}};__ngs._6y={_c:null,_d:function(){var c={exports:{}};var h=c.exports;this._c=c;var e=__ngs.r_(__ngs._59).UI;var b=e.ViewGeometry.Rect;var a=new (__ngs.r_(__ngs._f).RequireLoader)({ContactsController:function(){return __ngs.r_(__ngs._6h).ContactsController},ContentViewController:function(){return __ngs.r_(__ngs._a3).ContentViewController},MobageAccordionCVC:function(){return __ngs.r_(__ngs._ap).MobageAccordionCVC},Assets:function(){return __ngs.r_(__ngs._2z).Assets},User:function(){return __ngs.r_(__ngs._30).User},UserListener:function(){return __ngs.r_(__ngs._30).UserListener},Session:function(){return __ngs.r_(__ngs._o).Session},SessionListener:function(){return __ngs.r_(__ngs._o).SessionListener},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},UpgradeUserController:function(){return __ngs.r_(__ngs._ac).UpgradeUserController},PendingListSection:function(){return __ngs.r_(__ngs._9r).PendingListSection},ZeroCaseSection:function(){return __ngs.r_(__ngs._a4).ZeroCaseSection},AddFriendManager:function(){return __ngs.r_(__ngs._aq).AddFriendManager},ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities}});var j=__ngs.r_(__ngs._77).Primitives;var f=__ngs.r_(__ngs._ad).UserCellView_ThreeItemMessage_TappableRowVariant;var d=__ngs.r_(__ngs._2a).Destinations;var l=__ngs.r_(__ngs._n).LocalizedString;var g=f.subclass({classname:"FriendCell",insetRatio:null,buttonSizeRatio:null,subtitleHeightRatio:0.5,initialize:function($super,p){$super(p);var n=this;this.content.content.setOnClick(function(){NgLogD("Default On Click");a.UIUtils.showToast(n.content.getText())});var o=a.ListViewCellStyles.FriendCell;o.applyTo(this);this.insetRatio=o.extras.buttonInsetRatio;this.lastPlayedInsetRatio=o.extras.insetRatio;this.buttonSizeRatio=o.extras.buttonSizeRatio;this.subtitleHeightRatio=o.extras.subtitleHeightRatio;this.game=null},setGame:function(n){this.game=n;this.rightAccessory.setText(l("Last Played"));if(this.game){this.rightAccessory.setOnClick((function(){a.ServiceHost.showLoadingHelper(function(){d.loadThenAct("GameProfile",function(o){o.startGameOrGoToProfile(this.game,"JSGamePlayFriendsGames")}.bind(this))}.bind(this))}).bind(this))}else{this.rightAccessory.setOnClick(null)}},markOdd:function(){this.addState(a.ContactsController.OddState)},markEven:function(){this.clearState(a.ContactsController.OddState)},layoutSubviews:function($super){var t=new b(this.getFrame());if(!t.isEmpty()){var q=t.copy();var s=this.insetRatio*t.h;var o=[s,s,s,s];var n=[s/2,s/2,s/2,s/2];this.setIconInset(n);this.icon.setFrameSize([q.h,q.h]);var p=this.lastPlayedInsetRatio*t.h;var r=[p/2,p/1,p/1,p/1];this.setRightAccessoryInset(r);this.rightAccessory.setFrameSize([t.w*this.buttonSizeRatio,t.h]);this.content.subtitle.setFrameSize([t.w-(t.w*this.buttonSizeRatio)-q.h,t.h*this.subtitleHeightRatio])}$super()}});var m=h.FriendsController=a.MobageAccordionCVC.subclass({classname:"FriendsController",analyticsName:"MyFriends",_listView:null,_user:null,mutualFriends:null,_totalInvites:0,_scanState:null,_didPreviouslyShowResults:null,initialize:function($super,n){$super();this._addFriendManager=(new a.AddFriendManager(this)).retain();this.scanState=0;this._user=n;this._dirtyFriendsListener=new a.UserListener(this._dirtyFriendsListener_callback.bind(this),this._user);if(a.Session.isCurrentSessionValid()&&a.Session.getCurrentSessionUser().usesGuestLogin()){this._sessionListener=new a.SessionListener(this._sessionListener_callback.bind(this))}this.mutualFriendItems=new Array()},destroy:function(){if(this.pendingSection){this.pendingSection.release()}if(this.mutualFriendsSection){this.mutualFriendsSection.release()}if(this.zeroCaseSection){this.zeroCaseSection.release()}if(this.upgradeUserController){this.upgradeUserController.release()}if(this._addFriendManager){this._addFriendManager.release();this._addFriendManager=null}if(this._dirtyFriendsListener){this._dirtyFriendsListener.destroy();this._dirtyFriendsListener=null}if(this._sessionListener){this._sessionListener.destroy();this._sessionListener=null}},getDynamicTabTitle:function(){var n;(this._user.gamertag.length>7)?n=this._user.gamertag.substring(0,7)+"...":n=this._user.gamertag;return(this._isLoginUser())?l("My Friends"):l("%1s's Friends",n)},getCurUser:function(){return this._user},getZeroCaseObject:function(){return this.zeroCaseSection},loadView:function($super){$super();this.view()._headerHeightRatio=0},didActivateTab:function($super){$super();this.parentController.navController._host.hideLoadingLabel();if(a.Session.getCurrentSession().user().usesGuestLogin()){if(!this.upgradeUserController){this.upgradeUserController=(new a.UpgradeUserController("friends")).retain()}var n=this.upgradeUserController.view();n.setRowHeightRatio(1,this.view().content.getFrame()[3]);this.view().setSections([n]);return}setTimeout(this.bind(function(){this._didActivateTab()}),50)},_didActivateTab:function(){if(!this.pendingSection){this.pendingSection=(new a.PendingListSection()).retain()}this.pendingSection.setPendingText(l("Updating Friends list..."));if(!this.mutualFriendsSection){this.mutualFriendsSection=this.createSectionWithTitle().retain()}this.startScan()},startScan:function(){var n=this;switch(this.scanState){case a.ContactsController.ScanState.Done:break;case a.ContactsController.ScanState.NotStarted:this.scanState=a.ContactsController.ScanState.InFlight;this.mutualFriendItems=[];this.mutualFriends=[];this._user.getMutualFriendsList().forAll(this.zombieSafeCallback(function(t,p,q){this.mutualFriends.push(p);var s=new k(p);s.parentController=this.parentController;this.mutualFriendItems.push(s);s.mode="profile";this.logd("Friend found...[",p.gamertag," ",p.lastPlayedGame,"]");var r=p.lastPlayedGame;s.lastUserGameIcon=r?r.iconURL:null;s.lastUserGame=r;t(this.mutualFriendItems.length<=500)}),this.zombieSafeCallback(function(r){this.logd("Total Friends found...["+this.mutualFriendItems.length+"]");if(r){this.loge("Problem loading mutual friends: ",r);var q=(new e.AlertDialog()).retain();q.setTitle(l("No Network Connection"));q.setText(l("Please check your network connection settings."));q.setChoices([l("OK")]);q.onchoice=function(t){q.release();q=null};q.show();this._scanFinished();this._showNoInternetCase();return}this.sortedFriends=new Array();var p=function(v,u){var t=v.user.gamertag.toLowerCase();var w=u.user.gamertag.toLowerCase();return((t<w)?-1:((t>w)?1:0))};this.sortedFriends=this.mutualFriendItems.sort(p);for(var s=0;s<this.sortedFriends.length;s++){this.sortedFriends[s].odd=(s-1)%2}this.mutualFriendItems=this.sortedFriends;this._scanFinished()}),this.zombieSafeCallback(function(q,p){this.logd("Cached FriendsList final callback. dataWasRefreshed? ",!!p);if(!q&&p){this._user.emit({buddies:1})}}));case a.ContactsController.ScanState.InFlight:var o=this.view().getSections();if(!o||!o.length||o[0]!=this.pendingSection){if(this._didPreviouslyShowResults){this.pendingSection.setPendingText(l("Updating Friends list..."));this.view().setSections([this.pendingSection,this.mutualFriendsSection])}else{this.view().setSections([this.pendingSection])}}break;default:break}},_addGamesToView:function(){var n=this._listView.getSections()[0];n.setItems(this._gameData)},_scanFinished:function(){this.scanState=a.ContactsController.ScanState.Done;this.loge("Done!");this.mutualFriendsSection.setItems(this.mutualFriendItems);setTimeout(this.bind(function(){if(this.mutualFriendItems.length){this.view().setSections([this.mutualFriendsSection])}else{this._showNoResultsCase()}}),1)},_showNoResultsCase:function(){NgLogD("No Results Case");if(!this.zeroCaseSection){this.zeroCaseSection=(new a.ZeroCaseSection(1,this.view().content.getFrame()[3])).retain();if(this._isLoginUser()){this.zeroCaseSection.setZeroCaseTexts([l("You don't have any Friends yet."),l("Have you tried scanning your contacts? People you know may already be on Mobage!"),l("Scan Contacts")]);this.zeroCaseSection.setZeroCaseButtonCallback(function(){d.pushScreen(a.ServiceHost.navController,"FindFriends",{tab:"contacts"},this.parentController)}.bind(this))}else{this.zeroCaseSection.setZeroCaseTexts([l("%1s doesn't have any Friends yet.",this._user.gamertag),l("Help them out and add them as a Friend!"),l("Add as Friend")]);if(this._addFriendManager){this.zeroCaseSection.setZeroCaseButtonCallback(this._addFriendManager.getAddFriendButtonCallback())}}}this.view().setSections([this.zeroCaseSection]);if(!this._isLoginUser()&&this._addFriendManager){this._addFriendManager._checkRelationship()}},_showNoInternetCase:function(){NgLogD("No Internet Case");if(!this.zeroCaseSection){this.zeroCaseSection=(new a.ZeroCaseSection(1,this.view().content.getFrame()[3])).retain();this.zeroCaseSection.setZeroCaseTexts([l("No Network Connection"),l("Please check your network connection settings."),("")]);this.zeroCaseSection.setZeroCaseButtonEnabled(false)}this.view().setSections([this.zeroCaseSection])},_isLoginUser:function(){return(this._user.is(a.Session.getCurrentSession().user()))},_dirtyFriendsListener_callback:function(n){if(this.isDestroyed()){if(this._dirtyFriendsListener){this._dirtyFriendsListener.destroy();this._dirtyFriendsListener=null}return}if(!n||!n.buddies){return}if(this.scanState==a.ContactsController.ScanState.Done){this._didPreviouslyShowResults=true}this.scanState=a.ContactsController.ScanState.NotStarted},_sessionListener_callback:function(n){if(this.isDestroyed()){if(this._sessionListener){this._sessionListener.destroy();this._sessionListener=null}return}this._didActivateTab()}});var k=j.ListViewItem.subclass({classname:"FriendListItem",_reuseId:"mypage.friendlistitem",section:null,mode:null,initialize:function($super,n){if(!(n instanceof a.User)){throw new Error("User argument expected.")}this.user=n;$super()},_onCreateView:function(){return new g()},_onReleaseView:function(n){if(this.cell==n){this.cell=null}n.icon.setImage("");n.rightAccessory.setImage("")},_onSetView:function(o){this.cell=o;o.setState(e.State.Normal);o.setGame(this.lastUserGame);o.layoutSubviews();o.content.content.setTextCutOffOneLine(this.user.gamertag);o.content.middleLabel.setTextCutOffOneLine(this.user.getFullName());if(!this.user.ageRestricted){o.content.subtitle.setTextCutOffOneLine(this.user.motto,30)}else{o.content.subtitle.setText("")}if(this.lastUserGameIcon){var n=this.lastUserGameIcon;var s=a.Assets.image("no-game-icon.png");if(a.Capabilities.isPlatformIOS()&&this.lastUserGameIcon=="/images/app-default.png"){n=a.Assets.image("no-game-icon.png")}o.rightAccessory.setImage(n);o.rightAccessory.setText(l("Last played"));o.rightAccessory.setTouchable(true)}else{o.rightAccessory.setText("");o.rightAccessory.setTouchable(false)}var p=this.user.getDefinedIcon();if(!p){NgLogD("No avatar or photo for user.")}o.icon.setImage(p);if(this.odd){o.markOdd()}else{o.markEven()}o.setOnClick(this.bind(this.rowTapped));var r=new b(o.getFrame());var q=r.h*o.getStyle().extras.imageInsetRatio;o.setIconInset([q,q,q,q]);o.setRightAccessoryInset([q,q,q,q])},rowTapped:function(){d.pushScreen(this.parentController.navController,"UserProfilePage",{user:this.user},this.parentController)}})}};__ngs._6z={_c:null,_d:function(){var f={exports:{}};var e=f.exports;this._c=f;var c=new (__ngs.r_(__ngs._f).RequireLoader)({MessageListener:function(){return __ngs.r_(__ngs._w).MessageListener},ContactsController:function(){return __ngs.r_(__ngs._6h).ContactsController},ContentViewController:function(){return __ngs.r_(__ngs._a3).ContentViewController},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},Session:function(){return __ngs.r_(__ngs._o).Session},SessionListener:function(){return __ngs.r_(__ngs._o).SessionListener},UserListener:function(){return __ngs.r_(__ngs._30).UserListener},UpgradeUserController:function(){return __ngs.r_(__ngs._ac).UpgradeUserController},ContactsSectionTitleView:function(){return __ngs.r_(__ngs._7a).ContactsSectionTitleView},ContactsSectionSubtitleView:function(){return __ngs.r_(__ngs._ar).ContactsSectionSubtitleView},PendingListSection:function(){return __ngs.r_(__ngs._9r).PendingListSection},DirectInviteSection:function(){return __ngs.r_(__ngs._a8).DirectInviteSection},ZeroCaseSection:function(){return __ngs.r_(__ngs._a4).ZeroCaseSection}});var b=__ngs.r_(__ngs._2a).Destinations;var a=__ngs.r_(__ngs._n).LocalizedString;var d=__ngs.r_(__ngs._ap).MobageAccordionCVC;var g=e.InvitesController=d.subclass({classname:"InvitesController",analyticsName:"Requests",_listView:null,_user:null,invitableUsers:null,_totalInvites:0,_scanState:null,initialize:function($super,h){$super();this.scanState=0;this._user=h;NgLogD("////////INVITES CONTROLLER IGNORE FRIENDS: "+this._user.ignoreFriendRequests);this.invitableItems=new Array();this._dirtyFriendsListener=new c.UserListener(this._dirtyFriendsListener_callback.bind(this),this._user);if(c.Session.isCurrentSessionValid()&&c.Session.getCurrentSessionUser().usesGuestLogin()){this._sessionListener=new c.SessionListener(this._sessionListener_callback.bind(this))}},destroy:function($super){if(this.pendingSection){this.pendingSection.release()}if(this.invitableSection){this.invitableSection.release()}if(this.directInviteSection){this.directInviteSection.release()}if(this.zeroCaseSection){this.zeroCaseSection.release()}if(this.upgradeUserController){this.upgradeUserController.release()}if(this._dirtyFriendsListener){this._dirtyFriendsListener.destroy();this._dirtyFriendsListener=null}if(this._sessionListener){this._sessionListener.destroy();this._sessionListener=null}$super()},getDynamicTabTitle:function(){return a("My Friend Requests")},loadView:function($super){$super();this.view()._headerHeightRatio=0},didActivateTab:function($super){$super();NgLogD("Invites Controller: didActivateTab");this.parentController.navController._host.hideLoadingLabel();if(c.Session.getCurrentSession().user().usesGuestLogin()){if(!this.upgradeUserController){this.upgradeUserController=(new c.UpgradeUserController("invites")).retain()}var h=this.upgradeUserController.view();h.setRowHeightRatio(1,this.view().content.getFrame()[3]);this.view().setSections([h]);return}this._didActivateTab()},_didActivateTab:function(){if(!this.pendingSection){this.pendingSection=(new c.PendingListSection()).retain()}this.pendingSection.setPendingText(a("Checking for Friend requests..."));if(!this.directInviteSection){this.directInviteSection=(new c.DirectInviteSection()).retain()}this.view().setSections([this.pendingSection,this.directInviteSection]);this.scanState=c.ContactsController.ScanState.NotStarted;this.view().getContentView().setScrollPosition([0,0]);setTimeout(this.bind(function(){if(!this._activateInited){setTimeout(this.zombieSafeCallback(function(){if(this.directInviteSection.item&&this.directInviteSection.item.cell&&this.directInviteSection.item.cell.getAddressFieldView()){this.applyKeyboardWorkaround(this.directInviteSection.item.cell.getAddressFieldView())}}),1000);this.invitableSection=this.createSectionWithTitle().retain();this._activateInited=true}this.startScan()}),50)},startScan:function(){NgLogD("Invites Controller: startScan");this.invitableItems=[];this.invitableUsers=[];switch(this.scanState){case c.ContactsController.ScanState.Done:this._scanFinished();break;case c.ContactsController.ScanState.NotStarted:this.scanState=c.ContactsController.ScanState.InFlight;this.invitableItems=[];this.invitableUsers=[];this.invitableItems=[];this.invitableUsers=[];this._user.getInvitesList().forAll(this.zombieSafeCallback(function(m,j,k){if(j.isMutualFriend){m(true);return}this.invitableUsers.push(j);var l=new c.ContactsController.FoundUserListItem(j);this.invitableItems.push(l);l.mode="profile";l.odd=(this.invitableItems.length-1)%2;this.logd("Invite found...["+j+"]");m(this.invitableItems.length<=100)}),this.zombieSafeCallback(function(j){this.logd("Total invites found...["+this.invitableItems.length+"]");this._scanFinished()}),this.zombieSafeCallback(function(k,j){this.logd("Cached InvitesController final callback. dataWasRefreshed? ",!!j);if(!k&&j){this._user.emit({invites:1})}}));break;case c.ContactsController.ScanState.InFlight:var h=this.view().getSections();if(!h||!h.length||h[0]!=this.pendingSection){this.view().setSections([this.pendingSection,this.directInviteSection])}break;default:break}},_addGamesToView:function(){var h=this._listView.getSections()[0];h.setItems(this._gameData)},_scanFinished:function(){this.scanState=c.ContactsController.ScanState.Done;NgLogD("Invites Controller: scan finished");this.invitableSection.setItems(this.invitableItems);if(this.invitableItems.length){var h=this;if(!c.Session.getCurrentSession().user().ignoreFriendRequests){var j=new c.ContactsSectionSubtitleView();j.setTitle(a("Tip: Swipe a friend request to ignore it."));h.invitableSection.setSectionHeader(j);j.setOnClick(function(){c.Session.getCurrentSession().user().setIgnoreFriendRequests(1,(function(k,l){NgLogD("SET IGNORE FRIEND COMPLETE");h.invitableSection.removeSectionHeader(h.invitableSection,h.view());if(k){NgLogD("SET IGNORE FRIEND COMPLETE Failed")}}).bind(this))})}this.view().setSections([this.invitableSection,this.directInviteSection]);this.view().getContentView().setScrollPosition(this.view().getContentView().getScrollPosition()||[0,0])}else{this._showNoResultsCase()}},_showNoResultsCase:function(){NgLogD("No Results Case");if(!this.zeroCaseSection){this.zeroCaseSection=(new c.ZeroCaseSection(3/6)).retain();this.zeroCaseSection.setZeroCaseTexts([a("You don't have any friend requests yet."),a("Have you tried scanning your contacts? People you know may already be on Mobage!"),a("Scan Contacts")]);this.zeroCaseSection.setZeroCaseButtonCallback(function(){b.pushScreen(c.ServiceHost.navController,"FindFriends",{tab:"contacts"},this.parentController)})}this.view().setSections([this.zeroCaseSection,this.directInviteSection])},_dirtyFriendsListener_callback:function(h){if(this.isDestroyed()){if(this._dirtyFriendsListener){this._dirtyFriendsListener.destroy();this._dirtyFriendsListener=null}return}if(!h||!(h.buddies||h.invites)){return}if(this.scanState==c.ContactsController.ScanState.Done){this._didPreviouslyShowResults=true}this.scanState=c.ContactsController.ScanState.NotStarted},_sessionListener_callback:function(h){if(this.isDestroyed()){if(this._sessionListener){this._sessionListener.destroy();this._sessionListener=null}return}this._didActivateTab()}})}};__ngs._70={_c:null,_d:function(){var e={exports:{}};var v=e.exports;this._c=e;var a=__ngs.r_(__ngs._5).Core;var m=__ngs.r_(__ngs._59).UI;var u=__ngs.r_(__ngs._a).Storage;var o=__ngs.r_(__ngs._2a).Destinations;var f=__ngs.r_(__ngs._a3).ContentViewController;var d=__ngs.r_(__ngs._n).LocalizedString;var g=__ngs.r_(__ngs._2e).Game;var r=__ngs.r_(__ngs._o);var p=__ngs.r_(__ngs._79).MBListViewSection;var h=__ngs.r_(__ngs._9r).PendingListSection;var l=__ngs.r_(__ngs._5l).UnspammableButton;var j=__ngs.r_(__ngs._a4).ZeroCaseSection;var k=__ngs.r_(__ngs._9s).IdleActor;var q=__ngs.r_(__ngs._2v);var c=__ngs.r_(__ngs._a5).CatalogListItem;var n=__ngs.r_(__ngs._a3).compareArrays;var s=new (__ngs.r_(__ngs._f).RequireLoader)({UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils},Layout:function(){return __ngs.r_(__ngs._aj).Layout},UpgradeUserController:function(){return __ngs.r_(__ngs._ac).UpgradeUserController}});var t=m.ListViewItem.subclass({classname:"GamesController_AreaItem",_reuseId:null,_areaView:null,initialize:function($super,w,x){$super();this._areaView=w;this._reuseId=x},_onCreateView:function(){return this._areaView}});var b=v.GamesController=f.subclass({classname:"GamesController",analyticsName:"MyGames",_retrievingData:false,_hasMyGames:false,_allResultsReady:false,_isCurrentUser:false,_getFriendGames:false,_maxFriendsGamesForDisplay:5,initialize:function($super,x){$super();this._myGamesListItems=[];this._friendGamesListItems=[];this._sheet=__ngs.r_(__ngs._a7).CatalogList;this._user=x;var w=r.Session.getCurrentSession().user();if(w){this._isCurrentUser=this._getFriendGames=this._user.recordID==w.recordID}else{this._isCurrentUser=this._getFriendGames=false}this._idleActor=(new k()).retain();this._listView=this.view().getContentView();this._pendingListSection=(new h()).retain();this._pendingListSection.setPendingText(d("Loading games..."));if(r.Session.getCurrentSessionUser().usesGuestLogin()){this._sessionListener=new r.SessionListener(this._sessionListener_callback.bind(this))}},destroy:function(){if(this._idleActor){this._idleActor.release()}if(this._myGamesListSection){this._myGamesListSection.release()}if(this._pendingListSection){this._pendingListSection.release()}if(this._friendGamesHeaderSection){this._friendGamesHeaderSection.release()}if(this._friendGamesListSection){this._friendGamesListSection.release()}if(this.upgradeUserController){this.upgradeUserController.release()}if(this.zeroCaseSection){this.zeroCaseSection.release()}if(this._sessionListener){this._sessionListener.destroy();this._sessionListener=null}},getDynamicTabTitle:function(){var w;(this._user.gamertag.length>7)?w=this._user.gamertag.substring(0,7)+"...":w=this._user.gamertag;return(this._isCurrentUser)?d("My Games"):d("%1s's Games",w)},loadView:function($super){$super();this.view()._headerHeightRatio=0},_refreshListViewSections:function(){if(!this._retrievingData){if(this._friendGamesListItems.length===0&&this._myGamesListItems.length===0){this._showNoResultsCase()}else{if(this._getFriendGames&&this._friendGamesListItems.length>0){if(this._myGamesListItems.length===0){if(this._pendingListSection){this._pendingListSection.setMessageText(d("You don't have any games yet."))}this._listView.setSections([this._pendingListSection,this._friendGamesHeaderSection,this._friendGamesListSection])}else{this._listView.setSections([this._myGamesListSection,this._friendGamesHeaderSection,this._friendGamesListSection])}}else{this._listView.setSections([this._myGamesListSection])}}}else{this._listView.setSections([this._myGamesListSection,this._pendingListSection])}},didActivateTab:function($super,x){$super(x);this.parentController.navController._host.hideLoadingLabel();if(r.Session.getCurrentSession().user().usesGuestLogin()){if(!this.upgradeUserController){this.upgradeUserController=(new s.UpgradeUserController("games")).retain()}var w=this.upgradeUserController.view();w.setRowHeightRatio(1,this.view().content.getFrame()[3]);this.view().setSections([w]);return}this._setupContent()},_setupContent:function(){if(!this._allResultsReady){this._listView.setSections([this._pendingListSection])}if(!this._myGamesListSection){var z=this._sheet.extras.catalogCellHFactor2;this._myGamesListSection=(new p()).retain();this._myGamesListSection.setRowHeightRatio(z);this._friendGamesListSection=(new p()).retain();this._friendGamesListSection.setRowHeightRatio(z);var w=this.ySize(this._sheet.extras.friendsGamesHeaderHeight);this._friendsButtonArea=this.retainView(new m.View());this._friendsButtonArea.setFrame([0,0,this.view().content.getFrame()[2],w]);var B=new t(this._friendsButtonArea,"friends_button_area");this._friendGamesHeaderSection=(new p()).retain();this._friendGamesHeaderSection.setRowHeight(w);this._friendGamesHeaderSection.setItems([B]);var y=new m.ViewGeometry.Rect(this._friendsButtonArea.getFrame());this._labelFriends=this.retainView(new m.Label());this._labelFriends.setText(d("Games that my Friends Play"));this._labelFriends.setFrame([this.friendsButtonAreaX(this._sheet.extras.labelFriendsXInsetFactor),this.friendsButtonAreaY(this._sheet.extras.labelFriendsYInsetFactor),this.xSize(this._sheet.extras.labelFriendsWidthFactor),this.ySize(this._sheet.extras.labelFriendsHeightFactor)]);this._labelFriends.setTextGravity(m.ViewGeometry.Gravity.Left);this._friendsButtonArea.addChild(this._labelFriends);this._buttonAllGames=this.retainView(new l());this._buttonAllGames.setText(d("All Games"));var A=this._friendsButtonArea.getFrame()[2];var x=this._sheet.extras.allGamesButtonW*A;this._buttonAllGames.setFrame([s.Layout.getPositionInContainer(this._sheet.extras.allGamesButtonAlignH,this._sheet.extras.allGamesButtonGravityH,x,A),this.friendsButtonAreaY(this._sheet.extras.buttonAllGamesYInsetFactor),x,this.ySize(this._sheet.extras.buttonAllGamesHeightFactor)]);this._buttonAllGames.setOnClick(function(){o.pushScreen(this.parentController.navController,"Catalog",{tab:"all games"},this.parentController)}.bind(this));this._friendsButtonArea.addChild(this._buttonAllGames);this._sheet.applyTo(this)}if(this._user&&!this._retrievingData&&!this._allResultsReady){this._retrievingData=true;this._hasMyGames=false;this._allResultsReady=false;this._myGamesListItems=[];this._friendGamesListItems=[];this._refreshMyGamesSection();this._friendGamesListSection.setItems(this._friendGamesListItems);if(!this._idleAction){this._idleAction=this.zombieSafeCallback(function(){this._resultsReady()})}this._user.getOwnedGamesList().forAll(this.zombieSafeCallback(function(E,C,D){this._addGameToList(C);E(true)}),this.zombieSafeCallback(function(C){this._hasMyGames=true;if(!C){this._idleActor.waitForIdleBeforeAction(this._idleAction)}else{s.UIUtils.showAlert(d("Error"),d("Error accessing system.  Please try again later. Error: %1s",C))}if(this._getFriendGames){this._refreshListViewSections();this._getFriendGamesList()}else{this._onDataComplete()}}),this.zombieSafeCallback(function(D,C){NgLogD("GamesController: Cached lookup fully complete, needs UI refresh? "+!!C);if(!D&&C){var E=[];this._user.getOwnedGamesList().forAll(this.zombieSafeCallback(function(G,F){E.push(F);G(true)}),this.zombieSafeCallback(function(F){if(!F){NgLogD("GamesController: Refreshing UI post cache update!");var G;this._myGamesListItems=[];for(G=0;G<E.length;G++){this._addGameToList(E[G])}this._refreshMyGamesSection()}}),true)}}))}},_resultsReady:function(){this._refreshListViewSections()},_onDataComplete:function(){this._allResultsReady=true;this._retrievingData=false;this._refreshListViewSections();this._user._friendsOwnedGamesListCache=this._friendGames},_addGameToList:function(w){if(!(w instanceof g)){throw new Error("Game argument expected.")}var x=new c(w,this._myGamesListItems.length%2===1);x.rowTappedForGame=function(y){if(y){NgLogD("CatalogCell: INIT GAME");o.pushScreen(this.parentController.navController,"GameProfile",{game:y},x)}else{NgLogD("CatalogCell: missing tappedGame")}}.bind(this);this._myGamesListItems.push(x);this._idleActor.waitForIdleBeforeAction(this._idleAction)},_addGameToFriendGamesList:function(w){if(!(w instanceof g)){throw new Error("Game argument expected.")}var y;for(y=0;y<this._myGamesListItems.length;y++){if(this._myGamesListItems[y].game.recordID==w.recordID){return}}for(y=0;y<this._friendGamesListItems.length;y++){if(this._friendGamesListItems[y].game.recordID==w.recordID){return}}if(!this._friendGames){this._friendGames=[]}this._friendGames.push(w);var x=new c(w,this._friendGamesListItems.length%2===1);x.rowTappedForGame=function(z){if(z){NgLogD("CatalogCell: INIT GAME");o.pushScreen(this.parentController.navController,"GameProfile",{game:z},x)}else{NgLogD("CatalogCell: missing tappedGame")}}.bind(this);this._friendGamesListItems.push(x);this._idleActor.waitForIdleBeforeAction(this._idleAction)},_getFriendGamesList:function(){if(!this._user.is(r.Session.getCurrentSession().user())){return}if(this._user._friendsOwnedGamesListCache){for(var w=0;w<this._user._friendsOwnedGamesListCache.length;w++){this._addGameToFriendGamesList(this._user._friendsOwnedGamesListCache[w])}this._allResultsReady=true;this._retrievingData=false;this._idleActor.waitForIdleBeforeAction(this._idleAction);return}var x=this;this._friendIndexKey="_friendIndexKey";this._curIdx=0;u.KeyValueCache.local.getItem(this._friendIndexKey,function(z,y){if(!z){x._curIdx=y;if(!x._curIdx&&x._curIdx!==0){x._curIdx=0}}x._getNextFriend()})},_getNextFriend:function(){var w=this;w._userIdx=0;w._user.getMutualFriendsList().forRange(w._curIdx,99,this.zombieSafeCallback(function(z,x,y){w._userIdx=y;w._getGamesOfFriend(x,function(){z(w._friendGamesListItems.length<w._maxFriendsGamesForDisplay)})}),this.zombieSafeCallback(function(x){if(x){if(s.NetworkUtils.wasNetworkDown()){this._showNoInternetCase();return}else{s.UIUtils.showAlert(d("Error"),d("Error accessing system.  Please try again later. Error: %1s",x));return}}if(w._friendGamesListItems.length>=w._maxFriendsGamesForDisplay){u.KeyValueCache.local.setItem(w._friendIndexKey,++w._userIdx);this._onDataComplete()}else{if(w._curIdx!==0){w._curIdx=0;w._getNextFriend()}else{this._onDataComplete()}}}))},_getGamesOfFriend:function(x,w){x.getOwnedGamesList().forAll(this.zombieSafeCallback(function(z,A,y){if(this._friendGamesListItems.length<this._maxFriendsGamesForDisplay){this._addGameToFriendGamesList(A);z(true)}else{z(false)}}),this.zombieSafeCallback(function(y){w()}))},_showNoInternetCase:function(){NgLogD("No Internet Case");if(!this.zeroCaseSection){this.zeroCaseSection=(new j(1,this.view().content.getFrame()[3])).retain()}this.zeroCaseSection.setZeroCaseTexts([d("No Network Connection"),d("Please check your network connection settings."),("")]);this.zeroCaseSection.setZeroCaseButtonEnabled(false);this.view().setSections([this.zeroCaseSection])},_scrollToSection:function(){var x=this.view().getContentView().getSections();var w=-1;switch(this._sectionToSet){case"my games":w=x.indexOf(this._myGamesListSection);break;case"friends games":w=x.indexOf(this._friendGamesHeaderSection);break;default:return}if(w>=0&&w<x.length){this.view().getContentView().setScrollPosition([0,x[w].getYPosition()])}},xSize:function(w){return(w/800)*a.Capabilities.getScreenHeight()},ySize:function(w){return(w/480)*a.Capabilities.getScreenWidth()},friendsButtonAreaX:function(w){return this.xSize(w-this._sheet.extras.friendsButtonAreaXRatio)},friendsButtonAreaY:function(w){return this.ySize(w-this._sheet.extras.friendsButtonAreaYRatio)},_showNoResultsCase:function(){NgLogD("No Results Case");if(!this.zeroCaseSection){this.zeroCaseSection=(new j(1,this.view().content.getFrame()[3])).retain();var w=this._user;var x;if(this._isCurrentUser){this.zeroCaseSection.setZeroCaseTexts([d("You don't have any games yet."),"",d("Get Games")]);this.zeroCaseSection.setZeroCaseButtonCallback(function(){o.pushScreen(q.ServiceHost.navController,"Catalog",{},this.parentController)}.bind())}else{this.zeroCaseSection.setZeroCaseTexts([d("%1s isn't playing any games yet.",this._user.gamertag),d("Tell %1s what games they should be playing!",this._user.gamertag),d("Leave a Comment")]);this.zeroCaseSection.setZeroCaseButtonCallback(this.bind(function(){this.parentController.selectTabAtIndex(0)}))}}this.view().setSections([this.zeroCaseSection])},_refreshMyGamesSection:function(){var w=this._myGamesListSection.getItems()||[];var x=function(z,y){return(z.getGame().is(y.getGame()))};if(!n(w,this._myGamesListItems,x)){this._myGamesListSection.setItems(this._myGamesListItems)}},_sessionListener_callback:function(w){if(this.isDestroyed()){if(this._sessionListener){this._sessionListener.destroy();this._sessionListener=null}return}this._setupContent()}})}};__ngs._71={_c:null,_d:function(){var e={exports:{}};var g=e.exports;this._c=e;var h=__ngs.r_(__ngs._5).Core;var d=__ngs.r_(__ngs._4).Device;var f=__ngs.r_(__ngs._59).UI;var b=new (__ngs.r_(__ngs._f).RequireLoader)({UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},Session:function(){return __ngs.r_(__ngs._o).Session},AvatarImagePickerCell:function(){return __ngs.r_(__ngs._as).AvatarImagePickerCell},UIStyle:function(){return __ngs.r_(__ngs._60).Style},AvatarPickerStyle:function(){return __ngs.r_(__ngs._at)},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils},SpamLockForName:function(){return __ngs.r_(__ngs._68).getSpamProtectionLockForName},AppUpdater:function(){return __ngs.r_(__ngs._2i).AppUpdater}});var l=__ngs.r_(__ngs._n).LocalizedString;var j=h.MessageListener.subclass({classname:"AvatarImagePickerKeyListener"});var c=__ngs.r_(__ngs._7g).ViewController;var k=g.AvatarImagePickerController=c.subclass({classname:"AvatarImagePickerController",_mobageUserListItems:[],initialize:function($super,p,r,q,o){if($super&&typeof $super=="function"){$super()}b.AvatarPickerStyle;this._retrievingAvatars=true;var n=this;this._finalCB=o;this._choosePhotoCameraCB=p;this._choosePhotoCB=r;this._chooseAvatarCB=q;this._avatarPickerStyle=b.UIStyle.registeredStyle("social.us.avatarpicker");this._baseView=new f.View().retain();f.Window.document.addChild(this._baseView);this._serviceAutoRotate=b.ServiceHost.shouldAutoRotate();b.ServiceHost.setShouldAutoRotate(false);this._gameCoverView=new f.Button().retain();this._gameCoverView.onclick=function(s){n.cleanup()};this._topBarBgPane=new f.View().retain();this._topBarBgPane.setAttributes(this._avatarPickerStyle.props()["topBarBackgroundPane"]);this._baseView.addChild(this._topBarBgPane);this._topBarBorderPane=new f.View().retain();this._topBarBorderPane.setAttributes(this._avatarPickerStyle.props()["borderUnderTopPane"]);this._baseView.addChild(this._topBarBorderPane);this._selectLabel=new f.Label().retain();this._selectLabel.setText(l("Select a User Image"));this._selectLabel.setTextGravity(f.ViewGeometry.Gravity.Left);this._selectLabel.setAttributes(this._avatarPickerStyle.props()["selectLabel"]);this._topBarBgPane.addChild(this._selectLabel);this._cancelButton=new f.Button().retain();this._cancelButton.setText(l("Cancel"));b.CommonElements.standardButton.applyTo(this._cancelButton);this._cancelButton.onclick=function(s){n.cleanup()};this._topBarBgPane.addChild(this._cancelButton);this._listViewBgOuterPane=new f.View().retain();this._listViewBgOuterPane.setAttributes(this._avatarPickerStyle.props()["listContainerBgOuterPane"]);this._baseView.addChild(this._listViewBgOuterPane);this._listViewBgInnerPane=new f.View().retain();this._listViewBgInnerPane.setAttributes(this._avatarPickerStyle.props()["listContainerBgInnerPane"]);this._baseView.addChild(this._listViewBgInnerPane);this._listView=new f.ListView().retain();this._loadingItemsSection=(new f.Label()).retain();this._loadingItemsSection.setAttributes(this._avatarPickerStyle.props()["loadingLabel"]);this._loadingItemsSection.setText(l("Loading..."));this._listViewBgInnerPane.addChild(this._loadingItemsSection);this._spinner=(new f.Spinner()).retain();this._listViewBgInnerPane.addChild(this._spinner);this.layoutViews(f.Window.getWidth(),f.Window.getHeight());this.kListener=new j();b.UnspammableButton.addDeviceKeyListener(this.kListener,this.onKeyPressed.bind(this),99999);this._getAvatarImages();this._initialized=true;return this},loadView:function($super){$super()},layoutViews:function(o,t){this._orientedScreenWidth=o;this._orientedScreenHeight=t;var n=h.Capabilities.getScreenWidth();var p=h.Capabilities.getScreenHeight();var s=o>=t;var z=new f.ViewGeometry.Rect(0,0,o,t);var y=n/480;var r=p/800;var v;if(s){v=z.sliceVertical(60*r);this._gameCoverView.setGradient({gradient:["66000000 0.0","66000000 0.94","B3000000 1.0"],gradientAngle:180});this.rowHeight=100}else{v=z.sliceVertical(150*r);this._gameCoverView.setGradient({gradient:["66000000 0.0","66000000 0.94","B3000000 1.0"]});this.rowHeight=150}this._baseView.setFrame([0,t,o,t]);this._gameCoverView.setFrame(v);var q=z.sliceVertical(66*r);this._topBarBgPane.setFrame(q);var u=10*y;var w=176*y;this._selectLabel.setFrame([u,u,this._orientedScreenWidth,46*r]);this._cancelButton.setFrame([q.w-u-w,u,w,46*r]);this._topBarBorderPane.setFrame(z.sliceVertical(2));var x=z.copy();this._listViewBgOuterPane.setFrame(x);x.inset(2,2,0,2);this._listViewBgInnerPane.setFrame([x.x,x.y,x.w,x.h+2]);this._spinner.setFrame(x.w/2-110,(x.h+2)/2-15,30,30);this._loadingItemsSection.setFrame(0,0,x.w,x.h);x.x=0;x.y=0;x.inset(2,2,0,2);this._listView.setFrame(x);f.measureText(this._loadingItemsSection.getText(),500,h.Capabilities.getScreenWidth(),this._loadingItemsSection.getTextFont(),this._loadingItemsSection.getTextSize(),function(C){var A=C.totalWidth;var D=A+40;var B=(x.w-D)/2;this._spinner.setFrame(B,(x.h+2)/2-15,30,30);this._loadingItemsSection.setFrame(B+40,(x.h+2)/2-20,A,C.height)}.bind(this));this._maxPerRow=Math.floor(this._listView.getFrame()[2]/this.rowHeight);b.SpamLockForName("default").acquireHardLock();f.animate(function(){this._baseView.setFrame([0,0,o,t])}.bind(this),400,function(){b.SpamLockForName("default").releaseHardLock();this._baseView.addChild(this._gameCoverView)}.bind(this))},onKeyPressed:function(n){if(n.code===d.KeyEmitter.Keycode.back){if(this._gameCoverView){this.cleanup();return true}}return false},destroy:function(){if(this._baseView){this._baseView.release()}if(this._topBarBgPane){this._topBarBgPane.release()}if(this._topBarBorderPane){this._topBarBorderPane.release()}if(this._cancelButton){this._cancelButton.release()}if(this._selectLabel){this._selectLabel.release()}if(this._listView){this._listView.release()}if(this._listViewBgOuterPane){this._listViewBgOuterPane.release()}if(this._listViewBgInnerPane){this._listViewBgInnerPane.release()}if(this._loadingItemsSection){this._loadingItemsSection.release()}if(this._spinner){this._spinner.release()}this._baseView=null;this._topBarBgPane=null;this._topBarBorderPane=null;this._cancelButton=null;this._selectLabel=null;this._listView=null;this._listViewBgOuterPane=null;this._listViewBgInnerPane=null;this._loadingItemsSection=null;this._spinner=null},setOnCleanup:function(n){this._cleanupCb=n},cleanup:function(){if(typeof this._cleanupCb=="function"){this._cleanupCb();this._cleanupCb=null}b.ServiceHost.setShouldAutoRotate(this._serviceAutoRotate);if(this.kListener){d.KeyEmitter.removeListener(this.kListener);this.kListener=null}if(this._gameCoverView){this._gameCoverView.release();this._gameCoverView=null}if(!this._baseView){return}f.animate(function(){this._baseView.setFrame([0,this._orientedScreenHeight,this._orientedScreenWidth,this._orientedScreenHeight])}.bind(this),400,function(){this.destroy()}.bind(this))},_getAvatarImages:function(){NgLogD("AvatarImagePickerController - Retrieving avatar images");this._retrievingAvatars=true;this._mobageUserListItems=[];var p=this;var q=b.Session.getCurrentSession();var n=q.user();var o=[];if(__ngs.r_(__ngs._7).Capabilities.getHasCamera()){o=this._addItem(o,"choosePhotoCamera")}o=this._addItem(o,"choosePhoto");if(q){if(n){n.getAvatars(function(t,u){if(!t){for(var s=0;s<u.length;s++){o=this._addItem(o,u[s])}if(o.length>0&&o.length<this._maxPerRow){this._addRow(o)}NgLogD("AvatarImagePickerController - Retrieved "+u.length+" avatar images");this._onImagesRetrieved()}else{NgLogD("AvatarImagePickerController: Error: "+JSON.stringify(t));var r=function(){this.cleanup()}.bind(this);if(!b.NetworkUtils.wasNetworkDown(r)){b.UIUtils.showAlert(l("Error"),l("Error accessing system.  Please try again later. Error: %1s",t,r))}}}.bind(this))}}},_addRow:function(o){var n=new a(this._maxPerRow,this._choosePhotoCameraCB,this._choosePhotoCB,this._chooseAvatarCB,this._finalCB);n.data={photo:o,AvatarPickerController:this};this._mobageUserListItems.push(n)},_addItem:function(o,n){o.push(n);if(o.length==this._maxPerRow){this._addRow(o);o=[]}return o},_onImagesRetrieved:function(){this._retrievingAvatars=false;this._populateList()},_waitingOnData:function(){return this._retrievingAvatars},_populateList:function(){var o;var r=[];var p=false;if(!this._waitingOnData()){if(this._initialized){this._loadingItemsSection.removeFromParent();this._spinner.removeFromParent()}this._listViewBgInnerPane.addChild(this._listView);var q=[];var n=new f.ListViewSection({rowHeight:this.rowHeight,items:q});for(o=0;o<this._mobageUserListItems.length;o++){q.push(this._mobageUserListItems[o])}if(q.length>0){this._listViewBgInnerPane.addChild(this._listView);r.push(n)}else{b.UIUtils.showToast(l("Could not retrieve Images, Please check your connection"));this.cleanup()}}this._listView.setSections(r)}});var a=f.ListViewItem.subclass({classname:"MyListItemsArray",initialize:function($super,o,p,r,q,n){if($super&&typeof $super=="function"){$super()}this._avatarPickerStyle=b.UIStyle.registeredStyle("social.us.avatarpicker");this._avatarsPerRow=o;this._finalCB=n;this._choosePhotoCameraCB=p;this._choosePhotoCB=r;this._chooseAvatarCB=q;this._hasCamera=__ngs.r_(__ngs._7).Capabilities.getHasCamera()},_onCreateView:function(){return new b.AvatarImagePickerCell(this._avatarsPerRow,this.data.AvatarPickerController,this._choosePhotoCameraCB,this._choosePhotoCB,this._chooseAvatarCB,this._finalCB)},_onSetView:function(n){if(n){n.listItem=this;this.cell=n;n.setImageBordersWithStyle(this._avatarPickerStyle);n.setupListItem(this.data.photo,this._hasCamera)}},_onReleaseView:function(n){}});var m=g.AvatarImagePicker=h.Class.singleton({classname:"AvatarImagePicker",initialize:function(){this._uploadingImage=false},show:function(){if(this._uploadingImage){return}if(this._AvatarPickerController){return}this._AvatarPickerController=(new k(this.choosePhotoCameraCB.bind(this),this.choosePhotoCB.bind(this),this.chooseAvatarCB.bind(this),this.finalCB.bind(this))).retain();this._AvatarPickerController.setOnCleanup(this._cleanupHandler.bind(this))},choosePhotoCameraCB:function(n){this._cleanupOverlay=n;b.AppUpdater.blockApplyingJSUpdates(this);f.choosePhotoCamera(256,256,"avatar.png",{fit:f.FitMode.Fill,gravity:[0.5,0.5]},this._onPhotoPicked.bind(this))},choosePhotoCB:function(o,n){this._cleanupOverlay=n;b.AppUpdater.blockApplyingJSUpdates(this);f.choosePhoto(256,256,"avatar.png",{fit:f.FitMode.Fill,gravity:[0.5,0.5]},this._onPhotoPicked.bind(this),o)},_onPhotoPicked:function(o){if(this._cleanupOverlay){this._cleanupOverlay();this._cleanupOverlay=null}b.AppUpdater.allowApplyingJSUpdates(this);if(this._AvatarPickerController){this._AvatarPickerController.setOnCleanup(null);this._AvatarPickerController.cleanup();this._AvatarPickerController=null}if(o.err||typeof o.filename!="string"||o.filename.indexOf("Error:")!=-1){return}this._uploadingImage=true;var p=h.Capabilities.getBootDir()+"/"+o.filename;var n=b.Session.getCurrentSessionUser();n.emit({uploadingPhoto:1});n.setPhoto(p,this.bind(function(q,r){this._uploadingImage=false;n.emit({uploadingPhotoComplete:1});if(q){b.UIUtils.showToast(l("Failed to update avatar. Try again."))}}))},chooseAvatarCB:function(o,n){this._cleanupOverlay=n;if(this._cleanupOverlay){this._cleanupOverlay();this._cleanupOverlay=null}if(this._AvatarPickerController){this._AvatarPickerController.setOnCleanup(null);this._AvatarPickerController.cleanup();this._AvatarPickerController=null}if(!o){return}this._uploadingImage=true;var p=b.Session.getCurrentSessionUser();p.emit({updatingAvatarImage:1});p.setAvatarImage(o,this.bind(function(q,r){this._uploadingImage=false;p.emit({updatingAvatarImageComplete:1});if(q){b.UIUtils.showToast(l("Failed to update avatar. Try again."))}}))},finalCB:function(){},cleanup:function(){if(this._cleanupOverlay){this._cleanupOverlay();this._cleanupOverlay=null}b.AppUpdater.allowApplyingJSUpdates(this);if(this._AvatarPickerController){this._AvatarPickerController.setOnCleanup(null);this._AvatarPickerController.cleanup();this._AvatarPickerController=null}this._uploadingImage=false},_cleanupHandler:function(){this.cleanup()}})}};__ngs._72={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var h=__ngs.r_(__ngs._5).Core;var g=__ngs.r_(__ngs._59).UI;var b=new (__ngs.r_(__ngs._f).RequireLoader)({ViewController:function(){return __ngs.r_(__ngs._7g).ViewController},MobageStyle:function(){return __ngs.r_(__ngs._6k).MobageStyle},Session:function(){return __ngs.r_(__ngs._o).Session},SupportWebScreen:function(){return __ngs.r_(__ngs._4t).SupportWebScreen},Credentials:function(){return __ngs.r_(__ngs._2r).Credentials},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},ProfileSettingsView:function(){return __ngs.r_(__ngs._au).ProfileSettingsView},NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils},AvatarImagePicker:function(){return __ngs.r_(__ngs._71).AvatarImagePicker}});var a=__ngs.r_(__ngs._n).LocalizedString;var e=__ngs.r_(__ngs._a3).ContentViewController;var f=c.ProfileSettingsController=e.subclass({classname:"ProfileSettingsController",analyticsName:"EditProfile",_isLastNameChanged:false,_isFirstNameChanged:false,_isMottoChanged:false,onSaveCallback:null,initialize:function(){var j=b.Session.getCurrentSession();this._user=j.user();this._commonElements=b.CommonElements},loadView:function($super){var j=new b.ProfileSettingsView();j.setAvatarImageOnClick(this._avatarImage_clickHandler.bind(this));this.setView(j);if(typeof $super=="function"){$super()}this.view()._headerHeightRatio=0},didActivateTab:function($super,j){if(typeof $super=="function"){$super(j)}this.parentController.navController._host.hideLoadingLabel()},_validateLastName:function(){return true},_validateFirstName:function(){return true},startProgress:function(){this._setSaveButtonState(false,a("Saving..."));this.view()._firstNameEdit.setState(g.State.Disabled);this.view()._lastNameEdit.setState(g.State.Disabled);this.view()._editMotto.setState(g.State.Disabled)},stopProgress:function(){if(this._loadingProgess){this._loadingProgess.hide();this._loadingProgess.release();this._loadingProgess=undefined}this._setSaveButtonState(true,a("Save"))},firstNameEditOnFocus:function(){this._isFirstNameChanged=true},lastNameEditOnFocus:function(){this._isLastNameChanged=true},editMottoOnFocus:function(){this._isMottoChanged=true;this._editMottoText=this.view()._editMotto.getText();var k=function(){this.view().replaceEditMotto(this._editMottoText)}.bind(this);var j=function(){this.view().replaceEditMotto(this.view()._editMotto.getText())}.bind(this);this.parentController.navController._host.editMode(k,j)},editMottoOnBlur:function(){this.view().replaceEditMotto(this.view()._editMotto.getText());this.parentController.navController._host.setEditMode(false)},_setSaveButtonState:function(k,j){if(k){this.view()._buttonSaveChanges.setState(g.State.Normal);this._commonElements.standardButton.applyTo(this.view()._buttonSaveChanges)}else{this.view()._buttonSaveChanges.setState(g.State.Disabled);this._commonElements.disabledButton.applyTo(this.view()._buttonSaveChanges)}if(typeof j=="string"){this.view()._buttonSaveChanges.setText(j)}},buttonSupportOnClick:function(){if(b.ServiceHost.navController){b.ServiceHost.navController.pushViewController(new b.SupportWebScreen())}},buttonLogoutOnClick:function(){NgLogD("ProfileSettingsController - User is being logged out");b.Credentials.askUserForLogout(function(){NgLogD("ProfileSettingsController - User logged out")})},buttonSaveChangesOnClick:function(){this.view()._firstNameEdit.setState(g.State.Normal);this.view()._lastNameEdit.setState(g.State.Normal);this.view()._editMotto.setState(g.State.Normal);if(!this.view()._firstNameEdit.ensureTextLegalBeforeSubmit()){return}if(!this.view()._lastNameEdit.ensureTextLegalBeforeSubmit()){return}var j=0;var l=false;var k=null;var m=0;var n=this.bind(function(o){if(j===3){this.stopProgress();this.view().replaceEditMotto(this.view()._editMotto.getText());if(l){if(b.NetworkUtils.wasNetworkDown()){p._setSaveButtonState(true,a("Save"))}else{this.view()._alertDialog.setChoices([a("OK")]);this.view()._alertDialog.setTitle(a("Unable to Save"));if(k){if(k.length>0&&k[k.length-1]!="."){k+="."}this.view()._alertDialog.setText(a("%1s\nSorry, we weren't able to save changes. Please try again later.",k))}else{this.view()._alertDialog.setText(a("Sorry, we weren't able to save changes. Please try again later."))}var p=this;this.view()._alertDialog.onchoice=function(){p._setSaveButtonState(true,a("Save"))};this.view()._alertDialog.show()}}else{this._setSaveButtonState(false,a("Saved!"));setTimeout(this.bind(function(){this._setSaveButtonState(true,a("Save"))}),2000)}return}});if(this._isFirstNameChanged){this.startProgress();this._user.setFirstName(this.view()._firstNameEdit.getText(),(function(o,p){j=j+1;if(o){l=true;k=o;this.view()._firstNameEdit.setState(b.MobageStyle.ErrorState);n(o);return}else{this.view()._firstNameEdit.setState(g.State.Normal)}n()}).bind(this))}else{this.view()._firstNameEdit.setState(g.State.Normal);j=j+1}if(this._isLastNameChanged){this.startProgress();this._user.setLastName(this.view()._lastNameEdit.getText(),(function(o,p){j=j+1;if(o){l=true;k=o;this.view()._lastNameEdit.setState(b.MobageStyle.ErrorState);n(o);return}else{this.view()._lastNameEdit.setState(g.State.Normal)}n()}).bind(this))}else{this.view()._lastNameEdit.setState(g.State.Normal);j=j+1}if(this._isMottoChanged){this.startProgress();this._user.setMotto(this.view()._editMotto.getText(),(function(o,p){j=j+1;if(o){l=true;k=o;this.view()._editMotto.setState(b.MobageStyle.ErrorState);n(o);return}else{this.view()._editMotto.setState(g.State.Normal)}n()}).bind(this))}else{this.view()._editMotto.setState(g.State.Normal);j=j+1}if(this.onSaveCallback){this.onSaveCallback()}},_showErr:function(j){if(!b.NetworkUtils.wasNetworkDown()){this.view()._alertDialog.setTitle(a("Unable to Save"));this.view()._alertDialog.setText(a("Sorry, we weren't able to save changes. Please try again later."));this.view()._alertDialog.setChoices([a("OK")]);this.view()._alertDialog.errDialog.show()}},_avatarImage_clickHandler:function(){b.AvatarImagePicker.show()}})}};__ngs._73={_c:null,_d:function(){var c={exports:{}};var f=c.exports;this._c=c;var h=__ngs.r_(__ngs._5).Core;var e=__ngs.r_(__ngs._59).UI;var b=e.ViewGeometry.Rect;var a=new (__ngs.r_(__ngs._f).RequireLoader)({MobageStyle:function(){return __ngs.r_(__ngs._6k).MobageStyle},ViewController:function(){return __ngs.r_(__ngs._7g).ViewController},User:function(){return __ngs.r_(__ngs._30).User},Session:function(){return __ngs.r_(__ngs._o).Session},Credentials:function(){return __ngs.r_(__ngs._2r).Credentials},AccountSettingsView:function(){return __ngs.r_(__ngs._av).AccountSettingsView},AccountSettingsStyle:function(){return __ngs.r_(__ngs._aw)},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements},NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils}});var d=__ngs.r_(__ngs._2a).Destinations;var j=__ngs.r_(__ngs._n).LocalizedString;var g=__ngs.r_(__ngs._a3).ContentViewController;var k=f.AccountSettingsController=g.subclass({classname:"AccountSettingsController",analyticsName:"AccountSettings",_curUser:null,initialize:function(){var l=a.Session.getCurrentSession();this._curUser=l.user();this._currEmailAddress=this.view()._editEmailAddress.getText();this._currOptAllowFriendPostsOnly=this.view()._optAllowFriendPostsOnly.isChecked();this._currSetOptsIn=this.view()._optNewsUpdates.isChecked();this._currSetOnlyFriendNotifications=this.view()._optPushFriends.isChecked()},loadView:function($super){this.setView(new a.AccountSettingsView());$super();this.view()._headerHeightRatio=0;this._setupBlockedUser()},didActivateTab:function($super,l){$super(l);this.parentController.navController._host.hideLoadingLabel();this.view().refreshOptions()},_setupBlockedUser:function(){this.view()._cleanBlockedUserUIList();var m=a.Session.getCurrentSession().user().getBlockedUserList();var l=0;m.forAll((function(o,n){a.User.getUserWithGamertag(n.gamertag,(function(q,p){this.view().createBlockedUser(q,p,l);l++;o(true)}).bind(this))}).bind(this),(function(n){if(n){NgLogD("Error: AccountSettingsController.js:retrieveBlockedUsers "+n)}this.view()._updateBlockedUserAreaSize(l);this.view()._updateContentSize()}).bind(this))},buttonLogoutOnClick:function(){NgLogD("AccountSettingsController - User is being logged out");a.Credentials.askUserForLogout(function(){NgLogD("AccountSettingsController - User logged out")})},buttonSaveChangesOnClick:function(){var l=0;var n=false;var m=null;if(!this.view()._editEmailAddress.ensureTextLegalBeforeSubmit()){return}var o=this.zombieSafeCallback(function(q,r){if(n){if(a.NetworkUtils.wasNetworkDown()){this._setControlNormal(this.view()._editEmailAddress);this._setSaveButtonState(true,j("Save"));return}if(q){if(q.length>0&&q[q.length-1]!="."){q+="."}this._showErr(j("%1s",q))}else{if(!a.NetworkUtils.wasNetworkDown()){this._showErr(j("Sorry, we weren't able to save changes. Please try again later."))}}this._setSaveButtonState(true,j("Save"));if(r){this._setControlError(r)}}else{this._setSaveButtonState(false,j("Saved!"));setTimeout(this.zombieSafeCallback(function(){this._setSaveButtonState(true,j("Save"))}),2000)}});this._setControlNormal(this.view()._editEmailAddress);this._setSaveButtonState(false,j("Saving..."));this.view()._editEmailAddress.setState(e.State.Normal);if(this._currEmailAddress!=this.view()._editEmailAddress.getText()){NgLogD("Updating emailAddress");this._curUser.setEmailAddress(this.view()._editEmailAddress.getText(),(function(q,r){l=l+1;if(q){n=true;m=q;this.view()._editEmailAddress.setState(a.MobageStyle.ErrorState);o(q,this.view()._editEmailAddress)}else{this._currEmailAddress=this.view()._editEmailAddress.getText();o()}}).bind(this))}else{l=l+1}if(this._currSetOnlyFriendNotifications!==this.view()._optPushFriends.isChecked()){NgLogD("Updating setOnlyFriendNotifications");this._curUser.setOnlyShowFriendNotifications(this.view()._optPushFriends.isChecked(),(function(q,r){l=l+1;if(q){n=true;m=q;o(q)}else{this._currSetOnlyFriendNotifications=this.view()._optPushFriends.isChecked();o()}}).bind(this))}else{l=l+1}if(this._currSetOptsIn!==this.view()._optNewsUpdates.isChecked()){NgLogD("Updating setOptsIn");this._curUser.setOptsIn(this.view()._optNewsUpdates.isChecked(),(function(q,r){l=l+1;if(q){n=true;m=q;o(q)}else{this._currSetOptsIn=this.view()._optNewsUpdates.isChecked();o()}}).bind(this))}else{l=l+1}if(this._currOptAllowFriendPostsOnly!==this.view()._optAllowFriendPostsOnly.isChecked()){NgLogD("Updating optAllowFriendPostsOnly");this._curUser.setAllowFriendPostsOnly(this.view()._optAllowFriendPostsOnly.isChecked(),(function(q,r){l=l+1;if(q){n=true;m=q;o(q)}else{this._currOptAllowFriendPostsOnly=this.view()._optNewsUpdates.isChecked();o()}}).bind(this))}else{l=l+1}var p=function(q,r){if(q){n=true;m=q;o(q)}else{o()}}.bind(this);this._curUser.batchUpdate(function(){this._curUser.setEmailAddress(this.view()._editEmailAddress.getText());this._curUser.setOnlyShowFriendNotifications(this.view()._optPushFriends.isChecked()?1:0);this._curUser.setOptsIn(this.view()._optNewsUpdates.isChecked()?1:0);this._curUser.setAllowFriendPostsOnly(this.view()._optAllowFriendPostsOnly.isChecked()?1:0)}.bind(this),p.bind(this))},_setSaveButtonState:function(m,l){if(m){a.CommonElements.standardButton.applyTo(this.view()._buttonSaveChanges);this.view()._buttonSaveChanges.setState(e.State.Normal)}else{a.CommonElements.disabledButton.applyTo(this.view()._buttonSaveChanges);this.view()._buttonSaveChanges.setState(e.State.Disabled)}if(typeof l=="string"){this.view()._buttonSaveChanges.setText(l)}},_setControlError:function(l){l.setState(a.MobageStyle.ErrorState)},_setControlNormal:function(l){l.setState(e.State.Normal)},_showErr:function(l){this.view()._toast.setText(l);this.view()._toast.show()},buttonSupportOnClick:function(){d.pushScreen(this.parentController.navController,"SupportWebScreen",{},this)},acknowledgementsButtonOnClick:function(){d.pushScreen(this.parentController.navController,"AcknowledgementsWebScreen",{},this)},systemInfoButtonOnClick:function(){d.pushScreen(this.parentController.navController,"SystemInfoScreen",{},this)},blockeduserOnClick:function(l,m){var n=(new e.AlertDialog()).retain();n.setTitle(j("Unblock %1s?",l.gamertag));n.setText(j("Are you sure you want to unblock this user?"));n.setChoices([j("Yes"),j("No")]);n.onchoice=(function(o){if(o.choice===0){l.setBlocked(false,(function(q,s){if(q){NgLogD("Error: AccountSettingsController.js:buttonBlockUser: "+s.error+", "+q);var r=(new e.AlertDialog()).retain();r.setTitle(j("Error"));r.setText(s.error);r.setChoices([j("OK")]);r.onchoice=function(){r.release();r=null};r.show()}else{m.removeFromParent();var p=(new e.AlertDialog()).retain();p.setTitle(j("The user %1s has been unblocked",l.gamertag));p.setChoices([j("OK")]);p.onchoice=function(){p.release();p=null};p.show();this.view()._updateBlockedUserAreaSize(this.view()._blockedUserUIList.length-1);this.view()._blockedUserUIList.splice(m.getIndex(),1);this.view()._updateContentSize();this._refreshBlockedUsers(m.getIndex())}}).bind(this))}n.release();n=null}).bind(this);n.show()},_refreshBlockedUsers:function(o){if(this.view()._blockedUserUIList&&o>=0&&o<this.view()._blockedUserUIList.length){for(var n=o;n<this.view()._blockedUserUIList.length;n++){var l=this.view()._blockedUserUIList[n];var m=l.getIndex();l.setIndex(m-1);l.setFrame([0,(m-1)*this.view()._blockedUserCellHeight,this.view()._contentWidth,this.view()._blockedUserCellHeight])}}}})}};__ngs._74={_c:null,_d:function(){var b={exports:{}};var e=b.exports;this._c=b;var h=__ngs.r_(__ngs._5).Core;var d=__ngs.r_(__ngs._59).UI;var a=new (__ngs.r_(__ngs._f).RequireLoader)({MobageStyle:function(){return __ngs.r_(__ngs._6k).MobageStyle},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements},Session:function(){return __ngs.r_(__ngs._o).Session},PlusRequest:function(){return __ngs.r_(__ngs._28).PlusRequest},PasswordView:function(){return __ngs.r_(__ngs._ax).PasswordView},LargeActionButton:function(){return __ngs.r_(__ngs._ay).LargeActionButton},Credentials:function(){return __ngs.r_(__ngs._2r).Credentials},NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils}});var g=__ngs.r_(__ngs._a3).ContentViewController;var c=__ngs.r_(__ngs._2a).Destinations;var j=__ngs.r_(__ngs._n).LocalizedString;var f=e.PasswordController=g.subclass({classname:"PasswordController",analyticsName:"ChangePassword",_currentPage:0,_CHANGE_PASSWORD:1,_FORGOT_PASSWORD:2,initialize:function(){var k=a.Session.getCurrentSession();this._user=k.user();this._currentPage=this._CHANGE_PASSWORD},loadView:function($super){this.setView(new a.PasswordView());$super();this.view()._headerHeightRatio=0},destroy:function(){},didActivateTab:function($super,k){$super(k);this.parentController.navController._host.hideLoadingLabel();this._changeContent(this._CHANGE_PASSWORD)},_changeContent:function(k){if(this._currentPage==k){return}if(k==this._CHANGE_PASSWORD){this.view().showChangePass()}else{if(k==this._FORGOT_PASSWORD){this.view().showForgotPass()}}this._currentPage=k},_setControlError:function(k){k.setState(a.MobageStyle.ErrorState)},buttonSavePasswordOnClick:function(){if(!this.view()._editCurrPassword.ensureTextLegalBeforeSubmit()||!this.view()._editNewPassword.ensureTextLegalBeforeSubmit()||!this.view()._editReEnterPassword.ensureTextLegalBeforeSubmit()){return}if(this.view()._editReEnterPassword.getText()!==this.view()._editNewPassword.getText()){this._setControlError(this.view()._editNewPassword);this._setControlError(this.view()._editReEnterPassword);this._showErr(j("New passwords do not match."));return}this._user.updatePassword(this.view()._editCurrPassword.getText(),this.view()._editNewPassword.getText(),this.view()._editReEnterPassword.getText(),(function(l,m){var k=null;if(l){if(!a.NetworkUtils.wasNetworkDown()){if(l.indexOf("password_invalid")!==-1){l=j("Wrong password.");this._setControlError(this.view()._editCurrPassword)}this._showErr(l);this.view()._buttonSavePassword.setText(j("Error"));this.view()._buttonSavePassword.setState(d.State.Disabled);a.LargeActionButton.applyTo(this.view()._buttonSavePassword)}}else{this.view()._buttonSavePassword.setText(j("Saved!"));this.view()._buttonSavePassword.setState(d.State.Disabled);a.LargeActionButton.applyTo(this.view()._buttonSavePassword)}setTimeout(this.bind(function(){this.view()._buttonSavePassword.setText(j("Save"));this.view()._buttonSavePassword.setState(d.State.Normal);a.CommonElements.standardButton.applyTo(this.view()._buttonSavePassword)}),2000)}).bind(this));this.view()._buttonSavePassword.setState(d.State.Disabled);this.view()._buttonSavePassword.setText(j("Saving..."));a.CommonElements.disabledButton.applyTo(this.view()._buttonSavePassword)},_showErr:function(k){this.view()._toast.setText(k);this.view()._toast.show()},buttonForgotPasswordOnClick:function(){this._changeContent(this._FORGOT_PASSWORD)},buttonCancelForgotPasswordOnClick:function(){this._changeContent(this._CHANGE_PASSWORD)},buttonSendEmailOnClick:function(){if(!this.view()._editEmailAddress.ensureTextLegalBeforeSubmit()){return}this.view()._progressDialog.show();a.PlusRequest.sendPasswordResetEmailWithAddress(this.view()._editEmailAddress.getText(),this.bind(function(k){this.view()._progressDialog.hide();NgLogD("Mobage/ForgotPassword/Plus Request response="+JSON.stringify(k));if(!k){this.view()._toast.setText(j("Email sent!"));this.view()._toast.show();this._changeContent(this._CHANGE_PASSWORD);if(this._onCompleteCallback){this._onCompleteCallback()}if(this.view()._editEmailAddress){this.view()._editEmailAddress.setText("")}}else{if(k.indexOf("email")!=-1){this.view()._editEmailAddress.setState(a.MobageStyle.ErrorState)}this._showErr(k)}}))},buttonSupportOnClick:function(){c.pushScreen(this.parentController.navController,"SupportWebScreen",{},this)},buttonLogoutOnClick:function(){NgLogD("PasswordController - User is being logged out");a.Credentials.askUserForLogout(function(){NgLogD("PasswordController - User logged out")})}})}};__ngs._75={_c:null,_d:function(){var f={exports:{}};var e=f.exports;this._c=f;var h=__ngs.r_(__ngs._59).UI;var c=__ngs.r_(__ngs._n).LocalizedString;var b=new (__ngs.r_(__ngs._f).RequireLoader)({Session:function(){return __ngs.r_(__ngs._o).Session},SessionListener:function(){return __ngs.r_(__ngs._o).SessionListener},MessageListener:function(){return __ngs.r_(__ngs._w).MessageListener},DirtyFriendsListener:function(){return __ngs.r_(__ngs._4q).DirtyFriendsListener},IdleActor:function(){return __ngs.r_(__ngs._9s).IdleActor},ReportUserModalDialog:function(){return __ngs.r_(__ngs._5m).ReportUserModalDialog},Blacklist:function(){return __ngs.r_(__ngs._3a).Blacklist},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},AvatarImagePicker:function(){return __ngs.r_(__ngs._71).AvatarImagePicker},ProfileView:function(){return __ngs.r_(__ngs._az).ProfileView},UserProfileStyle:function(){return __ngs.r_(__ngs._b0)},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},VerticalTabViewSizing:function(){return __ngs.r_(__ngs._9g).VerticalTabViewSizing},FriendsGridPanelController:function(){return __ngs.r_(__ngs._b1).FriendsGridPanelController},WallListViewSectionController:function(){return __ngs.r_(__ngs._b2).WallListViewSectionController},RecentlyPlayedGamesGridPanelController:function(){return __ngs.r_(__ngs._b3).RecentlyPlayedGamesGridPanelController},Credentials:function(){return __ngs.r_(__ngs._2r).Credentials}});var g=__ngs.r_(__ngs._a3).ContentViewController;var a=e.UserProfileController=g.subclass({classname:"UserProfileController",analyticsName:"UserProfile",_switchTabToFriendsCb:null,_switchTabToGamesCb:null,_dirtyFriendsListener:null,equals:function(j){return this.classname==j.classname&&this._curUser.is(j._curUser)},initialize:function($super,j,l,k){this._switchTabToFriendsCb=l;this._switchTabToGamesCb=k;$super();this._curUser=j;this._idleActor=(new b.IdleActor()).retain();this._idleAction=function(){console.log("_idleAction+");this.view().content.reloadData();console.log("_idleAction-")}.bind(this);this._dirtyFriendsListener=new b.DirtyFriendsListener(this._dirtyFriendsListener_callback.bind(this),this._curUser);if(b.Session.isCurrentSessionUser(this._curUser)&&this._curUser.usesGuestLogin()){this._dirtySessionListener=new b.SessionListener(this._dirtySessionListener_callback.bind(this))}},destroy:function(){this._idleActor.release();if(this._dirtyFriendsListener){this._dirtyFriendsListener.destroy();this._dirtyFriendsListener=null}if(this._dirtySessionListener){this._dirtySessionListener.destroy();this._dirtySessionListener=null}if(this._wallController){this._wallController.release();this._wallController=null}if(this._friendsPanelController){this._friendsPanelController.release();this._friendsPanelController=null}if(this._recentGamesPanelController){this._recentGamesPanelController.release();this._recentGamesPanelController=null}},getDynamicTabTitle:function(){var j=this._curUser.gamertag;return(j.length>7)?c("%1s's Profile",j.substring(0,7)+"..."):c("%1s's Profile",j)},reloadRequested:function(j){this.logd("Reload requested by ",(j||{}).classname,"+",this.view().content.classname);this._idleActor.waitForIdleBeforeAction(this._idleAction);this.logd("Reload requested by ",(j||{}).classname,"-")},loadView:function($super){if(!this._view){this._wallController=(new b.WallListViewSectionController()).retain();this._wallController.showFriendsOnlyModalCb=this.showFriendsOnlyModal_callback.bind(this);this._wallController.setController(this);this._friendsPanelController=(new b.FriendsGridPanelController()).retain();this._friendsPanelController.headerViewAllOnClick=this._friendsViewAll_clickHandler.bind(this);this._friendsPanelController.setController(this);this._recentGamesPanelController=(new b.RecentlyPlayedGamesGridPanelController()).retain();this._recentGamesPanelController.headerViewAllOnClick=this._recentGamesViewAll_clickHandler.bind(this);this._recentGamesPanelController.setController(this);var j=new b.ProfileView();j.setWallSection(this._wallController.section());j.setFriendsPanel(this._friendsPanelController.section());j.setRecentlyPlayedGamesGridPanel(this._recentGamesPanelController.section());j.setAvatarImageOnClick(this._avatarImage_clickHandler.bind(this));this.setView(j);this._createButtons()}if(typeof $super=="function"){$super()}if(this._curUser===b.Session.getCurrentSession().user()){this._curUser.clearUnreadWallPostCount()}},_createButtons:function(){this.view().setButtons([[c("Unfriend User"),this._unfriendUserBtn_clickHandler.bind(this)],[c("Report User"),this._reportUserBtn_clickHandler.bind(this)],[c("Block User"),this._blockUserBtn_clickHandler.bind(this)]]);this.view().setButtonVisibleAtIndex(0,false);this._checkRelationship()},willActivateTab:function($super,j){if(typeof $super=="function"){$super(j)}if(!this.loaded){this._wallController.setUser(this._curUser);this._friendsPanelController.setUser(this._curUser);this._recentGamesPanelController.setUser(this._curUser);this.view().updateUser(this._curUser);this.loaded=true}},didActivateTab:function($super){if(typeof $super=="function"){$super()}this.parentController.navController._host.hideLoadingLabel();setTimeout(this.bind(function(){this._checkRelationship()}),50)},willDeactivateTab:function($super,j){this._wallController.cleanupTransients();$super(j)},_checkRelationship:function(){this._curUser.isBlockedUser=false;var j=b.Session.getCurrentSession().user().getBlockedUserList();j.forAll(this.zombieSafeCallback(function(m,k,l){if(k.is(this._curUser)){this._curUser.isBlockedUser=true;m(false)}else{m(true)}}),this.zombieSafeCallback(function(k){this._checkRelationshipComplete();if(k){NgLogE("UserProfileController._checkRelationship error :"+k)}}))},_checkRelationshipComplete:function(){this.logd("_checkRelationshipComplete this._curUser.isBlockedUser:"+this._curUser.isBlockedUser);if(this._curUser.isMutualFriend||this._curUser.localRelation==="friend"){this.view().setButtonVisibleAtIndex(0,true)}else{this.view().setButtonVisibleAtIndex(0,false)}if(this._curUser.isBlockedUser){this.view().setButtonVisibleAtIndex(2,false)}else{if(typeof this._curUser.isBlockedUser!=="undefined"&&this._curUser.isBlockedUser){this.view().setButtonVisibleAtIndex(2,true)}}},_dirtyFriendsListener_callback:function(){if(this.isDestroyed()){if(this._dirtyFriendsListener){this._dirtyFriendsListener.destroy();this._dirtyFriendsListener=null}return}this._checkRelationship()},_dirtySessionListener_callback:function(j){if(this.isDestroyed()){if(this._dirtySessionListener){this._dirtySessionListener.destroy();this._dirtySessionListener=null}return}this._curUser=j.user();this._wallController.setUser(this._curUser);this._friendsPanelController.setUser(this._curUser);this._recentGamesPanelController.setUser(this._curUser);this.view().updateUser(this._curUser)},showFriendsOnlyModal_callback:function(){var j=new d(this._curUser,function(){if(this.view()._userInfoItem){this.view()._userInfoItem.addFriendBtn_clickHandler()}}.bind(this));j.show()},_recentGamesViewAll_clickHandler:function(){if(typeof this._switchTabToGamesCb=="function"){this._switchTabToGamesCb()}},_friendsViewAll_clickHandler:function(){if(typeof this._switchTabToFriendsCb=="function"){this._switchTabToFriendsCb()}},_avatarImage_clickHandler:function(){var j=b.Session.getCurrentSession();if(j.user()&&j.user().usesGuestLogin()){b.Credentials.showRegistration(null,true,true,"tiered",null,"pickAvatar");return}if(this._wallController&&this._wallController.section()){this._wallController.section().setPostingMessageBlur()}b.AvatarImagePicker.show()},_unfriendUserBtn_clickHandler:function(){var j=(new h.AlertDialog()).retain();j.setTitle(c("Unfriend %1s?",this._curUser.gamertag));j.setText(c("Are you sure you want to unfriend this user?"));j.setChoices([c("Yes"),c("No")]);j.onchoice=function(k){if(k.choice===0){b.Session.getCurrentSession().user().deleteBuddy(this._curUser,function(l,m){this._curUser.unfriending=false;if(l){this._showErrorToast(l)}else{this._curUser.invited=false;this._curUser.localRelation="stranger";this._curUser.isMutualFriend=false;this._checkRelationship();this.view().setButtonVisibleAtIndex(0,false);b.UIUtils.showAlert(c("The user %1s was Unfriended",this._curUser.gamertag))}this._updateAddButton()}.bind(this))}}.bind(this);j.show()},_reportUserBtn_clickHandler:function(){this._modalDialogObj=new b.ReportUserModalDialog(this._curUser)},_blockUserBtn_clickHandler:function(){var j=(new h.AlertDialog()).retain();j.setTitle(c("Block %1s?",this._curUser.gamertag));j.setText(c("Are you sure you want to block this user?"));j.setChoices([c("Yes"),c("No")]);j.onchoice=function(k){if(k.choice===0){this._curUser.setBlocked(true,function(l,m){if(l){NgLogD("Error: UserProfileController.js:buttonBlockUser: "+m.error+", "+l);b.UIUtils.showAlert(c("Error"),l)}else{this.view().setButtonVisibleAtIndex(2,false);b.UIUtils.showAlert(c("The user %1s has been blocked, and can be unblocked from Settings",this._curUser.gamertag))}}.bind(this))}j.release();j=null}.bind(this);j.show()}});var d=e.AvailableFriendAlertDialog=h.AlertDialog.subclass({classname:"AvailableFriendAlertDialog",initialize:function($super,k,j){$super();this.setTitle(c("Available for Friends"));switch(k.localRelation){case"follower":this.setText(c("To post a comment, accept %1s's Friend request first!",k.gamertag));this.setChoices([c("Accept"),c("Not Now")]);break;case"requested":this.setText(c("%1s needs to accept your Friend request first!",k.gamertag));this.setChoices([c("OK")]);break;default:this.setText(c("To post a comment, send %1s a Friend request first!",k.gamertag));this.setChoices([c("Send"),c("Not Now")]);break}this.onchoice=function(l){if(l.choice===0&&k.localRelation!="requested"){j()}this.hide()}.bind(this)}})}};__ngs._76={_c:null,_d:function(){var e={exports:{}};var A=e.exports;this._c=e;var b=__ngs.r_(__ngs._5).Core;var m=__ngs.r_(__ngs._59).UI;var k=__ngs.r_(__ngs._4).Device;var l=__ngs.r_(__ngs._2z).Assets;var w=__ngs.r_(__ngs._6k).MobageStyle;var g=__ngs.r_(__ngs._5y).NavigableViewController;var j=__ngs.r_(__ngs._2s).CredentialsHost;var u=__ngs.r_(__ngs._30);var q=__ngs.r_(__ngs._o);var h=__ngs.r_(__ngs._6l).RegistrationRecord;var B=__ngs.r_(__ngs._b4).RegistrationWebScreen;var f=__ngs.r_(__ngs._b5).RegistrationContainer;var t=__ngs.r_(__ngs._b6).RegistrationStart;var c=__ngs.r_(__ngs._b7).RegistrationLogin;var d=__ngs.r_(__ngs._b8).RegistrationLinkFB;var s=__ngs.r_(__ngs._b9).RegistrationSignUp;var r=__ngs.r_(__ngs._ba).RegistrationFinish;var z=__ngs.r_(__ngs._bb).RegistrationFBFinish;var p=__ngs.r_(__ngs._bc).RegistrationFBConfirm;var n=__ngs.r_(__ngs._bd).UpgradeUserStart;var a=__ngs.r_(__ngs._be).RegistrationGuest;var y=__ngs.r_(__ngs._q).MobageAnalytics;var x=new (__ngs.r_(__ngs._f).RequireLoader)({UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},ForgotPasswordModalDialog:function(){return __ngs.r_(__ngs._5m).ForgotPasswordModalDialog},Facebook:function(){return __ngs.r_(__ngs._2m).Facebook},LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},CredentialsR:function(){return __ngs.r_(__ngs._2r)}});var o=b.MessageListener.subclass({classname:"RegistrationKeyListener"});var v=A.FacebookRegistration=g.subclass({classname:"FacebookRegistration",_onCompleteCallback:null,_registrationRecord:null,_currentScreen:null,_previousScreen:null,_upgradeUserBool:false,initialize:function($super,D,L,E,G,F,H){$super();var C="xxxxxxxxxxxxxxxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(O){var N=Math.random()*16|0,M=O=="x"?N:(N&3|8);return M.toString(16)});y.setLoginRegEventingSession(C,H);this._lockedForDialog=0;this._onCompleteCallback=D;this._upgradeUserBool=E;this._allowFacebookLogin=L=="enabled"||L=="true"||L===true;this._allowGuestLogin=G=="tiered"||G=="true"||G===true;this._registrationRecord=new h();if(this._upgradeUserBool){y.reportLoginRegEvent("UPGRADESTARTINITIALIZE")}else{y.reportLoginRegEvent("REGSTARTINITIALIZE")}this.registrationContainer=new f(this.close.bind(this),this._upgradeUserBool);this.registrationContainer.setFrame(0,0,m.Window.getWidth(),m.Window.getHeight());this.view().addChild(this.registrationContainer);this.view().setAlpha(0);m.animate(function(){this.view().setAlpha(1)}.bind(this),j.navController.transitionAnimationTime,function(){});this.kListener=new o();x.UnspammableButton.addDeviceKeyListener(this.kListener,this.onKeyPressed.bind(this),999999);this._currentScreen="RegistrationStart";this._previousScreen="RegistrationStart";if(!this._upgradeUserBool){this.registrationStart=new t(this.registrationContainer.containerFrame,this.initMobageLogin.bind(this),this.initMobageSignup.bind(this),this.authorizeFacebook.bind(this),this.initMobageGuest.bind(this),this._allowFacebookLogin,this._allowGuestLogin)}else{this.registrationStart=new n(this.registrationContainer.containerFrame,this.authorizeFacebook.bind(this),this.initMobageSignup.bind(this),this.startOver.bind(this),this._allowFacebookLogin)}this.registrationLogin=new c(this.registrationContainer.containerFrame,this.initRegistrationStart.bind(this),this.userLogin.bind(this),this.forgotPasswordModal.bind(this));var K=b.Capabilities._getAccts();var J="";for(var I in K){if(K[I]["com.google"]){if(u.User.emailAddressLooksValid(K[I]["com.google"])){J=K[I]["com.google"];break}}}this.registrationSignUp=new s(this.registrationContainer.containerFrame,this.onSignupBack.bind(this),this.validateSignUp.bind(this),this.termsOfService.bind(this),this.privacyPolicy.bind(this),J,this._upgradeUserBool);this.registrationFinish=new r(this.registrationContainer.containerFrame,this.createNewUser.bind(this),this._upgradeUserBool);this.registrationFBFinish=new z(this.registrationContainer.containerFrame,this.createNewFBUser.bind(this),this.linkFBUser.bind(this),this._upgradeUserBool);this.registrationFBConfirm=new p(this.registrationContainer.containerFrame,this.initRegistrationStart.bind(this),this.userFBLogin.bind(this),this.forgotPasswordModal.bind(this));this.registrationLinkFB=new d(this.registrationContainer.containerFrame,this.initRegistrationStart.bind(this),this.userFBLogin.bind(this),this.forgotPasswordModal.bind(this));switch(F){case"signUp":this._currentScreen=null;this.initMobageSignup();break;case"facebook":this.initRegistrationStart();this.authorizeFacebook();break;default:this.initRegistrationStart();break}u.User.hasNonGuestUsersForDevice(function(M,N,O){this._guestHasNonGuestAccounts=N;this._guestExistingAccounts=O;this.registrationGuest=new a(this.registrationContainer.containerFrame,this.initRegistrationStart.bind(this),this.guestSignUp.bind(this),this.termsOfService.bind(this),this.privacyPolicy.bind(this),N)}.bind(this))},onKeyPressed:function(D){var C=this;if(D.code===k.KeyEmitter.Keycode.back){y.reportLoginRegEvent("RegBack",{Origin:this._currentScreen,Destination:this._previousScreen});NgLogD("Mobage/FacebookRegistration - RegBack, {Origin: "+this._currentScreen+", Destination: "+this._previousScreen+"}");switch(this._currentScreen){case"RegistrationStart":C.askUserForExit();break;case"RegistrationFBFinish":C.askUserForExit();break;case"RegistrationFinish":C.askUserForExit();break;case"RegistrationLogin":C.initRegistrationStart(true);break;case"RegistrationSignUp":C.onSignupBack();break;case"RegistrationFBConfirm":C.initRegistrationStart(true);break;case"RegistrationWebView":if(j.navController.getTopViewController()=="RegistrationWebScreen"){j.navController.popViewController();this._currentScreen=this._previousScreen}break;case"RegistrationLinkFB":if(C._previousScreen=="RegistrationStart"){C.initRegistrationStart(true)}else{C.initFacebookFinishSignUp(true)}break;default:C.initRegistrationStart(true);break}return true}return false},askUserForExit:function(){if(this._upgradeUserBool){this.close()}else{y.reportLoginRegEvent("RegAskUserForExit",{CurrentScreen:this._currentScreen});NgLogD("RegAskUserForExit");var C=new m.AlertDialog();C.setTitle(x.LocText("Quit"));C.setText(x.LocText("Are you sure you want to quit?"));C.setChoices([x.LocText("Yes"),x.LocText("No")]);C.show();C.onchoice=function(D){if(D.choice===0){C.hide();k.LifecycleEmitter.exitProcess()}}.bind(this)}},animateOutAndClose:function(C,D){this.view().setAlpha(254/255);m.animate(function(){this.view().setAlpha(0)}.bind(this),j.navController.transitionAnimationTime,function(){}.bind(this));setTimeout(function(){this.view().setFrame([0,0,0,0])}.bind(this),j.navController.transitionAnimationTime-50);setTimeout(function(){var E=this._onCompleteCallback;this.destroy();E(C,D)}.bind(this),j.navController.transitionAnimationTime)},destroy:function(){NgLogD("DESTROY FacebookRegistration");var C=j.navController.handleViewControllerSelfDestroy(this);if(!C){NgLogW("Warning: Failed to removed FacebookRegistration from view stack on destroy.")}if(this.kListener){this.kListener.destroy()}if(this.registrationContainer){this.registrationContainer.destroy()}if(this.registrationStart){this.registrationStart.destroy()}if(this.registrationLogin){this.registrationLogin.destroy()}if(this.registrationSignUp){this.registrationSignUp.destroy()}if(this.registrationFinish){this.registrationFinish.destroy()}if(this.registrationFBFinish){this.registrationFBFinish.destroy()}if(this.registrationFBConfirm){this.registrationFBConfirm.destroy()}if(this.registrationLinkFB){this.registrationLinkFB.destroy()}if(this.registrationGuest){this.registrationGuest.destroy()}},loadView:function($super){$super()},initRegistrationStart:function(C){if(!this.registrationContainer.shouldAllowTransition()){return}NgLogD("initRegistrationStart");this._previousScreen=this._currentScreen;this._currentScreen="RegistrationStart";NgLogD("RegistrationStartInitialize");this.registrationContainer.animateInNewView(this.registrationStart,C)},onSignupBack:function(){if(this._previousScreen===null){this.close()}else{this.initRegistrationStart(true)}},initFacebookFinishSignUp:function(C){if(!this.registrationContainer.shouldAllowTransition()){return}NgLogD("Init Facebook Finalize Sign Up View");this._previousScreen=this._currentScreen;this._currentScreen="RegistrationFBFinish";y.reportLoginRegEvent(!this._upgradeUserBool?"RegFBFinishInitialize":"UPGRADEFBFinishInitialize",{PreviousScreen:this._previousScreen});NgLogD("RegistrationFBFinishInitialize");this.registrationContainer.animateInNewView(this.registrationFBFinish);this.realtimeNameValidation(this.registrationFBFinish,C)},initFacebookConfirmation:function(){if(!this.registrationContainer.shouldAllowTransition()){return}NgLogD("Init Facebook Confirmation View");this._previousScreen=this._currentScreen;this._currentScreen="RegistrationFBConfirm";y.reportLoginRegEvent("RegFBConfirmInitialize",{PreviousScreen:this._previousScreen});NgLogD("RegistrationFBConfirmInitialize");this.registrationContainer.animateInNewView(this.registrationFBConfirm)},initMobageLogin:function(){if(!this.registrationContainer.shouldAllowTransition()){return}NgLogD("Init Mobage Login View "+this);this._previousScreen=this._currentScreen;this._currentScreen="RegistrationLogin";y.reportLoginRegEvent("RegLoginInitialize",{PreviousScreen:this._previousScreen});NgLogD("RegistrationLoginInitialize");this.registrationContainer.animateInNewView(this.registrationLogin)},initMobageSignup:function(){if(!this.registrationContainer.shouldAllowTransition()){return}NgLogD("Init Mobage Signup View");this._previousScreen=this._currentScreen;this._currentScreen="RegistrationSignUp";y.reportLoginRegEvent(!this._upgradeUserBool?"RegSignUpInitialize":"UPGRADESignUpInitialize",{PreviousScreen:this._previousScreen});NgLogD("RegistrationSignUpInitialize");this.registrationContainer.animateInNewView(this.registrationSignUp)},initMobageGuest:function(){if(!this.registrationContainer.shouldAllowTransition()){return}if(!this.registrationGuest){NgLogD("Mobage/initMobageGuest: Waiting for >=G2 info to come back");return}NgLogD("Init Mobage Guest View");this._previousScreen=this._currentScreen;this._currentScreen="RegistrationGuest";var D=this._guestHasNonGuestAccounts?"REGGUESTINITIALIZEG2":"REGGUESTINITIALIZE";var C={PreviousScreen:this._previousScreen,accounts:this._guestExistingAccounts};y.reportLoginRegEvent(D,C);NgLogD("RegistrationGuestInitialize");this.registrationContainer.animateInNewView(this.registrationGuest)},initFacebookLink:function(){if(!this.registrationContainer.shouldAllowTransition()){return}NgLogD("Init Facebook Link View "+this);NgLogD("SET initFacebookLink BACK FUNC for: "+this._currentScreen);if(this._currentScreen=="RegistrationStart"){this.registrationLinkFB.setBackFunc(this.initRegistrationStart.bind(this))}else{this.registrationLinkFB.setBackFunc(this.initFacebookFinishSignUp.bind(this))}this._previousScreen=this._currentScreen;this._currentScreen="RegistrationLinkFB";y.reportLoginRegEvent("RegFBLinkInitialize",{PreviousScreen:this._previousScreen});NgLogD("RegistrationFBLinkInitialize");this.registrationContainer.animateInNewView(this.registrationLinkFB)},initRegistrationFinish:function(){if(!this.registrationContainer.shouldAllowTransition()){return}this._previousScreen=this._currentScreen;this._currentScreen="RegistrationFinish";y.reportLoginRegEvent(!this._upgradeUserBool?"RegFinishInitialize":"UPGRADEFinishInitialize",{PreviousScreen:this._previousScreen});NgLogD("RegistrationFinishInitialize");this.registrationContainer.animateInNewView(this.registrationFinish);this.realtimeNameValidation(this.registrationFinish)},forgotPasswordModal:function(C){y.reportLoginRegEvent("RegForgotPasswordInitialized");NgLogD("RegistrationForgotPasswordModal Initialized");this._modalDialogObj=new x.ForgotPasswordModalDialog();if(C.length>1&&C.indexOf("@")!==-1){this._modalDialogObj.setUserEmail(C)}},termsOfService:function(){this._previousScreen=this._currentScreen;this._currentScreen="RegistrationWebView";y.reportLoginRegEvent("RegTermsOfService");NgLogD("RegistrationTermsOfService Initialized");j.navController.pushViewController(new B("http://app.mobage.com/terms"))},privacyPolicy:function(){this._previousScreen=this._currentScreen;this._currentScreen="RegistrationWebView";y.reportLoginRegEvent("RegPrivacyPolicy");NgLogD("RegistrationPrivacyPolicy Initialized");j.navController.pushViewController(new B("http://app.mobage.com/privacy"))},guestSignUp:function(){NgLogD("Initialize guestSignUp");if(!this.showProgressDialog("Logging into Mobage","Please wait...")){return}var C=this;var D=this._guestHasNonGuestAccounts?"REGGUESTCLICKG2":"REGGUESTCLICK";var F={accounts:this._guestExistingAccounts};y.reportLoginRegEvent(D,F);var E=q.Session.getCurrentSession();E.newSessionAsGuest(this.bind(function(G,H){C.hideProgressDialog();if(G){NgLogD("************** Failed Login Error: "+JSON.stringify(G)+"\n");var I=this._guestHasNonGuestAccounts?"REGDATAGUESTUSERG2ERR":"REGDATAGUESTUSERERR";y.reportLoginRegEvent(I,{Error:JSON.stringify(G)});x.UIUtils.showToast(""+G)}else{NgLogD("Successful login! ********************\n");y.reportLoginRegEvent(this._guestHasNonGuestAccounts?"REGDATAGUESTUSERCOMPLETEG2":"REGDATAGUESTUSERCOMPLETE");this.animateOutAndClose(H.user(),null)}}))},startOver:function(){v.startOver()},$startOver:function(F){if(F){var C="xxxxxxxxxxxxxxxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(I){var H=Math.random()*16|0,G=I=="x"?H:(H&3|8);return G.toString(16)});y.setLoginRegEventingSession(C,F)}var D=q.Session.getCurrentSession();if(D&&D.user()&&D.user().usesGuestLogin()){var E=new m.AlertDialog();E.setTitle(x.LocText("Start over?"));E.setText(x.LocText("If you start over, you will lose all progress and purchases made in this game."));E.setChoices([x.LocText("Cancel"),x.LocText("Start Over")]);E.onchoice=function(G){if(G.choice===1){y.reportLoginRegEvent("UPGRADESTARTOVERCONFIRM");x.CredentialsR.Credentials.clearGuestUser()}else{y.reportLoginRegEvent("UPGRADESTARTOVERCANCEL")}};E.show()}},close:function(){if(this._upgradeUserBool){y.reportLoginRegEvent("UPGRADEDISMISS")}var C=q.Session.getCurrentSession();this.animateOutAndClose(C.user(),"cancelled")},showProgressDialog:function(D,C){this._lockedForDialog++;if(this._lockedForDialog>1){return false}if(!this.progressDialog){this.progressDialog=new m.ProgressDialog({title:D,text:C})}this.progressDialog.show();return true},hideProgressDialog:function(){this._lockedForDialog--;if(this.progressDialog){this.progressDialog.hide();this.progressDialog.destroy();this.progressDialog=undefined}},realtimeNameValidation:function(E){var D=this;var C=E.getGamertagField();var F=E.getGamertagFieldImage();C.setOnChange(D.bind(function(){D._registrationRecord.gamername=C.getText();NgLogD("GAMERNAME: "+C.getText());NgLogD("self._registrationRecord.gamername: "+D._registrationRecord.gamername);D._registrationRecord.testRemoteGamername(function(G){if(G){NgLogD("errors: "+G);C.setState(w.ErrorState);F.setImage(l.image("status_unavailable.png"))}else{F.setImage(l.image("status_available.png"));C.setState(m.State.Normal)}})}))},showAlertDialog:function(G,F,D,C){var E=new m.AlertDialog();E.setTitle(x.LocText(G));E.setText(x.LocText(F));if(D){if(C){E.setChoices([x.LocText("Quit"),x.LocText("Try Again")]);E.onchoice=function(H){if(H.choice===0){k.LifecycleEmitter.exitProcess()}else{C()}}}else{E.setChoices([x.LocText("Exit")]);E.onchoice=function(H){k.LifecycleEmitter.exitProcess()}}}else{E.setChoices([x.LocText("OK")])}E.show()},authorizeFacebook:function(){var C=this;x.Facebook.getSession(function(E){y.reportLoginRegEvent(!C._upgradeUserBool?"RegDataFBSessionAuthorize":"UPGRADEFBSessionAuthorize");NgLogD("RegDataFBSessionAuthorize");var D=false;E.authorize(function(){var F=E.getUserData();if(!F.email){C.showAlertDialog("Error Connecting","Couldn't connect using Facebook at this time. Try again later.");return}C.showProgressDialog("Authorizing Facebook","Please wait...");if(C._upgradeUserBool){E.seeIfUpgradeable(F.id,F.email,function(I,G,J){C.hideProgressDialog();if(I){y.reportLoginRegEvent("UPGRADEFBERR",{Error:JSON.stringify(I)});C.showAlertDialog("Error Connecting","Couldn't connect using Facebook at this time. Try again later.")}else{if(!G){y.reportLoginRegEvent("UPGRADEFBEXISTS");var K=new m.AlertDialog();K.setTitle(x.LocText("Account Already Exists"));K.setText(x.LocText('This Facebook account has already been linked to a Mobage account. To log in with this Facebook account, tap the "Start Over & Log In" button.'));K.setChoices([x.LocText("OK")]);K.onchoice=function(L){y.reportLoginRegEvent("UPGRADEFBREJECT")};K.show()}else{if(J){y.reportLoginRegEvent("UPGRADEFBEXISTS");var H=new m.AlertDialog();H.setTitle(x.LocText("Email Already In Use"));H.setText(x.LocText('A Mobage account already exists with your Facebook account\'s email. To log in with that account, tap the "Start Over & Log In" button and log in using that email.'));H.setChoices([x.LocText("OK")]);H.onchoice=function(L){y.reportLoginRegEvent("UPGRADEFBREJECT")};H.show()}else{C._registrationRecord.gamername=F.email.split("@",2)[0].replace(/[^a-zA-Z 0-9 \:\-\(\)]+/g,"").substring(0,13);C.showProgressDialog("Validating Gamer Name","Please wait...");y.reportLoginRegEvent("UPGRADEFBNEW");C._registrationRecord.testRemoteGamername(function(M,L){C.hideProgressDialog();if(L.length>0){C._registrationRecord.gamername=L[0];y.reportLoginRegEvent("UPGRADEFBSUGGESTNAME")}C.registrationFBFinish.setGamerName(C._registrationRecord.gamername);NgLogD("~~~init confirmation screen (FOR UPGRADE) BRAND NEW USER - "+C._registrationRecord.gamernameh);C.initFacebookFinishSignUp()})}}}})}else{E.loginToMobage(F.id,F.email,function(G,H){y.reportLoginRegEvent("RegDataFBLoginToMobage");NgLogD("RegDataFBLoginToMobage");C.hideProgressDialog();if(G||!H){NgLogD("~~~fbSession.loginToMobage ERR: "+G);NgLogD("~~~fbSession.loginToMobage data: "+H);C.showAlertDialog("Error Connecting","Couldn't connect using Facebook at this time. Try again later.")}else{y.reportLoginRegEvent("RegDataFBUserInfo",{FBUser:JSON.stringify(F)});NgLogD("registrationFBConfirm/registrationSignUp email set: "+F.email);C.registrationFBConfirm.setUserEmail(F.email);if(H.didLogIn){y.reportLoginRegEvent("RegDataFBAutoLogIn");NgLogD("RegDataFBAutoLogIn");y.reportLoginRegEvent("RegDataFBLoginComplete");NgLogD("RegDataFBLoginComplete");C.animateOutAndClose(H.mobageSession.user(),null)}else{if(H.foundMobageEmail){NgLogD("~~~init confirmation screen FBID IS NEW, BUT EMAIL LOOKS FAMILIAR");y.reportLoginRegEvent("RegDataFBEmailTaken");NgLogD("RegDataFBEmailTaken");C.registrationFBConfirm.setProfileValues(H.userImage,H.userName,H.userGamertag);C.initFacebookConfirmation()}else{C._registrationRecord.gamername=F.email.split("@",2)[0].replace(/[^a-zA-Z 0-9 \:\-\(\)]+/g,"").substring(0,13);C.showProgressDialog("Validating Gamer Name","Please wait...");y.reportLoginRegEvent("RegDataFBNew");NgLogD("RegDataFBNew");C._registrationRecord.testRemoteGamername(function(M,K){C.hideProgressDialog();if(K.length>0){NgLogD("Suggest Name: "+K[0]);C._registrationRecord.gamername=K[0];y.reportLoginRegEvent("RegDataFBSuggestName");NgLogD("RegDataFBSuggestName")}C.registrationFBFinish.setGamerName(C._registrationRecord.gamername);NgLogD("~~~init confirmation screen BRAND NEW USER");C._registrationRecord.email=F.email;C._registrationRecord.firstName=F.first_name;C._registrationRecord.lastName=F.last_name;C._registrationRecord.social_type="facebook";C._registrationRecord.social_id=F.id;C._registrationRecord.social_token=E.getAccessToken();C._registrationRecord.social_photo_url=x.Facebook.getPhotoUrlForUser(F.id);var L;var J;if(F.birthday){var I=F.birthday.split("/");C._registrationRecord.birthMonth=I[0];C._registrationRecord.birthYear=I[2];C._registrationRecord.birthdate=new Date(C._registrationRecord.birthYear,C._registrationRecord.birthMonth-1,1,0,0,0,0)}C.initFacebookFinishSignUp()})}}}})}},function(){D=true;C.showProgressDialog("Authorizing Facebook","Please wait...")},function(){if(D){C.hideProgressDialog();C.showAlertDialog("Error Connecting","Couldn't connect using Facebook at this time. Try again later.")}})})},validateSignUp:function(E,F){NgLogD("User SignUp Initialized, userEmail: "+E.getText()+", password: "+F.getText());y.reportLoginRegEvent(!this._upgradeUserBool?"RegDataUserSignUp":"UPGRADEUserSignUp");NgLogD("RegDataUserSignUp");var D=this;var C=false;E.setState(m.State.Normal);F.setState(m.State.Normal);D._registrationRecord.password=F.getText();this._registrationRecord.testLocalPassword(false,function(G){if(G){C=true;F.setState(w.ErrorState);x.UIUtils.showToast(G);y.reportLoginRegEvent(!D._upgradeUserBool?"RegDataUserSignUpPWFail":"UPGRADEUserSignUpPWFail");NgLogD("RegDataUserSignUpPWFail")}});D._registrationRecord.email=E.getText();y.reportLoginRegEvent(!this._upgradeUserBool?"RegDataUserSignUpEmailTest":"UPGRADEUserSignUpEmailTest");NgLogD("RegDataUserSignUpEmailTest");this._registrationRecord.testLocalEmail(function(G){if(G){y.reportLoginRegEvent(!D._upgradeUserBool?"RegDataUserSignUpEmailTestERR":"UPGRADEUserSignUpEmailTestERR",{Error:JSON.stringify(G)});NgLogD("RegDataUserSignUpEmailTestERR");x.UIUtils.showToast(G);E.setState(w.ErrorState);C=true}});if(C){return}D.showProgressDialog("Validating Email","Please wait...");this._registrationRecord.testRemoteEmail(function(G,H){NgLogD("RegDataUserTestRemoteEmailConditionals");if(G){NgLogD("testRemoteEmail Error:"+JSON.stringify(G));E.setState(w.ErrorState);x.UIUtils.showToast(G);C=true;D.hideProgressDialog();NgLogD("RegDataUserSignUpEmailTestERR");y.reportLoginRegEvent(!D._upgradeUserBool?"RegDataUserSignUpEmailTestERR":"UPGRADEUserSignUpEmailTestERR",{Error:JSON.stringify(G)});E.setEnabled(true)}else{NgLogD("Email Verified");y.reportLoginRegEvent(!D._upgradeUserBool?"RegDataUserSignUpEmailVerified":"UPGRADEUserSignUpEmailVerified");NgLogD("RegDataUserSignUpEmailVerified");D._registrationRecord.gamername=E.getText().split("@",2)[0].replace(/[^a-zA-Z 0-9 \:\-\(\)]+/g,"").substring(0,13);D.showProgressDialog("Validating Gamer Name","Please wait...");D._registrationRecord.testRemoteGamername(function(J,I){D.hideProgressDialog();NgLogD("RegDataSuggestNameDATA: "+I);if(I.length>0){NgLogD("Suggest Name: "+I[0]);y.reportLoginRegEvent(!D._upgradeUserBool?"UPGRADESuggestName":"RegDataSuggestName");NgLogD("RegDataSuggestName");D._registrationRecord.gamername=I[0]}D.registrationFinish.setGamerName(D._registrationRecord.gamername);D.initRegistrationFinish();E.blur();F.blur()})}})},createNewUser:function(G,F,E){var C=this;C._registrationRecord.gamername=G.getText();C._registrationRecord.optIn=F;C.showProgressDialog("Creating New Mobage Account","Please wait...");if(C._upgradeUserBool){y.reportLoginRegEvent(E?"UPGRADEFBNewUserInit":"UPGRADENewUserInit")}else{y.reportLoginRegEvent(E?"RegDataFBNewUserInit":"RegDataNewUserInit")}NgLogD("RegDataNewUserInit");G.setState(m.State.Normal);var D=function(K,I){C.hideProgressDialog();if(K){NgLogD("Registration: Errors while submitting for user creation: "+JSON.stringify(K));var J=new m.Toast();J.setText(K[0]);if(C._upgradeUserBool){y.reportLoginRegEvent(E?"UPGRADEFBNewUserCreateErr":"UPGRADENewUserCreateErr",{Error:K})}else{y.reportLoginRegEvent(E?"RegDataFBNewUserCreateErr":"RegDataNewUserCreateErr",{Error:K})}NgLogD("RegDataNewUserCreateErr: "+K);J.show();G.setState(w.ErrorState)}else{NgLogD("Registration: Created user successfully!");if(C._upgradeUserBool){y.reportLoginRegEvent(E?"UPGRADEFBNewUserComplete":"UPGRADENewUserComplete")}else{y.reportLoginRegEvent(E?"RegDataFBNewUserComplete":"RegDataNewUserComplete")}NgLogD("RegDataNewUserComplete");C.animateOutAndClose(I,null)}};if(C._upgradeUserBool){var H=q.Session.getCurrentSession();H.upgradeGuestUserWithUsernameAndPassword(C._registrationRecord.gamername,C._registrationRecord.password,C._registrationRecord.email,C._registrationRecord.optIn,function(I){D(I?[I]:null,H.user())})}else{if(!C._registrationRecord.birthdate){C._registrationRecord.birthMonth=4;C._registrationRecord.birthYear=1906;C._registrationRecord.birthdate=new Date(C._registrationRecord.birthYear,C._registrationRecord.birthMonth-1,1,0,0,0,0)}C._registrationRecord.createUser(function(J,I){D(J,I?I.user():null)})}},createNewFBUser:function(D,C){NgLogD("Create New FB User");if(this._upgradeUserBool){this.upgradeFBUser(D,C)}else{this.createNewUser(D,C,true)}},linkFBUser:function(){NgLogD("linkFBUser");this.initFacebookLink()},upgradeFBUser:function(E,D){var C=this;x.Facebook.getSession(function(F){if(F.isSessionValid()){C._registrationRecord.gamername=E.getText();y.reportLoginRegEvent("UPGRADEFBLINKSTART");E.setState(m.State.Normal);C.showProgressDialog("Upgrading your Account","Please wait...");F.upgradeGuestAccount(C._registrationRecord.gamername,D,function(I,G){C.hideProgressDialog();if(I){NgLogD("Registration: Errors while submitting for user creation: "+JSON.stringify(I));var H=new m.Toast();H.setText(I[0]);y.reportLoginRegEvent("UPGRADEFBLINKERR",{Error:I});H.show();E.setState(w.ErrorState)}else{NgLogD("Registration: Upgraded user using Facebook successfully!");y.reportLoginRegEvent("UPGRADEFBLINKCOMPLETE");C.animateOutAndClose(G.user(),null)}})}})},userFBLogin:function(F,D,E){NgLogD("Login with Facebook");var C=this;x.Facebook.getSession(function(I){if(I.isSessionValid()){C.showProgressDialog("Logging in to Mobage","Please wait...");y.reportLoginRegEvent(E?"RegDataFBMatchLogin":"RegDataFBLogin");NgLogD("RegDataFBLogin");var H=q.Session.getCurrentSession();var G=false;F.setState(m.State.Normal);D.setState(m.State.Normal);C._registrationRecord.password=D.getText();C._registrationRecord.testLocalPassword(true,C.bind(function(J){if(J){y.reportLoginRegEvent(E?"RegDataFBMatchLoginERR":"RegDataFBLoginERR",{Error:JSON.stringify(J)});NgLogD("RegDataFBLoginERR");x.UIUtils.showToast(""+J);G=true;D.setState(w.ErrorState)}}));if(G){C.hideProgressDialog();return}H.newSessionWithUsernameAndPassword(F.getText(),D.getText(),function(J,K){C.hideProgressDialog();if(J){NgLogD("************** Failed Login Error: "+JSON.stringify(J)+"\n");y.reportLoginRegEvent(E?"RegDataFBMatchLoginERR":"RegDataFBLoginERR",{Error:JSON.stringify(J)});NgLogD("RegDataFBLoginERR");F.setState(w.ErrorState);x.UIUtils.showToast(""+J)}else{NgLogD("Successful login! ********************\n");y.reportLoginRegEvent(E?"RegDataFBMatchLoginSuccess":"RegDataFBLoginSuccess");NgLogD("RegDataFBLoginSuccess");I.linkMobageAccount(function(N,M){y.reportLoginRegEvent(E?"RegDataFBMatchLoginLink":"RegDataFBLoginLink");NgLogD("RegDataFBLoginLink");if(N){y.reportLoginRegEvent(E?"RegDataFBMatchLoginLinkERR":"RegDataFBLoginLinkERR",{Error:JSON.stringify(J)});NgLogD("RegDataFBLoginLinkERR");C.showAlertDialog("Couldn't link account",N)}else{NgLogD("Account linked Successfully! ********************\n");var L=q.Session.getCurrentSession().user();y.reportLoginRegEvent(E?"RegDataFBMatchLinkComplete":"RegDataFBLinkComplete");NgLogD("RegDataFBLinkComplete");C.animateOutAndClose(L,null)}})}})}})},userLogin:function(G,E){NgLogD("Initialize userLogin");this.showProgressDialog("Logging into Mobage","Please wait...");var D=this;y.reportLoginRegEvent("RegDataLogin");NgLogD("RegDataLogin");var F=q.Session.getCurrentSession();var C=false;G.setState(m.State.Normal);E.setState(m.State.Normal);this._registrationRecord.password=E.getText();this._registrationRecord.testLocalPassword(true,this.bind(function(H){if(H){y.reportLoginRegEvent("RegDataLoginERR",{Error:JSON.stringify(H)});NgLogD("RegDataLoginERR");x.UIUtils.showToast(""+H);C=true;E.setState(w.ErrorState);D.hideProgressDialog()}}));if(C){return}F.newSessionWithUsernameAndPassword(G.getText(),E.getText(),this.bind(function(H,I){D.hideProgressDialog();if(H){NgLogD("************** Failed Login Error: "+JSON.stringify(H)+"\n");y.reportLoginRegEvent("RegDataLoginERR",{Error:JSON.stringify(H)});NgLogD("RegDataLoginERR");G.setState(w.ErrorState);x.UIUtils.showToast(""+H)}else{NgLogD("Successful login! ********************\n");y.reportLoginRegEvent("RegDataLoginComplete");NgLogD("RegDataLoginComplete");this.animateOutAndClose(I.user(),null)}}))}})}};__ngs._77={_c:null,_d:function(){var a={exports:{}};var e=a.exports;this._c=a;var c=__ngs.r_(__ngs._59).UI;var b=__ngs.r_(__ngs._2j).Logger;var j=__ngs.r_(__ngs._8a);var o=function(p){var q=p.length;while(q--){if(isNaN(p[q])){return true}}return false};var n=e.ElementEnhancements={toString:function(){return"<Element:"+this.classname+">"}};var g=[0,0,0,0];var f=e.ViewEnhancements={toString:function(){return"<View:"+this.classname+">"},getFrameSize:function(){return(this.getFrame()||g).slice(2)},setFrameSize:function(p){var q=this.getFrame()||g;this.setFrame([q[0]|0,q[1]|0,p[0],p[1]])},getFrameOrigin:function(){return(this.getFrame()||g).slice(0,2)},setFrameOrigin:function(p){var q=this.getFrame()||g;this.setFrame([p[0],p[1],q[2]|0,q[3]|0])}};var d=Array.prototype.slice;function h(p,r){function q(u,v){return function(){u.apply(this,[v.bind(this)].concat(d.call(arguments)))}}for(var s in r){var t=p.prototype[s];if(typeof t=="function"){p.prototype[s]=q(r[s],t)}else{p.prototype[s]=r[s]}}}var l=__ngs.r_(__ngs._23).AbstractView;l.subclass({});b.addLogHelpers(c.Element);b.addLogHelpers(c.ListViewItem);h(c.Element,n);h(l,f);h(c.Label,j.TextScalingEnhancements);h(c.Button,j.TextScalingEnhancements);c.Button.prototype.textScalingBehavior=j.TextMeasuredScalingBehaviors.StrictMultiLine;var m=function(q){var p=function(){return this};p.prototype=q;return new p()};var k=e.Primitives=m(c);k.__defineGetter__("LayoutGroup",function(){delete k.LayoutGroup;return k.LayoutGroup=__ngs.r_(__ngs._bf).LayoutGroup});k.__defineGetter__("ImageLabel",function(){delete k.ImageLabel;return k.ImageLabel=__ngs.r_(__ngs._an).ImageLabel})}};__ngs._78={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var d=__ngs.r_(__ngs._59).UI;var c=__ngs.r_(__ngs._77).Primitives;var e=a.AccordionListView=c.ListView.subclass({classname:"AccordionListView",initialize:function($super,f){$super(f);return this},destroy:function(){},setFrame:function($super,f){if(this._isValidFrame.apply(this,Array.prototype.slice.call(arguments,1))){$super.apply(this,Array.prototype.slice.call(arguments,1))}},sizeChanged:function(){this.calculateSectionPositions();this.layoutSubviews()},getSections:function($super){var f=$super()||[];return f.slice()},setSections:function($super,k){var h,f;var g=this.getSections();var j=[];for(h in g){if(g.hasOwnProperty(h)&&k.indexOf(g[h])==-1){j.push(g[h])}}$super(k);for(h in j){if(j.hasOwnProperty(h)){j[h].flush()}}this._removeQueuedViews()},layoutSubviews:function(){},_adjustSectionHeaderHeights:function(h){var g=new d.ViewGeometry.Rect(this.getFrame());for(var f=0;f<h.length;f++){h[f]._visibleRange=[0,0];if(h[f].getTitleView()){h[f].getTitleView().setFrame([0,0,g.w,0.14*g.h]);h[f].getTitleView()._headerHeight=0.14*g.h}}},_isValidFrame:function(g){var f=new d.ViewGeometry.Rect(g);if(f.isEmpty()||f.h<10){this.logd("Tried to set an android-unsafe frame! Blocking.");f.h=10;f.w=(f.w&&f.w>=10)?f.w:10;f.x=isNaN(f.x)?0:f.x;f.y=isNaN(f.y)?0:f.y;this.setFrame(f);return false}return true}})}};__ngs._79={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var e=__ngs.r_(__ngs._59).UI;var f=__ngs.r_(__ngs._5).Core;var d=__ngs.r_(__ngs._77).Primitives;var c=a.MBListViewSection=d.ListViewSection.subclass({classname:"MBListViewSection",initialize:function($super,g){$super(g);this.setRowHeightRatio(1/5)},destroy:function(){if(this._ownsHeader&&this.getTitleView()){this.getTitleView().release()}},setItems:function($super,h){if(this._listView){var g;for(var j=0;j<this._listView._ownedViews.length;j++){g=this._listView._ownedViews[j];if(g.setFrameOrigin){g.setFrameOrigin([0,0-g.getFrameSize()[1]])}}}$super(h)},flush:function($super){if(!this._visibleRange){this.loge("What the hell? Our visible range is undefined.");return}$super()},updateVisibleRange:function($super,g,h){if(!this._items){this.loge("Update visible range will crash if called without items");this._items=[]}$super.apply(this,Array.prototype.slice.call(arguments,1))},removeSectionHeader:function(){if(this._listView){var h=new e.View({frame:[0,0,0,0]});var g=this.getTitleView();this._listView.addChild(h);this.setTitleView(h);this._listView.removeChild(g);this._listView.reloadData();g.release()}},getSectionHeader:function(){return this.getTitleView()},setSectionHeader:function(g){this._ownsHeader=true;g.retain();if(this.getTitleView()){this.getTitleView().release()}this.setTitleView(g)},setListView:function($super,g){$super(g);if(g&&this.getTitleView()){g.addChild(this.getTitleView())}else{if(this.getTitleView()){this.getTitleView().removeFromParent()}}},setRowHeightRatio:function(h,j){this._rowHeightRatio=h;if(h>10){throw new Error("You probably didn't mean to allocate ten times the base height for a single row")}if(j===undefined){j=f.Capabilities.getScreenWidth()}var g=this._rowHeightRatio*j;this.setRowHeight(g)},calculateRowHeightForListView:function(g){var h=g.getFrame()[3]*this._rowHeightRatio;this.setRowHeight(h)}})}};__ngs._7a={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var a=__ngs.r_(__ngs._5l).UnspammableButton;var c=new (__ngs.r_(__ngs._f).RequireLoader)({ContactsSectionTitleStyle:function(){return __ngs.r_(__ngs._a9).ContactsSectionTitle}});var b=d.ContactsSectionTitleView=a.subclass({classname:"ContactsSectionTitleView",initialize:function($super,f){$super(f);this.setFrameSize([300,40]);c.ContactsSectionTitleStyle.applyTo(this);return this},_formattedTitle:function(){return""+this._baseText+((this._accessoryText!==null)?(" ("+this._accessoryText+")"):"")},_baseText:null,setTitle:function(f){this._baseText=f;this.setText(this._formattedTitle())},_accessoryText:null,setAccessoryText:function(f){this._accessoryText=f;this.setText(this._formattedTitle())}})}};__ngs._7b={_c:null,_d:function(){var c={exports:{}};var e=c.exports;this._c=c;var d=__ngs.r_(__ngs._59).UI;var b=new (__ngs.r_(__ngs._f).RequireLoader)({ContactsController:function(){return __ngs.r_(__ngs._6h).ContactsController},ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells}});var g=__ngs.r_(__ngs._9h);var a=g.Composite;var k=__ngs.r_(__ngs._9i);var f=k.Components;var j=k.Component;var h=e.SystemInfoCell=a({key:"key",component:f.Label},{key:"content",component:f.Label,altKey:"value"},f.AddOrders.Generator("key","content"),f.Layouts.TwoHorizontalGenerator("key","content"),{classname:"SystemInfoCell",initialize:function($super,l){$super(l);b.ListViewCellStyles.SystemInfoCell.applyTo(this)},markOdd:function(){this.addState(b.ContactsController.OddState)},markEven:function(){}})}};__ngs._7c={_c:null,_d:function(){var d={exports:{}};var a=d.exports;this._c=d;var e={};e.uidGenerator=0;var b=function(g){var h=e.uidGenerator++;e[h]=g;return h};var f=function(h){if(e.hasOwnProperty(h)){var g=e[h];delete e[h];return g}return null};var c=function(g){if(typeof g=="object"){if(g.hasOwnProperty("callbackFunc")){g.callbackId=b(g.callbackFunc);delete g.callbackFunc}else{if(g.hasOwnProperty("callbackId")){g.callbackFunc=f(g.callbackId);delete g.callbackId}}return g}NgLogD("Error: invalid or non-object passed to gsCmdConvert.");return null};a.makeSafe=function(g){if(g&&typeof g=="object"&&g.hasOwnProperty("callbackFunc")){return c(g)}return g};a.makeExecutable=function(g){if(g&&typeof g=="object"&&g.hasOwnProperty("callbackId")){return c(g)}return g}}};__ngs._7d={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var c=__ngs.r_(__ngs._t);var a=__ngs.r_(__ngs._2j).Logger;var g=b.OLLogD=function(h){if(a.shouldLog(null,"OrderedList")){var j=Array.prototype.slice.call(arguments);j.unshift("OrderedList: ");a.debug.apply(a,j)}};var e=b.OLLogE=function(h){var j=Array.prototype.slice.call(arguments);j.unshift("OrderedList: ");a.error.apply(a,j)};var f=c.Class.subclass({classname:"OrderedList",$noOp:{},initialize:function(h){this._requestPageSize=h;this._knownEndOfSet=undefined;this._pagesPending=[];this._pageETags=[]},forAll:function(k,h){var j=arguments.length>=3?arguments[2]:null;this._newCursor(0,-1,k,h,j)},forRange:function(m,l,k,h){if(l>0){var j=arguments.length>=5?arguments[4]:null;this._newCursor(m,m+l,k,h,j)}},forItem:function(j,l,h){var k=arguments.length>=4?arguments[3]:null;this._newCursor(j,j+1,l,h,k)},_hasData:function(h){return true},_getData:function(h){return undefined},_constructRequest:function(h){return undefined},_handleRequestData:function(h){},_newCursor:function(l,k,m,h,j){if(!m){e("Ordered List DataModel "+this.recordID+" got request with no perItemCb, can't process this.");return}this._processCursor({curIdx:l,endIdx:k,perItemCb:m,doneCb:h,isClosed:false,startIdx:l,staleData_optIn:j})},_checkForCursorComplete:function(j){var h=j.curIdx;if(h==j.endIdx||(j.haxcheckedonserver&&this._knownEndOfSet===0)||(typeof this._knownEndOfSet!=="undefined"&&this._knownEndOfSet!==0&&h>=this._knownEndOfSet)){this._closeCursor(j,undefined);return 2}if(this._getData(h)===f.noOp){j.curIdx++;return 1}return 0},_processCursor:function(q){while(true){var m=this._checkForCursorComplete(q);if(m===2){return}else{if(m===0){break}}}var l=q.curIdx;q.haxcheckedonserver=true;var n=this._requestPageSize>0?Math.floor(l/this._requestPageSize):0;if(!this._hasData(l)||(q._curPage!=n&&!q.staleData_optIn)){q.dataIsFresh=true;q._curPage=n;var p=true;for(var h in this._pagesPending){if(this._pagesPending.hasOwnProperty(h)){if(this._pagesPending[h].pageNum==n){var j=false;for(var o=0;o<this._pagesPending[h].waitingCursors.length;o++){var k=this._pagesPending[h].waitingCursors[o];if(!k.isClosed&&!(typeof this._knownEndOfSet!=="undefined"&&k.curIdx<this._knownEndOfSet)){j=true;break}}if(j){p=false;this._pagesPending[h].waitingCursors.push(q)}break}}}if(p){var r={waitingCursors:[q],pageNum:n};this._pagesPending.push(r);this._retrievePage(n,r)}q.waitingOnServer=true}else{q.curIdx++;q.waitingOnServer=false;this._returnData(q,this._getData(l),l)}},_closeCursor:function(j,h){if(j.isClosed){return}j.isClosed=true;if(j.doneCb){j.doneCb(h)}if(j.staleData_optIn){this._closeCacheCursor(j)}},_closeCacheCursor:function(l){if(l.dataIsFresh){g("Had to get fresh data, no need for extra requests.");if(typeof l.staleData_optIn==="function"){l.staleData_optIn(null,false)}}else{if(l.staleData_optIn===true){g("User wanted purely stale data, don't generate a new cursor to freshen.")}else{g("Had cached data, create new requests to freshen.");var j=l.curIdx==l.endIdx;var h=l.curIdx;var k=0;this._newCursor(l.startIdx,l.endIdx,function(m){m(j||h>(++k))},this.bind(function(m){if(typeof l.staleData_optIn==="function"){l.staleData_optIn(m,true)}}),false)}}},_waitingCursorsUnblocked:function(j){for(var h in j){if(j.hasOwnProperty(h)){this._processCursor(j[h])}}},_waitingCursorsGotError:function(k,j){for(var h in k){if(k.hasOwnProperty(h)){this._closeCursor(k[h],j)}}},_returnData:function(m,k,j){var h=this;var l=function(n){if(n){h._processCursor(m)}else{h._closeCursor(m,undefined)}};m.perItemCb(l,k,j)},_retrievePage:function(l,j){var h=this;var k=this._constructRequest(l);if(this._pageETags.hasOwnProperty(l)){k.setEntityTag(this._pageETags[l])}k.send(function(o,p,q,m){if(o){h._waitingCursorsGotError(j.waitingCursors,o)}else{if(m==304){h._waitingCursorsUnblocked(j.waitingCursors)}else{if(p.success!==true){h._waitingCursorsGotError(j.waitingCursors,p.error)}else{if(q.etag){h._pageETags[l]=q.etag}h._handleRequestData(p);h._waitingCursorsUnblocked(j.waitingCursors)}}}var n=h._pagesPending.indexOf(j);if(n==-1){e("Ordered List DataModel "+h.recordID+" had an in progress request that wasn't in the pending pages list?")}else{h._pagesPending.splice(n,1)}})}});b.OrderedList=f}};__ngs._7e={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var e=__ngs.r_(__ngs._6k).MobageStyle;var a=e.ScaledCorners;var f=e.ScaledTextSize;var c=__ngs.r_(__ngs._2z).Assets;e.lazyLoad(b,"RegistrationWebScreen",function(){return{children:{topNav:{style:{gradient:{gradient:["FF7F 0.0","FF4C 0.5"],innerShadow:"FF33 0.0 {0.0,2.0}"}}},doneButton:{style:{gradient:{corners:a(8),gradient:["FF4C 0.000","FF19 0.500"],innerLine:"FF00 2.0"},pressedGradient:{corners:a(8),gradient:["FF19 0.000","FF4C 0.500"],innerLine:"FF00 2.0"},textFont:e.defaultBoldFontFace,textSize:f(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}",corners:"14.0 14.0 14.0 14.0"}}},extras:{}}})}};__ngs._7f={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c={};c.Style=__ngs.r_(__ngs._60).Style;c.Style.sheet("social.us.communitybutton",{button:{gradient:{gradient:["FFFFFFFF 0.000","FFB7C1D7 1.000"],innerLine:"FFE0E6F0 1.5",outerLine:"AA000000 1.5"}},communityButtonScale:0.11875})}};__ngs._7g={_c:null,_d:function(){var f={exports:{}};var e=f.exports;this._c=f;var d=__ngs.r_(__ngs._87).ReferenceCounting;var c=__ngs.r_(__ngs._24).Element;var h=__ngs.r_(__ngs._77).Primitives.View;var g=__ngs.r_(__ngs._bf).LayoutGroup;var b=new (__ngs.r_(__ngs._f).RequireLoader)({Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities}});var a=e.ViewController=d.subclass({classname:"ViewController",initialize:function($super){$super();return this},loadView:function(){if(!this._view){this.setView(new h())}},destroy:function(){this.setView(null);this._cleanKeyboardWorkarounds();if(this._retainedViews&&this._retainedViews.length){this._cleanViews()}},view:function(){if(!this._view){this.loadView()}if(!this._view.controller){this._view.controller=this}return this._view},setView:function(j){if(j&&(j instanceof c||j instanceof g)){j.retain();j.controller=this}else{j=null}if(this._view&&(this._view instanceof c||this._view instanceof g)){if(this._view.controller==this&&this._view!=j){this._view.controller=null}this._view.release()}this._view=j;this.logd("setView end: this._view=",this._view)},reloadView:function(){this.setView(null);this.view()},_cleanViews:function(){this.loge("Anti-Pattern _cleanViews stop using this.");if(this._retainedViews){for(var j=0;j<this._retainedViews.length;j++){var k=this._retainedViews[j];if(k&&!k.__destroyed__){k.release()}}}this._retainedViews=new Array()},retainView:function(j){this.loge("Anti-Pattern retainView stop using this.");if(j){j.retain();if(!this._retainedViews){this._retainedViews=new Array()}this._retainedViews.push(j)}return j},applyKeyboardWorkaround:function(j){if((!j)||this._hasSaneKeyboard){return}if(typeof this._hasSaneKeyboard==="undefined"){this._hasSaneKeyboard=(!b.Capabilities.isPlatformAndroid());if(this._hasSaneKeyboard){return}}if(!this._keyboardWAViews){this._keyboardWAViews=new Array()}this._keyboardWAViews.push(j)},_cleanKeyboardWorkarounds:function(){this._keyboardWAViews=undefined},analyticsName:null})}};__ngs._7h={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var f=__ngs.r_(__ngs._23).AbstractView;var a=__ngs.r_(__ngs._22).Commands;var e=__ngs.r_(__ngs._b).Window;var c=__ngs.r_(__ngs._4i).ViewParent;var g=b.View=f.subclass({type:"view",initialize:function($super,h){if(g._init){g._init()}c.initialize.call(this);return $super(h)},addChild:c.addChild,removeChild:c.removeChild,getChildCount:c.getChildCount,getChildren:c.getChildren,layoutSubviews:function(){},_setVisible:function($super,m){var k=this._visible;$super(m);if(this._visible!=k){var h=this._children.length;for(var j=0;j<h;j++){this._children[j]._setVisible(m)}}}});g._init=function(){delete g._init;if(f._init){f._init()}g.synthesizePropertyWithState("image",a.setImage);g.synthesizePropertyWithState("imageBorder",a.setImageBorder);g.synthesizeCompoundProperty("imageGravity",a.setImageGravity);g.synthesizeProperty("imageFit",a.setImageFitMode);g.synthesizeProperty("visibleInOrientations",a.setVisibleInOrientations)}}};__ngs._7i={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var d=__ngs.r_(__ngs._23).AbstractView;var a=__ngs.r_(__ngs._22).Commands;var e=b.Label=d.subclass({type:"label",initialize:function($super,f){if(e._init){e._init()}$super(f)}});e._init=function(){delete e._init;if(d._init){d._init()}e.synthesizePropertyWithState("text",a.setText);e.synthesizePropertyWithState("textFont",a.setTextFont);e.synthesizePropertyWithState("textColor",a.setTextColor);e.synthesizePropertyWithState("textShadow",a.setTextShadow);e.synthesizeCompoundProperty("textGravity",a.setTextGravity);e.synthesizeProperty("textSize",a.setTextSize);e.synthesizeCompoundProperty("textInsets",a.setTextInsets);e.synthesizeProperty("lineHeight",a.setLineHeight)}}};__ngs._7j={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var e=__ngs.r_(__ngs._23).AbstractView;var a=__ngs.r_(__ngs._22).Commands;var c=b.Image=e.subclass({initialize:function($super,f){if(c._init){c._init()}$super(f)},type:"image"});c._init=function(){delete c._init;if(e._init){e._init()}c.synthesizePropertyWithState("image",a.setImage);c.synthesizePropertyWithState("imageBorder",a.setImageBorder);c.synthesizeCompoundProperty("imageGravity",a.setImageGravity);c.synthesizeCompoundProperty("imageTransform",a.setImageTransform);c.synthesizeProperty("imageFit",a.setImageFitMode);c.registerEventType("imageLoaded");c.registerEventType("imageLoadFailed")}}};__ngs._7k={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var e=__ngs.r_(__ngs._23).AbstractView;var b=__ngs.r_(__ngs._22).Commands;var a=c.Button=e.subclass({type:"button",Layout:b.ButtonLayout,initialize:function($super,f){if(a._init){a._init()}$super(f)}});a._init=function(){delete a._init;if(e._init){e._init()}a.synthesizePropertyWithState("image",b.setImage);a.registerEventType("imageLoaded");a.registerEventType("imageLoadFailed");a.synthesizeCompoundProperty("imageInsets",b.setImageInsets);a.synthesizeProperty("imageFit",b.setImageFitMode);a.synthesizeCompoundProperty("imageGravity",b.setImageGravity);a.synthesizeCompoundProperty("imageTransform",b.setImageTransform);a.synthesizePropertyWithState("imageBorder",b.setImageBorder);a.synthesizePropertyWithState("text",b.setText);a.synthesizePropertyWithState("textColor",b.setTextColor);a.synthesizePropertyWithState("textFont",b.setTextFont);a.synthesizePropertyWithState("textShadow",b.setTextShadow);a.synthesizeCompoundProperty("textGravity",b.setTextGravity);a.synthesizeProperty("textSize",b.setTextSize);a.synthesizeCompoundProperty("textInsets",b.setTextInsets)}}};__ngs._7l={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var e=__ngs.r_(__ngs._23).AbstractView;var a=__ngs.r_(__ngs._22).Commands;var d=__ngs.r_(__ngs._7).Capabilities.OpenGL;var f=b.GLView=e.subclass({type:"glview",initialize:function($super,g){if(f._init){f._init()}$super(g)}});f._init=function(){delete f._init;if(e._init){e._init()}f.synthesizeProperty("active",a.setActive);f.registerAccessors("OGLExtensions",function(){return d.getExtensions()},function(){});f.registerEventType("sizeChanged");f.registerEventType("activeChanged")}}};__ngs._7m={_c:null,_d:function(){var c={exports:{}};var d=c.exports;this._c=c;var f=__ngs.r_(__ngs._w).MessageListener;var e=__ngs.r_(__ngs._1a).KeyEmitter;var j=__ngs.r_(__ngs._b).Window;var h=__ngs.r_(__ngs._7).Capabilities;var b=__ngs.r_(__ngs._24).Element;var a=__ngs.r_(__ngs._7h).View;var l=__ngs.r_(__ngs._22).Commands;var k=f.subclass({classname:"UI_NavController_KeyListener"});var g=d.NavController=a.subclass({initialize:function($super,n){if(g._init){g._init()}this.navStack=[];var m=h.getPlatformOS()=="Android";this._useBackButton=!m;this.keyListener=new k();e.addListener(this.keyListener,this.onKeyPressed.bind(this));$super(n)},setUseBackButton:function(m){this._useBackButton=m;if(m){this._createBackButton()}else{if(this.backButton){this.backButton.removeFromParent()}}},clear:function(m){return this.backToView(undefined)},getTopView:function(){return(this.navStack.length>0)?this.navStack[(this.navStack.length-1)]:undefined},navStackDepth:function(){return this.navStack.length},depthOfView:function(n){var m=this.navStack.indexOf(n);if(m==-1){return -1}return this.navStack.length-m-1},viewAtDepth:function(m){if(m>=this.navStack.length){return null}return this.navStack[this.navStack.length-m-1]},removeDeepView:function(n){var m=this.navStack.indexOf(n);if(m==-1){NgLogE("NavController: trying to remove a nonexistent view from the nav stack!");return}this.navStack.splice(m,1)},_viewTransition:function(p,m,o){var r=this.getFrame();var n=r[2];var q=r[3];if(m){m.setFrame((o?-n:n),0,n,q);this.addChild(m)}l.animate(function(){if(p){p.setFrame((o?n:-n),0,n,q)}if(m){m.setFrame(0,0,n,q)}},400,function(){if(p){p.removeFromParent()}});this._createBackButton()},forwardToView:function(m,n){var o=this.getTopView();if(m&&(!this._delegate||(this._delegate&&typeof this._delegate.navControllerShouldPush=="function"&&this._delegate.navControllerShouldPush(this,m)))){m.performEventCallback({eventType:"push",navController:this});this.navStack.push(m);this._viewTransition(o,m,false,n)}},back:function(){var m=this.navStack.pop();if(m&&(!this._delegate||(this._delegate&&typeof this._delegate.navControllerShouldPop=="function"&&this._delegate.navControllerShouldPop(this,m)))){m.performEventCallback({eventType:"pop",navController:this})}else{return null}this._viewTransition(m,this.getTopView(),true);return m},backToView:function(n,q){var p=[];var o=this.navStack.pop();var m=o;if(o){do{if(o&&(!this._delegate||(this._delegate&&typeof this._delegate.navControllerShouldPop=="function"&&this._delegate.navControllerShouldPop(this,o)))){p.push(o);o.performEventCallback({eventType:"pop",navController:this})}else{break}if(this.getTopView()==n){break}}while((o=this.navStack.pop()))}if(p.length>0){this._viewTransition(m,this.getTopView(),true,q)}return p},loadApp:function(){},onBackPressed:function(){if(this.navStack.length>1){this.back();return true}return false},onKeyPressed:function(m){if((m.code===e.Keycode.back)&&(this.navStack.length>1)){this.back();return true}return false},_delegate:null,setDelegate:function(m){this._delegate=m},delegate:function(){return this._delegate},_createBackButton:function(){if(!this._useBackButton){return}if(!this.backButton){this.backButton=new UI.Button({normalText:"Back",textSize:13,normalTextColor:"FF",normalTextShadow:"00 1.5 {0,-1}",frame:[-2,20,j.outerWidth/5,j.outerHeight/12],normalGradient:{corners:"0 8 8 0",outerLine:"00 1.5",innerShadow:"99FF 2.0 {0,-1}",gradient:["FFCC 0.0","FF80 1.0"]},highlightedGradient:{corners:"0 8 8 0",outerLine:"00 1.5",innerLine:"FF00 15 {0,-1}",gradient:["FF50 0.0","FF80 1.0"]}});this.backButton.onclick=this.bind(this.onBackPressed)}if(this.navStack.length>1){if(!this.backButton.getParent()){j.document.addChild(this.backButton)}}else{if(this.backButton.getParent()){this.backButton.removeFromParent()}}}});g._init=function(){delete g._init;if(a._init){a._init()}}}};__ngs._7n={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var d=__ngs.r_(__ngs._23).AbstractView;var a=__ngs.r_(__ngs._22).Commands;var e=b.WebView=d.subclass({type:"webview",initialize:function($super,f){if(e._init){e._init()}this._canGoBack=false;this._canGoForward=false;return $super(f)},_onShouldLoad:function(g){NgLogD("Should Load "+g.url+" ???????");var f=this.getOnShouldload();if(typeof f=="function"){if(!Boolean(f.call(this,g))){return}}this.loadUrl(g.url)},performEventCallback:function($super,f){try{if(f.eventType=="shouldload"){this._onShouldLoad(f);return}if(f.eventType=="pageload"){this._canGoBack=f.canGoBack=Boolean(JSON.parse(f.canGoBack));this._canGoForward=f.canGoForward=Boolean(JSON.parse(f.canGoForward))}$super(f)}catch(g){NgHandleException(g)}},invoke:a.invoke,loadUrl:function(f,h,g){a.loadURL.call(this,f,h||null,+(g||0))},loadDocument:a.setSourceDocument,postUrl:function(g,j){var f;if(typeof j=="object"){var k=[];for(var h in j){k.push(encodeURIComponent(h)+"="+encodeURIComponent(j[h]))}f=k.join("&")}else{f=j}a.postURL.call(this,g,f)},stopLoading:a.stopLoading,reload:a.reload,goBack:a.goBack,goForward:a.goForward,canGoBack:function(){return this._canGoBack},canGoForward:function(){return this._canGoForward},setBasicAuthCredential:function(h,f,j,g){a.setBasicAuthCredentials.call(this,{host:h,realm:f,username:j,password:g})},setViewportEnabled:a.setViewportEnabled,setAutodetection:function(f){a.setAutodetection.call(this,f)}});e._init=function(){delete e._init;if(d._init){d._init()}e.synthesizeProperty("scrollable",a.setScrollable);e.synthesizeProperty("pluginsEnabled",a.setPluginsEnabled);e.registerEventType("startload");e.registerEventType("pageload");e.registerEventType("error");e.registerEventType("pageevent");e.registerEventType("shouldload");e.registerEventType("externalLink")}}};__ngs._7o={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var f=__ngs.r_(__ngs._7h).View;var a=__ngs.r_(__ngs._25);var b=__ngs.r_(__ngs._22).Commands;var e=c.ScrollView=f.subclass({type:"scrollview",initialize:function($super,g){if(e._init){e._init()}this._scrollPosition=[0,0];return $super(g)},updateScrollPosition:function(g){this._scrollPosition=g},performEventCallback:function($super,g){if(g.eventType=="scroll"){this.updateScrollPosition(g.scrollPosition)}$super(g)},getFrameOffset:function(){var g=this._frame;if(g){return[-this._scrollPosition[0],-this._scrollPosition[1]]}else{return undefined}}});e._init=function(){delete e._init;if(f._init){f._init()}e.synthesizeCompoundProperty("contentSize",b.setScrollableSize);e.synthesizeCompoundProperty("scrollPosition",b.setScrollPosition);e.synthesizeCompoundProperty("scrollIndicatorsVisible",b.setScrollIndicatorsVisible);f.synthesizeProperty("visibleInOrientations",b.setVisibleInOrientations);e.registerEventType("scroll");e.registerEventType("scrollEnded")}}};__ngs._7p={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var f=__ngs.r_(__ngs._23).AbstractView;var g=__ngs.r_(__ngs._7o).ScrollView;var a=__ngs.r_(__ngs._25);var b=__ngs.r_(__ngs._22).Commands;var c=d.ListView=g.subclass({type:"listview",initialize:function($super,h){if(c._init){c._init()}$super(h);this._sections=[];this._scrollPosition=[0,0];this.enableEvent("scroll",true);this._ownedViews=[];this._queuedViews={};this._cellDivider=0;return this},destroy:function($super){var h=this._ownedViews.length;for(var j=0;j<h;j++){this._ownedViews[j].release()}this._ownedViews=null;$super()},addChild:function($super,j,h){if(h=="cell"){h=this._cellDivider++}else{if((h||-1)>=0){h+=this._cellDivider}}$super(j,h)},_viewForItem:function(j){if(j._currentView instanceof f){return j._currentView}var l=j._reuseId;var h=this._queuedViews[l];var k=null;while(h&&h.length>0){if((k=h.pop()) instanceof f){break}}if(!(k instanceof f)){k=j._onCreateView(j);if(k instanceof f){this._ownedViews.push(k.retain());this.addChild(k,"cell")}else{console.log("Error creating view for list item with reuse id "+l)}}return k},_queueViewForItem:function(j){if(!j){NgLogE("ListView::_queueViewForItem called with undefined item");return}var k=j._currentView;if(k instanceof f){var l=j._reuseId;var h=this._queuedViews[l]||(this._queuedViews[l]=[]);h.push(k)}j._setCurrentView()},_removeQueuedViews:function(){for(var k in this._queuedViews){if(!this._queuedViews.hasOwnProperty(k)){continue}k=this._queuedViews[k];for(var j=0,h=k.length;j<h;j++){k[j].removeFromParent()}}this._cellDivider=0},flushSections:function(){for(var h in this._sections){if(!this._sections.hasOwnProperty(h)){continue}var j=this._sections[h];j.flush();j.calculateItemPositions()}this._removeQueuedViews()},reloadData:function(){this.flushSections();this.calculateSectionPositions();this.updateScrollPosition(this._scrollPosition)},getSections:function(){return this._sections},setSections:function(k){this.flushSections();var h;for(h in this._sections){if(this._sections.hasOwnProperty(h)){this._sections[h].setListView(null)}}this._sections=k;var j=[];for(h in k){if(k.hasOwnProperty(h)){j.push(0+(k[h].__objectRegistryId||0))}}b.setSections.call(this,j);this.reloadData()},calculateSectionPositions:function(){if(!this.getFrame()){console.log("UI.ListView Warning: You probably called setSections before you actually set a frame.");return}this._stackedSections={};var m=0;var k=this._sections.length;for(var n=0;n<k;n++){var p=this._sections[n];this._stackedSections[m]=p;p.setListView(this);p.setYPosition(m);var j=this._scrollPosition[1]-m;p.updateVisibleRange(j,j+this._frame[3]);var o=p._measureHeight();p._setFrame(0,m,this._frame[2],o);m+=o}this.setContentSize([this._frame[2],m])},updateScrollPosition:function(k){if(this._scrollPosition[1]===k[1]){return}this._scrollPosition=k;var j=this._frame[3];for(var l in this._stackedSections){if(this._stackedSections.hasOwnProperty(l)){var m=this._stackedSections[l];var h=k[1]-l;m.updateVisibleRange(h,h+j)}}},_onScroll:function(){},enableEvent:function($super,h,j){if((h=="scroll")&&!j){return}$super(h,j)}});c._init=function(){delete c._init;if(g._init){g._init()}c.synthesizeProperty("header");c.synthesizeProperty("footer")}}};__ngs._7q={_c:null,_d:function(){var c={exports:{}};var e=c.exports;this._c=c;var a=__ngs.r_(__ngs._24).Element;var b=__ngs.r_(__ngs._25);var d=__ngs.r_(__ngs._12).ObjectRegistry;var g=__ngs.r_(__ngs._5).Core;var k=__ngs.r_(__ngs._22).Commands;var h=__ngs.r_(__ngs._7r).ListViewItem;var f=5;var j=5;if(g.Capabilities.getPlatformOS()==="iPhone OS"){f=1;j=2}var l=e.ListViewSection=a.subclass({type:"listview-section",initialize:function($super,m){if(l._init){l._init()}this._visibleRange=[0,0];this._headerHeight=0;this._titleHeight=0;delete this._measuredHeight;this._needsLayout=false;$super(m)},addItemToVisible:function(m,o){if(!(m instanceof h)){return}if(m._currentView instanceof a){return}var p=this._listView._viewForItem(m);var n=this._listView.getFrame()[2];if(this._rowHeight>0){p.setFrame(0,this._yPosition+this._titleHeight+o*this._rowHeight,n,this._rowHeight)}else{p.setFrame(0,this._yPosition+this._cellPositions[o],n,m._height||0)}m._setCurrentView(p);if(!p.getParent()){this._listView.addChild(p,"cell")}},_setFrame:function(n,o,m,p){k.setFrame.call(this,n,o,m,p);if(this._titleView){this._titleView.setFrame(n,o,m,this._titleHeight)}},flush:function(){for(var n=this._visibleRange[0],m=this._visibleRange[1];n<m&&n<this._items.length;n++){this._listView._queueViewForItem(this._items[n])}this._visibleRange=[0,0]},updateVisibleRange:function(n,q){var m=this._getMeasuredHeight();var p=this._items.length;var v=this._rowHeight>0?this._rowHeight:m/p;n-=v*f;q+=v*j;var o=this._visibleRange[0];var t=this._visibleRange[1];var u=p>0&&v>0?Math.max(0,Math.floor(n/v)):0;var s=p>0&&v>0?Math.min(p,u+Math.floor((q-n)/v)):0;if(this._cellPositions){while(u<p&&this._cellPositions[u]<n){u++}while(u>0&&this._cellPositions[u]>n){u--}if(u>=p){u=Math.max(0,p-1)}while(s<p&&this._cellPositions[s]<q){s++}while(s>u&&this._cellPositions[s]>q){s--}n=this._cellPositions[u];q=s===0?n:(this._cellPositions[s-1]+(this._items[s-1]._height||0))}if(q<0||n>m){for(var r=this._visibleRange[0];r<this._visibleRange[1]&&r<this._items.length;r++){this._listView._queueViewForItem(this._items[r])}this._visibleRange=[0,0];return}if(o==u&&t==s){return}if(o==t){for(r=u;r<s;r++){this.addItemToVisible(this._items[r],r)}}else{if(o<u){do{this._listView._queueViewForItem(this._items[o])}while(++o<u)}if(t>s){while(t-->s){this._listView._queueViewForItem(this._items[t])}t=s}if(o>u){while(o-->u){this.addItemToVisible(this._items[o],o)}o=u}if(t<s){do{this.addItemToVisible(this._items[t],t)}while(++t<s)}}this._visibleRange=[u,s]},setListView:function(m){this._listView=m;delete this._measuredHeight;return this},_getMeasuredHeight:function(){return this._measuredHeight||this._measureHeight()},_measureHeight:function(){if(!this._rowHeight||this._rowHeight<0){var p=this._titleHeight+this._headerHeight;var m=[];var n=this._items.length;for(var o=0;o<n;o++){m.push(p);p+=this._items[o]._height||0}this._cellPositions=m;return this._measuredHeight=p}delete this._cellPositions;return this._measuredHeight=this._titleHeight+this._headerHeight+this._rowHeight*this._items.length},calculateItemPositions:function(){}});l._init=function(){delete l._init;if(a._init){a._init()}var p=function(){if(this.listViewMonitor){this.listViewMonitor.setTitleView(this)}p._superfunc.apply(this,Array.prototype.slice.call(arguments))};var o=function(r){if(this._titleView&&this._titleView.listViewMonitor==this){delete this._titleView.listViewMonitor}this._titleView=r;if(r.listViewMonitor!=this){r.listViewMonitor=this;if(!p._superfunc){p._superfunc=r.setFrame}if(r.setFrame!=p){r.registerAccessors("frame",null,p)}}this._titleHeight=r.getFrame()[3]||0;delete this._measuredHeight;k.setTitleView.call(this,d.objectToId(r));return this};var m=function(){return this._titleView};l.registerAccessors("titleView",m,o);l.synthesizeProperty("rowHeight");var n=function(r){r=(r instanceof Array)?r:Array.prototype.slice.call(arguments);this.flush();this._items=r;delete this._measuredHeight;if(!this._listView){return}this._listView.reloadData()};var q=function(){return this._items};l.registerAccessors("items",q,n);l.synthesizeProperty("yPosition")}}};__ngs._7r={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._t).Class;var d=b.ListViewItem=a.subclass({type:"listview-item",_reuseId:"__default__",_currentView:null,_onCreateView:function(){},_onReleaseView:function(e){},_onSetView:function(e){},setOnCreateView:function(e){this._onCreateView=e},setOnReleaseView:function(e){this._onReleaseView=e},setOnSetView:function(e){this._onSetView=e},setHeight:function(e){this._height=e},getHeight:function(){return this._height},_setCurrentView:function(e){if(e instanceof a){this._onSetView(e)}else{this._onReleaseView(this._currentView)}this._currentView=e;return this},getCurrentView:function(){return this._currentView},initialize:function(e){if(e){this._reuseId=e}return this}})}};__ngs._7s={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var e=__ngs.r_(__ngs._7h).View;var a=__ngs.r_(__ngs._22).Commands;var d=b.CellView=e.subclass({type:"cell",initialize:function($super,f){if(d._init){d._init()}$super(f)}});d._init=function(){delete d._init;if(e._init){e._init()}d.synthesizePropertyWithState("image",a.setImage);d.synthesizePropertyWithState("imageBorder",a.setImageBorder);d.synthesizeCompoundProperty("imageInsets",a.setImageInsets);d.synthesizeProperty("imageFit",a.setImageFitMode);d.synthesizeCompoundProperty("imageGravity",a.setImageGravity);d.synthesizeCompoundProperty("imageTransform",a.setImageTransform);d.synthesizePropertyWithState("rightImage",a.setRightImage);d.synthesizePropertyWithState("rightImageBorder",a.setRightImageBorder);d.synthesizeCompoundProperty("rightImageInsets",a.setRightImageInsets);d.synthesizeProperty("rightImageFit",a.setRightImageFitMode);d.synthesizeCompoundProperty("rightImageGravity",a.setRightImageGravity);d.synthesizeCompoundProperty("rightImageTransform",a.setRightImageTransform);d.registerEventType("imageLoaded");d.registerEventType("imageLoadFailed");d.synthesizePropertyWithState("title",a.setTitle);d.synthesizePropertyWithState("titleColor",a.setTitleColor);d.synthesizePropertyWithState("titleFont",a.setTitleFont);d.synthesizePropertyWithState("titleShadow",a.setTitleShadow);d.synthesizeCompoundProperty("titleGravity",a.setTitleGravity);d.synthesizeProperty("titleSize",a.setTitleSize);d.synthesizeCompoundProperty("titleInsets",a.setTitleInsets);d.synthesizePropertyWithState("text",a.setText);d.synthesizePropertyWithState("textColor",a.setTextColor);d.synthesizePropertyWithState("textShadow",a.setTextShadow);d.synthesizePropertyWithState("textFont",a.setTextFont);d.synthesizeCompoundProperty("textGravity",a.setTextGravity);d.synthesizeProperty("textSize",a.setTextSize);d.synthesizeCompoundProperty("textInsets",a.setTextInsets)}}};__ngs._7t={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var g=__ngs.r_(__ngs._23).AbstractView;var b=__ngs.r_(__ngs._22).Commands;var f=__ngs.r_(__ngs._b);var a={normal:{gradient:["FFED 0.000","FFA4 1.000"],insets:"{4.0,4.0,4.0,4.0}",outerLine:"FF51 2.0",outerShadow:"0000 0.0 {0.0,0.0}",corners:"3.0 3.0 3.0 3.0"},pressed:{innerShadow:"FF00 6.0 {0.0,-1.0}",gradient:["FF80 0.000","FF80 1.000"],insets:"{4.0,4.0,4.0,4.0}",outerLine:"FF51 2.0",outerShadow:"0000 0.0 {0.0,0.0}",corners:"3.0 3.0 3.0 3.0"},checked:{innerLine:"FF27A227 2.0",corners:"3.0 3.0 3.0 3.0",insets:"{4.0,4.0,4.0,4.0}",gradient:["FF2CFF2B 0.000","FF179117 1.000"],outerShadow:"0000 0.0 {0.0,0.0}",outerLine:"FF51 3.0",innerShadow:"FF97FE97 1.0 {0.0,0.0}"},checkedpressed:{innerShadow:"FF0F610F 5.0 {0.0,-1.0}",gradient:["FF179117 0.000","FF179117 1.000"],insets:"{4.0,4.0,4.0,4.0}",outerLine:"FF2B512B 3.0",outerShadow:"0000 0.0 {0.0,0.0}",corners:"3.0 3.0 3.0 3.0"},disabled:{innerShadow:"0000 0.0 {0.0,0.0}",gradient:["66B6 0.000","66CA 1.000"],insets:"{4.0,4.0,4.0,4.0}",outerLine:"7FE0 3.0",outerShadow:"0000 0.0 {0.0,0.0}",corners:"3.0 3.0 3.0 3.0"}};var d=c.CheckBox=g.subclass({type:"checkbox",initialize:function($super,h){if(d._init){d._init()}this._checked=false;$super();this.setGradient(a.normal,b.State.Normal);this.setGradient(a.pressed,b.State.Pressed);this.setGradient(a.checked,b.State.Checked);this.setGradient(a.checkedpressed,b.State.Checked|b.State.Pressed);this.setGradient(a.disabled,b.State.Disabled);this.setImageInsets([4,4,4,4]);this.setAttributes(h)},performEventCallback:function($super,h){if(h.eventType=="click"){this._checked=h.checked;if(this._checked){this._state=this._state|b.State.Checked}else{this._state=this._state&~b.State.Checked}}$super(h)}});d._init=function(){delete d._init;if(g._init){g._init()}d.synthesizePropertyWithState("image",b.setImage);d.bindPropertyState("image","checked",b.State.Checked);d.synthesizeCompoundProperty("imageInsets",b.setImageInsets);d.registerEventType("imageLoaded");d.registerEventType("imageLoadFailed");d.synthesizePropertyWithState("text",b.setText);d.bindPropertyState("text","checked",b.State.Checked);d.synthesizePropertyWithState("textColor",b.setTextColor);d.bindPropertyState("textColor","checked",b.State.Checked);d.synthesizePropertyWithState("textShadow",b.setTextShadow);d.bindPropertyState("textShadow","checked",b.State.Checked);d.synthesizeCompoundProperty("textGravity",b.setTextGravity);d.synthesizeProperty("textSize",b.setTextSize);d.synthesizePropertyWithState("textFont",b.setTextFont);d.bindPropertyState("textFont","checked",b.State.Checked);d.synthesizeCompoundProperty("textInsets",b.setTextInsets);d.synthesizeProperty("checked",b.setChecked)}}};__ngs._7u={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var d=__ngs.r_(__ngs._23).AbstractView;var a=__ngs.r_(__ngs._22).Commands;var e=b.EditText=d.subclass({type:"edittext",initialize:function($super,f){if(e._init){e._init()}$super(f);this.setOnClick=this.setOnClickCancel=function(){NgLogE("WARNING: Click and ClickCancel events do not work on EditText objects.")}},InputTypes:a.InputType,EnterKeyTypes:a.EnterKeyType,performEventCallback:function($super,f){try{switch(f.eventType){case"change":this._text=f.text;default:$super(f)}}catch(g){NgHandleException(g)}},getText:function(){return this._text||""},setText:function(f){this._text=f;a.setText.call(this,0,f)},focus:function(){a.setFocus.call(this,true)},blur:function(){a.setFocus.call(this,false)},setFocus:function(f){try{throw new Error("EditText.setFocus is deprecated and should not be used. Please use .focus() and .blur().")}catch(g){NgHandleException(g)}a.setFocus.call(this,f)}});e._init=function(){delete e._init;if(d._init){d._init()}e.registerAccessors("text",e.prototype.getText,e.prototype.setText);e.synthesizeProperty("placeholder",a.setPlaceholderText);e.synthesizeProperty("placeholderColor",a.setPlaceholderTextColor);e.synthesizeProperty("placeholderShadow",a.setPlaceholderTextShadow);e.synthesizeProperty("inputType",a.setInputType);e.synthesizeProperty("enterKeyType",a.setEnterKeyType);e.synthesizePropertyWithState("textColor",a.setTextColor);e.synthesizePropertyWithState("textShadow",a.setTextShadow);e.synthesizeCompoundProperty("textGravity",a.setTextGravity);e.synthesizeProperty("textSize",a.setTextSize);e.synthesizePropertyWithState("textFont",a.setTextFont);e.registerEventType("change");e.registerEventType("focus");e.registerEventType("blur");e.registerEventType("action")}}};__ngs._7v={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var e=__ngs.r_(__ngs._23).AbstractView;var a=__ngs.r_(__ngs._22).Commands;var d=b.EditTextArea=e.subclass({type:"edittextarea",initialize:function($super,f){if(d._init){d._init()}$super(f)},performEventCallback:function($super,f){try{switch(f.eventType){case"change":this._text=f.text;$super(f);break;case"focus":case"blur":$super(f);break}}catch(g){NgHandleException(g)}},getText:function(){return this._text||""},setText:function(f){this._text=f;a.setText.call(this,0,f)},focus:function(){a.setFocus.call(this,true)},blur:function(){a.setFocus.call(this,false)}});d._init=function(){delete d._init;if(e._init){e._init()}d.registerAccessors("text",d.prototype.getText,d.prototype.setText);d.synthesizeProperty("placeholder",a.setPlaceholderText);d.synthesizeProperty("placeholderColor",a.setPlaceholderTextColor);d.synthesizeProperty("placeholderShadow",a.setPlaceholderTextShadow);d.synthesizePropertyWithState("textColor",a.setTextColor);d.synthesizePropertyWithState("textShadow",a.setTextShadow);d.synthesizeCompoundProperty("textGravity",a.setTextGravity);d.synthesizeProperty("textSize",a.setTextSize);d.synthesizePropertyWithState("textFont",a.setTextFont);d.registerEventType("change");d.registerEventType("focus");d.registerEventType("blur")}}};__ngs._7w={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var e=__ngs.r_(__ngs._23).AbstractView;var a=__ngs.r_(__ngs._22).Commands;var d=b.Spinner=e.subclass({type:"spinner",initialize:function($super,f){if(d._init){d._init()}return $super(f)}});d._init=function(){delete d._init;if(e._init){e._init()}d.synthesizeProperty("darkStyle",a.setDarkStyle)}}};__ngs._7x={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var f=__ngs.r_(__ngs._23).AbstractView;var b=__ngs.r_(__ngs._22).Commands;var e=__ngs.r_(__ngs._b);var a=c.ProgressBar=f.subclass({type:"progressbar",initialize:function($super,g){if(a._init){a._init()}return $super(g)},useForUpdateProgress:b.useForUpdateProgress});a._init=function(){delete a._init;if(f._init){f._init()}a.synthesizePropertyWithState("progressGradient",b.setProgressGradient);a.synthesizePropertyWithState("secondaryGradient",b.setSecondaryGradient);var g=function(j){var h=(j instanceof Array)?j:Array.prototype.slice.call(arguments);while(h.length<2){h.push(0)}b.setProgress.apply(this,h)};a.synthesizeCompoundProperty("progress",g)}}};__ngs._7y={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._5).Core;a.Diagnostics=c.DiagnosticEmitter.singleton({classname:"UI_Diagnostics",initialize:function($super){$super("UI")}})}};__ngs._7z={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var e=__ngs.r_(__ngs._23).AbstractView;var a=__ngs.r_(__ngs._22).Commands;var d=b.AdView=e.subclass({type:"adview",initialize:function($super,f){if(d._init){d._init()}$super(f);this.onappear=this.bind(this._onappear);this.ondisappear=this.bind(this._ondisappear);this.onclick=this.bind(this._onclick)},onappear:function(){},ondisappear:function(){},_onappear:function($super,f){($super||function(){})(f)},_ondisappear:function($super,f){($super||function(){})(f)},performEventCallback:function($super,f){if(f.eventType=="click"){NgLogD("AD WAS CLICKED in AdView wooo!!!!");($super||function(){})(f)}if(f.eventType=="load"){NgLogD("AD WAS LOADED in AdView wooo!!!!");($super||function(){})(f)}},pauseAds:function(){a.pauseAds.call(this)},resumeAds:function(){a.resumeAds.call(this)},setRefreshRate:function(f){a.setAdRefreshRate.call(this,f)},setAutoplay:function(f){a.setAdRefreshRate.call(this,f)},getAdEventMetadata:function(){NgLogD("AD EventMetetData was requested!");var f="DefaultAdEventMetaData";return f}});d._init=function(){delete d._init;if(e._init){e._init()}d.synthesizeProperty("active",a.setActive);d.registerEventType("click");d.registerEventType("load")}}};__ngs._80={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var d=__ngs.r_(__ngs._23).AbstractView;var a=__ngs.r_(__ngs._22).Commands;var e=b.DocumentView=d.subclass({type:"documentview",initialize:function($super,f){if(e._init){e._init()}$super(f)}});e._init=function(){delete e._init;if(d._init){d._init()}e.synthesizeProperty("documentURL",a.setSourceDocument)}}};__ngs._81={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var f=__ngs.r_(__ngs._23).AbstractView;var a=__ngs.r_(__ngs._25);var b=__ngs.r_(__ngs._22).Commands;var d=c.CheckoutView=f.subclass({type:"checkoutview",initialize:function($super,g){if(d._init){d._init()}$super(g)}});d._init=function(){delete d._init;if(f._init){f._init()}d.registerAccessors("postData",null,b.setPostData);d.registerAccessors("postURL",null,b.loadPostURL);d.registerAccessors("getURL",null,b.loadGetURL)}}};__ngs._82={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var e=__ngs.r_(__ngs._23).AbstractView;var b=__ngs.r_(__ngs._22).Commands;var f=__ngs.r_(__ngs._83).MapAnnotation;var a=c.MapView=e.subclass({type:"mapview",initialize:function($super,g){this._annotations=[];this._region=[];return $super(g)},getCenterCoordinate:function(){return[this._region[0],this._region[1]]},setCenterCoordinate:function(h,j,g){this._region[0]=h;this._region[1]=j;if(!this._region[2]){this._region[2]=0.05}if(!this._region[3]){this._region[3]=0.05}this.setRegion(this._region[0],this._region[1],this._region[2],this._region[3],g)},getCoordinateSpan:function(){return[this._region[2],this._region[3]]},selectAnnotation:function(g){if(g instanceof f){var h=this._annotations.indexOf(g);if(h!=-1){b.selectAnnotation.call(this,g.__objectRegistryId);return}}b.selectAnnotation.call(this,-1)},addAnnotation:function(g){if(g instanceof f){this._annotations.push(g);b.addAnnotation.call(this,g.__objectRegistryId)}else{throw {message:this.type+".addAnnotation: "+g+" is not a MapAnnotation!"}}return this},removeAnnotation:function(g){if(g instanceof f){var h=this._annotations.indexOf(g);if(h!=-1){this._annotations.splice(h,1)}b.removeAnnotation.call(this,g.__objectRegistryId)}else{throw {message:this.type+".removeAnnotation: "+g+" is not a MapAnnotation!"}}return g},updateRegionFits:function(h,j,g,k){this._region[0]=h;this._region[1]=j;this._region[2]=g;this._region[3]=k},performEventCallback:function($super,g){if(g.eventType=="regionchange"){this.updateRegionFits(g.latitude,g.longitude,g.latitudeDelta,g.longitudeDelta)}$super(g)}});(function(){a.synthesizeProperty("scrollable",b.setScrollable);a.synthesizeProperty("zoomable",b.setZoomable);a.synthesizeCompoundProperty("region",b.setRegion);a.registerEventType("regionchange")})()}};__ngs._83={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=__ngs.r_(__ngs._24).Element;var a=__ngs.r_(__ngs._22).Commands;var e=c.MapAnnotation=b.subclass({type:"mapannotation",initialize:function($super,f){return $super(f)},setCalloutLeftView:function(f){this._calloutLeftView=f;a.setCalloutLeftView.call(this,f.__objectRegistryId)},getCalloutLeftView:function(){return this._calloutLeftView},setCalloutRightView:function(f){this._calloutRightView=f;a.setCalloutRightView.call(this,f.__objectRegistryId)},getCalloutRightView:function(){return this._calloutRightView},setView:function(f){this._view=f;a.setView.call(this,f.__objectRegistryId)},getView:function(){return this._view},setImage:function(g){console.log("WARNING : MapAnnotation.setImage has been deprecated. Use MapAnnotation.setView instead.");var f=new UI.Image();f.setImage(g);f.setFrame([0,0,40,40]);this.setView(f)},performEventCallback:function($super,f){$super(f)}});(function(){e.synthesizeCompoundProperty("coordinate",a.setCoordinate);e.synthesizeCompoundProperty("centerOffset",a.setCenterOffset);e.synthesizeProperty("calloutTitle",a.setCalloutTitle);e.synthesizeProperty("calloutSubtitle",a.setCalloutSubtitle);e.synthesizeProperty("calloutEnabled",a.setCalloutEnabled);e.registerEventType("select");e.registerEventType("deselect")})()}};__ngs._84={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var d=__ngs.r_(__ngs._23).AbstractView;var a=__ngs.r_(__ngs._22).Commands;var e=b.CutSceneView=d.subclass({type:"_cutsceneview",initialize:function($super,f){if(e._init){e._init()}return $super(f)},destroy:function($super){if(this.cbId){a.takeTemporaryCallback(this.cbId)}$super()},play:function(g,f){this.cbId=(typeof f=="function")?a.registerTemporaryCallback(f.bind(this)):"";a.playVideo.call(this,g,this.cbId)}});e._init=function(){delete e._init;if(d._init){d._init()}}}};__ngs._85={_c:null,_d:function(){var b={exports:{}};var e=b.exports;this._c=b;var c=__ngs.r_(__ngs._59).UI;var d=__ngs.r_(__ngs._2z).Assets;var k=__ngs.r_(__ngs._5o).Balance;var f=__ngs.r_(__ngs._2v).ServiceHost;var g=__ngs.r_(__ngs._5p).Transaction;var h=__ngs.r_(__ngs._5l).UnspammableButton;var a=new (__ngs.r_(__ngs._f).RequireLoader)({BalanceButtonStyle:function(){return __ngs.r_(__ngs._86).GameStyle},ShowBankAction:function(){return __ngs.r_(__ngs._2y).ShowBankAction},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics}});var j=e.BalanceButton=c.CellView.subclass({classname:"BalanceButton",initialize:function($super,n,m){$super();NgLogD("BalanceButton:  initialize start");if(m){this._sourcePage=m}else{NgLogE("BalanceButton:initialize sourcePage needed to be defined for analytics purpose.")}this._bankButtonAction=new a.ShowBankAction();this.setOnClickDown(this._bankButtonAction.bind(this._bankButtonAction.prepare));var l=this;this.setOnClick(function(){f.showLoadingHelper(function(){NgLogD("BalanceButton: button tapped");a.MobageAnalytics.reportEvent("BankBalanceButtonClick",{sourcePage:l._sourcePage});l._bankButtonAction.execute()})});this.setOnClickCancel(this._bankButtonAction.bind(this._bankButtonAction.cancel));this.updateBalance();if(n&&typeof n=="function"){setTimeout(this.bind(function(){n()}),50)}g.registerBalanceCB("balanceButton",this.bind(this.updateBalance));a.BalanceButtonStyle.applyTo(this);NgLogD("BalanceButton:  initialize end")},destroy:function(){g.unRegisterBalanceCB("balanceButton")},setCurrencyText:function(l){this.setTitle(l)},setBalanceText:function(l){this.setText(k.addCommas(l))},updateBalance:function(){k.get(function(n,p,o,m,l){if(p&&!this._destroyed){this.setBalance(o,m);if(l){this.setImage(l)}}}.bind(this))},setBalance:function(m,l){this.setCurrencyText(l);this.setBalanceText(m)}})}};__ngs._86={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var e=__ngs.r_(__ngs._6k).MobageStyle;var c=__ngs.r_(__ngs._2z).Assets;var a=e.ScaledCorners;var f=e.ScaledTextSize;e.lazyLoad(b,"ProfileStyle",function(){return{style:{gradient:{corners:a(10),gradient:["FFBBC9D5 0.000","FFBBC9D5 1.000"],innerShadow:"33000000 2.0 {0.0,-2.0}",outerShadow:"FFE8EEF2 2.0 {0.0,-2.0}"},pressedGradient:{corners:a(10),gradient:["FFFFFFFF 0.000","FFFFFFFF 1.000"],innerShadow:"33000000 2.0 {0.0,-2.0}",outerShadow:"FFE8EEF2 2.0 {0.0,-2.0}",insets:"{0.0,0.0,2.0,0.0}"},titleColor:"FF000000",titleSize:f(10),titleFont:e.defaultRegularFontFace,textColor:"FF004AA9",textSize:f(11),textFont:e.defaultBoldFontFace,image:c.image("coin_balance.png"),imageInsets:[2,2,2,2],rightImageInsets:[0,0,0,-32]},extras:{minWidth:150,minHeight:46}}});e.lazyLoad(b,"GameStyle",function(){return{style:{gradient:{corners:a(8),gradient:["FF2E3F58 0.000","FF1F2736 1.000"],innerShadow:"FF415D79 2.0 {0.0,-2.0}",outerLine:"FF000000 2.0"},pressedGradient:{corners:a(8),gradient:["FF2C1D36 0.000","FF1D0514 1.000"],innerShadow:"FD203B57 2.0 {0.0,-2.0}",outerLine:"FF000000 2.0",insets:"{0.0,0.0,2.0,0.0}"},titleColor:"FFFFFFFF",titleSize:f(10),titleFont:e.defaultRegularFontFace,titleInsets:[0,-32,0,0],textColor:"FFFFFFFF",textSize:f(11),textFont:e.defaultBoldFontFace,textInsets:[0,-32,0,0],image:c.image("coin_balance.png"),imageInsets:[5,5,5,5]},extras:{minWidth:150,minHeight:46}}})}};__ngs._87={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var e=__ngs.r_(__ngs._5).Core;var b=__ngs.r_(__ngs._2j).Logger;var a=c.ReferenceCounting=e.Class.subclass({classname:"ReferenceCounting",initialize:function(){this.__retainCount=0},retain:function(){if(isNaN(this.__retainCount)){b.error("Error: ReferenceCounting subclass: this.__retainCount isNaN for: "+this.classname);return this}++this.__retainCount;return this},release:function(){if(--this.__retainCount===0){this.destroy()}if(this.__retainCount<0){throw new Error("Reference counting error (count went negative); is there a missing retain?")}},autorelease:function(){a.addToAutoreleasePool(this);return this},destroy:function(){for(var f in this){if(this.hasOwnProperty(f)){delete this[f]}}this._destroyed=true;delete this.prototype},zombieSafeCallback:function(h,g){var f=this;return function(){if(f._destroyed){if(g){g(f)}return}return h.apply(f,Array.prototype.slice.call(arguments))}},isDestroyed:function(){return this._destroyed}});b.decorateDescendants(a);c.ReferenceCounting.pool=null;c.ReferenceCounting.tickListener=null;c.ReferenceCounting.lastTickWasEmpty=false;c.ReferenceCounting.addToAutoreleasePool=function(f){if(!a.pool){a.pool=[]}if(!a.tickListener){a.tickListener=e.MessageListener.singleton({initialize:function($super){if($super){$super()}},onUpdate:function(g){a.autoreleasePoolDrain()},_startListeningEmitter:function($super,g){this.listening=true;return $super(g)},_stopListeningEmitter:function($super,g){this.listening=false;return $super(g)}});a.tickListener.instantiate()}if(!a.tickListener.listening){NgLogD("ReferenceCounting: hook autorelease pool.");e.UpdateEmitter.addListener(a.tickListener,a.tickListener.onUpdate)}a.pool.push(f)};c.ReferenceCounting.autoreleasePoolDrain=function(){var g=a.pool;NgLogD("ReferenceCounting: Autorelease pool drain! ("+g.length+" objects)");a.pool=[];var h;for(var f in g){if(g.hasOwnProperty(f)&&(h=g[f])&&h.retain&&typeof h.retain=="function"){h.release()}}if(a.pool.length||g.length){a.lastTickWasEmpty=false}else{if(a.lastTickWasEmpty){NgLogD("ReferenceCounting: unhook autorelease pool.");e.UpdateEmitter.removeListener(a.tickListener)}a.lastTickWasEmpty=true}}}};__ngs._88={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;__ngs.r_(__ngs._9u);__ngs.r_(__ngs._bg)}};__ngs._89={_c:null,_d:function(){var f={exports:{}};var c=f.exports;this._c=f;var e=__ngs.r_(__ngs._4).Device;var g=__ngs.r_(__ngs._59).UI;var b=__ngs.r_(__ngs._n).LocalizedString;var d=__ngs.r_(__ngs._2z).Assets;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Game:function(){return __ngs.r_(__ngs._2e).Game},CredentialsStyles:function(){return __ngs.r_(__ngs._6j)}});var h=c.CredentialsHeaderView=g.View.subclass({initialize:function($super,j){$super(j);this.titleBarView=(new g.View()).retain();this.mobageLogo=(new g.Image()).retain();this.gameIcon=(new g.Image()).retain()},destroy:function(){this.titleBarView.release();this.mobageLogo.release();this.gameIcon.release()},layoutSubviews:function($super){$super();var j=new g.ViewGeometry.Rect(0,0,g.Window.getWidth(),g.Window.getHeight());var m=new g.ViewGeometry.Rect(this.getFrame());var k=m.copy();k.inset(-4,-4,0,-4);var l=m.copy();this.titleBarView.setFrame(k);this.addChild(this.titleBarView);l.sliceVertical(10*(j.h/800));this.logoAreaRect=(l.sliceVertical(80*(j.h/800)));this.logoAreaRect.inset(0,10,0,0);this.gameIcon.setFrame(this.logoAreaRect);this.gameIcon.setImageGravity(g.ViewGeometry.Gravity.Right);this.mobageLogo.setFrame(this.logoAreaRect);this.addChild(this.mobageLogo)},setStyle:function($super,j){$super(j);this.titleBarView.setAttributes(j.props()["titleBarView"]);this.mobageLogo.setImage(d.image("mobagelogotm.png"))},setGameIcon:function(j){a.Game._getGameWithAndroidPackageName(j,this.bind(function(l,k){NgLogD("Market app "+j+" has game "+k);if(!l&&k){NgLogD("Credentials Header Game Icon url="+k.iconURL+", name="+k.name);this.gameIcon.setImage(k.iconURL);this.addChild(this.gameIcon)}else{NgLogE("Credentials Header cant find the game Icon, Err: "+l)}}))}})}};__ngs._8a={_c:null,_d:function(){var f={exports:{}};var m=f.exports;this._c=f;var k=__ngs.r_(__ngs._59).UI;var c=k.ViewGeometry.Rect;var b=k.ViewGeometry.Scale;var g=__ngs.r_(__ngs._2j).Logger;var e=m.TSLogD=function(o){if(g.shouldLog(null,"TextScaling")){var p=Array.prototype.slice.call(arguments);p.unshift("TextScaling: ");g.debug.apply(g,p)}};var d=m.TSLogE=function(o){var p=Array.prototype.slice.call(arguments);p.unshift("TextScaling: ");g.error.apply(g,p)};var j=m.TextScalingModes={None:0,ScaleTextDown:1,ScaleTextUp:1<<1,ScaleTextDownOrUp:(1|(1<<1)),EllipsifyText:1<<2,TruncateText:1<<3};var l=6;var a=0.95;m.setText=function($super,p,o){if($super){$super(p,o)}else{console.log("setText $super was undefined ",this);this.textScalingBehavior=n.StrictMultiLine;console.log("and now set ",this)}if(!this.textScalingBehavior){d("textScalingBehavior undefined",this);return}if(!this.getTextMeasurementForState){console.log("getTextMeasurementForState");this.getTextMeasurementForState=function(u){var q=(this.getFrame()||[0,0,-1,-1]);var v=this.getTextFont(u)||this.getTextFont();var s=this.getTextSize();var r=this.getText(u);console.log("measureText: "+r+" "+JSON.stringify(q)+" "+JSON.stringify(v)+" "+JSON.stringify(s));k.measureText(r,q[2],q[3],v,s,this.textScalingBehavior.bind(this))}}this.getTextMeasurementForState(o)};m.getTextMeasurementForState=function(r){var o=(this.getFrame()||[0,0,-1,-1]);var s=this.getTextFont(r)||this.getTextFont();var q=this.getTextSize();var p=this.getText(r);e("measureText: "+p+" "+JSON.stringify(o)+" "+JSON.stringify(s)+" "+JSON.stringify(q));k.measureText(p,o[2],o[3],s,q,this.textScalingBehavior.bind(this))};var n=m.TextMeasuredScalingBehaviors={None:null,DynamicMultiLine:function(q){if(!q||!this.maxLines){return}var p=this.getText(q.state)||"";if(!p.split){d("view.getText returned a non-string, how? "+JSON.stringify(p));p=""}var o=this.getTextSize(q.state)*(q.lineWidths[0]/q.totalWidth)},StrictMultiLine:function(r){console.log("StrictMultiLine callback",JSON.stringify(r));if(!r){return}var q=this.getText(r.state)||"";if(!q.split){d("view.getText returned a non-string, how? "+JSON.stringify(q));q=""}var p=this.getTextSize(r.state)|(this._style?this._style.getTextSize(r.state):undefined);if(p){var o=p*(r.lineWidths[0]/r.totalWidth);this.setTextSize(o,r.state)}},SingleLine:null};var h=m.TextScalingEnhancements={setMaxLines:function(o){this.maxLines=o},getMaxLines:function(){return this.maxLines},setTextScalingBehavior:function(o){this.textScalingBehavior=o},getTextScalingBehavior:function(){return this.textScalingBehavior},setTextScalingMode:function(o){this._textScalingMode=o},getTextScalingMode:function(){return this._textScalingMode},setText:m.setText,getTextMeasurementForState:m.getTextMeasurementForState,textScalingBehavior:m.TextMeasuredScalingBehaviors.DynamicMultiLine,setTextCutOffOneLine:function(q,o){o=o||40;var p=q.replace(/\n/g," ");if(p.length>o){p=p.substr(0,o-1)+"…"}this.setText(p);return}}}};__ngs._8b={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=new (__ngs.r_(__ngs._f).RequireLoader)({UI:function(){return __ngs.r_(__ngs._59).UI},Device:function(){return __ngs.r_(__ngs._4).Device},UIStyle:function(){return __ngs.r_(__ngs._60).Style},Assets:function(){return __ngs.r_(__ngs._2z).Assets},LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},Settings:function(){return __ngs.r_(__ngs._4s).Settings},SupportWebScreen:function(){return __ngs.r_(__ngs._4t).SupportWebScreen},Credentials:function(){return __ngs.r_(__ngs._2r).Credentials},Session:function(){return __ngs.r_(__ngs._o).Session},ServiceHostR:function(){return __ngs.r_(__ngs._2v)},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton}});var a=c.MenuDrawer=b.UI.View.subclass({classname:"MenuDrawer",initialize:function($super){$super();this._sheet=b.UIStyle.registeredStyle("social.us.menudrawer").props();this.setAttributes(this._sheet.menuDrawer);this._mobageButtons=new Array();this._gameButtons=new Array();this.addMobageButton("support",b.Assets.image("menudrawer_support.png"),b.Assets.image("menudrawer_support_pressed.png"),"",function(){if(b.ServiceHostR.ServiceHost.navController){if(b.ServiceHostR.ServiceHost.navController.getTopViewController().classname!="SupportWebScreen"){b.ServiceHostR.ServiceHost.showLoadingHelper(function(){b.ServiceHostR.ServiceHost.navController.pushViewController(new b.SupportWebScreen())})}}});this.addMobageButton("settings",b.Assets.image("menudrawer_settings.png"),b.Assets.image("menudrawer_settings_pressed.png"),b.LocText("Settings"),function(){var e=b.Session.getCurrentSession();if(e.user()&&e.user().usesGuestLogin()){b.Credentials.showRegistration(null,true,true,"tiered",null,"menuDrawer_settings");return}if(b.ServiceHostR.ServiceHost.navController){if(b.ServiceHostR.ServiceHost.navController.getTopViewController().classname!="Settings"){b.ServiceHostR.ServiceHost.showLoadingHelper(function(){var f=b.Settings.initWithJSON({tab:"profile"});b.ServiceHostR.ServiceHost.navController.pushViewController(f)})}}});this.addMobageButton("home",b.Assets.image("menudrawer_home.png"),b.Assets.image("menudrawer_home_pressed.png"),b.LocText("Home"),function(){if(b.ServiceHostR.ServiceHost){if(b.ServiceHostR.ServiceHost.navController.getTopViewController().classname!="Home"){b.ServiceHostR.ServiceHost.showLoadingHelper(function(){b.ServiceHostR.ServiceHost.popToHome()})}}});this.addGameButton("home",b.Assets.image("menudrawer_home.png"),b.Assets.image("menudrawer_home_pressed.png"),b.LocText("Mobage Home"),function(){if(b.ServiceHostR.ServiceHost){b.ServiceHostR.ServiceHost.popToHome()}})},destroy:function(){this._mobageButtons=new Array();this._gameButtons=new Array();if(this._retainedViews){for(var e=0;e<this._retainedViews.length;e++){var f=this._retainedViews[e];if(f){f.release()}}}this._retainedViews=new Array()},sizeChanged:function(){this.layoutSubviews()},retainView:function(e){if(e){e.retain();if(!this._retainedViews){this._retainedViews=new Array()}this._retainedViews.push(e)}return e},addMobageButton:function(g,e,j,h,f){this.addButton(this._mobageButtons,g,e,j,h,f)},addGameButton:function(g,e,j,h,f){this.addButton(this._gameButtons,g,e,j,h,f)},addButton:function(l,h,e,k,j,f){var g=this.retainView(new b.UnspammableButton());g.setAttributes(this._sheet.menuDrawerButton);g.setGradient(this._sheet.menuDrawerButtonPressed.gradient,b.UI.State.Pressed);g.setImage(e);g.setImage(k,b.UI.State.Pressed);g.setImageGravity(b.UI.ViewGeometry.Gravity.TopCenter);g.setText(j);g.setTextColor(this._sheet.menuDrawerButtonPressed.textColor,b.UI.State.Pressed);g.setTextGravity(b.UI.ViewGeometry.Gravity.BottomCenter);g.onclick=this.bind(function(){if(!b.ServiceHostR.ServiceHost.isMenuDrawerClosedOrClosing()){b.ServiceHostR.ServiceHost.closeMenuDrawer();f()}});if(l){l.splice(0,0,{key:h,button:g})}this.layoutSubviews()},getMobageButtonByKey:function(e){return this.getButtonByKey(this._mobageButtons,e)},getGameButtonByKey:function(e){return this.getButtonByKey(this._gameButtons,e)},getButtonByKey:function(g,f){for(var e=0;e<g.length;e++){if(g[e].key===f){return g[e].button}}return null},isInMobage:function(){return true},isLandscape:function(e){return e==b.Device.OrientationEmitter.Orientation.LandscapeLeft||e==b.Device.OrientationEmitter.Orientation.LandscapeRight},layoutSubviews:function(){var t=null;var k=null;if(this.isInMobage()){t=this._mobageButtons;k=this._gameButtons;var m=this.getMobageButtonByKey("support");if(m){var f=b.LocText("Support");if(this.isLandscape(b.Device.OrientationEmitter.getInterfaceOrientation())){f=b.LocText("Support & Feedback")}m.setText(f)}}else{t=this._gameButtons;k=this._mobageButtons}if(k){for(var q=0;q<k.length;q++){var r=k[q].button;if(r){r.removeFromParent()}}}var h=this.getFrame();if(t&&h){var e=new b.UI.ViewGeometry.Rect(h);if(!e.isEmpty()){var u=Math.floor(e.w/t.length);var l=e.w-(u*(t.length-1));var s=this._sheet.imageHeightRatio*e.h;var p=this._sheet.topMarginRatio*e.h;var g=this._sheet.bottomMarginRatio*e.h;for(var o=0;o<t.length;o++){var n=t[o].button;if(n){n.setFrame([o*u,0,o<t.length-1?u:l,e.h]);n.setImageInsets([p,0,e.h-s-p,0]);n.setTextInsets([p+s,0,g,0]);if(!n.getParent()){this.addChild(n)}}}}}}})}};__ngs._8c={_c:null,_d:function(){var c={exports:{}};var f=c.exports;this._c=c;var j=__ngs.r_(__ngs._5).Core;var e=__ngs.r_(__ngs._59).UI;var g=__ngs.r_(__ngs._60).Style;var l=__ngs.r_(__ngs._n).LocalizedString;var d=__ngs.r_(__ngs._2e).Game;var k=__ngs.r_(__ngs._5l).UnspammableButton;var b=__ngs.r_(__ngs._2a).Destinations;var a=new (__ngs.r_(__ngs._f).RequireLoader)({GameDownloadStyle:function(){return __ngs.r_(__ngs._bh)},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost}});var h=f.GlobalDownloadingIcon=e.View.subclass({classname:"GlobalDownloadingIcon",initialize:function(){this._game=null;a.GameDownloadStyle;this._sheet=g.registeredStyle("social.us.globalgamedownloadicon").props();this._showing=false;this._lastProgress=0;this._button=(new k()).retain();this._progressBar=(new e.ProgressBar()).retain();this._label=(new e.Label()).retain();this._label.setText(l("Updating game..."));this._button.onclick=function(){if(this._game){b.pushScreen(a.ServiceHost.navController,"GameProfile",{game:this._game},this)}}.bind(this);this._progressBar.setTouchable(false);this._label.setTouchable(false);this._globalDownloadListener=new j.MessageListener();d.addGlobalDownloadListener(this._globalDownloadListener,this._onGlobalGameDownload.bind(this))},destroy:function(){d.removeGlobalDownloadListener(this._globalDownloadListener);this._globalDownloadListener.destroy();this._button.release();this._progressBar.release();this._label.release();if(this._game){this._game.removeDownloadListener(this)}},_onGlobalGameDownload:function(m){this._setGame(m.game)},initLayout:function(){var m=new e.ViewGeometry.Rect(this.getFrame());m.h*=1-this._sheet.insetFromBottomRatio;this._button.setGradient(this._sheet.clickableBackgroundPressedGradient,e.State.Pressed);this._button.setFrame([0,0,m.w,m.h]);this._progressBar.setAttributes(this._sheet.progressBar);var o=m.h*this._sheet.progressBarHeightRatio;this._progressBar.setFrame([2,m.h-o,m.w-4,o]);var n=m.h*this._sheet.labelHeightRatio;this._label.setAttributes(this._sheet.label);this._label.setFrame([0,m.h-n-o,m.w,n])},_setGame:function(m){if((!this._game&&!m)||(this.game&&m&&this.game.recordID==m.recordID)){return}if(this._game){this._game.removeDownloadListener(this)}if(m){m.addDownloadListener(this)}this._game=m;this._lastProgress=0;this._progressBar.setProgress(0,0);this.update()},update:function(){if(!this._progressBar||!this._label||!this._button){return}if(!this._game||!this._game.isDownloading()||this._lastProgress>=1){if(this._showing){this._button.removeFromParent();this._label.removeFromParent();this._progressBar.removeFromParent();this._showing=false}}else{if(!this._showing){this.addChild(this._button);this.addChild(this._label);this.addChild(this._progressBar);this._showing=true}}},downloadStarted:function(m){this._lastProgress=0;this._progressBar.setProgress(0,0);this.update()},downloadProgress:function(m,n,p,o){this._lastProgress=n;if(n>=1){this.update()}else{this._progressBar.setProgress(n,n)}},downloadCompleted:function(m,n){this._lastProgress=1;this._progressBar.setProgress(1,1);this.update()},downloadError:function(m,n){this._lastProgress=1;this._progressBar.setProgress(1,1);this.update()}})}};__ngs._8d={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var d=__ngs.r_(__ngs._59).UI;var a=new (__ngs.r_(__ngs._f).RequireLoader)({LayoutMethods:function(){return __ngs.r_(__ngs._5c).LayoutMethods}});b.FullScreenLoader=d.View.subclass({classname:"FullScreenLoader",initialize:function($super){$super();this.landscapeFrame=new d.View({gradient:{gradient:["DD000000 0.0"]}}).retain();this.landscapeFrame.setGradient({gradient:["F000 0.0"]},d.State.Selected);this.landscapeFrame.setVisibleInOrientations(d.Commands.OrientationFlag.Landscape);this.addChild(this.landscapeFrame);this.portraitFrame=new d.View({gradient:{gradient:["DD000000 0.0"]}}).retain();this.portraitFrame.setGradient({gradient:["F000 0.0"]},d.State.Selected);this.portraitFrame.setVisibleInOrientations(d.Commands.OrientationFlag.Portrait);this.addChild(this.portraitFrame);this.landscapeSpinner=new d.Spinner().retain();this.landscapeFrame.addChild(this.landscapeSpinner);this.portraitSpinner=new d.Spinner().retain();this.portraitFrame.addChild(this.portraitSpinner);this.layout(d.Window.getWidth(),d.Window.getHeight());a.LayoutMethods.createLayoutListener(this,this.layoutEventHandler)},setOpaque:function(e){this.landscapeFrame.setState(e?d.State.Selected:d.State.Normal);this.portraitFrame.setState(e?d.State.Selected:d.State.Normal)},destroy:function($super){this.spinner.release();$super()},layout:function(j,e){var h=Math.max(d.Window.getWidth(),d.Window.getHeight());var f=Math.min(d.Window.getWidth(),d.Window.getHeight());this.setFrame([0,0,h,h]);this.landscapeFrame.setFrame([0,0,h,f]);this.portraitFrame.setFrame([0,0,f,h]);var g=0.075*h;this.landscapeSpinner.setFrame([(h-g)/2,(f-g)/2,g,g]);this.portraitSpinner.setFrame([(f-g)/2,(h-g)/2,g,g])},layoutEventHandler:function(e){console.log("Layout Event!",e);this.layout(e.width,e.height)}})}};__ngs._8e={_c:null,_d:function(){var d={exports:{}};var f=d.exports;this._c=d;var a=__ngs.r_(__ngs._60).Style;var j=a.ScaledCorners;var b=a.ScaledTextSize;var c=__ngs.r_(__ngs._6k).MobageStyle;var e=c.ScaledCorners;var h=c.ScaledTextSize;var g=__ngs.r_(__ngs._9u).CommonElements;c.lazyLoad(f,"ModalDialog",function(){return{style:{}}});c.lazyLoad(f,"NoMobacoinModal",function(){return{children:{_topBarBgPane:{style:{gradient:{corners:"8 8 0 0",gradient:["EE1A3B7A 0.000","EE2C5CA5 1.000"]}}},_bottomPane:{style:{gradient:{corners:"0 0 8 8",gradient:["EE16346E 0.000","EE16346E 1.000"]}}},_gotoBankButton:g.standardButton},extras:{viewRatio:{buttonHFactor:(1/6),labelHFactor:(1/6),labelTextHFactor:(3/5)}}}});c.lazyLoad(f,"ForgotPasswordModal",function(){return{children:{_topBarBgPane:{style:{gradient:{corners:"8 8 8 8",gradient:["EE1A3B7A 0.000","EE2C5CA5 1.000"]}}},_titleLabel:{style:{textColor:"FFFFFFFF",textFont:c.defaultBoldFontFace,textSize:h(14),textGravity:[0.5,0.5]}},_textBox:g.textBox,_sendButton:g.standardButton,_cancelButton:g.grayButton}}});c.lazyLoad(f,"TouchCaptureLayer",function(){return{style:{gradient:{gradient:["88000000 0.0"]}}}});c.lazyLoad(f,"BDayRepairModal",function(){return{style:{gradient:{corners:e(8),gradient:["EE0C152D 0.000","EE0C152D 1.000"]}},children:{title:{style:{textColor:"FFFFFFFF",textFont:c.defaultBoldFontFace,textSize:h(14),textGravity:[0.5,0.5]}},inputLabel:{style:{textColor:"FFFFFFFF",textFont:c.defaultRegularFontFace,textSize:h(10),textGravity:[1,0.5]}}}}});f.BDayRepairSizing={titleHeightRatio:1/3,inputWidthRatio:1/6,inputHeightRatio:1/3};a.sheet("social.us.modaldialog",{topBarBackgroundPane:{gradient:{corners:j(8),gradient:["EE0C152D 0.000","EE0C152D 1.000"]}},standardButton:{gradient:{corners:j(8),gradient:["FF5AB0E2 0.000","FF2B76BC 1.000"],innerLine:"4484C3E9 2.0"},pressedGradient:{corners:j(8),gradient:["FF3682C3 0.000","FF1C61A8 1.000"],innerLine:"2B003366 2.0"},textFont:a.defaultBoldFontFace,textSize:b(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"},textBox:{gradient:{corners:j(8),gradient:["FFC9C9C9 0.000","FFEDEDED 1.000"],outerLine:"FF000000 2.0"},gradientError:{corners:j(8),gradient:["FFC9C9C9 0.000","FFEDEDED 1.000"],outerLine:"FFFF0000 2.0"},textFont:a.defaultRegularFontFace,textColor:"FF000000",textGravity:[0.5,0.5]},buttonHFactor:(2/8),labelHFactor:(2/8),labelTextHFactor:(3/5)});a.sheet("social.us.loginmodaldialog",{topBarBackgroundPane:{gradient:{corners:j(8),gradient:["FF1C5FA3 0.000","FF0E2A5A 1.000"]}},textHeader:{textFont:a.defaultBoldFontFace,textColor:"FFFFFFFF",textShadow:"45000000 1.0 {0.0,-2.0}"},textBody:{textColor:"FFFFFFFF",textShadow:"45000000 1.0 {0.0,-2.0}"},standardButton:{gradient:{corners:j(8),gradient:["FF5AB0E2 0.000","FF2B76BC 1.000"],innerLine:"4484C3E9 2.0"},pressedGradient:{corners:j(8),gradient:["FF3682C3 0.000","FF1C61A8 1.000"],innerLine:"2B003366 2.0"},textFont:a.defaultBoldFontFace,textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"45000000 1.0 {0.0,-2.0}"}});a.sheet("social.us.marketmodaldialog",{topBarBackgroundPane:{gradient:{corners:j(8),gradient:["FFFFFFFF 0.000","FFFFFFFF 1.000"]}},textHeader:{textFont:a.defaultBoldFontFace,textColor:"FF000000"},textBody:{textColor:"FF202020"}})}};__ngs._8f={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=new (__ngs.r_(__ngs._f).RequireLoader)({EditText:function(){return __ngs.r_(__ngs._7u).EditText},LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},MobageStyle:function(){return __ngs.r_(__ngs._6k).MobageStyle},EditTextLimits:function(){return __ngs.r_(__ngs._2q).EditTextLimits}});var d=__ngs.r_(__ngs._59).UI;var e=b.LimitedEditText=a.EditText.subclass({classname:"LimitedEditText",initialize:function($super,g,f){$super(f);this._limits=a.EditTextLimits.find(g);this._setupTextField();this._toast=(new d.Toast()).retain();this._toast.setOnDisappear(function(){this._alertUp=false}.bind(this));return this},_setupTextField:function(){this.onchange=function(){this.ensureTextLegalAfterChange()}.bind(this);if(this._limits.placeholder){this.setPlaceholder(a.LocText(this._limits.placeholder))}if(this._limits.inputType){this.setInputType(a.LocText(this._limits.inputType))}if(this._limits.enterKeyType){this.setEnterKeyType(a.LocText(this._limits.enterKeyType))}},ensureTextLegalAfterChange:function(){this.setState(d.State.Normal);this._ensureTextUnderMaxLength()},ensureTextLegalBeforeSubmit:function(){this.setState(d.State.Normal);if(!this._ensureTextUnderMaxLength()){return false}if(!this._ensureTextOverMinLength()){return false}if(!this._ensureTextValidates()){return false}return true},_ensureTextUnderMaxLength:function(){var f=this.getText();if(this._limits.maxLength&&f.length>this._limits.maxLength){this._showErr(a.LocText(this._limits.overMaxLengthMessage,this._limits.maxLength));this.setText(f.slice(0,this._limits.maxLength));return false}return true},_ensureTextValidates:function(){if(this._limits.validate&&this._limits.validate instanceof Function){var f=this.getText();if(!this._limits.validate(f)){if(this._limits.doesNotValidateMessage){this._showErr(a.LocText(this._limits.doesNotValidateMessage))}return false}}return true},_ensureTextOverMinLength:function(){var f=this.getText();if(this._limits.minLength&&f.length<this._limits.minLength){this._showErr(a.LocText(this._limits.underMinLengthMessage));return false}return true},_showErr:function(f){if(!this._toast){this._toast=(new d.Toast()).retain()}if(this._toast&&!this._alertUp){this._alertUp=true;this.setState(a.MobageStyle.ErrorState);this._toast.setText(f);this._toast.show()}},destroy:function(){if(this._toast){this._alertUp=false;this._toast.release()}}})}};__ngs._8g={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var f=__ngs.r_(__ngs._6k).MobageStyle;var a=f.ScaledCorners;var g=f.ScaledTextSize;var d=__ngs.r_(__ngs._2z).Assets;var b=new (__ngs.r_(__ngs._f).RequireLoader)({LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements}});f.lazyLoad(c,"NuxStyle",function(){return{children:{backgroundImage:{style:{image:d.image("credentials_sunburst.png"),imageFit:3,imageGravity:[1,0.5]}},backgroundRect:{style:{gradient:{corners:a(10),gradient:["FF011E4C 1.0"],innerLine:"FF000000 3.0"}}},transparentBase:{style:{gradient:{gradient:["9900 1.000"]}}},titleTxt:{style:{textFont:f.defaultBoldFontFace,text:b.LocText("Make Mobage games more fun"),textSize:g(18),textColor:"FFFFFF",textShadow:"FF00 3.0 {0,-2}",textGravity:[0.5,0.5]}},goal1BtnImg:{style:{image:d.image("nux_username.png"),text:b.LocText("Go"),textFont:f.defaultRegularFontFace,imageFit:3,imageGravity:[1,0.5],textGravity:[0.5,0]}},goal2BtnImg:{style:{image:d.image("nux_profile.png"),text:b.LocText("Go"),textFont:f.defaultRegularFontFace,imageFit:3,imageGravity:[1,0.5],textGravity:[0.5,0]}},goal3BtnImg:{style:{image:d.image("nux_friends.png"),text:b.LocText("Go"),textFont:f.defaultRegularFontFace,imageFit:3,imageGravity:[1,0.5],textGravity:[0.5,0]}},goal4BtnImg:{style:{image:d.image("nux_games.png"),text:b.LocText("Go"),textFont:f.defaultRegularFontFace,imageFit:3,imageGravity:[1,0.5],textGravity:[0.5,0]}},goal1Btn:{style:{image:null,disabledImage:d.image("nux_check.png"),imageFit:0,imageGravity:[0.8,0.8],pressedGradient:{corners:a(4),gradient:["9900 1.000"]},disabledGradient:{corners:a(4),gradient:["9900 1.000"]}}},goal2Btn:{style:{image:null,disabledImage:d.image("nux_check.png"),imageFit:0,imageGravity:[0.8,0.8],pressedGradient:{corners:a(4),gradient:["9900 1.000"]},disabledGradient:{corners:a(4),gradient:["9900 1.000"]}}},goal3Btn:{style:{image:null,disabledImage:d.image("nux_check.png"),imageFit:0,imageGravity:[0.8,0.8],pressedGradient:{corners:a(4),gradient:["9900 1.000"]},disabledGradient:{corners:a(4),gradient:["9900 1.000"]}}},goal4Btn:{style:{image:null,disabledImage:d.image("nux_check.png"),imageFit:0,imageGravity:[0.8,0.8],pressedGradient:{corners:a(4),gradient:["9900 1.000"]},disabledGradient:{corners:a(4),gradient:["9900 1.000"]}}},goal1BtnLabel:{style:{textFont:f.defaultRegularFontFace,textSize:g(12),textColor:"FF4687C4",textGravity:[0.5,0.5],text:b.LocText("Create\nUsername")}},goal2BtnLabel:{style:{textFont:f.defaultRegularFontFace,textSize:g(12),textColor:"FF4687C4",textGravity:[0.5,0.5],text:b.LocText("Complete\nProfile")}},goal3BtnLabel:{style:{textFont:f.defaultRegularFontFace,textSize:g(12),textColor:"FF4687C4",textGravity:[0.5,0.5],text:b.LocText("Add\nFriends")}},goal4BtnLabel:{style:{textFont:f.defaultRegularFontFace,textSize:g(12),textColor:"FF4687C4",textGravity:[0.5,0.5],text:b.LocText("Add More\nGames")}},progressBarTxt:{style:{textFont:f.defaultBoldFontFace,textSize:g(12),textColor:"FFFFFFFF",textGravity:[0.9,0.5]}},skipBtn:{style:{gradient:{corners:a(8),gradient:["FF45829C 0.000","FF235875 1.000"],innerLine:"44062742 2.0"},pressedGradient:{corners:a(8),gradient:["FF3682C3 0.000","44062742 1.000"],innerLine:"44062742 2.0"},textFont:f.defaultBoldFontFace,textColor:"0A3E62",textGravity:[0.5,0.5],textShadow:"45000000 1.0 {0.0,-2.0}",text:b.LocText("Skip")}},completeBtnHome:b.CommonElements.standardButton,completeBtnGame:b.CommonElements.standardButton,skipCheck:b.CommonElements.checkBox,footerLabel:{style:{textFont:f.defaultRegularFontFace,textSize:g(12),textColor:"FF95989D",textGravity:[0,0.5],text:b.LocText("Don't show this again.")}},footerBg:{style:{gradient:{corners:a(10),gradient:["FF011E4C 1.0"]}}}}}})}};__ngs._8h={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Bank={Item:__ngs.r_(__ngs._bi).Item,BillingItem:__ngs.r_(__ngs._bj).BillingItem,Transaction:__ngs.r_(__ngs._bk).Transaction,InAppItem:__ngs.r_(__ngs._bl).InAppItem}}};__ngs._8i={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Basic={Integer:__ngs.r_(__ngs._bm).Integer}}};__ngs._8j={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=__ngs.r_(__ngs._2f).Dispatcher;var e=__ngs.r_(__ngs._28);var g=__ngs.r_(__ngs._7d).OrderedList;var f=__ngs.r_(__ngs._o);var a=g.subclass({classname:"UserList",initialize:function($super,l,k,m,j){var h=100;$super(h);this._userClassRef=l;this.relation=m;this.game=j||null;this.userList={};this.userID=k;NgLogD("PRIVILEGED UserList "+JSON.stringify(this.relation)+" "+JSON.stringify(this.userID))},_hasData:function(h){return this.userList.hasOwnProperty(h)&&this.userList[h]},_getData:function(h){return this.userList[h]},_postBodyForPage:function(j){var h={slim:true,relation:this.relation,offset:(j*this._requestPageSize),count:this._requestPageSize};if(this.game){h.game_only=this.game.recordID}return h},_constructRequest:function(j){var h=new e.PlusRequest();var k=this._postBodyForPage(j);h.setApiMethod(this.apiMethod);h.setHttpMethod("GET");h.setPostBody(k);return h},_handleRequestData:function(k){this._knownEndOfSet=k.total;var q=f.Session.getCurrentSession()?f.Session.getCurrentSession().user():null;var j=(q&&q.recordID===this.userID);var n=k.count;var o;if(n>0){var h=k.list.length;if(n!=h){NgLogE("ERROR: BAD SERVER RESPONSE: UserList._handleRequestData: Size of data returned by server doesn't match count provided! Server needs to fix! list.length = "+k.list.length+", data.count = "+k.count)}if(h>0){b.beginBatching()}for(o=0;o<n;o++){var l=parseInt(k.offset,10)+parseInt(o,10);if(o<h){var p=k.list[o];if(!j){this._userClassRef.purgeContextSensitiveKeysFromDictionary(p)}var m=this._userClassRef.getUserWithData(p);if(q&&q.recordID===m.recordID){m=q}this.userList[l]=m}else{NgLogE("ERROR: BAD SERVER RESPONSE: UserList._handleRequestData: Adding a noOp user at index "+l+"! Server needs to fix! (See above error)");this.userList[l]=g.noOp}}if(o!=this._requestPageSize){for(o+=parseInt(k.offset,10);o<Object.keys(this.userList).length;o++){this.userList[o]=null}}if(h){b.endBatching()}}else{for(o=parseInt(k.offset,10);o<Object.keys(this.userList).length;o++){this.userList[o]=null}}}});c.UserList=a}};__ngs._8k={_c:null,_d:function(){var c={exports:{}};var a=c.exports;this._c=c;function b(e,d){return function(){delete this[e];return this[e]=d(require)}}a.RequireLoader=function(e){if(e instanceof Object){for(var d in e){this.__defineGetter__(d,b(d,e[d]))}}return this};a.RequireLoader.prototype={load:function(d){this[d]}}}};__ngs._8l={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._54);b.Appdata={getEntries:function(d,f){var e={apiURL:"Common.Appdata.getEntries",keys:d,callbackFunc:f};a.getRouterInstance().sendCommandToGameService(e)},updateEntries:function(d,f){if(d){var e={apiURL:"Common.Appdata.updateEntries",entries:d,callbackFunc:f};a.getRouterInstance().sendCommandToGameService(e)}else{if(typeof f==="function"){f({errorCode:400,description:"Entries to update are a required parameter"},null)}}},deleteEntries:function(d,f){if(d&&d.length>0){var e={apiURL:"Common.Appdata.deleteEntries",keys:d,callbackFunc:f};a.getRouterInstance().sendCommandToGameService(e)}else{if(typeof f==="function"){f({errorCode:400,description:"Keys to delete are a required parameter"},null)}}}}}};__ngs._8m={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._54);b.Auth={authorizeToken:function(d,f){var e={apiURL:"Common.Auth.authorizeToken",token:d,callbackFunc:f};a.getRouterInstance().sendCommandToGameService(e)}}}};__ngs._8n={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._54);b.Blacklist={checkBlacklist:function(f,e,d,h){var g={apiURL:"Common.Blacklist.checkBlacklist",userId:f,targetUserId:e,opt:d,callbackFunc:function(k,j){h(k,j.users,j.result)}};a.getRouterInstance().sendCommandToGameService(g)}}}};__ngs._8o={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._96).Session;a.Config={getServerEnvironment:function(){var e=c.getCurrentSession();if(!e){return"unknown"}var d=c.getCurrentSession().serverMode();if(d==c.serverModes.production){return"production"}else{if(d==c.serverModes.sandbox){return"sandbox"}else{return"unknown"}}}}}};__ngs._8p={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._54);b.People={getUser:function(e,d,g){var f={apiURL:"Common.People.getUser",userId:e,fields:d,callbackFunc:g};a.getRouterInstance().sendCommandToGameService(f)},getUsers:function(f,d,g){var e={apiURL:"Common.People.getUsers",userIds:f,fields:d,callbackFunc:function(j,h){g(j,h.users,h.results)}};a.getRouterInstance().sendCommandToGameService(e)},getCurrentUser:function(d,f){var e={apiURL:"Common.People.getCurrentUser",fields:d,callbackFunc:f};a.getRouterInstance().sendCommandToGameService(e)},getFriends:function(f,d,e,h){var g={apiURL:"Common.People.getFriends",userId:f,fields:d,opt:e,callbackFunc:function(k,j){h(k,j.users,j.results)}};a.getRouterInstance().sendCommandToGameService(g)},getFriendsWithGame:function(f,d,e,h){var g={apiURL:"Common.People.getFriendsWithGame",userId:f,fields:d,opt:e,callbackFunc:function(k,j){h(k,j.users,j.results)}};a.getRouterInstance().sendCommandToGameService(g)}}}};__ngs._8q={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._54);b.Profanity={checkProfanity:function(e,f){var d={apiURL:"Common.Profanity.checkProfanity",text:e,callbackFunc:function(h,g){f(h,g.profanity)}};a.getRouterInstance().sendCommandToGameService(d)}}}};__ngs._8r={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._t).Class;b.Request=a.subclass({execute:function(d){}})}};__ngs._8s={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._54);b.RemoteNotification={send:function(d,f,g){var e={apiURL:"Common.RemoteNotification.send",recipientId:d,payload:f,callbackFunc:g};a.getRouterInstance().sendCommandToGameService(e)},getRemoteNotificationsEnabled:function(e){var d={apiURL:"Common.RemoteNotification.getRemoteNotificationsEnabled",callbackFunc:e};a.getRouterInstance().sendCommandToGameService(d)},setRemoteNotificationsEnabled:function(d,f){var e={apiURL:"Common.RemoteNotification.setRemoteNotificationsEnabled",enabled:d,callbackFunc:f};a.getRouterInstance().sendCommandToGameService(e)}}}};__ngs._8t={_c:null,_d:function(){var a={exports:{}};var b=a.exports;this._c=a;var d=__ngs.r_(__ngs._62);var h=__ngs.r_(__ngs._54);var j=__ngs.r_(__ngs._1q).MessageEmitter;var c=__ngs.r_(__ngs._9c).ButtonOverlays;var e=__ngs.r_(__ngs._9a).Friends;var g=__ngs.r_(__ngs._99).Leaderboards;var k=__ngs.r_(__ngs._9b).Profile;var f=__ngs.r_(__ngs._8x).User;b.Service={showLeaderboards:function(){g.showLeaderboards()},openUserFinder:function(){e.showFindFriends(undefined)},openFriendPicker:function(l,m){e.showFriendPicker(l,function(q,p){var o=[];p=p||[];for(var n=0;n<p.length;n++){o.push(p[n].recordID)}m(o)})},openUserProfile:function(l,m){if(typeof l=="string"){if(l.match(/[^0-9]/)===null){l=parseInt(l,10)}else{l=null}}if(!l){m({errorCode:400,description:"userid is invalid"})}else{f.getUserWithID(l,function(o,n){if(o){if(o==="Sorry, we can't find anyone with that name."){m({errorCode:404,description:o})}else{m({errorCode:500,description:o})}}else{if(!n){m({errorCode:404,description:"User not found"})}else{k.showUserProfile(n,undefined)}}})}},showCommunityButton:function(n,l,m){c.showCommunityButton(n,m)},hideCommunityButton:function(l){c.hideCommunityButton(l)},invitedUserEmitter:new j(),showBalanceButton:function(m,n,l){c.showBalanceButton(m,n,l)},hideBalanceButton:function(l){c.hideBalanceButton(l)}}}};__ngs._8u={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._96);a.Analytics={getUserId:function(){var e=this._getSession(),d=null;if(e){d=(e.user()||{}).recordID}return d},getUsername:function(){var e=this._getSession(),d=null;if(e){d=(e.user()||{}).gamertag}return d},getPlatformVersion:function(){var d=this._getSession(),e=null;if(d){e=d.platformVersion()}return e},getServiceId:function(){return"US"},_getSession:function(){return c.Session.getCurrentSession()}}}};__ngs._8v={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._54);b.Leaderboard={getLeaderboard:function(e,d,g){var f={apiURL:"Common.Leaderboard.getLeaderboard",leaderboardIds:e,fields:d,callbackFunc:g};a.getRouterInstance().sendCommandToGameService(f)},getLeaderboards:function(f,d,g){var e={apiURL:"Common.Leaderboard.getLeaderboards",leaderboardIds:f,fields:d,callbackFunc:g};a.getRouterInstance().sendCommandToGameService(e)},getAllLeaderboards:function(d,f){var e={apiURL:"Common.Leaderboard.getAllLeaderboards",fields:d,callbackFunc:f};a.getRouterInstance().sendCommandToGameService(e)},getTopScoresList:function(e,d,f,h){var g={apiURL:"Common.Leaderboard.getTopScoresList",leaderboardIds:e,fields:d,opts:f,callbackFunc:h};a.getRouterInstance().sendCommandToGameService(g)},getFriendsScoresList:function(e,f,d,g,j){var h={apiURL:"Common.Leaderboard.getFriendsScoresList",leaderboardIds:e,userId:f,fields:d,opts:g,callbackFunc:j};a.getRouterInstance().sendCommandToGameService(h)},getScore:function(e,f,d,h){var g={apiURL:"Common.Leaderboard.getScore",leaderboardIds:e,userId:f,fields:d,callbackFunc:h};a.getRouterInstance().sendCommandToGameService(g)},updateCurrentUserScore:function(d,f,g){var e={apiURL:"Common.Leaderboard.updateCurrentUserScore",leaderboardId:d,value:f,callbackFunc:g};a.getRouterInstance().sendCommandToGameService(e)},deleteCurrentUserScore:function(d,f){var e={apiURL:"Common.Leaderboard.deleteCurrentUserScore",leaderboardIds:d,callbackFunc:f};a.getRouterInstance().sendCommandToGameService(e)}}}};__ngs._8w={_c:null,_d:function(){var f={exports:{}};var d=f.exports;this._c=f;var c=__ngs.r_(__ngs._1q).MessageEmitter;var g=__ngs.r_(__ngs._5x);var a=__ngs.r_(__ngs._96);var b=__ngs.r_(__ngs._97);var e=d.DataModel=c.subclass({initialize:function(h){this.recordID=h;this._cache()},beginChanges:function(){b.Dispatcher.beginBatching()},endChanges:function(){b.Dispatcher.endBatching()},_classname:function(){var h=this.classname;return h},_cache:function(){if(!this._dataCache){var j=a.Session.getCurrentSession();if(j){var h=j.dataCache();if(h){h.addObject(this);this._dataCache=h}}}return this._dataCache},$_serializedDataModel:function(h){if(h instanceof (e)){h={classname:h.classname,recordID:h.recordID}}return h},$_deserializedDataModel:function(m,k){if(m&&m.hasOwnProperty&&m.hasOwnProperty("classname")&&m.hasOwnProperty("recordID")){var j=m.classname;var n=g.Social.US[j];var h=m.recordID;if(n&&h){var l=k.getObjectWithRecordID(j,h);if(!l){l=new n(h)}l._deserializeFromHash(m.data);k.addObject(l);m=l}}return m},_serializedHash:function(m){var p=this.constructor;var o={classname:p.classname,recordID:this.recordID};if(m===false){return o}o.data={};var l=this.constructor.properties||[];for(var h=0;h<l.length;h++){var k=l[h];var j=this[k];if(j instanceof (Array)){for(var n=0;n<j.length;n++){j[n]=e._serializedDataModel(j[n])}}else{j=e._serializedDataModel(j)}o.data[k]=j}return o},_deserializeFromHash:function(l){if(!l){NgLogD("No public hash data for "+this.classname+" "+this.recordID);return}var h=this._cache();for(var j in l){var k=l[j];if(k instanceof (Array)){for(var m=0;m<k.length;m++){k[m]=e._deserializedDataModel(k[m],h)}}else{k=e._deserializedDataModel(k,h)}this[j]=k}}});e._oldSubclass=e.subclass;e.subclass=function(l){var m=e._oldSubclass(l);var k=l.properties||[];for(var h=0;h<k.length;h++){var j=k[h];(function(n){m.prototype.__defineSetter__(n,function(o){this["___"+n]=o;var p={};p[""+n]=o;this.emit(p)});m.prototype.__defineGetter__(n,function(o){return this["___"+n]})})(j)}return m}}};__ngs._8x={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var e=__ngs.r_(__ngs._8w);var a=__ngs.r_(__ngs._97).Dispatcher;var f=__ngs.r_(__ngs._bn).OrderedList;var d=__ngs.r_(__ngs._5x).Social;var g=b.User=e.DataModel.subclass({classname:"User",properties:["gamertag","avatarId","motto","relation","sparse","photoId","emailHash","ageRestricted","isMutualFriend","grade","phoneNumber","password","firstName","lastName","hideFullName","emailAddress","isNewRelationship","showsPresence","onlyShowFriendNotifications","allowFriendPostsOnly","capabilities","gamerscore","gamerLevel","gamerLevelName","gamerLevelScore","gamerNextLevelScore","games"],initialize:function($super,h){$super(h);NgLogD("User Public! "+h+" "+this.recordID)},addBuddy:function(j,h){a.callMethodOnRemoteObject(this,"addBuddy",[j,h])},removeBuddy:function(j,h){a.callMethodOnRemoteObject(this,"deleteBuddy",[j,h])},ignoreBuddy:function(j,h){a.callMethodOnRemoteObject(this,"ignoreBuddy",[j,h])},getUserDetails:function(h){a.callMethodOnRemoteObject(this,"getUserDetails",[h])},getMobageFriendRequestsList:function(){return f.getObjectPublicInterface(this,"getInvitesList","_followersListInterface")},getMobageFriendsList:function(){return f.getObjectPublicInterface(this,"getFriendsList","_friendsListInterface")},getMobageBlockedUserList:function(){return f.getObjectPublicInterface(this,"getBlockedUserList","_enemyListInterface")},getOwnedGamesList:function(){return f.getObjectPublicInterface(this,"getOwnedGamesList","_ownedGamesListInterface")},getAchievementsList:function(){return f.getObjectPublicInterface(this,"getAchievementsList","_achievementsListInterface")},getFeaturedUsersList:function(){return f.getObjectPublicInterface(this,"getFeaturedUsersList","_featuredUsersListInterface")},inviteToCurrentGame:function(h){var j=this;a.callMethodOnRemoteObject(this,"inviteToCurrentGame",[function(k){if(!k){d.Common.Service.invitedUserEmitter.emit({userId:j.recordID});d.US.Service.Friends.invitedUserEmitter.emit({user:j})}h.apply(this,Array.apply(null,arguments))}])},sendNotificationToUser:function(l,h,k,j){a.callMethodOnRemoteObject(this,"sendNotificationToUser",[l,h,k,j])},addFriend:function(j,k,h){if(typeof arguments[1]=="function"&&!arguments[2]){h=arguments[1];k=undefined}a.callMethodOnRemoteObject(this,"addGameFriend",[j,k,h])},removeFriend:function(j,h){a.callMethodOnRemoteObject(this,"removeGameFriend",[j,h])},report:function(j,h){a.callMethodOnRemoteObject(this,"report",[j,h])},getFriendsList:function(h){return f.getObjectPublicInterface(this,"getGameFriendsList",(h?("_gameFriendsList-friends-"+h):"_gameFriendsList-friends"),"friends",h)},getMutualFriendsList:function(h){return f.getObjectPublicInterface(this,"getGameFriendsList",(h?("_gameFriendsList-mutual-"+h):"_gameFriendsList-mutual"),"mutual",h)},getFriendRequestsList:function(h){return f.getObjectPublicInterface(this,"getGameFriendsList",(h?("_gameFriendsList-invitation-"+h):"_gameFriendsList-invitation"),"invitation",h)},setEmailAddress:function(j,h){a.callMethodOnRemoteObject(this,"setEmailAddress",[j,h])},setOnlyShowFriendNotifications:function(j,h){a.callMethodOnRemoteObject(this,"setOnlyShowFriendNotifications",[j,h])},setOptsIn:function(j,h){a.callMethodOnRemoteObject(this,"setOptsIn",[j,h])},setAllowFriendPostsOnly:function(j,h){a.callMethodOnRemoteObject(this,"setAllowFriendPostsOnly",[j,h])},setMotto:function(j,h){a.callMethodOnRemoteObject(this,"setMotto",[j,h])},setFirstName:function(j,h){a.callMethodOnRemoteObject(this,"setFirstName",[j,h])},setLastName:function(j,h){a.callMethodOnRemoteObject(this,"setLastName",[j,h])},setPassword:function(j,k,h){a.callMethodOnRemoteObject(this,"setPassword",[j,k,h])},setBlocked:function(j,h){a.callMethodOnRemoteObject(this,"setBlocked",[j,h])},getOriginOfRegistration:function(h){a.callMethodOnRemoteObject(this,"getOriginOfRegistration",[h])}});g.GamertagKey="gamertag";g.AvatarKey="badge_id";g.MottoKey="motto";g.RelationKey="relation";g.FirstNameKey="first_name";g.LastNameKey="last_name";g.BirthdateKey="birth_date";g.GenderKey="gender";g.PrivacyKey="fullname_privacy";g.PhotoKey="photo_url";g.EmailAddressKey="email";g.EmailHashKey="email_hash";g.PhoneNumberKey="phone_number";g.AgeRangeKey="age_restricted";g.SpamKey="opt_in";g.PasswordKey="password";g.PasswordConfirmKey="password_confirmation";g.GamesKey="games";g.CapabilitiesKey="capabilities";g.NewBuddyKey="new_buddy";g.IsMutualFriendKey="mutual_friends";g.HidePresenceKey="hide_presence";g.OnlyShowFriendNotificationsKey="friend_only_notification";g.AllowFriendPostsOnly="friend_only_wallpost";g.GamerScoreKey="gamerscore";g.LevelNumberKey="level_position";g.LevelNameKey="level_name";g.CurrentLevelScoreKey="level_points";g.NextLevelScoreKey="level_next_points";g.GradeKey="grade";g.CommonGradeKey="userGrade";g.NonSparseKeys=[g.PhotoKey,g.EmailAddressKey,g.EmailHashKey,g.PhoneNumberKey,g.PasswordKey,g.FirstNameKey,g.LastNameKey,g.PrivacyKey,g.NewBuddyKey,g.CapabilitiesKey,g.HidePresenceKey,g.OnlyShowFriendNotificationsKey,g.AllowFriendPostsOnly,g.GamerScoreKey,g.LevelNumberKey,g.LevelNameKey,g.CurrentLevelScoreKey,g.NextLevelScoreKey,g.GamesKey];g.getUserWithID=function(j,h){a.callClassMethodOnRemoteObject(g,"getUserWithID",[j,h])};g.getUserWithGamertag=function(j,h){a.callClassMethodOnRemoteObject(g,"getUserWithGamertag",[j,h])};g.showAccountUpgrade=function(h){a.callClassMethodOnRemoteObject(g,"showAccountUpgrade",[h])}}};__ngs._8y={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var g=__ngs.r_(__ngs._5).Core;var c=__ngs.r_(__ngs._4).Device;var e=__ngs.r_(__ngs._8w);var f=__ngs.r_(__ngs._bn).OrderedList;var a=__ngs.r_(__ngs._97).Dispatcher;var h=b.Game=e.DataModel.subclass({classname:"Game",properties:["name","publisher","category","numberOfLeaderboards","iconURL","numberOfAchievements","featured","masterProductID","appStoreURL","feedURL","catalogURL","description","phone_screenshot_urls","ngcore_url","androidMarketIntentURL"],goToAppStore:function(){if(g.Capabilities.getPlatformOS().toLowerCase()==="iphone os"){c.IPCEmitter.launch(this.appStoreURL)}else{c.IPCEmitter.launchIntent(this.androidMarketIntentURL)}}});h.getAllGamesList=function(){return f.getClassPublicInterface(h,"getAllGamesList","_allGamesInterface")};h.getCurrentGame=function(j){a.callClassMethodOnRemoteObject(h,"getCurrentGame",[j])}}};__ngs._8z={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var e=__ngs.r_(__ngs._8w);var b=__ngs.r_(__ngs._97).Dispatcher;var a=c.FullGamercard=e.DataModel.subclass({classname:"FullGamercard",properties:["visible"],show:function(){b.callMethodOnRemoteObject(this,"show")},hide:function(){b.callMethodOnRemoteObject(this,"hide")},set:function(f,g,h){b.callMethodOnRemoteObject(this,"set",[f,g,h])}});a.getFullGamercard=function(f){b.callClassMethodOnRemoteObject(a,"getFullGamercard",[f])};a.getFullGamercardAndSetUser=function(g,f){b.callClassMethodOnRemoteObject(a,"getFullGamercardAndSetUser",[g,f])};a.getFullGamercardAndSetCurrentUser=function(f){b.callClassMethodOnRemoteObject(a,"getFullGamercardAndSetCurrentUser",[f])}}};__ngs._90={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var e=__ngs.r_(__ngs._8w);var a=__ngs.r_(__ngs._97).Dispatcher;var f=__ngs.r_(__ngs._bn).OrderedList;var b=c.Leaderboard=e.DataModel.subclass({classname:"Leaderboard",properties:["level","title","game","iconURL"],initialize:function($super,g){$super(g);NgLogD("Leaderboard Public! "+g+" "+this.recordID)},submitScore:function(h,g){a.callMethodOnRemoteObject(this,"submitScoreWithPoints",[h,g])},getTopScoresList:function(){return f.getObjectPublicInterface(this,"getTopScoresList","_leaderboardTopScoresInterface")},getFriendsScoresList:function(){return f.getObjectPublicInterface(this,"getFriendsScoresList","_leaderboardFriendsScoresInterface")}});b.getLeaderboards=function(g){a.callClassMethodOnRemoteObject(b,"getLeaderboards",[g])}}};__ngs._91={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var a=__ngs.r_(__ngs._54);var f=__ngs.r_(__ngs._8w);var b=__ngs.r_(__ngs._97).Dispatcher;var d=c.Achievement=f.DataModel.subclass({classname:"Achievement",properties:["description","points","category","unlocked","name","index","icon_url"],initialize:function($super,g){$super(g)},unlockAchievement:function(g){b.callMethodOnRemoteObject(this,"unlockAchievement",[g])}})}};__ngs._92={_c:null,_d:function(){var d={exports:{}};var a=d.exports;this._c=d;var c=__ngs.r_(__ngs._8w).DataModel;var b=a.Score=c.subclass({classname:"Score",properties:["points","displayScore","rank","level","user"]})}};__ngs._93={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var c=__ngs.r_(__ngs._8w);var a=__ngs.r_(__ngs._97).Dispatcher;var b=d.AppData=c.DataModel.subclass({classname:"AppData",properties:["data","key","user","permissions"],initialize:function($super,f){$super(f)}});b.getKeysForUser=function(g,f){a.callClassMethodOnRemoteObject(b,"getKeysForUser",[g,f])};b.getDataForUserWithKey=function(g,h,f){a.callClassMethodOnRemoteObject(b,"getDataForUserWithKey",[g,h,f])};b.setDataForUserWithKeyAndPermissions=function(k,g,h,j,f){a.callClassMethodOnRemoteObject(b,"setDataForUserWithKeyAndPermissions",[k,g,h,j,f])};b.Permissions={Private:0,FriendsReadOnly:1,PublicReadOnly:2}}};__ngs._94={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._t).Class;var d=__ngs.r_(__ngs._5x);var e=b.Cache=a.subclass({classname:"Cache",inMemoryObjects:{},caches:{},initialize:function(){},getObjectWithRecordID:function(h,f){var g=this.inMemoryObjects[h];if(g){return g[f]||null}else{return null}},addObject:function(j){var h=j._classname();var g=this.inMemoryObjects[h];if(!g){g={};this.inMemoryObjects[h]=g}var f=g[j.recordID];if(f){return f}else{g[j.recordID]=j;return j}},removeObject:function(h){var g=h._classname();var f=this.inMemoryObjects[g];if(f){delete f[h.recordID]}},isObjectCached:function(h){var g=h._classname();var f=this.inMemoryObjects[g];return(f&&(f[h.recordID]==h))},saveCache:function(){},loadCache:function(){},loadCacheFromJSONArray:function(k,f){var o=[];for(var n=0;n<k.length;n++){var g=k[n];if(g&&g.hasOwnProperty("classname")&&g.hasOwnProperty("recordID")){var h=g.classname;var m=d.Social.US[h];var l=g.recordID;if(m&&l){var j=this.getObjectWithRecordID(h,l);if(!j){j=new m(l,{})}j._deserializeFromHash(g);this.addObject(j)}}}f(null,this)}})}};__ngs._95={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._54);b.AB={getCurrentVariants:function(e){var d={apiURL:"US.AB.getCurrentVariants",callbackFunc:e};a.getRouterInstance().sendCommandToGameService(d)}}}};__ngs._96={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var c=__ngs.r_(__ngs._5);var g=__ngs.r_(__ngs._1q);var b=__ngs.r_(__ngs._94);var a=__ngs.r_(__ngs._97).Dispatcher;var f=d.Session=g.MessageEmitter.subclass({classname:"Session",initialize:function(h){if(h){this._loadSessionData(h)}},_loadSessionData:function(h){this._appKey=h.appId||this._appKey||null;this._appVersion=h.appVersion||this._appVersion||null;this._platformVersion=h.platformVersion||this._platformVersion||"1.0";this._serverMode=h.serverMode||this._serverMode||null;this._user=(h.userID?this.dataCache().getObjectWithRecordID("User",h.userID):null);this.emit({user:this._user})},dataCache:function(){if(!this._cache){this._cache=new b.Cache();this._cache.loadCache(function(h){NgLogD("Loaded cache: "+h)})}return this._cache},user:function(){return this._user},appKey:function(){return this._appKey},appVersion:function(){return this._appVersion},serverMode:function(){return this._serverMode},platformVersion:function(){return this._platformVersion},getSessionTokensForConsumerKey:function(j,h){a.callClassMethodOnRemoteObject("Session",["getCurrentSession","getSessionTokensForConsumerKey"],[[],[j,h]])}});f.serverModes={staging:"staging",integration:"integration",partner:"sandbox",sandbox:"sandbox",production:"production",unknown:"unknown"};f.getCurrentSession=function(){return f._currentSession};f._emitter=null;f.addCurrentSessionListener=function(j,k,h){if(!f._emitter){f._emitter=new g.MessageEmitter()}f._emitter.addListener(j,k,h)};f.removeCurrentSessionListener=function(h){if(f._emitter){f._emitter.removeListener(h)}}}};__ngs._97={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var b=__ngs.r_(__ngs._54);var h=__ngs.r_(__ngs._5).Core;var g=__ngs.r_(__ngs._94);var f=__ngs.r_(__ngs._5x);var a=__ngs.r_(__ngs._96);var c=d.Dispatcher={classname:"Dispatcher",callbackUIDCounter:0,callbacks:{"-2":{},"-1":{}},cache:function(){try{return a.Session.getCurrentSession().dataCache()}catch(j){NgLogD("Mobage/Dispatcher/cache-Warning: cannot get cache. NOTE: This may be expected behavior if early on in initialization. Err="+j);return null}},receiveSession:function(l){var k=a.Session.getCurrentSession();if(!k){k=new a.Session();a.Session._currentSession=k}var j=l.data.userData;if(j){c.receiveObject({data:j})}k._loadSessionData(l.data);if(a.Session._emitter){a.Session._emitter.emit({session:k})}},callMethodOnLocalObject:function(m){var o=m.recordID;var l=m.classname;var n=c.cache().getObjectWithRecordID(l,o);if(n){var s=m.methodName;var q=false;var p;var j;if(s instanceof Array){var k=n;for(var r=0;r<s.length;r++){if(typeof k[s[r]]=="function"){p=c.convertArgumentsArrayFromJSON(m.arguments[r]||[]);j=k[s[r]].apply(k,p);k=j}else{q=true;break}}}else{if(typeof n[s]=="function"){p=c.convertArgumentsArrayFromJSON(m.arguments||[]);j=n[s].apply(n,p)}else{q=true}}if(q){NgLogD("ERROR: Invalid methods for calling on local object: "+m.recordID+" "+s)}else{if(m.callback){var t=c.convertFunctionFromJSON({callbackUID:m.callback});if(t){t(j)}}}}},callMethodOnRemoteObject:function(l,n,k,j){if(!l||!n){NgLogD("Public.Dispatcher.callMethodOnRemoteObject - bailing");if(j){j()}return}k=c.convertArgumentsArrayToJSON(k||[]);var m={apiURL:"US.Dispatcher.callMethodOnLocalObject",recordID:l.recordID,classname:l._classname(),methodName:n,arguments:k,callback:c.convertFunctionToJSON(j)};b.getRouterInstance().sendCommandToGameService(m)},callClassMethodOnLocalObject:function(m){c.beginBatching();var l=m.classname;var r=m.methodName;if(l&&r){var n=f.Social.US[l];if(!n){n=f.Social.US.Service[l]}if(n){var p=false;var o;var j;if(r instanceof Array){var k=n;for(var q=0;q<r.length;q++){if(typeof k[r[q]]=="function"){o=c.convertArgumentsArrayFromJSON(m.arguments[q]||[]);j=k[r[q]].apply(k,o);k=j}else{p=true;break}}}else{if(typeof n[r]=="function"){o=c.convertArgumentsArrayFromJSON(m.arguments||[]);j=n[r].apply(n,o)}else{p=true}}if(p){NgLogD("ERROR: Invalid methods for calling on local Class: "+l+" "+r)}else{if(m.callback){var s=c.convertFunctionFromJSON({callbackUID:m.callback});if(s){s(j)}}}}}c.endBatching()},callClassMethodOnRemoteObject:function(n,k,l,j){if(!n||!k){NgLogD("Public.Dispatcher.callClassMethodOnRemoteObject - bailing");if(j){j()}return}l=c.convertArgumentsArrayToJSON(l||[]);var m={apiURL:"US.Dispatcher.callClassMethodOnLocalObject",classname:(n.classname?n.classname:n),methodName:k,arguments:l,callback:(j?c.convertFunctionToJSON(j):null)};b.getRouterInstance().sendCommandToGameService(m)},sendCallbackToRemote:function(j,k){k=c.convertArgumentsArrayToJSON(k||[]);var l={apiURL:"US.Dispatcher.receiveCallbackFromRemote",callbackUID:j,arguments:k,zone:b.getRouterInstance().zone};b.getRouterInstance().sendCommandToGameService(l)},receiveCallbackFromRemote:function(k){var l=c.callbacks[b.getRouterInstance().zone][k.callbackUID];if(!l){return}var j=c.convertArgumentsArrayFromJSON(k.arguments||[]);l.apply(l,j)},convertArgumentsArrayFromJSON:function(m){var l=[];for(var k=0;k<m.length;k++){var j=m[k];if(j&&((j.recordID&&j.classname)||j instanceof Array)){l[k]=c.convertModelObjectFromJSON(j)}else{if(j&&j.callbackUID){l[k]=c.convertFunctionFromJSON(j)}else{l[k]=j}}}return l},convertArgumentsArrayToJSON:function(m){var l=[];for(var k=0;k<m.length;k++){var j=m[k];if(j&&(j.recordID&&j._classname&&typeof j._classname=="function"&&j._classname())){c.sendObjectImmediately(j);j=c.convertModelObjectToJSON(j);l[k]=j}else{if(j&&j instanceof Array){j=c.convertArgumentsArrayToJSON(j);l[k]=j}else{if(j&&typeof j=="function"){l[k]=c.convertFunctionToJSON(j)}else{l[k]=j}}}}return l},convertModelObjectToJSON:function(j){if(j&&j.recordID&&j._classname()){j={classname:j._classname(),recordID:j.recordID}}return j},convertModelObjectFromJSON:function(m){var l=m;if(m.recordID&&m.classname){var n=c.cache().getObjectWithRecordID(m.classname,m.recordID);if(n){l=n;if(m.data){l._deserializeFromHash(m.data)}}}else{if(m instanceof Array){for(var k=0;k<m.length;k++){var j=m[k];m[k]=c.convertModelObjectFromJSON(j)}}}return l},convertFunctionToJSON:function(l){if(l&&typeof l=="function"){var k=++c.callbackUIDCounter;var j=b.getRouterInstance().zone;c.callbacks[j][k]=l;l={callbackUID:k,zone:j}}return l},convertFunctionFromJSON:function(l){var m=l;var k=m.callbackUID;var j=m.zone;if(k){var n=c.callbacks[j][k];if(n){m=n;delete c.callbacks[j][k]}else{m=c.generateCallbackForUID(k)}}return m},generateCallbackForUID:function(j){if(j.callbackUID){j=j.callbackUID}return function(){c.sendCallbackToRemote(j,arguments)}},_batchCount:0,_queuedObjects:[],beginBatching:function(){++c._batchCount},endBatching:function(){if((--c._batchCount)===0){for(var j in c._queuedObjects){var k=c._queuedObjects[j];c._queuedObjects[j]=undefined;c.sendObjectImmediately(k)}}},sendObject:function(k){if(c._queuedObjects.indexOf(k)==-1){c.beginBatching();var j=""+k.classname+"---"+k.recordID;c._queuedObjects[j]=k;c.endBatching()}},sendObjectImmediately:function(k){if(!k){return}var j={apiURL:"US.Dispatcher.receiveObject",data:k._serializedHash()};b.getRouterInstance().sendCommandToGameService(j)},receiveObject:function(o){var m=o.data;var k=m.recordID;var l=m.classname;var j=m.data;if(k&&l&&c.cache()){var n=c.cache().getObjectWithRecordID(l,k);if(!n){var p=f.Social.US[l];n=new p(k);c.cache().addObject(n)}if(j){n._deserializeFromHash(j)}}}}}};__ngs._98={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._54);b.Reward={getActiveCampaigns:function(e){var d={apiURL:"US.Reward.getActiveCampaigns",callbackFunc:e};a.getRouterInstance().sendCommandToGameService(d)},redeem:function(f,e){var d={apiURL:"US.Reward.redeem",id:f,callbackFunc:e};a.getRouterInstance().sendCommandToGameService(d)}}}};__ngs._99={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._54);b.Leaderboards={showLeaderboards:function(){var d={apiURL:"US.Service.Leaderboards.showLeaderboards"};a.getRouterInstance().sendCommandToGameService(d)}}}};__ngs._9a={_c:null,_d:function(){var g={exports:{}};var e=g.exports;this._c=g;var f=__ngs.r_(__ngs._62);var a=__ngs.r_(__ngs._54);var c=__ngs.r_(__ngs._1q).MessageEmitter;var h=__ngs.r_(__ngs._8w);var b=__ngs.r_(__ngs._97).Dispatcher;var d=e.Friends=h.DataModel.subclass({classname:"Friends"});d.showFindFriends=function(j){NgLogD("Public call showFindFriends");var k={apiURL:"US.Service.Friends.showFindFriends"};if(j){k.data={};k.data.tab=j}a.getRouterInstance().sendCommandToGameService(k)};d.showFriendPicker=function(j,k){b.callClassMethodOnRemoteObject(d,"showFriendPicker",[j,k])};d.invitedUserEmitter=new c()}};__ngs._9b={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var c=__ngs.r_(__ngs._62);var a=__ngs.r_(__ngs._54);b.Profile={showUserProfile:function(f,e){var g={apiURL:"US.Service.Profile.showUserProfile",data:{user:f}};if(e){g.tab=e}a.getRouterInstance().sendCommandToGameService(g)}}}};__ngs._9c={_c:null,_d:function(){var b={exports:{}};var c=b.exports;this._c=b;var a=__ngs.r_(__ngs._25).Rect;var d=__ngs.r_(__ngs._62);var g=__ngs.r_(__ngs._54);var h=__ngs.r_(__ngs._1q).MessageEmitter;var e=__ngs.r_(__ngs._9a).Friends;var j=__ngs.r_(__ngs._9b).Profile;var f=__ngs.r_(__ngs._8x).User;c.ButtonOverlays={showCommunityButton:function(m,l){NgLogD("Public - showCommunityButton");var k={apiURL:"US.Service.ButtonOverlays.showCommunityButton"};k.gravity=m=m||[0,0];if((m[0]!==0&&m[0]!==1)||(m[1]!==0&&m[1]!==1)){throw new Error("showCommunityButton: Illegal/Out-of-Bounds parameter: gravity "+JSON.stringify(m))}if(l!=undefined&&typeof l=="function"){k.callbackFunc=l}else{k.callbackFunc=null}g.getRouterInstance().sendCommandToGameService(k)},hideCommunityButton:function(l){NgLogD("Public - hideCommunityButton");var k={apiURL:"US.Service.ButtonOverlays.hideCommunityButton"};if(l!=undefined&&typeof l=="function"){k.callbackFunc=l}else{k.callbackFunc=null}g.getRouterInstance().sendCommandToGameService(k)},showBalanceButton:function(l,n,k){NgLogD("Public - showBalanceButton");var m={apiURL:"US.Service.ButtonOverlays.showBalanceButton"};if(l!=undefined){m.rect=(new a(l)).array()}else{m.rect=undefined}if(n!=undefined&&typeof n=="function"){m.callbackFunc=n}else{m.callbackFunc=null}if(k!=undefined){m.sourcePage=k.toString()}else{m.sourcePage="somewhere_game"}g.getRouterInstance().sendCommandToGameService(m)},hideBalanceButton:function(l){NgLogD("Public - hideBalanceButton");var k={apiURL:"US.Service.ButtonOverlays.hideBalanceButton"};if(l!=undefined&&typeof l=="function"){k.callbackFunc=l}else{k.callbackFunc=null}g.getRouterInstance().sendCommandToGameService(k)}}}};__ngs._9d={_c:null,_d:function(){var f={exports:{}};var d=f.exports;this._c=f;var e=__ngs.r_(__ngs._62);var b=__ngs.r_(__ngs._54);var c=__ngs.r_(__ngs._1q).MessageEmitter;var a=d.GameLaunchPayload={getLastPayload:function(h){if(h!=undefined&&typeof h=="function"){var g={apiURL:"US.Service.GameLaunchPayload.getLastPayload"};g.callbackFunc=h;b.getRouterInstance().sendCommandToGameService(g)}},getNewPayloadEmitter:function(){if(!a.newGamePayloadEmitter){NgLogD("Creating new payload emitter...");a.newGamePayloadEmitter=new c()}return a.newGamePayloadEmitter},onGameLaunchPayload:function(g){a.getNewPayloadEmitter().emit(g.data.payload)}}}};__ngs._9e={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var c=__ngs.r_(__ngs._62);var a=__ngs.r_(__ngs._54);b.Achievements={showAchievementsScreen:function(){NgLogD("Public - showAchievementsScreen");var e={apiURL:"US.Service.Achievements.showAchievementsScreen"};a.getRouterInstance().sendCommandToGameService(e)}}}};__ngs._9f={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var c=__ngs.r_(__ngs._62);var a=__ngs.r_(__ngs._54);b.Bank={};b.Bank.Debit={createTransaction:function(e,j,h){NgLogD("Public call createTransaction");var g={billingItems:e,comment:j};var f={apiURL:"US.Service.Banking.Purchase.createTransaction",data:g};if(h!=undefined&&typeof h=="function"){f.callbackFunc=this._getCallBackFunc(h)}a.getRouterInstance().sendCommandToGameService(f)},openTransaction:function(g,f){NgLogD("Public call openTransaction");var e={apiURL:"US.Service.Banking.Purchase.openTransaction",data:{}};if(g){e.data.transactionId=g}if(f!=undefined&&typeof f=="function"){e.callbackFunc=this._getCallBackFunc(f)}a.getRouterInstance().sendCommandToGameService(e)},continueTransaction:function(g,f){NgLogD("Public call continueTransaction");var e={apiURL:"US.Service.Banking.Purchase.continueTransaction",data:{}};if(g){e.data.transactionId=g}if(f!=undefined&&typeof f=="function"){e.callbackFunc=f}a.getRouterInstance().sendCommandToGameService(e)},cancelTransaction:function(g,f){NgLogD("Public call cancelTransaction");var e={apiURL:"US.Service.Banking.Purchase.cancelTransaction",data:{}};if(g){e.data.transactionId=g}if(f!=undefined&&typeof f=="function"){e.callbackFunc=f}a.getRouterInstance().sendCommandToGameService(e)},closeTransaction:function(g,f){NgLogD("Public call closeTransaction");var e={apiURL:"US.Service.Banking.Purchase.closeTransaction",data:{}};if(g){e.data.transactionId=g}if(f!=undefined&&typeof f=="function"){e.callbackFunc=this._getCallBackFunc(f)}a.getRouterInstance().sendCommandToGameService(e)},getTransaction:function(g,f){NgLogD("Public call getTransaction");var e={apiURL:"US.Service.Banking.Purchase.getTransaction",data:{}};if(g){e.data.transactionId=g}if(f!=undefined&&typeof f=="function"){e.callbackFunc=this._getCallBackFunc(f)}a.getRouterInstance().sendCommandToGameService(e)},getPendingTransactions:function(f){NgLogD("Public call getPendingTransactions");var e={apiURL:"US.Service.Banking.Purchase.getPendingTransactions",data:{}};if(f!=undefined&&typeof f=="function"){e.callbackFunc=function(g,h){f(g.error,h.openTransactions)}}a.getRouterInstance().sendCommandToGameService(e)},_getCallBackFunc:function(e){return function(f,g){if(f){e(f,undefined)}else{e(f,g.transaction)}}}};b.Bank.Inventory={getItem:function(g,h){NgLogD("Public call Inventory getItem");var f={itemId:g};var e={apiURL:"US.Service.Banking.Purchase.getItem",data:f};if(h!=undefined&&typeof h=="function"){e.callbackFunc=function(j,k){if(j){h(j,undefined)}else{h(j,k.item)}}}a.getRouterInstance().sendCommandToGameService(e)},getIAPItems:function(e,h){NgLogD("Public call Inventory getIAPItems");var g={itemId:e};var f={apiURL:"US.Service.Banking.Purchase.getIAPItems",data:g};if(h!=undefined&&typeof h=="function"){f.callbackFunc=function(j,k){if(j){h(j,undefined)}else{h(j,k.item)}}}a.getRouterInstance().sendCommandToGameService(f)}}}};__ngs._9g={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=__ngs.r_(__ngs._60).Style;var e=__ngs.r_(__ngs._6k).MobageStyle;var a=e.ScaledCorners;var f=e.ScaledTextSize;e.lazyLoad(c,"TabButton",function(){return{style:{gradient:{innerLine:"19FFFFFF 1.0",innerShadow:"6600 0.0 {0.0,2.0}",gradient:["FF0B4B93 0.0","FF0A3F7C 1.0"],corners:a(6,0,0,6)},selectedGradient:{innerShadow:"6600 0.0 {0.0,2.0}",gradient:["FF1B61A3 0.0","FF2976BB 1.0"],corners:a(6,0,0,6)},pressedGradient:{innerLine:"33000000 1.0",innerShadow:"6600 0.0 {0.0,2.0}",gradient:["FF85C4EA 0.0","FF4799D3 1.0"],corners:a(6,0,0,6)},textColor:"FFFFFFFF",textShadow:"6600 0.0 {0.0,-2.0}",selectedTextShadow:"6600 0.0 {0.0,1.0}",textSize:f(13),textFont:e.defaultBoldFontFace},children:{rightAccessory:{style:{textColor:"FFD2EDFF",textGravity:[1,0.5],textSize:f(13),textFont:e.defaultRegularFontFace}}},extras:{leftImageWidthRatio:0.2,rightImageWidthRatio:0.2,leftImageInsetRatio:0.2,rightImageInsetRatio:0.2,leftTextSpacingRatio:0.07,rightTextSpacingRatio:0.07,numberRightTextSpacingRatio:0.07,heightRatio:0.18}}});e.lazyLoad(c,"JumpButton",function(){return{children:{content:{style:{gradient:{innerLine:"5900 1.0",innerShadow:"9900 0.0 {0.0,1.0}",gradient:["FF4F9E1D 0.000","FF296B0D 1.000"],corners:a(8)},pressedGradient:{innerLine:"5900 1.0",innerShadow:"FF00 0.0 {0.0,2.0}",gradient:["FF296B0D 0.000","FF397B12 1.000"],corners:a(8)}},children:{content:{style:{textColor:"FFFFFFFF",textGravity:[0.5,0.5],textFont:e.defaultBoldFontFace,textSize:f(13)}},accessory:{style:{textColor:"FFFFFFFF",textGravity:[0.5,0.5],textSize:f(12),textFont:e.defaultBoldFontFace}}}}},extras:{rightImageWidthRatio:0.13,rightImageInsetRatio:0.12,insetRatio:0.08,leftTextSpacingRatio:0.1}}});c.VerticalTabViewSizing={insetRatio:0.02,buttonContainerRatio:(210/800)}}};__ngs._9h={_c:null,_d:function(){var d={exports:{}};var g=d.exports;this._c=d;var o=__ngs.r_(__ngs._77).Primitives;var h=__ngs.r_(__ngs._60).Style;var e={classname:"CompositeHash",initialize:function($super,q){this._compositePrepare();if($super&&typeof $super==="function"){$super(q)}this.initSubviews();this.addSubviews();return this},destroy:function(){var q;for(q in this._compositeDestroys){if(this._compositeDestroys.hasOwnProperty(q)){this._compositeDestroys[q].call(this,q)}}},_compositePrepare:function($super){throw new Error("CompositeView/_compositePrepare must be implemented in subclass")},isComposite:function(){return true},initSubviews:function($super){if($super&&typeof $super==="function"){$super()}if(this._compositeInits){var q;for(q in this._compositeInits){if(this._compositeInits.hasOwnProperty(q)&&!this[q]){this._compositeInits[q].apply(this,[q])}}}},addSubviews:function($super){NgLogD("CompositeView/addSubviews Abstract Base Class")},layoutSubviews:function($super){if($super&&typeof $super==="function"){$super()}},sizeChanged:function(){this.layoutSubviews()}};var j=g.CompositeView=o.View.subclass(e);j.prototype.classname="CompositeView";var p=g.CompositeLayoutGroup=o.LayoutGroup.subclass(e);p.prototype.classname="CompositeLayoutGroup";var k=function(q){if(!q||(typeof q!=="string")||q.length<=0){q="unknownProperty"}return q.charAt(0).toUpperCase()+q.slice(1)};var b=function(q){if(!q||(typeof q!=="string")||q.length<=0){q="unknownProperty"}return q.charAt(0).toLowerCase()+q.slice(1)};var c=g.CompositeAttributesExtract=function(r,u,t){var s;var q=r[u];for(s in q){if(q.hasOwnProperty(s)){t[s]=q[s]}}delete r[u]};var l=function(q){var r=q.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return r.length==1&&!r[0]?[]:r};var n=function(q){return(typeof q=="function"&&q.toString().match(/function[^\(]*\(\s*\$super/))?true:false};var f=function(r,q){if(n(r)){return function(){return r.apply(this,[q].concat(Array.prototype.slice.call(arguments)))}}return r};var m=function(u){var r=u._componentKeys;delete u._componentKeys;var t=u._componentAltKeyMap;delete u._componentAltKeyMap;var s=u._compositeInits;delete u._compositeInits;var q=u._compositeDestroys;delete u._compositeDestroys;u._compositePrepare=function(){this.logv("_compositePrepare: "+this.classname);if(this._compositePropertiesReady){return}this._componentAltKeyMap=new Object();this._compositeInits=new Object();this._compositeDestroys=new Object();this._insets=new Object();var w,x;for(w=0;w<r.length;w++){this[r[w]]=null;this._insets[r[w]]=[0,0,0,0]}var v={_componentAltKeyMap:t,_compositeInits:s,_compositeDestroys:q};for(x in v){if(v.hasOwnProperty(x)){for(w in v[x]){if(v[x].hasOwnProperty(w)){this[x][w]=v[x][w]}}}}this._compositePropertiesReady=true}};var a=g.Composite=function(x){var D={_componentKeys:[],_componentAltKeyMap:{},_compositeInits:{},_compositeDestroys:{},toString:function(){var F=[this.classname,"[CompositeView]"];if(this.isCompositeButton&&this.isCompositeButton()){F.push("[CompositeButton]")}return F.join(" ")},setGradient:function($super,J,F,K){if(!J){J={}}else{if(J instanceof h){J=J.props()}}var G,I;if(!K){for(G in J){var H=this._componentAltKeyMap[G]||G;if(J.hasOwnProperty(G)&&this[H] instanceof Object){this[H].setGradient(J[G],F)}}}if((Object.keys(J)).length){$super(J,F)}},setAttributes:function($super,F,K){if(!F){F={}}else{if(F instanceof h){F=F.props()}}var H,J,G;if(!K){for(H in F){var I=this._componentAltKeyMap[H]||H;if(F.hasOwnProperty(H)&&this[I] instanceof Object){this[I].setAttributes(F[H])}}}if((Object.keys(F)).length){$super(F)}}};var r=j;var s=0;var v,B,z,w,C;for(v=0;v<arguments.length;v++){z=arguments[v];if(!z){NgLogE("Error: CompositeView: Received an undefined component, this is probably a severe error!");continue}if(typeof z==="function"){z(D);continue}if(z.CompositeClass){r=z.CompositeClass}if(z.key||z.isComponent){C=z.key||v.toString();D._componentKeys.push(C);if(z.altKey){D._componentAltKeyMap[z.altKey]=C}if(z.component instanceof Object){for(B in z.component){if(z.component.hasOwnProperty(B)){w=z.component[B];if(typeof w!="function"){continue}switch(B){case"isComponent":break;case"initializeViewWithKey":D._compositeInits[C]=w;break;case"destroyViewWithKey":D._compositeDestroys[C]=w;break;default:D[B]=w;break}}}}else{throw new Error("Composite View Class Creation error: required property: component "+C)}if(!D._compositeInits[C]){throw new Error("Composite View Class Creation error: required method: initializeViewWithKey")}if(!D._compositeDestroys[C]){throw new Error("Composite View Class Creation error: required method: destroyViewWithKey")}}else{for(B in z){if(z.hasOwnProperty(B)){w=z[B];switch(B){case"CompositeClass":break;default:D[B]=w;break}}}}}if(!D.layoutSubviews){throw new Error("Composite View Class Creation error: required method layoutSubviews")}if(!D.addSubviews){throw new Error("Composite View Class Creation error: required method addSubviews")}var A=function(J,G,H){if(!H){H=G}else{A(J,G)}var I=k(H)+"Inset";J["set"+I]=function(K){if(!this._compositePropertiesReady){this._compositePrepare()}this._insets[G]=K};J["get"+I]=function(){if(!this._compositePropertiesReady){this._compositePrepare()}return this._insets[G]};var F=k(H)+"View";J["set"+F]=function(K){if(!this._compositePropertiesReady){this._compositePrepare()}var L=this[G];this[H]=this[G]=K.retain();if(L){L.removeFromParent()}this.addChild(K);if(L){L.release()}};J["get"+F]=function(){if(!this._compositePropertiesReady){this._compositePrepare()}return this[G]}};var E=function(I,F,G,H){I[F]=function(J){H.call(this,J);if(this[J]){this[G]=this[J]}}};var q;var y;var u={};for(C in D._componentAltKeyMap){if(D._componentAltKeyMap.hasOwnProperty(C)){u[D._componentAltKeyMap[C]]=C;y=D._compositeInits[D._componentAltKeyMap[C]];if(y&&typeof y==="function"){E(D._compositeInits,D._componentAltKeyMap[C],C,y)}}}for(v=0;v<D._componentKeys.length;v++){C=D._componentKeys[v];q=u[C];A(D,C,q)}m(D);var t=r.subclass(D);if(!t||!(t instanceof Function)){throw new Error("Error defining composite class! "+D.valueOf())}return t}}};__ngs._9i={_c:null,_d:function(){var c={exports:{}};var j=c.exports;this._c=c;var b=__ngs.r_(__ngs._t).Class;var d=__ngs.r_(__ngs._59).UI;var a=d.ViewGeometry.Rect;var o=__ngs.r_(__ngs._77).Primitives;var h=__ngs.r_(__ngs._bo);var n=__ngs.r_(__ngs._5l).UnspammableButton;var q=j.Component=function(v){var u;var x;var s;var w;var t;var r={isComponent:true};for(u=0;u<arguments.length;u++){t=arguments[u];if(t&&typeof t==="object"){for(x in t){if(t.hasOwnProperty(x)){r[x]=t[x]}}}}if(!r.hasOwnProperty("initializeViewWithKey")){r.initializeViewWithKey=function(y){throw ("Default Initializer!!? ["+JSON.stringify(y)+"]")}}if(!r.hasOwnProperty("destroyViewWithKey")){r.destroyViewWithKey=function(y){if(!this[y]){return}this[y].release();this[y]=null}}return r};var l=function(r){if(!r||(typeof r!=="string")||r.length<=0){r="unknownProperty"}return r.charAt(0).toUpperCase()+r.slice(1)};var f=function(r,s){return s.slice(0,3)+l(r)+s.slice(3)};var e=j.ACCESSOR_PASSTHROUGH="CompositePropertyPassthrough";var m=j.ComponentInheritForKey=function(r,s){var t=new Object();return t};var g=j.Components={};var k=g.Layouts=h.Layouts;var p=g.AddOrders=h.AddOrders;g.View=q({initializeViewWithKey:function(r){this[r]=(new o.View()).retain()}});g.LayoutGroup=q(g.View,{initializeViewWithKey:function(r){this[r]=(new o.LayoutGroup()).retain()}});g.Spinner=q(g.View,{initializeViewWithKey:function(r){this[r]=(new o.Spinner()).retain()}});g.Button=q({initializeViewWithKey:function(r){this[r]=(new d.Button()).retain()}});g.UnspammableButton=q(g.Button,{initializeViewWithKey:function(r){this[r]=(new n()).retain()}});g.Label=q({initializeViewWithKey:function(r){this[r]=(new o.Label()).retain()}});g.Image=q({initializeViewWithKey:function(r){this[r]=(new o.Image()).retain()}});g.ListView=q({initializeViewWithKey:function(r){this[r]=(new o.ListView()).retain()}});g.ScrollView=q({initializeViewWithKey:function(r){this[r]=(new o.ScrollView()).retain()}});g.EditText=q(g.Label,{initializeViewWithKey:function(r){this[r]=(new o.EditText()).retain()}});g.EditTextArea=q(g.EditText,{initializeViewWithKey:function(r){this[r]=(new o.EditTextArea()).retain()}});g.ImageLabel=q({initializeViewWithKey:function(r){this[r]=(new o.ImageLabel()).retain()}})}};__ngs._9j={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;function c(f){var e=f.toString(16);if(e.length==1){e="0"+e}return e}var d=a.Color={argb:function(h){var e=arguments;if(h&&h instanceof Array){e=h}if(e.length==4||e.length==3){for(var g=0;g<e.length;g++){if(e[g]===undefined||e[g]===null||!(e[g] instanceof Number)){NgLogD("Color::argb tried to parse invalid input");return null}}var f=c(e[0])+c(e[1])+c(e[2]);if(e.length==4){return f+c(e[3])}else{return"FF"+f}}NgLogD("Color::argb tried to parse invalid input");return null},setAlpha:function(j,k){if(isNaN(k)||k>1){k=1}else{if(k<0){k=0}}if(j&&j instanceof Array&&j.length>=2){var g=[];for(var h=0;h<j.length;h++){var f=j[h].split(" ");var e=f[1];f=f[0];g.push(d.setAlpha(f,k)+" "+e)}return g}else{if(j instanceof String){if(j.length==6){return c(255*k)+j}else{if(j.length==8){return c(255*k)+j.substring(2)}}}}NgLogD("Color::setAlpha tried to parse invalid input");return null},gradientFromColors:function(h){var e=arguments;if(h&&h instanceof Array){e=h}if(e.length==1){e=[e[0],e[0]]}var f=[];var j=1/(e.length-1);for(var g=0;g<e.length;g++){f.push(e[g]+" "+(g*j))}return f}}}};__ngs._9k={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var a=__ngs.r_(__ngs._7).Capabilities;var b=__ngs.r_(__ngs._t).Class;var e=c.DynamicValue=b.subclass({realize:function(){throw new Error("Must implement realize()")}})}};__ngs._9l={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._7).Capabilities;var e=__ngs.r_(__ngs._9k).DynamicValue;var d=b.DynamicTextSize=e.subclass({initialize:function(f){this._rawSize=f;return this},$_screenRatio:null,$_isIOS:null,_getScreenRatioIOS:function(){if(d._screenRatio===null){var g=a.getScreenWidth()/320;var f=a.getScreenHeight()/480;d._screenRatio=g<f?g:f}return d._screenRatio},_getScreenRatioAndroid:function(){if(d._screenRatio===null){d._screenRatio=a.getScreenHeight()/800}return d._screenRatio},_isIOS:function(){if(d._isIOS===null){d._isIOS=a.isPlatformIOS()}return d._isIOS},_getAndroidTabletScale:function(){var f=a.getScreenUnits();var g=this._getScreenRatioAndroid();if(g>f){return 1/f*g*1.5}else{return 1}},realize:function(){if(this._isIOS()){var f=Math.round(this._rawSize*this._getScreenRatioIOS()*0.9);return f}else{return this._rawSize*this._getAndroidTabletScale()}}})}};__ngs._9m={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var a=__ngs.r_(__ngs._7).Capabilities;var e=__ngs.r_(__ngs._9k).DynamicValue;var b=c.ProportionalCorners=e.subclass({corners:null,initialize:function(g){if(!g&&isNaN(g)){return this}var j=null;var f;var h;if(g instanceof b){this.corners=[];for(f in g.corners){if(g.corners.hasOwnProperty(f)){this.corners.push(g.corners[f])}}return this}if(g instanceof String){j=g.split(" ");for(f in j){h=parseFloat(j[f]);if(!isNaN(h)){j[f]=h}else{j[f]=0}}}if(g instanceof Array){j=g}else{if(arguments.length>=1){j=Array.prototype.slice.call(arguments)}}this.corners=j;return this},realize:function(){if(b.screenWidth===null){b.screenWidth=a.getScreenHeight()}var f=[];var h;for(var g in this.corners){if(this.corners.hasOwnProperty(g)){h=this.corners[g];h=h*b.screenWidth/800;f.push(h)}}return f.join(" ")},$screenWidth:null})}};__ngs._9n={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._7).Capabilities;var e=__ngs.r_(__ngs._9k).DynamicValue;var d=b.FontCascade=e.subclass({_faces:null,initialize:function(g){this._faces=[];var f;if(!g){return this}else{if(g instanceof d){this._faces=g._faces.slice();return this}else{if(g instanceof String&&arguments.length>0){for(f in arguments){if(arguments.hasOwnProperty(f)){this._faces.push({face:arguments[f]})}}return this}else{if(g instanceof Array){this._faces=g;return this}}}}},realize:function(){for(var f=0;f<this._faces.length;f++){if(d._osMatch(this._faces[f].os)){return this._faces[f].face}}return null},$_osMatch:function(f){if(!f||(f.toLowerCase()=="ios"&&a.isPlatformIOS())||(f.toLowerCase()=="droid"&&a.isPlatformAndroid())||(f.toLowerCase()=="flash"&&a.isPlatformFlash())){return true}return false}});b.FontCascade.defaultRegularFontFace=new d([{face:"DroidSans",os:"droid"},{face:"HelveticaNeue",os:"ios"},{face:"Helvetica",os:"ios"},{face:"DroidSansFallback"},{face:"Helvetica"}]);b.FontCascade.defaultBoldFontFace=new d([{face:"DroidSans-Bold",os:"droid"},{face:"HelveticaNeue-Bold",os:"ios"},{face:"Helvetica-Bold",os:"ios"},{face:"DroidSansFallback"},{face:"Helvetica"}]);b.FontCascade.defaultItalicFontFace=new d([{face:"DroidSerif-Italic",os:"droid"},{face:"HelveticaNeue-Italic",os:"ios"},{face:"Helvetica-Italic",os:"ios"},{face:"DroidSansFallback"},{face:"Helvetica"}]);b.FontCascade.defaultBoldItalicFontFace=new d([{face:"DroidSerif-BoldItalic",os:"droid"},{face:"HelveticaNeue-Bold",os:"ios"},{face:"Helvetica-Bold",os:"ios"},{face:"DroidSansFallback"},{face:"Helvetica"}])}};__ngs._9o={_c:null,_d:function(){var c={exports:{}};var B=c.exports;this._c=c;var g=__ngs.r_(__ngs._1s).SHA1;var b;if((typeof b=="undefined")||(b===null)){b={}}b.setProperties=function q(C,E){if(C!==null&&E!==null){for(var D in E){if(E.hasOwnProperty(D)){C[D]=E[D]}}}return C};b.setProperties(b,{percentEncode:function u(D){if((typeof D=="undefined")||(D===null)){return""}if(D instanceof Array){var E="";for(var C=0;C<D.length;++D){if(E!==""){E+="&"}E+=b.percentEncode(D[C])}return E}D=encodeURIComponent(D);D=D.replace(/\!/g,"%21");D=D.replace(/\*/g,"%2A");D=D.replace(/\'/g,"%27");D=D.replace(/\(/g,"%28");D=D.replace(/\)/g,"%29");return D},decodePercent:function s(C){if(C!==null){C=C.replace(/\+/g," ")}return decodeURIComponent(C)},formEncode:function p(D){var C="";var F=b.getParameterList(D);for(var G=0;G<F.length;++G){var E=F[G][1];if((typeof E=="undefined")||E===null){E=""}if(C!==""){C+="&"}C+=b.percentEncode(F[G][0])+"="+b.percentEncode(E)}return C},decodeForm:function l(F){var H=[];var J=F.split("&");for(var I=0;I<J.length;++I){var C=J[I];if(C===""){continue}var E=C.indexOf("=");var D;var G;if(E<0){D=b.decodePercent(C);G=null}else{D=b.decodePercent(C.substring(0,E));G=b.decodePercent(C.substring(E+1))}H.push([D,G])}return H},getParameterList:function m(C){if((typeof C=="undefined")||(C===null)){return[]}if(typeof C!="object"){return b.decodeForm(C+"")}if(C instanceof Array){return C}var D=[];for(var E in C){if(C.hasOwnProperty(E)){D.push([E,C[E]])}}return D},appendParameters:function m(E,C){for(var D=0;D<C.length;D++){E.push(C[D])}},authenticate:function n(I){var J=I.getRequestURL();var F=b.SignatureMethod.parseUri(J);var G=this.getParameterList(I.queryParams);if(I.getHttpHeaders()["Content-Type"]==="application/x-www-form-urlencoded"){this.appendParameters(G,this.getParameterList(I.postBody))}this.appendParameters(G,this.getParameterList(F.query));var L=I.authenticationParameters;var H={};H.oauth_consumer_key=L.consumerKey;H.oauth_token=L.token;H.oauth_version="1.0";H.oauth_timestamp=b.timestamp();H.oauth_nonce=b.nonce(6);H.oauth_signature_method=L.signature_method||"HMAC-SHA1";L.oauth_signature_method=H.oauth_signature_method;if(L.realm){H.realm=L.realm}var D=null;for(D in H){G.push([D,H[D]])}var C=b.SignatureMethod.getBaseString(I.getHttpMethod(),F,G);var E=b.SignatureMethod.sign(L,C);H.oauth_signature=E;var K=this.getAuthorizationHeader(H);I.httpHeaders.Authorization=K;return K},getAuthorizationHeader:function k(C){var D=[];var E=null;for(E in C){D.push(E+'="'+b.percentEncode(C[E])+'"')}return"OAuth "+D.join(",")},correctTimestamp:function j(C){b.timeCorrectionMsec=(C*1000)-(new Date()).getTime()},timeCorrectionMsec:0,timestamp:function d(){var C=(new Date()).getTime()+b.timeCorrectionMsec;return Math.floor(C/1000)},nonce:function t(G){var F=b.nonce.CHARS;var C="";for(var E=0;E<G;++E){var D=Math.floor(Math.random()*F.length);C+=F.substring(D,D+1)}return C}});b.nonce.CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";b.declareClass=function h(F,C,E){var G=F[C];F[C]=E;if(E!==null&&G!==null){for(var D in G){if(D!="prototype"){E[D]=G[D]}}}return E};b.declareClass(b,"SignatureMethod",function v(){});b.setProperties(b.SignatureMethod.prototype,{sign:function z(D){var C=this.getSignature(D);return C},initialize:function a(E,C){var D;if((typeof C.accessorSecret!="undefined")&&C.accessorSecret!==null&&E.length>9&&E.substring(E.length-9)=="-Accessor"){D=C.accessorSecret}else{D=C.consumerSecret}this.key=b.percentEncode(D)+"&"+b.percentEncode(C.tokenSecret)}});b.setProperties(b.SignatureMethod,{sign:function z(C,E){var D=C.oauth_signature_method;if((typeof D=="undefined")||D===null||D===""){D="HMAC-SHA1"}return b.SignatureMethod.newMethod(D,C).sign(E)},newMethod:function f(F,C){var E=b.SignatureMethod.REGISTERED[F];if((typeof E!="undefined")&&(E!==null)){var I=new E();I.initialize(F,C);return I}var H=new Error("signature_method_rejected");var D="";for(var G in b.SignatureMethod.REGISTERED){if(b.SignatureMethod.REGISTERED.hasOwnProperty(G)){if(D!==""){D+="&"}D+=b.percentEncode(G)}}H.oauth_acceptable_signature_methods=D;throw H},REGISTERED:{},registerMethodClass:function x(D,C){for(var E=0;E<D.length;++E){b.SignatureMethod.REGISTERED[D[E]]=C}},makeSubclass:function e(C){var D=b.SignatureMethod;var E=function(){D.call(this)};E.prototype=new D();E.prototype.getSignature=C;E.prototype.constructor=E;return E},getBaseString:function y(E,D,C){return b.percentEncode(E.toUpperCase())+"&"+b.percentEncode(b.SignatureMethod.normalizeUri(D))+"&"+b.percentEncode(b.SignatureMethod.normalizeParameters(C))},normalizeUri:function A(E){var C=E.protocol.toLowerCase();var G=E.authority.toLowerCase();var H=true;if(H){var D=G.lastIndexOf(":");if(D>=0){G=G.substring(0,D)}}var F=E.path;if(!F){F="/"}return C+"://"+G+F},parseUri:function r(G){var F={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}};var C=F.parser.strict.exec(G);var E={};var D=14;while(D--){E[F.key[D]]=C[D]||""}return E},normalizeParameters:function o(G){if((typeof G=="undefined")||G===null){return""}var E=0;var H=[];for(E=0;E<G.length;E++){var D=G[E];H.push([b.percentEncode(D[0])+" "+b.percentEncode(D[1]),D])}H.sort(function(J,I){if(J[0]<I[0]){return -1}if(J[0]>I[0]){return 1}return 0});var C=[];for(var F=0;F<H.length;++F){C.push(H[F][1])}return b.formEncode(C)}});b.SignatureMethod.registerMethodClass(["PLAINTEXT","PLAINTEXT-Accessor"],b.SignatureMethod.makeSubclass(function w(C){return this.key}));b.SignatureMethod.registerMethodClass(["HMAC-SHA1","HMAC-SHA1-Accessor"],b.SignatureMethod.makeSubclass(function w(D){var C=g.b64_hmac_sha1(this.key,D,"=");NgLogD("Donkey Signature: "+C);return C}));if((typeof B!="undefined")&&B){B.DonkeyOauth1=b}}};__ngs._9p={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var a=new (__ngs.r_(__ngs._f).RequireLoader)({UI:function(){return __ngs.r_(__ngs._59).UI},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements},GamercardStyle:function(){return __ngs.r_(__ngs._65).Gamercard},VHUserInfoListItem:function(){return __ngs.r_(__ngs._bp).VHUserInfoListItem},VHMobageHeaderListItem:function(){return __ngs.r_(__ngs._bq).VHMobageHeaderListItem},VHGameModuleListItem:function(){return __ngs.r_(__ngs._br).VHGameModuleListItem},VHListViewSectionController:function(){return __ngs.r_(__ngs._bs).VHListViewSectionController},GamercardWallListViewSectionController:function(){return __ngs.r_(__ngs._bt).GamercardWallListViewSectionController}});var b=c.FullGamercardView=a.UI.ListView.subclass({classname:"FullGamercardView",initialize:function($super,e){$super();this._cardStyle=a.GamercardStyle;this._user=e?e:null;this._userInfoSection=null;this._mobageHeaderSection=null;this._gameModuleSection=null;this._wallSection=null;this._gameModuleEnabled=null;this._userSectionsEnabled=null;this._addedSections=false;this.initSubviews()},destroy:function(){if(this._wallSection){this._wallSection.release();this._wallSection=null}if(this._userInfoSection){this._userInfoSection.release();this._userInfoSection=null}if(this._mobageHeaderSection){this._mobageHeaderSection.release();this._mobageHeaderSection=null}if(this._gameModuleSection){this._gameModuleSection.release();this._gameModuleSection=null}},initSubviews:function(){var f=[new a.VHUserInfoListItem(this._user)];var g=[new a.VHMobageHeaderListItem()];var e=[new a.VHGameModuleListItem()];this._userInfoSection=(new a.VHListViewSectionController(f,false)).retain();this._mobageHeaderSection=(new a.VHListViewSectionController(g,false)).retain();this._wallSection=(new a.GamercardWallListViewSectionController(this._user,true)).retain();this._gameModuleSection=(new a.VHListViewSectionController(e,false)).retain();this._cardStyle.applyTo(this);if(this._cardStyle.extras.backgroundColor){this.setBackgroundColor(this._cardStyle.extras.backgroundColor)}},layoutSubviews:function(){if(!this._addedSections&&this.getFrame()){this._addedSections=true;this._addSections(true)}this._mobageHeaderSection.layoutSubviews();if(this._userSectionsEnabled){this._userInfoSection.layoutSubviews();this._wallSection.layoutSubviews()}if(this._gameModuleEnabled){this._gameModuleSection.layoutSubviews()}},_addSections:function(g){var j=this._userSectionsEnabled;var h=!!this._user;var f=this._gameModuleEnabled;var e=this._gameModuleSection.items()[0]._data.show;if(g||j!=h||f!=e){var k=[];k.push(this._mobageHeaderSection.section());if(h){k.push(this._userInfoSection.section())}if(e){k.push(this._gameModuleSection.section())}if(h){k.push(this._wallSection.section())}this.setSections(k)}this._gameModuleEnabled=e;this._userSectionsEnabled=h},set:function(e,f){if(e.hasOwnProperty("user")){this._setUser(e.user)}if(e.hasOwnProperty("gameModule")){this._gameModuleSection.items()[0].set(e.gameModule,f)}this._addSections();this.layoutSubviews()},_jimmyListView:function(){if(this.getFrame()){var e=this.getScrollPosition();e[1]--;this.setScrollPosition(e);e[1]++;this.setScrollPosition(e)}},reloadData:function($super){$super();this._jimmyListView()},_setUser:function(e){if(e!=this._user){this._user=e;var f;this._userInfoSection.items()[0].setUser(e);this._wallSection.setUser(e);this._wallSection.loadData(true)}},sizeChanged:function(e,f){this.layoutSubviews()}})}};__ngs._9q={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var f=__ngs.r_(__ngs._59).UI;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Assets:function(){return __ngs.r_(__ngs._2z).Assets},FriendPickerStyle:function(){return __ngs.r_(__ngs._9t)},UIStyle:function(){return __ngs.r_(__ngs._60).Style},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements}});var e=a.UIStyle.ScaledTextSize;var d=f.View.subclass({classname:"FriendPickerCell",initialize:function($super,k,h,j){$super();a.FriendPickerStyle;this._FriendPickerStyle=a.UIStyle.registeredStyle("social.us.friendpicker");this.scaleFactor=1;if(k){this.scaleFactor=k}this._baseWidth=480;if(h){this._baseWidth=h}this.setFrame([15*k,15*k,15*k,15*k]);this._userPhoto=(new f.Image()).retain();this._userPhoto.setImageBorder(this._FriendPickerStyle.props()["userAvatar"]);this.addChild(this._userPhoto);this._nameLabel=(new f.Label()).retain();this._nameLabel.setTextSize(e(14).realize());this._nameLabel.setTextGravity(f.ViewGeometry.Gravity.BottomLeft);this._nameLabel.setAttributes(this._FriendPickerStyle.props()["listItemName"]);this.addChild(this._nameLabel);this._descriptionLabel=(new f.Label()).retain();this._descriptionLabel.setTextSize(e(12).realize());this._descriptionLabel.setTextGravity(f.ViewGeometry.Gravity.TopLeft);this._descriptionLabel.setAttributes(this._FriendPickerStyle.props()["listItemInvite"]);this.addChild(this._descriptionLabel);var g=this;this._selectCheckBox=(new f.CheckBox()).retain();a.CommonElements.checkBox.applyTo(this._selectCheckBox);this._selectCheckBox.onclick=function(){j.onRowSelectClicked(g)};this._sendInviteButton=(new a.UnspammableButton()).retain();this._sendInviteButton.setImage(a.Assets.image("invite_icon.png"));this._sendInviteButton.setImage(a.Assets.image("invite_sent_icon.png"),f.State.Disabled);this._sendInviteButton.setAttributes(this._FriendPickerStyle.props()["confirmButton"]);this._sendInviteButton.setGradient({},f.State.Disabled);this._sendInviteButton.onclick=function(){j.onRowInviteClicked(g)}},setupListItem:function(o,z,q,h,u,p,k,v){var x=this.getFrame();var r=x[2];var A=x[3];var g=(100/460)*r;var w=(275/460)*r;this._nameLabel.setFrame([g,0,w,A/2]);this._descriptionLabel.setFrame([g,A/2,w,A/2]);if(o){this.setAttributes(this._FriendPickerStyle.props()["listItemEven"])}else{this.setAttributes(this._FriendPickerStyle.props()["listItemOdd"])}this._nameLabel.setText(q);this._descriptionLabel.setText(u);var n=(10/75)*A;var m=(61/75)*A;this._userPhoto.setFrame([n,(A-m)/2,m,m]);if(h){this._userPhoto.setImage(h)}else{this._userPhoto.setImage(a.Assets.image("no-user-icon.png"))}if(z===true){if(this._sendInviteButton){this._sendInviteButton.removeFromParent()}var j=(10/75)*A;var t=(60/75)*A;this._selectCheckBox.setFrame([r-j-t*1.3+t*0.3,(A-t)/2,t*1.3,t]);this.addChild(this._selectCheckBox);this._selectCheckBox.clearState(f.State.Disabled);this._selectCheckBox.setChecked(p===true);if(!p&&v){this._selectCheckBox.setState(f.State.Disabled)}}else{if(this._selectCheckBox){this._selectCheckBox.removeFromParent()}var s=(10/75)*A;var l=(75/75)*A;var y=(52/75)*A;this._sendInviteButton.setFrame([r-s-l,(A-y)/2,l,y]);this.addChild(this._sendInviteButton);if(k){this._sendInviteButton.setImageInsets([0,0,0,0]);this._sendInviteButton.setState(f.State.Disabled)}else{this._sendInviteButton.setImageInsets([(10/75)*l,(10/75)*l,(10/75)*l,(10/75)*l]);this._sendInviteButton.setState(f.State.Normal)}}},onInviteSent:function(){this._sendInviteButton.setImageInsets([0,0,0,0]);this._sendInviteButton.setState(f.State.Disabled)},setFriendPickerSelectionEnabled:function(g){if(this.listItem.data.isSelected!==true){this._selectCheckBox.setState(g?f.State.Normal:f.State.Disabled)}},cleanUp:function(){if(this._userPhoto){this._userPhoto.release();this._userPhoto=null}if(this._nameLabel){this._nameLabel.release();this._nameLabel=null}if(this._descriptionLabel){this._descriptionLabel.release();this._descriptionLabel=null}if(this._selectCheckBox){this._selectCheckBox.release();this._selectCheckBox=null}if(this._sendInviteButton){this._sendInviteButton.release();this._sendInviteButton=null}},destroy:function(){this.cleanUp()}});b.FriendPickerCell=d}};__ngs._9r={_c:null,_d:function(){var f={exports:{}};var j=f.exports;this._c=f;var h=__ngs.r_(__ngs._59).UI;var e=h.ViewGeometry.Rect;var d=h.ViewGeometry.Scale;var k=__ngs.r_(__ngs._60).Style;var c=new (__ngs.r_(__ngs._f).RequireLoader)({PendingCellView:function(){return __ngs.r_(__ngs._bu).PendingCellView},ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells}});var n=__ngs.r_(__ngs._n).LocalizedString;var m=__ngs.r_(__ngs._79).MBListViewSection;var b=j.PendingLItem=h.ListViewItem.subclass({classname:"PendingLItem",_reuseId:"pendinglistsection_pendinglitem",_parentSection:null,initialize:function($super,o){$super();this._parentSection=o;this.setMessage(n("Talking to the server..."))},_message:"",setMessage:function(o){this._message=o;if(this.cell){this._onSetView(this.cell)}},_onCreateView:function(){return new c.PendingCellView()},_parentCVC:null,_onSetView:function(o){o.content.setText(this._message);o.onclick=this.bind(function(){NgLogD("Pending Item Clicked!")});o.setState(h.State.Normal);this.cell=o},_onReleaseView:function(o){if(this.cell==o){this.cell=null}}});var a=j.ErrorLItem=h.ListViewItem.subclass({classname:"ErrorLItem",_reuseId:"pendinglistsection_errorlitem",initialize:function($super){$super();this.setMessage(n("Error! Gremlins aren't being friendly today."));this._sheet=c.ListViewCellStyles.ErrorCell},_message:"",setMessage:function(o){this._message=o},_onCreateView:function(){return new h.Label({style:this._sheet})},clickAction:null,_onSetView:function(o){o.setText(this._message);o.setState(h.State.Normal);var q=new e(o.getFrame());var p=q.w*this._sheet.extras.textInsetRatio;o.setTextInsets([0,p,0,p]);this.cell=o}});var g=j.InformationalLItem=h.ListViewItem.subclass({classname:"InformationalLItem",_reuseId:"pendinglistsection_informationallitem",initialize:function($super){$super();this.setMessage(n("Whoa! Double Rainbow!"))},_message:"",setMessage:function(o){this._message=o},_onCreateView:function(){return new h.CellView({style:c.ListViewCellStyles.InformationalCell})},clickAction:null,_onSetView:function(o){o.setTitle(this._message);var p=this;o.setState(h.State.Normal);this.cell=o}});var l=j.PendingListSection=m.subclass({classname:"PendingListSection",spinnerListItem:null,errorListItem:null,messageListItem:null,currentListItem:null,initialize:function($super,o){$super(o);if(!this._items){this._items=[]}this.setRowHeightRatio(1/6);return this},destroy:function(){},controller:null,showError:function(o,p){if(!this.errorListItem){this.errorListItem=(new a())}this.errorListItem.setMessage(o);this.setItems([this.errorListItem]);this.currentListItem=this.errorListItem},setPendingText:function(o){if(!this.spinnerListItem){this.spinnerListItem=(new b(this))}this.spinnerListItem.setMessage(o);this.setItems([this.spinnerListItem]);this.currentListItem=this.spinnerListItem},setMessageText:function(o){if(!this.messageListItem){this.messageListItem=(new g())}this.messageListItem.setMessage(o);this.setItems([this.messageListItem]);this.currentListItem=this.messageListItem},calculateRowHeightForListView:function(o){if(!o){return}var q=new e(o.getFrame());if(q.isEmpty()){return}var p=q.h/5;this.setRowHeight(p)}})}};__ngs._9s={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var f=__ngs.r_(__ngs._5).Core;var a=__ngs.r_(__ngs._87).ReferenceCounting;var e=f.MessageListener.singleton({classname:"IdleScheduler",_isScheduled:null,_activeIdlers:null,_uidGen:null,initialize:function($super){if($super&&typeof $super==="function"){$super()}this._uidGen=0;this._isScheduled=false;this._activeIdlers={}},_scheduleTick:function(){var h=(new Date()).getTime();for(var g in this._activeIdlers){if(this._activeIdlers.hasOwnProperty(g)){this._activeIdlers[g].idleTick(h)}}},scheduleIdler:function(g){if(!g.uid){g.uid=""+(this._uidGen++)}if(this._activeIdlers.hasOwnProperty(g.uid)){return}this._activeIdlers[g.uid]=g;if(!this._isScheduled){f.UpdateEmitter.addListener(this,this.bind(this._scheduleTick));this._isScheduled=true}},unscheduleIdler:function(h){if(this._activeIdlers.hasOwnProperty(h.uid)){delete this._activeIdlers[h.uid]}if(this._isScheduled){for(var g in this._activeIdlers){if(this._activeIdlers.hasOwnProperty(g)){return}}f.UpdateEmitter.removeListener(this);this._isScheduled=false}}});var d=b.IdleActor=a.subclass({classname:"IdleActor",interval:null,idleAction:null,_idleStartTime:null,waitForIdleBeforeAction:function(g){this.idleAction=g;this._idleStartTime=(new Date()).getTime();e.scheduleIdler(this)},initialize:function($super){if($super&&typeof $super==="function"){$super()}this.interval=100},destroy:function(){e.unscheduleIdler(this)},idleTick:function(g){if(this._idleStartTime+this.interval<g){this.idleWaitCompleted()}},idleWaitCompleted:function(){if(this.idleAction&&typeof this.idleAction==="function"){this.idleAction()}e.unscheduleIdler(this)}})}};__ngs._9t={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var e={};e.Style=__ngs.r_(__ngs._60).Style;var a=e.Style.ScaledCorners;var d=e.Style.ScaledTextSize;e.Style.sheet("social.us.friendpicker",{listItemEven:{gradient:{gradient:["FFF9FCFD 0.0","FFF9FCFD 1.0"]}},listItemOdd:{gradient:{gradient:["FFE6EDF5 0.0","FFE6EDF5 1.0"]}},listItemName:{textColor:"FF004AA9"},listItemInvite:{textColor:"FF000000"},topBarBackgroundPane:{backgroundColor:"EE0C152D"},borderUnderTopPane:{backgroundColor:"FF2C4B6F"},listAreaPane:{backgroundColor:"EE13243B"},baseView:{gradient:{gradient:["FF0A1D34 0.0","FF0A1D34 1.0"]}},findFriendButtonNormalGradient:{gradient:["FFDAF2FD 0.0","FFDAF2FD 1.0"]},findFriendButtonHighlightedGradient:{corners:"6.0 6.0 6.0 6.0",gradient:["FF4090CD 0.0","FF2966BC 1.0"]},bottomBar:{gradient:{insets:"{0.0,0.0,0.0,0.0}",gradient:["E50E2454 0.000","E51C4B7C 1.000"]}},bottomBarText:{textColor:"FFFFFFFF"},confirmButton:{gradient:{corners:"6.0 6.0 6.0 6.0",gradient:["FF75B624 0.000","FF4D8D1F 1.000"]},pressedGradient:{corners:"6.0 6.0 6.0 6.0",gradient:["FF397210 0.000","FF5B971B 1.000"]},textColor:"FFFFFFFF"},confirmButtonDisabled:{gradient:{corners:"6.0 6.0 6.0 6.0",gradient:["FF9A9E90 0.000","FF7C7F76 1.000"]},textColor:"FFFFFFFF"},sentInviteButton:{gradient:{outerShadow:"0000 1.0 {0.0,0.0}",insets:"{1.0,0.0,0.0,0.0}",corners:"6.0 6.0 6.0 6.0",innerShadow:"FF00 0.0 {0.0,0.0}",gradient:["FF75B624 0.000","FF4D8D1F 1.000"]}},userAvatar:{corners:"2.0 2.0 2.0 2.0",gradient:[],outerLine:"FFFF 2",innerLine:"6000 2"},inviteSentButton:{gradient:{corners:"6.0 6.0 6.0 6.0",gradient:["00FFFFFF 0.0","00FFFFFF 1.0"]}},verticalContentContainer:{gradient:{gradient:["FFCAD2DD 0.0","FF7CA4C8 0.2"],corners:"4 4 0 0"},innerContainer:{gradient:{gradient:["FFC2D0E0 0.0","FFD9E1EC 1.0"],innerLine:"FF0E1D3B 2.0",corners:"4 4 0 0"}}},verticalContentFailureCaseTextHeader:{textFont:e.Style.defaultBoldFontFace,textColor:"FF60718A",textGravity:[0.5,0],textSize:d(14),textShadow:"66FFFFFF 1.0 {0.0,-2.0}"},verticalContentFailureCaseTextBody:{textColor:"FF60718A",textGravity:[0.5,0],textSize:d(14),textShadow:"66FFFFFF 1.0 {0.0,-2.0}"}})}};__ngs._9u={_c:null,_d:function(){var d={exports:{}};var g=d.exports;this._c=d;var a=__ngs.r_(__ngs._60).Style;var k=a.ScaledCorners;var b=a.ScaledTextSize;var c=__ngs.r_(__ngs._6k).MobageStyle;var f=__ngs.r_(__ngs._2z).Assets;var e=c.ScaledCorners;var j=c.ScaledTextSize;g.GenericMetrics={hPadding:0.0188,vPadding:0.0188,vSpacing:0.0188,vSpacingBig:0.0376,viewHeaderH:0.15,viewHeaderTextX:0.0188,viewHeaderTextW:0.9624,buttonH:0.104,textEditH:0.1458};g.CommonElements={};var h=function(l,m){c.lazyLoad(g.CommonElements,l,m)};h("standardButton",function(){return{style:{gradient:{corners:e(8),gradient:["FF5AB0E2 0.000","FF2B76BC 1.000"],innerLine:"4484C3E9 2.0"},pressedGradient:{corners:e(8),gradient:["FF3682C3 0.000","FF1C61A8 1.000"],innerLine:"2B003366 2.0"},textFont:c.defaultBoldFontFace,textSize:j(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}}});h("largeStandardButton",function(){return{style:{gradient:{corners:e(8),gradient:["FF5AB0E2 0.000","FF2B76BC 1.000"],outerLine:"FF233656 2.0",innerLine:"4484C3E9 2.0"},pressedGradient:{corners:e(8),gradient:["FF3682C3 0.000","FF1C61A8 1.000"],outerLine:"FF233656 2.0",innerShadow:"23000000 1.0 {0.0,-2.0}"},textFont:c.defaultBoldFontFace,textSize:j(16),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}}});h("largeActionButton",function(){return{style:{gradient:{corners:e(8),gradient:["FF75B624 0.000","FF4D8D1F 1.000"],outerLine:"FF233656 2.0",innerLine:"4484C3E9 2.0"},pressedGradient:{corners:e(8),gradient:["FF5B971B 0.000","FF397210 1.000"],outerLine:"FF233656 2.0",innerShadow:"23000000 1.0 {0.0,-2.0}"},textFont:c.defaultBoldFontFace,textSize:j(16),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}",disabledGradient:{},disabledTextColor:"FF000000"}}});h("disabledButton",function(){return{style:{gradient:{corners:e(8),gradient:["FFA0A0A0 0.000","FF7C7C7C 1.000"],innerLine:"44FFFFFF 2.0"},pressedGradient:{corners:k(8),gradient:["FFA0A0A0 0.000","FF7C7C7C 1.000"],innerLine:"44FFFFFF 2.0"},textFont:c.defaultBoldFontFace,textSize:j(14),textColor:"FFD1CDCD",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}}});h("backButton",function(){return{style:{image:f.image("back_button_ios.png"),pressedImage:f.image("back_button_ios_down.png"),textFont:c.defaultBoldFontFace,textSize:j(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5]}}});h("grayButton",function(){return{style:{gradient:{corners:e(8),gradient:["FF838d93 0.000","FF767c82 1.000"],innerLine:"44acbac0 2.0"},pressedGradient:{corners:e(8),gradient:["FF767c82 0.000","FF838d93 1.000"],innerLine:"44acbac0 2.0"},textFont:c.defaultBoldFontFace,textSize:j(16),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}}});h("blueButton",function(){return{style:{gradient:{corners:e(8),gradient:["FF5AB0E2 0.000","FF2B76BC 1.000"],innerLine:"4484C3E9 2.0"},pressedGradient:{corners:e(8),gradient:["FF3682C3 0.000","FF1C61A8 1.000"],innerLine:"2B003366 2.0"},textFont:c.defaultBoldFontFace,textSize:j(16),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}}});h("greenButton",function(){return{style:{gradient:{corners:e(8),gradient:["FF76b332 0.0","FF56912b 1.0"],outerLine:"FF233656 2.0",innerLine:"4484C3E9 2.0"},pressedGradient:{corners:e(8),gradient:["FF56912b 0.000","FF76b332 1.000"],outerLine:"FF233656 2.0",innerShadow:"23000000 1.0 {0.0,-2.0}"},textFont:c.defaultBoldFontFace,textSize:j(16),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}}});h("textBox",function(){return{style:{gradient:{corners:e(6),gradient:["FFC9C9C9 0.000","FFEDEDED 1.000"],outerLine:"FF000000 2.0",insets:"{0.0,0.0,2.0,0.0}"},errorGradient:{corners:e(6),gradient:["FFC9C9C9 0.000","FFEDEDED 1.000"],outerLine:"FFFF0000 2.0",insets:"{0.0,0.0,2.0,0.0}"},textFont:c.defaultRegularFontFace,textColor:"FF000000",textSize:j(14),textGravity:[0,0.5]}}});h("invisibleButton",function(){return{style:{pressedGradient:{corners:e(6),gradient:["44000000 0.000"],insets:"{0.0,0.0,2.0,0.0}"}}}});h("checkBox",function(){return{style:{gradient:{insets:"{0, 0, 0, 0}",outerLine:"00000000 3",outerShadow:"0000 0 {0,0}",corners:e(6),innerShadow:"FF7A7E80 2 {0,-1}",gradient:["FFE0E6EC 0","FFF3F7FD 1"]},pressedGradient:{insets:"{0, 0, 0, 0}",innerShadow:"FF00 6.0 {0.0,-1.0}",gradient:["FF80 0.000","FF80 1.000"],outerLine:"0000 3",outerShadow:"0000 0.0 {0.0,0.0}",corners:e(6)},checkedGradient:{insets:"{0, 0, 0, 0}",outerLine:"00000000 3",outerShadow:"0000 0 {0,0}",corners:e(6),innerShadow:"FF00 0 {0,0}",gradient:["FF75B624 0","FF4D8D1F 1"]},pressedCheckedGradient:{innerShadow:"FF0F610F 5.0 {0.0,-1.0}",insets:"{0, 0, 0, 0}",gradient:["FF179117 0.000","FF179117 1.000"],outerLine:"0000 3",outerShadow:"0000 0.0 {0.0,0.0}",corners:e(6)},disabledGradient:{insets:"{0, 0, 0, 0}",outerLine:"00000000 3",outerShadow:"3300 3 {0,0}",corners:e(6),gradient:["FFEEEEEE 0","FFD6D6D6 1"]}}}});h("topPageNavigationTab",function(){return{style:{gradient:{insets:"{4.0,0.0,0.0,0.0}",corners:"6.0 6.0 0.0 0.0",innerLine:"26B7F5FF 1.5",gradient:["FF2976BB 0.0","FF0B4B93 0.94","FF073161 0.95"]},pressedGradient:{insets:"{4.0,0.0,0.0,0.0}",corners:"6.0 6.0 0.0 0.0",innerLine:"26B7F5FF 1.5",gradient:["FF85C4EA 0.0","FF4799D3 0.94","FF3674A1 0.95"]},focusedGradient:{insets:"{0.0,0.0,0.0,0.0}",corners:"6.0 6.0 0.0 0.0",innerLine:"26B7F5FF 1.5",gradient:["FF2976BB 0.0","FF1B61A3 0.94","FF134370 0.95"]},textFont:c.defaultRegularFontFace,textFontSelected:c.defaultBoldFontFace,textSize:j(14),textColor:"FFFF",textGravity:[0.5,0.5],textShadow:"66000000 1.0 {0.0,-2.0}",textShadowSelected:"66000000 1.0 {0.0,1.0}"}}});h("userPhoto",function(){return{style:{imageBorder:{corners:e(4),outerLine:"FFFFFFFF 3",innerLine:"FFB2B2B2 2"},pressedImageBorder:{corners:e(8),outerLine:"FF000000 2",innerLine:"FFB2B2B2 2"},image:f.image("no-user-icon.png")}}});h("zeroCase",function(){return{extras:{heightFactor:200/480}}});h("header",function(){return{style:{gradient:{gradient:["FF143558 0.0","FF295D8D 1.0"]}},children:{content:{style:{textSize:j(14),textGravity:[0,0.25],textFont:c.defaultBoldFontFace,textColor:"FFFFFFFF"}},button:{style:{textColor:"FFFFFFFF",textSize:j(12),textFont:c.defaultBoldFontFace,gradient:{corners:e(8),gradient:["FF5AB0E2 0.000","FF2B76BC 1.000"],innerLine:"4484C3E9 2.0"},pressedGradient:{corners:e(8),gradient:["FF3682C3 0.000","FF1C61A8 1.000"],innerLine:"2B003366 2.0"}}}},extras:{headerHeightRatio:1/8}}});h("UserIconView",function(){return{style:{image:f.image("no-user-icon.png"),imageBorder:{outerLine:"FFFFFEFE 2.5",innerLine:"FF00 1.5",corners:e(6)}}}});h("LabeledUserIconButton",function(){return{style:{pressedGradient:{corners:e(6),gradient:["FF555555 0.0"]}},children:{label:{style:{textFont:c.defaultBoldFontFace,textSize:j(10),textColor:"FF00319A",textGravity:[0.5,0.5]}}},extras:{labelHeightRatio:1/4}}});h("GameIconView",function(){return{style:{image:f.image("no-game-icon.png"),imageBorder:{corners:e(6)}}}});h("LabeledGameIconButton",function(){return{style:{pressedGradient:{corners:e(20),gradient:["FF555555 0.0"]}},children:{label:{style:{textFont:c.defaultBoldFontFace,textSize:j(12),textColor:"FF004AA9",textGravity:[0.5,0.5]}}},extras:{labelHeightRatio:1/5,imageInsetRatio:1/20}}});a.sheet("social.us.commonelements",{standardButton:{gradient:{corners:k(8),gradient:["FF5AB0E2 0.000","FF2B76BC 1.000"],innerLine:"4484C3E9 2.0"},pressedGradient:{corners:k(8),gradient:["FF3682C3 0.000","FF1C61A8 1.000"],innerLine:"2B003366 2.0"},textFont:a.defaultBoldFontFace,textSize:b(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"},largeStandardButton:{gradient:{corners:k(8),gradient:["FF5AB0E2 0.000","FF2B76BC 1.000"],outerLine:"FF233656 2.0",innerLine:"4484C3E9 2.0"},pressedGradient:{corners:k(8),gradient:["FF3682C3 0.000","FF1C61A8 1.000"],outerLine:"FF233656 2.0",innerShadow:"23000000 1.0 {0.0,-2.0}"},textFont:a.defaultBoldFontFace,textSize:b(16),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"},largeActionButton:{gradient:{corners:k(8),gradient:["FF75B624 0.000","FF4D8D1F 1.000"],outerLine:"FF233656 2.0",innerLine:"4484C3E9 2.0"},pressedGradient:{corners:k(8),gradient:["FF5B971B 0.000","FF397210 1.000"],outerLine:"FF233656 2.0",innerShadow:"23000000 1.0 {0.0,-2.0}"},textFont:a.defaultBoldFontFace,textSize:b(16),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"},disabledButton:{gradient:{corners:k(8),gradient:["FFA0A0A0 0.000","FF7C7C7C 1.000"],innerLine:"44FFFFFF 2.0"},pressedGradient:{corners:k(8),gradient:["FFA0A0A0 0.000","FF7C7C7C 1.000"],innerLine:"44FFFFFF 2.0"},textFont:a.defaultBoldFontFace,textSize:b(14),textColor:"FFD1CDCD",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"},textBox:{gradient:{corners:k(6),gradient:["FFC9C9C9 0.000","FFEDEDED 1.000"],outerLine:"FF000000 2.0",insets:"{0.0,0.0,2.0,0.0}"},gradientError:{corners:k(6),gradient:["FFC9C9C9 0.000","FFEDEDED 1.000"],outerLine:"FFFF0000 2.0",insets:"{0.0,0.0,2.0,0.0}"},textFont:a.defaultRegularFontFace,textColor:"FF000000",textSize:b(14)},checkBoxGradients:{checkBoxChecked:{insets:"{0, 0, 0, 0}",outerLine:"00000000 3",outerShadow:"0000 0 {0,0}",corners:"6 6 6 6",innerShadow:"FF00 0 {0,0}",gradient:["FF75B624 0","FF4D8D1F 1"]},checkBoxUnChecked:{insets:"{0, 0, 0, 0}",outerLine:"00000000 3",outerShadow:"0000 0 {0,0}",corners:"6 6 6 6",innerShadow:"FF7A7E80 2 {0,-1}",gradient:["FFE0E6EC 0","FFF3F7FD 1"]},checkBoxPressed:{insets:"{0, 0, 0, 0}",innerShadow:"FF00 6.0 {0.0,-1.0}",gradient:["FF80 0.000","FF80 1.000"],outerLine:"0000 3",outerShadow:"0000 0.0 {0.0,0.0}",corners:"6 6 6 6"},checkBoxCheckedPressed:{innerShadow:"FF0F610F 5.0 {0.0,-1.0}",insets:"{0, 0, 0, 0}",gradient:["FF179117 0.000","FF179117 1.000"],outerLine:"0000 3",outerShadow:"0000 0.0 {0.0,0.0}",corners:"6 6 6 6"},checkBoxInActive:{insets:"{0, 0, 0, 0}",outerLine:"00000000 3",outerShadow:"3300 3 {0,0}",corners:"6 6 6 6",gradient:["FFEEEEEE 0","FFD6D6D6 1"]}},topPageNavigationTab:{gradient:{insets:"{4.0,0.0,0.0,0.0}",corners:"6.0 6.0 0.0 0.0",innerLine:"26B7F5FF 1.5",gradient:["FF2976BB 0.0","FF0B4B93 0.94","FF073161 0.95"]},pressedGradient:{insets:"{4.0,0.0,0.0,0.0}",corners:"6.0 6.0 0.0 0.0",innerLine:"26B7F5FF 1.5",gradient:["FF85C4EA 0.0","FF4799D3 0.94","FF3674A1 0.95"]},gradientSelected:{insets:"{0.0,0.0,0.0,0.0}",corners:"6.0 6.0 0.0 0.0",innerLine:"26B7F5FF 1.5",gradient:["FF2976BB 0.0","FF1B61A3 0.94","FF134370 0.95"]},textFont:a.defaultRegularFontFace,textFontSelected:a.defaultBoldFontFace,textSize:b(14),textColor:"FFFF",textGravity:[0.5,0.5],textShadow:"66000000 1.0 {0.0,-2.0}",textShadowSelected:"66000000 1.0 {0.0,1.0}"},zeroCaseHeightFactor:200/480,userPhoto:{imageBorder:{corners:k(4),outerLine:"FFFFFFFF 3",innerLine:"FFB2B2B2 2"}}});a.sheet("social.us.host",{parent:"social.us.commonelements",backgroundView:{gradient:{gradient:["FF05162c 0.0","FF132337 1.0"]},imageGravity:[0,0]},backButton:{textFont:a.defaultBoldFontFace,textSize:b(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}});a.sheet("social.us.servicehost",{parent:"social.us.host",backgroundView:{gradient:{gradient:["FF061b3d 0.0"]},imageFit:6},titleBarView:{backgroundColor:"80000000"},titleBarLine:{gradient:{outerLine:"2EA3D9FF 1.0"}},homeButton:{gradient:{outerShadow:"FF20719F 0.0 {0.0,-4.0}",insets:"{0.0,0.0,4.0,0.0}",corners:"6.0 6.0 6.0 6.0",innerShadow:"FFFFFEFE 2.0 {0.0,-1.0}",gradient:["FF42BEF0 0.000","FF35A2DC 1.000"],outerLine:"FF7DD1F4 1.0"},textColor:"FFFFFFFF"},mobageButton:{},activeGameButton:{gradient:{corners:k(6),gradient:["FF1969B6 0.000","FF00347E 1.000"],innerLine:"4484C3E9 1.0"},gradientPressed:{corners:k(6),gradient:["FF002B69 0.000","FF0A468D 1.000"],innerLine:"4484C3E9 1.0"},textColor:"FFFFFFFF",textColorPressed:"FFBFBFBF",textShadow:"33000000 1.0 {0.0,1.0}",textShadowPressed:"33FFFFFF 1.0 {0.0,1.0}",textFont:a.defaultBoldFontFace,textSize:b(10),textGravity:[1,0.5]}});a.sheet("social.us.credentialshost",{parent:"social.us.host",titleBarView:{gradient:{gradient:["FF0F3455 0.0","FF061A35 1.0"],outerLine:"CC446B8E 2.0"}},titleBarLine:{gradient:{outerLine:"CC446B8E 2.0"}},footerView:{gradient:{gradient:["CC000D21 0.0","CC000D21 1.0"]}},footerLine:{gradient:{outerLine:"CC7D8996 2.0"}},mobageLogo:{imageFit:1,imageGravity:[0.5,0]},subtitle:{textFont:a.defaultRegularFontFace,textSize:b(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"66000000 4.0 {0.0,-4.0}"},footerLabel:{textFont:a.defaultRegularFontFace,textSize:b(14),textColor:"FFFFFFFF",textGravity:[0,0.5],textShadow:"66000000 1.0 {0.0,-2.0}"},welcomeText0:{textFont:a.defaultBoldFontFace,textSize:b(12),textColor:"FF27A0F7",textGravity:[0.5,1]},welcomeText1:{textFont:a.defaultBoldFontFace,textSize:b(12),textColor:"9927A0F7",textGravity:[0.5,1]},welcomeText2:{textFont:a.defaultBoldFontFace,textSize:b(12),textColor:"6627A0F7",textGravity:[0.5,1]}});a.sheet("social.us.disaggregated",{parent:"social.us.commonelements",backgroundView:{gradient:{corners:e(10),gradient:["E5011E4C 0.0","E5011E4C 1.0"],innerLine:"FF000000 3.0",insets:"{0,0,10,0}"}},backBtn:{textFont:a.defaultBoldFontFace,textSize:j(18),textColor:"FFFFFFFF"},inputLabel:{textFont:a.defaultRegularFontFace,textSize:j(16),textColor:"FFFFFFFF",textGravity:[0,1]},forgotPasswordButton:{gradient:{corners:e(0),gradient:["00000000 0.000","00000000 1.000"],outerLine:"00000000 0.0",innerLine:"00000000 0.0"},pressedGradient:{corners:e(5),gradient:["40000000 0.000","80000000 1.000"],outerLine:"00000000 0.0",innerShadow:"00000000 1.0 {0.0,-2.0}",insets:"{5,0,5,0}"},textFont:a.defaultRegularFontFace,textColor:"FF4F89D5",textSize:j(15),textGravity:[0,0.5],textShadow:"00000000 1.0 {0.0,-2.0}"},title:{textFont:a.defaultBoldFontFace,textSize:j(18),textColor:"FFFFFFFF",textGravity:[0,1],textShadow:"CC000000 1.0 {0.0,-2.0}"},descText:{textFont:a.defaultRegularFontFace,textSize:j(14),textColor:"FFFFFFFF",textGravity:[0,0.5]},invisibleButton:{pressedGradient:{corners:e(6),gradient:["66000000 0.000"],insets:"{0.0,0.0,2.0,0.0}"}}});a.sheet("social.us.standardtitle",{content:{textColor:"FFFFFFFF",textSize:b(15)},accessory:{}});a.sheet("social.us.ccview",{_headerHeightRatio:1/8,_insetRatio:0.1,_borderThicknessRatio:5/480,_bgHeightGrowthRatio:1/480,bgAttributes:{gradient:{corners:k(4),gradient:["FFE9EFF3 0.0","FFE9EFF3 1.0"]}},borderAttributes:{gradient:{corners:k(2),outerLine:"FF0E1D3B 1.0"}}});a.sheet("social.us.usericonview",{imageBorder:{outerLine:"FFFFFEFE 2.5",innerLine:"FF00 1.5",corners:k(6)}});a.sheet("social.us.userbutton",{userButtonLabel:{textColor:"FF333333",textSize:b(11),textFont:a.defaultBoldFontFace},maxFriendNameChars:7,userButtonIconY:0,userButtonIconWidth:62,userButtonLabelY:66,userButtonLabelHeight:22});a.sheet("social.us.interstitialsplash",{attributes:{gradient:{gradient:["FF091847 0.0","FF091847 1.0"]}}});a.sheet("social.us.progressveil",{gradient:{gradient:["FF0B4B93 0.0","FF0B4B93 1.0"]}});a.sheet("social.us.menudrawer",{menuDrawer:{gradient:{insets:"{0.0,-5.0,-5.0,-5.0}",gradient:["EE011732 0.0","EE002A5A 1.0"],innerLine:"FF334A62 3.0"}},menuDrawerButton:{textColor:"FFFFFFFF",textSize:b(14)},menuDrawerButtonPressed:{textColor:"FFB2B2B2",gradient:{gradient:["FF011733 0.0","FF002A5A 1.0"],innerLine:"FF334A62 3.0"},centerGradient:{gradient:["FF011733 0.0","FF002A5A 1.0"],innerLine:"FF334A62 1.0"}},centerButtonGradient:{insets:"{0.0,0.0,-5.0,0.0}",innerLine:"FF334A62 1.0"},imageHeightRatio:50/102,topMarginRatio:12/102,bottomMarginRatio:10/102})}};__ngs._9v={_c:null,_d:function(){var f={exports:{}};var d=f.exports;this._c=f;var h=__ngs.r_(__ngs._59).UI;var e=h.ViewGeometry.Rect;var c=new (__ngs.r_(__ngs._f).RequireLoader)({Assets:function(){return __ngs.r_(__ngs._2z).Assets},FriendPickerStyle:function(){return __ngs.r_(__ngs._9t)},UIStyle:function(){return __ngs.r_(__ngs._60).Style},ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements}});var g=c.UIStyle.ScaledTextSize;var b=__ngs.r_(__ngs._2a).Destinations;var a=h.View.subclass({classname:"LeaderboardCategoryCell",initialize:function($super,k,j){$super();c.FriendPickerStyle;this._FriendPickerStyle=c.UIStyle.registeredStyle("social.us.friendpicker");this.setFrame([15*k,15*k,15*k,15*k]);this._gamePhoto=(new h.Image()).retain();this.addChild(this._gamePhoto);this._titleLabel=(new h.Label()).retain();this.addChild(this._titleLabel);this._topPlayerLabel=(new h.Label()).retain();this.addChild(this._topPlayerLabel);this._userPhotoButton=(new c.UnspammableButton()).retain();this.addChild(this._userPhotoButton);this.stylesheet=c.ListViewCellStyles.LeaderboardCategoryCell;this.stylesheet.applyTo(this)},setupListItem:function(p,j,o,k,m,l){var n=new e(this.getFrame());this._gamePhoto.setFrame(0,0,n.h,n.h);this._titleLabel.setFrame(n.h,0,n.w,n.h);this._topPlayerLabel.setFrame(n.h,0,n.w,n.h);this._userPhotoButton.setFrame(n.w-n.h,0,n.h,n.h);if(p){this.setAttributes(this._FriendPickerStyle.props()["listItemEven"])}else{this.setAttributes(this._FriendPickerStyle.props()["listItemOdd"])}this._titleLabel.setText(o);this._topPlayerLabel.setText(k);this._gamePhoto.setImage(j);this._userPhotoButton.setImage(m);this._userPhotoButton.setOnClick(function(){NgLogD("LEADERSHLAGEN _userPhotoButtonCLICK: ");l()});NgLogD("LEADERSHLAGEN userClickFunc: "+l)},cleanUp:function(){if(this._gamePhoto){this._gamePhoto.release();this._gamePhoto=null}if(this._titleLabel){this._titleLabel.release();this._titleLabel=null}if(this._topPlayerLabel){this._topPlayerLabel.release();this._topPlayerLabel=null}if(this._selectCheckBox){this._selectCheckBox.release();this._selectCheckBox=null}if(this._userPhotoButton){this._userPhotoButton.release();this._userPhotoButton=null}},destroy:function(){this.cleanUp()}});d.LeaderboardCategoryCell=a}};__ngs._9w={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var g=__ngs.r_(__ngs._59).UI;var d=g.ViewGeometry.Rect;var b=new (__ngs.r_(__ngs._f).RequireLoader)({ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells}});var a=__ngs.r_(__ngs._n).LocalizedString;var f=c.LeaderboardFooterView=g.View.subclass({classname:"LeaderboardFooterView",initialize:function(h){NgLogD("initialize LeaderboardFooterView v2");this.image=new g.Image();this.title=new g.Label();this.text=new g.Label();this.score=new g.Label();this.button=new g.Button();this.button.setOnClick(function(){NgLogD("FILTRATION COMMENSE!!")});if(h){NgLogD("LeaderboardListSection.userScore.rank "+h.rank);NgLogD("LeaderboardListSection.userScore.gamertag "+h.gamertag);NgLogD("LeaderboardListSection.userScore.score "+h.score);NgLogD("LeaderboardListSection.userScore.badge_id "+h.badge_id);this.image.setImage(h.badge_id);this.title.setText(h.rank);this.text.setText(h.gamertag);this.score.setText(h.score)}else{NgLogD("LeaderboardListSection.userScore NO SCORE case");this.text.setText(a("User Name"));this.score.setText(a("NO SCORE"))}this.addChild(this.image);this.addChild(this.title);this.addChild(this.text);this.addChild(this.score);this.addChild(this.button);b.ListViewCellStyles.LeaderboardFooterView.applyTo(this);this.layoutSubviews()},layoutSubviews:function(){var h=new d(this.getFrame());NgLogD("LeaderboardFooterView.layoutSubviews "+h);this.image.setFrame(0,0,h.h,h.h);this.title.setFrame(0,0,h.w,h.h);this.text.setFrame(0,0,h.w,h.h);this.score.setFrame(0,0,h.w,h.h);this.button.setFrame(0,0,h.w,h.h)},sizeChanged:function(){this.layoutSubviews()}})}};__ngs._9x={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var g=__ngs.r_(__ngs._59).UI;var c=g.ViewGeometry.Rect;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Assets:function(){return __ngs.r_(__ngs._2z).Assets},FriendPickerStyle:function(){return __ngs.r_(__ngs._9t)},UIStyle:function(){return __ngs.r_(__ngs._60).Style},ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements}});var f=a.UIStyle.ScaledTextSize;var e=g.View.subclass({classname:"LeaderboardCell",initialize:function($super,j,h){$super();a.FriendPickerStyle;this._FriendPickerStyle=a.UIStyle.registeredStyle("social.us.friendpicker");this._userPhotoButton=(new g.Button()).retain();this.addChild(this._userPhotoButton);this._rankLabel=(new g.Label()).retain();this.addChild(this._rankLabel);this._gamertagLabel=(new g.Label()).retain();this.addChild(this._gamertagLabel);this._scoreLabel=(new g.Label()).retain();this.addChild(this._scoreLabel);this.stylesheet=a.ListViewCellStyles.LeaderboardCell;this.stylesheet.applyTo(this)},setupListItem:function(r,n,l,j,k,h,m,o){var p=new c(this.getFrame());var q=this;this._userPhotoButton.setFrame(0,0,p.h,p.h);this._rankLabel.setFrame(p.h,0,p.w,p.h);this._gamertagLabel.setFrame(p.h,0,p.w,p.h);this._scoreLabel.setFrame(0,0,p.w-16,p.h);this.cntrlRef=o;if(r){this.setAttributes(this._FriendPickerStyle.props()["listItemEven"])}else{this.setAttributes(this._FriendPickerStyle.props()["listItemOdd"])}this._userPhotoButton.setImage(n);this._rankLabel.setText(l);this._gamertagLabel.setText(j);this._scoreLabel.setText(k);this._userPhotoButton.setOnClick(function(){NgLogD("LEADERSHLAGEN _userPhotoButtonCLICK: ");h()});this._userPhotoButton.setOnSwipe(function(s){NgLogD("LEADERSHLAGEN _userPhotoButtonSWIPE: ");m(s,q.cntrlRef)})},cleanUp:function(){if(this._rankLabel){this._rankLabel.release();this._rankLabel=null}if(this._gamertagLabel){this._gamertagLabel.release();this._gamertagLabel=null}if(this._selectCheckBox){this._selectCheckBox.release();this._selectCheckBox=null}if(this._userPhotoButton){this._userPhotoButton.release();this._userPhotoButton=null}},destroy:function(){this.cleanUp()}});b.LeaderboardCell=e}};__ngs._9y={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var f={};f.Style=__ngs.r_(__ngs._60).Style;var d=__ngs.r_(__ngs._6k).MobageStyle;var a=d.ScaledCorners;var e=d.ScaledTextSize;f.Style.sheet("social.us.leaderboardview",{listItemEven:{gradient:{gradient:["FFF9FCFD 0.0","FFF9FCFD 1.0"]}},listItemOdd:{gradient:{gradient:["FFE6EDF5 0.0","FFE6EDF5 1.0"]}},header:{backgroundColor:"EE032644"},leaderboardFooter:{backgroundColor:"EE0C152D"},footer:{backgroundColor:"EE032644"},headerLabel:{textColor:"FFFFFFFF",textGravity:[0,0.5],textFont:f.Style.defaultBoldFontFace,textSize:e(14)},leaderboardListHeaderText:{textColor:"FFFFFFFF",textInsets:[0,0,0,10],textGravity:[0,0.5],textFont:f.Style.defaultBoldFontFace,textSize:e(14)},friendFilterButton:{textColor:"FFFFFFFF",textSize:e(14),textFont:f.Style.defaultBoldFontFace,gradient:{innerLine:"19FFFFFF 1.0",innerShadow:"6600 0.0 {0.0,2.0}",gradient:["FFcccccc 0.0","FF7f7f7f 1.0"],corners:a(12,0,0,12)},selectedGradient:{innerShadow:"6600 0.0 {0.0,2.0}",gradient:["FF09a3e9 0.0","FF09a3e9 1.0"],corners:a(12,0,0,12)},pressedGradient:{innerLine:"33000000 1.0",innerShadow:"6600 0.0 {0.0,2.0}",gradient:["FF09a3e9 0.0","FF09a3e9 1.0"],corners:a(12,0,0,12)}},globalFilterButton:{textColor:"FFFFFFFF",textSize:e(14),textFont:f.Style.defaultBoldFontFace,gradient:{innerLine:"19FFFFFF 1.0",innerShadow:"6600 0.0 {0.0,2.0}",gradient:["FFcccccc 0.0","FF7f7f7f 1.0"],corners:a(1,12,12,0)},selectedGradient:{innerShadow:"6600 0.0 {0.0,2.0}",gradient:["FF09a3e9 0.0","FF09a3e9 1.0"],corners:a(1,12,12,0)},pressedGradient:{innerLine:"33000000 1.0",innerShadow:"6600 0.0 {0.0,2.0}",gradient:["FF09a3e9 0.0","FF09a3e9 1.0"],corners:a(1,12,12,0)}},dragHandle:{imageGravity:[0,0.5],imageFit:1,gradient:{gradient:["FF707070 0.0","FF333333 1.0"],gradientAngle:180}},verticalContentContainer:{gradient:{gradient:["FFCAD2DD 0.0","FF7CA4C8 0.2"],corners:"4 4 0 0"},innerContainer:{gradient:{gradient:["FFC2D0E0 0.0","FFD9E1EC 1.0"],corners:"4 4 0 0"}}},leaderboardContainer:{gradient:{gradient:["FFCAD2DD 0.0","FF7CA4C8 0.2"],corners:"4 4 0 0"},innerContainer:{imageGravity:[0,0.5],gradient:{gradient:["FFC2D0E0 0.0","FFD9E1EC 1.0"],corners:"4 4 0 0"}}},leaderboardListHeader:{textSize:e(14),textGravity:[0,0.5],textFont:d.defaultBoldFontFace,textColor:"FFFFFFFF",textInsets:[0,0,0,10],backgroundColor:["FF999EA3"]},footerImage:{imageGravity:[0,0.5],imageInsets:[5,5,5,5]},footerTitle:{textSize:e(50),textInsets:[0,5,0,5],textFont:d.defaultBoldFontFace,textGravity:[0,0.5],textColor:"FF516b86"},footerText:{textSize:e(16),textInsets:[0,0,0,15],textFont:d.defaultBoldFontFace,textGravity:[0,0.5],textColor:"FFFFFFFF"},footerScore:{textSize:e(16),textInsets:[0,5,0,0],textFont:d.defaultBoldFontFace,textGravity:[1,0.5],textColor:"FFFFFFFF"}})}};__ngs._9z={_c:null,_d:function(){var f={exports:{}};var j=f.exports;this._c=f;var b=__ngs.r_(__ngs._60).Style;var o=b.ScaledCorners;var c=b.ScaledTextSize;var d=__ngs.r_(__ngs._6k).MobageStyle;var g=d.ScaledCorners;var n=d.ScaledTextSize;var h=__ngs.r_(__ngs._2z).Assets;var a=new (__ngs.r_(__ngs._f).RequireLoader)({LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements}});var l=j.ListViewCells={};var m=function(p,q){d.lazyLoad(j.ListViewCells,p,q)};var e={style:{gradient:{gradient:["FFFFFFFF 0.0","FFFFFFFF 1.0"]},pressedGradient:{gradient:["66000000 0.0","66000000 0.0"]},oddGradient:{gradient:["FFdfe8f2 0.0","FFdfe8f2 1.0"]},pressedOddGradient:{gradient:["66000000 0.0","66000000 0.0"],outerLine:"2F233656 1.0"}},extras:{imageInsetRatio:0.1,buttonInsetRatio:0.1,insetRatio:0.1,buttonSizeRatio:0.22,subtitleHeightRatio:0.4}};m("Generics",function(){return{style:e.style,children:{icon:{style:{gradient:{corners:g(8)}}}},extras:e.extras}});m("InviteRequestSent",function(){return{style:{textGravity:[0,0.5],disabledTextColor:"FF8E9CAA",textShadow:"FFFFFFFF 1.0 {0.0,-2.0}",textFont:d.defaultBoldFontFace,textSize:n(14)},extras:{extensionRatio:0.1,markRatio:0.21,marginRatio:0.06}}});m("AddButton",function(){var p={style:{gradient:{corners:g(8),gradient:["FF5fad0d 0.0","FF336c0f 1.0"]},pressedGradient:{corners:g(8),gradient:["FF336c0f 0.0","FF5fad0d 1.0"],outerLine:"2F233656 2.0"},textFont:d.defaultRegularFontFace,textSize:n(14),textColor:"FFFFFFFF",textShadow:"00 0.0 {0.0,0.0}",disabledGradient:{},disabledTextColor:"FF000000"}};p.style.oddGradient=p.style.gradient;p.style.pressedOddGradient=p.style.pressedGradient;return p});m("IgnoreButton",function(){var p={style:{gradient:{corners:g(8),gradient:["FF676767 0.0","FF464646 1.0"]},pressedGradient:{corners:g(8),gradient:["FF464646 0.0","FF676767 1.0"],outerLine:"2F676767 2.0"},textFont:d.defaultRegularFontFace,textSize:n(14),textColor:"FFFFFFFF",textShadow:"00 0.0 {0.0,0.0}",disabledGradient:{},disabledTextColor:"FF000000"}};p.style.oddGradient=p.style.gradient;p.style.pressedOddGradient=p.style.pressedGradient;return p});m("FriendCellMessage",function(){return{children:{title:{style:{textFont:d.defaultBoldFontFace,textSize:n(12),textColor:"FF004AA9",textGravity:[0,0.9]}},middleLabel:{style:{textFont:d.defaultBoldFontFace,textSize:n(10),textColor:"FF000000",textGravity:[0,0.5]}},subtitle:{style:{textFont:d.defaultRegularFontFace,textSize:n(10),textColor:"FF000000",textGravity:[0,0.1]}}}}});m("SystemInfoCell",function(){return{style:e.style,extras:e.extras,children:{key:{style:{outerLine:"FF000000 2.0",textFont:d.defaultBoldFontFace,textColor:"FF004AA9",textGravity:[0.5,0.5],textSize:n(14)}},content:{style:{outerLine:"FF000000 2.0",textFont:d.defaultRegularFontFace,textColor:"FF000000",textGravity:[0,0.5],textSize:n(14)}}}}});m("FoundFriendCell",function(){var p={style:{pressedGradient:{gradient:["66000000 0.0","66000000 0.0"],innerShadow:"CC00 1.0 {0,0}"}},children:{icon:{style:{imageBorder:{corners:g(4)},image:h.image("no-user-icon.png")}},message:l.FriendCellMessage,accessoryButton:l.AddButton,accessoryButtonAlt1:l.IgnoreButton},extras:e.extras};for(var q in e.style){if(!p.style[q]){p.style[q]=e.style[q]}}return p});m("DropDownCell",function(){var q={style:{pressedGradient:{gradient:["66000000 0.0","66000000 0.0"],innerShadow:"CC00 1.0 {0,0}"}},extras:e.extras};for(var p in e.style){if(!q.style[p]){q.style[p]=e.style[p]}}return q});m("WallPostCell",function(){return{style:{gradient:{insets:"{0,-2,0,-2}",gradient:["FFDD 0.0","FFF8 1.0"],outerLine:"FFCC 1.0"}},children:{title:{style:{text:a.LocText("Comments"),textFont:d.defaultBoldFontFace,textSize:n(12),textColor:"FF000000",textGravity:[0,0]}},field:a.CommonElements.textBox,button:{style:{gradient:{corners:g(8),gradient:["FF5AB0E2 0.000","FF2B76BC 1.000"],innerLine:"4484C3E9 2.0"},pressedGradient:{corners:g(8),gradient:["FF3682C3 0.000","FF1C61A8 1.000"],innerLine:"2B003366 2.0"},text:a.LocText("Post"),textFont:d.defaultBoldFontFace,textSize:n(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}}},extras:{titleHeightRatio:3/10,postWidthRatio:1/4,insetWidthRatio:1/40}}});var k=function(){var q={style:{textFont:d.defaultRegularFontFace,textSize:n(14),textColor:"FFFFFFFF",image:h.image("ListModal_OpenModal_Up.png"),pressedImage:h.image("ListModal_OpenModal_Down.png"),disabledGradient:{},disabledTextColor:"FF000000",gradient:{}}};q.style.pressedGradient=q.style.gradient;q.style.oddGradient=q.style.gradient;q.style.pressedOddGradient=q.style.gradient;var r={style:{gradient:{gradient:["FFFFFFFF 0.0","FFFFFFFF 1.0"],outerLine:"FFE4EBF0 1.0"},pressedGradient:{gradient:["66000000 0.0","66000000 0.0"],innerShadow:"CC00 1.0 {0,0}"}},children:{icon:{children:{content:{style:{image:h.image("no-user-icon.png")}}}},message:{children:{title:{style:{textFont:d.defaultBoldFontFace,textSize:n(13),textColor:"FF00319A",textGravity:[0,0.5]}},middleLabel:{style:{textFont:d.defaultBoldFontFace,textSize:n(10),textColor:"FF000000",textGravity:[0,0.5]}},subtitle:{style:{textFont:d.defaultRegularFontFace,textSize:n(13),textColor:"FF000000",textGravity:[0,0]}}}},accessoryButton:{children:{content:q,label:{style:{text:"",textFont:d.defaultBoldFontFace,textSize:n(13),textColor:"FF00319A",textGravity:[1,0.5]}}}},accessoryButtonAlt1:{children:{content:q,label:{style:{text:"",textFont:d.defaultBoldFontFace,textSize:n(13),textColor:"FF00319A",textGravity:[1,0.5]}}}}},extras:{rightInsetRatio:1/4}};var p;for(p in e.style){if(!r.style[p]){r.style[p]=e.style[p]}}for(p in e.extras){if(!r.extras[p]){r.extras[p]=e.extras[p]}}return r};m("ConversationCell",function(){var p=k();return p});m("DialogCell",function(){var p=k();p.children.accessoryButton=p.children.accessoryButton.children.content;return p});m("MorePostCell",function(){return{style:{gradient:{gradient:["FFFFFFFF 0.0"],insets:"{0,-2,0,-2}",outerLine:"FFCC 1.0"},pressedGradient:{gradient:["4400319A 0.0"]}},children:{message:{style:{text:a.LocText("More Posts"),textFont:d.defaultBoldFontFace,textSize:n(13),textColor:"FF00319A",textGravity:[0.5,0.5]}},leftArrow:{style:{image:h.image("show_more_arrow.png"),imageGravity:[0.5,0.5]}},rightArrow:{style:{image:h.image("show_more_arrow.png"),imageGravity:[0.5,0.5]}}},extras:{imageInsetRatio:0.1,buttonInsetRatio:0.1,insetRatio:0.1,buttonSizeRatio:0.22}}});m("FriendCell",function(){var p={style:{pressedGradient:{gradient:["66000000 0.0","66000000 0.0"],innerShadow:"CC00 1.0 {0,0}"}},children:{message:l.FriendCellMessage,rightAccessory:{style:{image:h.image("no-game-icon.png"),textFont:d.defaultRegularFontFace,textSize:n(10),textColor:"FF333333",pressedImageBorder:{gradient:["66000000 0.0","66000000 1.0"],corners:g(16),innerShadow:"CC00 1.0 {0,0}"}}},icon:{style:{image:h.image("no-user-icon.png")}}},extras:e.extras};for(var q in e.style){if(!p.style[q]){p.style[q]=e.style[q]}}return p});m("AddAllCell",function(){var p={style:{gradient:{gradient:["FF9dadbe 0.0","FFdfe8f2 1.0"],innerShadow:"CC00 1.0 {0,0}"},pressedGradient:{gradient:["66000000 0.0","66000000 0.0"],innerShadow:"CC00 1.0 {0,0}"}},children:{message:{style:{textFont:d.defaultBoldFontFace,textSize:n(10),textColor:"FF000000",textGravity:[0,0.5]}},accessoryButton:l.AddButton},extras:e.extras};p.style.oddGradient=p.style.gradient;p.style.pressedOddGradient=p.style.pressedGradient;return p});m("PendingCell",function(){return{style:{gradient:{gradient:["FFC0 0.0","FFFF 1.0"],innerShadow:"CC00 1.0 {0,0}"}},children:{content:{style:{textGravity:[0.1,0.5],textFont:d.defaultRegularFontFace,textSize:n(12)}}}}});m("ErrorCell",function(){return{style:{gradient:{innerShadow:"CC00 1.0 {0,0}"},textFont:d.defaultRegularFontFace,textSize:n(12),textColor:"FF656565",textGravity:[0,0.5]},extras:{textInsetRatio:0.1}}});m("DirectInviteCell",function(){return{style:{textFont:d.defaultRegularFontFace,textSize:n(11),gradient:{gradient:["FF506580 0.0","FF3e4f65 1.0"],outerLine:"FF303d52 1.5",insets:"{5,5,5,5}",corners:g(8)}},children:{title:{style:{textGravity:[0,0.5],textFont:d.defaultRegularFontFace,textSize:n(12),textColor:"FFFFFFFF"}},content:a.CommonElements.textBox,button:{style:{gradient:{gradient:["FF7a9de1 0.0","057a9de1 1.0"],corners:g(8),outerLine:"FF395163 1.0"},pressedGradient:{gradient:["057a9de1 0.0","FF7a9de1 1.0"],corners:g(8),outerLine:"FF395163 1.0"},textColor:"FFFFFFFF",textFont:d.defaultRegularFontFace,textSize:n(16)}}},extras:{ratios:{title:0.3,button:0.3,inset:0.05}}}});m("InviteEmailForm",function(){return{children:{field:a.CommonElements.textBox,sendButton:a.CommonElements.standardButton}}});m("InviteCellForm",function(){return{children:{sendButton:{textSize:c(14),textColor:"FFFFFFFF"}},extras:{insetRatio:0.05,buttonWidthRatio:0.2}}});m("EmptyMessageCell",function(){return{style:{titleGravity:[0.5,0.5],titleFont:d.defaultRegularFontFace,titleSize:n(17),titleColor:"FF647286"}}});m("ZeroCaseMessageCell",function(){return{children:{title:{style:{textGravity:[0.5,0.5],textFont:d.defaultBoldFontFace,textSize:n(13),textColor:"FF5F718A",textShadow:"80FFFFFF 1.0 {0.0,-2.0}"}},content:{style:{textGravity:[0.5,0.5],textFont:d.defaultBoldFontFace,textSize:n(13),textColor:"FF5F718A",textShadow:"80FFFFFF 1.0 {0.0,-2.0}"}},actionButton:a.CommonElements.largeActionButton},extras:{titleXFactor:0,titleYFactor:0,titleWidthFactor:1,titleHeightFactor:1/3,contentXFactor:0.025,contentYFactor:1/3,contentWidthFactor:0.95,contentHeightFactor:1/3,actionButtonXFactor:0.3,actionButtonYFactor:(2/3+0.05),actionButtonWidthFactor:0.4,actionButtonHeightFactor:(1/3-0.1),actionButtonInset:20}}});m("InformationalCell",function(){return{children:{title:{style:{textGravity:[0.5,0.5],textFont:d.defaultBoldFontFace,textSize:n(13),textColor:"FF5F718A",textShadow:"80FFFFFF 1.0 {0.0,-2.0}"}},content:{style:{textGravity:[0.5,0.5],textFont:d.defaultBoldFontFace,textSize:n(13),textColor:"FF5F718A",textShadow:"80FFFFFF 1.0 {0.0,-2.0}"}}}}});m("StandardSectionHeaderCell",function(){return{style:{gradient:{gradient:["FFA0B0BF 0.0","FFA0B0BF 0.3","FFDCE5EC 1.0"]},textGravity:[0,0.5],textFont:d.defaultBoldFontFace,textSize:n(13),textColor:"FF000000"},extras:{insetRatio:1/20}}});m("StandardActionCell",function(){return{style:{imageBorder:{corners:g(20)},gradient:{gradient:["FFFFFFFF 0.0"],outerLine:"FFAAAAAA 0.5"},textGravity:[0,0.5],textFont:d.defaultBoldFontFace,textSize:n(13),textColor:"FF000000"},children:{auxiliaryButton:a.CommonElements.standardButton},extras:{insetRatio:1/40,auxiliaryButtonWidthRatio:1/3}}});m("LeaderboardCategoryCell",function(){return{style:{gradient:{gradient:["FFFFFFFF 0.0"],outerLine:"FFAAAAAA 0.5"},pressedGradient:{gradient:["FF1C3C60"],outerLine:"FFAAAAAA 0.5"},textGravity:[1,1],textInsets:[0,5,0,5],textFont:d.defaultRegularFontFace,textSize:n(13),titleColor:"157DEC",titleFont:d.defaultBoldFontFace,titleInsets:[0,5,0,5],titleGravity:[0,0.5],imageInsets:[5,5,5,5]},children:{_gamePhoto:{style:{imageInsets:[5,5,5,5]}},_titleLabel:{style:{textSize:n(16),textInsets:[0,0,0,5],textFont:d.defaultBoldFontFace,textGravity:[0,0.2],textColor:"FF004aa9"}},_topPlayerLabel:{style:{textSize:n(14),textInsets:[0,0,0,5],textFont:d.defaultRegularFontFace,textGravity:[0,0.8],textColor:"FF000000"}},_userPhotoButton:{style:{imageInsets:[5,5,5,5]}}},extras:{insetRatio:1/40,auxiliaryButtonWidthRatio:1/3}}});m("LeaderboardCell",function(){return{style:{gradient:{gradient:["FFFFFFFF 0.0"],outerLine:"FFAAAAAA 0.5"},pressedGradient:{gradient:["FF1C3C60"],outerLine:"FFAAAAAA 0.5"}},children:{_userPhotoButton:{style:{imageInsets:[5,5,5,5]}},_rankLabel:{style:{textSize:n(48),textInsets:[0,5,0,5],textFont:d.defaultBoldFontFace,textGravity:[0,0.5],textColor:"FFB5CAE7"}},_gamertagLabel:{style:{textSize:n(16),textInsets:[0,0,0,15],textFont:d.defaultBoldFontFace,textGravity:[0,0.5],textColor:"FF000000"}},_scoreLabel:{style:{textSize:n(16),textFont:d.defaultBoldFontFace,textInsets:[0,15,0,0],textGravity:[1,0.5],textColor:"FF000000"}}},extras:{insetRatio:1/40,auxiliaryButtonWidthRatio:1/3}}});m("LeaderboardSectionHeaderCell",function(){return{style:{gradient:{gradient:["FF99AEA3 1.0"]},textGravity:[0,0.5],textFont:d.defaultBoldFontFace,textSize:n(14),textColor:"FFFFFFFF"},extras:{insetRatio:1/20}}});m("LeaderboardMenu",function(){return{style:{gradient:{gradient:["FF99AEA3 1.0"]}},children:{title:{style:{textSize:n(60),textInsets:[0,5,0,100],textFont:d.defaultBoldFontFace,textGravity:[0,0.5],textColor:"FF516b86"}},buttonLeft:{style:{gradient:{corners:"0 8 0 8",gradient:["FFC6C6C6 0.000","FF6B6B6B 1.000"],insets:"{10,5,10,10}"},pressedGradient:{corners:"0 8 0 8",gradient:["FF00A5E2"],innerLine:"2B003366 2.0"},textFont:d.defaultBoldFontFace,textSize:n(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}},buttonRight:{style:{gradient:{corners:"0 0 8 8",gradient:["FFC6C6C6 0.000","FF6B6B6B 1.000"],insets:"{10,10,10,5}"},pressedGradient:{corners:"0 8 0 8",gradient:["FF00A5E2"],insets:"{10,10,10,5}"},textFont:d.defaultBoldFontFace,textSize:n(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}}},extras:{insetRatio:1/20}}});m("LeaderboardFooterView",function(){return{style:{gradient:{gradient:["FF1C3C60 1.0"]}},children:{image:{style:{imageInsets:[5,5,5,5]}},title:{style:{textSize:n(60),textInsets:[0,5,0,100],textFont:d.defaultBoldFontFace,textGravity:[0,0.5],textColor:"FF516b86"}},text:{style:{textSize:n(16),textInsets:[0,0,0,150],textFont:d.defaultBoldFontFace,textGravity:[0,0.5],textColor:"FFFFFFFF"}},score:{style:{textSize:n(16),textInsets:[0,25,0,0],textFont:d.defaultBoldFontFace,textGravity:[1,0.5],textColor:"FFFFFFFF"}}},extras:{insetRatio:1/20}}});m("UpgradeUserCell",function(){return{children:{title:{style:{textGravity:[0.5,0],textFont:d.defaultRegularFontFace,textSize:n(16),textColor:"FF000000"}},facebookBtn:{style:{image:h.image("registration_button_facebook.png"),pressedImage:h.image("registration_button_facebook_down.png"),imageFit:3,imageGravity:[0,0],textFont:d.defaultRegularFontFace,textColor:"FFFFFFFF",textSize:n(16),textGravity:[0.8,0.5]}},signUpBtn:{style:{gradient:{corners:g(8),gradient:["FF5AB0E2 0.000","FF2B76BC 1.000"],innerLine:"4484C3E9 2.0"},pressedGradient:{corners:g(8),gradient:["FF3682C3 0.000","FF1C61A8 1.000"],innerLine:"2B003366 2.0"},textFont:d.defaultRegularFontFace,textSize:n(16),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}},startOverBtn:{style:{gradient:{corners:g(8),gradient:["FF5AB0E2 0.000","FF2B76BC 1.000"],innerLine:"4484C3E9 2.0"},pressedGradient:{corners:g(8),gradient:["FF3682C3 0.000","FF1C61A8 1.000"],innerLine:"2B003366 2.0"},textFont:d.defaultRegularFontFace,textSize:n(16),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}},alreadyLbl:{style:{textFont:d.defaultRegularFontFace,textColor:"FF999999",textSize:n(12),textGravity:[0.5,0.5]}},alreadyDivLeftView:{style:{gradient:{gradient:["FF999999 0.000"]}}},alreadyDivRightView:{style:{gradient:{gradient:["FF999999 0.000"]}}},supportLbl:{style:{textFont:d.defaultRegularFontFace,textSize:n(12),textColor:"FF000000",textGravity:[0.5,0.5]}},supportBtn:{style:{textFont:d.defaultRegularFontFace,textSize:n(12),textColor:"FF266A9F",textGravity:[0.5,0.5],pressedGradient:{corners:g(8),gradient:["33000000 0.000"]}}},facebookIconImg:{style:{image:h.image("registration_icon_facebook.png"),imageFit:6,imageGravity:[0.5,0.5]}},facebookIconDivImg:{style:{image:h.image("FB-Email-Divider-line.png"),imageFit:6,imageGravity:[0.5,0.5]}},signUpIconImg:{style:{image:h.image("email-icon.png"),imageFit:1,imageGravity:[0.5,0.5]}},signUpIconDivImg:{style:{image:h.image("FB-Email-Divider-line.png"),imageFit:6,imageGravity:[0.5,0.5]}},facebookBtn:{style:{image:h.image("registration_button_facebook.png"),pressedImage:h.image("registration_button_facebook_down.png"),imageFit:3,imageGravity:[0,0]}},facebookBtnLbl:{style:{textFont:d.defaultBoldFontFace,textColor:"FFFFFFFF",textSize:n(16),textGravity:[0.5,0.5]}},signUpBtnLbl:{style:{textFont:d.defaultBoldFontFace,textColor:"FFFFFFFF",textSize:n(16),textGravity:[0.5,0.5]}}}}})}};__ngs._a0={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var f=__ngs.r_(__ngs._6k).MobageStyle;var a=f.ScaledCorners;var g=f.ScaledTextSize;var d=__ngs.r_(__ngs._2z).Assets;var b=new (__ngs.r_(__ngs._f).RequireLoader)({CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements}});f.lazyLoad(c,"TitleCellStyle",function(){return{style:{gradient:{gradient:["FF032644 0.0"]}},children:{_label:{style:{textGravity:[0,0.5],textInsets:[0,0,0,10],textFont:f.defaultBoldFontFace,textColor:"FFFFFFFF",textSize:g(14)}}}}});f.lazyLoad(c,"CountHeaderCellStyle",function(){return{style:{gradient:{gradient:["FFDDDDDD 0.0","FFFFFFFF 1.0"]}},children:{_label:{style:{textGravity:[0,0.5],textInsets:[0,0,0,10],textFont:f.defaultStandardFontFace,textColor:"FF000000",textSize:g(14)}}}}});f.lazyLoad(c,"ListCellStyle",function(){return{style:{gradient:{gradient:["FFFFFFFF 0.0"]}},children:{_bkgImage:{style:{textGravity:[0,0.5],textInsets:[0,0,0,10],textFont:f.defaultStandardFontFace,textColor:"FF000000",textSize:g(14)}}},extras:{imageWidthInsetRatio:0.04,imageHeightInsetRatio:0.32}}});f.lazyLoad(c,"BadgeButtonStyle",function(){return{style:{imageFit:1,imageGravity:[0.5,0],textGravity:[0.5,0],textInsets:[0,0,0,0],textFont:f.defaultBoldFontFace,textColor:"FF555555",textSize:g(12)},extras:{textWidthMarginsPct:0.08,textHeightPct:0.7,imageTextMarginPct:0.14}}});f.lazyLoad(c,"FooterStyle",function(){return{style:{gradient:{gradient:["FF032644 0.0"]}},children:{_mobageButton:{style:{gradient:{gradient:["FFFFFFFF 0.0"]},imageGravity:[0.5,0.5],imageInsets:[0,10,0,0]}}},extras:{mobageButtonWidthRatio:0.27,mobageButtonHeightInsetRatio:0.09}}});f.lazyLoad(c,"ContentBackgroundStyle",function(){return{style:{gradient:{gradient:["FFFFFFFF 0.0"]}}}});f.lazyLoad(c,"DetailModalStyle",function(){return{style:{gradient:{gradient:["FFAAAAAA 0.0"],corners:"4.0 4.0 4.0 4.0",outerLine:"FF000000 1.0"}},children:{_descriptionLabel:{style:{textFont:f.defaultStandardFontFace,textColor:"FF000000",textGravity:[0,0],textSize:g(14)}},_titleLabel:{style:{textFont:f.defaultBoldFontFace,textColor:"FF000000",textGravity:[0,0.8],textSize:g(14)}},_achvImage:{style:{imageGravity:[0.5,0.5]}}},extras:{achvIconInsetRatio:0.1,achvIconWidthRatio:0.25,textMarginHeightPct:0.03,containerWidthInsetRatio:0.03,containerHeightMaxRatio:0.7,containerVerticalInsetRatio:0.1}}})}};__ngs._42={_c:null,_d:function(){var module={exports:{}};var exports=module.exports;this._c=module;var Class=function(){};exports.Class=Class;Class.subclass=(function(){function argumentNames(body){var names;if(Function.prototype.__arguments){names=body.__arguments();if(names){return names}}names=body.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return names.length==1&&!names[0]?[]:names}function overrideMethod(overrideBody,ancestorBody){var override;if(ancestorBody!==undefined){override=function(){var localThis=this;var $super=function(){return ancestorBody.apply(localThis,arguments)};Array.prototype.unshift.call(arguments,$super);return overrideBody.apply(this,arguments)}}else{override=function(){Array.prototype.unshift.call(arguments,undefined);return overrideBody.apply(this,arguments)}}override.valueOf=function(){return overrideBody.valueOf()};override.toString=function(){return overrideBody.toString()};return override}function TempClass(){}function emptyFunction(){}return function(){var properties=arguments[0];var conditions=arguments[1];var property;var classname=properties.classname||(this.classname?this.classname+"Subclass":"AnonymousClass");if(typeof $_ASSIGNENGINEBINDINGS!=="undefined"&&typeof properties._classId!=="undefined"){$_ASSIGNENGINEBINDINGS(properties,properties._classId)}var NewClass=eval("(function "+classname+"(){this.initialize.apply(this, arguments)})");for(property in this){if(!this.hasOwnProperty(property)){continue}NewClass[property]=this[property]}var ancestorPrototype=this.prototype;TempClass.prototype=ancestorPrototype;NewClass.prototype=new TempClass();NewClass.prototype.superclass=ancestorPrototype;NewClass.prototype.constructor=NewClass;var value;for(property in properties){if(!properties.hasOwnProperty(property)){continue}var getter=properties.__lookupGetter__(property);var setter=properties.__lookupSetter__(property);if(getter||setter){if(getter){value=getter;if(argumentNames(value)[0]=="$super"){value=overrideMethod(value,ancestorPrototype.__lookupGetter__(property))}NewClass.prototype.__defineGetter__(property,value)}if(setter){value=setter;if(argumentNames(value)[0]=="$super"){value=overrideMethod(value,ancestorPrototype.__lookupSetter__(property))}NewClass.prototype.__defineSetter__(property,value)}}else{value=properties[property];if(typeof value==="function"&&property[0]!="$"){if(argumentNames(value)[0]=="$super"){value=overrideMethod(value,ancestorPrototype[property])}else{if(property=="initialize"){var ancestorInitialize=ancestorPrototype.initialize;if(ancestorInitialize){var derivedInitialize=value;value=function(){ancestorInitialize.apply(this,arguments);derivedInitialize.apply(this,arguments)}}}else{if(property=="destroy"){var ancestorDestroy=ancestorPrototype.destroy;if(ancestorDestroy){var derivedDestroy=value;value=function(){derivedDestroy.apply(this,arguments);ancestorDestroy.apply(this,arguments)}}}}}NewClass.prototype[property]=value}else{if(property[0]=="$"){property=property.slice(1)}NewClass[property]=value;NewClass.prototype[property]=value}}}if(!NewClass.prototype.initialize){NewClass.prototype.initialize=emptyFunction}if(typeof properties.__load=="function"){properties.__load.call(NewClass)}if(typeof $_REGISTERCLASSTOENGINE!=="undefined"&&typeof properties._classId!=="undefined"){$_REGISTERCLASSTOENGINE(properties,properties._classId)}return NewClass}})();Class.singleton=function(arg0){var __load=arg0.__load;delete arg0.__load;var tempClass=this.subclass.call(this,arg0);var initialize=tempClass.prototype.initialize;tempClass.prototype.initialize=function(){};var instance=new tempClass();tempClass._instance=instance;if(__load){__load.call(tempClass)}var functions=[];var instantiate=function(real){for(var i in functions){var func=functions[i];delete instance[func]}instance.initialize=initialize;instance.initialize();instance.instantiate=function(){};var args=Array.prototype.slice.call(arguments,1);return real.apply(instance,args)};for(var i in instance){if(instance.__lookupGetter__(i)||instance.__lookupSetter__(i)){continue}var value=instance[i];if(typeof(value)=="function"){functions.push(i);instance[i]=instantiate.bind(this,value)}}instance.instantiate=instantiate.bind(this,function(){});return instance};Class.prototype.bind=function(func){var context=this;if(arguments.length<2){return function(){return func.apply(context,arguments)}}else{var args=Array.prototype.slice.call(arguments,1);return function(){var finalArgs=args.concat(Array.prototype.slice.call(arguments,0));return func.apply(context,finalArgs)}}};Class.prototype.toString=function(){return this.constructor.name}}};__ngs._43={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;
/*!
 * Perl License (GPL or Artistic)
 *
 * $Id: base64.js,v 1.1 2009/03/01 22:38:45 dankogai Exp dankogai $
 *
 * History:
 *   dankogai's original: character-based
 *   drry's fix: split string to array then join
 *   new version: regexp-based
 */
var c=(function(){var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var e=function(x){var w={};for(var v=0,u=x.length;v<u;v++){w[x.charAt(v)]=v}return w}(g);var p=String.fromCharCode;var k=function(t){var u=(t.charCodeAt(0)<<16)|(t.charCodeAt(1)<<8)|(t.charCodeAt(2));return g.charAt(u>>>18)+g.charAt((u>>>12)&63)+g.charAt((u>>>6)&63)+g.charAt(u&63)};var s=function(u){if(u.match(/[^\x00-\xFF]/)){throw"unsupported character found"}var v=0;while(u.length%3){u+="\x00";v++}var t=u.replace(/[\x00-\xFF]{3}/g,k);if(!v){return t}t=t.substr(0,t.length-v);while(v--){t+="="}return t};var h=typeof(btoa)!=="undefined"?btoa:s;var o=function(t){var u=(e[t.charAt(0)]<<18)|(e[t.charAt(1)]<<12)|(e[t.charAt(2)]<<6)|(e[t.charAt(3)]);return p(u>>16)+p((u>>8)&255)+p(u&255)};var d=function(u){u=u.replace(/[^A-Za-z0-9\+\/]/g,"");var v=u.length%4;while(u.length%4){u+="A"}var t=u.replace(/[A-Za-z0-9\+\/]{4}/g,o);if(v>=2){t=t.substring(0,t.length-[0,0,2,1][v])}return t};var l=typeof(atob)!=="undefined"?atob:d;var f=/[^\x00-\x7F]/g;var r=function(t){var u=t.charCodeAt(0);return u<2048?p(192|(u>>>6))+p(128|(u&63)):p(224|((u>>>12)&15))+p(128|((u>>>6)&63))+p(128|(u&63))};var n=function(t){return unescape(encodeURIComponent(t))};var j=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g;var m=function(t){var w=t.charCodeAt(0);var v=t.charCodeAt(1);if(w<224){return p(((w&31)<<6)|(v&63))}else{var u=t.charCodeAt(2);return p(((w&15)<<12)|((v&63)<<6)|(u&63))}};var q=function(t){return decodeURIComponent(escape(t))};return{fromBase64:d,toBase64:s,atob:l,btoa:h,utob:n,btou:q,encode:function(t){if(!t){return""}return h(n(new String(t)))},encodeBinary:function(t){if(!t){return""}return h(new String(t))},decode:function(t){if(!t){return""}if(t.length%4==1){throw new Error("Invalid Base64 string: "+t)}return q(l(t.replace(/[\-_]/g,function(u){return u=="-"?"+":"/"})))},decodeBinary:function(t){if(!t){return""}return l(t.replace(/[\-_]/g,function(u){return u=="-"?"+":"/"}))}}})();a.Base64=c}};__ngs._44={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._42).Class;b.MessageListener=a.subclass({classname:"MessageListener",initialize:function(){this._messageEmitters=[]},destroy:function(){var d=this._messageEmitters;while(d.length){d[0].removeListener(this)}},_startListeningEmitter:function(f){var e=this._messageEmitters;var d=e.indexOf(f);if(d!==-1){return false}e.push(f);return true},_stopListeningEmitter:function(f){var e=this._messageEmitters;var d=e.indexOf(f);if(d===-1){return false}e.splice(d,1);return true}})}};__ngs._45={_c:null,_d:function(){var a={exports:{}};var e=a.exports;this._c=a;
/*!
 * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message
 * Digest Algorithm, as defined in RFC 1321.
 * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for more info.
 */
function f(t){return r(l(g(t),t.length*8))}function o(u){var w="0123456789abcdef";var t="";var s;for(var v=0;v<u.length;v++){s=u.charCodeAt(v);t+=w.charAt((s>>>4)&15)+w.charAt(s&15)}return t}function j(u){var t="";var v=-1;var s,w;while(++v<u.length){s=u.charCodeAt(v);w=v+1<u.length?u.charCodeAt(v+1):0;if(55296<=s&&s<=56319&&56320<=w&&w<=57343){s=65536+((s&1023)<<10)+(w&1023);v++}if(s<=127){t+=String.fromCharCode(s)}else{if(s<=2047){t+=String.fromCharCode(192|((s>>>6)&31),128|(s&63))}else{if(s<=65535){t+=String.fromCharCode(224|((s>>>12)&15),128|((s>>>6)&63),128|(s&63))}else{if(s<=2097151){t+=String.fromCharCode(240|((s>>>18)&7),128|((s>>>12)&63),128|((s>>>6)&63),128|(s&63))}}}}}return t}function g(t){var s=Array(t.length>>2);for(var u=0;u<s.length;u++){s[u]=0}for(u=0;u<t.length*8;u+=8){s[u>>5]|=(t.charCodeAt(u/8)&255)<<(u%32)}return s}function r(t){var s="";for(var u=0;u<t.length*32;u+=8){s+=String.fromCharCode((t[u>>5]>>>(u%32))&255)}return s}function l(D,y){D[y>>5]|=128<<((y)%32);D[(((y+64)>>>9)<<4)+14]=y;var C=1732584193;var B=-271733879;var A=-1732584194;var z=271733878;for(var u=0;u<D.length;u+=16){var w=C;var v=B;var t=A;var s=z;C=m(C,B,A,z,D[u+0],7,-680876936);z=m(z,C,B,A,D[u+1],12,-389564586);A=m(A,z,C,B,D[u+2],17,606105819);B=m(B,A,z,C,D[u+3],22,-1044525330);C=m(C,B,A,z,D[u+4],7,-176418897);z=m(z,C,B,A,D[u+5],12,1200080426);A=m(A,z,C,B,D[u+6],17,-1473231341);B=m(B,A,z,C,D[u+7],22,-45705983);C=m(C,B,A,z,D[u+8],7,1770035416);z=m(z,C,B,A,D[u+9],12,-1958414417);A=m(A,z,C,B,D[u+10],17,-42063);B=m(B,A,z,C,D[u+11],22,-1990404162);C=m(C,B,A,z,D[u+12],7,1804603682);z=m(z,C,B,A,D[u+13],12,-40341101);A=m(A,z,C,B,D[u+14],17,-1502002290);B=m(B,A,z,C,D[u+15],22,1236535329);C=b(C,B,A,z,D[u+1],5,-165796510);z=b(z,C,B,A,D[u+6],9,-1069501632);A=b(A,z,C,B,D[u+11],14,643717713);B=b(B,A,z,C,D[u+0],20,-373897302);C=b(C,B,A,z,D[u+5],5,-701558691);z=b(z,C,B,A,D[u+10],9,38016083);A=b(A,z,C,B,D[u+15],14,-660478335);B=b(B,A,z,C,D[u+4],20,-405537848);C=b(C,B,A,z,D[u+9],5,568446438);z=b(z,C,B,A,D[u+14],9,-1019803690);A=b(A,z,C,B,D[u+3],14,-187363961);B=b(B,A,z,C,D[u+8],20,1163531501);C=b(C,B,A,z,D[u+13],5,-1444681467);z=b(z,C,B,A,D[u+2],9,-51403784);A=b(A,z,C,B,D[u+7],14,1735328473);B=b(B,A,z,C,D[u+12],20,-1926607734);C=q(C,B,A,z,D[u+5],4,-378558);z=q(z,C,B,A,D[u+8],11,-2022574463);A=q(A,z,C,B,D[u+11],16,1839030562);B=q(B,A,z,C,D[u+14],23,-35309556);C=q(C,B,A,z,D[u+1],4,-1530992060);z=q(z,C,B,A,D[u+4],11,1272893353);A=q(A,z,C,B,D[u+7],16,-155497632);B=q(B,A,z,C,D[u+10],23,-1094730640);C=q(C,B,A,z,D[u+13],4,681279174);z=q(z,C,B,A,D[u+0],11,-358537222);A=q(A,z,C,B,D[u+3],16,-722521979);B=q(B,A,z,C,D[u+6],23,76029189);C=q(C,B,A,z,D[u+9],4,-640364487);z=q(z,C,B,A,D[u+12],11,-421815835);A=q(A,z,C,B,D[u+15],16,530742520);B=q(B,A,z,C,D[u+2],23,-995338651);C=h(C,B,A,z,D[u+0],6,-198630844);z=h(z,C,B,A,D[u+7],10,1126891415);A=h(A,z,C,B,D[u+14],15,-1416354905);B=h(B,A,z,C,D[u+5],21,-57434055);C=h(C,B,A,z,D[u+12],6,1700485571);z=h(z,C,B,A,D[u+3],10,-1894986606);A=h(A,z,C,B,D[u+10],15,-1051523);B=h(B,A,z,C,D[u+1],21,-2054922799);C=h(C,B,A,z,D[u+8],6,1873313359);z=h(z,C,B,A,D[u+15],10,-30611744);A=h(A,z,C,B,D[u+6],15,-1560198380);B=h(B,A,z,C,D[u+13],21,1309151649);C=h(C,B,A,z,D[u+4],6,-145523070);z=h(z,C,B,A,D[u+11],10,-1120210379);A=h(A,z,C,B,D[u+2],15,718787259);B=h(B,A,z,C,D[u+9],21,-343485551);C=k(C,w);B=k(B,v);A=k(A,t);z=k(z,s)}return Array(C,B,A,z)}function c(A,w,v,u,z,y){return k(p(k(k(w,A),k(u,y)),z),v)}function m(w,v,B,A,u,z,y){return c((v&B)|((~v)&A),w,v,u,z,y)}function b(w,v,B,A,u,z,y){return c((v&A)|(B&(~A)),w,v,u,z,y)}function q(w,v,B,A,u,z,y){return c(v^B^A,w,v,u,z,y)}function h(w,v,B,A,u,z,y){return c(B^(v|(~A)),w,v,u,z,y)}function k(s,v){var u=(s&65535)+(v&65535);var t=(s>>16)+(v>>16)+(u>>16);return(t<<16)|(u&65535)}function p(s,t){return(s<<t)|(s>>>(32-t))}var n=function(t){return o(f(j(t)))};function d(){return n("abc").toLowerCase()=="900150983cd24fb0d6963f7d28e17f72"}e.toMD5=n;e.testMD5=d}};__ngs._46={_c:null,_d:function(){var c={exports:{}};var e=c.exports;this._c=c;var a=__ngs.r_(__ngs._42).Class;var j=__ngs.r_(__ngs._47).NgPipesRemote;var d=__ngs.r_(__ngs._4e).hex_sha1;var g=Object.prototype.hasOwnProperty;var h=__ngs.r_(__ngs._7);var b=__ngs.r_(__ngs._10).KeyValueCache;var f=a.subclass({classname:"NgPipe",initialize:function(o){o=o||{};var l=h.Capabilities;this._socAnalytics=__ngs.r_(__ngs._5x).Social.Common.Analytics;this._meta=o.meta||{};this._queue=null;this._isSendQueued=false;this._sendDelay=o.sendDelay||1000;this.UTCoffset=o.offset||0;this.timeQueue=[];this._meta=o.meta||{};this._seqStart=o.seqStart||new Date().getTime();this._playerState=o.playerState||null;this._seqNumber=o.seqNumber||0;this._allowedLargeValue={msg:1024*5,err:1024*5,sid:64,udid:64,ifv:64,ifa:64,aid:64,tid:64,rid:64,UDID:64,IFV:64,IFA:64,AID:64,TID:64,RID:64};this._waitForUTC=l.meetsBinaryVersion&&l.meetsBinaryVersion("1.3.5.8");this._sendToRemote=true;this._globalKey="__PipeKey";var n=this;var k=function(p,r,q){var t=[];if(!p){try{t=JSON.parse(r)}catch(s){t=[]}}if(n._queue){t=n._queue.concat(t)}n._setQueue(t);if(n._queue.length>0){n._drainQueue()}};this._locListener=null;this._location=null;b.global(this._globalKey).getItem(this._globalKey,{},k);var m=[].concat(o.queue||[]);this._queue=m;this._sessionEnded=false;this._capAlphaNumStringKeys=["afam","asku","srcty","evcl","evid","pltfmsku","carr","srv"];this.sessionStartEvent();this._tagQa();this._hookLifetime();this._hookGeo();return true},close:function(){this._drainQueue();return true},enable:function(){this._sendToRemote=true},disable:function(){this._sendToRemote=false},setRemoteUrl:function(k){j.setUrl(k)},playerEvent:function(k,l,o,n){var m;l||(l="PLST");m={change:o,srcty:"GC",evid:k,evcl:l,plst:this._getPlayerStateDiff(n||this._playerState)};this._queueMessage(m);this._setCurrentPlayerState(n);return m},gameEvent:function(k,n,m){var l;l={evid:k,evpl:n,srcty:"GC",evcl:"GAME"};if(m){l.plst=this._getPlayerStateDiff(m||this._playerState)}this._queueMessage(l);return l},gameOpsEvent:function(k,m){var l;l={evid:k,evpl:m,srcty:"GC",evcl:"GAMEOPS"};this._queueMessage(l);return l},revenueEvent:function(k,m){var l;l={evcl:"REV",evid:k,srcty:"PC",evpl:m};this._queueMessage(l);return l},uiEvent:function(k,m){var l;l={evcl:"UI",srcty:"GC",evid:k,evpl:m};this._queueMessage(l);return l},funnelEvent:function(k,n,m){var l;l={evcl:"FUNNEL",srcty:"GC",evid:k,evpl:n};if(m){l.plst=this._getPlayerStateDiff(m||this._playerState);this._setCurrentPlayerState(m)}this._queueMessage(l);return l},plusEvent:function(l,n,k){var m;m={evcl:"PLUS",srcty:"PC",evid:l,evpl:n};this._queueMessage(m,k);return m},plusUIEvent:function(k,m){var l={evcl:"PLUSUI",srcty:"PC",evid:k,evpl:m};this._queueMessage(l);return l},navigationEvent:function(m,l,k){var n={};n.fro=m;n.to=l;if(k){n.btnid=k}return this.plusUIEvent("NAV",n)},_setUTC:function(m){this.UTCoffset=m?m-new Date().getTime():0;this.UTCready=true;var l=this.timeQueue.length;while(l--){var k=this.timeQueue[l];k.msg.evts=k.time+this.UTCoffset;this._queueMessage(k.msg,k.forThis)}},sessionEndEvent:function(){if(!this.UTCready){this.UTCready=true;var m=this.timeQueue.length;while(m--){var l=this.timeQueue[m];l.msg.evts=l.time;this._queueMessage(l.msg,l.forThis)}}if(!(this._sessionEnded)){var n;var k=h.Capabilities;n={evid:"SFN",evcl:"PLUS",srcty:"PC",hwty:k.getDeviceName(),hwrev:k.getPlatformHW(),osrev:""+k.getPlatformOS()+" "+k.getPlatformOSVersion(),lang:k.getLanguage()};n=this._queueMessage(n);this._sessionEnded=true;return n}return null},sessionStartEvent:function(){var l;var k=h.Capabilities;l={evid:"SST",evcl:"PLUS",srcty:"PC",hwty:k.getDeviceName(),hwrev:k.getPlatformHW(),osrev:""+k.getPlatformOS()+" "+k.getPlatformOSVersion(),lang:k.getLanguage()};l=this._queueMessage(l);this._drainQueue();return l},socialEvent:function(l,k,n){var m;m={evcl:"SOCL",srcty:"GC",frid:k,evid:l,evpl:n};return this._queueMessage(m)},initPlayerState:function(k){this._setCurrentPlayerState(k);return true},updatePlayerState:function(k){this._setCurrentPlayerState(k);return true},reportAdShow:function(k){return this.revenueEvent("ADSHOW",{adid:k})},reportAdClick:function(k){return this.revenueEvent("ADCLCK",{adid:k})},reportPromoShow:function(k){return this.revenueEvent("PROMOSHOW",{promoid:k})},reportPromoClick:function(k){return this.revenueEvent("PROMOCLCK",{promoid:k})},reportPromoRedeem:function(k){return this.revenueEvent("PROMOREDM",{promoid:k})},reportMoneyIAPIntent:function(p,u,n,l,t,m,s,k,r,q){var o={sku:p,itemamt:u,productid:l,dispmsg:k,dispname:t,mobabalance:m,amt:n,cur:r||"USD"};q?o.dynamicdata=q:"";return this.revenueEvent("IAPINTENT",o)},reportMoneyIAPCancel:function(p,u,n,l,t,m,s,k,r,q){var o={sku:p,itemamt:u,productid:l,dispmsg:k,dispname:t,mobabalance:m,amt:n,cur:r||"USD"};q?o.dynamicdata=q:"";return this.revenueEvent("IAPCANCEL",o)},reportMoneyIAPSuccess:function(q,v,o,k,m,u,n,t,l,s,r){var p={sku:q,itemamt:v,orderid:k,productid:m,dispmsg:l,dispname:u,mobabalance:n,amt:o,cur:s||"USD"};r?p.dynamicdata=r:"";return this.revenueEvent("IAPSUCCESS",p)},reportMoneyIAPFail:function(q,v,o,k,m,u,n,t,l,s,r){var p={sku:q,itemamt:v,productid:m,dispmsg:l,dispname:u,mobabalance:n,amt:o,cur:s||"USD"};k?p.orderid=k:"";r?p.dynamicdata=r:"";return this.revenueEvent("IAPFAIL",p)},reportMoneyIAPShow:function(){return this.revenueEvent("IAPSHOW",{})},reportMobaIAPShow:function(){return this.revenueEvent("MOBAIAPSHOW",{})},reportMobaIAPIntent:function(p,m,l,s,n,r,k,q){var o={sku:p,mobaprice:m,productid:l,dispmsg:k,dispname:s,mobabalance:n};q?o.dynamicdata=q:"";return this.revenueEvent("MOBAIAPINTENT",o)},reportMobaIAPCancel:function(p,m,l,s,n,r,k,q){var o={sku:p,mobaprice:m,productid:l,dispmsg:k,dispname:s,mobabalance:n};q?o.dynamicdata=q:"";return this.revenueEvent("MOBAIAPCANCEL",o)},reportMobaIAPSuccess:function(q,n,k,m,t,o,s,l,r){var p={sku:q,mobaprice:n,orderid:k,productid:m,dispmsg:l,dispname:t,mobabalance:o};r?p.dynamicdata=r:"";return this.revenueEvent("MOBAIAPSUCCESS",p)},reportMobaIAPFail:function(q,n,k,m,t,o,s,l,r){var p={sku:q,mobaprice:n,productid:m,dispmsg:l,dispname:t,mobabalance:o};k?p.orderid=k:"";r?p.dynamicdata=r:"";return this.revenueEvent("MOBAIAPFAIL",p)},reportFacebookScrape:function(l,m){var n;var k={};m?k.dynamicdata=m:"";n={evcl:"PLUS",srcty:"PC",extid:l,evid:"FBSCRAPE",evpl:k};this._queueMessage(n);return n},reportContactScrape:function(l){var m;var k={};l?k.dynamicdata=l:"";m={evcl:"PLUS",srcty:"PC",evid:"CONTACTSCRAPE",evpl:k};this._queueMessage(m);return m},reportWallPost:function(k,m){var l;l={evcl:"SOCL",srcty:"PC",frid:k,evid:"WALLPOST",evpl:m};this._queueMessage(l);return l},reportDownload:function(k,n,o){var m={};m.game=k;m.section=n;m.slot=o;var l;l={evcl:"PLUS",srcty:"PC",evid:"DOWNLOAD",evpl:m};this._queueMessage(l);return l},addTag:function(k){var m={};m.tag=k;var l;l={evcl:"PLUS",evid:"TAG",srcty:"PC",evpl:m};this._queueMessage(l);return l},getSeqNumber:function(){this._seqNumber+=1;return this._seqNumber},getQueueCount:function(){return this._queue.length},getSendDelay:function(){return this._sendDelay},setSendDelay:function(k){return(this._sendDelay=k)},setMeta:function(k,l){if(!l){l=k;return(this._meta=l)}else{return(this._meta[k]=l)}},getMeta:function(k){if(k){return this._meta[k]}else{return this._meta}},_queueMessage:function(o,n){if(!o){return false}var l=__ngs.r_(__ngs._7).Capabilities;if(this._waitForUTC&&!this.UTCready){this.timeQueue.unshift({msg:o,time:new Date().getTime(),forThis:n});return true}var m=this;this._setUnsetMetaKeys();o.evts=o.evts||this._getUTCTime();o=this._mergeMeta(o);o=this._addSeqDetails(o);o=this._addGeo(o);o=this._addGameSku(o,n);o=this._addGameRel(o);o=this._addCarrier(o);o=this._addService(o);o=this._addPlatformVersion(o);o=this._addUserId(o);o=this._addUserName(o);o.avalue=l._getDeviceIds();o=this._normalizeValues(o);var k=this._getQueue();k.push(o);this._setQueue(k);if(!this._isSendQueued){setTimeout(function(){m._isSendQueued=false;return m._drainQueue()},m._sendDelay)}return o},_tagQa:function(){var k=__ngs.r_(__ngs._d).FileSystem;var l=this;k.readFile("QA",{},function(m,n){if(!m){l.addTag("NGMOCOQA")}})},_hookGeo:function(){var o=__ngs.r_(__ngs._5x).Social;if(o.US){var n=__ngs.r_(__ngs._w).MessageListener;var m=__ngs.r_(__ngs._4).Device,l=this;var k=n.subclass({initialize:function(){m.LocationEmitter.addListener(this,this.onUpdate,false)},onUpdate:function(p){l._location=p;m.LocationEmitter.removeListener(this);l._locListener=null}});this._locListener=new k()}},_hookLifetime:function(){var l=this;var n=__ngs.r_(__ngs._w).MessageListener;var m=__ngs.r_(__ngs._4).Device;var k=n.subclass({initialize:function(){m.LifecycleEmitter.addListener(this,this.onLifecycleUpdate)},onLifecycleUpdate:function(o){switch(o){case m.LifecycleEmitter.Event.Suspend:case m.LifecycleEmitter.Event.Terminate:l.sessionEndEvent();l._drainQueue();break}}});if(!this._listener){this._listener=new k()}},_setSocialAnalytics:function(k){this._socAnalytics=k},_setUnsetMetaKeys:function(){var k=__ngs.r_(__ngs._7).Capabilities;if(!this.getMeta("sid")){var m=""+d(this._seqStart+k.getUniqueId());this.setMeta("sid",m)}if(!this.getMeta("pltfmsku")){var l=/android/;var n=k.getPlatformOS();if(n){n=n.toLowerCase();if(n.match(l)){n="android"}else{if("flash"===n){n="flash"}else{n="ios"}}this.setMeta("pltfmsku",n)}}if(!this.getMeta("apiver")){this.setMeta("apiver",5)}return true},_getPlayerStateDiff:function(p){var m,k,o,l,n;o={};if(!this._playerState){this._setCurrentPlayerState(p)}for(l in p){if(!g.call(p,l)){continue}n=p[l];if(typeof n==="number"){k=(n-this._playerState[l])||0;if(k<0){m="-"}if(k>=0){m="+"}o[l]=""+m+","+Math.abs(k)+","+(this._playerState[l])}else{if(typeof n==="string"){o[l]=n}}}return o},_setCurrentPlayerState:function(l){var k,m;this._playerState={};for(k in l){if(!g.call(l,k)){continue}m=l[k];this._playerState[k]=m}return true},_getUTCTime:function(){return new Date().getTime()+this.UTCoffset},_addGeo:function(l){var k;if(this._location&&(k=this._location.getPosition())&&!isNaN(k.getX())&&!isNaN(k.getY())){l.geo=""+k.getX()+","+k.getY()}return l},_addCarrier:function(m){var l=h.Capabilities;var k=l.getCarrier();if(k){m.carr=k}return m},_addService:function(l){var k=this._socAnalytics;l.srvc=k.getServiceId();return l},_addPlatformVersion:function(l){var k=this._socAnalytics;l.pver=k.getPlatformVersion();return l},_addSeqDetails:function(k){this._seqNum+=1;k.seq=this.getSeqNumber();k.seqdt=new Date().getTime()-this._seqStart;return k},_addUserId:function(m){var k=this._socAnalytics;var l=k.getUserId();if(l){m.uid=l}return m},_addUserName:function(m){var l=this._socAnalytics;var k=l.getUsername();if(k){m.plus=k}return m},_addGameSku:function(m,k){var l=k||(Capabilities.getConfigs()||{})["appId"];if(l){m.asku=l}return m},_addGameRel:function(l){var k=Capabilities.getAppReleaseVersion();if(k){l.arel=k}return l},_normalizeValues:function(m){var k,l;for(k in m){if(!g.call(m,k)){continue}l=m[k];if(typeof l==="string"){l=this._normalizeString(k,l)}else{if(typeof l==="object"){l=this._normalizeValues(l)}}m[k]=l}return m},_normalizeString:function(k,l){l=l.substring(0,this._allowedLargeValue[k]||32);if(-1!==this._capAlphaNumStringKeys.indexOf(k)){l=l.toUpperCase().replace(/[^\w]+/g,"").replace("_","")}return l},_mergeMeta:function(o){var n,p,l,k,m;k={};for(l in o){if(!g.call(o,l)){continue}m=o[l];k[l]=m}n=this._meta;for(l in n){if(!g.call(n,l)){continue}m=n[l];(p=k[l])?p:k[l]=m}return k},_drainQueue:function(){var k,l,m;m=this._getQueue();this._setQueue([]);l=this;if(!this._sendToRemote){return true}k=function(o,n){if(o===j.possibleStates.error){l._queueMany(n);l._storeQueue();l._sendDelay=l._sendDelay*2}else{if(o===j.possibleStates.finished){l._sendDelay=1000}}return true};j.clearQueue(m,k);m=null;return true},_exitingApp:function(){this.sessionEndEvent();this._drainQueue()},_queueMany:function(k){var n,l,o,m=this;this._setQueue((this._getQueue()||[]).concat(k));if(this._isSendQueued){this._isSendQueued=true;setTimeout(function(){m._isSendQueued=false;return m._drainQueue()},m._sendDelay)}return true},_setQueue:function(k){this._queue=k;return true},_storeQueue:function(){b.global(this._globalKey).setItem(this._globalKey,JSON.stringify(this._queue),{})},_getQueue:function(){return this._queue}});e.NgPipe=f}};__ngs._47={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var c=__ngs.r_(__ngs._s).Network;var a=0;var e={listeners:[],debug:false,possibleStates:{unknown:{ngPipesRemote:"unknown"},finished:{ngPipesRemote:"finished"},error:{ngPipesRemote:"error"}}};e.addListener=function(f){this.listeners.push(f);return true};e.clearQueue=function(g,m){if(!g){return false}if(!this.getUrl()){if(m){m(e.possibleStates.finished,[])}return false}var h=g.slice(0,g.length);var k,f,l;while(h&&h.length>0){var j=h.slice(0,10);h=h.slice(10);l="";for(k=0,f=j.length;k<f;k++){l+=JSON.stringify(j[k]);if(k+1<f){l+="\r\n"}}if(l){e._makeRequest(l,j,m)}}};e._makeRequest=function(k,l,m){var j=new c.XHR(),h=this.getUrl();if(this.debug){e._debugOutput(k)}a++;var g="pipe"+a;var f=__ngs.r_(__ngs._11).LifecycleEmitter;f.requestEngineKeepAlive(g);j.onreadystatechange=function(){var n=null;try{if(this.readyState===4){f.cancelEngineKeepAlive(g);n=e._handleResponse(j.responseText)}else{n=e.possibleStates.unknown}}catch(o){n=e.possibleStates.error;NgLogException(o)}if(m){m(n,l)}e._notifyListeners(n);return true};j.open("POST",h,true);j.setRequestHeader("X-Ngpipes-Api","1.0");j.setRequestHeader("Content-Type","application/json+batch");j.setRequestHeader("If-None-Match","0");j.send(k);e._notifyListeners("started");return true};e.setUrl=function(f){this.url=f};e.getUrl=function(){if(this.url){return this.url}var f=__ngs.r_(__ngs._7).Capabilities;var g=null;if(f){g=(f.getConfigs()||{})["analyticsServer"]||null;if(g){g="https://"+g+"/pipes/r.2/bulk_record_stats";if(this.debug){NgLogD("Pipes URL => "+g)}}}return g};e._handleResponse=function(g){var j,f;f=e.possibleStates.unknown;if(g&&g.length>0){try{j=JSON.parse(g)}catch(h){j=null}if(j&&(j.success!==null&&j.success!==undefined)&&j.success){if(this.debug){NgLogD("[NgPipesRemote] Got Success")}f=e.possibleStates.finished}else{f=e.possibleStates.error}}else{if(this.debug){NgLogD("[NgPipesRemote] ERROR posting")}f=e.possibleStates.error}return f};e._debugOutput=function(l){var j,f,g,k,h;h=l.split("\r\n");for(j=0,f=h.length;j<f;j++){k=h[j];NgLogD("[NgPipesRemote] Message sent: "+k)}return false};e._notifyListeners=function(k){var j,g,h,f;for(j=0,g=(h=this.listeners).length;j<g;j++){f=h[j];f(k)}return true};b.NgPipesRemote=e}};__ngs._48={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var b=__ngs.r_(__ngs._42).Class;var a=__ngs.r_(__ngs._6b).Pool;var f;var d=function(g,j,h){if(g!==undefined){if(j!==undefined){if(h!==undefined){this._red=g;this._green=j;this._blue=h}else{throw new Error("Wrong number of arguments for a Color")}}else{if(g instanceof f){this._red=g._red;this._green=g._green;this._blue=g._blue}else{d.apply(this,g)}}}else{this._red=1;this._green=1;this._blue=1}};f=c.Color=b.subclass({classname:"Color",initialize:d,setAll:d,getRed:function(){return this._red},getGreen:function(){return this._green},getBlue:function(){return this._blue},setRed:function(g){this._red=g;return this},setGreen:function(g){this._green=g;return this},setBlue:function(g){this._blue=g;return this}});c.Color.pool=a.create(c.Color,500)}};__ngs._49={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=__ngs.r_(__ngs._42).Class;var a=__ngs.r_(__ngs._6b).Pool;c.Vector=b.subclass({classname:"Vector",initialize:function(){switch(arguments.length){case 0:this._x=0;this._y=0;break;case 1:var e=arguments[0];if(e===undefined){this._x=0;this._y=0}else{if(!e.hasOwnProperty("length")){this._x=e.getX();this._y=e.getY()}else{switch(e.length){case 0:this._x=0;this._y=0;break;case 1:e=e[0];this._x=e.getX();this._y=e.getY();break;case 2:this._x=e[0];this._y=e[1];break;default:throw new Error("Wrong number of arguments for a Vector")}}}break;case 2:this._x=arguments[0];this._y=arguments[1];break;default:throw new Error("Wrong number of arguments for a Vector")}},setAll:function(){this.constructor.apply(this,arguments);return this},clone:function(){return new this.constructor(this)},getX:function(){return this._x},setX:function(e){this._x=e;return this},getY:function(){return this._y},setY:function(e){this._y=e;return this}});c.Vector.pool=a.create(c.Vector,500)}};__ngs._4a={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var b=__ngs.r_(__ngs._42).Class;var a=__ngs.r_(__ngs._6b).Pool;var f;var d=function(h,g){if(h!==undefined){if(g!==undefined){this._x=h;this._y=g}else{if(typeof h==="object"&&h.getX&&h.getY){this._x=h.getX();this._y=h.getY()}else{d.apply(this,h)}}}else{this._x=0;this._y=0}return this};f=c.Point=b.subclass({classname:"Point",initialize:d,setAll:d,clone:function(){return new this.constructor(this)},getX:function(){return this._x},setX:function(g){this._x=g;return this},getY:function(){return this._y},setY:function(g){this._y=g;return this}});c.Point.pool=a.create(c.Point,500)}};__ngs._4b={_c:null,_d:function(){var f={exports:{}};var d=f.exports;this._c=f;var c=__ngs.r_(__ngs._42).Class;var b=__ngs.r_(__ngs._6b).Pool;var a;var e=function(h,g){if(h!==undefined){if(g!==undefined){this._width=h;this._height=g}else{if(h instanceof a){this._width=h.getWidth();this._height=h.getHeight()}else{e.apply(this,h)}}}else{this._width=0;this._height=0}return this};a=d.Size=c.subclass({classname:"Size",initialize:e,setAll:e,clone:function(){return new this.constructor(this)},getWidth:function(){return this._width},setWidth:function(g){this._width=g;return this},getHeight:function(){return this._height},setHeight:function(g){this._height=g;return this}});d.Size.pool=b.create(d.Size,500)}};__ngs._4c={_c:null,_d:function(){var g={exports:{}};var d=g.exports;this._c=g;var c=__ngs.r_(__ngs._42).Class;var h=__ngs.r_(__ngs._4a).Point;var b=__ngs.r_(__ngs._4b).Size;var a=__ngs.r_(__ngs._6b).Pool;var f;var e=function(l,k,j,m){this._origin=this._origin||h.pool.get();this._size=this._size||b.pool.get();if(l!==undefined){if(k!==undefined){if(j!==undefined){if(m!==undefined){this._origin._x=l;this._origin._y=k;this._size._width=j;this._size._height=m}else{throw new Error("Wrong number of arguments for a Rect")}}else{this._origin.setAll(l);this._size.setAll(k)}}else{if(l instanceof f){this._origin._x=l._origin._x;this._origin._y=l._origin._y;this._size._width=l._size._width;this._size._height=l._size._height}else{e.apply(this,l)}}}else{this._origin._x=0;this._origin._y=0;this._size._width=0;this._size._height=0}return this};f=d.Rect=c.subclass({classname:"Rect",initialize:e,setAll:e,clone:function(){return new this.constructor(this)},getOrigin:function(){return this._origin},setOrigin:function(j){this._origin.setAll(j);return this},setOriginCentered:function(j){j=h.pool.get(j);this._origin.setX(j.getX()-this._size.getWidth()/2);this._origin.setY(j.getY()-this._size.getHeight()/2);h.pool.put(j);return this},getSize:function(){return this._size},setSize:function(j){this._size.setAll(j);return this},setSizeCentered:function(k){var j=this._size.getWidth();var l=this._size.getHeight();this._size.setAll(k);this._origin.setX(this._origin.getX()+j/2-this._size.getWidth()/2);this._origin.setY(this._origin.getY()+l/2-this._size.getHeight()/2);return this},getMinX:function(){return this._origin.getX()},getMidX:function(){return this._origin.getX()+this._size.getWidth()/2},getMaxX:function(){return this._origin.getX()+this._size.getWidth()},getMinY:function(){return this._origin.getY()},getMidY:function(){return this._origin.getY()+this._size.getHeight()/2},getMaxY:function(){return this._origin.getY()+this._size.getHeight()}});d.Rect.pool=a.create(d.Rect,100)}};__ngs._4d={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var e=__ngs.r_(__ngs._6).Proc;var a=__ngs.r_(__ngs._42).Class;var c=__ngs.r_(__ngs._44).MessageListener;b.MessageEmitter=a.subclass({classname:"MessageEmitter",initialize:function(){this._messageListenersCount=0;this._messageListenerRecords=[];this._messageDeferredWork=[];this._messageShouldDefer=false},destroy:function($super){if(this._messageShouldDefer){this._messageDeferredWork.push(this._destroyActual.bind(this,$super))}else{this._destroyActual($super)}},_destroyActual:function(g){var f=this._messageListenerRecords;while(f.length){this.removeListener(f[0].l)}if(g){g()}},getListenerCount:function(){return this._messageListenersCount},addListener:function(h,g,f){if(!h instanceof c){throw new Error("MessageEmitter.addListener: listener must be instances of MessageListener")}if(!h._startListeningEmitter(this)){throw new Error("MessageEmitter.addListener: listener is already listening")}if(!f){f=0}this._messageListenersCount++;if(this._messageShouldDefer){this._messageDeferredWork.push(this._addListenerActual.bind(this,h,g,f))}else{this._addListenerActual(h,g,f)}},_addListenerActual:function(l,k,j){if((typeof j)=="undefined"){j=0}var g=this._messageListenerRecords;var f=g.length;for(var h=0;h<f;++h){if(g[h].p<=j){break}}g.splice(h,0,{l:l,f:k,p:j})},removeListener:function(k){if(!k._stopListeningEmitter(this)){return false}this._messageListenersCount--;if(this._messageShouldDefer){var h=this._messageListenerRecords;var f=h.length;for(var j=0;j<f;++j){var g=h[j];if(g.l==k){g.f=null;break}}this._messageDeferredWork.push(this._removeListenerActual.bind(this,k))}else{this._removeListenerActual(k)}return true},_removeListenerActual:function(k){var h=this._messageListenerRecords;var f=h.length;for(var j=0;j<f;++j){var g=h[j];if(g.l==k){h.splice(j,1);break}}},emit:function(g){var f=false;if(this._messageShouldDefer){this._messageDeferredWork.push(this._emitActual.bind(this,arguments,false))}else{f=this._emitActual(arguments,true)}return f},_emitActual:function(m,k){this._messageShouldDefer=true;var h=this._messageListenerRecords;var f=h.length;var l=false;for(var j=0;j<f;++j){var g=h[j];if(!g.f){continue}if(g.f.apply(g.l,m)){l=true}}this._messageShouldDefer=false;if(this._messageDeferredWork.length&&k){this._executeDeferred()}return l},chain:function(f){if(this._messageShouldDefer){this._messageDeferredWork.push(this._chainActual.bind(this,arguments,false));return undefined}else{return this._chainActual(arguments,true)}},_chainActual:function(m,l){var g=false;this._messageShouldDefer=true;var j=this._messageListenerRecords;var f=j.length;for(var k=0;k<f;++k){var h=j[k];if(!h.f){continue}if(h.f.apply(h.l,m)){g=true;break}}this._messageShouldDefer=false;if(this._messageDeferredWork.length&&l){this._executeDeferred()}return g},_executeDeferred:function(){var f=this._messageDeferredWork;for(var g=0;g<f.length;++g){f[g]()}this._messageDeferredWork=[]}})}};__ngs._4e={_c:null,_d:function(){var b={exports:{}};var w=b.exports;this._c=b;
/*!
	Version 2.1a Copyright Paul Johnston 2000 - 2002.
	Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet.
	Distributed under the BSD License.
	See http://pajhome.org.uk/crypt/md5 for details.
*/
var q=0;var v="";var d=8;function r(z,C){var B=(z&65535)+(C&65535);var A=(z>>16)+(C>>16)+(B>>16);return(A<<16)|(B&65535)}function p(x,y){return(x<<y)|(x>>>(32-y))}function t(y,x,A,z){if(y<20){return(x&A)|((~x)&z)}if(y<40){return x^A^z}if(y<60){return(x&A)|(x&z)|(A&z)}return x^A^z}function m(x){return(x<20)?1518500249:(x<40)?1859775393:(x<60)?-1894007588:-899497514}function f(L,F){L[F>>5]|=128<<(24-F%32);L[((F+64>>9)<<4)+15]=F;var M=Array(80);var K=1732584193;var J=-271733879;var I=-1732584194;var H=271733878;var G=-1009589776;for(var C=0;C<L.length;C+=16){var E=K;var D=J;var B=I;var A=H;var y=G;for(var z=0;z<80;z++){if(z<16){M[z]=L[C+z]}else{M[z]=p(M[z-3]^M[z-8]^M[z-14]^M[z-16],1)}var N=r(r(p(K,5),t(z,J,I,H)),r(r(G,M[z]),m(z)));G=H;H=I;I=p(J,30);J=K;K=N}K=r(K,E);J=r(J,D);I=r(I,B);H=r(H,A);G=r(G,y)}return Array(K,J,I,H,G)}function u(A){var z=[];var x=(1<<d)-1;for(var y=0;y<A.length*d;y+=d){z[y>>5]|=(A.charCodeAt(y/d)&x)<<(32-d-y%32)}return z}function h(z,C){var B=u(z);if(B.length>16){B=f(B,z.length*d)}var x=Array(16),A=Array(16);for(var y=0;y<16;y++){x[y]=B[y]^909522486;A[y]=B[y]^1549556828}var D=f(x.concat(u(C)),512+C.length*d);return f(A.concat(D),512+160)}function s(z){var A="";var x=(1<<d)-1;for(var y=0;y<z.length*32;y+=d){A+=String.fromCharCode((z[y>>5]>>>(32-d-y%32))&x)}return A}function k(z){var y=q?"0123456789ABCDEF":"0123456789abcdef";var A="";for(var x=0;x<z.length*4;x++){A+=y.charAt((z[x>>2]>>((3-x%4)*8+4))&15)+y.charAt((z[x>>2]>>((3-x%4)*8))&15)}return A}function o(A){var z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var C="";for(var y=0;y<A.length*4;y+=3){var B=(((A[y>>2]>>8*(3-y%4))&255)<<16)|(((A[y+1>>2]>>8*(3-(y+1)%4))&255)<<8)|((A[y+2>>2]>>8*(3-(y+2)%4))&255);for(var x=0;x<4;x++){if(y*8+x*6>A.length*32){C+=v}else{C+=z.charAt((B>>6*(3-x))&63)}}}return C}function l(x){return k(f(u(x),x.length*d))}function j(x){return o(f(u(x),x.length*d))}function e(x){return s(f(u(x),x.length*d))}function n(x,y){return s(h(x,y))}function c(x,y){return k(h(x,y))}function g(x,y,z){if((typeof z!="undefined")&&z){v=z}return o(h(x,y))}function a(){return l("abc")=="a9993e364706816aba3e25717850c26c9cd0d89d"}if((typeof w!="undefined")&&w){w.b64_hmac_sha1=g;w.hex_sha1=l;w.b64_sha1=j}}};__ngs._4f={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._42).Class;var d=a.subclass({classname:"Bytes",initialize:function(e){var h,g,f,l,k;this._blockSize=4*1024;this._hasTypedArray=(typeof Uint8Array!=="undefined");this._offset=0;this._length=0;this.__defineGetter__("length",function(){if(this._hasTypedArray){return this._length}return this._bytes.length});if(this._hasTypedArray){this._bytes=[];if(typeof(e)==="object"){if(e instanceof d){this._bytes.length=e._bytes._length;this._length=e.length;for(h=0;h<_bytes.length;++h){this._bytes.push(new Uint8Array(e._bytes[h]))}}else{if(e instanceof Array){this._length=e.length;f=0;for(h=0;h<this._getRequiredNumBlocks(e.length);++h){l=new Uint8Array(this._blockSize);k=this._length-f;if(k>this._blockSize){k=this._blockSize}for(g=0;g<k;++g){l[g]=e[f+g]}f+=k;this._bytes.push(l)}}else{this._bytes.push(new Uint8Array(this._blockSize))}}}else{if(typeof(e)==="string"){this._length=e.length;f=0;for(h=0;h<this._getRequiredNumBlocks(e.length);++h){l=new Uint8Array(this._blockSize);k=this._length-f;if(k>this._blockSize){k=this._blockSize}for(g=0;g<k;++g){l[g]=e.charCodeAt(f+g)}f+=k;this._bytes.push(l)}}else{this._bytes.push(new Uint8Array(this._blockSize))}}}else{NgLogD("Core.Buffer: typed-array is not available");if(typeof(e)=="object"){if(e instanceof d){this._bytes=e._bytes}else{if(e instanceof Array){this._bytes=String.fromCharCode.apply(null,e)}else{this._bytes=""}}}else{if(typeof(e)=="string"){this._bytes=e}else{this._bytes=""}}}},set:function(e,g){if(this._hasTypedArray){var f=this._getLocation(e);this._bytes[f.block][f.offset]=g;return}throw"set() method is not supported"},get:function(e){if(this._hasTypedArray){var f=this._getLocation(e);return this._bytes[f.block][f.offset]}return this._bytes.charCodeAt(e)},append:function(f){var e;if(!this._isBinary(f)){NgLogE("cannot append non-binary data");return}if(this._hasTypedArray){var h=this._getLocation(this._length);var j;var g=h.offset;if(h.block===this._bytes.length){j=new Uint8Array(this._blockSize);this._bytes.push(j);if(g!==0){NgLogE("invalid offset");g=0}}else{j=this._bytes[h.block]}for(e=0;e<f.length;++e){if(g===this._blockSize){j=new Uint8Array(this._blockSize);this._bytes.push(j);g=0}if(typeof f==="string"){j[g]=f.charCodeAt(e)}else{if(f instanceof d){j[g]=f.get(e)}else{j[g]=f[e]}}this._length++;g++}return}if(typeof f==="string"){this._bytes+=f}else{if(f instanceof d){this._bytes+=f.toString()}else{this._bytes+=String.fromCharCode.apply(null,f)}}},remove:function(f,h){var e;var g;var j=(h==="string")?"":((h==="array")?[]:undefined);if(this._hasTypedArray){while(f>0){var k=f;g=[];if(k>=this._blockSize-this._offset){k=this._blockSize-this._offset}if(j!==undefined){for(e=0;e<k;++e){g.push(this._bytes[0][this._offset+e])}if(typeof j==="string"){j=j.concat(String.fromCharCode.apply(null,g))}else{j=j.concat(g)}}this._offset+=k;if(this._offset===this._blockSize){this._offset=0;if(this._bytes.length>1){this._bytes.shift()}}this._length-=k;f-=k}}else{if(j!==undefined){g=this._bytes.slice(0,f);this._bytes=this._bytes.slice(f);if(typeof j==="string"){j=g}else{j=[];for(e=0;e<g.length;++e){j.push(g.charCodeAt(e))}}}}return j},toString:function(){if(this._hasTypedArray){var e=[];var g=0;var f=this._offset;for(i=0;i<this._length;++i){e.push(this._bytes[g][f]);f++;if(f===this._blockSize){f=0;g++}}return String.fromCharCode.apply(null,e)}return this._bytes},forEach:function(e,g){var k;var m;if(this._hasTypedArray){var l=0;var h=this._offset;for(k=0;k<this._length;++k){m=e.call(g,this._bytes[l][h],k,this);if(typeof m==="number"){this._bytes[l][h]=m}else{if(m===null){break}}h++;if(h===this._blockSize){h=0;l++}}}else{var f=[];var j=false;console.log("forEach: this._length="+this._length);for(k=0;k<this._bytes.length;++k){m=e.call(g,this._bytes.charCodeAt(k),k,this);if(typeof m==="number"){j=true;f.push(m)}else{if(m===null){break}f.push(this._bytes.charCodeAt(k))}}if(j){this._bytes=String.fromCharCode.apply(null,f)}}},slice:function(k,f){var j;var e;var g=[];if(this._hasTypedArray){var h=f-k;var m=this._getLocation(k);while(h>0){var l=this._bytes[m.block];while(h>0){g.push(l[m.offset]);m.offset++;h--;if(m.offset===ths._blockSize){m.offset=0;m.block++;l=this._bytes[m.block]}}}e=new d(g)}else{e=new d(this._bytes.slice(k,f))}return e},clear:function(){if(this._hasTypedArray){this._length=0;this._offset=0;this._bytes=[new Uint8Array(this._blockSize)]}else{this._bytes=""}},_isBinary:function(f){var e,g;if(typeof f==="string"){for(e=0;e<f.length;++e){g=f.charCodeAt(e);if(g<0&&g>=256){return false}}}else{if(!(f instanceof d)){for(e=0;e<f.length;++e){g=f[e];if(g<0&&g>=256){return false}}}}return true},_getRequiredNumBlocks:function(f){var e=Math.floor(f/this._blockSize);if(e===0||f%this._blockSize>0){e++}return e},_getLocation:function(e){var f={};var g=this._offset+e;f.block=Math.floor(g/this._blockSize);f.offset=(f.block>0)?g%(this._blockSize*(f.block)):g;return f}});b.Buffer=a.subclass({classname:"Buffer",initialize:function(){this._log2=function(e){return Math.floor(Math.log(e)/Math.LN2)};this._toIEEE754=function(k,e,g){var j;var f;switch(g){case 32:j=8;f=23;break;case 64:j=11;f=52;break;default:throw"Invalid bit width"}var h=Math.pow(2,j-1)-1;e.neg=(k<0)?1:0;e.expo=0;e.sigd=0;k=Math.abs(k);if(isNaN(k)){e.neg=0;e.expo=0;e.sigd=1}else{if(!isFinite(k)){e.expo=Math.pow(2,j)-1;e.sigd=0}else{if(k===0){e.expo=0;e.sigd=0}else{e.expo=this._log2(k);if(e.expo<(1-h)||(e.expo==(1-h)&&k<Math.pow(2,(1-h)))){e.sigd=Math.round((k/Math.pow(2,(1-h)))*Math.pow(2,f));e.expo=0}else{e.sigd=Math.round((k/Math.pow(2,e.expo)-1)*Math.pow(2,f));e.expo+=h}}}}};this._fromIEEE754=function(e,g){var j;var f;switch(g){case 32:j=8;f=23;break;case 64:j=11;f=52;break;default:throw"Invalid bit width"}var h=Math.pow(2,j-1)-1;if(e.expo===0){if(e.sigd===0){return 0}return e.neg*e.sigd*Math.pow(2,(1-h)-f)}if(e.expo==Math.pow(2,j)-1){if(e.sigd===0){return e.neg*Number.POSITIVE_INFINITY}return NaN}return e.neg*(1+e.sigd*Math.pow(2,-f))*Math.pow(2,e.expo-h)};this._array2val=function(f,e){var h=0;if(e){f.reverse()}for(var g=0;g<f.length;++g){h+=f[g]*Math.pow(2,(f.length-g-1)*8)}return h};this._array2str=function(f,e){if(e){f.reverse()}return String.fromCharCode.apply(String,f)};if(arguments[0] instanceof b.Buffer){this._bytes=new d(arguments[0]._bytes)}else{this._bytes=new d(arguments[0])}this.__defineGetter__("length",function(){return this._bytes.length})},getSize:function(){return this._bytes.length},readUint8:function(){if(this._bytes.length<1){return NaN}return this._bytes.remove(1,"array")[0]},readUint16:function(e){if(this._bytes.length<2){return NaN}return this._array2val(this._bytes.remove(2,"array"),e)},readUint32:function(e){if(this._bytes.length<4){return NaN}return this._array2val(this._bytes.remove(4,"array"),e)},readInt8:function(){var e=this.readUint8();if(e>>>7){return e-256}return e},readInt16:function(e){var f=this.readUint16(e);if(f>>>15){return f-65536}return f},readInt32:function(e){var f=this.readUint32(e);if(f>>>31){return f-4294967296}return f},readFloat64:function(f){if(this._bytes.length<8){return NaN}var e=this._bytes.remove(8,"array");if(f){e.reverse()}var g={neg:1-(2*(e[0]>>7)),expo:(((e[0]<<1)&255)<<3)|(e[1]>>4),sigd:((e[1]&15)*281474976710656)+(e[2]*1099511627776)+(e[3]*4294967296)+(e[4]*16777216)+(e[5]*65536)+(e[6]*256)+e[7]};return this._fromIEEE754(g,64)},readFloat32:function(f){if(this._bytes.length<4){return NaN}var e=this._bytes.remove(4,"array");if(f){e.reverse()}var g={neg:1-(2*(e[0]>>7)),expo:(((e[0]<<1)&255)|(e[1]>>7))&65535,sigd:((e[1]&127)*65536)+(e[2]*256)+e[3]};return this._fromIEEE754(g,32)},readBytes:function(e){if(e>this._bytes.length){e=this._bytes.length}return this._bytes.remove(e,"string")},writeUint8:function(e){this._bytes.append([e])},writeUint16:function(g,e){var f=[g>>>8,g&255];if(e){f.reverse()}this._bytes.append(f)},writeUint32:function(g,e){var f=[(g>>>24)&255,(g>>>16)&255,(g>>>8)&255,g&255];if(e){f.reverse()}this._bytes.append(f)},writeInt8:function(e){if(e<-128||e>127){throw new Error("Invalid argument")}if(e<0){e=256+e}this.writeUint8(e)},writeInt16:function(f,e){if(f<-32768||f>32767){throw new Error("Invalid argument")}if(f<0){f=65536+f}this.writeUint16(f,e)},writeInt32:function(f,e){if(f<-2147483648||f>2147483647){throw new Error("Invalid argument")}if(f<0){f=4294967296+f}this.writeUint32(f,e)},writeFloat64:function(j,e){var h={};this._toIEEE754(j,h,64);var g=Math.floor(h.sigd/4294967296);var k=h.sigd%4294967296;var f=[(h.neg<<7)|(h.expo>>4),(h.expo&15)<<4|((g>>16)&15),(g>>8)&255,g&255,(k>>>24)&255,(k>>>16)&255,(k>>>8)&255,k&255];if(e){f.reverse()}this._bytes.append(f)},writeFloat32:function(h,e){var g={};this._toIEEE754(h,g,32);var f=[(g.neg<<7)|(g.expo>>>1),((g.expo<<7)&255)|((g.sigd>>16)&127),(g.sigd>>8)&255,g.sigd&255];if(e){f.reverse()}this._bytes.append(f)},writeBytes:function(e){if(e instanceof b.Buffer){this._bytes.append(e._bytes)}else{this._bytes.append(e)}},toString:function(){return this._bytes.toString()},clear:function(){this._bytes.clear()},clone:function(){return new b.Buffer(this)},slice:function(f,e){return new b.Buffer(this._bytes.slice(f,e))},get:function(e){return this._bytes.get(e)},forEach:function(e,f){this._bytes.forEach(e,f)}})}};__ngs._4g={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=(function(){var e=function(j){var f="";for(var g=0;g<j.length;g++){var h=j.charCodeAt(g);if(h<=127){f+=String.fromCharCode(h)}else{if(h<2048){f+=String.fromCharCode(((h>>>6)&31)|192);f+=String.fromCharCode((h&63)|128)}else{if(h<=55295||h>=57344){f+=String.fromCharCode(((h>>>12)&15)|224);f+=String.fromCharCode(((h>>>6)&63)|128);f+=String.fromCharCode((h&63)|128)}else{h=(((h-55296)<<10)|(j.charCodeAt(++g)-56320))+65536;f+=String.fromCharCode(((h>>>18)&7)|240);f+=String.fromCharCode(((h>>>12)&63)|128);f+=String.fromCharCode(((h>>>6)&63)|128);f+=String.fromCharCode((h&63)|128)}}}}return f};var d=function(f){var j="";var g=0;var k=[0,0,0,0,0,0];var h;while(g<f.length){k[0]=f.charCodeAt(g++);if(k[0]<128){j+=String.fromCharCode(k[0])}else{if((k[0]>=192)&&(k[0]<224)){k[1]=f.charCodeAt(g++);h=((k[0]&31)<<6)|(k[1]&63)}else{if((k[0]>=224)&&(k[0]<240)){k[1]=f.charCodeAt(g++);k[2]=f.charCodeAt(g++);h=((k[0]&15)<<12)|((k[1]&63)<<6)|(k[2]&63)}else{k[1]=f.charCodeAt(g++);k[2]=f.charCodeAt(g++);k[3]=f.charCodeAt(g++);h=(((k[0]&7)<<18)|((k[1]&63)<<12)|((k[2]&63)<<6)|(k[3]&63))-65536;j+=String.fromCharCode(((h&1047552)>>>10)+55296);h=(h&1023)+56320}}j+=String.fromCharCode(h)}}return j};return{encode:e,decode:d}})();a.UTF8=c}};__ngs._4h={_c:null,_d:function(){var f={exports:{}};var d=f.exports;this._c=f;var c=__ngs.r_(__ngs._24).Element;var b=__ngs.r_(__ngs._22).Commands;var e={normal:b.State.Normal,focused:b.State.Focused,selected:b.State.Selected,pressed:b.State.Pressed,disabled:b.State.Disabled};var a=d.Style=c.subclass({type:"style",classname:"UI_Style",initialize:function($super,g){if(a._init){a._init()}$super(g)},$synthesizePropertyWithState:function(l,k){function g(m,q,o){var n="get"+m;var r="set"+m;var s=function(){return this[n].call(this,o)};var p=function(t){return this[r].call(this,t,o)};this.registerAccessors(q+m,s,p)}c.synthesizePropertyWithState.call(this,l,k);var h=l.charAt(0).toUpperCase()+l.substr(1);for(var j in e){g.call(this,h,j,e[j])}}});a._init=function(){delete a._init;if(c._init){c._init()}a.synthesizePropertyWithState("gradient",b.setGradient);a.synthesizePropertyWithState("image",b.setImage);a.synthesizePropertyWithState("imageBorder",b.setImageBorder);a.synthesizeProperty("imageFit",b.setImageFitMode);a.synthesizeCompoundProperty("imageInsets",b.setImageInsets);a.synthesizeCompoundProperty("imageGravity",b.setImageGravity);a.synthesizeCompoundProperty("imageTransform",b.setImageTransform);a.synthesizePropertyWithState("text",b.setText);a.synthesizePropertyWithState("textColor",b.setTextColor);a.synthesizePropertyWithState("textFont",b.setTextFont);a.synthesizePropertyWithState("textShadow",b.setTextShadow);a.synthesizeCompoundProperty("textGravity",b.setTextGravity);a.synthesizeProperty("textSize",b.setTextSize);a.synthesizeCompoundProperty("textInsets",b.setTextInsets);a.synthesizeProperty("lineHeight",b.setLineHeight);a.synthesizePropertyWithState("rightImage",b.setRightImage);a.synthesizePropertyWithState("rightImageBorder",b.setRightImageBorder);a.synthesizeProperty("rightImageFit",b.setRightImageFitMode);a.synthesizeCompoundProperty("rightImageInsets",b.setRightImageInsets);a.synthesizeCompoundProperty("rightImageGravity",b.setRightImageGravity);a.synthesizeCompoundProperty("rightImageTransform",b.setRightImageTransform);a.synthesizePropertyWithState("title",b.setTitle);a.synthesizePropertyWithState("titleColor",b.setTitleColor);a.synthesizePropertyWithState("titleFont",b.setTitleFont);a.synthesizePropertyWithState("titleShadow",b.setTitleShadow);a.synthesizeCompoundProperty("titleGravity",b.setTitleGravity);a.synthesizeProperty("titleSize",b.setTitleSize);a.synthesizeCompoundProperty("titleInsets",b.setTitleInsets)}}};__ngs._4i={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._22).Commands;var d=__ngs.r_(__ngs._23).AbstractView;b.ViewParent={initialize:function(){this._children=[]},getChildCount:function(){return this._children.length},getChildren:function(){return this._children.slice()},addChild:function(f,e){if(f===this){throw new Error("Cannot add "+f+" as a child of itself!")}if(f instanceof d){if(f._parent){f.removeFromParent()}if(e===0||e>0){e=Math.min(e,this.getChildCount());this._children.splice(e,0,f)}else{e=-1;this._children.push(f)}f._parent=this;f._setVisible(this._visible);a.addSubview.call(this,f.__objectRegistryId,e)}else{throw new Error(this.type+".addChild: "+f+" is not a view!")}return this},removeChild:function(e){if(e instanceof d){if(e._parent==this){e._setVisible(false);var f=this._children.indexOf(e);if(f!=-1){this._children.splice(f,1)}}e._parent=undefined;a.removeFromSuperview.call(e)}else{throw {message:this.type+".removeChild: "+e+" is not a view!"}}return e}}}};__ngs._4j={_c:null,_d:function(){var b={exports:{}};var K=b.exports;this._c=b;var g=__ngs.r_(__ngs._1s).SHA1;var l;if((typeof l=="undefined")||(l===null)){l={}}l.setProperties=function v(e,M){if(e!==null&&M!==null){for(var L in M){if(M.hasOwnProperty(L)){e[L]=M[L]}}}return e};l.setProperties(l,{percentEncode:function z(M){if((typeof M=="undefined")||(M===null)){return""}if(M instanceof Array){var N="";for(var L=0;L<M.length;++M){if(N!==""){N+="&"}N+=l.percentEncode(M[L])}return N}M=encodeURIComponent(M);M=M.replace(/\!/g,"%21");M=M.replace(/\*/g,"%2A");M=M.replace(/\'/g,"%27");M=M.replace(/\(/g,"%28");M=M.replace(/\)/g,"%29");return M},decodePercent:function x(e){if(e!==null){e=e.replace(/\+/g," ")}return decodeURIComponent(e)},getParameterList:function r(e){if((typeof e=="undefined")||(e===null)){return[]}if(typeof e!="object"){return l.decodeForm(e+"")}if(e instanceof Array){return e}var L=[];for(var M in e){if(e.hasOwnProperty(M)){L.push([M,e[M]])}}return L},getParameterMap:function E(L){if((typeof L=="undefined")||(L===null)){return{}}if(typeof L!="object"){return l.getParameterMap(l.decodeForm(L+""))}if(L instanceof Array){var N={};for(var M=0;M<L.length;++M){var e=L[M][0];if(N[e]===undefined){N[e]=L[M][1]}}return N}return L},getParameter:function m(L,e){if(L instanceof Array){for(var M=0;M<L.length;++M){if(L[M][0]==e){return L[M][1]}}}else{return l.getParameterMap(L)[e]}return null},formEncode:function u(L){var e="";var N=l.getParameterList(L);for(var O=0;O<N.length;++O){var M=N[O][1];if((typeof M=="undefined")||M===null){M=""}if(e!==""){e+="&"}e+=l.percentEncode(N[O][0])+"="+l.percentEncode(M)}return e},decodeForm:function q(N){var P=[];var R=N.split("&");for(var Q=0;Q<R.length;++Q){var e=R[Q];if(e===""){continue}var M=e.indexOf("=");var L;var O;if(M<0){L=l.decodePercent(e);O=null}else{L=l.decodePercent(e.substring(0,M));O=l.decodePercent(e.substring(M+1))}P.push([L,O])}return P},setParameter:function I(M,e,N){var L=M.parameters;if(L instanceof Array){for(var O=0;O<L.length;++O){if(L[O][0]==e){if(N===undefined){L.splice(O,1)}else{L[O][1]=N;N=undefined}}}if(N!==undefined){L.push([e,N])}}else{L=l.getParameterMap(L);L[e]=N;M.parameters=L}},setParameters:function t(M,L){var N=l.getParameterList(L);for(var e=0;e<N.length;++e){l.setParameter(M,N[e][0],N[e][1])}},completeRequest:function p(L,e){if((typeof L.method=="undefined")||L.method===null){L.method="GET"}var M=l.getParameterMap(L.parameters);if((typeof M.oauth_consumer_key=="undefined")||M.oauth_consumer_key===null){l.setParameter(L,"oauth_consumer_key",e.consumerKey||"")}if((typeof M.oauth_token=="undefined")||M.oauth_token===null&&e.token!==null){l.setParameter(L,"oauth_token",e.token)}if((typeof M.oauth_version=="undefined")||M.oauth_version===null){l.setParameter(L,"oauth_version","1.0")}if((typeof M.oauth_timestamp=="undefined")||M.oauth_timestamp===null){l.setParameter(L,"oauth_timestamp",l.timestamp())}if((typeof M.oauth_nonce=="undefined")||M.oauth_nonce===null){l.setParameter(L,"oauth_nonce",l.nonce(6))}l.SignatureMethod.sign(L,e)},setTimestampAndNonce:function D(e){l.setParameter(e,"oauth_timestamp",l.timestamp());l.setParameter(e,"oauth_nonce",l.nonce(6))},addToURL:function k(e,M){var O=e;if((typeof M!="undefined")&&M!==null){var L=l.formEncode(M);if(L.length>0){var N=e.indexOf("?");if(N<0){O+="?"}else{O+="&"}O+=L}}return O},getAuthorizationHeader:function n(e,N){var R="OAuth ";if(e){N=N.slice();N.realm=e}var M=0;var O=l.getParameterList(N);for(var P=0;P<O.length;++P){var Q=O[P];var L=Q[0];if(L.indexOf("oauth_")===0||L.indexOf("realm")===0){R+=(M++===0?"":",")+l.percentEncode(L)+'="'+l.percentEncode(Q[1])+'"'}}return R},correctTimestampFromSrc:function J(e){e=e||"oauth_timestamp";return},correctTimestamp:function j(e){l.timeCorrectionMsec=(e*1000)-(new Date()).getTime()},timeCorrectionMsec:0,timestamp:function c(){var e=(new Date()).getTime()+l.timeCorrectionMsec;return Math.floor(e/1000)},nonce:function y(O){var N=l.nonce.CHARS;var e="";for(var M=0;M<O;++M){var L=Math.floor(Math.random()*N.length);e+=N.substring(L,L+1)}return e}});l.nonce.CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";l.declareClass=function h(N,e,M){var O=N[e];N[e]=M;if(M!==null&&O!==null){for(var L in O){if(L!="prototype"){M[L]=O[L]}}}return M};l.declareClass(l,"SignatureMethod",function o(){});l.setProperties(l.SignatureMethod.prototype,{sign:function H(M){var L=l.SignatureMethod.getBaseString(M);var e=this.getSignature(L);l.setParameter(M,"oauth_signature",e);return e},initialize:function a(M,e){var L;if((typeof e.accessorSecret!="undefined")&&e.accessorSecret!==null&&M.length>9&&M.substring(M.length-9)=="-Accessor"){L=e.accessorSecret}else{L=e.consumerSecret}this.key=l.percentEncode(L)+"&"+l.percentEncode(e.tokenSecret)}});l.setProperties(l.SignatureMethod,{sign:function H(M,e){var L=l.getParameterMap(M.parameters).oauth_signature_method;if((typeof L=="undefined")||L===null||L===""){L="HMAC-SHA1";l.setParameter(M,"oauth_signature_method",L)}l.SignatureMethod.newMethod(L,e).sign(M)},newMethod:function f(N,e){var M=l.SignatureMethod.REGISTERED[N];if((typeof M!="undefined")&&(M!==null)){var Q=new M();Q.initialize(N,e);return Q}var P=new Error("signature_method_rejected");var L="";for(var O in l.SignatureMethod.REGISTERED){if(l.SignatureMethod.REGISTERED.hasOwnProperty(O)){if(L!==""){L+="&"}L+=l.percentEncode(O)}}P.oauth_acceptable_signature_methods=L;throw P},REGISTERED:{},registerMethodClass:function B(L,e){for(var M=0;M<L.length;++M){l.SignatureMethod.REGISTERED[L[M]]=e}},makeSubclass:function d(e){var L=l.SignatureMethod;var M=function(){L.call(this)};M.prototype=new L();M.prototype.getSignature=e;M.prototype.constructor=M;return M},getBaseString:function F(O){var e=O.action;var P=e.indexOf("?");var N;if(P<0){N=O.parameters}else{N=l.decodeForm(e.substring(P+1));var M=l.getParameterList(O.parameters);for(var L=0;L<M.length;++L){N.push(M[L])}}return l.percentEncode(O.method.toUpperCase())+"&"+l.percentEncode(l.SignatureMethod.normalizeUrl(e))+"&"+l.percentEncode(l.SignatureMethod.normalizeParameters(N))},normalizeUrl:function G(M){var N=l.SignatureMethod.parseUri(M);var e=N.protocol.toLowerCase();var P=N.authority.toLowerCase();var Q=true;if(Q){var L=P.lastIndexOf(":");if(L>=0){P=P.substring(0,L)}}var O=N.path;if(!O){O="/"}return e+"://"+P+O},parseUri:function w(O){var N={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}};var e=N.parser.strict.exec(O);var M={};var L=14;while(L--){M[N.key[L]]=e[L]||""}return M},normalizeParameters:function s(N){if((typeof N=="undefined")||N===null){return""}var O=l.getParameterList(N);var Q=[];for(var P=0;P<O.length;++P){var L=O[P];if(L[0]!="oauth_signature"){Q.push([l.percentEncode(L[0])+" "+l.percentEncode(L[1]),L])}}Q.sort(function(S,R){if(S[0]<R[0]){return -1}if(S[0]>R[0]){return 1}return 0});var e=[];for(var M=0;M<Q.length;++M){e.push(Q[M][1])}return l.formEncode(e)}});l.SignatureMethod.registerMethodClass(["PLAINTEXT","PLAINTEXT-Accessor"],l.SignatureMethod.makeSubclass(function A(e){return this.key}));l.SignatureMethod.registerMethodClass(["HMAC-SHA1","HMAC-SHA1-Accessor"],l.SignatureMethod.makeSubclass(function A(L){var e=g.b64_hmac_sha1(this.key,L,"=");NgLogD("Signature: "+e);return e}));try{l.correctTimestampFromSrc()}catch(C){}if((typeof K!="undefined")&&K){K.OAuth=l}}};__ngs._4k={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var g=__ngs.r_(__ngs._5).Core;var f=__ngs.r_(__ngs._59).UI;var d=f.ViewGeometry.Scale;var h=__ngs.r_(__ngs._n).Localization;var b=__ngs.r_(__ngs._5y).NavigableViewController;var a=c.AcknowledgementsWebScreen=b.subclass({classname:"AcknowledgementsWebScreen",initialize:function($super,j){if($super&&typeof $super=="function"){$super()}this._contentUrl="http://"+g.Capabilities.getSocialServer()+"/acknowledgements";this._totalWidth=g.Capabilities.getScreenHeight();this._totalHeight=g.Capabilities.getScreenWidth()},$initWithJSON:function(){return new a()},destroy:function(){if(this._retainedViews){for(var j=0;j<this._retainedViews.length;j++){var k=this._retainedViews[j];if(k){k.release()}}}this._retainedViews=new Array()},retainView:function(j){if(j){j.retain();if(!this._retainedViews){this._retainedViews=new Array()}this._retainedViews.push(j)}return j},loadView:function($super){$super();var j=new f.ViewGeometry.Rect([0,0,this._totalWidth,this._totalHeight]);j.sliceVertical(13.75,f.Scale.Percent);j.y+=2;j.h-=2;this.webView=this.retainView(new f.WebView());this.webView.setFrame(j);this.webView.setGradient({gradient:["FFFF 0.0"]});this.webView.loadUrl(this._contentUrl,{"Accept-Language":h.getAcceptLanguage()});this.view().addChild(this.webView)},didPush:function($super,j){$super(j);this.navController._host.hideLoadingLabel()}})}};__ngs._4l={_c:null,_d:function(){var e={exports:{}};var g=e.exports;this._c=e;var j=__ngs.r_(__ngs._5).Core;var f=__ngs.r_(__ngs._59).UI;var b=__ngs.r_(__ngs._4).Device;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Purchase:function(){return __ngs.r_(__ngs._2y).Purchase},Assets:function(){return __ngs.r_(__ngs._2z).Assets},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},OldStyle:function(){return __ngs.r_(__ngs._60).Style},ComplexLabel:function(){return __ngs.r_(__ngs._6c).ComplexLabel},Balance:function(){return __ngs.r_(__ngs._5o).Balance},Transaction:function(){return __ngs.r_(__ngs._5p).Transaction},SupportWebScreen:function(){return __ngs.r_(__ngs._4t).SupportWebScreen},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},BankStyle:function(){return __ngs.r_(__ngs._6d)},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities},Session:function(){return __ngs.r_(__ngs._o).Session},Credentials:function(){return __ngs.r_(__ngs._2r).Credentials}});var h=__ngs.r_(__ngs._5y).NavigableViewController;var l=__ngs.r_(__ngs._n).LocalizedString;var k=a.OldStyle.ScaledTextSize;var m=j.Class.subclass({classname:"CoinPack",initialize:function(r,u,t,q,p,n,o,s){this._productId=r;this._descLine1=u;this._descLine2=t;this._descLine3=q;this._amount=p;this._priceStr=n;this._imageUrl=o;this._coinPackView=null;this._displayOriginPrice=s}});var d=__ngs.r_(__ngs._2a).Destinations;var c=g.BankController=h.subclass({classname:"BankController",analyticsName:"Bank",MAX_BALANCE_VALUE:100000,loadView:function($super){if(!this._view){this.setView(new f.View())}a.Purchase.retryFailedCreditsAux();$super()},initialize:function($super,I,y,z,p){if($super&&typeof $super=="function"){$super()}this._selectCallback=y;this._cancelCallback=z;var P=this;a.BankStyle;var D=a.OldStyle.registeredStyle("social.us.banking").props();this.isAnimating=false;this._numCoinPacksInView=3;this._minCoinPackPos=0;this._stickyTime=500;this._stickyTargetPos=this._minCoinPackPos;this._totalWidth=a.ServiceHost.view().getFrame()[2];this._totalHeight=a.ServiceHost.view().getFrame()[3];var W=-this._totalWidth*D.topAreaXRatio;var U=this._totalHeight*D.topAreaYRatio-1;var Y=this._totalWidth*D.topAreaWidthRatio;var S=this._totalHeight*D.topAreaHeightRatio;var M=this._totalWidth*D.coinPacksViewMarginRatio;var O=this._totalWidth-2*M;var K=this._totalHeight*D.coinPacksViewHeightRatio;this._coinPackOffsetX=M;this._coinPackOffsetY=this._totalHeight*D.coinPackOffsetYRatio;var s=M*D.arrowWidthRatio;var t=K*D.arrowHeightRatio;var T=M*D.arrowSideMarginRatio;var q=this._coinPackOffsetY+K/2-t/2;this._coinPackMarginBig=M*D.coinPackMarginBigRatio;this._coinPackMarginSmall=this._totalWidth*D.coinPackMarginSmallRatio;this._coinPackWidth=(O-(this._numCoinPacksInView-1)*this._coinPackMarginSmall)/this._numCoinPacksInView;this._coinPackHeight=K;this._coinPackGroupWidth=this._numCoinPacksInView*this._coinPackWidth+(this._numCoinPacksInView-1)*this._coinPackMarginSmall;var v=this._totalHeight*D.bottomAreaHeightRatio;var N=this._totalHeight-v;var A=new f.ViewGeometry.Rect(0,0,this._totalWidth,this._totalHeight);this.view().setFrame(A);this._topArea=this.retainView(new f.View());this._topArea.setFrame([W,U,Y,S]);this._topArea.setAttributes(D.topAreaView);this._balanceArea=this.retainView(new f.View());this._balanceArea.setFrame([-this._totalWidth*D.balanceAreaXRatio,S*D.balanceAreaYRatio,this._totalWidth*D.balanceAreaWidthRatio,S*D.balanceAreaHeightRatio]);this._balanceArea.setAttributes(D.balanceAreaView);this._topArea.addChild(this._balanceArea);this._balanceCoin=this.retainView(new f.Image());this._balanceCoin.setFrame([this._totalWidth*D.balanceCoinXRatio,S*D.balanceCoinYRatio,S*D.balanceCoinWidthRatio,S*D.balanceCoinHeightRatio]);if(!a.Capabilities.isPlatformIOS()){this._balanceCoin.setImage(a.Assets.image("bank_coins_balance.png"))}this._balanceArea.addChild(this._balanceCoin);this._myBalance=this.retainView(new f.Label());this._myBalance.setText(l("My Balance:"));this._myBalance.setFrame([this._totalWidth*D.myBalanceXRatio,0,this._totalWidth*D.myBalanceWidthRatio,S*D.myBalanceHeightRatio]);this._myBalance.setTextGravity(f.ViewGeometry.Gravity.Left);this._myBalance.setAttributes(D.myBalanceLabel);this._balanceArea.addChild(this._myBalance);this._balanceNum=this.retainView(new f.Label());this._balanceNum.setFrame([this._totalWidth*D.balanceNumXRatio,S*D.balanceNumYRatio,this._totalWidth*D.balanceNumWidthRatio,S*D.balanceNumHeightRatio]);this._balanceNum.setTextGravity(f.ViewGeometry.Gravity.Left);this._balanceNum.setAttributes(D.balanceNumLabel);this._balanceArea.addChild(this._balanceNum);this.updateBalance();this._balanceName=this.retainView(new f.Label());this._balanceName.setText(l("MobaCoin"));this._balanceName.setFrame([this._totalWidth*D.balanceNameXRatio,S*D.balanceNameYRatio,this._totalWidth*D.balanceNameWidthRatio,S*D.balanceNameHeightRatio]);this._balanceName.setTextGravity(f.ViewGeometry.Gravity.Left);this._balanceName.setAttributes(D.balanceNameLabel);this._balanceArea.addChild(this._balanceName);this._supportButton=this.retainView(new a.UnspammableButton());this._supportButton.setText(l("Customer Support"));this._supportButton.setFrame([this._totalWidth*D.supportButtonXRatio,S*D.supportButtonYRatio,this._totalWidth*D.supportButtonWidthRatio,S*D.supportButtonHeightRatio]);this._supportButton.setAttributes(D.customerSupportButton);this._supportButton.setGradient(D.customerSupportButtonPressed,f.State.Pressed);this._supportButton.onclick=function(){d.pushScreen(this.navController,"SupportWebScreen",{},this)}.bind(this);this._topArea.addChild(this._supportButton);this.view().addChild(this._topArea);this._coinBackgroundView=this.retainView(new f.View());this._coinBackgroundView.setFrame([0,U+S,this._totalWidth,this._totalHeight-(U+S)]);this._coinBackgroundView.setAttributes(D.coinBackgroundView);this.view().addChild(this._coinBackgroundView);this._coinPacksArray=this.getCoinPacks(I);this._coinPackGroups=new Array();var r=null;for(var V=0;V<this._coinPacksArray.length;V++){var B=this._coinPacksArray[V];var R=this.retainView(new f.View());R.setFrame([(V%this._numCoinPacksInView)*(this._coinPackWidth+this._coinPackMarginSmall),0,this._coinPackWidth,this._coinPackHeight]);R.setAttributes(D.coinPackView);var H=this.retainView(new f.Label());H.setText(B._descLine1);H.setFrame([0,this._coinPackHeight*D.coinPackHeader1YRatio,this._coinPackWidth,this._coinPackHeight*D.coinPackHeader1HeightRatio]);H.setAttributes(D.coinPackHeaderLabel);R.addChild(H);var G=this.retainView(new f.Label());G.setText(B._descLine2);G.setFrame([0,this._coinPackHeight*D.coinPackHeader2YRatio,this._coinPackWidth,this._coinPackHeight*D.coinPackHeader2HeightRatio]);G.setAttributes(D.coinPackHeaderMidLabel);R.addChild(G);var E=this.retainView(new f.Label());E.setText(B._descLine3);E.setFrame([0,this._coinPackHeight*D.coinPackHeader3YRatio,this._coinPackWidth,this._coinPackHeight*D.coinPackHeader3HeightRatio]);E.setAttributes(D.coinPackHeaderLabel);R.addChild(E);var Q=this.numDigitsOfWholeNumber(B._amount);var J=this._coinPackWidth*D.coinPackAmountDigitWidthRatio;var n=this._coinPackHeight*D.coinPackCoinWidthRatio+this._coinPackWidth*D.coinPackCoinMarginRatio;var o=this.retainView(new f.Image());o.setFrame([(this._coinPackWidth-n-Q*J)*0.5,this._coinPackHeight*D.coinPackCoinYRatio,this._coinPackHeight*D.coinPackCoinWidthRatio,this._coinPackHeight*D.coinPackCoinHeightRatio]);if(!B._imageUrl){if(!a.Transaction._isIOS()){o.setImage(a.Assets.image("gold_mobacoin.png"))}}else{o.setImage(B._imageUrl)}R.addChild(o);var x=this.retainView(new f.Label());x.setText(""+B._amount);x.setFrame([(this._coinPackWidth+n-Q*J)*0.5,this._coinPackHeight*D.coinPackAmountYRatio,this._coinPackWidth*D.coinPackAmountWidthRatio,this._coinPackHeight*D.coinPackAmountHeightRatio]);x.setTextGravity(f.ViewGeometry.Gravity.Left);x.setAttributes(D.coinPackAmountLabel);R.addChild(x);var C=this._coinPackWidth*D.coinPackPriceButtonWidthRatio;var u=this.retainView(new a.UnspammableButton());var F;if(a.Transaction._isIOS()){F=B._priceStr;u.setText(B._priceStr)}else{if(B._displayOriginPrice){F=B._displayOriginPrice;u.setText(B._displayOriginPrice)}else{F=B._priceStr;u.setText(B._priceStr)}}F=F.replace(/[^\d\.,]/gi,"");u.setFrame([(this._coinPackWidth-C)/2,this._coinPackHeight*D.coinPackPriceButtonYRatio,C,this._coinPackHeight*D.coinPackPriceButtonHeightRatio]);u.setAttributes(D.coinPackPriceButton);var w=function(aa){if(aa){if(aa=="cancelled"||aa=="recreditLater"){return}NgLogD("mobage/Purchase: received IAB failure: "+aa);var ab=(new f.AlertDialog()).retain();ab.setTitle(l("Purchase Failed"));ab.setText(l("The purchase failed.  Please try again later."));ab.setChoices([l("OK")]);ab.onchoice=function(ac){ab.release();ab=undefined};ab.show();return}P.updateBalance();var Z=(new f.AlertDialog()).retain();Z.setTitle(l("Purchase Succeeded"));if(a.Session.getCurrentSession().user().usesGuestLogin()){if(a.Capabilities.isPlatformIOS()){Z.setText(l("Create your Mobage accout now to secure your parchases and unlock social features."))}else{Z.setText(l("Create your Mobage accout now to secure your parchases and to carry your MobageCoin balance to other Mobage games."))}Z.setChoices([l("Play game"),l("Sign Up")]);Z.onchoice=function(ac){if(ac.choice==1){a.Credentials.showRegistration(null,true,true,"tiered",null,"bankPurchaseModal")}Z.release();Z=undefined}}else{Z.setTitle(l("Purchase Succeeded"));Z.setText(l("The purchase succeeded.  Your balance has been updated!"));Z.setChoices([l("OK")]);Z.onchoice=function(ac){Z.release();Z=undefined}}Z.show()};u.onclick=function(ac,ab,aa,Z,ad){return function(){NgLogD("mobage-BankController: coinPackPriceButton tapped for "+ac);for(var af=0;af<aa.length;af++){var ag=aa[af];ag._coinPackPriceButton.setEnabled(false)}if(ab+P._balanceValue>=P.MAX_BALANCE_VALUE){var ae=(new f.AlertDialog()).retain();ae.setTitle(l("Hey Big Spender"));ae.setText(l("You've hit the maximum balance of 99,999 %1s. Spend some before you buy more!",P._currency));ae.setChoices([l("OK")]);ae.onchoice=function(ah){ae.release();ae=undefined};ae.show()}else{if(typeof P._selectCallback=="function"){P._selectCallback(ac,w,Z,ad)}}}}(B._productId,B._amount,this._coinPacksArray,F,p);R.addChild(u);B._coinPackPriceButton=u;B._coinPackView=R;if(!r||(V%this._numCoinPacksInView)===0){r=this.retainView(new f.View());this.view().addChild(r);this._coinPackGroups.push(r)}if(r){r.addChild(R)}}var X=s/2;this._leftArrowButton=this.retainView(new a.UnspammableButton());this._leftArrowButton.setFrame([T-X,q-X,s+2*X,t+2*X]);this._leftArrowButton.setImageInsets([X,X,X,X]);this._leftArrowButton.setImage(a.Assets.image("bank_arrow_left.png"));this._leftArrowButton.setImage(a.Assets.image("bank_arrow_left_downstate.png"),f.State.Pressed);this._leftArrowButton.onclick=function(){NgLogD("mobage-BankController: left button tapped");P.doMove(false)};this.view().addChild(this._leftArrowButton);this._rightArrowButton=this.retainView(new a.UnspammableButton());this._rightArrowButton.setFrame([this._totalWidth-T-s-X,q-X,s+2*X,t+2*X]);this._rightArrowButton.setImageInsets([X,X,X,X]);this._rightArrowButton.setImage(a.Assets.image("bank_arrow_right.png"));this._rightArrowButton.setImage(a.Assets.image("bank_arrow_right_downstate.png"),f.State.Pressed);this._rightArrowButton.onclick=function(){NgLogD("mobage-BankController: right button tapped");P.doMove(true)};this.view().addChild(this._rightArrowButton);this.setCurrentCoinPackPos(this._minCoinPackPos);this.updateArrowButtons();this._bottomArea=this.retainView(new f.View());this._bottomArea.setFrame([0,N,this._totalWidth,v]);this._mobageExplanation=this.retainView(new f.Label());if(!a.Capabilities.isPlatformIOS()){this._mobageExplanation.setText(l("One currency to spend in all of your Mobage games."))}this._mobageExplanation.setTextSize(k(16).realize());this._mobageExplanation.setFrame([0,0,this._totalWidth,v]);this._mobageExplanation.setAttributes(D.bottomAreaLabel);this._bottomArea.addChild(this._mobageExplanation);this.view().addChild(this._bottomArea);var L=j.MessageListener.subclass({_onLifecycleEvent:function(Z){if(Z===b.LifecycleEmitter.Event.Resume){P.reEnablePriceButton()}return true},destroy:function(){b.LayoutEmitter.removeListener(this)}});this._lifecycleListenerInstance=new L();b.LifecycleEmitter.addListener(this._lifecycleListenerInstance,this._lifecycleListenerInstance._onLifecycleEvent);return this},$initWithJSON:function(n){return new c(null,null)},reEnablePriceButton:function(){for(var n=0;n<this._coinPacksArray.length;n++){var o=this._coinPacksArray[n];o._coinPackPriceButton.setEnabled(true)}},onJSON:function(n){return null},canMove:function(n){var o=0;if(n){o=this.getMaxCoinPackPos()-this._currentCoinPackPos}else{o=this._currentCoinPackPos-this._minCoinPackPos}o=Math.abs(o);if(o<this._coinPackWidth){return false}return true},getMaxCoinPackPos:function(){if(this._coinPackGroups&&this._coinPackGroups.length>0){return(this._coinPackGroups.length-1)*this._coinPackGroupWidth+(this._coinPackGroups.length-1)*this._coinPackMarginBig}return 0},putPosInBounds:function(n){return Math.max(this._minCoinPackPos,Math.min(n,this.getMaxCoinPackPos()))},doMove:function(n){if(this.isAnimating){return}var p=this._coinPackGroupWidth+this._coinPackMarginBig;if(!n){p*=-1}var o=this.putPosInBounds(this._stickyTargetPos+p);if(this._stickyTargetPos!=o){this._stickyTargetPos=o;this.animateCoinPacks()}},animateCoinPacks:function(){if(this.isAnimating){return}var n=this;this.isAnimating=true;f.animate(function(){n.setCurrentCoinPackPos(n._stickyTargetPos)},this._stickyTime,function(){n.updateArrowButtons();n.isAnimating=false})},setCurrentCoinPackPos:function(o){var n=this.putPosInBounds(o);if(this._currentCoinPackPos==undefined||n!=this._currentCoinPackPos){this._currentCoinPackPos=n;this.updateCoinPackPositions()}},updateArrowButtons:function(){if(!this.canMove(false)){if(this._leftArrowButton.getParent()){this._leftArrowButton.removeFromParent()}}else{if(!this._leftArrowButton.getParent()){this.view().addChild(this._leftArrowButton)}}if(!this.canMove(true)){if(this._rightArrowButton.getParent()){this._rightArrowButton.removeFromParent()}}else{if(!this._rightArrowButton.getParent()){this.view().addChild(this._rightArrowButton)}}},updateCoinPackPositions:function(){if(!this._coinPacksArray){return}var o=-this._currentCoinPackPos;for(var q=0;q<this._coinPackGroups.length;q++){var r=this._coinPackGroups[q];if(r){r.setFrame([this._coinPackOffsetX+o,this._coinPackOffsetY,this._coinPackGroupWidth,this._coinPackHeight]);var s=this._coinPackGroupWidth/2;var p=Math.abs(s-(o+0.5*this._coinPackWidth));var n=s-(0.5*this._coinPackWidth);if(p>n){r.setAlpha(Math.max(0.3,1-(p-n)/(n/2)))}else{r.setAlpha(1)}o+=this._coinPackGroupWidth+this._coinPackMarginBig}}},willPush:function($super,n){NgLogD("mobage-BankController: willPush");this.navController._host.hideLoadingLabel();$super(n)},willReshow:function($super,n){NgLogD("mobage-BankController: willReshow");this._sentHideEvent=false;a.MobageAnalytics.reportEvent("BankNavReshow");$super(n)},didHide:function($super,n){$super(n);if(!this._sentHideEvent){a.MobageAnalytics.reportEvent("BankNavAway")}this._sentHideEvent=true},didPop:function($super,n){NgLogD("mobage-BankController: didPop");$super(n);if(!this._sentHideEvent){a.MobageAnalytics.reportEvent("BankNavAway")}this._sentHideEvent=true;a.MobageAnalytics.reportEvent("MobaPurchaseCancel");if(typeof this._cancelCallback=="function"){this._cancelCallback()}},updateBalance:function(){var n=this;a.Balance.get(function(q,s,r,p,o){NgLogD("update balance = "+r);if(s){n._balanceName.setText(p);n._currency=p;n.setBalance(r);if(o){n._balanceCoin.setImage(o)}}})},setBalance:function(n){this._balanceValue=n;if(this._balanceNum){this._balanceNum.setText(a.Balance.addCommas(n))}},numDigitsOfWholeNumber:function(p){var n=Math.floor(Math.abs(p));var o=1;while(true){if(n>=10){o++;n=Math.floor(n/10)}else{break}}return o},getCoinPacks:function(o){var q=new Array();for(var n in o){var r=o[n];var s=r.id;var p=-111;if(r.price){p=parseInt(r.price,10)}q.push(new m(s,l("Buy a"),r.name,r.currency,p,r.origin_price,r.imageUrl,r.display_origin_price))}return q},destroy:function(){this._coinPacksArray=new Array();this._coinPackGroups=new Array();this._lifecycleListenerInstance.destroy()}})}};__ngs._4m={_c:null,_d:function(){var a={exports:{}};var e=a.exports;this._c=a;var d=__ngs.r_(__ngs._2z).Assets;var n=__ngs.r_(__ngs._n).LocalizedString;var k=__ngs.r_(__ngs._6e).MobageVerticalTabController;var g=__ngs.r_(__ngs._6f).CatalogController;var l=__ngs.r_(__ngs._2v).ServiceHost;var b=__ngs.r_(__ngs._2a).Destinations;var h=5;var o=null;var m=null;var p=null;var j=null;var f="name abc";var c=e.Catalog=k.subclass({classname:"Catalog",_allGamesController:null,_featuredGamesController:null,_friendsGamesController:null,initialize:function($super,q){$super();this._featuredGamesController=(new g("featured")).retain();this._featuredGamesController.setMaxEntries(h);this._featuredGamesController.setSorting(o);this._friendsGamesController=(new g("friends")).retain();this._friendsGamesController.setMaxEntries(m);this._friendsGamesController.setSorting(p);this._allGamesController=(new g()).retain();this._allGamesController.setMaxEntries(j);this._allGamesController.setSorting(f);this.tabToSelect=q;return this},$initWithJSON:function(r){var q=null;if(r.tab){q=r.tab}return new c(q)},onJSON:function(q){if(q.tab){if(q.tab=="all games"){this.selectTabAtIndex(0)}else{this.selectTabAtIndex(1)}}},loadView:function($super){$super();this.batchChangeMode=true;this.addTabWithTextImageAndContent(n("Featured Games"),d.image("catalog_tabbadge_allgames.png"),this._featuredGamesController.view());this.addTabWithTextImageAndContent(n("Friends' Games"),d.image("catalog_tabbadge_allgames.png"),this._friendsGamesController.view());this.addTabWithTextImageAndContent(n("All Games"),d.image("catalog_tabbadge_allgames.png"),this._allGamesController.view());this.addJumpWithTitleAndCallback(n("My Games"),function(){NgLogD("My Games Button Clicked.");b.pushScreen(this.navController,"MyPage",{tab:"games"},this)}.bind(this));this.batchChangeMode=false;this.view().layoutButtonContainer()},destroy:function(){if(this._allGamesController){this._allGamesController.release();this._allGamesController=null}if(this._featuredGamesController){this._featuredGamesController.release();this._featuredGamesController=null}if(this._friendsGamesController){this._friendsGamesController.release();this._friendsGamesController=null}},willPush:function($super,q){$super(q);if(!this.tabToSelect||this.tabToSelect=="all games"){this.selectTabAtIndex(2)}else{if(this.tabToSelect=="featured games"){this.selectTabAtIndex(0)}else{if(this.tabToSelect=="friends games"){this.selectTabAtIndex(1)}}}},didPush:function($super,q){$super(q);this.navController._host.hideLoadingLabel()}})}};__ngs._4n={_c:null,_d:function(){var d={exports:{}};var g=d.exports;this._c=d;var f=__ngs.r_(__ngs._2z).Assets;var k=__ngs.r_(__ngs._n).LocalizedString;var e=__ngs.r_(__ngs._o).Session;var h=__ngs.r_(__ngs._6e).MobageVerticalTabController;var j=__ngs.r_(__ngs._6g).SuggestedFriendsController;var b=__ngs.r_(__ngs._6h).ContactsController;var a=__ngs.r_(__ngs._6i).UserSearchController;var c=__ngs.r_(__ngs._2a).Destinations;var l=g.FindFriends=h.subclass({classname:"FindFriends",suggestedFriendsController:null,contactsController:null,searchController:null,tabToSelect:null,initialize:function($super,m){$super();this.suggestedFriendsController=(new j()).retain();this.contactsController=(new b()).retain();this.searchController=(new a()).retain();this.tabToSelect=m;return this},$initWithJSON:function(n){var m=null;if(n.tab){m=n.tab}return new l(m)},onJSON:function(n){if(n.tab){var m=0;if(!n.tab||n.tab=="suggested"){m=0}else{if(n.tab=="contacts"){m=1}else{m=2}}this.selectTabAtIndex(m)}return null},loadView:function($super){$super();NgLogD("FindFriends: loadView");this.batchChangeMode=true;this.addTabWithTextImageAndContent(k("Suggested Friends"),f.image("findfriends_tabbadge_suggested.png"),this.suggestedFriendsController.view());NgLogD("ContactsController");this.addTabWithTextImageAndContent(k("Scan Device Contacts"),f.image("findfriends_tabbadge_contacts.png"),this.contactsController.view());this.addTabWithTextImageAndContent(k("Search"),f.image("findfriends_tabbadge_search.png"),this.searchController.view());var m=this.addJumpWithTitleAndCallback(k("Friend Requests"),function(){NgLogD("Invites Button Clicked.");c.pushScreen(this.navController,"MyPage",{tab:"invites"},{analyticsName:"FindFriendsInvite"})}.bind(this));var o=this.tabPairAtIndex(m).tabView;NgLogD("FindFriends: loadView Main Setup finished.");this.batchChangeMode=false;this.view().layoutButtonContainer();var n=0;e.getCurrentSession().user().getInvitesList().forAll(function(r,p,q){if(p.isMutualFriend){r(true)}r(++n<=99)},this.bind(function(p){NgLogE("Finished counting Requests users, total count = "+n);if(n>0){o.showCustomAccessoryImage(f.image("mobageverticaltab_jumpbutton_invitesbubble.png"));o._rightImageWidthMultiplier=2}else{o.showCaret();o._rightImageWidthMultiplier=1}if(n<=0){o.content.accessory.setText("")}else{if(n<99){o.content.accessory.setText(n)}else{o.content.accessory.setText("99+")}}o.layoutSubviews()}))},destroy:function(){this.suggestedFriendsController.release();this.contactsController.release();this.searchController.release()},willPush:function($super,n){$super(n);var m=0;if(!this.tabToSelect||this.tabToSelect=="suggested"){m=0}else{if(this.tabToSelect=="contacts"){m=1}else{m=2}}this.selectTabAtIndex(m)}})}};__ngs._4o={_c:null,_d:function(){var c={exports:{}};var e=c.exports;this._c=c;var d=__ngs.r_(__ngs._59).UI;var b=d.ViewGeometry.Scale;var g=__ngs.r_(__ngs._5).Core;var a=new (__ngs.r_(__ngs._f).RequireLoader)({PlusRequest:function(){return __ngs.r_(__ngs._28).PlusRequest},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},CredentialsHost:function(){return __ngs.r_(__ngs._2s).CredentialsHost},CredentialsStyles:function(){return __ngs.r_(__ngs._6j)},MobageStyle:function(){return __ngs.r_(__ngs._6k).MobageStyle},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},RegistrationRecord:function(){return __ngs.r_(__ngs._6l).RegistrationRecord},OldStyle:function(){return __ngs.r_(__ngs._60).Style}});var h=__ngs.r_(__ngs._n).LocalizedString;var f=__ngs.r_(__ngs._5y).NavigableViewController;var j=e.ForgotPassword=f.subclass({classname:"ForgotPassword",_registrationRecord:null,initialize:function($super,k){$super();this._onCompleteCallback=k;this.holderScrollView=(new d.ScrollView()).retain();this.title=(new d.Label()).retain();this.subtitle=(new d.Label()).retain();this.email=(new d.Label()).retain();this.emailInput=(new d.EditText()).retain();this.sendButton=(new a.UnspammableButton()).retain();this._initEventing()},$initWithJSON:function(k){return new j()},onJSON:function(k){return null},destroy:function(){this.title.release();this.subtitle.release();this.email.release();this.emailInput.release();this.sendButton.release()},_initEventing:function(){this.sendButton.onclick=this.bind(function(){this._resetPassword()})},loadView:function($super){NgLogD("Mobage/Forgot Password/loadView begin");$super();var r=new d.ViewGeometry.Rect(a.CredentialsHost.navController.view().getFrame());var t=r.copy();this.view().setFrame(r);this.holderScrollView.setFrame(r);this.holderScrollView.setContentSize([g.Capabilities.getScreenWidth(),g.Capabilities.getScreenHeight()]);t.sliceVertical(176*(r.h/800));var o=t.sliceVertical(r.h*(46/800));o.inset(0,r.w*(28/480));this.title.setFrame(o);this.title.setText(h("Forgot Your Password?"));t.sliceVertical(10*(r.h/800));var s=t.sliceVertical((36+99)/800*r.h);s=s.inset(0,49/480*r.w);this.subtitle.setFrame(s);this.subtitle.setText(h("Please enter the email address you used to sign up for Mobage and a password reset will be sent to you."));var m=t.sliceVertical(143/800*r.h);m=m.inset(0,26/480*r.w);var q=m.sliceVertical((45+24)/800*r.h);q=q.inset(0,2);this.email.setFrame(q);this.email.setText(h("Email Address"));this._registrationRecord=new a.RegistrationRecord();var p=m.sliceVertical((5+70)/800*r.h);p=p.inset(5/800*r.h,0);this.emailInput.setFrame(p);this.emailInput.setInputType(d.Commands.InputType.Email);this.emailInput.setEnterKeyType(d.Commands.EnterKeyType.Done);var n=t.sliceVertical((42+72)/800*r.h);var k=42/800*r.h;var l=66/480*r.w;n=n.inset(k,l,0,l);this.sendButton.setFrame(n);this.sendButton.setText(h("Send"));this.holderScrollView.addChild(this.title);this.holderScrollView.addChild(this.subtitle);this.holderScrollView.addChild(this.email);this.holderScrollView.addChild(this.emailInput);this.holderScrollView.addChild(this.sendButton);this.view().addChild(this.holderScrollView);this.loadStyles();NgLogD("Mobage/Forgot Password/loadView end")},_loadStylesAntiPattern:function(m){if(!this.view().getStyle()){this.view().setStyle(new a.OldStyle())}var k=this.view().getStyle();k.defaultsFrom(m);for(var l in k.props()){if(k.props().hasOwnProperty(l)&&this.hasOwnProperty(l)&&this[l]){this[l].setAttributes(k.props()[l])}}},loadStyles:function($super){a.CredentialsStyles;this._loadStylesAntiPattern("social.us.forgotpassword");this.email.setAttributes(this.view().getStyle().props()["inputLabel"]);this.emailInput.setAttributes(this.view().getStyle().props()["textBox"]);this.emailInput.setGradient(this.view().getStyle().props()["textBox"]["gradientError"],a.MobageStyle.ErrorState);this.sendButton.setAttributes(this.view().getStyle().props()["largeStandardButton"]);this.sendButton.setGradient(this.view().getStyle().props()["largeStandardButton"]["pressedGradient"],d.State.Pressed)},_resetPassword:function(){NgLogD("Send email clicked.");this._resetViewState();if(!this.progressDialog){this.progressDialog=new d.ProgressDialog();this.progressDialog.setText(h("Sending request"))}this.progressDialog.show();this._registrationRecord.email=this.emailInput.getText().replace(/^\s+|\s+$/g,"");if(!this.progressDialog){this.progressDialog=new d.ProgressDialog();this.progressDialog.setText(h("Verifying..."))}this.progressDialog.show();var k=this;this._registrationRecord.testRemoteEmail(function(l){if(l){a.UIUtils.showToast(l);this.emailInput.setState(a.MobageStyle.ErrorState)}else{NgLogD("EMAIL VERIFIED");k._registrationRecord.optIn=this._optInUpdates;NgLogD("Registration: Record ready to submit, record's data: "+JSON.stringify(this._registrationRecord));a.PlusRequest.sendPasswordResetEmailWithAddress(this.emailInput.getText(),this.bind(function(m){k.progressDialog.hide();k.progressDialog.destroy();k.progressDialog=undefined;NgLogD("Mobage/ForgotPassword/Plus Request response="+JSON.stringify(m));if(!m){a.UIUtils.showToast(h("Email sent!"));if(this._onCompleteCallback){this._onCompleteCallback()}}else{if(m.indexOf("email")!=-1){this.emailInput.setState(a.MobageStyle.ErrorState)}a.UIUtils.showToast(m)}}))}})},_resetViewState:function(){this.emailInput.setState(d.State.Normal)}})}};__ngs._4p={_c:null,_d:function(){var d={exports:{}};var h=d.exports;this._c=d;var g=__ngs.r_(__ngs._2z).Assets;var m=__ngs.r_(__ngs._n).LocalizedString;var k=__ngs.r_(__ngs._2v).ServiceHost;var f=__ngs.r_(__ngs._6m).GameProfileController;var j=__ngs.r_(__ngs._6e).MobageVerticalTabController;var c=__ngs.r_(__ngs._2e);var b=__ngs.r_(__ngs._q).MobageAnalytics;var l=__ngs.r_(__ngs._6n).CpiProduct;var a=__ngs.r_(__ngs._2a).Destinations;var e=h.GameProfile=j.subclass({classname:"GameProfile",analyticsName:"GameProfile",gameProfileController:null,initialize:function($super,n,p,o){$super();this._game=n;this.gameProfileController=(new f(n,o)).retain();this.tabToSelect=p;return this},$startGameOrGoToProfile:function(p,o){if(!p){NgLogD("GameProfile - startOrGoToProfile: No has or game passed in.");return}var q,n;if(p instanceof c.Game){n=p;q={game:n}}else{n=p.game;q=p;if(!n instanceof c.Game){NgLogD("GameProfile - startOrGoToProfile: No game passed in.");return}}if(n.isAvailableLocally()){if(!o){o="JSGamePlayFromSomewhere"}b.reportEvent(o,n.recordID);n.checkUpdateAndStartGame()}else{n.loadLaunchable(function(){a.pushScreen(k.navController,"GameProfile",q,{analyticsName:"startGameOrGoToProfile"})}.bind(this))}},$initWithJSON:function(r){var p=null;var n=null;if(r.tab){p=r.tab}if(r.game){n=r.game}var q=l.getProducts();var o=q[n.recordID];return new e(n,p,o)},onJSON:function(n){if(n.game&&n.game.recordID!=this._game.recordID){return e.initWithJSON(n)}return null},loadView:function($super){$super();this.batchChangeMode=true;this.addTabWithTextImageAndContent(m("Game Info"),g.image("game_info_icon.png"),this.gameProfileController.view());this.addJumpWithTitleAndCallback(m("All Games"),function(){NgLogD("All Games Button Clicked.");a.pushScreen(this.navController,"Catalog",{},this)}.bind(this));this.batchChangeMode=false;this.view().layoutButtonContainer()},destroy:function(){this.gameProfileController.release()},equals:function(n){if(!n._game){return false}return(this._game.recordID==n._game.recordID)},willPush:function($super,n){$super(n);if(!this.tabToSelect||this.tabToSelect=="info"||true){this.selectTabAtIndex(0)}}})}};__ngs._4q={_c:null,_d:function(){var f={exports:{}};var h=f.exports;this._c=f;var g=__ngs.r_(__ngs._59).UI;var c=__ngs.r_(__ngs._4).Device;var q=__ngs.r_(__ngs._a).Storage;var l=__ngs.r_(__ngs._w).MessageListener;var n=__ngs.r_(__ngs._7).Capabilities;var b=new (__ngs.r_(__ngs._f).RequireLoader)({Purchase:function(){return __ngs.r_(__ngs._2y).Purchase},ShowBankAction:function(){return __ngs.r_(__ngs._2y).ShowBankAction},GameLaunchedEmitter:function(){return __ngs.r_(__ngs._2g).GameLaunchedEmitter},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},UserProfilePage:function(){return __ngs.r_(__ngs._4u).UserProfilePage},Main:function(){return __ngs.r_(__ngs._m).Main},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics},CustomModalDialog:function(){return __ngs.r_(__ngs._5k).CustomModalDialog},User:function(){return __ngs.r_(__ngs._30).User},Game:function(){return __ngs.r_(__ngs._2e).Game},Session:function(){return __ngs.r_(__ngs._o).Session},SessionListener:function(){return __ngs.r_(__ngs._o).SessionListener},Balance:function(){return __ngs.r_(__ngs._5o).Balance},AppConfig:function(){return __ngs.r_(__ngs._29).AppConfig},MobageBootAB:function(){return __ngs.r_(__ngs._6o).MobageBootAB},CpiProduct:function(){return __ngs.r_(__ngs._6n).CpiProduct},HomeScreenButton:function(){return __ngs.r_(__ngs._6p).HomeScreenButton},HomeScreenScrollView:function(){return __ngs.r_(__ngs._6q).HomeScreenScrollView},GameCarousel:function(){return __ngs.r_(__ngs._6r).GameCarousel},GameCarouselCache:function(){return __ngs.r_(__ngs._2t).GameCarouselCache},UserPicNameView:function(){return __ngs.r_(__ngs._6s).UserPicNameView},GameIconView:function(){return __ngs.r_(__ngs._6t).HomeGameIconView},Assets:function(){return __ngs.r_(__ngs._2z).Assets}});var e=__ngs.r_(__ngs._2a).Destinations;var o=__ngs.r_(__ngs._n).LocalizedString;var j=__ngs.r_(__ngs._6u).Currency;var k=__ngs.r_(__ngs._5y).NavigableViewController;var p=__ngs.r_(__ngs._6v).NavigableView.subclass({classname:"HomeScreen_SizeReporterView",sizeChanged:function($super,s,r){$super.apply(this,Array.prototype.slice.call(arguments,1));if(s>r&&this.controller&&this.controller._layoutViews&&this.controller._homePushInited){this.controller._layoutViews()}}});var a=h.Home=k.subclass({classname:"Home",analyticsName:"Homepage",_leftPaneBackground:null,_userNamePicView:null,_lastGameView:null,_lastGameIcon:null,_noGameText:null,_noGameImage:null,_gamesButtonView:null,_friendsButtonView:null,_bankButtonView:null,_featuredGamesList:null,_alsoPlayingUsersList:null,_lastInvitesSeenCount:null,_curInvitesCount:null,_launchedMarketAppGame:null,_style:null,_bankSetupOniOs:false,_dirtyFriendsListener:null,$initWithJSON:function(r){return new a(null)},initialize:function($super,r){$super();if(r){this._launchedGame=r}this._isTransitioning=false;this._shouldAnimate=true;this._friendsButtonHasBadge=false;this._style=__ngs.r_(__ngs._6w).Home;this._leftPaneBackground=(new g.View()).retain();this._userNamePicView=(new b.UserPicNameView()).retain();this._lastGameView=(new g.View()).retain();this._lastGameIcon=(new b.GameIconView()).retain();this._noGameText=(new g.Label()).retain();this._noGameImage=(new g.Image()).retain();this._gameCarousel=(new b.GameCarousel()).retain();this._alsoPlayingUsersList=(new b.HomeScreenScrollView()).retain();this._gamesButtonView=(new b.HomeScreenButton()).retain();this._friendsButtonView=(new b.HomeScreenButton()).retain();this._bankButtonView=(new b.HomeScreenButton()).retain();this._bankButtonAction=new b.ShowBankAction();this._userNamePicView.setClickCallback(this.userNamePic_clickHandler.bind(this));this._lastGameIcon.setClickCallback(this.lastGameIcon_clickHandler.bind(this));this._noGameText.setTouchable(false);this._noGameImage.setTouchable(false);this._gameCarousel.setOnGameClick(this.gameCarousel_gameClickHandler.bind(this));this._gameCarousel.setCornerButton(o("Find Games"),this.findGames_clickHandler.bind(this));this._alsoPlayingUsersList.setData(null);this._alsoPlayingUsersList.setButton(o("Find People"),this.alsoPlayingUsersList_clickHandler.bind(this));this._gamesButtonView.setMainText(o("My Games"));this._gamesButtonView.buttonIcon.setImage(b.Assets.image("micons__0004_games1.png"));this._gamesButtonView.setOnClick(this.gamesButton_clickHandler.bind(this));this._friendsButtonView.buttonIcon.setImage(b.Assets.image("micons__0011_friends.png"));this._friendsButtonView.setMainText(o("My Friends"));this._friendsButtonView.setOnClick(this.friendsButton_clickHandler.bind(this));if(n.isPlatformIOS()){if(j.isWaitingOnData()){this._bankButtonView.setMainText(o("Loading..."));this._bankButtonView.buttonIcon.setImage(b.Assets.image("loading_icon.png"));this.view().getContentView().addChild(this._bankButtonView);NgLogD("Making the currency remote call...");j.load(this.updateBankButton.bind(this))}else{var s=j.getIconUrl();this._bankButtonView.setMainText(o(j.getName()));this._bankButtonView.buttonIcon.setImage(s);this._bankSetupOniOs=(s&&s!=="")}}else{NgLogD("prepareBankButton: is not Platform iOS");this._bankButtonView.setMainText(o("My Mobacoin"));this._bankButtonView.buttonIcon.setImage(b.Assets.image("micons__0008_bank.png"))}this._bankButtonView.setOnClickDown(this._bankButtonAction.prepare.bind(this._bankButtonAction));this._bankButtonView.setOnClickCancel(this._bankButtonAction.cancel.bind(this._bankButtonAction));this._bankButtonView.setOnClick(this.bankButton_clickHandler.bind(this));this._style.applyTo(this);this._gameLaunchedListener=new l();b.GameLaunchedEmitter.addListener(this._gameLaunchedListener,this.gameLaunched_callback.bind(this));var t=new l();c.IPCEmitter.addListener(t,this.ipc_callback.bind(this));c.IPCEmitter.getCallingPackage(this.callingPackage_callback.bind(this));this._lifecycleListenerInstance=new m();c.LifecycleEmitter.addListener(this._lifecycleListenerInstance,this.lifecycle_callback.bind(this));if(b.Session.isCurrentSessionValid()){this._dirtyFriendsListener=new d(this._dirtyFriendsListener_callback.bind(this));if(b.Session.getCurrentSessionUser().usesGuestLogin()){this._dirtySessionListener=new b.SessionListener(this._dirtySessionListener_callback.bind(this))}}NgLogD("mobage: Home initialized");return this},destroy:function(){if(this._gameLaunchedListener){b.GameLaunchedEmitter.removeListener(this._gameLaunchedListener);this._gameLaunchedListener=null}this._leftPaneBackground.release();this._userNamePicView.release();this._lastGameView.release();this._lastGameIcon.release();this._noGameText.release();this._noGameImage.release();this._gamesButtonView.release();this._friendsButtonView.release();this._bankButtonView.release();this._gameCarousel.release();this._alsoPlayingUsersList.release();this._lifecycleListenerInstance.destroy();if(this._dirtyFriendsListener){this._dirtyFriendsListener.destroy();this._dirtyFriendsListener=null}if(this._dirtySessionListener){this._dirtySessionListener.destroy();this._dirtySessionListener=null}},onJSON:function(r){},loadView:function($super){var s=new p();var r=s.getContentView();r.addChild(this._leftPaneBackground);r.addChild(this._userNamePicView);r.addChild(this._lastGameView);r.addChild(this._lastGameIcon);r.addChild(this._noGameImage);r.addChild(this._noGameText);r.addChild(this._gamesButtonView);r.addChild(this._friendsButtonView);if(n.isPlatformIOS()){if(this._bankSetupOniOs){r.addChild(this._bankButtonView)}}else{r.addChild(this._bankButtonView)}r.addChild(this._gameCarousel);r.addChild(this._alsoPlayingUsersList);this.setView(s)},willPush:function($super,r){NgLogD("mobage-home: willPush");$super(r);if(!this._homePushInited){this._pushFirstInit(r)}},_pushFirstInit:function(r){if(r){this._lastEvent=r}else{r=this._lastEvent;if(!r){return}}this._homePushInited=true;if(r.host){r.host.disableSoftNavButtons();if(typeof(r.host.setupForHomeScreen)=="function"){r.host.setupForHomeScreen(true)}}this._layoutViews();this.updateOwnedGames();this.updateFeaturedGames();this.updateFeaturedUsers();this.updateInvitesCount();this.updateCurrentUser();this._updateGameIconWidget();b.Purchase.retryFailedCreditsAux()},_layoutViews:function(){if(!this._style){return}var D=new g.ViewGeometry.Rect(this.view().getFrame());if(D.isEmpty()){this.view().setFrame([0,0,g.Window.getWidth(),g.Window.getHeight()]);D=new g.ViewGeometry.Rect(this.view().getFrame())}var E=new g.ViewGeometry.Rect(this.view().content.getFrame());E.x=E.y=0;var w=E.w*this._style.extras.contentInsetPctWidth;E.inset(w,w,w,w);var t=E.w;var z=E.sliceHorizontal(t*this._style.extras.leftPaneWidth);var y=E;y.inset(0,2,0,t*this._style.extras.leftRightPaneMargin-2);var u=y.h*this._style.extras.rightPaneSectionMargin;var F=y.h*0.5-u/2-3;var s=y.h*0.66-u/2+3;var r=y.sliceVertical(s);this._gameCarousel.setFrame(r);var C=y;C.y+=2;C.h-=u/2;this._alsoPlayingUsersList.setFrame(C);this._leftPaneBackground.setFrame(z);z.inset(1,1,1,1);var v=F*this._style.extras.userNameHeightRatio;var B=F-v-1;var G=(z.h-v-B)/3;var A=z.sliceVertical(v);A.inset(1,1,1,1);this._userNamePicView.setFrame(A);var x=z.sliceVertical(B);x.inset(1,1,1,1);this._lastGameView.setFrame(x);this._lastGameIcon.setFrame(x);this._noGameText.setFrame(x);x.y+=x.h*0.1;x.h/=2.3;this._noGameImage.setFrame(x);A=z.sliceVertical(G);A.inset(1,1,1,1);this._gamesButtonView.setFrame(A);A=z.sliceVertical(G);A.inset(1,1,1,1);this._friendsButtonView.setFrame(A);A=z.sliceVertical(G);A.inset(1,1,1,1);this._bankButtonView.setFrame(A);this._gamesButtonView.layoutSubviews();this._friendsButtonView.layoutSubviews();this._bankButtonView.layoutSubviews();this._userNamePicView.layoutSubviews();this._lastGameIcon.layoutSubviews();this._gameCarousel.layoutSubviews();this._alsoPlayingUsersList.layoutSubviews()},onUserLogin:function(){this.updateCurrentUser();this.updateOwnedGames();this.updateInvitesCount();this._updateGameIconWidget()},updateFeaturedGames:function(){var u=[];var r=b.GameCarouselCache;var s=this.zombieSafeCallback(function(){var w=[];for(var x=0,v=u.length;x<v;x++){var y=u[x];if(!y.localPromotionalImage){y.localPromotionalImage=r.readyImageForGame(y)}if(y.localPromotionalImage){w.push(y)}}this._gameCarousel.setGames(w)});var t=this.zombieSafeCallback(function(){var z=b.CpiProduct.getProductList();if(z.length==0){var v={};var w=b.Assets.image("mobage-promo-image.jpg");v.localPromotionalImage=w.substr(w.indexOf("/")+1);v.screen="Catalog";v.appKey="localPromo";u.push(v);s()}var x="";for(var y=0,A=z.length;y<A;++y){var C=z[y];if(C.promotionalImage){u.push(C);r.addGame(C,s);if(x.length!=0){x+=","}x+=C.appKey}}if(this._launchedMarketAppGame){this._gameCarousel.scrollToGame(this._launchedMarketAppGame.recordID)}this._gameCarousel.startAutoscrolling();var B=b.Session.getCurrentSession();var D=(B)?B.appKey():"";b.MobageAnalytics.reportEvent("CarouselDisplay",{displayed_appkeys:x,current_appkey:D})});b.CpiProduct.loadProducts(t)},updateFeaturedUsers:function(){var t=this;var s=b.Session.getCurrentSession()?b.Session.getCurrentSession().user():null;var u=[];var w=__ngs.r_(__ngs._6w).FeaturedUser;var v=this.zombieSafeCallback(function(y,z,x){var A=(new g.Button()).retain();A.setTouchable(true);w.applyTo(A);A.setImage(z.getDefinedIcon());A.setOnClick(b.ServiceHost.credentialCheckCB(this.zombieSafeCallback(function(){if(this._isTransitioning){return}b.ServiceHost.showLoadingHelper(this.zombieSafeCallback(function(){var C={user:z};var B=b.UserProfilePage.initWithJSON(C);this.navController.pushViewController(B,C,function(){b.ServiceHost.hideLoadingLabel()})}))}),this.zombieSafeCallback(function(){this._alsoPlayingUsersList.startAutoscrolling()})));u.push(A);y(true)});var r=this.zombieSafeCallback(function(x){this._alsoPlayingUsersList.setListViews(u);this._alsoPlayingUsersList.startAutoscrolling()});(s?s:b.User).getFeaturedUsersList().forAll(v,r)},updateInvitesCount:function(){var s=0;var r=b.Session.getCurrentSession()?b.Session.getCurrentSession().user():null;if(r){r.getInvitesList().forAll(this.zombieSafeCallback(function(v,t,u){if(t.isMutualFriend){v(true)}v(++s<=99)}),this.zombieSafeCallback(function(u){NgLogE("Finished counting Requests users, total count = "+s);if(s>0&&s!=this._lastInvitesSeenCount){var t=s;if(s>99){t="99+"}this._curInvitesCount=s;this._friendsButtonView.setBadgeCount(t);this._friendsButtonHasBadge=true}else{this.updateFriendsCount()}}))}},updateFriendsCount:function(){var s=this;var r=b.Session.getCurrentSession()?b.Session.getCurrentSession().user():null;if(r){var t=0;r.getMutualFriendsList().forAll(this.zombieSafeCallback(function(w,u,v){t++;w(true)}),this.zombieSafeCallback(function(u){if(u){NgLogD("updating buddies list, got error: ",JSON.stringify(u))}else{if(t>999){this._friendsButtonView.setCountText("999+")}else{this._friendsButtonView.setCountText(t)}this._friendsButtonHasBadge=false}}))}},_showGetMoreGamesPlaceholder:function(){this._noGameText.setText(o("Download a free game\n to get started!"));this._noGameImage.setImage(b.Assets.image("home_nogames_icon.png"));this._lastGameIcon.setGame("","",true);this._currentLastGameObj=null},_updateGameIconWidget:function(){if(!this.navController||!this.navController._host){return}if(this._launchedGame){NgLogD("Home Screen Last played icon: Using LAUNCHED game. url="+this._launchedGame.iconURL+", name="+this._launchedGame.name);this._noGameText.setText("");this._noGameImage.setImage("");this._lastGameIcon.setGame(this._launchedGame.iconURL,this._launchedGame.name);this._currentLastGameObj=this._launchedGame}else{if(this.navController._host.isRunningActiveGame()){b.Game.getCurrentGame(this.zombieSafeCallback(function(y,x){if(!y||this._currentLastGameObj){if(y){x=this._currentLastGameObj}NgLogD("Home Screen Last played icon: Using active game. url="+x.iconURL+", name="+x.name);this._noGameText.setText("");this._noGameImage.setImage("");this._lastGameIcon.setGame(x.iconURL,x.name);this._alsoPlayingUsersList.setTitle(o("People playing %1s",x.name));this._currentLastGameObj=x}else{NgLogD("Home Screen Last played icon: I think an active game is running but I failed to get it, Err: "+y);this._showGetMoreGamesPlaceholder()}}))}else{var s="com.mobage.ww.local_last_played_game.";var v=q.KeyValueCache.local;if(!v){q.KeyValueCache.init();v=q.KeyValueCache.local}var w=b.Session.getCurrentSession();var r=w?w.user():null;var t=r?r.gamertag:"nobody";var u=s+t;v.getItem(u,this.zombieSafeCallback(function(y,x){if((!y)&&x){b.Game.getGameWithAppKey(x,this.zombieSafeCallback(function(A,z){if(!A&&z){NgLogD("Home Screen Last played icon: Using last played game. url="+z.iconURL+", name="+z.name);this._noGameText.setText("");this._noGameImage.setImage("");this._lastGameIcon.setGame(z.iconURL,z.name);this._currentLastGameObj=z}else{NgLogE("Home Screen Last played icon: Couldnt get a recently played game. Err: "+A);this._showGetMoreGamesPlaceholder()}}));return}else{NgLogE("Home Screen Last played icon: No last game in KV store. Err: "+y);this._showGetMoreGamesPlaceholder()}}))}}},updateBankButton:function(v,s,r){if(this.isDestroyed()){return}b.Session.getCurrentSession().setCurrency(s,r);var u="";var w=null;var t=false;if(!v){if(!s){NgLogE("Home: Failed to retrieve game currency details "+v)}else{u=o(s)}if(!r||r===""){NgLogD("No currency icon from the server.")}else{NgLogD("Has currency icon from the server.");w=r;t=true}}this._bankButtonView.setMainText(u);this._bankButtonView.buttonIcon.setImage(w);this._bankSetupOniOs=t;if(t){this.view().getContentView().addChild(this._bankButtonView)}else{this._bankButtonView.removeFromParent()}},updateOwnedGames:function(){var t=this;var r=b.Session.getCurrentSession()?b.Session.getCurrentSession().user():null;if(r){var s=0;r.getOwnedGamesList().forAll(this.zombieSafeCallback(function(v,w,u){s++;v(true)}),this.zombieSafeCallback(function(u){if(s===0){this._gamesButtonView.setCountText("")}else{this._gamesButtonView.setCountText(s)}}))}},updateCurrentUser:function(){var s=b.Session.getCurrentSession();var r=s?s.user():null;if(r){this._userNamePicView.setUserInfo(r.gamertag,r.getDefinedIcon(),0);r.getUnreadWallPostCount(this.zombieSafeCallback(function(u,t){this._userNamePicView.setBadgeCount(t)}))}else{this._userNamePicView.setUserInfo(o("Sign Up"),b.Assets.image("no-user-icon.png"),0)}},willReshow:function($super,r){NgLogD("mobage-home: willReshow");$super(r);this._isTransitioning=true;if(!this._homePushInited){this._pushFirstInit(r)}this.updateCurrentUser();this.updateOwnedGames();this.updateInvitesCount();if(r.host){r.host.disableSoftNavButtons();if(typeof(r.host.setupForHomeScreen)=="function"){r.host.setupForHomeScreen(true)}}if(b.Main.getNewLaunchGame()){this._launchedGame=b.Main.getNewLaunchGame();b.Main.setNewLaunchGame(null)}this._updateGameIconWidget();this.setAnimationsEnabled(true);b.Purchase.retryFailedCreditsAux()},setAnimationsEnabled:function(r){if(r){if(this._gameCarousel){this._gameCarousel.startAutoscrolling()}if(this._alsoPlayingUsersList){this._alsoPlayingUsersList.startAutoscrolling()}}else{if(this._gameCarousel){this._gameCarousel.stopAutoscrolling()}if(this._alsoPlayingUsersList){this._alsoPlayingUsersList.stopAutoscrolling()}}},didReshow:function($super,r){NgLogD("mobage-home: didReshow");$super(r);this._isTransitioning=false;this._shouldAnimate=true;this._updateGameIconWidget()},willHide:function($super,r){$super(r);this._isTransitioning=true;this._shouldAnimate=false;if(this._alsoPlayingUsersList){this._alsoPlayingUsersList.stopAutoscrolling()}this.setAnimationsEnabled(false)},willPop:function($super,r){$super(r);this._isTransitioning=true;this._shouldAnimate=false;this.setAnimationsEnabled(false)},didHide:function($super,r){this._alsoPlayingUsersList.list.setScrollPosition([0,0]);this._isTransitioning=false;if(r.host){r.host.enableSoftNavButtons();if(typeof(r.host.setupForHomeScreen)=="function"){r.host.setupForHomeScreen(false)}}},didPop:function($super,r){this._isTransitioning=false;if(r&&r.host){r.host.enableSoftNavButtons();if(typeof(r.host.setupForHomeScreen)=="function"){r.host.setupForHomeScreen(false)}}},didPush:function($super,r){q.KeyValueCache.local.getItem("Mobage_DidJSUpdate",function(s,t){if(!s){if(t==="1"){var u=(new g.AlertDialog()).retain();u.setTitle(o("Mobage Updated"));u.setText(o("Mobage just got a little bit better! Enjoy!"));u.setChoices([o("OK")]);u.onchoice=function(v){u.release()};u.show()}}q.KeyValueCache.local.setItem("Mobage_DidJSUpdate","")});this._isTransitioning=false;$super(r);this.navController._host.hideLoadingLabel();b.Main.handleFirstLaunchIntent()},userNamePic_clickHandler:function(){if(!b.Session.isCurrentSessionValid()){b.CustomModalDialog.show();return}e.pushScreen(this.navController,"MyPage",{},{analyticsName:"HomeCurrentUserPic"})},lastGameIcon_clickHandler:function(){if(this.isDestroyed()){return}if(!b.Session.isCurrentSessionValid()){b.CustomModalDialog.show();return}b.ServiceHost.showLoadingHelper(function(){if(this.isDestroyed()){b.ServiceHost.hideLoadingLabel();return}if(this.navController._host.isRunningActiveGame()&&(!this._currentLastGameObj||this._currentLastGameObj.recordID==b.Session.getCurrentSession().appKey())){e.pushScreen(this.navController,"GamePlaceholder",{host:this.navController._host,game:"AhabTester_hardcoded"},{analyticsName:"HomeLastGameIcon"})}else{if(this._currentLastGameObj){e.loadThenAct("GameProfile",function(r){r.startGameOrGoToProfile(this._currentLastGameObj,"JSGamePlayHomeLastGame")})}else{e.pushScreen(this.navController,"Catalog",{},{analyticsName:"HomeLastGameIcon"})}}}.bind(this))},gameCarousel_gameClickHandler:function(s){if(this.isDestroyed()){return}if(this._isTransitioning){return}if(!b.Session.isCurrentSessionValid()){b.CustomModalDialog.show();return}if(s&&s.screen){e.pushScreen(this.navController,s.screen,{})}else{if(s instanceof b.CpiProduct){s.acceptOffer()}}var t=b.Session.getCurrentSession();var r={screen:"carousel",carousel_transition:"direct",current_appkey:(t)?t.appKey():"",list_slotnum:this._gameCarousel.selectedGameIndex()};if(s instanceof b.CpiProduct){r.appkey=s.appKey;r.is_featured=false;r.is_incented=Boolean(s);r.campaign_id=(s&&s.campaign)?s.campaign.recordID:"";r.featured_slotnum=this._gameCarousel.getFeaturedSlotNum(s.appKey);r.incent_amt=(s&&s.hasOwnProperty("mobacoin"))?s.mobacoin:0}else{r.appkey="";r.is_featured=false;r.is_incented=false;r.campaign_id="";r.featured_slotnum=-1;r.incent_amt=0}b.MobageAnalytics.reportEvent("GameClick",r)},findGames_clickHandler:function(){if(this.isDestroyed()){return}if(this._isTransitioning){return}if(!b.Session.isCurrentSessionValid()){b.CustomModalDialog.show();return}e.pushScreen(this.navController,"Catalog",{},{analyticsName:"HomeFindGamesButton"})},alsoPlayingUsersList_clickHandler:function(){if(this.isDestroyed()){return}if(this._isTransitioning){return}if(!b.Session.isCurrentSessionValid()){b.CustomModalDialog.show();return}e.pushScreen(this.navController,"FindFriends",{tab:"suggested"},{analyticsName:"FindPeople"})},gamesButton_clickHandler:function(){if(this.isDestroyed()){return}if(this._isTransitioning){return}if(!b.Session.isCurrentSessionValid()){b.CustomModalDialog.show();return}e.pushScreen(this.navController,"MyPage",{tab:"games"},{analyticsName:"HomeMyGamesButton"})},friendsButton_clickHandler:function(){if(this.isDestroyed()){return}if(this._isTransitioning){return}if(!b.Session.isCurrentSessionValid()){b.CustomModalDialog.show();return}var r=null;if(this._friendsButtonHasBadge){r={tab:"invites"}}else{r={tab:"friends"}}this._lastInvitesSeenCount=this._curInvitesCount;NgLogD("this._lastInvitesSeen:"+this._curInvitesCount);e.pushScreen(this.navController,"MyPage",r,{analyticsName:"HomeMyFriendsButton"})},bankButton_clickHandler:function(){if(this.isDestroyed()){return}b.ServiceHost.showLoadingLabel();b.MobageAnalytics.reportEvent("BankMobageHomeBankClick");this._bankButtonAction.execute()},gameLaunched_callback:function(){if(this.isDestroyed()){return}this._launchedGame=undefined;this._updateGameIconWidget()},ipc_callback:function(s){if(this.isDestroyed()){return}if(s&&s.getExtras&&s.getExtras()&&s.getExtras().callingPackage){var r=s.getExtras().callingPackage;this._onIntentReceived(r)}},callingPackage_callback:function(r){if(this.isDestroyed()){return}this._onIntentReceived(r)},_onIntentReceived:function(r){b.Game._getGameWithAndroidPackageName(r,this.zombieSafeCallback(function(t,s){NgLogD("Market app "+r+" has game "+s);if(s){if(this._gameCarousel&&this._gameCarousel.hasGame(s.recordID)){this._gameCarousel.stopAutoscrolling();this._gameCarousel.layoutSubviews();this._gameCarousel.scrollToGame(s.recordID);this._gameCarousel.startAutoscrolling()}else{this._launchedMarketAppGame=s}}}))},_dirtyFriendsListener_callback:function(){if(this.isDestroyed()){if(this._dirtyFriendsListener){this._dirtyFriendsListener.destroy();this._dirtyFriendsListener=null}return}this._lastInvitesSeenCount=0;if(this.navController&&this.navController.getTopViewController()==this){this.updateInvitesCount()}},_dirtySessionListener_callback:function(r){if(this.isDestroyed()){if(this._dirtySessionListener){this._dirtySessionListener.destroy();this._dirtySessionListener=null}return}this.updateCurrentUser()},lifecycle_callback:function(r){if(r===c.LifecycleEmitter.Event.Suspend){this.setAnimationsEnabled(false)}else{if(r===c.LifecycleEmitter.Event.Resume&&this._shouldAnimate){this.setAnimationsEnabled(true)}}return true}});var d=h.DirtyFriendsListener=l.subclass({callback:null,_user:null,initialize:function($super,s,r){$super();this.callback=s;this._user=(r)?r:b.Session.getCurrentSessionUser();this._user.addListener(this,this._onEvent.bind(this))},_onEvent:function(r){if(r&&r.buddies&&typeof this.callback=="function"){this.callback()}},destroy:function(){if(this._user){this._user.removeListener(this);this._user=null}this.callback=null}});var m=l.subclass({destroy:function(){c.LayoutEmitter.removeListener(this)}})}};__ngs._4r={_c:null,_d:function(){var d={exports:{}};var j=d.exports;this._c=d;var l=__ngs.r_(__ngs._6e).MobageVerticalTabController;var h=__ngs.r_(__ngs._2z).Assets;var m=__ngs.r_(__ngs._n).LocalizedString;var g=__ngs.r_(__ngs._o).Session;var k=__ngs.r_(__ngs._6x).CurrentUserProfileController;var o=__ngs.r_(__ngs._6y).FriendsController;var f=__ngs.r_(__ngs._6z).InvitesController;var e=__ngs.r_(__ngs._70).GamesController;var n=__ngs.r_(__ngs._71).AvatarImagePicker;var c=__ngs.r_(__ngs._4q).DirtyFriendsListener;var b=__ngs.r_(__ngs._2a).Destinations;var a=j.MyPage=l.subclass({classname:"MyPage",_user:null,_profileController:null,_friendsController:null,_invitesController:null,_gamesController:null,_findFriendsButton:null,_settingsButton:null,_dirtyFriendsListener:null,_tabToSelect:"",initialize:function($super,q,p){$super();this._scrollToSection=p;this._tabToSelect=q;this._profileController=(new k(this._switchTabToFriends.bind(this),this._switchTabToGames.bind(this))).retain();this._user=g.getCurrentSessionUser();this._friendsController=(new o(this._user)).retain();this._invitesController=(new f(this._user)).retain();this._gamesController=(new e(this._user)).retain();this.updateInvitesCount();this.updateFriendsCount();this._dirtyFriendsListener=new c(this._dirtyFriendsListener_callback.bind(this));return this},updateInvitesCount:function(){if(this._updatingInvites){return}this._updatingInvites=true;var p=0;this._totalInvites=0;g.getCurrentSessionUser().getInvitesList().forAll(this.zombieSafeCallback(function(s,q,r){if(q.isMutualFriend){s(true);return}s(++p<=99)}),this.zombieSafeCallback(function(q){NgLogE("Finished counting Requests users, total count = "+p);this._totalInvites=p;this._updatingInvites=false;if(q){return}this.setInviteTabText((this._totalInvites>99)?"99+":this._totalInvites)}))},updateFriendsCount:function(){if(!g.isCurrentSessionValid()){return}if(this._updatingFriends){return}this._updatingFriends=true;var p=0;this._totalFriends=0;g.getCurrentSessionUser().getMutualFriendsList().forAll(this.zombieSafeCallback(function(s,q,r){p++;s(true)}),this.zombieSafeCallback(function(q){this._updatingFriends=false;this._totalFriends=p;if(q){return}this.setFriendsTabText((this._totalFriends>999)?"999+":this._totalFriends)}))},_dirtyFriendsListener_callback:function(){if(this.isDestroyed()){if(this._dirtyFriendsListener){this._dirtyFriendsListener.destroy();this._dirtyFriendsListener=null}return}this.updateInvitesCount();this.updateFriendsCount()},setInviteTabText:function(q){var p=this._invitesTab;if(p){p.rightAccessory.setText(q)}},setFriendsTabText:function(q){var p=this._friendsTab;if(p){p.rightAccessory.setText(q)}},$initWithJSON:function(r){var q=null;var p=null;if(r.tab){q=r.tab}if(r.section){NgLogException(new Error("Scrolling to a section is currently disabled. Report if you need this!"));p=r.section}return new a(q,p)},onJSON:function(p){if(p.tab){this._switchTab(p.tab)}return null},loadView:function($super){$super();NgLogD("MyPage: loadView");this.batchChangeMode=true;this.addTabWithTextImageAndContent(m("Profile"),h.image("micons__0006_editprofile.png"),this._profileController.view());this.addTabWithTextImageAndContent(m("Games"),h.image("micons__0004_games1.png"),this._gamesController.view());var q=this.addTabWithTextImageAndContent(m("Friends"),h.image("mypage_tabbadge_friends.png"),this._friendsController.view(),true);this._friendsTab=this.tabPairAtIndex(q).tabView;var p=this.addTabWithTextImageAndContent(m("Friend Requests"),h.image("mypage_tabbadge_invites.png"),this._invitesController.view(),true);this._invitesTab=this.tabPairAtIndex(p).tabView;if(this._totalInvites>0){this._invitesTab.rightAccessory.setText(this._totalInvites)}this.addJumpWithTitleAndCallback(m("Find Friends"),function(){NgLogD("FindFriends Button Clicked.");b.pushScreen(this.navController,"FindFriends",{tab:"suggested"},this)}.bind(this));NgLogD("MyPage: loadView Main Setup finished.");this.batchChangeMode=false;NgLogD("MyPage: loadView finished.")},destroy:function(){if(this._profileController){this._profileController.release();this._profileController=null}if(this._friendsController){this._friendsController.release();this._friendsController=null}if(this._invitesController){this._invitesController.release();this._invitesController=null}if(this._gamesController){this._gamesController.release();this._gamesController=null}},willPush:function($super,p){$super(p);this._switchTab(this._tabToSelect)},didPush:function($super,p){if(this._scrollToSection){this.view().setScrollToSection(this._scrollToSection)}$super(p)},willPop:function($super,p){$super(p);n.cleanup()},willHide:function($super,p){$super(p);n.cleanup()},_switchTabToFriends:function(){this._switchTab("friends")},_switchTabToGames:function(){this._switchTab("games")},_switchTab:function(p){switch(p){case"invites":this.selectTabAtIndex(3);break;case"friends":this.selectTabAtIndex(2);break;case"games":this.selectTabAtIndex(1);break;default:this.selectTabAtIndex(0);break}}})}};__ngs._4s={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var e=__ngs.r_(__ngs._6e).MobageVerticalTabController;var a=__ngs.r_(__ngs._2a).Destinations;var d=b.Settings=e.subclass({classname:"Settings",editProfileController:null,accountSettingsController:null,passwordController:null,initialize:function($super,j,g){$super();var h=__ngs.r_(__ngs._72).ProfileSettingsController;var f=__ngs.r_(__ngs._73).AccountSettingsController;var k=__ngs.r_(__ngs._74).PasswordController;this.editProfileController=(new h()).retain();this.accountSettingsController=(new f()).retain();this.passwordController=(new k()).retain();this.tabToSelect=j;this.editProfileController.onSaveCallback=g;return this},$initWithJSON:function(h){var g=null;var f=null;if(h.tab){g=h.tab}if(h.onSaveCallback){f=h.onSaveCallback}return new d(g,f)},onJSON:function(f){if(f.tab){if(f.tab=="password"){this.selectTabAtIndex(2)}else{if(f.tab=="account"){this.selectTabAtIndex(1)}else{this.selectTabAtIndex(0)}}}return null},loadView:function($super){$super();NgLogD("Settings: loadView");this.batchChangeMode=true;var h=__ngs.r_(__ngs._2z).Assets;var g=__ngs.r_(__ngs._n).LocalizedString;this.addTabWithTextImageAndContent(g("Edit Profile"),h.image("settings_tabbadge_profile.png"),this.editProfileController.view());var f=g("Account Settings");if(f=="Account-Einstellungen"){f="Account-\nEinstellungen"}this.addTabWithTextImageAndContent(f,h.image("settings_tabbadge_account.png"),this.accountSettingsController.view());this.addTabWithTextImageAndContent(g("Change Password"),h.image("settings_tabbadge_password.png"),this.passwordController.view());this.addJumpWithTitleAndCallback(g("My Page"),function(){NgLogD("My Page Button Clicked.");__ngs.r_(__ngs._2a).Destinations.pushScreen(this.navController,"MyPage",{tab:"profile"},this)}.bind(this));this.batchChangeMode=false;NgLogD("Settings: loadView finished.")},destroy:function(){NgLogD("Settings: destroy");if(this.editProfileController!==null){this.editProfileController.release();this.editProfileController=null}if(this.accountSettingsController!==null){this.accountSettingsController.release();this.accountSettingsController=null}if(this.passwordController!==null){this.passwordController.release();this.passwordController=null}},selectTabByView:function($super,f){$super(f)},willPush:function($super,f){$super(f);if(this.tabToSelect=="password"){this.selectTabAtIndex(2)}else{if(this.tabToSelect=="account"){this.selectTabAtIndex(1)}else{this.selectTabAtIndex(0)}}return}})}};__ngs._4t={_c:null,_d:function(){var d={exports:{}};var g=d.exports;this._c=d;var l=__ngs.r_(__ngs._5).Core;var f=__ngs.r_(__ngs._59).UI;var c=f.ViewGeometry.Scale;var j=__ngs.r_(__ngs._n).Localization;var e=__ngs.r_(__ngs._q).MobageAnalytics;var h=__ngs.r_(__ngs._5y).NavigableViewController;var b=__ngs.r_(__ngs._o);var a=new (__ngs.r_(__ngs._2b).InterfaceLoader)({NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils}});var k=g.SupportWebScreen=h.subclass({classname:"SupportWebScreen",initialize:function($super,m){$super();if(m&&m!==""){this._contentUrl=m}else{this._contentUrl=this.createDefaultURL()}NgLogD("SupportWebScreen: url = "+this._contentUrl);this._totalWidth=l.Capabilities.getScreenHeight();this._totalHeight=l.Capabilities.getScreenWidth()},$initWithJSON:function(m){return new k()},destroy:function(){if(this.spinner){this.spinner.release()}if(this._retainedViews){for(var m=0;m<this._retainedViews.length;m++){var n=this._retainedViews[m];if(n){n.release()}}}this._retainedViews=new Array()},retainView:function(m){if(m){m.retain();if(!this._retainedViews){this._retainedViews=new Array()}this._retainedViews.push(m)}return m},loadView:function($super){$super();var m=new f.ViewGeometry.Rect([0,0,this._totalWidth,this._totalHeight]);m.sliceVertical(13.75,f.Scale.Percent);m.y+=2;m.h-=2;var n=new f.ViewGeometry.Rect([(this._totalWidth-100)/2,(this._totalHeight-100)/2,100,100]);this.spinner=new f.Spinner();this.spinner.setFrame(n);this.spinner.retain();this.webView=this.retainView(new f.WebView());this.webView.setFrame(m);this.webView.setGradient({gradient:["FFFF 0.0"]});this.webView.loadUrl(this._contentUrl,{"Accept-Language":j.getAcceptLanguage()});this.webView.onpageload=function(){this.spinner.release()}.bind(this);this.view().addChild(this.webView);this.view().addChild(this.spinner)},willHide:function($super,m){if(typeof $super==="function"){$super(m)}if(this.webView){this.webView.removeFromParent();this.view().addChild(this.webView)}},willPop:function($super,m){if(typeof $super==="function"){$super(m)}if(this.webView){this.webView.removeFromParent();this.view().addChild(this.webView)}},willPush:function($super,n){if(typeof $super==="function"){$super(n)}var m;if(this.navController&&this.navController.getTopViewController&&(m=this.navController.getTopViewController())){e.logNavEvent((m.classname||"UNKNOWN"),this.classname)}},didPush:function($super,m){if(typeof $super==="function"){$super(m)}this.navController._host.hideLoadingLabel()},createDefaultURL:function(){var n="";var u="";var y="";var v="";var z="";var o="";var m=b.Session.getCurrentSession();if(m){var r=m.user();if(r){n=r.gamertag;v=r.emailAddress;u=r.recordID;y=r.grade}z=m.appKey();o=m.appVersion()}var t=l.Capabilities.getSDKVersion();var w=a.NetworkUtils.getDeviceIdForPlatformServer();var p=l.Capabilities.getDeviceName();var A=l.Capabilities.getPlatformOS()+l.Capabilities.getPlatformOSVersion();var x=l.Capabilities.getLocale();var s=j.getAcceptLanguage();var q="http://support.mobage.com/?gamertag="+encodeURIComponent(n)+"&email="+encodeURIComponent(v)+"&game="+encodeURIComponent(z)+"&game_version="+encodeURIComponent(o)+"&device_id="+encodeURIComponent(w)+"&device_type="+encodeURIComponent(p)+"&device_os="+encodeURIComponent(A)+"&sdk_version="+encodeURIComponent(t)+"&user_id="+encodeURIComponent(u)+"&locale="+encodeURIComponent(x)+"&language="+encodeURIComponent(s)+"&grade="+encodeURIComponent(y);return q}})}};__ngs._4u={_c:null,_d:function(){var c={exports:{}};var g=c.exports;this._c=c;var h=__ngs.r_(__ngs._6e).MobageVerticalTabController;var f=__ngs.r_(__ngs._2z).Assets;var l=__ngs.r_(__ngs._n).LocalizedString;var e=__ngs.r_(__ngs._o).Session;var j=__ngs.r_(__ngs._75).UserProfileController;var m=__ngs.r_(__ngs._6y).FriendsController;var d=__ngs.r_(__ngs._70).GamesController;var b=__ngs.r_(__ngs._4r).MyPage;var a=__ngs.r_(__ngs._2a).Destinations;var k=g.UserProfilePage=h.subclass({classname:"UserProfilePage",_user:null,_profileController:null,_friendsController:null,_gamesController:null,_findFriendsButton:null,_settingsButton:null,_tabToSelect:"",initialize:function($super,o,n){$super();this._user=n;this._tabToSelect=o;this._profileController=(new j(this._user,this._switchTabToFriends.bind(this),this._switchTabToGames.bind(this))).retain();this._friendsController=(new m(this._user)).retain();this._gamesController=(new d(this._user)).retain();return this},$initWithJSON:function(p){if(e.getCurrentSession()&&e.getCurrentSession().user().is(p.user)){return b.initWithJSON(p)}var o=null;var n=null;if(p.tab){o=p.tab}if(p.user){n=p.user}return new k(o,n)},onJSON:function(n){if(n.user&&n.user!=this._user){return k.initWithJSON(n)}if(n.tab){this._switchTab(n.tab)}return null},loadView:function($super){$super();NgLogD("UserProfilePage: loadView");this.batchChangeMode=true;this.addTabWithTextImageAndContent(l("Profile"),f.image("mypage_tabbadge_profile.png"),this._profileController.view());this.addTabWithTextImageAndContent(l("Games"),f.image("micons__0004_games1.png"),this._gamesController.view());this.addTabWithTextImageAndContent(l("Friends"),f.image("mypage_tabbadge_friends.png"),this._friendsController.view());this.addJumpWithTitleAndCallback(l("My Profile"),function(){NgLogD("My Profile Jump Button Clicked");a.pushScreen(this.navController,"MyPage",{},{analyticsName:"UserProfileJumpToMyPage"})}.bind(this));NgLogD("UserProfilePage: loadView Main Setup finished.");this.batchChangeMode=false;NgLogD("UserProfilePage: loadView finished.")},destroy:function(){if(this._profileController){this._profileController.release();this._profileController=null}if(this._friendsController){this._friendsController.release();this._friendsController=null}if(this._gamesController){this._gamesController.release();this._gamesController=null}},equals:function(n){if(!n._user){return false}return(this._user.recordID==n._user.recordID)},willPush:function($super,n){$super(n);this._switchTab(this._tabToSelect)},_switchTabToFriends:function(){this._switchTab("friends")},_switchTabToGames:function(){this._switchTab("games")},_switchTab:function(n){switch(n){case"friends":this.selectTabAtIndex(2);break;case"games":this.selectTabAtIndex(1);break;default:this.selectTabAtIndex(0);break}},getUser:function(){return this._user}})}};__ngs._4v={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Registration={initWithJSON:function(h){var d=h?h.cb:null;var g=h?h.useFacebook:null;var f=h?h.showUpgradeFlow:null;var k=h?h.regFlowVariant:null;var j=h?h.startView:null;var e=h?h.regReferrer:null;var c=__ngs.r_(__ngs._7).Capabilities;return new (__ngs.r_(__ngs._76).FacebookRegistration)(d,g,f,k,j,e)},onJSON:function(c){return null}}}};__ngs._4w={_c:null,_d:function(){var e={exports:{}};var g=e.exports;this._c=e;var n=__ngs.r_(__ngs._7).Capabilities;var k=__ngs.r_(__ngs._w).MessageListener;var o=__ngs.r_(__ngs._1f).LayoutEmitter;var f=__ngs.r_(__ngs._59).UI;var b=f.ViewGeometry.Rect;var a=new (__ngs.r_(__ngs._f).RequireLoader)({UIStyle:function(){return __ngs.r_(__ngs._60).Style},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics},GameLaunchedEmitter:function(){return __ngs.r_(__ngs._2g).GameLaunchedEmitter},GameLaunchingProgress:function(){return __ngs.r_(__ngs._52).GameLaunchingProgress},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},Main:function(){return __ngs.r_(__ngs._m).Main}});var p=__ngs.r_(__ngs._n).LocalizedString;var m=__ngs.r_(__ngs._77).Primitives;var d=__ngs.r_(__ngs._2a).Destinations;var h=__ngs.r_(__ngs._5y).NavigableViewController;var c=g.GamePlaceholder=h.subclass({classname:"GamePlaceholder",analyticsName:"NavPlaceholder",isLocked:false,targetGame:null,initialize:function($super,u,t,v){$super();this._host=u;this.targetGame=t;if(v){this.isLocked=true}var s=n.getScreenHeight();var r=n.getScreenWidth();var q=(s>r)?s:r;this.progressVeil=new f.View();this.progressVeil.setFrame([0,0,q,q]);this.progressVeil.setGradient(a.UIStyle.registeredStyle("social.us.progressveil").props().gradient);this._gameLaunchedListener=new k();a.GameLaunchedEmitter.addListener(this._gameLaunchedListener,this.bind(this._onGameLaunched));this._showingFullScreenLoadingSpinner=false;return this},destroy:function(){NgLogD("GamePlaceholder destroy");if(this._onLaunchDoneCB&&!this._launchFailed){NgLogD("WARNING!!! Attempted to destroy game placeholder in the middle of a game launch.");a.MobageAnalytics.reportEvent("JSGameLaunchFailed",{error:"destroyed placeholder during load"});return}a.GameLaunchingProgress.hideDialog(this);this._gameLaunchedListener.destroy();this.progressVeil.destroy()},equals:function(q){return this.targetGame==q.targetGame},$initWithJSON:function(q){if(!q.host){NgLogE("GamePlaceholder.initWithJSON - No host specified, cannot create.");return null}if(!q.game){NgLogE("GamePlaceholder.initWithJSON - No game specified, cannot create.");return null}return new c(q.host,q.game)},onJSON:function(q){if(q.game){if(q.game!==this.targetGame){return c.initWithJSON(q)}}return null},loadView:function($super){if(!this._view){this.setView(new m.View())}$super()},willPush:function($super,q){NgLogD("GamePlaceholder/willPush");$super(q);a.ServiceHost.setIsInServiceUI(false)},willReshow:function($super,r){NgLogD("GamePlaceholder/willReshow");$super(r);var q=a.ServiceHost.getGameOrientation();this._showingFullScreenLoadingSpinner=!a.ServiceHost.isSupportedOrientation(q);if(this._showingFullScreenLoadingSpinner){a.ServiceHost.view().showFullScreenLoadingSpinner()}a.ServiceHost.setIsInServiceUI(false)},didPush:function($super,q){NgLogD("GamePlaceholder/didPush");$super(q);a.GameLaunchingProgress.hideDialog(this);this.navController._host.hide();if(this._veilShowing){this._veilShowing=false;f.Window.document.removeChild(this.progressVeil)}},willPop:function($super,q){NgLogD("GamePlaceholder/willPop");$super(q);f.Window.document.addChild(this.progressVeil);this._veilShowing=true;a.GameLaunchingProgress.hideDialog(this);this.navController._host.show()},didPop:function($super,q){NgLogD("GamePlaceholder/didPop");$super(q);if(this._veilShowing){this._veilShowing=false;f.Window.document.removeChild(this.progressVeil)}a.ServiceHost.setIsInServiceUI(true)},didHide:function($super,q){NgLogD("GamePlaceholder/didHide");$super(q);a.ServiceHost.setIsInServiceUI(true)},didReshow:function($super,q){NgLogD("GamePlaceholder/didReshow");$super(q);a.GameLaunchingProgress.hideDialog(this);this.navController._host.hide();if(this._veilShowing){this._veilShowing=false;f.Window.document.removeChild(this.progressVeil)}},willHide:function($super,q){NgLogD("GamePlaceholder/willHide");$super(q);a.GameLaunchingProgress.hideDialog(this);this.navController._host.show()},launchGame:function(r,s){this._onLaunchDoneCB=s;f.Window.document.addChild(this.progressVeil);this._veilShowing=true;a.GameLaunchingProgress.showDialog(this,r.name);var q=this;a.Main.switchToGame(r.getGameURL(),function(t){if(t){q._onLaunchDoneCB(t);q._onLaunchDoneCB=null}})},_onGameLaunched:function(){NgLogD("GamePlaceholder/_onGameLaunched");if(this._onLaunchDoneCB){this._onLaunchDoneCB(null);this._onLaunchDoneCB=null}},$switchToRunningGame:function(){var q=new c(a.ServiceHost.navController._host,"AhabTester_hardcoded");a.ServiceHost.navController.pushViewController(q)},$launchGameAndSwitch:function(q){a.MobageAnalytics.reportEvent("JSGameLaunchStart",q.recordID);var r=new c(a.ServiceHost.navController._host,q.getGameURL(),false);r.launchGame(q,function(s){if(!s){NgLogD("GamePlaceholder.launchGameAndSwitch - Game launch succeeded");a.MobageAnalytics.reportEvent("JSGameLaunchSuccess",q.recordID);a.ServiceHost.navController.pushViewController(r)}else{NgLogD("GamePlaceholder.launchGameAndSwitch - Game launch failed, killing placeholder screen. Err: "+s);a.MobageAnalytics.reportEvent("JSGameLaunchFailed",{error:"switchToGameFailed",game:q.recordID});r._launchFailed=true;r.destroy();a.UIUtils.showAlert(p("Error"),p("Couldn't connect.\nPlease try again."))}})}});var l=m.View.subclass({classname:"InterstitialSplashScreenView",_trueSize:null,initialize:function($super,q){$super(q);this._trueSize=[n.getScreenHeight(),n.getScreenHeight()]}});var j=g.InterstitialSplashScreen=h.subclass({classname:"InterstitialSplashScreen",analyticsName:"InterstitialSplashScreen",initialize:function($super,q){$super();this.onDidPush=q},destroy:function(){if(this.lListener){this.lListener.destroy()}},didPush:function($super,q){$super(q);if(this.onDidPush){this.onDidPush()}},didHide:function($super,q){$super(q);if(this.onDidHide){this.onDidHide()}},loadView:function($super){if(!this._view){this.setView(new l())}$super();this.lListener=new k();o.addListener(this.lListener,this.zombieSafeCallback(this.layoutUpdate))},layoutUpdate:function(q){this.view().setFrameSize([q.width,q.height])}})}};__ngs._4x={_c:null,_d:function(){var d={exports:{}};var z=d.exports;this._c=d;var w=__ngs.r_(__ngs._7).Capabilities;var l=__ngs.r_(__ngs._59).UI;var c=__ngs.r_(__ngs._n).LocalizedString;var n=__ngs.r_(__ngs._2a).Destinations;var e=__ngs.r_(__ngs._5y).NavigableViewController;var A=__ngs.r_(__ngs._78).AccordionListView;var t=__ngs.r_(__ngs._79).MBListViewSection;var s=__ngs.r_(__ngs._7a).ContactsSectionTitleView;var g=__ngs.r_(__ngs._77).Primitives;var m=__ngs.r_(__ngs._7b).SystemInfoCell;var v=new (__ngs.r_(__ngs._f).RequireLoader)({AppConfig:function(){return __ngs.r_(__ngs._29).AppConfig},PlusRequest:function(){return __ngs.r_(__ngs._28).PlusRequest}});var o=["getContentUrl","mobagePlatformVersion","mobageServerURL","mobageAnalyticsServerURL","getSDKVersion","getSDKBuildDate","getSDKBuildHash","getBootDir","getGameDir","getAppReleaseVersion","getBundleIdentifier","getBinaryVersion","getBinaryBuildDate","getBinaryBuildHash","getPlatformOS","getPlatformOSVersion","_getBootServer","_getBoot","getBootGame","getStartingServer","getBundleServer","getBundleGame","getGame","getServer","getUrl"];var f={SDKVersion:"SDK Version",SDKBuildDate:"SDK Build Date",SDKBuildHash:"SDK Build Hash",PlatformOS:"Platform OS",PlatformOSVersion:"Platform OS Version",PlatformHW:"Platform Hardware",OglExtensions:"OpenGL Extensions",SourceAppID:"Source Application ID",ScreenWidth:"Screen Pixel Width",ScreenHeight:"Screen Pixel Height"};var j={};var y=function(D){var C=1;if(!w.isPlatformAndroid()){C=w.getScreenPixelUnits()}return D*C};var q=function(C){return JSON.stringify(C)};var x={getScreenWidth:y,getScreenHeight:y,getConfigs:q};var b;var B;var h;var u=0;var k=0;var r=z.SystemInfoScreen=e.subclass({classname:"SystemInfoScreen",$hook:function(D){NgLogD("Hooking SystemInfoScreen!");var C=function(E){if(!n.isLoaded("Home")||!(D.controller.navController.getTopViewController() instanceof n.Home)){return}switch(E.direction){case l.Commands.SwipeDirection.Left:u=(new Date()).getTime();break;case l.Commands.SwipeDirection.Right:k=(new Date()).getTime();break;default:break}var F=Math.abs(u-k);if(F<2000){NgLogD("DoubleSwipe detected! Pushing SystemInfoScreen!");n.pushScreen(D.controller.navController,"SystemInfoScreen",{},{analyticsName:"MagicGenieSwipe"})}};D.mobageButton.setOnSwipe(C);D.mobageButton.setOnClickDown(function(){})},$initWithJSON:function(C){console.log("json object is: "+C);return new r()},initialize:function($super){$super();this.logd("Instantiating");this.setTitle(c("System Information"));this._data=new Object();var E;for(E in w){this.logd("key: ",E);b(E,w,this._data)}b("_getBootServer",w,this._data);b("_getBoot",w,this._data);this.importantItems=[];this.optionalItems=[];this._data.mobagePlatformVersion=["Mobage JS Version",v.AppConfig.getPlatformVersion()];this._data.mobageServerURL=["Mobage Platform Server",v.PlusRequest.apiDomain];var C=w.getConfigs();if(C){this._data.mobageAnalyticsServerURL=["Analytics Server",C.analyticsServer]}var D;for(D=0;D<o.length;D++){E=o[D];if(this._data.hasOwnProperty(E)){this.importantItems.push(new B(this._data[E]));this.importantItems[this.importantItems.length-1].odd=D%2;delete this._data[E]}}for(E in this._data){if(this._data.hasOwnProperty(E)){this.optionalItems.push(new B(this._data[E]));this.optionalItems[this.optionalItems.length-1].odd=D%2;D++}}delete this._data;return this},destroy:function(){},loadView:function($super){$super();this.view().setContentView(new A());this.importantSection=new h();this.optionalSection=new h();this.importantSection.header.setTitle(c("Mobage Information"));this.optionalSection.header.setTitle(c("Additional System Details"));this.importantSection.setItems(this.importantItems);this.optionalSection.setItems(this.optionalItems)},didPush:function($super,C){$super(C);this.navController._host.hideLoadingLabel();this.view().getContentView().setSections([this.importantSection,this.optionalSection])}});h=t.subclass({classname:"SystemInfoSection",initialize:function($super,C){$super(C);if(!this._items){this._items=[]}var D=this.header=new s();this.setSectionHeader(D);return this},destroy:function(){}});B=g.ListViewItem.subclass({classname:"SystemInfoListItem",_reuseId:"systeminfolistitem",_cellProps:null,section:null,initialize:function($super,C){this.key=C[0];this.value=C[1];return $super()},_onCreateView:function(){return new m()},_onReleaseView:function(C){if(this.cell==C){this.cell=null}},_onSetView:function(C){this.cell=C;if(!C.keyFrameInited){var D=C.content.getFrameSize();C.key.setFrameSize([D[0]/5,D[1]]);var E=D[1]/8;C.setContentInset([E,E,E,0]);C.keyFrameInited=true}C.setState(l.State.Normal);C.layoutSubviews();C.key.setText(this.key);C.content.setText(this.value);if(this.odd){C.markOdd()}else{C.markEven()}C.content.setOnClick(this.bind(this.rowTapped))},rowTapped:function(){NgLogD("SystemInfoListItemTap! "+this.key+": "+(this.value))}});var a=/([A-Z])/g;var p=function(D){if(D[0]==="_"){D=D.slice(1)}var C=D.slice(3);NgLogD("PreProcessedKey: "+C);if(C in f){return f[C]}return C[0]+C.slice(1).replace(a," $1")};b=function(D,F,C){if(typeof F[D]==="function"&&D.indexOf("get")===0&&!(D in j)){var E=F[D]();if(D in x){E=x[D](E)}C[D]=[p(D),E];NgLogD("Loading Capabilities "+D+" ("+C[D][0]+", "+C[D][1]+")")}}}};__ngs._4y={_c:null,_d:function(){var e={exports:{}};var b=e.exports;this._c=e;var a=__ngs.r_(__ngs._42).Class;var f=__ngs.r_(__ngs._6).Proc;var c=__ngs.r_(__ngs._7c);var d=false;b.Router=a.subclass({classname:"Router",initialize:function(){var g=__ngs.r_(__ngs._12).ObjectRegistry;g.register(this);this._createSendGen(this.__objectRegistryId)},zone:-2,Zone:{Public:-2,GameService:-1},_classId:346,_sendToOtherProcessRecvGen:function(h){if((h.length-h.idx)!==1){NgLogE("Could not parse due to wrong argument count in Router.sendToOtherProcess from command: "+h);return false}var g=f.parseObject(h[h.idx++]);if(g===undefined){NgLogE("Could not parse gsCommand in Router.sendToOtherProcess from command: "+h);return false}return this._sendToOtherProcessRecv(g)},_onCreateRecvGen:function(h){if((h.length-h.idx)!==1){NgLogE("Could not parse due to wrong argument count in Router.onCreate from command: "+h);return false}var g=f.parseInt(h[h.idx++]);if(g===undefined){NgLogE("Could not parse zone in Router.onCreate from command: "+h);return false}return this._onCreateRecv(g)},$_createSendGen:function(g){f.appendToCommandString(22740991,[+g])},_sendToOtherProcessSendGen:function(g){f.appendToCommandString(22675458,this,[f.encodeObject(g)])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[346]=this._instance||this;PROC_METHOD_TABLE[22675458]=this.prototype._sendToOtherProcessRecvGen;PROC_METHOD_TABLE[22675459]=this.prototype._onCreateRecvGen},_onCreateRecv:function(g){this.zone=g;NgLogD("_Router/_onCreateRecv: "+g)},_sendToOtherProcessRecv:function(g){if(this.zone==this.Zone.Public){if(d){NgLogD("_Router/_sendToOtherProcessRecv - in public")}this.dispatchGameCommand(g)}else{if(this.zone==this.Zone.GameService){if(d){NgLogD("_Router/ _sendToOtherProcessRecv - not in public")}this.dispatchGameServiceCommand(g)}else{NgLogE("Unknown Command Zone for the GameService Router.");this.dispatchGameCommand(g)}}},sendToOtherProcess:function(g){var h=c.makeSafe(g);if(!h){NgLogD("Couldn't prep GSCommand message for sending!");return}if(d){NgLogD("_Router.js/sendToOtherProcess: "+JSON.stringify(h))}this._sendToOtherProcessSendGen(h)},sendCommandToGameService:function(g){if(this.zone==this.Zone.Public){if(d){NgLogD("_Router: sendCommandToGameService - in public")}this.sendToOtherProcess(g)}else{if(this.zone==this.Zone.GameService){if(d){NgLogD("_Router: sendCommandToGameService - not in public")}this.dispatchGameServiceCommand(g)}else{NgLogE("Unknown Command Zone for the GameService Router.");this.sendToOtherProcess(g)}}},sendCommandToGame:function(g){if(this.zone==this.Zone.GameService){this.sendToOtherProcess(g)}else{if(this.zone==this.Zone.Public){this.dispatchGameCommand(g)}else{NgLogE("Unknown Command Zone for the GameService Router.");this.sendToOtherProcess(g)}}},dispatchGameCommand:function(l){var m=c.makeExecutable(l);if(m&&m.hasOwnProperty("callbackFunc")){if(typeof m.callbackFunc=="function"){var j=null;var h=null;if(m.hasOwnProperty("error")){h=m.error}if(m.hasOwnProperty("callbackData")){j=m.callbackData}m.callbackFunc(h,j)}}else{if(m){var o=null;if(m&&m.hasOwnProperty("apiURL")){o=m.apiURL;var k=o.split(".");var n=__ngs.r_(__ngs._5x).Social;var g=n;b._dispatchHelper(g,k,l)}}}},dispatchGameServiceCommand:function(j){var k=null;if(j&&j.hasOwnProperty("apiURL")){k=j.apiURL;var h=k.split(".");var g=__ngs.r_(__ngs._r).Social;b._dispatchHelper(g,h,j)}else{NgLogE("Someone called GameService without the proper parameters.\n")}},setVerboseLogging:function(g){d=g}});b._dispatchHelper=function(h,l,k){var j;var m=false;while(l.length&&!m){if(h.dispatchCommand){h.dispatchCommand(l,k);m=true}else{if(h.hasOwnProperty((j=l.shift()))){try{h=h[j]}catch(n){NgLogException(n)}}else{NgLogE("Cannot find namespace "+k.apiURL+" in GameService");h=null;break}}}if(!m&&h&&typeof h=="function"){try{h(k)}catch(g){NgLogException(g)}return}}}};__ngs._4z={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var a=__ngs.r_(__ngs._2f).Dispatcher;var f=__ngs.r_(__ngs._28);var g=__ngs.r_(__ngs._7d).OrderedList;var c=__ngs.r_(__ngs._2z).Assets;var e=g.subclass({classname:"AllGamesList",initialize:function($super,j){var h=0;$super(h);this._gameClassRef=j;this._data={}},_hasData:function(h){return this._data.hasOwnProperty(h)&&this._data[h]},_getData:function(h){return this._data[h]},_constructRequest:function(j){var h=new f.PlusRequest();h.setApiMethod("games");h.setHttpMethod("GET");return h},_handleRequestData:function(l){this._data={};if(l.games){a.beginBatching();var k=0;for(var h=0;h<l.games.length;h++){if(c.isSupportGame(l.games[h].app_key)){var j=this._gameClassRef.getGameWithData(l.games[h]);if(j){this._data[k++]=j}}}this._knownEndOfSet=k;a.endBatching()}}});b.AllGamesList=e}};__ngs._50={_c:null,_d:function(){var c={exports:{}};var a=c.exports;this._c=c;var d=__ngs.r_(__ngs._4z).AllGamesList;var b=a.FeaturedGamesList=d.subclass({_constructRequest:function($super,f){var e=$super(f);e.setPostBody({featured:true,sort:"position"});return e}})}};__ngs._51={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=new (__ngs.r_(__ngs._f).RequireLoader)({Dispatcher:function(){return __ngs.r_(__ngs._2f).Dispatcher},PlusRequest:function(){return __ngs.r_(__ngs._28).PlusRequest},Assets:function(){return __ngs.r_(__ngs._2z).Assets},CpiProduct:function(){return __ngs.r_(__ngs._6n).CpiProduct}});var e=__ngs.r_(__ngs._7d).OrderedList;var a=c.CpiProductsList=e.subclass({classname:"CpiProductsList",initialize:function($super){var f=0;$super(f);this._data={}},_hasData:function(f){return this._data.hasOwnProperty(f)&&this._data[f]},_getData:function(f){return this._data[f]},_constructRequest:function(g){var f=new b.PlusRequest();f.setApiMethod("cpi/products");f.setHttpMethod("GET");return f},_handleRequestData:function(j){this._data={};var h=0;if(typeof j==="object"&&j.hasOwnProperty("length")&&j.length>0){b.Dispatcher.beginBatching();for(var g=0,f=j.length;g<f;g++){if(!b.Assets.isSupportGame(j[g].app_key)){continue}var k=b.CpiProduct.getCpiProductWithData(j[g]);if(k){this._data[h++]=k}}b.Dispatcher.endBatching()}this._knownEndOfSet=h},_retrievePage:function(j,g){var f=this;var h=this._constructRequest(j);if(this._pageETags.hasOwnProperty(j)){h.setEntityTag(this._pageETags[j])}h.send(function(m,n,o,k){if(m){f._waitingCursorsGotError(g.waitingCursors,m)}else{if(k==304){f._waitingCursorsUnblocked(g.waitingCursors)}else{if(k!=200){f._waitingCursorsGotError(g.waitingCursors,n.error)}else{if(o.etag){f._pageETags[j]=o.etag}f._handleRequestData(n);f._waitingCursorsUnblocked(g.waitingCursors)}}}var l=f._pagesPending.indexOf(g);if(l==-1){OLLogE("Ordered List DataModel "+f.recordID+" had an in progress request that wasn't in the pending pages list?")}else{f._pagesPending.splice(l,1)}})}})}};__ngs._52={_c:null,_d:function(){var g={exports:{}};var e=g.exports;this._c=g;var f=__ngs.r_(__ngs._w).MessageListener;var a=__ngs.r_(__ngs._55).ProgressDialog;var c=__ngs.r_(__ngs._n).LocalizedString;var b=__ngs.r_(__ngs._2g).GameLaunchedEmitter;var d=e.GameLaunchingProgress={_progressDialog:null,_onGameLaunchedListener:null,_requestingObjects:[],showDialog:function(h,j){if(d._requestingObjects.indexOf(h)!==-1){return}d._requestingObjects.push(h);if(!d._progressDialog){d._progressDialog=new a();d._onGameLaunchedListener=new f();b.addListener(d._onGameLaunchedListener,d._onGameLaunched)}if(!j||j=="name"){d._progressDialog.setText(c("Launching…"))}else{d._progressDialog.setText(c("Launching %1s…",j))}d._progressDialog.show()},hideDialog:function(h){var j=d._requestingObjects.indexOf(h);if(j===-1){return}d._requestingObjects.splice(j,1);if(d._requestingObjects.length===0){d._progressDialog.hide()}},_onGameLaunched:function(){}}}};__ngs._53={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._11).LifecycleEmitter;var d=b.LifecycleManagedTimeout=(__ngs.r_(__ngs._w).MessageListener).subclass({classname:"LifecycleManagedTimeout",initialize:function($super,f,e){if($super&&typeof $super=="function"){$super()}a.addListener(this,this._onLifecycleEvent.bind(this));this._timeoutLength=e;this._cb=f;this._onDone=this._onTimeoutDone.bind(this);this._startTimeout()},destroy:function(){if(this._activeTimeout){clearTimeout(this._activeTimeout)}},cancel:function(){this.destroy()},_startTimeout:function(){if(!this._activeTimeout){this._timeoutStarted=new Date();this._activeTimeout=setTimeout(this._onDone,this._timeoutLength)}},_pauseTimeout:function(){if(this._activeTimeout){clearTimeout(this._activeTimeout);this._activeTimeout=null;this._timeoutLength-=((new Date())-this._timeoutStarted)}},_onTimeoutDone:function(){this._cb();this.destroy()},_onLifecycleEvent:function(e){if(e===a.Event.Suspend){this._pauseTimeout()}else{if(e===a.Event.Resume){this._startTimeout()}}return true}})}};__ngs._54={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=null;b.setRouterInstance=function(d){a=d};b.getRouterInstance=function(){return a}}};__ngs._55={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var c=__ngs.r_(__ngs._24).Element;var b=__ngs.r_(__ngs._22).Commands;var a=d.ProgressDialog=c.subclass({type:"progressdialog",initialize:function($super,f){if(a._init){a._init()}return $super(f)},show:b.show,hide:b.hide});a._init=function(){delete a._init;if(c._init){c._init()}a.synthesizePropertyWithState("title",b.setTitle);a.synthesizePropertyWithState("text",b.setText)}}};__ngs._56={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.OpenSocial={populateErrors:function(d,f,g,c){var e=c-c%100;if(f&&f.success===false){d={errorCode:f.error,description:f.error_msg}}else{if(f&&f.Error&&e!=200){d={errorCode:f.Error.Code,description:f.Error.Message}}else{if(d&&e!=200){d={errorCode:c,description:d};f=null}}}return{error:d,data:f}},populatePeopleFields:function(d){var f=["hasApp","thumbnailUrl"];if(d instanceof Array){var c={hasApp:true,thumbnailUrl:true,id:true,nickname:true};for(var e=0;e<d.length;e++){if(!(d[e] in c)){f.push(d[e])}}}return f},stripBlacklist:function(e){var c=[];if(e&&e.entry instanceof Array){for(var d=0;d<e.entry.length;d++){c.push(e.entry[d]["targetId"])}}else{if(e){c.push(e.targetId)}}return c},keys:function(e){if(!(e instanceof Object)){throw TypeError("Object.keys called on non-object")}var c=[];for(var d in e){if(e.hasOwnProperty(d)){c.push(d)}}return c}};if(typeof Object.keys=="function"){a.OpenSocial.keys=Object.keys}}};__ngs._57={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var g=__ngs.r_(__ngs._5).Core;var c=__ngs.r_(__ngs._4).Device;var f=__ngs.r_(__ngs._59).UI;var a=new (__ngs.r_(__ngs._2b).InterfaceLoader)({LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},MobageStyle:function(){return __ngs.r_(__ngs._6k).MobageStyle},FacebookConsts:function(){return __ngs.r_(__ngs._2m).FacebookConsts},RegWebScreenStyle:function(){return __ngs.r_(__ngs._7e).RegistrationWebScreen}});var e=b.FacebookWebview={showNoNetworkError:function(){var h=new f.AlertDialog();h.setTitle(a.LocText("We're not able to connect"));h.setText(a.LocText("Please check your network settings and try again."));h.setChoices([a.LocText("Ok")]);h.onchoice=function(j){e.close()};h.show()},close:function(){if(e._currentWebviewObjects){for(var h=0;h<e._currentWebviewObjects.length;h++){e._currentWebviewObjects[h].destroy()}e._currentWebviewObjects=undefined}},show:function(o,j,l,h){e.close();e._currentWebviewObjects=[];var E=f.Window.getWidth();var r=f.Window.getHeight();var q=new f.WebView();e._currentWebviewObjects.push(q);var n=new f.View({gradient:{gradient:["FFFF 0.0"]},frame:[0,0,E,r]});e._currentWebviewObjects.push(n);if(g.Capabilities.isPlatformIOS()){var m=new a.UnspammableButton();e._currentWebviewObjects.push(m);m.setText(a.LocText("Cancel"));m.onclick=function(){e.close()};var k=new f.View();k.addChild(m);e._currentWebviewObjects.push(k);var y=new f.ViewGeometry.Rect([0,0,E,r]);var C=y.copy();var u=y.copy();y.sliceVertical(y.h*(66/800));var x=C.sliceVertical(66/800*r);var t=u.sliceVertical(66/800*r);t.w=80/480*E;t.h=x.h-x.h/5;t.y=x.h/10;t.x=x.h/10;var A={doneButton:m,topNav:k};a.RegWebScreenStyle.applyTo(A);m.setFrame(t);k.setFrame(x);q.setFrame(y);n.addChild(k)}else{q.setFrame([0,0,E,r])}q.loadUrl(o);var z=new f.View({gradient:{gradient:["F333 0.0"],corners:a.MobageStyle.ScaledCorners(8)}});e._currentWebviewObjects.push(z);var v=new f.Label({text:"Loading...",textFont:a.MobageStyle.defaultBoldFontFace,textSize:a.MobageStyle.ScaledTextSize(14),textColor:"FFFF"});e._currentWebviewObjects.push(v);var w=new f.Spinner();e._currentWebviewObjects.push(w);var B=E*0.26;var s=E-B*2;var D=(1/1.61803399)*s;z.setFrame(B,r/2-D/2,s,D);v.setFrame(0,0,s,D*0.6);w.setFrame(s/2-(D*0.2)/2,D*0.6,D*0.2,D*0.2);z.addChild(v);z.addChild(w);var p=new g.MessageListener();e._currentWebviewObjects.push(p);a.UnspammableButton.addDeviceKeyListener(p,function(F){if(F.code===c.KeyEmitter.Keycode.back){l();e.close();return true}return false},9999999);q.onstartload=function(F){NgLogD("MAXMAXMAX - ONSTARTLOAD: "+JSON.stringify(F));if(z){f.Window.document.addChild(z)}if(g.Capabilities.isPlatformIOS()){if(e.pageLoadTimeout){clearTimeout(e.pageLoadTimeout)}e.pageLoadTimeout=setTimeout(e.showNoNetworkError,12000)}};q.onpageload=function(F){NgLogD("MAXMAXMAX - ONPAGELOAD: "+JSON.stringify(F));if(e.pageLoadTimeout){clearTimeout(e.pageLoadTimeout);e.pageLoadTimeout=null}if(z){z.removeFromParent()}if(F.url.indexOf("data:text/html;null")===0){e.showNoNetworkError()}};q.onpageerror=function(F){NgLogD("MAXMAXMAX - ERROR: "+JSON.stringify(F))};q.onshouldload=function(J){var H=J.url;NgLogD("MAXMAXMAX - Facebook-WebView Redirect URL: "+H);NgLogD("MAXMAXMAX - LOOKING FOR: "+a.FacebookConsts.REDIRECT_URI);if(H.indexOf(a.FacebookConsts.REDIRECT_URI)===0){NgLogD("MAXMAXMAX - Is complete URL");var K={};var M=H.split("?");if(M.length===1){M=H.split("#")}if(M.length>1){M=M[1];var F=M.split("&");for(var I=0;I<F.length;I++){var G=F[I].split("=");K[G[0]]=G[1]}}var L=K.error||K.error_type;if(!L){NgLogD("MAXMAXMAX - A onComplete: "+j+" paramBundle: "+JSON.stringify(K));j(K)}else{if(L=="access_denied"||L=="OAuthAccessDeniedException"){NgLogD("MAXMAXMAX - B");l()}else{NgLogD("MAXMAXMAX - C");h(L)}}e.close();return false}else{if(H.indexOf(a.FacebookConsts.CANCEL_URI)===0){l();e.close();return false}else{if(H.indexOf(a.FacebookConsts.DISPLAY_STRING)!==-1){return false}}}return true};f.Window.document.addChild(n);f.Window.document.addChild(q)}}}};__ngs._58={_c:null,_d:function(){var c={exports:{}};var j=c.exports;this._c=c;var e=__ngs.r_(__ngs._59).UI;var g=__ngs.r_(__ngs._14).OrientationEmitter;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Purchase:function(){return __ngs.r_(__ngs._2y).Purchase},OldStyle:function(){return __ngs.r_(__ngs._60).Style},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},CommunityButtonStyle:function(){return __ngs.r_(__ngs._7f)}});var h=__ngs.r_(__ngs._2z).Assets;var b=__ngs.r_(__ngs._7g).ViewController;var d=__ngs.r_(__ngs._2a).Destinations;var f=j.CommunityButtonController=b.subclass({classname:"CommunityButtonController",$_instance:null,initialize:function(){a.CommunityButtonStyle;this._stylesheet=a.OldStyle.registeredStyle("social.us.communitybutton");var k=0;this._button=(new a.UnspammableButton()).retain();this._button.setFrame([0,0,150,150]);this._button.setImage(h.image("ComBtnUS_up.png"));this._button.setImage(h.image("ComBtnUS_down.png"),e.State.Pressed);this._button.setImageInsets([k,k,k,k]);this._button.setImageGravity(e.ViewGeometry.Gravity.Right);this._button.onclick=function(){NgLogD("mobage-CommunityButtonController: button tapped");var m=g.getInterfaceOrientation();if(a.ServiceHost.isSupportedOrientation(m)){d.pushScreen(a.ServiceHost.navController,"Home",{},this)}else{a.ServiceHost.view().showFullScreenLoadingSpinner();d.pushScreen(a.ServiceHost.navController,"Home",{},this,function(){a.ServiceHost.view().hideFullScreenLoadingSpinner()})}this._button.setEnabled(false);setTimeout(function(){this._button.setEnabled(true)}.bind(this),300)}.bind(this);var l=this._button;e.animate(function(){e.Window.document.addChild(l)},250,function(){});a.Purchase.retryFailedCreditsAux();f._instance=this;NgLogD("mobage-CommunityButtonController: initialized");return this},setThemeAndGravity:function(o,r){var m=this._stylesheet.props()["button"];var q=3;var n=Math.min(e.Window.getWidth(),e.Window.getHeight());var l=n*this._stylesheet.props()["communityButtonScale"];var k;var p;if(r[0]===1&&r[1]===0){k=e.Window.getWidth()-l;p=-q;m.gradient.corners="4.0 0 4.0 4.0"}else{if(r[0]===0&&r[1]===1){k=-q;p=e.Window.getHeight()-l;m.gradient.corners="4.0 4.0 4.0 0"}else{if(r[0]===1&&r[1]===1){k=e.Window.getWidth()-l;p=e.Window.getHeight()-l;m.gradient.corners="4.0 4.0 0 4.0"}else{k=-q;p=-q;m.gradient.corners="0 4.0 4.0 4.0"}}}this._button.setAttributes(m);this._button.setFrame([k,p,l+q,l+q])},destroy:function(){if(this._button){var k=this._button;e.animate(function(){k.removeFromParent()},250,function(){k.release()});this._button=null}f._instance=null},$destroyInstance:function(k){if(f._instance){f._instance.destroy()}if(k){k()}}})}};__ngs._59={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=function(f){var e=function(g,h,j){return function(){delete g[h];return g[h]=j.call(this)}};for(var d in f){if(typeof f[d]=="function"){this.__defineGetter__(d,e(this,d,f[d]))}else{this[d]=f[d]}}};c.prototype={animate:function(){return this.Commands.animate.apply(this,Array.prototype.slice.call(arguments))},compositeImages:function(e,j,f,g,k){var d=this.Commands.registerTemporaryCallback(k);if(d){this.Commands.doCompositeImages(e,j,f,g,d)}},choosePhoto:function(g,h,e,f,k,j){if(!j||!j.__objectRegistryId){new a.UI.Toast({text:"Photo picker requires an invoking view.",onDisappear:function(){this.destroy()}}).show();return}var d=this.Commands.registerTemporaryCallback(k);if(d){this.Commands.doChoosePhoto(g,h,e,f||{},d,j.__objectRegistryId)}},choosePhotoCamera:function(h,e,f,g,j){var d=this.Commands.registerTemporaryCallback(j);if(d){this.Commands.doChooseCamera(h,e,f,g||{},d)}},takeScreenshot:function(h,e,f,g,j){var d=this.Commands.registerTemporaryCallback(j);if(d){this.Commands.takeScreenshot(h,e,f,g||{},d)}},measureText:function(k,e,j,f,g,l){var d=this.Commands.registerTemporaryCallback(l);if(d!==""){this.Commands.measureText(k,e||-1,j||-1,f,g,d)}},hideKeyboard:function(){this.Commands.hideKeyboard()},sendEmail:function(e,f){var d=this.Commands.registerTemporaryCallback(f);this.Commands.sendEmail(e,d)},sendSMS:function(e,f){var d=this.Commands.registerTemporaryCallback(f);this.Commands.sendSMS(e,d)},sendTweet:function(e,f){var d=this.Commands.registerTemporaryCallback(f);this.Commands.sendTweet(e,d)},getAvailableSharingServices:function(e){var d=this.Commands.registerTemporaryCallback(e);this.Commands.getAvailableSharingServices(d)}};if(typeof $APP_REQUIREPATHMAP!="undefined"){$APP_REQUIREPATHMAP["NGCore/Client/UI.js"]=a}a.UI=new c({Commands:function(){return __ngs.r_(__ngs._22).Commands},FontStyle:function(){return this.Commands.FontStyle},State:function(){return this.Commands.State},FitMode:function(){return this.Commands.FitMode},Window:function(){return __ngs.r_(__ngs._b).Window},Element:function(){return __ngs.r_(__ngs._24).Element},ViewGeometry:function(){return __ngs.r_(__ngs._25).ViewGeometry},Scale:function(){return a.UI.ViewGeometry.Scale},View:function(){return __ngs.r_(__ngs._7h).View},Label:function(){return __ngs.r_(__ngs._7i).Label},Image:function(){return __ngs.r_(__ngs._7j).Image},Button:function(){return __ngs.r_(__ngs._7k).Button},GLView:function(){return __ngs.r_(__ngs._7l).GLView},NavController:function(){return __ngs.r_(__ngs._7m).NavController},WebView:function(){return __ngs.r_(__ngs._7n).WebView},ScrollView:function(){return __ngs.r_(__ngs._7o).ScrollView},ListView:function(){return __ngs.r_(__ngs._7p).ListView},ListViewSection:function(){return __ngs.r_(__ngs._7q).ListViewSection},ListViewItem:function(){return __ngs.r_(__ngs._7r).ListViewItem},CellView:function(){return __ngs.r_(__ngs._7s).CellView},CheckBox:function(){return __ngs.r_(__ngs._7t).CheckBox},EditText:function(){return __ngs.r_(__ngs._7u).EditText},EditTextArea:function(){return __ngs.r_(__ngs._7v).EditTextArea},AlertDialog:function(){return __ngs.r_(__ngs._i).AlertDialog},ProgressDialog:function(){return __ngs.r_(__ngs._55).ProgressDialog},Toast:function(){return __ngs.r_(__ngs._j).Toast},Style:function(){return __ngs.r_(__ngs._4h).Style},Spinner:function(){return __ngs.r_(__ngs._7w).Spinner},ProgressBar:function(){return __ngs.r_(__ngs._7x).ProgressBar},Diagnostics:function(){return __ngs.r_(__ngs._7y).Diagnostics},AdView:function(){return __ngs.r_(__ngs._7z).AdView},DocumentView:function(){return __ngs.r_(__ngs._80).DocumentView},CheckoutView:function(){return __ngs.r_(__ngs._81).CheckoutView},MapView:function(){return __ngs.r_(__ngs._82).MapView},MapAnnotation:function(){return __ngs.r_(__ngs._83).MapAnnotation},_CutSceneView:function(){return __ngs.r_(__ngs._84).CutSceneView}})}};__ngs._5a={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var h=__ngs.r_(__ngs._5).Core;var g=__ngs.r_(__ngs._59).UI;var d=g.ViewGeometry.Rect;var b=new (__ngs.r_(__ngs._f).RequireLoader)({Purchase:function(){return __ngs.r_(__ngs._2y).Purchase},BalanceButton:function(){return __ngs.r_(__ngs._85).BalanceButton},BalanceButtonStyle:function(){return __ngs.r_(__ngs._86).GameStyle}});var a=__ngs.r_(__ngs._7g).ViewController;var f=c.BalanceButtonController=a.subclass({$_instance:null,initialize:function($super,n,p,m){if($super&&typeof $super=="function"){$super()}this._buttonRect=this._backwardsCompatibleMakeRect(n);this._sheet=b.BalanceButtonStyle.extras;this._style=b.BalanceButtonStyle;this._totalWidth=h.Capabilities.getScreenHeight();this._totalHeight=h.Capabilities.getScreenWidth();var k=Math.min(this._totalWidth,this._totalHeight);var l=Math.max(this._totalWidth,this._totalHeight);var j=(this._sheet.minWidth/800)*l;var q=(this._sheet.minHeight/480)*k;if(isNaN(this._buttonRect.x)||this._buttonRect.x<0){this._buttonRect.x=50}if(isNaN(this._buttonRect.y)||this._buttonRect.y<0){this._buttonRect.y=50}if(isNaN(this._buttonRect.w)||this._buttonRect.w<j){this._buttonRect.w=j}if(isNaN(this._buttonRect.h)||this._buttonRect.h<q){this._buttonRect.h=q}this._balanceButton=(new b.BalanceButton(p,m)).retain();this._balanceButton.setFrame(this._buttonRect);var o=this._balanceButton;g.animate(function(){g.Window.document.addChild(o)},250,function(){});f._instance=this;this._style.applyTo(this);b.Purchase.retryFailedCreditsAux();NgLogD("mobage-BalanceButtonController: initialized");return this},getButton:function(){return this._balanceButton},$refreshBalance:function(){NgLogD("mobage-BalanceButtonController: refreshBalance");if(!f._instance){return}NgLogD("mobage-BalanceButtonController: refreshing the balance ...");f._instance._balanceButton.updateBalance()},destroy:function(){if(this._balanceButton){var j=this._balanceButton;g.animate(function(){j.removeFromParent()},250,function(){j.release()});this._balanceButton=null}f._instance=null},_backwardsCompatibleMakeRect:function(j){if(!j||j instanceof d||j.length){return new d(j)}else{return new d(j.x,j.y,j.w,j.h)}},$destroyInstance:function(j){if(f._instance){f._instance.destroy()}if(j){j()}}})}};__ngs._5b={_c:null,_d:function(){var e={exports:{}};var h=e.exports;this._c=e;var f=__ngs.r_(__ngs._59).UI;var b=f.ViewGeometry.Rect;var j=__ngs.r_(__ngs._w).MessageListener;var c=__ngs.r_(__ngs._4).Device;var a=new (__ngs.r_(__ngs._f).RequireLoader)({MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},LayoutMethods:function(){return __ngs.r_(__ngs._5c).LayoutMethods},Session:function(){return __ngs.r_(__ngs._o).Session},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities},NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils}});var d=__ngs.r_(__ngs._7g).ViewController;var k=__ngs.r_(__ngs._n).LocalizedString;var m=j.subclass({classname:"GSNavController_KeyListener"});var l=h.GSNavController=d.subclass({classname:"GSNavController",navStack:null,length:function(){return(this.navStack&&this.navStack.length)?this.navStack.length:0},_host:null,_isTransitioningViews:false,_transitionEventQueue:null,transitionAnimationTime:null,initialize:function($super,n){$super();if(!this.navStack){this.navStack=[]}this._transitionEventQueue=[];NgLogD("Mobage/GSNavController/initialize: host="+n);this._host=n;this.kListener=new m();a.UnspammableButton.addDeviceKeyListener(this.kListener,this.onKeyPressed.bind(this),1000);this.lListener=a.LayoutMethods.createLayoutListener(this,this.onLayout);this.transitionAnimationTime=(!a.Capabilities.isPlatformAndroid())?400:600;this._dontAnimateTransitions=false;return this},_delegate:null,setDelegate:function(n){this._delegate=n},delegate:function(){return this._delegate},viewControllerAtIndex:function(n){n=(n<this.length())?n:-1;n=(n>=0&&this.length()>0)?n:-1;if(n==-1){return null}return this.navStack[n]},indexOfViewController:function(n){return this.navStack.indexOf(n)},removeViewController:function(o){var n=this.navStack.indexOf(o);if(o&&n!=-1){this.removeViewControllerAtIndex(n)}},removeViewControllerAtIndex:function(n){if(n>=0&&n<this.length()){var o=this.navStack[n];this.navStack.splice(n,1);o.autorelease()}},removeUntilViewController:function(n){this.removeUntilIndex(this.indexOfViewController(n))},removeUntilIndex:function(n){if(n>=-1&&n<this.length()-1){var o=this.navStack.slice(n+1);this.navStack.splice(n+1,o.length);for(n=o.length;o>=0;o--){o[n].autorelease()}}},insertViewControllerAtIndex:function(o,n){if(!o||!(o instanceof d)){return}o.retain();if(n>=this.length()){this.navStack.push(o)}else{if(n<=0){var p=this.navStack.shift();this.navStack.unshift(p,o)}else{this.navStack.splice(n,0,o)}}},getBottomViewController:function(){return(this.length())?this.navStack[0]:null},getTopViewController:function(){return(this.length())?this.navStack[this.navStack.length-1]:null},getViewControllers:function(){return this.navStack.slice(0)},pushViewController:function(o,v,p){if(this._isTransitioningViews){var t={eventType:"PUSH_VIEW_CONTROLLER",destVC:o,buttonRef:v,cb:p};this._transitionEventQueue.push(t);NgLogD("GSNavController.pushViewController - queued push view to "+o.classname);return}var u=false;if(!this._isTransitioningViews){this._isTransitioningViews=true;u=true}var r=this.getTopViewController();var w=this;var n=null;var q;if(a.NetworkUtils.wasNetworkDown(p)){if(u){this._isTransitioningViews=false;if(this._host&&this._host.hideLoadingLabel){this._host.hideLoadingLabel()}}return}if(r===o){q="Already on this controller";NgLogD("GSNavController.pushViewController - "+q);if(p){p(q)}if(u){this._isTransitioningViews=false}return}else{if(r&&r.equals(o)){q="Controller is the same as the current controller, according to: "+r.equals;NgLogD("GSNavController.pushViewController - "+q);if(o._launchedGame){r._launchedGame=o._launchedGame;if(r._updateGameIconWidget){r._updateGameIconWidget()}}if(p){p(q)}if(u){this._isTransitioningViews=false}return}}if(o&&o instanceof d){o.retain()}if(o&&(!this._delegate||(this._delegate&&typeof this._delegate.navControllerShouldPushViewController==="function"&&this._delegate.navControllerShouldPushViewController(this,o,v)))){NgLogD("GSNavController-pushViewController: nodelegate or delegate said push was okay!");var s=(new f.ViewGeometry.Rect(this.view().getFrame()));if(!s.isEmpty()){o.view().setFrame(s)}if(r){r.performEventCallback({eventType:"willHide",host:this._host,navController:this})}o.performEventCallback({eventType:"willPush",host:this._host,navController:this});if(r){n=function(){if(r){r.performEventCallback({eventType:"didHide",host:w._host,navController:w})}o.performEventCallback({eventType:"didPush",host:w._host,navController:w})}}this.navStack.push(o);this._transitionNVCs(r,o,false,v,n)}else{if(o&&o instanceof d){q="Delegate refused push of view controller";o.release();if(p){p(q)}if(u){this._isTransitioningViews=false}return}}if(p){p()}},popViewController:function(n){var o=null;if(this.length()>1){o=this.viewControllerAtIndex(this.navStack.length-2)}if(this._isTransitioningViews){if(this._transitionEventQueue.length===0||this._transitionEventQueue[this._transitionEventQueue.length-1].target!=o){this._transitionEventQueue.push({eventType:"BACK_KEY",buttonRef:n,target:o});NgLogD("GSNavController.popViewController - queued pop view to ")}return null}var p=this.popToViewController(o,n);if(p.length){return p[0]}return null},back:function(){return this.popViewController()},popToViewController:function(s,o){NgLogD("Mobage/GSNavController/popToViewController begin");if(this.navStack.length>0&&this.navStack[this.navStack.length-1]==s){s.view().setFrame(this.view().getFrame());s.performEventCallback({eventType:"willReshow",host:this._host,navController:this});s.performEventCallback({eventType:"didReshow",host:this._host,navController:this});return null}var t=[];var u;var r=(this.navStack.length)?this.navStack[this.navStack.length-1]:null;while(this.navStack.length&&(u=this.navStack[this.navStack.length-1])){if(u&&(!this._delegate||(this._delegate&&typeof this._delegate.navControllerShouldPopViewController==="function"&&this._delegate.navControllerShouldPopViewController(this,u,o)))){t.push(u);this.navStack.pop()}else{break}if(this.getTopViewController()==s){break}if(r!=u&&u&&u instanceof d){u.autorelease()}}if(t.length>0){var n=this;for(var q=0;q<t.length;q++){t[q].performEventCallback({eventType:"willPop",host:n._host,navController:n})}var p=function(){for(var v=0;v<t.length;v++){t[v].performEventCallback({eventType:"didPop",host:n._host,navController:n});t[v].autorelease()}};this._transitionNVCs(r,this.getTopViewController(),true,o,p)}return t},popAllViewControllers:function(){this.popToViewController(this.viewControllerAtIndex(0));this.popViewController()},_transitionNVCs:function(t,q,o,A,p){NgLogD("Mobage/GSNavController/_transitionNVCs - setting _isTransitioningViews fromNVC= "+t+" toNVC="+q);this._isTransitioningViews=true;NgLogD("Mobage/GSNavController/_transitionNVCs toNVC="+q);var B=this;if(o&&q){q.performEventCallback({eventType:"willReshow",host:this._host,navController:this})}var s=new b(this.view().getFrame());if(s.isEmpty()){NgLogE("Can't transition view controllers with an unset frame!, this.view() = "+this.view());this._isTransitioningViews=false;return}var y=s.w;var u=s.h;var z=new b((o?-y:y),0,y,u);var x=new b((o?y:-y),0,y,u);var r=new b(0,0,y,u);if(q){q.view().setFrame(z);this.view().addChild(q.view())}if(this._host&&this._host.onNavTransition){this._host.onNavTransition(t,q,this.transitionAnimationTime,o)}a.MobageAnalytics.logNavEvent(t,q,A);if(!this.view().getRoot()||this._dontAnimateTransitions){if(t){t.view().removeFromParent()}if(typeof p==="function"){p()}if(o&&q){q.performEventCallback({eventType:"didReshow",host:this._host,navController:this})}if(q){q.view().setFrame(r)}this._isTransitioningViews=false;return}var v=null;var n=false;f.animate(function(){if(t){t.retain();t.view().setFrame(x)}if(q){q.retain();q.view().setFrame(r)}},this.transitionAnimationTime,v=function(){if(n){return}n=true;if(t){t.view().removeFromParent();t.autorelease()}if(typeof p==="function"){p()}if(o&&q){q.performEventCallback({eventType:"didReshow",host:B._host,navController:B})}if(q){q.autorelease()}if(B._transitionEventQueue.length===0){NgLogD("GSNavController - resetting _isTransitioningViews - no queued event");B._isTransitioningViews=false;return}var w=B._transitionEventQueue.shift();if(w&&(w.eventType=="PUSH_VIEW_CONTROLLER")){NgLogD("GSNavController - resetting _isTransitioningViews - push view event - replaying");B._isTransitioningViews=false;B.pushViewController(w.destVC,w.buttonRef,w.cb)}else{if(w&&w.eventType=="BACK_KEY"){NgLogD("GSNavController - resetting _isTransitioningViews - back key event - replaying");B._isTransitioningViews=false;B.back()}else{NgLogD("GSNavController - resetting _isTransitioningViews - unknown event - skipping");B._isTransitioningViews=false}}NgLogD("GSNavController: animation complete!")});setTimeout(v,this.transitionAnimationTime*3)},onLayout:function(o){if(this._landscapeOnly&&o.width<o.height){return}this.view().setFrame(0,0,o.width,o.height);if(this.getTopViewController()){var n=this.getTopViewController().view();n.setFrame(0,0,o.width,o.height)}},setLandscapeOnly:function(n){if(n){this.view().setVisibleInOrientations(f.Commands.OrientationFlag.Landscape)}else{this.view().setVisibleInOrientations(f.Commands.OrientationFlag.Landscape|f.Commands.OrientationFlag.Portrait)}this._landscapeOnly=n},handleViewControllerSelfDestroy:function(o){for(var n=0;n<this.navStack.length;n++){if(this.navStack[n]==o){this.navStack.splice(n,1);return true}}return false},onKeyPressed:function(o){var n;var q=null;if(o.code===c.KeyEmitter.Keycode.back){if(this._host&&this._host.isMenuDrawerClosedOrClosing&&!this._host.isMenuDrawerClosedOrClosing()){this._host.closeMenuDrawer();return true}else{if(!this._host||this._host.isShowing()){if(!this._isTransitioningViews){n=this.back()}else{var p={eventType:"BACK_KEY"};this._transitionEventQueue.push(p);n=true;NgLogD("GSNavController.onKeyPressed - queued back key event")}return n?true:false}}}else{if(o.code===c.KeyEmitter.Keycode.backunhandled){if(!this._host||this._host.isShowing()){return false}else{if(this._host&&this._host.isMenuDrawerClosedOrClosing&&!this._host.isMenuDrawerClosedOrClosing()){this._host.closeMenuDrawer();return true}else{n=this.back();return n?true:false}}}else{if(o.code===c.KeyEmitter.Keycode.menu&&(q=a.Session.getCurrentSession())&&q.user()&&this._host.menuKeyPressed&&this._host.menuKeyPressed()){return true}}}return false}});var g=null;h.GSNavController.getInstance=function(){if(!g){g=new l();var n=[f.Window.getWidth(),f.Window.getHeight()];g.view().setFrameSize(n);f.Window.document.addChild(g.view())}return g}}};__ngs._5c={_c:null,_d:function(){var d={exports:{}};var f=d.exports;this._c=d;var h=__ngs.r_(__ngs._5).Core;var c=__ngs.r_(__ngs._4).Device;var e=__ngs.r_(__ngs._59).UI;var b=e.ViewGeometry.Rect;f.LayoutMethods={};var g=[0,0,0,0];f.LayoutMethods.setFrame=function($super){var l=(this._frame||g).slice(2);if($super){$super.apply(this,Array.prototype.slice.call(arguments,1))}var k=this._frame||g;if((l[0]^k[2])|(l[1]^k[3])){if(typeof this.sizeChanged=="function"){console.log("Size of "+this.classname+" changed to "+k[2]+" x "+k[3]);this.sizeChanged(k[2],k[3],l[0],l[1])}}};f.LayoutMethods.setFrameNoSuper=function(n,m){var l=(this._frame||g).slice(2);if(n instanceof Array){if(m instanceof Array){this._frame=n.concat(m)}else{this._frame=n}}else{if(n instanceof b){this._frame=n.array()}else{this._frame=Array.prototype.slice.call(arguments)}}var k=this._frame||g;if((l[0]^k[2])|(l[1]^k[3])){if(typeof this.sizeChanged=="function"){console.log("Size of "+this.classname+" changed to "+k[2]+" x "+k[3]);this.sizeChanged(k[2],k[3],l[0],l[1])}}};var a=h.MessageListener.subclass({classname:"Generic_LayoutListener"});f.LayoutMethods.createLayoutListener=function(k,n,l){var m=new a();c.LayoutEmitter.addListener(m,n.bind(k),l);return m};f.LayoutMethods.sizeToLayoutEvent=function(k){if(k){this.setFrame(0,0,k.width,k.height)}};var j=c.LayoutEmitter.Orientations;f.LayoutMethods.isLandscape=function(k){return k==j.LandscapeLeft||k==j.LandscapeRight};f.LayoutMethods.isPortrait=function(k){return k==j.Portrait||k==j.PortraitUpsideDown};f.LayoutMethods.guessLandscapeFrameHack=function(){var r=__ngs.r_(__ngs._59).UI;var q=r.Window.getWidth();var m=r.Window.getHeight();if(q>m){console.log("TODO");return[0,0,q,m]}else{var k=h.Capabilities.getScreenWidth();var o=h.Capabilities.getScreenHeight();var l=Math.max(k,o);var p=Math.min(k,o);var n=Math.max(l-m,p-q);q=l;m=p-n}console.log("Guessed frame at: "+q+","+m);return[0,0,q,m]}}};__ngs._5d={_c:null,_d:function(){var g={exports:{}};var d=g.exports;this._c=g;var f=__ngs.r_(__ngs._4).Device;var c=new (__ngs.r_(__ngs._f).RequireLoader)({Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities},LifecycleEmitter:function(){return __ngs.r_(__ngs._11).LifecycleEmitter},MessageListener:function(){return __ngs.r_(__ngs._w).MessageListener},GSNavController:function(){return __ngs.r_(__ngs._5b).GSNavController},Session:function(){return __ngs.r_(__ngs._o).Session},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils}});var b=__ngs.r_(__ngs._n).LocalizedString;var a=__ngs.r_(__ngs._7g).ViewController;var e=d.Host=a.subclass({classname:"Host",isShowing:function(){return this._showing},enableSoftNavButtons:function(){if(c.Capabilities.isPlatformAndroid()){this._showNavButtons=false}else{this._showNavButtons=true}if(this.isShowing()){this.resurfaceControls()}},disableSoftNavButtons:function(){this._showNavButtons=false;if(this.isShowing()){this.resurfaceControls()}},initialize:function(){this._showing=false;this._showNavButtons=false;NgLogD("mobage: Initializing the mobage host container.");this.navController=(new c.GSNavController(this)).retain();this._showNavButtons=!c.Capabilities.getHasBackButton();if(c.Capabilities.isPlatformAndroid()){this._showNavButtons=false}this.view()},destroy:function(){this.navController.setDelegate(null);this.navLogic.release();this.navController.release()},show:function(){this._showing=true;var h=false;if(!(c.Session.getCurrentSession())||(h=(c.Session.getCurrentSession().appKey()=="default-Dev"))){if(h){NgLogE('Error!!! Application appears to have been configured with a bad or missing appKey, Mobage received "default-Dev" when it should not have!')}else{NgLogE("Error: Mobage tried to show the service without any session at all, this is a fatal error.")}c.UIUtils.showAlert(b("Service Unavailable"),b("Sorry to keep you waiting! We'll be back ASAP."),[b("Exit")],function(){c.LifecycleEmitter.exitProcess()})}NgLogD("mobage-Host-show: finished.")},hide:function(){NgLogD("mobage-Host: hide");this._showing=false},shouldAutoRotate:function(){return this._shouldAutoRotate},setShouldAutoRotate:function(h){if(!this._shouldAutoRotate&&h){this._shouldAutoRotate=h;if(!this.devOrientationListener){this.devOrientationListener=new c.MessageListener();f.OrientationEmitter.addListener(this.devOrientationListener,this._rotateInterfaceIfNecessary.bind(this))}}else{this._shouldAutoRotate=h}},_rotateInterfaceIfNecessary:function(h){if(!this._showing||!this._shouldAutoRotate||!h||!h.hasOwnProperty("type")||h.type!=f.OrientationEmitter.OrientationType.Device||!this.isSupportedOrientation(h.orientation)){if(this._showing&&this._shouldAutoRotate&&f.OrientationEmitter.getInterfaceOrientation()!=h.orientation){NgLogD("Mobage: Not Rotating to "+h.orientation)}return}NgLogD("Mobage AutoRotating to: "+h.orientation);f.OrientationEmitter.setInterfaceOrientation(h.orientation)},resurfaceControls:function(h){},isSupportedOrientation:function(h){return true}})}};__ngs._5e={_c:null,_d:function(){var c={exports:{}};var h=c.exports;this._c=c;var l=__ngs.r_(__ngs._87).ReferenceCounting;var e=__ngs.r_(__ngs._2a).Destinations;var d=__ngs.r_(__ngs._4w).GamePlaceholder;var j=__ngs.r_(__ngs._5).Core;var b=__ngs.r_(__ngs._29).AppConfig;var m=__ngs.r_(__ngs._n).LocalizedString;var a=new (__ngs.r_(__ngs._f).RequireLoader)({UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics}});h.MobageNavLogic={};var n=h.MobageNavLogic.HomeResettingNav=l.subclass({classname:"HomeResettingNav",initialize:function($super,o){$super();this.hostController=o},hostController:null,setHostController:function(o){this.hostController=o},navControllerShouldPopViewController:function(q,p,o){if(!p){return true}if(p instanceof d&&p.isLocked){return false}if(q.length()==1){if(p instanceof d){return false}}return true},navControllerShouldPushViewController:function(o,v,z){NgLogD("mobage-HomeResettingNav: navControllerShouldPush");var u,w;if(e.isLoaded("Home")&&v instanceof e.Home){w=o.getViewControllers();for(u in w){if(w.hasOwnProperty(u)){if(w[u] instanceof e.Home){o.popToViewController(w[u],z);return false}}}}else{if(v instanceof d){w=o.getViewControllers();for(u in w){if(w.hasOwnProperty(u)){var r=w[u];if(r instanceof d){if(r==o.getBottomViewController()&&r.isLocked){continue}if(r.targetGame==v.targetGame){break}else{var q=[];var y=false;for(var s=w.length;s>=0;s++){r=w[s];if(!y&&!(r instanceof d)){continue}y=true;q.push(r)}for(u in q){if(q.hasOwnProperty(u)){o.removeViewController(q[u]);q[u].didPop()}}o.insertViewControllerAtIndex(new e.Home(),0);NgLogD("TODO: MobageNavLogic, how does one actually launch a new game???");break}}else{continue}}}}}if(o.length()>=b.getMaxNavStackDepth()){var t=o.getBottomViewController();var p=0;if(t&&t instanceof d&&t.isLocked){p++;t=o.viewControllerAtIndex(p)}if(t&&!(t instanceof e.Home)){var x=new e.Home();o.insertViewControllerAtIndex(x,p);if(t){o.removeViewControllerAtIndex(p+1);t.didPop();t=o.viewControllerAtIndex(p+1)}}if(t){o.removeViewControllerAtIndex(p+1);t.didPop()}}return true}});var g=h.MobageNavLogic.BackPreservingNav=l.subclass({classname:"BackPreservingNav",initialize:function($super,o){$super();this.hostController=o},hostController:null,setHostController:function(o){this.hostController=o},navControllerShouldPopViewController:function(q,p,o){if(!p){return true}if(p instanceof d&&p.isLocked){return false}if(e.isLoaded("Home")&&p instanceof e.Home&&!this.hostController.isRunningActiveGame()){return false}if(q.length()==1){if(p instanceof d){return false}}return true},navControllerShouldPushViewController:function(o,v,z){NgLogD("mobage-BackPreservingNav: navControllerShouldPush");var u,w;if(v instanceof d){w=o.getViewControllers();for(u in w){if(w.hasOwnProperty(u)){var r=w[u];if(r instanceof d){if(r==o.getBottomViewController()&&r.isLocked){continue}if(r.targetGame==v.targetGame){break}else{var q=[];var y=false;for(var s=w.length;s>=0;s++){r=w[s];if(!y&&!(r instanceof d)){continue}y=true;q.push(r)}for(u in q){if(q.hasOwnProperty(u)){o.removeViewController(q[u]);q[u].didPop()}}o.insertViewControllerAtIndex(new e.Home(),0);NgLogD("TODO: MobageNavLogic, how does one actually launch a new game???");break}}else{continue}}}}if(o.length()>=b.getMaxNavStackDepth()){var t=o.getBottomViewController();var p=0;if(t&&t instanceof d&&t.isLocked){p++;t=o.viewControllerAtIndex(p)}if(t&&!(t instanceof e.Home)){var x=new e.Home();o.insertViewControllerAtIndex(x,p);if(t){o.removeViewControllerAtIndex(p+1);t.didPop();t=o.viewControllerAtIndex(p+1)}}if(t){o.removeViewControllerAtIndex(p+1);t.didPop()}}return true}});var k=h.MobageNavLogic.CredentialsBackPreservingNav=g.subclass({navControllerShouldPopViewController:function($super,q,p,o){if(!p){return true}if(q.getViewControllers().length==1){return false}if(p instanceof d){return false}return $super(q,p,o)}});var f=h.MobageNavLogic.ServiceNavLogic=l.subclass({classname:"ServiceNavLogic",initialize:function($super,o){$super();this.hostController=o},hostController:null,setHostController:function(o){this.hostController=o},navControllerShouldPopViewController:function(q,p,o){if(!p){return true}if(p instanceof d&&p.isLocked){return false}if(e.isLoaded("Home")&&p instanceof e.Home&&!this.hostController.isRunningActiveGame()){return false}if(q.length()==1){return false}return true},navControllerShouldPushViewController:function(o,v,B){NgLogD("mobage-ServiceNavLogic: navControllerShouldPush");var u,w;if(e.isLoaded("Home")&&v instanceof e.Home){w=o.getViewControllers();for(u in w){if(w.hasOwnProperty(u)){if(w[u] instanceof e.Home){o.popToViewController(w[u],B);return false}}}}else{if(v instanceof d){w=o.getViewControllers();for(u in w){if(w.hasOwnProperty(u)){var s=w[u];if(s instanceof d){if(s==o.getBottomViewController()&&s.isLocked){continue}if(s.targetGame==v.targetGame){break}else{var q=[];var y=false;for(var r=0;r>=w.length;r++){var A=w[r];if(A===s){break}q.push(A)}q.push(s);for(var z=0;z<q.length;z++){o.removeViewController(q[z]);q[z].didPop()}break}}else{continue}}}}}if(o.length()>=b.getMaxNavStackDepth()){var t=o.getBottomViewController();var p=0;if(t&&t instanceof d&&t.isLocked){p++;t=o.viewControllerAtIndex(p)}if(t&&!(t instanceof e.Home)){var x=new e.Home();o.insertViewControllerAtIndex(x,p);if(t){o.removeViewControllerAtIndex(p+1);t.didPop();t=o.viewControllerAtIndex(p+1)}}if(t){o.removeViewControllerAtIndex(p+2);t.didPop()}}return true}})}};__ngs._5f={_c:null,_d:function(){var b={exports:{}};var e=b.exports;this._c=b;var c=__ngs.r_(__ngs._59).UI;var a=c.ViewGeometry.Scale;var f=__ngs.r_(__ngs._60).Style;var l=__ngs.r_(__ngs._n).LocalizedString;var d=__ngs.r_(__ngs._2z).Assets;var k=__ngs.r_(__ngs._77).Primitives;__ngs.r_(__ngs._88);var h=__ngs.r_(__ngs._5l).UnspammableButton;var j=__ngs.r_(__ngs._89).CredentialsHeaderView;var g=__ngs.r_(__ngs._8a);var n=__ngs.r_(__ngs._5c).LayoutMethods;var m=e.CredentialsHostView=k.View.subclass({classname:"CredentialsHostView",backgroundView:null,backButton:null,doneButton:null,cancelButton:null,navControllerView:null,standardTitleViewRect:new c.ViewGeometry.Rect([0,0,100,100]),initialize:function($super,o){$super(o);this.backgroundView=(new c.Image()).retain();this.backButton=(new h()).retain();this.footerView=(new c.View()).retain();this.footerLine=(new c.View()).retain();this.footerLabel=(new c.Label()).retain();this.footerButton=(new h()).retain();this.credentialsHeaderView=(new j()).retain();this.doneButton=(new h()).retain();this.cancelButton=(new h()).retain();this.overlayLayer=(new c.View()).retain()},destroy:function(){this.backButton.release();this.backgroundView.release();this.footerView.release();this.footerLine.release();this.footerLabel.release();this.footerButton.release();this.credentialsHeaderView.release();this.doneButton.release();this.cancelButton.release()},sizeChanged:function(G,u){console.log(this.classname+" laying out in "+G+" by "+u);var B=new c.ViewGeometry.Rect(0,0,G,u);var A=new c.ViewGeometry.Rect(0,0,G,u);var o=A.sliceVertical(112/800*B.h);var z=this.footerRect=A.sliceVertical(-104/800*B.h);var p=this.fOutRect=this.footerRect.copy();p.y+=p.h;var r=z.copy();r.x=-2;r.y=0;r.w+=4;r.h+=2;this.backgroundView.setFrame(B);this.addChild(this.backgroundView);var s=this.footerView;s.setFrame(p);this.footerLine.setFrame(r);s.addChild(this.footerLine);this.navControllerView.setFrame(B);this.addChild(this.navControllerView);this.addChild(s);this.addChild(this.credentialsHeaderView);this.credentialsHeaderView.setFrame(o);this.credentialsHeaderView.layoutSubviews();var F=120/480;var t=B.w*F;var q=o.copy();var C=o.copy().sliceHorizontal(t);var I=0.25*100;var E=0.2*100;C.inset(I,E,I,E,c.Scale.Percent);this.backButton.setFrame(C);this.backButton.setText(l("Back"));this.credentialsHeaderView.addChild(this.backButton);this.cancelButton.setText(l("Cancel"));this.cancelButton.setFrame(C);this.cancelButton.setVisible(false);this.cancelButton.onclick=function(){if(this.cancelButtonCB&&((typeof this.cancelButtonCB)==="function")){this.cancelButtonCB()}this.setEditMode(false)}.bind(this);var D=q.sliceHorizontal(-t);D.inset(E);this.doneButton.setFrame(D);this.doneButton.setText(l("Done"));this.doneButton.onclick=function(){if(this.doneButtonCB&&((typeof this.doneButtonCB)==="function")){this.doneButtonCB()}this.setEditMode(false)}.bind(this);this.doneButton.setVisible(false);var v=z.copy();v.x=0;v.y=0;var x=v.sliceHorizontal((311+16)/480*B.w);this.footerLabel.setFrame(x);var y=16/480*B.w;this.footerLabel.setTextInsets(0,y,0,y);s.addChild(this.footerLabel);if(this.footerView&&this.footerView.getParent()){this.footerView.setFrame(z);this.footerView.getParent().addChild(this.footerView)}var H=(104-56)/2/800*B.h;var w=(480-347-118)/480*B.w;v.inset(H,w);this.footerButton.setFrame(v);s.addChild(this.footerButton);if(!this.getStyle()){this.setStyle(new f())}this.footerButton.setAttributes(this.getStyle().props()["standardButton"]);this.footerButton.setGradient(this.getStyle().props()["standardButton"]["pressedGradient"],c.State.Pressed);this.footerButton.setTextScalingBehavior(g.TextMeasuredScalingBehaviors.DynamicMultiLine)},animateFooterOut:function(p){if(this.footerRect.isEmpty()){return}var o=this;if(this.footerView){c.animate(function(){if(o.footerView){o.footerView.setFrame(o.fOutRect)}},p,function(){})}},animateFooterIn:function(p){if(this.footerRect.isEmpty()){return}var o=this;if(this.footerView){this.footerView.setFrame(this.fOutRect);c.animate(function(){if(o.footerView){o.footerView.setFrame(o.footerRect)}},p,function(){})}},setStyle:function($super,p){$super(p);p.defaultsFrom("social.us.credentialshost");for(var q in p.props()){if(p.props().hasOwnProperty(q)&&this.hasOwnProperty(q)&&this[q]){this[q].setAttributes(p.props()[q])}}this.credentialsHeaderView.setStyle(p);this.backButton.setImage(d.image("back_button_ios.png"));this.backButton.setImage(d.image("back_button_ios_down.png"),c.State.Pressed);var o=f.registeredStyle("social.us.commonelements").props();this.doneButton.setAttributes(o.standardButton);this.cancelButton.setAttributes(o.standardButton)},setFooterText:function(o){this.footerLabel.setText(o)},getFooterButton:function(){return this.footerButton},editMode:function(p,o){this.cancelButtonCB=p;this.doneButtonCB=o;this.setEditMode(true)},setEditMode:function(o){if(o){this.backButton.setVisible(false);this.cancelButton.setVisible(true);this.doneButton.setVisible(true)}else{this.backButton.setVisible(true);this.cancelButton.setVisible(false);this.doneButton.setVisible(false)}},setNavControllerView:function(o){this.navControllerView=o;this.addChild(this.navControllerView,2)}})}};__ngs._5g={_c:null,_d:function(){var b={exports:{}};var e=b.exports;this._c=b;var h=__ngs.r_(__ngs._5).Core;var c=__ngs.r_(__ngs._59).UI;var a=c.ViewGeometry.Scale;var f=__ngs.r_(__ngs._60).Style;var l=__ngs.r_(__ngs._n).LocalizedString;var d=__ngs.r_(__ngs._2z).Assets;var k=__ngs.r_(__ngs._77).Primitives;__ngs.r_(__ngs._88);var j=__ngs.r_(__ngs._5l).UnspammableButton;var m=__ngs.r_(__ngs._5c).LayoutMethods;var g=e.DisaggregatedCredentialsHostView=k.View.subclass({classname:"DisaggregatedCredentialsHostView",backgroundView:null,backButton:null,doneButton:null,cancelButton:null,navControllerView:null,standardTitleViewRect:new c.ViewGeometry.Rect([0,0,100,100]),initialize:function($super,n){$super(n);this.backgroundView=(new c.View()).retain();this.backButton=(new j()).retain();this.credentialsHeaderView=(new c.View()).retain();this.doneButton=(new j()).retain();this.cancelButton=(new j()).retain();if(h.Capabilities.getBootGame()===""){this.setGradient({gradient:["FF84CAFF 0.0","FF005CBA 0.8"]})}},destroy:function(){this.backButton.release();this.backgroundView.release();this.credentialsHeaderView.release();this.doneButton.release();this.cancelButton.release()},setFrame:m.setFrame,sizeChanged:function(n,v){var u=new c.ViewGeometry.Rect(this.getFrame());var z=u.copy();var w=z.sliceVertical(112/800*u.h);var o=new c.ViewGeometry.Rect((16/480)*h.Capabilities.getScreenWidth(),(18/800)*h.Capabilities.getScreenHeight(),(448/480)*h.Capabilities.getScreenWidth(),(415/800)*h.Capabilities.getScreenHeight());this.backgroundView.setFrame(o);this.navControllerView.setFrame(u);this.addChild(this.navControllerView);var y=120/480;var p=u.w*y;var x=w.copy();var t=w.copy().sliceHorizontal(p);var s=0.25*100;var r=0.2*100;t.inset(s,r,s,r,c.Scale.Percent);this.backButton.setFrame(t);this.backButton.setText(l("Back"));this.cancelButton.setText(l("Cancel"));this.cancelButton.setFrame(t);this.cancelButton.setVisible(false);this.cancelButton.onclick=function(){if(this.cancelButtonCB&&((typeof this.cancelButtonCB)==="function")){this.cancelButtonCB()}this.setEditMode(false)}.bind(this);var q=x.sliceHorizontal(-p);q.inset(r);this.doneButton.setFrame(q);this.doneButton.setText(l("Done"));this.doneButton.onclick=function(){if(this.doneButtonCB&&((typeof this.doneButtonCB)==="function")){this.doneButtonCB()}this.setEditMode(false)}.bind(this);this.doneButton.setVisible(false)},animateFooterOut:function(n){},animateFooterIn:function(n){},setStyle:function($super,o){$super(o);o.defaultsFrom("social.us.dissaggregatedcredentialshost");for(var p in o.props()){if(o.props().hasOwnProperty(p)&&this.hasOwnProperty(p)&&this[p]){this[p].setAttributes(o.props()[p])}}this.credentialsHeaderView.setStyle(o);this.backButton.setImage(d.image("back_button_ios.png"));this.backButton.setImage(d.image("back_button_ios_down.png"),c.State.Pressed);var n=f.registeredStyle("social.us.commonelements").props();this.doneButton.setAttributes(n.standardButton);this.cancelButton.setAttributes(n.standardButton)},setFooterText:function(n){},getFooterButton:function(){return this.footerButton},setTitleViewFrame:function(n){this.standardTitleViewRect=n.copy();this.standardTitleImageWidth=n.w/2},editMode:function(o,n){this.cancelButtonCB=o;this.doneButtonCB=n;this.setEditMode(true)},setEditMode:function(n){if(n){this.backButton.setVisible(false);this.cancelButton.setVisible(true);this.doneButton.setVisible(true)}else{this.backButton.setVisible(true);this.cancelButton.setVisible(false);this.doneButton.setVisible(false)}},setNavControllerView:function(n){this.navControllerView=n;this.addChild(this.navControllerView)}})}};__ngs._5h={_c:null,_d:function(){var e={exports:{}};var b=e.exports;this._c=e;var f=__ngs.r_(__ngs._6k).MobageStyle;var a=f.ScaledCorners;var g=f.ScaledTextSize;var c=__ngs.r_(__ngs._2z).Assets;var d=__ngs.r_(__ngs._25).Scale;f.lazyLoad(b,"MobageBrandSlideIn",function(){return{style:{image:c.image("powered-by-lozenge.png"),imageFit:3,textColor:"FF",textShadow:"FF00 3.0 {0,-2}",imageGravity:[0.5,0.25],textGravity:[0.5,1],textSize:g(18),gradient:{gradient:["FF011E4C 0.0","FF011E4C 1.0"],innerLine:"FF000000 3",corners:a(13),insets:"{5,5,5,5}"}}}})}};__ngs._5i={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._11).LifecycleEmitter;var d=b.MobagePauseGame={_requestingObjects:[],pauseGame:function(e){if(!e){NgLogW("MobagePauseGame - pauseGame called with bad caller ("+e+")");return}NgLogD("MobagePauseGame - pausing the game");d._requestingObjects.push(e);a.pauseGame()},resumeGame:function(f){var e=d._requestingObjects.indexOf(f);if(e>-1){d._requestingObjects.splice(e,1);if(d._requestingObjects.length===0){NgLogD("MobagePauseGame - resuming the game");a.resumeGame()}}}}}};__ngs._5j={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=new (__ngs.r_(__ngs._f).RequireLoader)({UI:function(){return __ngs.r_(__ngs._59).UI},Scale:function(){return b.UI.ViewGeometry.Scale},UIStyle:function(){return __ngs.r_(__ngs._60).Style},Assets:function(){return __ngs.r_(__ngs._2z).Assets},LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},MenuDrawer:function(){return __ngs.r_(__ngs._8b).MenuDrawer},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities},SystemInfoHook:function(){return __ngs.r_(__ngs._4x).SystemInfoScreen.hook},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},GlobalDownloadingIcon:function(){return __ngs.r_(__ngs._8c).GlobalDownloadingIcon},FullScreenLoader:function(){return __ngs.r_(__ngs._8d).FullScreenLoader}});__ngs.r_(__ngs._88);var a=c.ServiceHostView=b.UI.View.subclass({classname:"ServiceHostView",backgroundView:null,titleBarView:null,titleBarLine:null,mobageButton:null,activeGameButton:null,doneButton:null,cancelButton:null,backButton:null,currentDownload:null,navControllerView:null,standardTitleViewRect:new b.UI.ViewGeometry.Rect([0,0,100,100]),menuDrawerClosedOrClosing:true,titleBarHidden:false,initialize:function($super,e){$super(e);this.menuDrawerIsLocked=false;this.iOSLogoShift=false;this.backgroundView=(new b.UI.Image()).retain();this.titleBarView=(new b.UI.View()).retain();this.titleBarLine=(new b.UI.View()).retain();this.mobageButton=(new b.UnspammableButton()).retain();this.backButton=(new b.UnspammableButton()).retain();this.activeGameButton=(new b.UnspammableButton()).retain();this.doneButton=(new b.UnspammableButton()).retain();this.cancelButton=(new b.UnspammableButton()).retain();this.menuDrawer=(new b.MenuDrawer()).retain();this.menuDrawerCover=(new b.UI.View()).retain();this.spinner=(new b.UI.Spinner()).retain();this.loadingLabel=(new b.UI.Label()).retain();this.currentDownload=(new b.GlobalDownloadingIcon()).retain();this.addChild(this.backgroundView);this.addChild(this.titleBarView);this.addChild(this.titleBarLine);this.addChild(this.currentDownload);this.titleBarView.addChild(this.mobageButton);this.titleBarView.addChild(this.spinner);this.titleBarView.addChild(this.loadingLabel);this.spinner.setVisible(false);this.loadingLabel.setVisible(false);this.setEditMode(false);this._fullScreenLoader=new b.FullScreenLoader().retain();this._fullScreenLoader.setOpaque(true);b.SystemInfoHook(this)},destroy:function(){this.activeGameButton.release();this.backButton.release();this.mobageButton.release();this.titleBarLine.release();this.titleBarView.release();this.backgroundView.release();this.doneButton.release();this.cancelButton.release();this.spinner.release();this.loadingLabel.release();this.currentDownload.release();if(this.menuDrawer){this.menuDrawer.removeFromParent();this.menuDrawer.release();this.menuDrawer=null}if(this.menuDrawerCover){this.menuDrawerCover.removeFromParent();this.menuDrawerCover.release();this.menuDrawerCover=null}},layoutSubviews:function(){NgLogD("mobage-ServiceHostView-layoutSubviews");var q=new b.UI.ViewGeometry.Rect(this.getFrame());var l=q.copy();var f=q.sliceVertical(13.75,b.UI.Scale.Percent);this.layoutMenuDrawer(l.w,l.h);var k=new b.UI.ViewGeometry.Rect();k.x=-1;k.y=f.y+f.h;k.w=f.w+2;k.h=2;this.backgroundView.setFrame(l);var m=this.titleBarView;m.setFrame(f);this.titleBarLine.setFrame(k);this.navControllerView.setFrame(l);var j=new b.UI.ViewGeometry.Rect(0.01*l.w,0.0125*l.h,0.2375*l.w,0.1125*l.h);this.mobageButton.setFrame(j);var e=j.w+2*j.x;var x=0.18;var o=0.3;var h=l.w*0.18;var v=0.1*f.h;var g=f.copy();var r=f.sliceHorizontal(h);r.inset(v);this.backButton.setFrame(r);this.backButton.setText(b.LocText("Back"));this.cancelButton.setText(b.LocText("Cancel"));this.cancelButton.setFrame(r);this.cancelButton.onclick=function(){if(this.cancelButtonCB&&((typeof this.cancelButtonCB)==="function")){this.cancelButtonCB()}this.setEditMode(false)}.bind(this);var n=f.copy();var u=f.sliceHorizontal(-(f.h*2));u.inset(f.h*0.18);this.activeGameButton.setFrame(u);this.activeGameButton.setText(b.LocText("Back To\nGame"));this.activeGameButton.setImageInsets([u.h*0.2,u.w*0.03,u.h*0.2,u.w*2/3]);this.activeGameButton.setTextInsets([0,u.w*1.1/3,0,0]);this.activeGameButton.setImageFit(b.UI.ViewGeometry.FitModes.Inside);this._currentDownloadRect=n.sliceHorizontal(-(f.h*2.4));this._currentDownloadRect.inset(l.h*0.015);this._currentDownloadRectWithGame=f.sliceHorizontal(-(f.h*2.4));this._currentDownloadRectWithGame.inset(l.h*0.015);this.currentDownload.setFrame(this._currentDownloadRect);this.currentDownload.initLayout();var s=g.sliceHorizontal(-h);s.inset(v);this.doneButton.setFrame(s);this.doneButton.setText(b.LocText("Done"));this.doneButton.onclick=function(){if(this.doneButtonCB&&((typeof this.doneButtonCB)==="function")){this.doneButtonCB()}this.setEditMode(false)}.bind(this);var t=new b.UI.ViewGeometry.Rect(0.018*l.w+0.45*l.w,0.03*l.h,0.18*l.w,0.07*l.h);var p=new b.UI.ViewGeometry.Rect(0.018*l.w+0.425*l.w,0.04*l.h,0.05*l.h,0.05*l.h);this.spinner.setFrame(p);this.loadingLabel.setMaxLines(1);this.loadingLabel.setFrame(t);this.loadingLabel.setTextSize(0.029*l.h);this.loadingLabel.setTextColor("FFFFFFFF");this.loadingLabel.setText(" "+b.LocText("Loading..."));if(!b.Capabilities.isPlatformAndroid()){if(this.iOSLogoShift){this.shiftMobageLogo()}else{this.resetShiftMobageLogo()}}var w=l.copy();w.sliceVertical(0-(l.h-f.h));w.sliceHorizontal(-f.h);w.sliceHorizontal(e);NgLogD("MobageTitleRect old:"+f+" new:"+w);this.setTitleViewFrame(w);if(!this.getStyle()){this.setStyle(new b.UIStyle())}},layoutMenuDrawer:function(f,e){var g=Math.ceil(102/480*Math.min(f,e));this.menuDrawerRect=new b.UI.ViewGeometry.Rect(0,e-g,f,g);this.menuDrawerOutRect=this.menuDrawerRect.copy();this.menuDrawerOutRect.y+=this.menuDrawerOutRect.h;if(this.menuDrawer){this.menuDrawer.setFrame(this.menuDrawerOutRect)}if(this.menuDrawerCover){this.menuDrawerCover.setFrame(new b.UI.ViewGeometry.Rect(0,0,f,e));this.menuDrawerCover.onclick=function(){this.closeMenuDrawer()}.bind(this)}},setStyle:function($super,f){$super(f);f.defaultsFrom("social.us.servicehost");for(var g in f.props()){if(f.props().hasOwnProperty(g)&&this.hasOwnProperty(g)&&this[g]){this[g].setAttributes(f.props()[g])}}this.backButton.setImage(b.Assets.image("back_button_ios.png"));this.backButton.setImage(b.Assets.image("back_button_ios_down.png"),b.UI.State.Pressed);var e=b.UIStyle.registeredStyle("social.us.commonelements").props();this.doneButton.setAttributes(e.standardButton);this.cancelButton.setAttributes(e.standardButton);this.activeGameButton.setAttributes(f.props()["activeGameButton"]);this.activeGameButton.setGradient(f.props()["activeGameButton"].gradientPressed,b.UI.State.Pressed);this.activeGameButton.setTextColor(f.props()["activeGameButton"].textColorPressed,b.UI.State.Pressed);this.activeGameButton.setImage(b.Assets.image("backtogamearrow.png"))},setTitleViewFrame:function(e){this.standardTitleViewRect=e.copy();this.standardTitleImageWidth=e.h/2.5},hideTitleBar:function(e){if(e&&!this.titleBarHidden){this.titleBarView.removeFromParent();this.titleBarLine.removeFromParent()}else{if(this.titleBarHidden){this.addChild(this.titleBarView);this.addChild(this.titleBarLine)}}this.titleBarHidden=e;console.log("hideTitleBar called")},editMode:function(f,e){this.cancelButtonCB=f;this.doneButtonCB=e;this.setEditMode(true)},setEditMode:function(e){this._isEditMode=e;if(e){this.backButton.setVisible(false);this.activeGameButton.setVisible(false);this.cancelButton.setVisible(true);this.doneButton.setVisible(true)}else{this.backButton.setVisible(true);this.activeGameButton.setVisible(true);this.cancelButton.setVisible(false);this.doneButton.setVisible(false)}},setNavControllerView:function(e){this.navControllerView=e;this.addChild(this.navControllerView,2)},shiftMobageLogo:function(){NgLogD("ServiceHostView: shift mobage logo");var g=new b.UI.ViewGeometry.Rect(this.getFrame());var f=g.copy();this.mobageButton.setFrame(new b.UI.ViewGeometry.Rect(f.w/2-(0.11875*f.w),0.0125*f.h,0.2375*f.w,0.1125*f.h));var e=new b.UI.ViewGeometry.Rect(f.w/2+((0.11875*f.w)+0.05*f.h),0.04*f.h,0.05*f.h,0.05*f.h);this.spinner.setFrame(e);this.loadingLabel.setText(" ")},resetShiftMobageLogo:function(){NgLogD("ServiceHostView: shift mobage logo reset");var g=new b.UI.ViewGeometry.Rect(this.getFrame());var f=g.copy();this.mobageButton.setFrame(new b.UI.ViewGeometry.Rect(0.01*f.w,0.0125*f.h,0.2375*f.w,0.1125*f.h));var e=new b.UI.ViewGeometry.Rect(0.018*f.w+0.425*f.w,0.04*f.h,0.05*f.h,0.05*f.h);this.spinner.setFrame(e);this.loadingLabel.setText(" "+b.LocText("Loading..."))},animateMenuDrawerIn:function(){if(!this._menuDrawerLayer){this._menuDrawerLayer=b.UI.Window._getLayer(2)}if(this.menuDrawerIsLocked||this.menuDrawerRect.isEmpty()||!b.Capabilities.isPlatformAndroid()){return}var e=this;this.menuDrawerClosedOrClosing=false;if(this.menuDrawerCover){this.menuDrawerCover.removeFromParent();this._menuDrawerLayer.addChild(this.menuDrawerCover)}if(this.menuDrawer){this.menuDrawer.removeFromParent();this.menuDrawer.setFrame(this.menuDrawerOutRect);this._menuDrawerLayer.addChild(this.menuDrawer);b.UI.animate(function(){if(e.menuDrawer){e.menuDrawer.setFrame(e.menuDrawerRect)}},undefined,function(){})}},animateMenuDrawerOut:function(g,f){if(this.menuDrawerRect.isEmpty()||!b.Capabilities.isPlatformAndroid()){return}if(g!==undefined){if(g){this.menuDrawerIsLocked=true;return}else{this.menuDrawerIsLocked=false}}var e=this;this.menuDrawerClosedOrClosing=true;if(this.menuDrawerCover){this.menuDrawerCover.removeFromParent()}if(this.menuDrawer){if(f===undefined||f){b.UI.animate(function(){if(e.menuDrawer){e.menuDrawer.setFrame(e.menuDrawerOutRect)}},undefined,function(){if(e.menuDrawer){e.menuDrawer.removeFromParent()}})}else{this.menuDrawer.setFrame(this.menuDrawerOutRect);this.menuDrawer.removeFromParent()}}},menuKeyPressed:function(){if(this.menuDrawerClosedOrClosing){this.animateMenuDrawerIn()}else{this.animateMenuDrawerOut()}return true},closeMenuDrawer:function(f,e){this.animateMenuDrawerOut(f,e)},isMenuDrawerClosedOrClosing:function(){return this.menuDrawerClosedOrClosing},showFullScreenLoadingSpinner:function(){if(!this._menuDrawerLayer){this._menuDrawerLayer=b.UI.Window._getLayer(100)}this._menuDrawerLayer.addChild(this._fullScreenLoader)},hideFullScreenLoadingSpinner:function(){if(this._menuDrawerLayer){this._menuDrawerLayer.removeChild(this._fullScreenLoader)}}})}};__ngs._5k={_c:null,_d:function(){var e={exports:{}};var g=e.exports;this._c=e;var h=__ngs.r_(__ngs._5).Core;var c=__ngs.r_(__ngs._4).Device;var f=__ngs.r_(__ngs._59).UI;var b=new (__ngs.r_(__ngs._f).RequireLoader)({Assets:function(){return __ngs.r_(__ngs._2z).Assets},OldStyle:function(){return __ngs.r_(__ngs._60).Style},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},Credentials:function(){return __ngs.r_(__ngs._2r).Credentials},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},ModalDialogStyle:function(){return __ngs.r_(__ngs._8e)}});var d=__ngs.r_(__ngs._7g).ViewController;var k=__ngs.r_(__ngs._n).LocalizedString;var j=h.MessageListener.subclass({classname:"CustomModalDialog_KeyListener"});var a=g.CustomModalDialog=d.subclass({classname:"CustomModalDialog",_inFlight:false,initialize:function($super,m){$super();a.currentDialog=this;this._curUser=m;var l=this;b.ModalDialogStyle;this._modalStyle=b.OldStyle.registeredStyle("social.us.loginmodaldialog").props();this._transparentBase=new f.Button().retain();f.Window.document.addChild(this._transparentBase);this._topBarBgPane=new f.View().retain();this._topBarBgPane.setAttributes(this._modalStyle.topBarBackgroundPane);f.Window.document.addChild(this._topBarBgPane);this._label1=new f.Label().retain();this._topBarBgPane.addChild(this._label1);this._label2=new f.Label().retain();this._topBarBgPane.addChild(this._label2);this._goButton=new f.Button().retain();this._goButton.setText(k("Let's go!"));this._goButton.setAttributes(this._modalStyle.standardButton);this._goButton.onclick=function(o){if(!this._inFlight){this._inFlight=true;this.destroy();b.ServiceHost.hide();b.Credentials.showRegistration(function(){var p=b.ServiceHost.navController.getTopViewController();b.ServiceHost.show();p.onUserLogin()},true,true,"tiered",null,"obsolete_homeScreenPreview");this._inFlight=false}}.bind(this);this._topBarBgPane.addChild(this._goButton);this._closeButton=new f.Button().retain();this._closeButton.setImage(b.Assets.image("closebutton_up.png"));this._closeButton.setImage(b.Assets.image("closebutton_down.png"),f.State.Pressed);f.Window.document.addChild(this._closeButton);var n=function(o){if(!this._inFlight){this._inFlight=true;this.destroy();this._inFlight=false}}.bind(this);this._transparentBase.onclick=n;this._closeButton.onclick=n;this.layoutViews();this.kListener=new j();b.UnspammableButton.addDeviceKeyListener(this.kListener,this.onKeyPressed.bind(this),99999);return this},loadView:function($super){$super()},layoutViews:function(){var n=h.Capabilities.getScreenWidth();var p=h.Capabilities.getScreenHeight();this._transparentBase.setGradient({gradient:["66000000 0.0","66000000 0.0"]});this._transparentBase.setFrame(0,0,p,n);var q=[p/8,n/4,p*6/8,n*2/4];this._topBarBgPane.setFrame(q);var o=10;var r=q[3]/5;var m=q[3]/4;this._goButton.setFrame([q[2]/5,q[3]-m*1.5,q[2]-q[2]/5*2,m]);this._goButton.setTextSize(m*1/3);this._label1.setTextSize(r*0.5);this._label1.setAttributes(this._modalStyle.textHeader);this._label1.setText(k("You look great today!"));this._label1.setFrame([0,q[3]/6-r/3,q[2],r]);this._label2.setTextSize(r*0.45);this._label2.setAttributes(this._modalStyle.textBody);this._label2.setText(k("Choose your Mobage name to play."));this._label2.setFrame([0,q[3]/6+r,q[2],r]);var l=q[3]/6;this._closeButton.setFrame(p*7/8-l,n/4,l,l)},onKeyPressed:function(l){if(l.code===c.KeyEmitter.Keycode.back){if(this._transparentBase){this.destroy();return true}}return false},destroy:function(){a.currentDialog=undefined;this._transparentBase.release();this._topBarBgPane.release();this._label1.release();this._label2.release();this._closeButton.release();c.KeyEmitter.removeListener(this.kListener);this.kListener=undefined}});a.show=function(){if(!a.currentDialog){new a()}}}};__ngs._5l={_c:null,_d:function(){var e={exports:{}};var b=e.exports;this._c=e;var d=__ngs.r_(__ngs._4).Device;var f=__ngs.r_(__ngs._77).Primitives;var c=__ngs.r_(__ngs._68).SpamProtectionLock;var g=__ngs.r_(__ngs._68).getSpamProtectionLockForName;var a=b.UnspammableButton=f.Button.subclass({classname:"UnspammableButton",_spamProtectionEnabled:null,_spamProtectionLock:null,_spamProtectionLockName:null,initialize:function($super,h){$super(h);this._spamProtectionEnabled=true;this.setSpamLockName("default");return this},performEventCallback:function($super,h){switch(h.eventType){case"click":if(this._spamProtectionEnabled&&!this._spamProtectionLock.acquire()){this.loge("Spam Protection abort! LockPool: [",this._spamProtectionLockName||"","]");return}default:if($super){$super(h)}break}},getSpamLock:function(){return this._spamProtectionLock},getSpamLockName:function(){return this._spamProtectionLockName},setSpamLockName:function(h){this._spamProtectionLockName=h;this._spamProtectionLock=g(h)},getSpamProtectionEnabled:function(){return this._spamProtectionEnabled},setSpamProtectionEnabled:function(h){this._spamProtectionEnabled=h}});b.UnspammableButton.addDeviceKeyListener=function(j,h,k){d.KeyEmitter.addListener(j,function(n){if((n.code!==d.KeyEmitter.Keycode.back)&&(n.code!==d.KeyEmitter.Keycode.backunhandled)&&(n.code!==d.KeyEmitter.Keycode.menu)){return h(n)}var l="default";var m=g(l);if(!m.peekAcquire()){NgLogE("Hardware Key Spam Protection abort! LockPool: [",l||"","]");return true}if(h(n)){m.acquire();return true}return false},k)}}};__ngs._5m={_c:null,_d:function(){var h={exports:{}};var k=h.exports;this._c=h;var l=__ngs.r_(__ngs._5).Core;var g=__ngs.r_(__ngs._4).Device;var j=__ngs.r_(__ngs._59).UI;var o=__ngs.r_(__ngs._8f).LimitedEditText;var f=__ngs.r_(__ngs._6k).MobageStyle;var c=new (__ngs.r_(__ngs._f).RequireLoader)({OldStyle:function(){return __ngs.r_(__ngs._60).Style},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},ModalDialogStyles:function(){return __ngs.r_(__ngs._8e)},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},Assets:function(){return __ngs.r_(__ngs._2z).Assets},Purchase:function(){return __ngs.r_(__ngs._2y).Purchase}});var q=l.MessageListener.subclass({classname:"ModalDialog_KeyListener"});var b=j.CellView.subclass({classname:"SizeReportingCellView",sizeChanged:function(){if(this.controller&&this.controller.onViewSizeChanged){this.controller.onViewSizeChanged.apply(this.controller,Array.prototype.slice.call(arguments))}}});var p=__ngs.r_(__ngs._n).LocalizedString;var e=__ngs.r_(__ngs._7g).ViewController;var m=k.ModalDialog=e.subclass({classname:"ModalDialog",initialize:function(){this.kListener=new q()},destroy:function(){NgLogD("Destroying ModalDialog "+this.classname);g.KeyEmitter.removeListener(this.kListener);this.kListener=undefined},loadView:function($super){if(!this._view){this.setView(new b());this.view().setOnClick(this.zombieSafeCallback(this.hide))}$super()},show:function(){if(this._showing){return}this._showing=true;c.UnspammableButton.addDeviceKeyListener(this.kListener,this.onKeyPressed.bind(this),99999)},hide:function(){if(!this._showing){return}this._showing=false;if(this.kListener){g.KeyEmitter.removeListener(this.kListener)}},onKeyPressed:function(r){if(r.code===g.KeyEmitter.Keycode.back||r.code===g.KeyEmitter.Keycode.menu){this.hide();return true}return false}});var a=k.ReportUserModalDialog=m.subclass({classname:"ReportUserModalDialog",initialize:function($super,s,u){$super();this.maxLength=255;this._curUser=s;var r=this;c.ModalDialogStyles;this._modalStyle=c.OldStyle.registeredStyle("social.us.modaldialog").props();this._transparentBase=new c.UnspammableButton().retain();this._transparentBase.onclick=function(v){r.destroy()};j.Window.document.addChild(this._transparentBase);this._topBarBgPane=new j.View().retain();this._topBarBgPane.setAttributes(this._modalStyle.topBarBackgroundPane);j.Window.document.addChild(this._topBarBgPane);this._reportLabel=new j.Label().retain();this._topBarBgPane.addChild(this._reportLabel);this._textBox=new o("report_reason").retain();this._textBox.setEnterKeyType(j.Commands.EnterKeyType.Done);this._textBox.setPlaceholder(p("Please enter a reason to report this user."));this._topBarBgPane.addChild(this._textBox);this._reportButton=new c.UnspammableButton().retain();this._reportButton.setText(p("Report"));this._reportButton.setAttributes(this._modalStyle.standardButton);this._reportButton.onclick=function(){if(r._textBox.ensureTextLegalBeforeSubmit()){r._curUser.report(r._textBox.getText(),function(w,x){if(x===true){var v=new j.AlertDialog();v.setTitle(p("User reported--we're looking into it. Thanks!"));v.setChoices([p("OK")]);v.show();v.onchoice=function(y){r.destroy()}}else{NgLogD("Error in ModalDialog.js:buttonReportUser: "+w)}},u)}};this._topBarBgPane.addChild(this._reportButton);this._cancelButton=new c.UnspammableButton().retain();this._cancelButton.setText(p("Cancel"));this._cancelButton.setAttributes(this._modalStyle.standardButton);this._cancelButton.onclick=function(v){r.destroy()};this._topBarBgPane.addChild(this._cancelButton);this.layoutViews(g.OrientationEmitter.getInterfaceOrientation());var t=l.MessageListener.subclass({_onOrientationEvent:function(v){if(v.type===g.OrientationEmitter.OrientationType.Interface){r.layoutViews(v.orientation)}},destroy:function(){g.OrientationEmitter.removeListener(this)}});this.orientationListenerInstance=new t();g.OrientationEmitter.addListener(this.orientationListenerInstance,this.orientationListenerInstance._onOrientationEvent);this.show();return this},loadView:function($super){if(!this._view){this.setView(new j.View())}$super()},layoutViews:function(A){if(this._currentOrientation===A){return}if(A===g.OrientationEmitter.Orientation.FaceUp||A===g.OrientationEmitter.Orientation.FaceDown){if(this._currentOrientation===null){A=g.OrientationEmitter.Orientation.Portrait}else{return}}this._currentOrientation=A;var r=l.Capabilities.getScreenWidth();var t=l.Capabilities.getScreenHeight();var s=r;var z=t;var x;if(A===g.OrientationEmitter.Orientation.LandscapeLeft||A===g.OrientationEmitter.Orientation.LandscapeRight){x=true;s=t;z=r}else{x=false}this._transparentBase.setGradient({gradient:["66000000 0.0","66000000 0.0"]});this._transparentBase.setFrame(0,0,s,z);var u;if(x){u=[s/8,z/4,s*6/8,z/2.5]}else{u=[s/8,z*1/3,s*6/8,z*1/3]}this._topBarBgPane.setFrame(u);var B=10;var w=u[3]*this._modalStyle.labelHFactor;var v=u[3]*this._modalStyle.buttonHFactor;var y=(u[3]-B-v)-(B+w)-B;this._reportLabel.setTextSize(w*this._modalStyle.labelTextHFactor);this._reportLabel.setTextColor("FFFFFFFF");this._reportLabel.setText(p("Report %1s",this._curUser.gamertag));this._reportLabel.setFrame([B,B,u[2]-2*B,w]);this._textBox.setFrame([B,B*3/2+w,u[2]-2*B,y]);this._textBox.setTextGravity(j.ViewGeometry.Gravity.Left);this._textBox.setAttributes(this._modalStyle.textBox);this._reportButton.setFrame([B,u[3]-B-v,u[2]/2-B*3/2,v]);this._cancelButton.setFrame([u[2]/2+B/2,u[3]-B-v,u[2]/2-B*3/2,v])},onKeyPressed:function(r){if(r.code===g.KeyEmitter.Keycode.back||r.code===g.KeyEmitter.Keycode.menu){if(this._transparentBase){this.destroy();return true}}return false},destroy:function(){this._transparentBase.release();this._topBarBgPane.release();this._reportLabel.release();this._textBox.release();this._reportButton.release();this._cancelButton.release();this.orientationListenerInstance.destroy()}});var d=k.ForgotPasswordModalDialog=m.subclass({classname:"ForgotPasswordModalDialog",initialize:function($super){$super();var r=this;this._transparentBase=new c.UnspammableButton().retain();this._transparentBase.onclick=function(t){r.destroy()};this._topBarBgPane=new j.View().retain();this._titleLabel=new j.Label().retain();this._textBox=new j.EditText().retain();this._sendButton=new c.UnspammableButton().retain();this._cancelButton=new c.UnspammableButton().retain();j.Window.document.addChild(this._transparentBase);j.Window.document.addChild(this._topBarBgPane);this._topBarBgPane.addChild(this._titleLabel);this._topBarBgPane.addChild(this._textBox);this._topBarBgPane.addChild(this._sendButton);this._topBarBgPane.addChild(this._cancelButton);this._textBox.setEnterKeyType(j.Commands.EnterKeyType.Done);this._textBox.setPlaceholder(p("Email"));this._textBox.setInputType(j.Commands.InputType.Email);this._sendButton.setText(p("Send"));this._cancelButton.setText(p("Cancel"));this._titleLabel.setText(p("Forgot Password?"));this._style=c.ModalDialogStyles.ForgotPasswordModal;this._style.applyTo(this);this._sendButton.onclick=function(){NgLogD("Send email clicked.");var u=r._textBox.getText();if(!r.progressDialog){r.progressDialog=new j.ProgressDialog();r.progressDialog.setText(p("Sending request"))}var t=__ngs.r_(__ngs._28).PlusRequest;if(u.length&&t.emailAddressIsValid(u)){r.progressDialog.show()}t.sendPasswordResetEmailWithAddress(u,this.bind(function(v){r.progressDialog.hide();r.progressDialog.destroy();r.progressDialog=undefined;NgLogD("Mobage/ForgotPassword/Plus Request response="+JSON.stringify(v));if(!v){c.UIUtils.showToast(p("Email sent!"));r.destroy()}else{if(v.indexOf("email")!=-1){NgLogD("Email sent ERROR");r._textBox.setState(f.ErrorState)}c.UIUtils.showToast(v)}}))};this._cancelButton.onclick=function(t){r._textBox.blur();r.destroy()};this.layoutViews(g.OrientationEmitter.getInterfaceOrientation());var s=l.MessageListener.subclass({_onOrientationEvent:function(t){if(t.type===g.OrientationEmitter.OrientationType.Interface){r.layoutViews(t.orientation)}},destroy:function(){g.OrientationEmitter.removeListener(this)}});this.orientationListenerInstance=new s();g.OrientationEmitter.addListener(this.orientationListenerInstance,this.orientationListenerInstance._onOrientationEvent);this.show();return this},loadView:function($super){if(!this._view){this.setView(new j.View())}$super()},layoutViews:function(v){var u=l.Capabilities.getScreenWidth();var w=l.Capabilities.getScreenHeight();this._transparentBase.setGradient({gradient:["66000000 0.0","66000000 0.0"]});this._transparentBase.setFrame(0,0,u,w);var t=[u/8,w*(1/3),u*6/8,w*(1/3)];var r=10;var s=t[3]*(1/6);this._topBarBgPane.setFrame(t[0],t[1],t[2],s*3.5+(r*2));this._titleLabel.setFrame([r,r,t[2]-2*r,s]);this._textBox.setFrame([r,r+(s),t[2]-2*r,s*1.5]);this._textBox.setTextGravity([1,0.5]);this._sendButton.setFrame([r,r+(s*2.5),t[2]/2-r*3/2,s]);this._cancelButton.setFrame([t[2]/2+r/2,r+(s*2.5),t[2]/2-r*3/2,s])},setUserEmail:function(r){this._textBox.setText(r)},onKeyPressed:function(r){if(r.code===g.KeyEmitter.Keycode.back||r.code===g.KeyEmitter.Keycode.menu){if(this._transparentBase){this.destroy();return true}}return false},destroy:function(){this._transparentBase.release();this._topBarBgPane.release();this._textBox.release();this._sendButton.release();this._cancelButton.release();this.orientationListenerInstance.destroy()}});var n=k.NoMobacoinModal=m.subclass({classname:"NoMobacoinModal",initialize:function($super,u,s,t){$super();this._curUser=s;var r=this;this._transparentBase=new c.UnspammableButton().retain();this._transparentBase.onclick=function(v){c.Purchase._CREATE_TXN_LOCK=null;r.destroy()};j.Window.document.addChild(this._transparentBase);this._topBarBgPane=new j.View().retain();j.Window.document.addChild(this._topBarBgPane);this._bottomPane=new j.View().retain();j.Window.document.addChild(this._bottomPane);this._icon=(new j.Image()).retain();this._icon.setImage(c.Assets.image("mobacoin.png"));this._topBarBgPane.addChild(this._icon);this._reportLabel=new j.Label().retain();this._topBarBgPane.addChild(this._reportLabel);this._textLabel=new j.Label().retain();this._topBarBgPane.addChild(this._textLabel);this._gotoBankButton=new c.UnspammableButton().retain();this._gotoBankButton.setText(p("Get MobaCoin!"));this._gotoBankButton.onclick=function(){u(r)};this._bottomPane.addChild(this._gotoBankButton);this._style=c.ModalDialogStyles.NoMobacoinModal;this._style.applyTo(this);this.layoutViews(g.OrientationEmitter.getInterfaceOrientation());this.show();return this},loadView:function($super){if(!this._view){this.setView(new j.View())}$super()},layoutViews:function(F){if(this._currentOrientation===F){return}if(F===g.OrientationEmitter.Orientation.FaceUp||F===g.OrientationEmitter.Orientation.FaceDown){if(this._currentOrientation===null){F=g.OrientationEmitter.Orientation.Portrait}else{return}}this._currentOrientation=F;var t=l.Capabilities.getScreenWidth();var v=l.Capabilities.getScreenHeight();var u=t;var D=v;var A;if(F===g.OrientationEmitter.Orientation.LandscapeLeft||F===g.OrientationEmitter.Orientation.LandscapeRight){A=true;u=v;D=t}else{A=false}this._transparentBase.setGradient({gradient:["66000000 0.0","66000000 0.0"]});this._transparentBase.setFrame(0,0,u,D);var x;var w;var G;var C;var E=10;var s=this._style.extras.viewRatio;if(A){G=D*2/4-D*2/4*s.buttonHFactor*2;x=[u/6,D/4,u*4/6,G];w=[u/6,D/4+G,u*4/6,D*2/4*s.buttonHFactor+20];C=w[2]-E*24}else{G=D*1/3-D*1/3*s.buttonHFactor*2;x=[u/8,D*1/3,u*6/8,G];w=[u/8,D*1/3+G-1,u*6/8,D*1/3*s.buttonHFactor+20];C=w[2]-E*16}this._topBarBgPane.setFrame(x);this._bottomPane.setFrame(w);var z=x[3]*s.labelHFactor*1.4;var y=w[3]-2*E;var B=(x[3]-E-y)-(E+z)-E;this._icon.setFrame([E,E,z*1.5,z*1.5]);this._reportLabel.setTextSize(z/2.5*s.labelTextHFactor*1.4);this._reportLabel.setTextColor("FFFFFFFF");this._reportLabel.setText(p("You'll need some MobaCoin"));this._reportLabel.setTextGravity(j.ViewGeometry.Gravity.Left);this._reportLabel.setFrame([2*E+z*1.5,E/2,x[2]-3*E-z,z*2]);this._textLabel.setTextSize(z/2.3*s.labelTextHFactor*1.1);this._textLabel.setTextColor("FFFFFFFF");this._textLabel.setText(p("MobaCoin is the currency for all your Mobage games."));this._textLabel.setFrame([E,E*5+z,x[2]-2*E,B]);this._gotoBankButton.setFrame([w[2]/2-C/2,E,C,y])},onKeyPressed:function(r){if(r.code===g.KeyEmitter.Keycode.back||r.code===g.KeyEmitter.Keycode.menu){if(this._transparentBase){this.destroy();c.Purchase._CREATE_TXN_LOCK=null;return true}}return false},destroy:function(){this._transparentBase.release();this._topBarBgPane.release();this._icon.release();this._reportLabel.release();this._gotoBankButton.release();this._textLabel.release();this._bottomPane.release()}})}};__ngs._5n={_c:null,_d:function(){var c={exports:{}};var g=c.exports;this._c=c;var h=__ngs.r_(__ngs._5).Core;var f=__ngs.r_(__ngs._59).UI;var b=__ngs.r_(__ngs._6k).MobageStyle;var e=b.ScaledCorners;var k=b.ScaledTextSize;var d=__ngs.r_(__ngs._2a).Destinations;var a=new (__ngs.r_(__ngs._f).RequireLoader)({LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics}});var j=g.NuxView=f.View.subclass({classname:"NuxView",initialize:function($super,n,m){$super();NgLogD("NUX VIEW INIT");this.numGoals=m;this.backgroundImage=(new f.Image()).retain();this.backgroundRect=(new f.View).retain();this.transparentBase=(new a.UnspammableButton()).retain();this.titleTxt=(new f.Label()).retain();this.goal1Btn=(new a.UnspammableButton()).retain();this.goal2Btn=(new a.UnspammableButton()).retain();this.goal3Btn=(new a.UnspammableButton()).retain();this.goal4Btn=(new a.UnspammableButton()).retain();this.goal1BtnImg=(new f.Button()).retain();this.goal2BtnImg=(new f.Button()).retain();this.goal3BtnImg=(new f.Button()).retain();this.goal4BtnImg=(new f.Button()).retain();this.goal1BtnLabel=(new f.Label()).retain();this.goal2BtnLabel=(new f.Label()).retain();this.goal3BtnLabel=(new f.Label()).retain();this.goal4BtnLabel=(new f.Label()).retain();this.progressBar=(new f.ProgressBar()).retain();this.progressBarTxt=(new f.Label()).retain();this.progressBar.setTouchable(false);this._skipForever=false;this.progressBar.setProgressGradient({corners:e(8),gradient:["FF75B624 0.000","FF4D8D1F 1.000"],insets:"{1.0,1.0,1.0,1.0}"});this.progressBar.setSecondaryGradient({corners:e(8),gradient:["4C75B624 0.000","4C4D8D1F 1.000"],insets:"{1.0,1.0,1.0,1.0}"});this.progressBar.setGradient({corners:e(8),gradient:["FFFFFF 1.000"],outerLine:"FFFFFF 2.0"});this.progressBarTxt.setText(a.LocText("1 of 4"));this.skipCheck=(new f.CheckBox()).retain();this.footerLabel=(new f.Label()).retain();this.skipBtn=(new a.UnspammableButton()).retain();this.completeBtnHome=(new a.UnspammableButton()).retain();this.completeBtnGame=(new a.UnspammableButton()).retain();this.footerBg=(new a.UnspammableButton()).retain();this.completeBtnHome.setText(a.LocText("Mobage Home"));this.completeBtnGame.setText(a.LocText("Back to Game"));this.completeBtnHome.setVisible(false);this.completeBtnGame.setVisible(false);this.addChild(this.transparentBase);this.addChild(this.backgroundRect);this.addChild(this.backgroundImage);this.addChild(this.titleTxt);this.addChild(this.goal1BtnImg);this.addChild(this.goal2BtnImg);this.addChild(this.goal3BtnImg);this.addChild(this.goal4BtnImg);this.addChild(this.goal1Btn);this.addChild(this.goal2Btn);this.addChild(this.goal3Btn);this.addChild(this.goal4Btn);this.addChild(this.goal1BtnLabel);this.addChild(this.goal2BtnLabel);this.addChild(this.goal3BtnLabel);this.addChild(this.goal4BtnLabel);this.addChild(this.progressBar);this.addChild(this.progressBarTxt);this.addChild(this.footerBg);this.addChild(this.footerLabel);this.addChild(this.skipCheck);this.addChild(this.skipBtn);this.addChild(this.completeBtnHome);this.addChild(this.completeBtnGame);this.addClickHandlers(n);var l=__ngs.r_(__ngs._8g).NuxStyle;l.applyTo(this);this.layoutViews(f.Window.getWidth(),f.Window.getHeight())},addClickHandlers:function(m){var l=this;this.transparentBase.onclick=function(n){};this.goal1Btn.onclick=function(n){d.pushScreen(a.ServiceHost.navController,"Settings",{user:m._user},l);a.MobageAnalytics.reportEvent("NUXCLICKNAME");l.controller.hide()};this.goal2Btn.onclick=function(n){d.pushScreen(a.ServiceHost.navController,"Settings",{user:m._user},l);a.MobageAnalytics.reportEvent("NUXCLICKPROFILE");l.controller.hide()};this.goal3Btn.onclick=function(n){d.pushScreen(a.ServiceHost.navController,"FindFriends",{},l);a.MobageAnalytics.reportEvent("NUXCLICKFRIENDS");l.controller.hide()};this.goal4Btn.onclick=function(n){d.pushScreen(a.ServiceHost.navController,"Catalog",{},l);a.MobageAnalytics.reportEvent("NUXCLICKGAMES");l.controller.hide()};this.skipCheck.onclick=this.bind(function(n){if(n.eventType=="click"){l._skipForever=!l._skipForever;NgLogD("SKIP FOREVER: "+l._skipForever)}});this.skipBtn.onclick=function(n){if(l._skipForever){NgLogD("//NUX DESTROY 4EVER");a.MobageAnalytics.reportEvent("NUXCLICKSKIPFOREVER");l.controller._setNuxComplete()}else{NgLogD("//NUX HIDE");a.MobageAnalytics.reportEvent("NUXCLICKSKIPHIDE");l.controller.hide()}};this.completeBtnHome.onclick=function(n){l.controller._setNuxComplete();a.MobageAnalytics.reportEvent("NUXCLICKCOMPLETEHOME");d.pushScreen(a.ServiceHost.navController,"Home",{},l)};this.completeBtnGame.onclick=function(n){l.controller._setNuxComplete();a.MobageAnalytics.reportEvent("NUXCLICKCOMPLETEBACKTOGAME");d.pushScreen(a.ServiceHost.navController,"GamePlaceholder",{host:a.ServiceHost.navController,game:"AhabTester_hardcoded"})}},setStates:function(m,t,n,o,s){var u=this;var q=1;var r=u.numGoals;var p;var l=u.progressBar.getFrame();u.goal1Btn.setState(f.State.Disabled);NgLogD("//NUX STATES");NgLogD("//PROFILE: "+m);if(m){q++;u.goal2Btn.setState(f.State.Disabled)}NgLogD("//FRIENDS: "+t);if(t){q++;u.goal3Btn.setState(f.State.Disabled)}NgLogD("//GAMES: "+n);if(n){q++;u.goal4Btn.setState(f.State.Disabled)}this.objectivesComplete=q;p=q/r;if(o){NgLogD("NUX PROGRESS ANIMATE");u.setProgressState(q)}else{u.progressBar.setProgress(p,p)}u.progressBarTxt.setText(a.LocText("%1d of %2d",q,r));if(q==r){u.setVictoryState(s)}else{u.progressBarTxt.setFrame(l[0],l[1],l[2]*(p),l[3])}},getObjectivesComplete:function(){return this.objectivesComplete},layoutViews:function(R,M){this._orientedScreenWidth=R;this._orientedScreenHeight=M;var D=R>=M;if(D){var p=this._orientedScreenWidth;var w=this._orientedScreenHeight;var N=p/800;var G=w/480;var F=new f.ViewGeometry.Rect(0,0,p,w);F.x=0;F.y=0;var o=40;var J=20;var Q=14;this.backgroundImage.setFrame(F.copy().inset(o*G,140*N,o*G,140*N));this.backgroundRect.setFrame(F.copy().inset(o*G,140*N,o*G,140*N));this.transparentBase.setFrame(0,0,p,w);var E=F.copy().inset(o*G,140*N,o*G,(140*N));var A=new f.ViewGeometry.Rect(E.x,(o*G)+(E.h)-(70*N),E.w,70*N);var x=A.copy();this.completeBtnHome.setFrame(A.copy().inset(J*G,A.w/2+(J*N),J*G,J*N));this.completeBtnGame.setFrame(A.copy().inset(J*G,J*N,J*G,A.w/2));this.footerBg.setFrame(A);this.skipBtn.setFrame(A.w-J,(A.y+A.h/2)-(20*N),(150*N),(40*N));this.skipCheck.setFrame(A.copy().inset((J/2)*G,A.w-((50*N)),(J/2)*G,(J/2)*G));A.sliceHorizontal(60*N);this.footerLabel.setFrame(A.sliceHorizontal(200*N));var n=E.sliceVertical(100*G);this.titleTxt.setFrame(n);var m=E.sliceVertical(100*G);m.sliceHorizontal(J*N);this.goal1BtnImg.setFrame(m.sliceHorizontal(110*N));m.sliceHorizontal(Q*N);this.goal2BtnImg.setFrame(m.sliceHorizontal(110*N));m.sliceHorizontal(Q*N);this.goal3BtnImg.setFrame(m.sliceHorizontal(110*N));m.sliceHorizontal(Q*N);this.goal4BtnImg.setFrame(m.sliceHorizontal(110*N));this.goal1Btn.setFrame(this.goal1BtnImg.getFrame());this.goal2Btn.setFrame(this.goal2BtnImg.getFrame());this.goal3Btn.setFrame(this.goal3BtnImg.getFrame());this.goal4Btn.setFrame(this.goal4BtnImg.getFrame());var P=E.sliceVertical(60*G);P.sliceHorizontal(J*N);this.goal1BtnLabel.setFrame(P.sliceHorizontal(110*N));P.sliceHorizontal(Q*N);this.goal2BtnLabel.setFrame(P.sliceHorizontal(110*N));P.sliceHorizontal(Q*N);this.goal3BtnLabel.setFrame(P.sliceHorizontal(110*N));P.sliceHorizontal(Q*N);this.goal4BtnLabel.setFrame(P.sliceHorizontal(110*N));E.sliceVertical(20*G);var I=E.sliceVertical(40*G);this.progressBar.setFrame(I.inset(0,J,0,J))}else{var y=this._orientedScreenWidth;var v=this._orientedScreenHeight;var s=y/480;var l=v/800;var u=new f.ViewGeometry.Rect(0,0,y,v);u.x=0;u.y=0;var B=14;var t=14;var r=10;this.backgroundImage.setFrame(u.copy().inset(180*l,B*s,180*l,B*s));this.backgroundRect.setFrame(u.copy().inset(180*l,B*s,180*l,B*s));this.transparentBase.setFrame(0,0,y,v);var q=u.copy().inset(180*l,B*s,(180*l)-(B*s),B*s);var C=new f.ViewGeometry.Rect(q.x,(u.h-(180*l))-(70*s),q.w,70*s);this.backgroundImage.setFrame(u.copy().inset(180*l,B*s,180*l,B*s));this.backgroundRect.setFrame(u.copy().inset(180*l,B*s,180*l,B*s));this.transparentBase.setFrame(0,0,y,v);this.completeBtnHome.setFrame(C.copy().inset(t*l,C.w/2+(t*s),t*l,t*s));this.completeBtnGame.setFrame(C.copy().inset(t*l,t*s,t*l,C.w/2));this.footerBg.setFrame(C);this.skipBtn.setFrame(C.w-(150*s),(C.y+C.h/2)-(20*s),(150*s),(40*s));this.skipCheck.setFrame(t,(C.y+C.h/2)-(25*s),(50*s),(50*s));C.sliceHorizontal(60*s);this.footerLabel.setFrame(C.sliceHorizontal(200*s));var z=q.sliceVertical(100*l);this.titleTxt.setFrame(z);var L=q.sliceVertical(110*l);L.sliceHorizontal(t*s);this.goal1BtnImg.setFrame(L.sliceHorizontal(100*s));L.sliceHorizontal(r*s);this.goal2BtnImg.setFrame(L.sliceHorizontal(100*s));L.sliceHorizontal(r*s);this.goal3BtnImg.setFrame(L.sliceHorizontal(100*s));L.sliceHorizontal(r*s);this.goal4BtnImg.setFrame(L.sliceHorizontal(100*s));this.goal1Btn.setFrame(this.goal1BtnImg.getFrame());this.goal2Btn.setFrame(this.goal2BtnImg.getFrame());this.goal3Btn.setFrame(this.goal3BtnImg.getFrame());this.goal4Btn.setFrame(this.goal4BtnImg.getFrame());var O=q.sliceVertical(60*l);O.sliceHorizontal(t*s);this.goal1BtnLabel.setFrame(O.sliceHorizontal(100*s));O.sliceHorizontal(r*s);this.goal2BtnLabel.setFrame(O.sliceHorizontal(100*s));O.sliceHorizontal(r*s);this.goal3BtnLabel.setFrame(O.sliceHorizontal(100*s));O.sliceHorizontal(r*s);this.goal4BtnLabel.setFrame(O.sliceHorizontal(100*s));q.sliceVertical(20*l);var K=q.sliceVertical(40*l);this.progressBar.setFrame(K.inset(0,t,0,t))}if(this.objectivesComplete!==undefined){this.progressBarTxt.setFrame(this.progressBar.getFrame()[0],this.progressBar.getFrame()[1],this.progressBar.getFrame()[2]*(this.objectivesComplete/this.numGoals),this.progressBar.getFrame()[3])}},setVictoryState:function(l){if(l===null||l===""){this.titleTxt.setText(a.LocText("Congratulations!"))}else{this.titleTxt.setText(a.LocText("Congratulations %1s!",l))}this.completeBtnHome.setVisible(true);this.completeBtnGame.setVisible(true);this.progressBarTxt.setText(a.LocText("Complete!"));this.progressBarTxt.setFrame(this.progressBar.getFrame());this.skipCheck.setVisible(false);this.skipBtn.setVisible(false);this.footerBg.setVisible(false);this.footerLabel.setVisible(false)},setProgressState:function(m){var o=(m/this.numGoals);this.progressBar.setProgress(0,o);var n=o-0.25;var l=(function(){n=n+0.01;this.progressBar.setProgress(n,o);if(n<o){setTimeout(l,10)}}).bind(this);l()}})}};__ngs._5o={_c:null,_d:function(){var a={exports:{}};var d=a.exports;this._c=a;var c=__ngs.r_(__ngs._o).Session;var e=__ngs.r_(__ngs._28).PlusRequest;var h=__ngs.r_(__ngs._5p).Transaction;var b=__ngs.r_(__ngs._59).UI;var f=__ngs.r_(__ngs._n).Localization;var g=__ngs.r_(__ngs._5).Core;var j=__ngs.r_(__ngs._a).Storage;d.Balance={classname:"Balance",get:function(o){NgLogD("GET balance");var m=undefined;var r=false;var p=0;var l="mobacoin";var k=undefined;var q=c.getCurrentSession();if(!q){if(o){o(m,r,p,l)}return}var n=e.newBankRequest();if(h._isIOS()){n.setApiMethod("bank/balance?os=ios")}else{n.setApiMethod("bank/balance?os=Android")}n.setHttpMethod("GET");n.send(function(t,u,v,s){NgLogD("err = "+t);NgLogD("data = "+JSON.stringify(u));m=t;if(u){if(u.hasOwnProperty("success")){r=u.success}if(u.hasOwnProperty("balance")){p=u.balance}if(u.hasOwnProperty("currency")){l=u.currency}if(u.hasOwnProperty("currency_icon")){k=u.currency_icon}}if(t||(!r)){if(o){o(m,r,p,l,k)}}else{if(o){o(m,r,p,l,k)}}})},addCommas:function(k){return f.getNumber(k,0)}}}};__ngs._5p={_c:null,_d:function(){var e={exports:{}};var b=e.exports;this._c=e;var f=__ngs.r_(__ngs._5).Core;var d=__ngs.r_(__ngs._s).Network;var c=__ngs.r_(__ngs._28).PlusRequest;var a=b.Transaction=f.Class.subclass({$_balanceCBList:{},$authorize:function(h,g){a._putToNextState(h,"authorize",g)},$close:function(h,g){a._putToNextState(h,"close",g)},$open:function(h,g){a._putToNextState(h,"open",g)},$cancel:function(h,g){a._putToNextState(h,"cancel",g)},$create:function(h,o,g){var n=c.newBankRequest();n.setApiMethod("bank/debit");n.setHttpMethod("POST");n.setHttpHeaders({"Content-Type":"application/json; charset=utf-8"});var j=new Array();for(var k=0;k<h.length;k++){var m={item:{sku:h[k].item.id},quantity:h[k].quantity};j.push(m)}var l={};l.items=j;l.comment=o;if(this._isIOS()){l.os="ios"}else{l.os="Android"}NgLogD("Mobage/Transaction create postBody = "+JSON.stringify(l));n.setPostBody(JSON.stringify(l));n.sendRetry(function(r,s,t,p){NgLogD("err = "+r);NgLogD("data = "+JSON.stringify(s));var u=undefined;var q=a.getErrorObj(r,s,p);if(s){u=s.transaction_id}if(g&&typeof g=="function"){g(q,u)}})},$_updateBalance:function(){for(var h in a._balanceCBList){var g=a._balanceCBList[h];g()}},$registerBalanceCB:function(h,g){a._balanceCBList[h]=g},$unRegisterBalanceCB:function(g){delete a._balanceCBList[g]},$_putToNextState:function(k,j,h){var l=c.newBankRequest();if(this._isIOS()){l.setApiMethod("bank/debit/"+k+"?state="+j+"&os=ios")}else{l.setApiMethod("bank/debit/"+k+"?state="+j+"&os=Android")}if(j.toLowerCase()==="authorize"){var g="sandbox";if(c.serverModeIsProduction()){g="service"}d._int_Util.sign(k,g,function(m){NgLogD("Mobage/Transaction: sign authorize txn");l.setPostBody({signature:m});this._sendDebitRequest(l,j,h)}.bind(this))}else{this._sendDebitRequest(l,j,h)}},$_sendDebitRequest:function(j,h,g){j.setHttpMethod("PUT");j.setHttpHeaders({"Content-Type":"application/json; charset=utf-8"});j.sendRetry(function(n,o,p,k){NgLogD("err = "+n);NgLogD("data = "+JSON.stringify(o));var q=undefined;var l=undefined;NgLogD("data = "+JSON.stringify(o));if(o){q=o.transaction_id;l=o.state;if(!o.success){n="failed:status="+k+"err="+n}else{if(!l){NgLogD("txn state = "+h);l=h}if(l.toLowerCase()==="open"||l.toLowerCase()==="canceled"){a._updateBalance()}}}var m=a.getErrorObj(n,o,k);if(g&&typeof g=="function"){g(m,q,l)}})},$closeCreditTxn:function(h,g){var j=c.newBankRequest();if(this._isIOS()){j.setApiMethod("bank/credit/"+h+"?state=close&os=ios")}else{j.setApiMethod("bank/credit/"+h+"?state=close&os=Android")}j.setHttpMethod("PUT");j.setHttpHeaders({"Content-Type":"application/json; charset=utf-8"});j.sendRetry(function(n,o,p,k){var q=undefined;var l=undefined;NgLogD("data = "+JSON.stringify(o));if(o){q=o.transaction_id;l=o.state;if(!o.success||(typeof l)==="undefined"){n="failed:status="+k+"err="+n}else{a._updateBalance()}}var m=a.getErrorObj(n,o,k);if(g&&typeof g=="function"){g(m)}})},$_isIOS:function(){if(typeof this._capIsIOS!="undefined"){return this._capIsIOS}this._capIsIOS=f.Capabilities.isPlatformIOS();return this._capIsIOS},$credit:function(l,o,j,p,h,n,m){var k=c.newBankRequest();var q=this;k.setApiMethod("bank/credit");k.setHttpMethod("POST");k.setHttpHeaders({"Content-Type":"application/json; charset=utf-8"});var g={comment:l,item:{sku:o,quantity:j},receipt:p,origin_price:n,origin_currency:m};if(q._isIOS()){g.os="ios"}else{g.os="Android"}k.setPostBody(JSON.stringify(g));k.sendRetry(function(t,u,v,r){if((!t)&&u){if((!u.success)&&(u.error)){t=u.error}if(u.transaction_id){u.id=u.transaction_id}}var s=a.getErrorObj(t,u,r);if(h&&typeof h=="function"){h(s,u,r);a._updateBalance()}})},$getItems:function(k,g){var h=this;var j=c.newBankRequest();if(!h._isIOS()&&k){j.setApiMethod("bank/items?product_id=0&os=Android")}else{if(h._isIOS()){if(k){j.setApiMethod("bank/items?os=ios&type=credit")}else{j.setApiMethod("bank/items?os=ios")}}else{j.setApiMethod("bank/items?os=Android")}}j.setHttpMethod("GET");j.setHttpHeaders({"Content-Type":"application/json; charset=utf-8"});j.sendRetry(function(m,o,l,n){NgLogD("data = "+JSON.stringify(o));var q=new Array();if(o&&(o.items)){for(var p=0;p<o.items.length;p++){var t=o.items[p];var s={id:t.sku,price:t.value,description:t.description,imageUrl:t.image_url,name:t.display_name,currency:t.currency,origin_price:t.origin_price,display_origin_price:t.display_origin_price};if(parseInt(s.origin_price.replace(/,/g,"").replace(/\./g,""),10)!==0){if(k){q.push(s)}}else{if(!k){q.push(s)}}}}var r=a.getErrorObj(m,o,n);if(g&&((typeof g)=="function")){g(r,q)}})},$getErrorObj:function(j,k,g){if(!j){return j}var h=undefined;if(k&&k.success){return h}if(k&&!k.success){h={errorCode:k.error,description:k.error_msg}}else{h={errorCode:999,description:"failed:status="+g+"&err="+j}}return h}})}};__ngs._5q={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.DataType={Bank:__ngs.r_(__ngs._8h).Bank,Basic:__ngs.r_(__ngs._8i).Basic}}};__ngs._5r={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._5).Core;a.PreparedAction=c.Class.subclass({initialize:function(){},prepare:function(){if(!this._isPreparing){this._isPreparing=true;if(typeof this.onPrepare=="function"){this.onPrepare()}else{this.prepared()}}},prepared:function(){this._isPreparing=false;if(!this._isPrepared){this._isPrepared=true;if(this._shouldExecute){this.execute()}}},execute:function(){if(!this._isExecuting){if(this._isPrepared){this._shouldExecute=false;this._isExecuting=true;if(typeof this.onExecute=="function"){this.onExecute()}else{this.executed()}}else{this._shouldExecute=true}}},executed:function(){this._hasExecuted=true;this._isExecuting=false;if(typeof this.onDidExecute=="function"){this.onDidExecute()}},isPreparing:function(){return this._isPreparing||false},isPrepared:function(){return this._isPrepared||false},shouldExecute:function(){return this._shouldExecute||false},isExecuting:function(){return this._isExecuting||false}})}};__ngs._5s={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=__ngs.r_(__ngs._2f).Dispatcher;var e=__ngs.r_(__ngs._28);var a=__ngs.r_(__ngs._8j).UserList;var f=a.subclass({classname:"UserBuddiesList",initialize:function($super,j,h,k,g){$super(j,h,k,g);this.apiMethod="users/"+h+"/buddies"}});c.UserBuddiesList=f}};__ngs._5t={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=__ngs.r_(__ngs._2f).Dispatcher;var e=__ngs.r_(__ngs._28);var a=__ngs.r_(__ngs._8j).UserList;var f=a.subclass({classname:"UserGameFriendsList",initialize:function($super,h,g,j,k){$super(h,g,j);this.apiMethod="users/"+g+"/friends";this._groupName=k;this._afterValue=undefined},_postBodyForPage:function(h){var g={relation:this.relation,count:this._requestPageSize};if(this._groupName){g.group=this._groupName}if(this._afterValue){g.after=this._afterValue}return g},_handleRequestData:function(l){this._knownEndOfSet=l.total;var j=this.userList.length||0;if(l.friends.length>0){b.beginBatching();for(var g in l.friends){if(l.friends.hasOwnProperty(g)){var k=l.friends[g];var h=this._userClassRef.getUserWithData(k);var m=j+parseInt(g,10);this.userList[m]=h}}b.endBatching()}}});c.UserGameFriendsList=f}};__ngs._5u={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=__ngs.r_(__ngs._2f).Dispatcher;var e=__ngs.r_(__ngs._28);var a=__ngs.r_(__ngs._8j).UserList;var f=a.subclass({classname:"FeaturedUsersList",initialize:function($super,h,g){$super(h,g);if(g){this.apiMethod="users/"+g+"/featured_users"}else{this.apiMethod="featured_users"}},_postBodyForPage:function(g){return{full:true}},_removeDuplicateUsers:function(j){var g=0;var h={};while(g!=j.length){if(h[j[g].gamertag]){j.splice(g,1)}else{h[j[g].gamertag]=true;++g}}},_handleRequestData:function(k){if(k.featured_users){this._removeDuplicateUsers(k.featured_users);this._knownEndOfSet=k.featured_users.length;b.beginBatching();for(var h in k.featured_users){if(k.featured_users.hasOwnProperty(h)){var j=k.featured_users[h];if(!j[this._userClassRef.PhotoKey]){j[this._userClassRef.PhotoKey]=j.photourl}if(!j.user_id){j.user_id=j.userid}var g=this._userClassRef.getUserWithData(j);this.userList[h]=g}}b.endBatching()}}});c.FeaturedUsersList=f}};__ngs._5v={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var a=__ngs.r_(__ngs._2f).Dispatcher;var e=__ngs.r_(__ngs._28);var f=__ngs.r_(__ngs._7d).OrderedList;var c=__ngs.r_(__ngs._2z).Assets;var g=f.subclass({classname:"OwnedGamesList",initialize:function($super,j,k){var h=0;$super(h);this._gameClassRef=j;this._data={};this.userID=k;this.apiMethod="users/"+k+"/games"},_hasData:function(h){return this._data.hasOwnProperty(h)&&this._data[h]},_getData:function(h){return this._data[h]},_constructRequest:function(j){var h=new e.PlusRequest();h.setApiMethod(this.apiMethod);h.setHttpMethod("GET");return h},_handleRequestData:function(l){this._data={};if(l.games){a.beginBatching();var k=0;for(var h=0;h<l.games.length;h++){if(c.isSupportGame(l.games[h].app_key)){var j=this._gameClassRef.getGameWithData(l.games[h]);if(j){this._data[k++]=j}}}this._knownEndOfSet=k;a.endBatching()}}});b.OwnedGamesList=g}};__ngs._5w={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Dispatcher:function(){return __ngs.r_(__ngs._2f).Dispatcher},PlusRequest:function(){return __ngs.r_(__ngs._28).PlusRequest},Achievement:function(){return __ngs.r_(__ngs._3k).Achievement}});var e=__ngs.r_(__ngs._7d).OrderedList;var d=b.AchievementsList=e.subclass({classname:"AchievementsList",initialize:function($super,g){var f=0;$super(f);this._data={};this._userID=g;this.apiMethod="users/"+g+"/achievements"},_hasData:function(f){return this._data.hasOwnProperty(f)&&this._data[f]},_getData:function(f){return this._data[f]},_constructRequest:function(g){var f=new a.PlusRequest();f.setApiMethod(this.apiMethod);f.setHttpMethod("GET");return f},_handleRequestData:function(j){this._data={};if(j.achievements){a.Dispatcher.beginBatching();var h=0;for(var f=0;f<j.achievements.length;f++){var g=a.Achievement.getAchievementWithData(this._userID,j.achievements[f]);if(g){this._data[h++]=g}}this._knownEndOfSet=h;a.Dispatcher.endBatching()}}})}};__ngs._5x={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Social={};a.Social.Common=new (__ngs.r_(__ngs._8k).RequireLoader)({Appdata:function(){return __ngs.r_(__ngs._8l).Appdata},Auth:function(){return __ngs.r_(__ngs._8m).Auth},Blacklist:function(){return __ngs.r_(__ngs._8n).Blacklist},Config:function(){return __ngs.r_(__ngs._8o).Config},People:function(){return __ngs.r_(__ngs._8p).People},Profanity:function(){return __ngs.r_(__ngs._8q).Profanity},Request:function(){return __ngs.r_(__ngs._8r).Request},RemoteNotification:function(){return __ngs.r_(__ngs._8s).RemoteNotification},Service:function(){return __ngs.r_(__ngs._8t).Service},Analytics:function(){return __ngs.r_(__ngs._8u).Analytics},Leaderboard:function(){return __ngs.r_(__ngs._8v).Leaderboard}});a.Social.US=new (__ngs.r_(__ngs._8k).RequireLoader)({DataModel:function(){return __ngs.r_(__ngs._8w).DataModel},User:function(){return __ngs.r_(__ngs._8x).User},Game:function(){return __ngs.r_(__ngs._8y).Game},FullGamercard:function(){return __ngs.r_(__ngs._8z).FullGamercard},Leaderboard:function(){return __ngs.r_(__ngs._90).Leaderboard},Achievement:function(){return __ngs.r_(__ngs._91).Achievement},Score:function(){return __ngs.r_(__ngs._92).Score},AppData:function(){return __ngs.r_(__ngs._93).AppData},Cache:function(){return __ngs.r_(__ngs._94).Cache},AB:function(){return __ngs.r_(__ngs._95).AB},Session:function(){return __ngs.r_(__ngs._96).Session},Dispatcher:function(){return __ngs.r_(__ngs._97).Dispatcher},Reward:function(){return __ngs.r_(__ngs._98).Reward}});a.Social.US.Service=new (__ngs.r_(__ngs._8k).RequireLoader)({Leaderboards:function(){return __ngs.r_(__ngs._99).Leaderboards},Friends:function(){return __ngs.r_(__ngs._9a).Friends},Profile:function(){return __ngs.r_(__ngs._9b).Profile},ButtonOverlays:function(){return __ngs.r_(__ngs._9c).ButtonOverlays},GameLaunchPayload:function(){return __ngs.r_(__ngs._9d).GameLaunchPayload},Achievements:function(){return __ngs.r_(__ngs._9e).Achievements}});a.Bank=__ngs.r_(__ngs._9f).Bank}};__ngs._5y={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var b=__ngs.r_(__ngs._7g).ViewController;var d={willPop:true,didPop:true,willPush:true,didPush:true,willHide:true,didHide:true,willReshow:true,didReshow:true};var a=c.NavigableViewController=b.subclass({classname:"NavigableViewController",equals:function(f){return this.classname==f.classname},navController:null,_title:null,_titleImage:null,_interfaceActive:false,getTitle:function(){NgLogE("Screen Titles Have Been Deprecated");return this._title},setTitle:function(f){this._title=f;NgLogE("Screen Titles Have Been Deprecated")},getTitleImage:function(){NgLogE("Screen Titles Have Been Deprecated");return this._titleImage},setTitleImage:function(f){this._titleImage=f;NgLogE("Screen Titles Have Been Deprecated")},loadView:function($super){if(!this._view){this.setView(new (__ngs.r_(__ngs._6v).NavigableView)())}$super()},willPush:function(f){},didPush:function(f){this._interfaceActive=true},willPop:function(f){this._interfaceActive=false},didPop:function(f){},willReshow:function(f){if(f.host.showLoadingLabel){f.host.showLoadingLabel()}},didReshow:function(f){if(f.host.hideLoadingLabel){f.host.hideLoadingLabel()}this._interfaceActive=true},willHide:function(f){this._interfaceActive=false},didHide:function(f){},performEventCallback:function(g){var f=g.eventType;if(f in d){this.navController=g.navController;console.log("Calling for "+f+": "+(typeof this[f]));this[f].call(this,g);(f=="didPop")&&(this.navController=null)}else{console.log("Bad Event: "+g.eventType)}}})}};__ngs._5z={_c:null,_d:function(){var e={exports:{}};var l=e.exports;this._c=e;var f=__ngs.r_(__ngs._59).UI;var o=__ngs.r_(__ngs._5).Core;var d=f.ViewGeometry.Rect;var c=f.ViewGeometry.Scale;var g=__ngs.r_(__ngs._6v).NavigableView;var b=new (__ngs.r_(__ngs._f).RequireLoader)({VerticalTabViewSizing:function(){return __ngs.r_(__ngs._9g).VerticalTabViewSizing}});var k=__ngs.r_(__ngs._9h);var a=k.Composite;var h=k.CompositeLayoutGroup;var j=__ngs.r_(__ngs._9i).Components;var n=f.View.subclass({classname:"VTabViewBody",initialize:function($super){$super();this._buttonsRect=new f.ViewGeometry.Rect(0,0,0,0);this._contentRect=new f.ViewGeometry.Rect(0,0,0,0);this._hackedContentRect=new f.ViewGeometry.Rect(0,0,0,0);this._buttonContainerInset=0;this._contentInset=[0,0,0,0];this._selectedTab=null;this._rootPerfHacked=false;return this},layoutSubviews:function($super){if(typeof($super)=="function"){$super()}this.layoutButtonContainer();this._contentRect.x=this._buttonsRect.x+this._buttonsRect.w;this._contentRect.y=0;this._contentRect.w=this._frame[2]-this._contentRect.x;this._contentRect.h=this._frame[3];this._contentRect.inset(this._contentInset[0],this._contentInset[1],this._contentInset[2],this._contentInset[3]);this._contentRect.x=Math.round(this._contentRect.x);this._contentRect.y=Math.round(this._contentRect.y);this._contentRect.h=Math.round(this._contentRect.h);this._contentRect.w=Math.round(this._contentRect.w);this._hackedContentRect.x=this._contentRect.x+this._frame[0];this._hackedContentRect.y=this._contentRect.y+this._frame[1];this._hackedContentRect.w=this._contentRect.w;this._hackedContentRect.h=this._contentRect.h;var p;var r=this.getParent().tabContent;for(var q=0;q<r.length;q++){if((p=r[q].contentView)){if(this._rootPerfHacked){p.setFrame(this._hackedContentRect)}else{p.setFrame(this._contentRect)}}}},layoutButtonContainer:function(){if(this._buttonsRect.isEmpty()){this.loge(" can't layoutButtonContainer with an empty frame!");return}var x=new f.ViewGeometry.Rect(this._buttonsRect);x.sliceVertical(this._buttonContainerInset/8);var w=null;var u=null;var t=null;var p=this.getParent().tabContent;var s=o.Capabilities.getScreenHeight()/800;var q=4*s;for(var r=0;r<p.length;r++){w=p[r];if(w.tabView.getParent()!=this){this.addChild(w.tabView)}var v=0;if(typeof(w.tabView.getHeightRatio)=="function"){v=w.tabView.getHeightRatio()*this._buttonsRect.h}else{if(w.tabView.getFrame()){v=w.tabView.getFrame()[3]}}u=x.sliceVertical(v+q);u.inset(0+q,0,0,this._buttonContainerInset);w.tabView.setFrame(u)}if(this._selectedTab){this._adjustTabButton(this._selectedTab,true)}},setButtonContainerInsetAmount:function(p){if(isNaN(p)){return}this._buttonContainerInset=p},setContentView:function(p){if(this._contentView){this.removeChild(this._contentView)}if(this._rootPerfHacked){f.Window.document.addChild(this._contentView);p.setFrame(this._hackedContentRect)}else{this.addChild(p);p.setFrame(this._contentRect)}this._contentView=p},setButtonContainerRect:function(p){this._buttonsRect=p},getButtonContainerRect:function(){return this._buttonsRect},setContentInset:function(p){this._contentInset=p},setSelectedTab:function(p){if(p!==this._selectedTab){if(this._selectedTab){this._adjustTabButton(this._selectedTab,false);this._selectedTab.setSelected(false)}this._adjustTabButton(p,true);p.setSelected(true)}this._selectedTab=p},_adjustTabButton:function(s,q){var p=this._buttonContainerInset/2;if(!q){p=-p}var r=s.getFrame();r[0]-=p;r[2]+=p;s.setFrame(r)},_rootPerformanceHack:function(){if(!this._rootPerfHacked){if(this._contentView){this.removeChild(this._contentView);this._contentView.setFrame(this._hackedContentRect);f.Window.document.addChild(this._contentView);this._contentView.setVisibleInOrientations(f.Commands.OrientationFlag.Landscape)}}this._rootPerfHacked=true},_undoRootPerformanceHack:function(){if(this._rootPerfHacked&&this._contentView){f.Window.document.removeChild(this._contentView);this._contentView.setFrame(this._contentRect);this.addChild(this._contentView)}this._rootPerfHacked=false}});var m=l.VerticalTabView=g.subclass({classname:"VerticalTabView",initialize:function($super,p){this._compositePrepare();this._compositeInits.content=function(q){this[q]=(new n()).retain()};$super(p);this.tabContent=[];this.setFrameSize([100,100]);NgLogD("VerticalTabView initialized.");return this},tabContent:null,destroy:function(){for(var p in this.tabContent){if(this.tabContent.hasOwnProperty(p)){var q=this.tabContent[p];q.tabView.release();if(q.contentView){q.contentView.release()}}}},layoutSubviews:function($super){$super();var q=new f.ViewGeometry.Rect(this.content.getFrame());q.x=q.y=0;if(q.isEmpty()){NgLogD("VerticalTabView: layoutSubviews EmptyRect");return}var s=this.getContentView();var y=q.w*b.VerticalTabViewSizing.insetRatio;this.logv("ButtonContainerInsetAmount:"+y);var w=s.getButtonContainerRect();var t=Math.min(o.Capabilities.getScreenHeight(),o.Capabilities.getScreenWidth());var p=Math.max(o.Capabilities.getScreenHeight(),o.Capabilities.getScreenWidth());var u=800/480;var r=u*t;var x=b.VerticalTabViewSizing.buttonContainerRatio*r/p;w.w=x*q.w;w.h=q.h;var v=y/4;w.x=w.y=v;s.setButtonContainerRect(w);s.setContentInset([v,v,v,0]);s.setButtonContainerInsetAmount(y);s.layoutSubviews()},layoutButtonContainer:function(){this.getContentView().layoutButtonContainer()}})}};__ngs._60={_c:null,_d:function(){var c={exports:{}};var q=c.exports;this._c=c;var h=__ngs.r_(__ngs._87).ReferenceCounting;var p=__ngs.r_(__ngs._2j).Logger;var r=__ngs.r_(__ngs._9j).Color;var m=__ngs.r_(__ngs._9k).DynamicValue;var j=__ngs.r_(__ngs._9l).DynamicTextSize;var l=__ngs.r_(__ngs._9m).ProportionalCorners;var n=__ngs.r_(__ngs._9n).FontCascade;var s={};var b={};var e=false;var g=function(t){if(p.shouldLog(null,"Style")){var u=Array.prototype.slice.call(arguments);u.unshift("Style: ");p.debug.apply(p,u)}};var f=function(t){var u=Array.prototype.slice.call(arguments);u.unshift("Style: ");p.error.apply(p,u)};var o=function(w){if(null===w||"object"!==typeof w||w instanceof m){return w}var x;if(w instanceof Array){x=[];var u=w.length;for(var v=0;v<u;++v){x[v]=o(w[v])}return x}if(w instanceof Object){x={};for(var t in w){if(w.hasOwnProperty(t)){x[t]=o(w[t])}}return x}throw new Error("Unable to copy obj! Its type isn't supported.")};var d=function(u){if(u instanceof Object){for(var t in u){if(u.hasOwnProperty(t)){if(u[t] instanceof m){u[t]=u[t].realize()}if(u[t] instanceof Object){d(u[t])}else{if(!u[t]&&(u[t]===null||u[t]===undefined)){delete u[t]}}}}}return u};var k=null;var a=q.Style=h.subclass({classname:"Style",initialize:function(t){if(t instanceof a){this._properties=o(t._properties)}else{if(t===null||typeof t==="undefined"){this._properties={}}else{this._properties=o(t)}}},_properties:null,_safeProps:null,props:function(){if(!this._safeProps){this._safeProps=d(o(this._properties))}return this._safeProps},toString:function(){return this.classname+JSON.stringify(this.props())},override:function(x,w){if(typeof w=="undefined"){w=0}else{w++}if(w>100){f("ERROR! Too much recursion in stylesheets. Cycle suspected!");return}this._safeProps=null;var v={};if(typeof x==="string"){v=o(a.registeredStyle(x)._properties)}else{if(x instanceof a){v=o(x._properties)}else{v=o(x)}}var t;for(var u in v){if(u==="parent"){continue}if(typeof(this._properties[u])==="object"){t=(new a(this._properties[u])).retain();t.override(v[u],w);this._properties[u]=t._properties}else{this._properties[u]=v[u]}}},defaultsFrom:function(x,w){if(typeof w=="undefined"){w=0}else{w++}if(w>100){f("Stylesheet ERROR! Too much recursion in stylesheets. Cycle suspected!");return}this._safeProps=null;var v={};if(typeof x==="string"){v=o(a.registeredStyle(x)._properties)}else{if(x instanceof a){v=o(x._properties)}else{v=o(x)}}var t;for(var u in v){if(u=="parent"){continue}if(typeof this._properties[u]==="undefined"){this._properties[u]=v[u]}else{if(typeof this._properties[u]==="object"){t=(new a(this._properties[u])).retain();t.defaultsFrom(v[u],w);this._properties[u]=t._properties}}}},$register:function(u,t){if(s.hasOwnProperty(u)){g("Stylesheet Warning: Reregistering a stylesheet for an existing name: "+u)}var v=t;if(v instanceof a){s[u]=v}else{s[u]=(new a(v)).retain()}},$registeredStyle:function(t){if(!e){a.instantiateAllStylesheets()}if(!s.hasOwnProperty(t)){return(new a()).retain()}return s[t]},$sheet:function(t,u){if(b.hasOwnProperty(t)){f("Stylesheet Error: Overriding another unregistered style. Probably namespace collision: '"+t+"'\nWill lead to orphaned style references. Fix This!")}if(!e){b[t]=u}else{g("stylesheets already instantiated, directly making:",t);k(t,u)}},$instantiateAllStylesheets:function(){g("Stylesheets: Instantiating Global Stylesheets.");if(e){f("Stylesheet Error: Only instantiate the stylesheets once!\n\t If you're seeing this a bunch you're probably calling Style.registeredStyle(name) from the global scope.")}e=true;var u=["placeholder"];var t=0;while(u.length>0&&t<1000){u=[];for(var y in b){if(b.hasOwnProperty(y)){if(typeof b[y]["parent"]=="undefined"||s.hasOwnProperty(b[y]["parent"])){k(y,b[y]);u.push(y)}}}for(var w in u){if(u.hasOwnProperty(w)){delete b[u[w]]}}t++}if(b.length>0){var x=[];for(var v in b){x.push(v)}g("Stylesheet: Discovered cycles in the stylesheet inheritance graph. \nUnprocessed styles:\n\t"+x.join("\n\t"))}}});q.Style.clone=o;k=function(t,w){var v=null;var u=null;g("Stylesheet: Instantiating Stylesheet named: "+t);if(w.hasOwnProperty("parent")&&(u=s[w.parent])){v=(new a(u._properties)).retain();v.override(w);delete v._properties.parent}else{v=(new a(w)).retain()}a.register(t,v)};q.Style.Color=r;q.Style.ProportionalCornersClass=l;q.Style.ScaledCorners=function(t){if(!t){return new l()}if(t instanceof String||t instanceof l||t instanceof Array){return new l(t)}return new l(Array.prototype.slice.call(arguments))};q.Style.FontCascade=n;q.Style.defaultRegularFontFace=n.defaultRegularFontFace;q.Style.defaultBoldFontFace=n.defaultBoldFontFace;q.Style.defaultItalicFontFace=n.defaultItalicFontFace;q.Style.defaultBoldItalicFontFace=n.defaultBoldItalicFontFace;q.Style.DynamicTextSize=j;q.Style.ScaledTextSize=function(t){return new j(t)}}};__ngs._61={_c:null,_d:function(){var c={exports:{}};var e=c.exports;this._c=c;var d=__ngs.r_(__ngs._9o);var n=__ngs.r_(__ngs._5);var a=__ngs.r_(__ngs._o);var l=__ngs.r_(__ngs._s).Network;var b=__ngs.r_(__ngs._28);var j=__ngs.r_(__ngs._n).LocalizedString;var f=__ngs.r_(__ngs._n).Localization;var m=function(r,p){var q=function(t){var s=""+t.substr(0,1).toUpperCase()+t.substr(1,t.length-1);r.prototype["set"+s]=function(u){this[t]=u};r.prototype["get"+s]=function(){return this[t]}};for(var o=0;o<p.length;o++){q(p[o])}};var g=function(q,p,o){g._initialize();this.apiDomain=b.PlusRequest.apiDomain;this.secure=(g.getServerMode()==g.serverModes.production);this.apiMethod=q;this.httpMethod=p||"GET";this.httpHeaders={};this.queryParams={};this.authenticationParameters={};this.authenticationType=o||g.authenticationTypes.OAuth1};g.classname="DonkeyRequest";g._initialize=function(){var o=NgApplication.getInstance();if(n.Core.Capabilities.getSocialServer()){g.apiDomain=n.Core.Capabilities.getSocialServer();NgLogD("DonkeyRequest: Social server! "+g.apiDomain)}else{g.setServerMode(g.serverModes.partner)}NgLogD("DonkeyRequest: social server set to: "+g.apiDomain);g._initialize=function(){}};m(g,["apiMethod","entityTag","secure","httpHeaders","httpMethod","postBody","apiDomain","queryParams","authenticationType","authenticationParameters"]);g.apiVersion="1";g.__defineSetter__("apiDomain",function(o){if(o||!g._apiDomain){g._apiDomain=o}});g.__defineGetter__("apiDomain",function(){var o=g._apiDomain;if(!o){o="app-sandbox.mobage.com"}return o});g.apiDomain=null;g.serverModes={staging:"staging",integration:"integration",partner:"sandbox",sandbox:"sandbox",production:"production",unknown:"unknown"};g.authenticationTypes={OAuth1:"OAuth1",OAuth2:"OAuth2",None:"None"};g.getServerMode=function(){g._initialize();var p=g.apiDomain;var o=g.serverModes;var q=o.unknown;if(p=="staging.plusplus.com"||p=="app-staging.mobage.com"||p=="app.staging.mobage.com"){q=o.staging}else{if(p=="partner.plusplus.com"||p=="app-sandbox.mobage.com"){q=o.partner}else{if(p=="integration.plusplus.com"||p=="app-integration.mobage.com"||p=="app.integration.mobage.com"){q=o.integration}else{if(p=="app.plusplus.com"||p=="app.mobage.com"){q=o.production}}}}NgLogD("DonkeyRequest: Getting server mode: "+q);return q};g.setServerMode=function(p){var o=g.serverModes;if(p==o.staging){g.apiDomain="app.staging.mobage.com"}else{if(p==o.partner){g.apiDomain="app-sandbox.mobage.com"}else{if(p==o.integration){g.apiDomain="app.integration.mobage.com"}else{if(p==o.production){g.apiDomain="app.mobage.com"}}}}};g.serverModeIsProduction=function(){return(g.getServerMode()===g.serverModes.production)};g.prototype.send=function(o){var p=this._prepareRequest();var q;p.onreadystatechange=function(){if(p.readyState==4){q=p.getUnflattenedResponseHeaders();var s=p.responseText;var r=p.error;var u=p.getResponseHeader("Content-Type")||"text";if(u.indexOf("application/json")!=-1){try{s=JSON.parse(s)}catch(t){NgLogE("EXCEPTION - Could not parse JSON data: "+t+" - "+s);r=t}if(s&&s.error_msg){r=s.error_msg}}p.statusClass=p.status-(p.status%100);if(p.statusClass!==200&&p.status!==304){r=j("Please check your network connection settings.")}o(r,s,q,p.status)}};p.send(this._postData)};g.appKey=function(){return a.Session.getCurrentSession().appKey()};g.appVersion=function(){return a.Session.getCurrentSession().appVersion()};g.getPlatformVersion=function(){return"1.0"};g.getOAuthInfo=function(){return a.Session.getCurrentSession().OAuthConsumerInfo()};g.prototype.getRequestURL=function(){var o=g.appKey();var q=[(this.apiDomain||g.apiDomain),g.apiVersion,o,this.apiMethod];var p=""+(this.secure?"https":"http")+"://"+q.join("/");return p};g.prototype._encodeArrayOrObject=function(q){var o=[];if(q instanceof Array){var r=null;for(var p=0;p<q.length;p++){r=q[p];o.push(encodeURIComponent(r[0])+"="+encodeURIComponent(r[1]))}}else{for(k in q){o.push(encodeURIComponent(k)+"="+encodeURIComponent(q[k]))}}return o.join("&")};g.prototype._appendUrlParameters=function(o){if(!this.queryParams||(this.queryParams.length===0)||(Object.getOwnPropertyNames(this.queryParams).length===0)){return o}if(o.indexOf("?",0)>=0){o+="&"}else{o+="?"}return o+this._encodeArrayOrObject(this.queryParams)};g.prototype._createPostBody=function(){if(!this.postBody||typeof this.postBody==="string"){return this.postBody}return this._encodeArrayOrObject(this.postBody)};g.prototype._prepareRequest=function(){this.request=new l.XHR();var w;var o=this.getHttpMethod();var y=this.getRequestURL();this._fullUrl=this._appendUrlParameters(y);NgLogD("DonkeyRequest: "+o+" "+this._fullUrl);if(o!=="GET"){this._postData=this._createPostBody()}var v=this.httpHeaders["Content-Type"];if(!v&&(o==="POST")){v="application/x-www-form-urlencoded";this.httpHeaders["Content-Type"]=v}if(this.authenticationType===g.authenticationTypes.OAuth1){var r=null;var s=g.getOAuthInfo();for(r in s){this.authenticationParameters[r]=s[r]}}this.request.open(o,this._fullUrl,true);var t=null;if(this.authenticationType==g.authenticationTypes.OAuth1){t=d.DonkeyOauth1.authenticate(this)}else{if(this.authenticationType==g.authenticationTypes.OAuth2){t="bearer: "+a.Session.getCurrentSession().OAuth2Token()}}if(t){this.request.setRequestHeader("Authorization",t)}var x=""+g.appKey()+"/"+g.appVersion()+" PlusPlus/"+g.getPlatformVersion();this.request.setRequestHeader("User-Agent",x);this.request.setRequestHeader("Accept","application/json");var q=n.Core.Capabilities;var u=false;if((typeof q.getPlatformOS()=="undefined")||(!q.isPlatformAndroid()&&!q.isPlatformFlash())){u=true}this.request.setRequestHeader("Accept-Encoding",(u?"gzip":""));this.request.setRequestHeader("Accept-Language",f.getAcceptLanguage());if(this.httpHeaders){for(w in this.httpHeaders){if(this.httpHeaders.hasOwnProperty(w)){this.request.setRequestHeader(w,this.httpHeaders[w])}}}this.request.setRequestHeader("X-Stat-Session",n.Core.Analytics._getPipe().getMeta("sid"));if(this.entityTag){this.request.setRequestHeader("If-None-Match",this.entityTag)}return this.request};for(var k in g.prototype){if(g.prototype.hasOwnProperty(k)){var h=g.prototype[k];h.displayName="DonkeyRequest."+k+"()"}}g.noOp=function(){};e.DonkeyRequest=g}};__ngs._62={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=__ngs.r_(__ngs._4y).Router;var a=__ngs.r_(__ngs._54);a.setRouterInstance(new b())}};__ngs._63={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var a=__ngs.r_(__ngs._2f).Dispatcher;var f=__ngs.r_(__ngs._28);var g=__ngs.r_(__ngs._7d).OrderedList;var c=__ngs.r_(__ngs._3l).Score;var e=b.ScoresList=g.subclass({$MAX_SIZE:100,initialize:function($super,h,k,l){var j=e.MAX_SIZE;$super(j);this._isFriends=(l?true:false);this._leaderboard=h;this._user=k;this._data=[];this.apiMethod="games/"+h.game.recordID+"/leaderboards/"+h.level},_hasData:function(h){return this._data.hasOwnProperty(h)&&this._data[h]},_getData:function(h){return this._data[h]},_constructRequest:function(k){var h=new f.PlusRequest();h.setApiMethod(this.apiMethod);h.setHttpMethod("GET");var j={count:this._requestPageSize,offset:k*this._requestPageSize};if(this._isFriends){j.relation="friends"}NgLogD("Generating Leaderboard scores list with both "+JSON.stringify(j));h.setPostBody(j);return h},_handleRequestData:function(l){a.beginBatching();this._data=[];var k=l.leaderboard||[];this._knownEndOfSet=k.length;for(var h=0;h<k.length;h++){var j=k[h];var m=c.getScoreWithDataAndLeaderboard(j,this._leaderboard);this._data.push(m)}a.endBatching()}})}};__ngs._64={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=new (__ngs.r_(__ngs._f).RequireLoader)({UI:function(){return __ngs.r_(__ngs._59).UI},Core:function(){return __ngs.r_(__ngs._5).Core},Device:function(){return __ngs.r_(__ngs._4).Device},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},Destinations:function(){return __ngs.r_(__ngs._2a).Destinations},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},ViewController:function(){return __ngs.r_(__ngs._7g).ViewController},Assets:function(){return __ngs.r_(__ngs._2z).Assets},GamercardStyle:function(){return __ngs.r_(__ngs._65).Gamercard},FooterStyle:function(){return __ngs.r_(__ngs._65).Footer},ContentBackgroundStyle:function(){return __ngs.r_(__ngs._65).ContentBackground},FullGamercardView:function(){return __ngs.r_(__ngs._9p).FullGamercardView},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics}});var a=c.FullGamercardController=b.ViewController.subclass({classname:"FullGamercardController",analyticsName:"FullGamercardScreen",initialize:function($super,e,f){$super();this._user=f;this._styleExtras=b.GamercardStyle.extras;this._onClose=null;this._gameCoverView=null;this._footerView=null;this._mobageButton=null;this._contentBackground=null;this._layoutListener=null;this._orientationListener=null;this._keyListener=null;if(!e){e=this.view()}this.setOnClose(function(){this._animateOut(function(){this.destroy()}.bind(this))}.bind(this));this.initSubviews();this.initListeners();this.setView(e.retain())},destroy:function(){this.view().release();if(this._gameCoverView){this._gameCoverView.destroy();this._gameCoverView=null}if(this._footerView){this._footerView.destroy();this._footerView=null}if(this._mobageButton){this._mobageButton.destroy();this._mobageButton=null}if(this._contentBackground){this._contentBackground.destroy();this._contentBackground=null}if(this._layoutListener){b.Device.LayoutEmitter.removeListener(this._layoutListener);this._layoutListener.destroy();this._layoutListener=null}if(this._orientationListener){b.Device.OrientationEmitter.removeListener(this._orientationListener);this._orientationListener.destroy();this._orientationListener=null}if(this._keyListener){this._keyListener.destroy();this._keyListener=null}},initListeners:function(){this._layoutListener=new b.Core.MessageListener();b.Device.LayoutEmitter.addListener(this._layoutListener,function(e){this.layoutViews(e.width,e.height,false)}.bind(this));this._orientationListener=new b.Core.MessageListener();b.Device.OrientationEmitter.addListener(this._orientationListener,function(e){if(e.type==b.Device.OrientationEmitter.OrientationType.Device){b.Device.OrientationEmitter.setInterfaceOrientation(e.orientation)}});this._keyListener=new b.Core.MessageListener();this._keyListener.classname="FullGamercardControllerKeyListener"},_addKeyListener:function(){b.UnspammableButton.addDeviceKeyListener(this._keyListener,function(e){if(e.code===b.Device.KeyEmitter.Keycode.back){b.MobageAnalytics.reportEvent("GamercardBackKeyPressed");this.close();return true}return false}.bind(this),99999)},_removeKeyListener:function(){b.Device.KeyEmitter.removeListener(this._keyListener)},initSubviews:function(){this._gameCoverView=new b.UnspammableButton();this._gameCoverView.onclick=function(e){b.MobageAnalytics.reportEvent("GamercardClickCoverView");this.close()}.bind(this);this._footerView=new b.UI.View();this._mobageButton=new b.UnspammableButton();this._mobageButton.setImage(b.Assets.image("mobagelogotm_down.png"),b.UI.State.Pressed);this._mobageButton.setImage(b.Assets.image("mobagelogotm.png"));this._mobageButton.onclick=function(){b.MobageAnalytics.reportEvent("GamercardFooterClickMobageLogo");b.Destinations.pushScreen(b.ServiceHost.navController,"Home",{},this)}.bind(this);this._footerView.addChild(this._mobageButton);this._contentBackground=new b.UI.View();b.FooterStyle.applyTo(this._footerView);b.ContentBackgroundStyle.applyTo(this._contentBackground)},_animateIn:function(e){e=e||function(){};this.layoutViews(b.UI.Window.getWidth(),b.UI.Window.getHeight(),true);b.UI.animate(function(){this.layoutViews(b.UI.Window.getWidth(),b.UI.Window.getHeight(),false)}.bind(this),this._styleExtras.animateInDuration,e)},_animateOut:function(e){e=e||function(){};this.layoutViews(b.UI.Window.getWidth(),b.UI.Window.getHeight(),false);b.UI.animate(function(){this.layoutViews(b.UI.Window.getWidth(),b.UI.Window.getHeight(),true)}.bind(this),this._styleExtras.animateOutDuration,e)},show:function(){b.MobageAnalytics.reportEvent("GamercardShow");b.UI.Window.document.addChild(this._gameCoverView);b.UI.Window.document.addChild(this._footerView);b.UI.Window.document.addChild(this._contentBackground);b.UI.Window.document.addChild(this.view());this._animateIn(function(){this._addKeyListener()}.bind(this))},hide:function(){this._removeKeyListener();this._animateOut(function(){this._gameCoverView.removeFromParent();this._footerView.removeFromParent();this._contentBackground.removeFromParent();this.view().removeFromParent()}.bind(this))},layoutViews:function(e,n,g){var r=Math.min(e,n);var j=e>n?true:false;var p=new b.UI.ViewGeometry.Rect(0,0,e,n);if(g){if(j){p.x+=r*1.2}else{p.y+=n}}var o;var h;if(j){h={gradient:["0000 "+this._styleExtras.landscapeGradientStart,"F000 1.0"],gradientAngle:180};o=p.sliceHorizontal(e-r)}else{var l=r*0.2;var m=(this._styleExtras.portraitGradientStart*l+n)/(l+n);h={gradient:["8000 "+m,"F000 1.0"],gradientAngle:90};o=p.sliceVertical(l);o.y=p.y-l-n;o.h+=n}this._gameCoverView.setGradient(h);this._gameCoverView.setFrame(o);var k=p.sliceVertical(-(r*0.083333));k.h=Math.ceil(k.h);this._contentBackground.setFrame(p);this.view().setFrame(p);this._footerView.setFrame(k);var q=b.FooterStyle.extras.mobageButtonWidthRatio*k.w;this._mobageButton.setFrame([k.w-q,0,q,k.h])},setOnClose:function(e){this._onClose=e},close:function(){b.MobageAnalytics.reportEvent("GamercardClose");if(this._onClose&&typeof this._onClose=="function"){this._onClose()}},set:function(f,g){if(f.hasOwnProperty("user")){this._user=f.user}var e=this.view();if(typeof e.set=="function"){e.set(f,g)}},reset:function(){this.view().setScrollPosition([0,0]);this.view()._wallSection.reset()},getUser:function(){return this._user},loadView:function($super){if(!this._view){this.setView((new b.FullGamercardView(this._user)).retain())}$super()}})}};__ngs._65={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var e=__ngs.r_(__ngs._6k).MobageStyle;var c=__ngs.r_(__ngs._2z).Assets;var a=e.ScaledCorners;var g=e.ScaledTextSize;e.lazyLoad(b,"Gamercard",function(){return{style:{},extras:{landscapeGradientStart:0.8,portraitGradientStart:0.8,animateInDuration:400,animateOutDuration:400}}});e.lazyLoad(b,"UserInfoCell",function(){return{style:{gradient:{gradient:["FF00204D 0.000","FF00204D 1.000"]}},children:{_gamertag:{style:{textGravity:[0,0.5],textSize:g(18),textFont:e.defaultBoldFontFace,textInsets:[8,10,8,0],textColor:"FFFFFFFF"}},_motto:{style:{textGravity:[0,0.5],textSize:g(12),textFont:e.defaultRegularFontFace,textInsets:[0,10,8,0],textColor:"FFFFFFFF"}},_avatar:{style:{image:c.image("no-user-icon.png")}},_clickyOverlay:{style:{pressedGradient:{gradient:["880B519F 0.0"]}}}},extras:{avatarImageSizeFactor:0.225,avatarImageSpacerInsetRatio:0.025}}});e.lazyLoad(b,"MobageHeaderCell",function(){return{style:{gradient:{gradient:["FF0A365E 0.000","FF03203E 1.000"]}},extras:{logoRatio:330/100,logoW:0.45,insets:[2,10,2,10]}}});e.lazyLoad(b,"GameModuleCell",function(){return{style:{gradient:{gradient:["FF00204D 0.000","FF00204D 1.000"]}},children:{_image:{style:{imageBorder:{corners:a(12)}}}},extras:{panelInsets:[8,8,8,8],normalIconSizeFactor:0.2,smallIconSizeFactor:0.15,iconMarginFactor:0.025,buttonSpacing:5,dynamicImageRatio:0.3}}});e.lazyLoad(b,"GameModuleBasicPanel",function(){return{style:{gradient:{gradient:["FF938733 0.000","FF967C16 1.000"],corners:a(12)}}}});e.lazyLoad(b,"GameModuleDynamicImagePanel",function(){return{style:{gradient:{gradient:["22000000 0.000","44000000 1.000"],corners:a(12)}}}});e.lazyLoad(b,"GameModuleHeader",function(){return{style:{textGravity:[0,0.5],textSize:g(18),textFont:e.defaultBoldFontFace,textInsets:[8,10,8,0],textColor:"FFFFFFFF"}}});e.lazyLoad(b,"GameModuleContent",function(){return{style:{textGravity:[0,0.5],textSize:g(14),textFont:e.defaultRegularFontFace,textInsets:[0,10,8,0],textColor:"FFFFFFFF"}}});e.lazyLoad(b,"GameModuleIcon",function(){return{style:{image:c.image("no-game-icon.png")}}});e.lazyLoad(b,"GameModuleButton",function(){return{style:{gradient:{corners:a(12),gradient:["FF75B624 0.000","FF51911F 1.000"],innerLine:"55CCCCCC 2.0"},pressedGradient:{corners:a(12),gradient:["FF5C8E1C 0.000","FF3F7118 1.000"],innerLine:"44666666 2.0"},textFont:e.defaultBoldFontFace,textInsets:[8,8,8,8],textSize:g(14),textColor:"FFFFFFFF",textGravity:[0.5,0.5],textShadow:"33000000 1.0 {0.0,-2.0}"}}});e.lazyLoad(b,"WallCell",function(){return{style:{gradient:{gradient:["FFFFFFFF 0.0","FFFFFFFF 1.0"],outerLine:"FFE4EBF0 1.0"}},children:{_gamertag:{style:{textGravity:[0,0.5],textSize:g(18),textFont:e.defaultBoldFontFace,textInsets:[8,10,0,0],textColor:"FF00319A"}},_subtitle:{style:{textGravity:[0,0.5],textSize:g(14),textFont:e.defaultBoldFontFace,textInsets:[2,8,0,8],textColor:"FF666666"}},_message:{style:{textGravity:[0,0.5],textSize:g(14),textFont:e.defaultRegularFontFace,textInsets:[4,10,8,0],textColor:"FF000000"}},_avatar:{style:{image:c.image("no-user-icon.png")}},_avatarOverlay:{style:{pressedGradient:{gradient:["550B519F 0.0"]}}},_commandButton:{style:{image:c.image("ListModal_OpenModal_Up.png"),pressedImage:c.image("ListModal_OpenModal_Down.png")}},_clickyOverlay:{style:{pressedGradient:{gradient:["880B519F 0.0"]}}}},extras:{avatarImageSizeFactor:0.15,avatarImageSpacerInsetRatio:0.025,commandButtonSizeFactor:0.12,commandButtonSpacerInsetRatio:0.0225,placeholderOpacity:0.4,normalOpacity:1,headerHeightFactor:0.155,footerHeightFactor:0.09}}});e.lazyLoad(b,"Footer",function(){return{style:{gradient:{gradient:["FF032644 0.0"]}},children:{_mobageButton:{style:{gradient:{gradient:["FFFFFFFF 0.0"]},imageGravity:[0.5,0.5],imageInsets:[0,10,0,0]}}},extras:{mobageButtonWidthRatio:0.27}}});e.lazyLoad(b,"ContentBackground",function(){return{style:{gradient:{gradient:["FF032644 0.0"]}}}});var f={};f.Style=__ngs.r_(__ngs._60).Style;var h=f.Style.ScaledTextSize;f.Style.sheet("social.us.gamercard.wallpostsection",{wallHeaderLabel:{textFont:f.Style.defaultBoldFontFace,textSize:h(13),textColor:"FFFFFFFF",textGravity:[0,0]},userInfoGradient:{gradient:{insets:"{0.0,0.0,0.0,0.0}",gradient:["E50E2454 0.000","E50E2454 1.000"],outerLine:"E51C4B7C 1.0"}},wallGradient:{gradient:{insets:"{0.0,0.0,0.0,0.0}",gradient:["E50E2454 0.000","E5000000 1.000"],outerLine:"E51C4B7C 1.0"}},gameInfoGradient:{gradient:{insets:"{0.0,0.0,0.0,0.0}",gradient:["E50E2454 0.000","E5000000 1.000"],outerLine:"E51C4B7C 1.0"}},gameButton:{normalGradient:{corners:"8.0 8.0 8.0 8.0",gradient:["FF75B624 0.000","FF4D8D1F 1.000"]},highlightedGradient:{corners:"8.0 8.0 8.0 8.0",gradient:["FF5B971B 0.000","FF397210 1.000"]},textColor:"FFFFFFFF",textSize:h(14),textFont:f.Style.defaultBoldFontFace,textShadow:"33000000 1.0 {0.0,-2.0}"},topBarBackgroundPane:{backgroundColor:"EE0C152D"},wallHeaderTopMargin:2,postAreaHFactor:(85/480),postHeaderLabelYFactor:(0/85),postHeaderLabelHFactor:(30/85),postTextYFactor:(30/85),postTextHFactor:(50/85),postTextWFactor:(435/582),postHeaderLabelXFactor:(7/582),postHeaderLabelWFactor:(373/582),postHeaderLabelHFactor:(28/56),buttonPostXFactor:(455/582),buttonPostWFactor:(120/582),buttonPostHFactor:(47/85)})}};__ngs._66={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var d=__ngs.r_(__ngs._5).Core;var c=__ngs.r_(__ngs._4);a.BankLegacy=d.Class.singleton({classname:"BankLegacy",initialize:function(){},asyncFulfill:function(f,e){c.Device.InAppPurchase.initService(f,e)},launchPurchaseView:function(f,e){c.Device.InAppPurchase.launchPurchaseView(f,function(k,l,j,h,g){g(true);e(undefined,k,l,j,h)},function(h,g){e("failed:"+g)},function(){e("cancelled")})}})}};__ngs._67={_c:null,_d:function(){var e={exports:{}};var h=e.exports;this._c=e;var k=__ngs.r_(__ngs._5).Core;var c=__ngs.r_(__ngs._4).Device;var f=__ngs.r_(__ngs._59).UI;var a=new (__ngs.r_(__ngs._f).RequireLoader)({ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},Session:function(){return __ngs.r_(__ngs._o).Session},Game:function(){return __ngs.r_(__ngs._2e).Game},FriendPickerCell:function(){return __ngs.r_(__ngs._9q).FriendPickerCell},PendingListSection:function(){return __ngs.r_(__ngs._9r).PendingListSection},MBListViewSection:function(){return __ngs.r_(__ngs._79).MBListViewSection},IdleActor:function(){return __ngs.r_(__ngs._9s).IdleActor},Assets:function(){return __ngs.r_(__ngs._2z).Assets},OldStyle:function(){return __ngs.r_(__ngs._60).Style},FriendPickerStyle:function(){return __ngs.r_(__ngs._9t)},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements}});var n=a.OldStyle.ScaledTextSize;var l=__ngs.r_(__ngs._5l).UnspammableButton;var q=__ngs.r_(__ngs._68).getSpamProtectionLockForName;var o=__ngs.r_(__ngs._n).LocalizedString;var p={};var j=k.MessageListener.subclass({classname:"FriendPickerKeyListener"});var d=__ngs.r_(__ngs._2a).Destinations;var b=__ngs.r_(__ngs._7g).ViewController;var g=h.FriendpickerViewController=b.subclass({classname:"FriendpickerViewController",analyticsName:"FriendPicker",_retrievingCurrentGame:true,_retrievingServiceFriends:false,_retrievingGameFriends:false,_mobageUserListItems:null,_gameFriendListItems:null,_currentTab:null,_activeListItems:null,GameFriendsTab:1,AllServiceFriendsTab:2,_idleActor:null,_idleAction:null,initialize:function($super,v,s,u){$super();this._mobageUserListItems=[];this._gameFriendListItems=[];var y=this;this._friendPickerCallback=s;this._inviteCallback=u;this._maxPick=0;if(v){this._maxPick=v}this._idleActor=(new a.IdleActor()).retain();this._selectedFriends=0;this._currentGame=null;this._setCurrentGame();this._oldScrollPosition_gameFriends=[0,0];this._oldScrollPosition_allServiceFriends=[0,0];a.FriendPickerStyle;this._friendPickerStyle=a.OldStyle.registeredStyle("social.us.friendpicker");var w=a.OldStyle.registeredStyle("social.us.commonelements");var x=q("friendpicker");x.timeout=400;this._gameCoverView=new l().retain();this._gameCoverView.setSpamLockName("friendpicker");this._gameCoverView.onclick=function(z){if(y._friendPickerCallback){y._friendPickerCallback("friendpicker closed",[])}y.destroy()};f.Window.document.addChild(this._gameCoverView);this._topBarBgPane=new f.View().retain();this._topBarBgPane.setAttributes(this._friendPickerStyle.props()["topBarBackgroundPane"]);f.Window.document.addChild(this._topBarBgPane);this._topBarBorderPane=new f.View().retain();this._topBarBorderPane.setAttributes(this._friendPickerStyle.props()["borderUnderTopPane"]);f.Window.document.addChild(this._topBarBorderPane);this._mobageButton=new l().retain();this._mobageButton.setSpamLockName("friendpicker");this._mobageButton.setImage(a.Assets.image("mobagelogotm_down.png"),f.State.Pressed);this._mobageButton.setImage(a.Assets.image("mobagelogotm.png"));this._mobageButton.onclick=function(){NgLogD("Pressed mobage button");if(y._friendPickerCallback){y._friendPickerCallback("friendpicker closed",[])}y.destroy();d.pushScreen(a.ServiceHost.navController,"Home",{},y)};this._topBarBgPane.addChild(this._mobageButton);this._findFriendButton=new l().retain();this._findFriendButton.setSpamLockName("friendpicker");this._findFriendButton.setText(o("Find Friends"));a.CommonElements.standardButton.applyTo(this._findFriendButton);this._findFriendButton.onclick=function(){NgLogD("Pressed find friend button");if(y._friendPickerCallback){y._friendPickerCallback(null,[])}y.destroy();d.pushScreen(a.ServiceHost.navController,"FindFriends",{},y)};this._topBarBgPane.addChild(this._findFriendButton);this._tabAndListBgPane=new f.View().retain();this._tabAndListBgPane.setAttributes(this._friendPickerStyle.props()["listAreaPane"]);f.Window.document.addChild(this._tabAndListBgPane);var t=w.props()["topPageNavigationTab"];this._buttonAllFriends=new l().retain();this._buttonAllFriends.setSpamLockName("friendpicker");this._buttonAllFriends.setText(o("Mobage Friends"));this._buttonAllFriends.setAttributes(t);this._buttonAllFriends.setGradient(t.pressedGradient,f.State.Pressed);this._buttonAllFriends.setGradient(t.gradientSelected,f.State.Selected);this._buttonAllFriends.setTextFont(t.textFontSelected,f.State.Selected);this._buttonAllFriends.setTextShadow(t.textShadowSelected,f.State.Selected);this._buttonAllFriends.onclick=this._selectAllServiceFriends.bind(this);f.Window.document.addChild(this._buttonAllFriends);this._buttonCurrentGameFriends=new l().retain();this._buttonCurrentGameFriends.setSpamLockName("friendpicker");this._buttonCurrentGameFriends.setText("");this._buttonCurrentGameFriends.setAttributes(t);this._buttonCurrentGameFriends.setGradient(t.pressedGradient,f.State.Pressed);this._buttonCurrentGameFriends.setGradient(t.gradientSelected,f.State.Selected);this._buttonCurrentGameFriends.setTextFont(t.textFontSelected,f.State.Selected);this._buttonCurrentGameFriends.setTextShadow(t.textShadowSelected,f.State.Selected);this._buttonCurrentGameFriends.onclick=this._selectGameFriends.bind(this);f.Window.document.addChild(this._buttonCurrentGameFriends);this._allFriendsShowing=true;this._buttonAllFriends.setState(f.State.Pressed);this._buttonCurrentGameFriends.setState(f.State.Normal);this._listViewBgOuterPane=new f.View().retain();this._listViewBgOuterPane.setAttributes(this._friendPickerStyle.props().verticalContentContainer);f.Window.document.addChild(this._listViewBgOuterPane);this._listViewBgInnerPane=new f.View().retain();this._listViewBgInnerPane.setAttributes(this._friendPickerStyle.props().verticalContentContainer.innerContainer);f.Window.document.addChild(this._listViewBgInnerPane);this._listView=new f.ListView().retain();this._listViewBgInnerPane.addChild(this._listView);this._listViewSection=(new a.MBListViewSection()).retain();this._listViewSection.setRowHeightRatio(1/3.8);this._zeroCaseView=new f.View().retain();this._zeroCaseTextHeader=new f.Label().retain();this._zeroCaseTextHeader.setAttributes(this._friendPickerStyle.props().verticalContentFailureCaseTextHeader);this._zeroCaseView.addChild(this._zeroCaseTextHeader);this._zeroCaseTextBody=new f.Label().retain();this._zeroCaseTextBody.setAttributes(this._friendPickerStyle.props().verticalContentFailureCaseTextBody);this._zeroCaseTextBody.setText(o("Check out these suggested friends who play this game!"));this._zeroCaseView.addChild(this._zeroCaseTextBody);this._zeroCaseLinkBtn=new l().retain();this._zeroCaseLinkBtn.setSpamLockName("friendpicker");this._zeroCaseLinkBtn.setText(o("Suggested Friends"));this._zeroCaseLinkBtn.setAttributes(w.props()["largeActionButton"]);this._zeroCaseLinkBtn.setGradient(w.props()["largeActionButton"].pressedGradient,f.State.Pressed);this._zeroCaseLinkBtn.onclick=function(){if(y._friendPickerCallback){y._friendPickerCallback(null,y._getPickedUsers())}y.destroy();d.pushScreen(a.ServiceHost.navController,"FindFriends",{},y)};this._zeroCaseView.addChild(this._zeroCaseLinkBtn);this._bottomBar=new f.View().retain();this._bottomBar.setAttributes(this._friendPickerStyle.props()["bottomBar"]);this._confirmButton=new l().retain();this._confirmButton.setText(o("Confirm"));this._confirmButton.setTextSize(n(12).realize());this._confirmButton.setAttributes(this._friendPickerStyle.props()["confirmButton"]);this._confirmButton.setGradient(w.props()["disabledButton"].gradient,f.State.Disabled);this._confirmButton.setTextColor(w.props()["disabledButton"].textColor,f.State.Disabled);this._confirmButton.setTextShadow(w.props()["disabledButton"].textShadow,f.State.Disabled);this._confirmButton.onclick=function(){if(y._friendPickerCallback){y._friendPickerCallback(null,y._getPickedUsers())}y.destroy()};this._bottomBar.addChild(this._confirmButton);this._bottombarText=new f.Label().retain();this._bottombarText.setTextSize(n(12).realize());this._bottombarText.setTextGravity(f.ViewGeometry.Gravity.Center);this._bottombarText.setAttributes(this._friendPickerStyle.props()["bottomBarText"]);this._bottomBar.addChild(this._bottombarText);this.layoutViews(f.Window.getWidth(),f.Window.getHeight());var r=k.MessageListener.subclass({_onLayoutEvent:function(z){y.layoutViews(z.width,z.height)},destroy:function(){c.LayoutEmitter.removeListener(this)}});this.layoutListenerInstance=new r();c.LayoutEmitter.addListener(this.layoutListenerInstance,this.layoutListenerInstance._onLayoutEvent);this._loadingItemsSection=(new a.PendingListSection()).retain();this._loadingItemsSection.setPendingText(o("Loading..."));this._selectAllServiceFriends();this.kListener=new j();l.addDeviceKeyListener(this.kListener,this.onKeyPressed.bind(this),99999);return this},loadView:function($super){$super()},layoutViews:function(s,y){var r=k.Capabilities.getScreenWidth();var t=k.Capabilities.getScreenHeight();var x=s>=y;var F=new f.ViewGeometry.Rect(0,0,s,y);var D=r/480;var w=t/800;var A;if(x){A=F.sliceHorizontal(320*w);this._gameCoverView.setGradient({gradient:["66000000 0.0","66000000 0.94","B3000000 1.0"],gradientAngle:180})}else{A=F.sliceVertical(320*w);this._gameCoverView.setGradient({gradient:["66000000 0.0","66000000 0.94","B3000000 1.0"]})}this._gameCoverView.setFrame(A);var v=F.sliceVertical(66*w);this._topBarBgPane.setFrame(v);var z=10*D;var B=176*D;this._findFriendButton.setFrame([v.w-z-B,z,B,46*w]);this._mobageButton.setFrame([20*D,z,165*D,46*w]);this._topBarBorderPane.setFrame(F.sliceVertical(2));this._tabAndListBgPane.setFrame(F);var E=F.sliceVertical(62*w);E.inset(6*D,10*w,0,10*D);this._buttonAllFriends.setFrame(E.sliceHorizontal(E.w/2));this._buttonCurrentGameFriends.setFrame(E);var C=F.copy();C.x+=5*D;C.w-=10*D;this._listViewBgOuterPane.setFrame(C);C.inset(2,2,0,2);this._listViewBgInnerPane.setFrame([C.x,C.y,C.w,C.h+2]);C.x=0;C.y=0;C.inset(2,2,0,2);this._zeroCaseView.setFrame(C);var u=C.sliceVertical(-62*D);this._listView.setFrame(C);this._bottomBar.setFrame(u);u.x=u.y=0;u.inset(6*w,6*D,6*w,6*D);this._confirmButton.setFrame(u.sliceHorizontal(-166*w));this._bottombarText.setFrame(u);this._zeroCaseTextHeader.setFrame([0,55*D,C.w,75*w]);this._zeroCaseTextBody.setFrame([35*w,125*D,C.w-70*w,150*w]);this._zeroCaseLinkBtn.setFrame([(C.w-282*w)/2,210*D,282*w,54*D]);this._refreshUI()},onKeyPressed:function(r){if(r.code===c.KeyEmitter.Keycode.back){if(this._gameCoverView){if(this._friendPickerCallback){this._friendPickerCallback("friendpicker closed",[])}this.destroy();return true}}return false},destroy:function(){this._idleActor.release();this._gameCoverView.release();this._topBarBgPane.release();this._topBarBorderPane.release();this._mobageButton.release();this._findFriendButton.release();this._tabAndListBgPane.release();this._buttonAllFriends.release();this._buttonCurrentGameFriends.release();this._listViewBgOuterPane.release();this._listViewBgInnerPane.release();this._zeroCaseView.release();this._zeroCaseTextHeader.release();this._zeroCaseTextBody.release();this._zeroCaseLinkBtn.release();this._listView.release();this._listViewSection.release();this._bottomBar.release();this._confirmButton.release();this._bottombarText.release();this._loadingItemsSection.release();this.layoutListenerInstance.destroy();c.KeyEmitter.removeListener(this.kListener);this.kListener=undefined},_isInvited:function(r){for(var s=0;s<this._invitedUsers.length;s++){if(r.recordID===this._invitedUsers[s].recordID){return true}}return false},_updateUIElements:function(){this._buttonCurrentGameFriends.setText(o("%1s",this._currentGame?this._currentGame.name:""));this._selectedFriends=this._getTotalSelected();this._updateBottomBarText();if(this._waitingOnData()){this._confirmButton.setState(f.State.Disabled)}else{var r=this._maxPick!==0&&this._selectedFriends>=this._maxPick;if(this._reachedMaximumPicked!=r){this._enablePicking(!r);this._reachedMaximumPicked=r}this._confirmButton.setState((this._selectedFriends>0)?f.State.Normal:f.State.Disabled)}},_enablePicking:function(r){if(this._activeListItems){for(var s=0;s<this._activeListItems.length;s++){if(this._activeListItems[s].cell){this._activeListItems[s].cell.setFriendPickerSelectionEnabled(r)}}}},_updateBottomBarText:function(r){if(!this._bottombarText){return}if(this._maxPick>0){if(this._selectedFriends>0){this._bottombarText.setText(o("Choose up to %1d friends: %2d left",this._maxPick,(this._maxPick-this._selectedFriends)))}else{this._bottombarText.setText(o("Choose up to %1d friends",this._maxPick))}}else{this._bottombarText.setText(o("Choose Friends: %1d",this._selectedFriends))}},_getPickedUsers:function(){var s=[];if(this._activeListItems){for(var r=0;r<this._activeListItems.length;r++){if(this._activeListItems[r].data.isSelected){if(this._activeListItems[r].data.user){s.push(this._activeListItems[r].data.user)}}}}return s},_getTotalSelected:function(){var r=0;if(this._activeListItems){for(var s=0;s<this._activeListItems.length;s++){if(this._activeListItems[s].data.isSelected){r++}}}return r},onRowSelectClicked:function(r){r.listItem.data.isSelected=!r.listItem.data.isSelected;this._updateUIElements()},onRowInviteClicked:function(r){if(this._inviteCallback&&r.listItem.data.user){r.onInviteSent();r.listItem.data.isInvited=true;this._invitedUsers.push(r.listItem.data.user);this._inviteCallback(r.listItem.data.user)}},_setCurrentGame:function(){var r=this;a.Game.getCurrentGame(function(t,s){r._retrievingCurrentGame=false;r._currentGame=s;if(!p[r._currentGame.recordID]){p[r._currentGame.recordID]=[]}r._invitedUsers=p[r._currentGame.recordID];r._updateUIElements();r._getGameFriends();r._getServiceGameOwners();r._getServiceFriends()})},_getGameFriends:function(){NgLogD("FriendpickerViewController - Retrieving game friends for game "+this._currentGame);this._retrievingGameFriends=true;this._gameFriendListItems=[];var s=this;var t=a.Session.getCurrentSession();if(t){var r=t.user();if(r){r.getGameFriendsList("mutual").forAll(function(w,x,v){NgLogD("FriendpickerViewController - Got game friend: "+x.gamertag);var u=new m();u.data={user:x,hasGame:true,isSelected:false,isInvited:true,friendPickerController:s};s._gameFriendListItems.push(u);s._displayAvailableDataWhenIdle();w(true)},function(u){NgLogD("FriendpickerViewController - Done getting all game friends");s._onGameFriendsRetrieved()})}}},_userHasGame:function(r){if(r&&r.recordID){return !!((this._serviceGameOwnersIdToUser||{})[r.recordID])}return false},_getServiceGameOwners:function(){this._retrievingServiceGameOwners=true;if(!this._currentGame){a.Game.getCurrentGame(this.zombieSafeCallback(function(u,t){if(u){console.log("Error getting current game in friend picker, trying _getServiceGameOwners again")}this._currentGame=t;this._getServiceGameOwners()}));return}this._serviceGameOwnersIdToUser={};var s=a.Session.getCurrentSession();if(s){var r=s.user();if(r){r.getFriendsListForGame(this._currentGame).forAll(this.zombieSafeCallback(function(v,t){this._serviceGameOwnersIdToUser[t.recordID]=t;var u=(this._idToListItem||{})[t.recordID];if(u){u.data.hasGame=true;if(u.cell){u._onSetView(u.cell)}}this._displayAvailableDataWhenIdle();v(true)}),this.zombieSafeCallback(function(t){this._retrievingServiceGameOwners=false;NgLogD("FriendpickerViewController: Got Service Game Owners");this._serviceFriendsFinishRefresh()}))}}},_getServiceFriends:function(){NgLogD("FriendpickerViewController - Retrieving mobage friends");this._retrievingServiceFriends=true;this._mobageUserListItems=[];this._idToListItem={};var s=this;var t=a.Session.getCurrentSession();if(t){var r=t.user();if(r){r.getMutualFriendsList().forAll(this.zombieSafeCallback(function(x,w,v){NgLogD("FriendpickerViewController - Got service friend: "+w.gamertag);var u=new m();u.data={user:w,hasGame:this._userHasGame(w),isSelected:false,isInvited:s._isInvited(w),friendPickerController:s};this._mobageUserListItems.push(u);this._idToListItem[w.recordID]=u;this._displayAvailableDataWhenIdle();x(true)}),this.zombieSafeCallback(function(u){NgLogD("FriendpickerViewController - Done getting all mobage service friends");this._retrievingServiceFriends=false;this._serviceFriendsFinishRefresh()}))}}},_serviceFriendsFinishRefresh:function(){for(var r=0;r<this._mobageUserListItems.length;r++){var s=this._mobageUserListItems[r];if(s&&s.cell){s._onSetView(s.cell)}}this._refreshUI()},_onGameFriendsRetrieved:function(){this._retrievingGameFriends=false;if(this._currentTab===this.GameFriendsTab){this._refreshUI()}},_waitingOnData:function(){return this._retrievingCurrentGame||this._retrievingServiceFriends||this._retrievingServiceGameOwners||(this._currentTab===this.GameFriendsTab&&this._retrievingGameFriends)},_displayAvailableDataWhenIdle:function(){if(!this._idleAction){this._idleAction=this.bind(function(){this._displayAvailableData()})}this._idleActor.waitForIdleBeforeAction(this._idleAction)},_displayAvailableData:function(){this._activeListItems=null;if(!this._loadingItemsSection){return}var r;var t=[];var s=[];if(this._currentTab===this.GameFriendsTab){for(r=0;r<this._gameFriendListItems.length;r++){s.push(this._gameFriendListItems[r])}}for(r=0;r<this._mobageUserListItems.length;r++){if(this._currentTab===this.AllServiceFriendsTab||this._mobageUserListItems[r].data.hasGame){s.push(this._mobageUserListItems[r])}}for(r=0;r<s.length;r++){s[r].data.isEven=(r%2===0)}if(s.length>0){t.push(this._listViewSection);this._listViewSection.calculateRowHeightForListView(this._listView);this._activeListItems=s;this._listViewSection.setItems(this._activeListItems)}if(this._waitingOnData()){this._loadingItemsSection.setRowHeight(this._listView.getFrame()[3]/3.8);t.unshift(this._loadingItemsSection);this._zeroCaseView.removeFromParent();if(s.length===0){this._bottomBar.removeFromParent()}}if(this._activeListItems&&this._activeListItems.length){this._zeroCaseView.removeFromParent();this._listViewBgInnerPane.addChild(this._bottomBar);this._listViewBgInnerPane.addChild(this._listView);if(this._waitingOnData()&&!this._loadingFurtherUsers){this._loadingItemsSection.setPendingText(o("Loading more choices..."));this._loadingFurtherUsers=true}}this._listView.setSections(t)},_refreshUI:function(){this._displayAvailableData();if(this._waitingOnData()){this._zeroCaseView.removeFromParent();this._bottomBar.removeFromParent();this._listViewBgInnerPane.addChild(this._listView)}else{if(!this._activeListItems||!this._activeListItems.length){this._bottomBar.removeFromParent();this._listView.removeFromParent();this._listViewBgInnerPane.addChild(this._zeroCaseView)}}if(k.Capabilities.isPlatformAndroid()){this._listView.removeFromParent();this._listViewBgInnerPane.addChild(this._listView)}this._updateUIElements()},_selectAllServiceFriends:function(){if(this._currentTab!==this.AllServiceFriendsTab){this._oldScrollPosition_gameFriends=this._listView.getScrollPosition();this._listView.setScrollPosition(this._oldScrollPosition_allServiceFriends);this._currentTab=this.AllServiceFriendsTab;for(var r=0;r<this._gameFriendListItems.length;r++){this._gameFriendListItems[r].data.isSelected=false}this._buttonCurrentGameFriends.setState(f.State.Normal);this._buttonAllFriends.setState(f.State.Selected);this._allFriendsShowing=true;this._buttonCurrentGameFriends.setImage(null);if(this._zeroCaseTextHeader){this._zeroCaseTextHeader.setText(o("You don't have any Mobage friends yet."))}this._refreshUI()}},_selectGameFriends:function(){if(this._currentTab!==this.GameFriendsTab){this._oldScrollPosition_allServiceFriends=this._listView.getScrollPosition();this._listView.setScrollPosition(this._oldScrollPosition_gameFriends);this._currentTab=this.GameFriendsTab;this._buttonCurrentGameFriends.setState(f.State.Selected);this._buttonAllFriends.setState(f.State.Normal);this._allFriendsShowing=false;this._buttonAllFriends.setImage(null);if(this._zeroCaseTextHeader&&this._currentGame){this._zeroCaseTextHeader.setText(o("You don't have any %1s friends yet.",this._currentGame.name))}this._refreshUI()}}});var m=f.ListViewItem.subclass({initialize:function(){},_onCreateView:function(){return new a.FriendPickerCell(1,480,this.data.friendPickerController)},_onSetView:function(u){if(u){u.listItem=this;this.cell=u;var t=this.data.user?this.data.user.gamertag:"<no user>";var s=this.data.user?this.data.user.getDefinedIcon():a.Assets.image("no-user-icon.png");var r=this.data.hasGame?"Choose me":"Invite to "+this.data.friendPickerController._currentGame.name;u.setupListItem(this.data.isEven,this.data.hasGame,t,s,r,this.data.isSelected,this.data.isInvited,this.data.friendPickerController._reachedMaximumPicked)}},_onReleaseView:function(r){r.listItem=null;this.cell=null}})}};__ngs._68={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var a=new (__ngs.r_(__ngs._f).RequireLoader)({LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils}});var c=function(){this.timeout=300;this.lastInvocation=0;this.hardLock=false};c.prototype.acquire=function(){if(!this.peekAcquire()){return false}NgLogD("SpamProtectionLock acquired.");if(this.hardLock){NgLogD("... However, SpamProtectionLock encountered hard lock");return false}this.lastInvocation=new Date().getTime();return true};c.prototype.acquireHardLock=function(){this.hardLock=true};c.prototype.releaseHardLock=function(){this.hardLock=false};c.prototype.peekAcquire=function(){var h=Math.abs(new Date().getTime()-this.lastInvocation);NgLogD("SpamProtectionLock delta: "+h+" timeout: "+this.timeout);if(h<=this.timeout){return false}return true};var e={};var f=b.getSpamProtectionLockForName=function(k,j){var h;if(!(h=e[k])){h=new c();if(j){h.timeout=j}if(k){e[k]=h}}return h};var g=b.shouldShowGameRequestedUI=function(){var j=f("GameRequestedUI",1500);if(!j.acquire()){NgLogD("GameRequested UI is being spammed.");var h=f("SlowDown",2000);if(h.acquire()){NgLogD("Showing toast to warn the user.");a.UIUtils.showToast(a.LocText("Please wait while we catch up!"))}return false}return true}}};__ngs._69={_c:null,_d:function(){var f={exports:{}};var h=f.exports;this._c=f;var k=__ngs.r_(__ngs._5).Core;var d=__ngs.r_(__ngs._4).Device;var g=__ngs.r_(__ngs._59).UI;var a=new (__ngs.r_(__ngs._f).RequireLoader)({ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics},Session:function(){return __ngs.r_(__ngs._o).Session},Game:function(){return __ngs.r_(__ngs._2e).Game},User:function(){return __ngs.r_(__ngs._30).User},MobagePauseGame:function(){return __ngs.r_(__ngs._5i).MobagePauseGame},FriendPickerCell:function(){return __ngs.r_(__ngs._9q).FriendPickerCell},LeaderboardCategoryCell:function(){return __ngs.r_(__ngs._9v).LeaderboardCategoryCell},LeaderboardFooterView:function(){return __ngs.r_(__ngs._9w).LeaderboardFooterView},LeaderboardCell:function(){return __ngs.r_(__ngs._9x).LeaderboardCell},PendingListSection:function(){return __ngs.r_(__ngs._9r).PendingListSection},MBListViewSection:function(){return __ngs.r_(__ngs._79).MBListViewSection},Assets:function(){return __ngs.r_(__ngs._2z).Assets},OldStyle:function(){return __ngs.r_(__ngs._60).Style},LeaderboardViewStyle:function(){return __ngs.r_(__ngs._9y)},Leaderboard:function(){return __ngs.r_(__ngs._3j).Leaderboard},ListViewCellStyles:function(){return __ngs.r_(__ngs._9z).ListViewCells},CommonElements:function(){return __ngs.r_(__ngs._9u).CommonElements}});var l=__ngs.r_(__ngs._5l).UnspammableButton;var n=__ngs.r_(__ngs._n).LocalizedString;var m=k.MessageListener.subclass({classname:"LeaderboardViewKeyListener"});var e=__ngs.r_(__ngs._2a).Destinations;var c=__ngs.r_(__ngs._7g).ViewController;var b=h.LeaderboardViewController=c.subclass({classname:"LeaderboardViewController",analyticsName:"LeaderboardView",_categoryListItems:null,_currentLevel:null,_leaderboardsOpen:false,_drawerAnimating:false,orientedScreenWidth:null,orientedScreenHeight:null,initialize:function($super){$super();NgLogD("INIT LeaderboardsViewController");a.MobagePauseGame.pauseGame(this);a.MobageAnalytics.reportEvent("LeaderboardView");this._categoryListItems=[];var p=this;this.cntrlRef=this;a.LeaderboardViewStyle;this._leaderboardViewStyleStyle=a.OldStyle.registeredStyle("social.us.leaderboardview");var r=a.OldStyle.registeredStyle("social.us.commonelements");this._gameCoverView=new l().retain();this._header=new g.View().retain();this._header.setAttributes(this._leaderboardViewStyleStyle.props()["header"]);this._headerLabel=new g.Label().retain();this._headerLabel.setAttributes(this._leaderboardViewStyleStyle.props()["headerLabel"]);this._header.addChild(this._headerLabel);this._globalFilterButton=new l().retain();this._globalFilterButton.setText(n("Global"));this._globalFilterButton.setAttributes(this._leaderboardViewStyleStyle.props().globalFilterButton);this._friendFilterButton=new l().retain();this._friendFilterButton.setText(n("Friends"));this._friendFilterButton.setAttributes(this._leaderboardViewStyleStyle.props().friendFilterButton);this._globalFilterButton.setState(g.State.Pressed);this._globalFilterButton.setVisible(false);this._friendFilterButton.setVisible(false);this._categoryListView=new g.ListView().retain();this._categoryListViewContainer=new g.View().retain();this._categoryListViewContainer.setAttributes(this._leaderboardViewStyleStyle.props().verticalContentContainer.innerContainer);this._categoryListViewContainer.addChild(this._categoryListView);this._listViewSection=(new a.MBListViewSection()).retain();this._leaderboardListView=new g.ListView().retain();this._leaderboardListViewContainer=new g.View().retain();this._leaderboardListViewContainer.setAttributes(this._leaderboardViewStyleStyle.props().leaderboardContainer.innerContainer);this._zeroCaseListButton=new l().retain();a.CommonElements.invisibleButton.applyTo(this._zeroCaseListButton);this._leaderboardListViewContainer.addChild(this._leaderboardListView);this._leaderboardListViewSection=(new a.MBListViewSection()).retain();this._dragHandle=new g.Button().retain();this._dragHandle.setAttributes(this._leaderboardViewStyleStyle.props().dragHandle);this._dragHandle.setImage(a.Assets.image("dragHandle.png"));this._leaderboardListViewContainer.addChild(this._dragHandle);this._zeroCaseListButton.setOnSwipe(function(s){p._closeDrawer(s,p)});this._dragHandle.onclick=function(){g.animate(function(){p._leaderboardListViewContainer.setFrame([p.orientedScreenWidth,p._leaderboardListViewContainer.getFrame()[1],p._leaderboardListViewContainer.getFrame()[2],p._leaderboardListViewContainer.getFrame()[3]])},500,function(){})};this._leaderboardListHeader=new g.View().retain();this._leaderboardListHeaderText=new g.Label().retain();this._leaderboardListHeaderText.setAttributes(this._leaderboardViewStyleStyle.props()["leaderboardListHeaderText"]);this._leaderboardListHeader.setAttributes(this._leaderboardViewStyleStyle.props().leaderboardListHeader);this._leaderboardListHeader.addChild(this._friendFilterButton);this._leaderboardListHeader.addChild(this._globalFilterButton);this._leaderboardListHeader.addChild(this._leaderboardListHeaderText);this._leaderboardCategoryFooter=new g.View().retain();this._leaderboardCategoryFooter.setAttributes(this._leaderboardViewStyleStyle.props()["header"]);this._mobageButton=new l().retain();this._mobageButton.setImage(a.Assets.image("mobagelogotm_down.png"),g.State.Pressed);this._mobageButton.setImage(a.Assets.image("mobagelogotm.png"));this._mobageButton.setOnClick(this.bind(function(){e.pushScreen(a.ServiceHost.navController,"Home",{},p)}));this._leaderboardCategoryFooter.addChild(this._mobageButton);this._leaderboardFooter=new g.View().retain();this.leaderboardFooterImage=new g.Image();this.leaderboardFooterTitle=new g.Label();this.leaderboardFooterText=new g.Label();this.leaderboardFooterScore=new g.Label();this.leaderboardFooterButton=new g.Button();this._leaderboardFooter.setAttributes(this._leaderboardViewStyleStyle.props()["leaderboardFooter"]);this.leaderboardFooterImage.setAttributes(this._leaderboardViewStyleStyle.props()["footerImage"]);this.leaderboardFooterTitle.setAttributes(this._leaderboardViewStyleStyle.props()["footerTitle"]);this.leaderboardFooterText.setAttributes(this._leaderboardViewStyleStyle.props()["footerText"]);this.leaderboardFooterScore.setAttributes(this._leaderboardViewStyleStyle.props()["footerScore"]);this.leaderboardFooterButton.setAttributes(this._leaderboardViewStyleStyle.props()["footerButton"]);this._leaderboardFooter.addChild(this.leaderboardFooterImage);this._leaderboardFooter.addChild(this.leaderboardFooterTitle);this._leaderboardFooter.addChild(this.leaderboardFooterText);this._leaderboardFooter.addChild(this.leaderboardFooterScore);this._leaderboardFooter.addChild(this.leaderboardFooterButton);this._dragHandle.setOnSwipe(this.bind(function(s){p._closeDrawer(s,p)}));g.Window.document.addChild(this._gameCoverView);g.Window.document.addChild(this._categoryListViewContainer);g.Window.document.addChild(this._leaderboardCategoryFooter);g.Window.document.addChild(this._header);g.Window.document.addChild(this._leaderboardListViewContainer);this._zeroCaseView=new g.View().retain();this._zeroCaseTextHeader=new g.Label().retain();this._zeroCaseTextHeader.setText(n("You don't have any Friends on this leaderboard yet!"));this._zeroCaseView.addChild(this._zeroCaseTextHeader);this._zeroCaseLinkBtn=new l().retain();this._zeroCaseLinkBtn.setSpamLockName("leaderboards");this._zeroCaseLinkBtn.setText(n("Suggested Friends"));this._zeroCaseLinkBtn.onclick=function(){a.MobageAnalytics.reportEvent("LeaderboardTapFindFriends");e.pushScreen(a.ServiceHost.navController,"FindFriends",{},p)};a.CommonElements.standardButton.applyTo(this._zeroCaseLinkBtn);this._zeroCaseView.addChild(this._zeroCaseListButton);this._zeroCaseView.addChild(this._zeroCaseLinkBtn);this._gameCoverView.onclick=function(){p.close()};this.layoutViews(g.Window.getWidth(),g.Window.getHeight(),true);g.animate(function(){p.layoutViews(g.Window.getWidth(),g.Window.getHeight(),false)},400,function(){});var q=k.MessageListener.subclass({_onLayoutEvent:function(s){NgLogD("LAYOUT EVENT: "+s.width+" | "+s.height);p.layoutViews(s.width,s.height)}});this.layoutListenerInstance=new q();d.LayoutEmitter.addListener(this.layoutListenerInstance,this.layoutListenerInstance._onLayoutEvent);this._loadingItemsSection=(new a.PendingListSection()).retain();this._loadingItemsSection.setPendingText(n("Loading..."));this._keyListener=new k.MessageListener();this._keyListener.classname="LeaderboardViewKeyListener";l.addDeviceKeyListener(this._keyListener,function(s){if(s.code===d.KeyEmitter.Keycode.back){this.close();return true}return false}.bind(this),99999);this._getLeaderboardCategories(p);this._headerLabel.setText((n("Leaderboards")));return this},loadView:function($super){$super()},layoutViews:function(H,D,t){NgLogD("LeaderboardViewController Layout Event W:"+H+", H:"+D);var B=k.Capabilities.getScreenWidth();var F=k.Capabilities.getScreenHeight();var z=H>=D;this.orientedScreenWidth=H;this.orientedScreenHeight=D;var A=new g.ViewGeometry.Rect(0,0,H,D);var E=Math.min(g.Window.getWidth(),g.Window.getHeight());if(t){if(z){A.x+=E*1.5}else{A.y+=D}}var G=B/480;var r=F/800;var C=16;var s;if(z){s=A.sliceHorizontal(320*r);this._gameCoverView.setGradient({gradient:["0000 0.0","F000 1.0"],gradientAngle:180})}else{s=A.sliceVertical(160*r);this._gameCoverView.setGradient({gradient:["0000 0.0","F000 1.0"]})}this._gameCoverView.setFrame(s);var w=A.sliceVertical(56*r);var q=A.copy().sliceVertical(100*r);this._header.setFrame(w);var v=10*G;var u=100*G;this._friendFilterButton.setFrame([w.w-v-(u*2)-C,v,u,46*r]);this._globalFilterButton.setFrame([w.w-v-u-C,v,u,46*r]);this._headerLabel.setFrame([20*G,v,165*G,46*r]);var y=A.copy();this._categoryListViewContainer.setFrame([y.x,y.y,y.w,y.h]);if(this._leaderboardsOpen){this._leaderboardListViewContainer.setFrame([y.x,w.y,y.w,y.h+(w.h)])}else{this._leaderboardListViewContainer.setFrame([y.x+y.w,w.y,y.w,y.h+(w.h)])}this._leaderboardCategoryFooter.setFrame([y.x,D-w.h,w.w,w.h]);y.x=0;y.y=0;var p=y.copy();p.x=C;this._dragHandle.setFrame([y.x,y.y,C,y.h+w.h]);var x=y.sliceVertical(-62*G);this._categoryListView.setFrame(y);this._leaderboardListView.setFrame([p.x,p.y,p.w,p.h-(q.h*0.3)]);this._leaderboardFooter.setFrame([p.x,p.h-(q.h*0.3),q.w,q.h]);this._zeroCaseView.setFrame([p.x,p.y+x.h,p.w,p.h]);this.leaderboardFooterImage.setFrame(0,0,q.w,q.h);this.leaderboardFooterTitle.setFrame(q.h,0,q.w,q.h);this.leaderboardFooterText.setFrame(q.h,0,q.w,q.h);this.leaderboardFooterScore.setFrame(0,0,q.w-C,q.h);this._leaderboardListHeader.setFrameSize([y.w,x.h]);this._leaderboardListHeaderText.setFrame(0,0,300,x.h);this._zeroCaseListButton.setFrame(y.x,y.y,y.w,y.h+x.h);x.x=x.y=0;x.inset(6*r,6*G,6*r,6*G);this._mobageButton.setFrame(x.sliceHorizontal(-126*r));this._zeroCaseTextHeader.setFrame([0,100*r,y.w,75*r]);this._zeroCaseLinkBtn.setFrame([(y.w-282*r)/2,200*r,282*r,54*G])},_closeDrawer:function(q,r){var p=this;NgLogD("SWIPE ANIM: "+p._drawerAnimating);NgLogD("SWIPE DIRECTION: "+q.direction);if(!p._drawerAnimating&&q.direction==2){p.cntrlRef=r;p.cntrlRef._leaderboardFooter.setVisible(false);p.cntrlRef._globalFilterButton.setVisible(false);p.cntrlRef._friendFilterButton.setVisible(false);p.cntrlRef._leaderboardListView.setScrollPosition([0,0]);g.animate(function(){p._drawerAnimating=true;p.cntrlRef._leaderboardListViewContainer.setFrame([p.cntrlRef.orientedScreenWidth,p.cntrlRef._leaderboardListViewContainer.getFrame()[1],p.cntrlRef._leaderboardListViewContainer.getFrame()[2],p.cntrlRef._leaderboardListViewContainer.getFrame()[3]])},500,function(){p._drawerAnimating=false;p.cntrlRef._leaderboardsOpen=false})}},close:function(){var p=this;this.layoutViews(g.Window.getWidth(),g.Window.getHeight(),false);g.animate(function(){p.layoutViews(g.Window.getWidth(),g.Window.getHeight(),true)},400,function(){p.destroy()})},onKeyPressed:function(p){if(p.code===d.KeyEmitter.Keycode.back){if(this._gameCoverView){this.destroy();return true}}return false},destroy:function(){this._gameCoverView.release();this._header.release();this._headerLabel.release();this._friendFilterButton.release();this._categoryListViewContainer.release();this._leaderboardListViewContainer.release();this._categoryListView.release();this._listViewSection.release();this._leaderboardCategoryFooter.release();this._mobageButton.release();this._loadingItemsSection.release();this.layoutListenerInstance.destroy();this._keyListener.destroy();a.MobagePauseGame.resumeGame(this)},_getLeaderboardCategories:function(q){this._categoryListItems=[];this._idToListItem={};var p=this;this.classRef=q;this._loadingItemsSection.setRowHeight(this._header.getFrame()[3]);this._loadingItemsSection.setPendingText(n("Loading Leaderboards..."));var r=[];r.unshift(this._loadingItemsSection);r.push(this._loadingItemsSection);this._categoryListView.setSections(r);a.Leaderboard.getLeaderboards(this.bind(function(y,v){NgLogD("LËÄDËRSHWÄGËNS: "+v);if(y){NgLogD("LB ERR!#!#!")}else{var u=0;while(u!=v.length){if(v[u].level===null||v[u].level===undefined){v.splice(u,1)}else{var t=new j();t.data={gamePhoto:v[u].getDefinedIcon(),title:v[u].title,gamerTag:v[u].gamertag,userPhoto:v[u].badgeId,level:v[u].level};t._setClassRef(this.classRef);p._categoryListItems.push(t);u++}}var s;var x=[];var w=[];for(s=0;s<p._categoryListItems.length;s++){w.push(p._categoryListItems[s])}for(s=0;s<w.length;s++){w[s].data.isEven=(s%2===0)}if(w.length>0){x.push(p._listViewSection);p._listViewSection.setItems(w)}p._categoryListViewContainer.addChild(p._categoryListView);p._categoryListView.setSections(x)}}))},_getLeaderboardScores:function(t,s,q){var p=s;p._leaderboardListItems=[];p._idToListItem={};this.classRef=s;this._loadingItemsSection.setRowHeight(this._header.getFrame()[3]);this._loadingItemsSection.setPendingText(n("Loading Scores..."));var r=[];r.unshift(this._loadingItemsSection);r.push(this._loadingItemsSection);this._leaderboardListView.setSections(r);p._leaderboardListViewSection.setSectionHeader(p._leaderboardListHeader);g.animate(function(){p._leaderboardListViewContainer.setFrame([p._categoryListViewContainer.getFrame()[0],p._leaderboardListViewContainer.getFrame()[1],p._leaderboardListViewContainer.getFrame()[2],p._leaderboardListViewContainer.getFrame()[3]])},500,function(){p._leaderboardsOpen=true});p._zeroCaseView.setVisible(false);a.Leaderboard.getLeaderboardScores(t,0,q,function(w,u,C,A){NgLogD("LËÄDËRSHWÄGËNS_getLeaderboardScores: "+u);p._leaderboardListHeaderText.setText(A);if(q){p._friendFilterButton.setOnClick(null);p._globalFilterButton.setOnClick(p.bind(function(){a.MobageAnalytics.reportEvent("LeaderboardTapGlobalFilter");p._leaderboardListView.setScrollPosition([0,0]);p._getLeaderboardScores(p._currentLevel,p,false);p._globalFilterButton.setState(g.State.Pressed);p._friendFilterButton.setState(g.State.Normal)}))}else{p._globalFilterButton.setOnClick(null);p._friendFilterButton.setOnClick(p.bind(function(){a.MobageAnalytics.reportEvent("LeaderboardTapFriendFilter");p._leaderboardListView.setScrollPosition([0,0]);p._getLeaderboardScores(p._currentLevel,p,true);p._friendFilterButton.setState(g.State.Pressed);p._globalFilterButton.setState(g.State.Normal)}))}if(w){NgLogD("LB ERR!#!#!")}else{var x=0;while(x!=u.length){if(u[x].level===null||u[x].level===undefined){u.splice(x,1)}else{var y=new o();y.data={userPhoto:u[x].badge_id,rank:u[x].rank,gamerTag:u[x].gamertag,score:u[x].score};y._setClassRef(p.classRef);p._leaderboardListItems.push(y);x++}}var B;var z=[];var v=[];for(B=0;B<p._leaderboardListItems.length;B++){v.push(p._leaderboardListItems[B])}for(B=0;B<v.length;B++){v[B].data.isEven=(B%2===0)}z.push(p._leaderboardListViewSection);p._leaderboardListViewSection.setItems(v);if(C){p.leaderboardFooterImage.setImage(C.badge_id);p.leaderboardFooterTitle.setText(C.rank);p.leaderboardFooterText.setText(C.gamertag);p.leaderboardFooterScore.setText(C.score)}else{p.leaderboardFooterImage.setImage(a.Session.getCurrentSession().user().getDefinedIcon());p.leaderboardFooterText.setText(n("NO SCORE YET"));p.leaderboardFooterScore.setText("")}p._leaderboardListViewContainer.addChild(p._leaderboardListView);p._leaderboardListView.setSections(z);p._leaderboardListViewContainer.addChild(p._leaderboardFooter);p._globalFilterButton.setVisible(true);p._leaderboardFooter.setVisible(true);p._friendFilterButton.setVisible(true);if(v.length<1){p._leaderboardFooter.setVisible(false);p._zeroCaseView.setVisible(true);p._leaderboardListViewContainer.addChild(p._zeroCaseView)}}})}});var j=g.ListViewItem.subclass({initialize:function(){},_setClassRef:function(p){this.cntrlRef=p},_onCreateView:function(){return new a.LeaderboardCategoryCell(1,k.Capabilities.getScreenWidth())},_onSetView:function(u){if(u){u.listItem=this;this.cell=u;var p=this.data.gamePhoto;var t=this.data.title;var q=this.data.gamerTag;var s=this.data.userPhoto;this.cell.setOnClick(this.bind(function(){this.cntrlRef._getLeaderboardScores(this.data.level,this.cntrlRef,false);this.cntrlRef._currentLevel=this.data.level;this.cntrlRef._globalFilterButton.setState(g.State.Pressed);this.cntrlRef._friendFilterButton.setState(g.State.Normal)}));this.cntrlRef._friendFilterButton.setOnClick(this.bind(function(){a.MobageAnalytics.reportEvent("LeaderboardTapFriendFilter");this.cntrlRef._leaderboardListView.setScrollPosition([0,0]);this.cntrlRef._getLeaderboardScores(this.cntrlRef._currentLevel,this.cntrlRef,true);this.cntrlRef._friendFilterButton.setState(g.State.Pressed);this.cntrlRef._globalFilterButton.setState(g.State.Normal)}));this.cntrlRef._globalFilterButton.setOnClick(this.bind(function(){a.MobageAnalytics.reportEvent("LeaderboardTapGlobalFilter");this.cntrlRef._leaderboardListView.setScrollPosition([0,0]);this.cntrlRef._getLeaderboardScores(this.cntrlRef._currentLevel,this.cntrlRef,false);this.cntrlRef._globalFilterButton.setState(g.State.Pressed);this.cntrlRef._friendFilterButton.setState(g.State.Normal)}));var r=function(){a.User.getUserWithGamertag(q,(function(w,v){e.pushScreen(a.ServiceHost.navController,"UserProfilePage",{user:v},this);a.MobageAnalytics.reportEvent("LeaderboardTapFriendProfile")}).bind(this))};u.setupListItem(this.data.isEven,p,t,q,s,r)}},_onReleaseView:function(p){this.cell=null}});var o=g.ListViewItem.subclass({initialize:function(){},_setClassRef:function(p){this.cntrlRef=p},_onCreateView:function(){return new a.LeaderboardCell(1,k.Capabilities.getScreenWidth())},_onSetView:function(w){if(w){w.listItem=this;this.cell=w;var s=this.data.userPhoto;var v=this.data.rank;var q=this.data.gamerTag;var u=this.data.score;var p=this;this.cell.setOnSwipe(this.bind(function(x){p.cntrlRef._closeDrawer(x,p.cntrlRef)}));var r=function(){a.User.getUserWithGamertag(q,(function(y,x){a.MobageAnalytics.reportEvent("LeaderboardTapFriendProfile");e.pushScreen(a.ServiceHost.navController,"UserProfilePage",{user:x},this)}).bind(this))};var t=p.cntrlRef._closeDrawer;w.setupListItem(this.data.isEven,s,v,q,u,r,t,p.cntrlRef)}},_onReleaseView:function(p){this.cell=null}})}};__ngs._6a={_c:null,_d:function(){var c={exports:{}};var g=c.exports;this._c=c;var k=__ngs.r_(__ngs._5).Core;var b=__ngs.r_(__ngs._4).Device;var d=__ngs.r_(__ngs._59).UI;var a=new (__ngs.r_(__ngs._f).RequireLoader)({ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},Session:function(){return __ngs.r_(__ngs._o).Session},Game:function(){return __ngs.r_(__ngs._2e).Game},Achievement:function(){return __ngs.r_(__ngs._3k).Achievement},FriendPickerCell:function(){return __ngs.r_(__ngs._9q).FriendPickerCell},PendingListSection:function(){return __ngs.r_(__ngs._9r).PendingListSection},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},MobagePauseGame:function(){return __ngs.r_(__ngs._5i).MobagePauseGame},NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},Assets:function(){return __ngs.r_(__ngs._2z).Assets},Destinations:function(){return __ngs.r_(__ngs._2a).Destinations},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics},AchievementsScreenStyle:function(){return __ngs.r_(__ngs._a0)},MobageStyle:function(){return __ngs.r_(__ngs._6k).MobageStyle}});var l=d.CellView.subclass({classname:"AchievementsBadgesCellView",initialize:function($super){$super();this._badgeBtn=[];var s=this;for(var r=0;r<f._badgesPerRow;r++){var t=new d.Button();t._added=false;t._achIdx=r;t.setOnClick(function(){s.onButtonClicked(this._achIdx)}.bind(t));a.AchievementsScreenStyle.BadgeButtonStyle.applyTo(t);this._badgeBtn.push(t)}this._cellWidth=null;this._cellHeight=null;this._hiliteImg=new d.Image();this._hiliteImg.setImage(a.Assets.image("AwardsHighlight.png"));this._bkgImage=new d.Image();this.addChild(this._bkgImage);a.AchievementsScreenStyle.ListCellStyle.applyTo(this)},destroy:function(){for(var r=0;r<this._badgeBtn.length;r++){this._badgeBtn[r].destroy()}this._badgeBtn=undefined;this._hiliteImg.destroy();this._hiliteImg=undefined;this._bkgImage.destroy();this._bkgImage=undefined},onButtonClicked:function(r){if(this._controller&&r<this._achievements.length){if(this._controller.onAchievementClicked(this._achievements[r],this.getFrame())){if(this._controller._currentHilite){this._controller._currentHilite.removeFromParent()}var s=this._badgeBtn[r].getFrame();this._hiliteImg.setFrame([s[0],s[1],s[2],s[3]-this._badgeBtnImageBtmInset]);this.addChild(this._hiliteImg);this._badgeBtn[r].removeFromParent();this.addChild(this._badgeBtn[r]);this._controller._currentHilite=this._hiliteImg}}},setAchievements:function(v){this._achievements=v;var u;if(!v||!v.length){this._bkgImage.setImage(null);for(u=0;u<this._badgeBtn.length;u++){this._badgeBtn[u].setImage(null)}return}this._bkgImage.setImage(a.Assets.image("achievement_shelf.png"));for(u=0;u<this._badgeBtn.length;u++){if(u<v.length){if(!this._badgeBtn[u].added){this._badgeBtn[u].added=true;this.addChild(this._badgeBtn[u])}}else{if(this._badgeBtn[u].added){this._badgeBtn[u].added=false;this._badgeBtn[u].removeFromParent()}}}this._respositionButtons();for(var s=0;s<v.length;s++){var t=this._badgeBtn[s];var r=v[s];t.setText(r.name);if(r.unlocked){if(r.icon_url){t.setImage(r.icon_url)}else{t.setImage(a.Assets.image("UnlockedAchievement.png"))}}else{t.setImage(a.Assets.image("LockedAchievement.png"))}}},sizeChanged:function(s,y){var x=s*a.AchievementsScreenStyle.ListCellStyle.extras.imageWidthInsetRatio;var w=y*a.AchievementsScreenStyle.ListCellStyle.extras.imageHeightInsetRatio;this._bkgImage.setFrame([x,w,s-x*2,y-w]);this._cellWidth=s;this._cellHeight=y;var u=a.AchievementsScreenStyle.BadgeButtonStyle.extras.textHeightPct*y;var t=a.AchievementsScreenStyle.BadgeButtonStyle.extras.imageTextMarginPct*y;var A=(y-u)+t;this._badgeBtnImageBtmInset=A;var z=this._cellWidth/f._badgesPerRow;var r=a.AchievementsScreenStyle.BadgeButtonStyle.extras.textWidthMarginsPct*z;for(var v=0;v<this._badgeBtn.length;v++){this._badgeBtn[v].setImageInsets([0,0,A,0]);this._badgeBtn[v].setTextInsets([u,r,0,r])}this._respositionButtons()},_respositionButtons:function(){if(!this._achievements||!this._cellWidth||!this._cellHeight){return}var u=this._cellWidth/f._badgesPerRow;var r=(this._cellWidth/(this._achievements.length)/2)-u/2;var t=r;for(var s=0;s<this._achievements.length;s++){this._badgeBtn[s].setFrame([t,0,u,this._cellHeight]);t+=u}}});var q=d.ListViewItem.subclass({classname:"AchievementsBadgesListItem",_reuseId:"AchievementsBadgesListItem",initialize:function($super,r){$super();this._controller=r;this._achievements=null},setAchievements:function(r){this._achievements=r;if(this._cellView){this._cellView.setAchievements(this._achievements)}},_onSetView:function(r){if(r){r.setAchievements(this._achievements);r._controller=this._controller}this._cellView=r},_onCreateView:function(){return new l()},_onReleaseView:function(r){r.setAchievements(null);r._controller=null;this._cellView=null}});var h=d.CellView.subclass({classname:"AchievementsTitleCellView",initialize:function($super){$super();this._label=new d.Label();this.addChild(this._label);a.AchievementsScreenStyle.TitleCellStyle.applyTo(this)},destroy:function(){this._label.destroy()},setGameName:function(r){if(r){this._label.setText(r+" Achievements")}else{this._label.setText("")}},sizeChanged:function(s,r){this._label.setFrame([0,0,s,r])}});var n=d.ListViewItem.subclass({classname:"AchievementsTitleListItem",_reuseId:"AchievementsTitleListItem",initialize:function($super){$super();this._gameName=null},setGameName:function(r){this._gameName=r;if(this._cellView){this._cellView.setGameName(r)}},_onSetView:function(r){if(r){r.setGameName(this._gameName)}this._cellView=r},_onCreateView:function(){return new h()},_onReleaseView:function(r){this._cellView=null}});var e=d.CellView.subclass({classname:"AchievementsCountHeaderCellView",initialize:function($super){$super();this._label=new d.Label();this.addChild(this._label);a.AchievementsScreenStyle.CountHeaderCellStyle.applyTo(this)},destroy:function(){this._label.destroy()},setAchievementCounts:function(r,s){if(!s){this._label.setText("")}else{this._label.setText(r+" of "+s+" achievements unlocked")}},sizeChanged:function(s,r){this._label.setFrame([0,0,s,r])}});var j=d.ListViewItem.subclass({classname:"AchievementsCountHeaderListItem",_reuseId:"AchievementsCountHeaderListItem",initialize:function($super){$super();this._achievementsUnlocked=0;this._achievementsTotal=0},setAchievementCounts:function(r,s){this._achievementsUnlocked=r;this._achievementsTotal=s;if(this._cellView){this._cellView.setAchievementCounts(this._achievementsUnlocked,this._achievementsTotal)}},_onSetView:function(r){if(r){r.setAchievementCounts(this._achievementsUnlocked,this._achievementsTotal)}this._cellView=r},_onCreateView:function(){return new e()},_onReleaseView:function(r){this._cellView=null}});var m=d.View.subclass({classname:"AchievementsDetailModal",initialize:function($super,r){$super();this._controller=r;this._descriptionLabel=new d.Label();this._titleLabel=new d.Label();this._achvImage=new d.Image();this.addChild(this._descriptionLabel);this.addChild(this._titleLabel);this.addChild(this._achvImage);a.AchievementsScreenStyle.DetailModalStyle.applyTo(this);this._showing=false;this.setTouchable(false);this._descriptionLabel.setTouchable(false);this._titleLabel.setTouchable(false);this._achvImage.setTouchable(false)},destroy:function(){this._descriptionLabel.destroy();this._titleLabel.destroy();this._achvImage.destroy()},isOverlappingButton:function(r,s){if(!this._showing){return false}if(r+s/2>this._displayedYPos){return true}return false},show:function(s,w,v,t,u){if(!u){u=a.Assets.image("UnlockedAchievement.png")}this._descriptionLabel.setText(t);this._titleLabel.setText(v);this._achvImage.setImage(u);var r=Math.min(s,w);d.measureText("PLACEHOLDER",9000,9000,a.MobageStyle.defaultBoldFontFace,14,function(z){this._titleHeight=z.height*1.35;var B=s*a.AchievementsScreenStyle.DetailModalStyle.extras.containerWidthInsetRatio;var y=r-B*2;var x=y*a.AchievementsScreenStyle.DetailModalStyle.extras.achvIconWidthRatio;var A=x*a.AchievementsScreenStyle.DetailModalStyle.extras.achvIconInsetRatio;d.measureText(t,y-x,9000,a.MobageStyle.defaultStandardFontFace,14,function(D){if(this._showing){this.removeFromParent()}var E=r*a.AchievementsScreenStyle.DetailModalStyle.extras.textMarginHeightPct;var K=r*a.AchievementsScreenStyle.DetailModalStyle.extras.containerHeightMaxRatio;var C=x;var I=D.height*1.2+this._titleHeight;var L=Math.min(Math.max(I+E*2,C),K);var J=r*a.AchievementsScreenStyle.DetailModalStyle.extras.containerVerticalInsetRatio;this._displayedYPos=w-J-L;this.setFrame([s-r+B,this._displayedYPos,y,L]);var H=L/2-x/2+A;var F=x-A*2;this._achvImage.setFrame([A,H,F,F]);var G=Math.max((L-I)/2,E);this._titleLabel.setFrame([x,G,y-x,this._titleHeight]);this._descriptionLabel.setFrame([x,G+this._titleHeight,y-x,L-this._titleHeight]);this._showing=true;d.Window.document.addChild(this)}.bind(this))}.bind(this))},close:function(){if(!this._showing){return}this._showing=false;if(this._controller._currentHilite){this._controller._currentHilite.removeFromParent()}this.removeFromParent()}});var p=__ngs.r_(__ngs._n).LocalizedString;var o=__ngs.r_(__ngs._87).ReferenceCounting;var f=g.AchievementsController=o.subclass({classname:"AchievementsController",analyticsName:"AchievementsScreen",_badgesPerRow:3,$showAchievementsScreen:function(){if(f._instance){return null}f._instance=new f();return f._instance},$hideAchievementsScreen:function(){if(f._instance){f._instance.close()}},initialize:function($super,t){$super();this._animating=false;a.MobagePauseGame.pauseGame(this);this._onGetAchievementsSuccess=f.onGetAchievementsSuccess.bind(this);this._onGetAchievementsError=f.onGetAchievementsError.bind(this);if(t){this._setCurrentGame(t)}else{if(!a.NetworkUtils.wasNetworkDown(function(){this.close()}.bind(this))){a.Game.getCurrentGame(function(x,w){if(x){w=null}this._setCurrentGame(w)}.bind(this))}}this._gameCoverView=new a.UnspammableButton();this._gameCoverView.onclick=function(w){if(this._detailModal._showing){this._detailModal.close()}else{this.close()}}.bind(this);d.Window.document.addChild(this._gameCoverView);this._detailModal=new m(this);this._footerView=new d.View();d.Window.document.addChild(this._footerView);this._mobageButton=new a.UnspammableButton();this._mobageButton.setImage(a.Assets.image("mobagelogotm_down.png"),d.State.Pressed);this._mobageButton.setImage(a.Assets.image("mobagelogotm.png"));this._mobageButton.onclick=function(){a.Destinations.pushScreen(a.ServiceHost.navController,"Home",{},this)}.bind(this);this._footerView.addChild(this._mobageButton);this._contentBackground=new d.View();d.Window.document.addChild(this._contentBackground);this._listView=new d.ListView();d.Window.document.addChild(this._listView);a.AchievementsScreenStyle.FooterStyle.applyTo(this._footerView);a.AchievementsScreenStyle.ContentBackgroundStyle.applyTo(this._contentBackground);this.layoutViews(d.Window.getWidth(),d.Window.getHeight(),true);var s=this;d.animate(function(){s._animating=true;s.layoutViews(d.Window.getWidth(),d.Window.getHeight(),false)},400,function(){s._animating=false});var v=Math.min(d.Window.getWidth(),d.Window.getHeight());this._titleListItem=new n();this._titleSection=new d.ListViewSection({items:[this._titleListItem],rowHeight:v*0.108});this._countHeaderListItem=new j();this._countHeaderSection=new d.ListViewSection({items:[this._countHeaderListItem],rowHeight:v*0.108});this._pendingSection=new a.PendingListSection();this._pendingSection.setPendingText(p("Getting achievements..."));this._pendingSection.setRowHeight(v*0.2);this._listView.setSections([this._titleSection,this._pendingSection]);this._badgeRowHeight=v*0.33333333;this._listView.onscroll=function(){if(this._detailModal._showing){this._detailModal.close()}}.bind(this);var r=this;var u=k.MessageListener.subclass({_onLayoutEvent:function(w){r._detailModal.close();r.layoutViews(w.width,w.height)},destroy:function(){b.LayoutEmitter.removeListener(this)}});this._layoutListener=new u();b.LayoutEmitter.addListener(this._layoutListener,this._layoutListener._onLayoutEvent);this._keyListener=new k.MessageListener();this._keyListener.classname="AchievementsControllerKeyListener";a.UnspammableButton.addDeviceKeyListener(this._keyListener,function(w){if(w.code===b.KeyEmitter.Keycode.back){if(!a.ServiceHost.isShowing()){this.close();return true}else{return false}}return false}.bind(this),99999);a.MobageAnalytics.reportEvent("AchvScreenShow");return this},destroy:function(){if(f._instance==this){f._instance=null}a.MobagePauseGame.resumeGame(this);a.MobageAnalytics.reportEvent("AchvScreenHide");if(this._headersSection){this._headersSection.destroy()}if(this._contentSection){this._contentSection.destroy()}this._detailModal.destroy();this._gameCoverView.destroy();this._footerView.destroy();this._mobageButton.destroy();this._contentBackground.destroy();this._listView.destroy();this._layoutListener.destroy();this._keyListener.destroy()},close:function(){if(this._animating){return}this._detailModal.close();var r=this;this.layoutViews(d.Window.getWidth(),d.Window.getHeight(),false);d.animate(function(){r._animating=true;r.layoutViews(d.Window.getWidth(),d.Window.getHeight(),true)},400,function(){r._animating=false;r.destroy()})},layoutViews:function(r,w,s){var B=Math.min(r,w);var u=r>w?true:false;var y=new d.ViewGeometry.Rect(0,0,r,w);if(s){if(u){y.x+=B*1.2}else{y.y+=w}}var x;var t;if(u){t={gradient:["0000 0.8","F000 1.0"],gradientAngle:180};x=y.sliceHorizontal(r-B)}else{t={gradient:["0000 0.2","F000 1.0"],gradientAngle:90};x=y.sliceVertical(w*0.2)}this._gameCoverView.setGradient(t);this._gameCoverView.setFrame(x);var v=y.sliceVertical(-(B*0.088));this._contentBackground.setFrame(y);this._listView.setFrame(y);v.h=Math.ceil(v.h);this._footerView.setFrame(v);var A=v.w*a.AchievementsScreenStyle.FooterStyle.extras.mobageButtonWidthRatio;var z=v.h*a.AchievementsScreenStyle.FooterStyle.extras.mobageButtonHeightInsetRatio;this._mobageButton.setFrame([v.w-A,z,A,v.h-z])},_setCurrentGame:function(r){this._currentGame=r;if(this._currentGame){this._titleListItem.setGameName(r.name);this._getAchievements()}},_getAchievements:function(){if(!a.NetworkUtils.wasNetworkDown(function(){this.close()}.bind(this))){var u=a.Session.getCurrentSession();if(u){var r=u.user();if(r){var s=r.getAchievementsList();var t=[];var v=0;s.forAll(function(y,x,w){if(x.unlocked){v++}t.push(x);y(true)}.bind(this),function(w){if(w){this._onGetAchievementsError(w)}else{this._onGetAchievementsSuccess(t,v)}}.bind(this))}else{this._onGetAchievementsError("no user")}}else{this._onGetAchievementsError("no user")}}},$onGetAchievementsSuccess:function(r,v){if(this._countHeaderListItem){this._countHeaderListItem.setAchievementCounts(v,r.length)}var u=[];while(r.length>0){var t=r.splice(0,f._badgesPerRow);var s=new q(this);s.setAchievements(t);u.push(s)}if(this._contentSection){this._contentSection.destroy();this._contentSection=null}this._contentSection=new d.ListViewSection({items:u,rowHeight:this._badgeRowHeight});this._listView.setSections([this._titleSection,this._countHeaderSection,this._contentSection])},$onGetAchievementsError:function(r){NgLogD("AchievementsController - got error retreiving achievements: "+r)},onAchievementClicked:function(r,t){a.MobageAnalytics.reportEvent("AchvScreenViewAchv",{achievement:r.name});var s=t[1];s-=this._listView.getScrollPosition()[1];s+=this._listView.getFrame()[1];if(this._detailModal.isOverlappingButton(s,t[3])){this._detailModal.close();return false}this._detailModal.show(d.Window.getWidth(),d.Window.getHeight(),r.name,r.description,r.icon_url);return true}})}};__ngs._t={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Class=__ngs.r_(__ngs._42).Class}};__ngs._u={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Base64=__ngs.r_(__ngs._43).Base64}};__ngs._v={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var c=__ngs.r_(__ngs._t);var a=__ngs.r_(__ngs._1);var e=c.Class.subclass({classname:"ResultSet",initialize:function(f){this.items=[];this._continueId=f;this.totalLength=Number.MAX_VALUE},getMore:function(f){return a.SystemBinding._getMoreContacts(this,f)},closeResultSet:function(){a.SystemBinding._closeContactsResultSet(this)}});b.ResultSet=e}};__ngs._w={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.MessageListener=__ngs.r_(__ngs._44).MessageListener}};__ngs._x={_c:null,_d:function(){var c={exports:{}};var f=c.exports;this._c=c;var m=__ngs.r_(__ngs._6).Proc;var b=__ngs.r_(__ngs._t).Class;var k=__ngs.r_(__ngs._y).Util;var g=__ngs.r_(__ngs._7).Capabilities;var j=function(o,n){this.item=o;this.content=n};var e=/(.*?): (.*)/;var l={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4};var d=["OPTIONS","GET","HEAD","POST","PUT","DELETE","TRACE","CONNECT"];var h=["CONNECT","TRACE","TRACK"];var a=function(n){if(!n){return"GET"}n=n.toString();if(n in h){throw"SECURITY_ERROR "+n+" not allowed."}if(n.toUpperCase() in d){return n.toUpperCase()}return n};f.XHR=b.subclass({classname:"XHR",initialize:function(){this.respHeaders={};this.settings={};this.headers=[];this.sendFlag=false;this.errorFlag=false;this.readyState=l.UNSENT;this.responseText=null;this.responseXML=null;this.status=0;this.statusText=""},_classId:340,_sendStatusRecvGen:function(p){if((p.length-p.idx)!==2){NgLogE("Could not parse due to wrong argument count in XHR.sendStatus from command: "+p);return false}var o=m.parseInt(p[p.idx++]);if(o===undefined){NgLogE("Could not parse statNum in XHR.sendStatus from command: "+p);return false}var n=m.parseString(p[p.idx++]);if(n===undefined){NgLogE("Could not parse statStr in XHR.sendStatus from command: "+p);return false}return this._sendStatusRecv(o,n)},_sendHeadersRecvGen:function(n){if((n.length-n.idx)!==1){NgLogE("Could not parse due to wrong argument count in XHR.sendHeaders from command: "+n);return false}var o=m.parseString(n[n.idx++]);if(o===undefined){NgLogE("Could not parse headers in XHR.sendHeaders from command: "+n);return false}return this._sendHeadersRecv(o)},_sendDataRecvGen:function(o){if((o.length-o.idx)!==1){NgLogE("Could not parse due to wrong argument count in XHR.sendData from command: "+o);return false}var n=m.parseString(o[o.idx++]);if(n===undefined){NgLogE("Could not parse data in XHR.sendData from command: "+o);return false}return this._sendDataRecv(n)},_onFinishRecvGen:function(o){if((o.length-o.idx)!==1){NgLogE("Could not parse due to wrong argument count in XHR.onFinish from command: "+o);return false}var n=m.parseBool(o[o.idx++]);if(n===undefined){NgLogE("Could not parse error in XHR.onFinish from command: "+o);return false}return this._onFinishRecv(n)},$_createSendGen:function(n){m.appendToCommandString(22347775,[+n])},_destroySendGen:function(){m.appendToCommandString(22282242,this)},_startSendGen:function(q,n,o,p){m.appendToCommandString(22282247,this,[m.encodeString(q),m.encodeString(n),m.encodeString(o),+p])},_headerSendGen:function(o,n){m.appendSubcommandToCommandString([m.encodeString(o),m.encodeString(n)])},_setCompositionSendGen:function(){m.appendToCommandString(22282249,this)},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[340]=this._instance||this;PROC_METHOD_TABLE[22282243]=this.prototype._sendStatusRecvGen;PROC_METHOD_TABLE[22282244]=this.prototype._sendHeadersRecvGen;PROC_METHOD_TABLE[22282245]=this.prototype._sendDataRecvGen;PROC_METHOD_TABLE[22282246]=this.prototype._onFinishRecvGen},open:function(r,p,q,n,o){p=p.split(" ").join("%20");this.settings={method:a(r),url:k.buildRelativeUrl(p),async:q,user:n,password:o};this.reset();this.setState(l.OPENED)},sendComposition:function(n){this.composing=true;this.send(JSON.stringify(n))},send:function(q){if(this.readyState!=l.OPENED||this.sendFlag){throw"INVALID_STATE_ERR: "+(this.sendFlag?"Already sending":"in state "+this.readyState)}this.sendFlag=true;this.errorFlag=false;var o;if(this.settings.method=="GET"||this.settings.method=="HEAD"){q=null}else{if(q){var p=false;for(o in this.headers){if(this.headers[o].item=="Content-Type"){p=true;break}}if(!p){this.setRequestHeader("Content-Type","text/plain;charset=UTF-8")}}}this.responseText="";if(!q){q=""}var n=__ngs.r_(__ngs._12).ObjectRegistry;n.register(this);this._createSendGen(this.__objectRegistryId);if(this.composing){this._setCompositionSendGen()}this._startSendGen(this.settings.method,this.settings.url,q,this.headers.length);for(o in this.headers){var r=this.headers[o];this._headerSendGen(r.item,r.content)}},abort:function(){this.responseText=null;this.errorFlag=true;this.headers=[];if(this.sendFlag){if(this.readyState!=l.DONE){this.sendFlag=false;this.setState(l.DONE)}}this.readyState=l.UNSENT},getResponseHeader:function(n){if(this.readyState>l.OPENED){return this.respHeaders[n.toLowerCase()]}return null},getUnflattenedResponseHeaders:function(){return this.respHeaders},getAllResponseHeaders:function(){if(this.readyState<l.HEADERS_RECEIVED||this.errorFlag){return""}var n="";for(var o in this.respHeaders){n+=o+": "+this.respHeaders[o]+"\r\n"}return n.substr(0,n.length-2)},setRequestHeader:function(o,n){this.headers.push(new j(o,n))},getRequestHeader:function(p){var n=null;for(var o in this.headers){if(this.headers[o].item==p){n=this.headers[o].content;break}}return n},onStatus:function(n,o){this.status=n;this.statusText=o},_sendStatusRecv:function(o,n){this.onStatus(o,n)},onHeaders:function(q){var n=q.split("\n");n.pop();for(var p in n){var o=e.exec(n[p]);if(o){this.respHeaders[o[1].toLowerCase()]=o[2]}}this.setState(l.HEADERS_RECEIVED)},_sendHeadersRecv:function(n){this.onHeaders(n)},onData:function(n){this.responseText+=n;this.setState(l.LOADING)},_sendDataRecv:function(n){this.onData(n)},onFinish:function(n){this.sendFlag=false;if(n){this.responseText=null;this.error="Network Error";this.errorFlag=true;this.status=0}this.setState(l.DONE)},_onFinishRecv:function(n){this.onFinish(n)},reset:function(){this.headers=[];this.readyState=l.UNSENT;this.responseText=null;this.responseXML=null;this.composing=false},setState:function(o){this.readyState=o;if(o==l.DONE){this._destroySendGen();var n=__ngs.r_(__ngs._12).ObjectRegistry;n.unregister(this)}if(typeof this.onreadystatechange!="undefined"){try{this.onreadystatechange()}catch(p){NgLogException(p)}}}})}};__ngs._y={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var c=__ngs.r_(__ngs._7).Capabilities;var e=__ngs.r_(__ngs._1r).Time;var a=__ngs.r_(__ngs._11).LifecycleEmitter;var g=__ngs.r_(__ngs._i).AlertDialog;var f=/^(https?:\/\/)?([^\/]*)(.*[^\/])?.?/i;var h=b.Util={NormalizeUrl:function(k,l){k=h.buildRelativeUrl(k);var j=k.match(f);if(j&&j[1]){k=j[1].toLowerCase()+j[2].toLowerCase()+(j[3]?j[3]:"")}else{k=k.toLowerCase()}return k},GetMD5HashDirectoryFromUrl:function(k){var j;if(k===Capabilities._getBootServer()+"/"+Capabilities._getBoot()){j=Capabilities.getBootDir()}else{j=__ngs.r_(__ngs._45).toMD5(k)}return j},buildRelativeUrl:function(j){if(!j.match(/^(https?:\/\/)/)){if(j.charAt(0)=="/"||!j.length){j=c.getServer()+j}else{j=c.getServer()+"/"+c.getGame()+"/"+j}}return j},RetrySchedule:function(k,m){var l=Math.floor(Math.log(m/k));var n=[k];for(var j=0;j<l+1;++j){k*=2;n.push(k)}return n},OperationWithRetries:function(s,m,n){var l;var k;var q;if(n){l=3;k=10000;q=1}else{l=Infinity;k=30000;q=6}k=Core.Time.getRealTime()+k;var r=250;var u=1;var o=false;var j=true;var p=function(){if(o){return}if(!j){console.log("OperationWithRetries: failureParam called when not armed");return}j=false;if(u>=l){console.log("OperationWithRetries: too many retry attempts");o=true;m();return}if(Core.Time.getRealTime()>=k&&u>=q){console.log("OperationWithRetries: retries took too long");console.log("OperationWithRetries: abortTime:",k,"realTime:",Core.Time.getRealTime());console.log("OperationWithRetries: attemptCount:",u,"abortTimeAttempts:",q);o=true;m();return}console.log("OperationWithRetries: Failure, will retry in "+r+"ms");setTimeout(function(){if(o){return}j=true;s(p,t)},r);u+=1;r*=2};var t=function(){var v=true;m()};s(p,t);return t},showFatalErrorDialog:function(k){var l=new g();l.setTitle(Core.Localization.getString("Network failure"));l.setChoices([Core.Localization.getString("Exit")]);l.onchoice=function(m){l.hide();a.exitProcess()};var j={"302":"File location has changed (302)","400":"Bad request to server (400)","401":"Authorization failed (401)","403":"Server permissions error (403)","404":"Resource not found (404)","408":"Request timed out (408)","500":"Internal server error (500)","501":"Cannot process request (501)","502":"Bad Gateway (502)","503":"Service overloaded / down for maintenance (503)","504":"Timeout at intervening gateway (504)"};l.setText(Core.Localization.getString(j[k]||"This application requires a working data connection."));l.show()},showSimpleNetworkError:function(k){var m=new g();m.setTitle(Core.Localization.getString("Network failure"));m.setChoices([Core.Localization.getString("OK")]);m.onchoice=function(n){m.hide()};var j={"302":" File location has changed (302)","400":" Bad request to server (400)","401":" Authorization failed (401)","403":" Server permissions error (403)","404":" Resource not found (404)","408":" Request timed out (408)","500":" Internal server error (500)","501":" Cannot process request (501)","502":" Bad Gateway (502)","503":" Service overloaded / down for maintenance (503)","504":" Timeout at intervening gateway (504)"};var l="Cannot download game without network connection.";if(j[k]){l+=j[k]}m.setText(Core.Localization.getString(l));m.show()},getCacheBustingString:function(){return""},Ad:{Tapjoy:{sendActionComplete:function(k){var j=__ngs.r_(__ngs._3w)._int_Util;j.adTapjoySendActionComplete(k)}}}}}};__ngs._z={_c:null,_d:function(){var c={exports:{}};var f=c.exports;this._c=c;var j=__ngs.r_(__ngs._6).Proc;var d=__ngs.r_(__ngs._12).ObjectRegistry;var b=__ngs.r_(__ngs._t).Class;var h=__ngs.r_(__ngs._7).Capabilities;var e=/^([\w-]+):\s*([^\n]+?)\s*$/mg;function g(m,l,k){this.push({item:l,content:k})}function a(k){var l=[];k.replace(e,g.bind(l));return l}f.DownloadFile=b.subclass({classname:"DownloadFile",initialize:function(){this._options=[]},start:function(k,p,l,n,o){d.register(this);this._createSendGen(this.__objectRegistryId);l=l.split(" ").join("%20");if(!(n instanceof Array)){if(n){NgLogE("Improper headers sent("+n+'). Need an array, ex: [{item:"Content-Easter", content:"egg"}]')}n=[]}for(var m=0;m<this._options.length;++m){this._setOptionSendGen(this._options[m].opId,this._options[m].iVal,this._options[m].sVal)}this.__sendSendGen(k,p,l,n.length);for(var m in n){this.__headerSendGen(n[m].item,n[m].content)}this.mCB=o},abort:function(){this._destroySendGen();d.unregister(this)},setOption:function(l,m,k){if(h.compareBinaryVersion(1,8,1)<0){NgLogE("setOption() method not supported with this binary");return}this._options.push({opId:l,iVal:m,sVal:k})},_finishRecv:function(l,k){this._finishWithResultRecv(l,k,"")},_finishWithHeadersRecv:function(l,k,m){this._finishWithResultRecv(l,k,m)},_finishWithResultRecv:function(m,l,p,n){this._destroySendGen();if(this.mCB){var k=null;try{if(typeof n==="string"&&n.length>0){k=JSON.parse(n)}}catch(o){NgLogE("Could not parse response :"+n)}this.mCB(m,l,a(p),k)}d.unregister(this)},Option:{VerificationHash:1,AutoDecompress:2},HashType:{NoHash:1,MD5:2},Error:{UnspecifiedError:0,NetworkError:-1,HashVerificationFailed:-2,DecompressionFailed:-3,AccessDenied:-4,DiskFull:-5},_classId:341,_finishRecvGen:function(m){if((m.length-m.idx)!==2){NgLogE("Could not parse due to wrong argument count in DownloadFile.finish from command: "+m);return false}var l=j.parseInt(m[m.idx++]);if(l===undefined){NgLogE("Could not parse status in DownloadFile.finish from command: "+m);return false}var k=j.parseString(m[m.idx++]);if(k===undefined){NgLogE("Could not parse signature in DownloadFile.finish from command: "+m);return false}return this._finishRecv(l,k)},_finishWithHeadersRecvGen:function(m){if((m.length-m.idx)!==3){NgLogE("Could not parse due to wrong argument count in DownloadFile.finishWithHeaders from command: "+m);return false}var l=j.parseInt(m[m.idx++]);if(l===undefined){NgLogE("Could not parse status in DownloadFile.finishWithHeaders from command: "+m);return false}var k=j.parseString(m[m.idx++]);if(k===undefined){NgLogE("Could not parse signature in DownloadFile.finishWithHeaders from command: "+m);return false}var n=j.parseString(m[m.idx++]);if(n===undefined){NgLogE("Could not parse headers in DownloadFile.finishWithHeaders from command: "+m);return false}return this._finishWithHeadersRecv(l,k,n)},_finishWithResultRecvGen:function(n){if((n.length-n.idx)!==4){NgLogE("Could not parse due to wrong argument count in DownloadFile.finishWithResult from command: "+n);return false}var l=j.parseInt(n[n.idx++]);if(l===undefined){NgLogE("Could not parse status in DownloadFile.finishWithResult from command: "+n);return false}var k=j.parseString(n[n.idx++]);if(k===undefined){NgLogE("Could not parse signature in DownloadFile.finishWithResult from command: "+n);return false}var o=j.parseString(n[n.idx++]);if(o===undefined){NgLogE("Could not parse headers in DownloadFile.finishWithResult from command: "+n);return false}var m=j.parseString(n[n.idx++]);if(m===undefined){NgLogE("Could not parse files in DownloadFile.finishWithResult from command: "+n);return false}return this._finishWithResultRecv(l,k,o,m)},$_createSendGen:function(k){j.appendToCommandString(22413311,[+k])},_destroySendGen:function(){j.appendToCommandString(22347778,this)},__sendSendGen:function(n,m,k,l){j.appendToCommandString(22347779,this,[j.encodeString(n),j.encodeString(m),j.encodeString(k),+l])},__headerSendGen:function(l,k){j.appendSubcommandToCommandString([j.encodeString(l),j.encodeString(k)])},_setOptionSendGen:function(l,m,k){j.appendToCommandString(22347783,this,[+l,+m,j.encodeString(k)])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[341]=this._instance||this;PROC_METHOD_TABLE[22347781]=this.prototype._finishRecvGen;PROC_METHOD_TABLE[22347782]=this.prototype._finishWithHeadersRecvGen;PROC_METHOD_TABLE[22347784]=this.prototype._finishWithResultRecvGen}})}};__ngs._10={_c:null,_d:function(){var c={exports:{}};var f=c.exports;this._c=c;var j=__ngs.r_(__ngs._6).Proc;var e=__ngs.r_(__ngs._12).ObjectRegistry;var a=__ngs.r_(__ngs._t).Class;var g=__ngs.r_(__ngs._21).Diagnostics;var h=[];function b(){}f.KeyValueCache=b;b.lruMeanCacheSize=100;b.instanceMap={};var d=[];b.init=function(){b.local=new Storage.KeyValue();b.local.registerForKey("local")};b.global=function(k){if(d[k]){return d[k]}var l=new f.KeyValue();l.registerForKey(k);d[k]=l;return l};f.KeyValue=a.subclass({classname:"KeyValue",_options:{blocking:1},initialize:function(){this.initialized=false;this.origin=null;this.callbacks={};this.callbacks.uidGenerator=1;this.local=false;this.lruCacheShrinkCounter=0;var k=__ngs.r_(__ngs._7).Capabilities;this.oldBinary=!k.meetsBinaryVersion("1.4");e.register(this);this._createSendGen(this.__objectRegistryId);this._getItemCount=0;this._setItemCount=0;this._removeItemCount=0;g.pushCollector(this.collectDiagnostics.bind(this))},destroy:function(){this._destroySendGen();e.unregister(this)},registerForKey:function(k){this.origin=k;b.instanceMap[k]=this;this._registerCommandSendGen(this.origin,0);return this},getItem:function(m,l,k){this._getItemCount++;var o=typeof l=="object";var n=this.callbacks.uidGenerator++;this.callbacks[n]=(o?k:l)||function(){};if(this.oldBinary){this._getItemSendGen(this.origin,n,m)}else{var p;if(o){p=0|(l&&l.blocking&&this._options.blocking)}else{p=this._options.blocking;NgLogW("KeyValue.getItem(): using deprecated function signature")}this._getItemAsyncSendGen(this.origin,n,m,p)}},setItem:function(m,p,l,k){this._setItemCount++;var o=typeof l=="object";var n=this.callbacks.uidGenerator++;this.callbacks[n]=(o?k:l)||function(){};if(this.oldBinary){this._setItemSendGen(this.origin,n,m,p)}else{var q;if(o){q=0|(l&&l.blocking&&this._options.blocking)}else{q=this._options.blocking;NgLogW("KeyValue.setItem(): using deprecated function signature")}this._setItemAsyncSendGen(this.origin,n,m,p,q)}},removeItem:function(m,l,k){this._removeItemCount++;var o=typeof l=="object";var n=this.callbacks.uidGenerator++;this.callbacks[n]=(o?k:l)||function(){};if(this.oldBinary){this._removeItemSendGen(this.origin,n,m)}else{var p;if(o){p=0|(l&&l.blocking&&this._options.blocking)}else{p=this._options.blocking;NgLogW("KeyValue.removeItem(): using deprecated function signature")}this._removeItemAsyncSendGen(this.origin,n,m,p)}},clear:function(l,k){var n=typeof l=="object";var m=this.callbacks.uidGenerator++;this.callbacks[m]=(n?k:l)||function(){};if(this.oldBinary){this._clearSendGen(this.origin,m)}else{var o;if(n){o=0|(l&&l.blocking&&this._options.blocking)}else{o=this._options.blocking;NgLogW("KeyValue.clear(): using deprecated function signature")}this._clearAsyncSendGen(this.origin,m,o)}},_getInstanceRecv:function(l,n,m){var k=b.instanceMap[n];return k},_registerCommandCbRecv:function(m,l,n,p,o,k){if(n){console.log("Storage: Error registering for KeyValue location '"+n+"'");if(!this.initialized){delete d[msg.originalStoreKey]}return}if(this.origin=="local"){this.local=true;d[this.origin]=this}this.origin=p;this.initialized=true},_getItemCommandCbRecv:function(l,p,o,m,n,q){var k=o&&this.callbacks[o];if(k){delete this.callbacks[o];k(m,m?null:q,n)}},_setItemCommandCbRecv:function(l,p,o,m,n,q){var k=o&&this.callbacks[o];if(k){if(typeof k!=="function"){console.log("FAKEXCEPTION! this is not a function! "+k)}delete this.callbacks[o];k(m,n)}},_removeItemCbRecv:function(l,p,o,m,n){var k=o&&this.callbacks[o];if(k){delete this.callbacks[o];k(m,n)}},_clearCommandCbRecv:function(l,o,n,m){var k=n&&this.callbacks[n];if(k){delete this.callbacks[n];k(m,this.origin)}},Responses:{Register:0,GetItem:1,SetItem:2,RemoveItem:3,Clear:4},_classId:339,_getInstanceRecvGen:function(n){if((n.length-n.idx)!==3){NgLogE("Could not parse due to wrong argument count in KeyValue.getInstance from command: "+n);return false}var k=j.parseInt(n[n.idx++]);if(k===undefined){NgLogE("Could not parse response in KeyValue.getInstance from command: "+n);return false}var m=j.parseString(n[n.idx++]);if(m===undefined){NgLogE("Could not parse storeKey in KeyValue.getInstance from command: "+n);return false}var l=j.parseString(n[n.idx++]);if(l===undefined){NgLogE("Could not parse key in KeyValue.getInstance from command: "+n);return false}return this._getInstanceRecv(k,m,l)},_registerCommandCbRecvGen:function(q){if((q.length-q.idx)<5){NgLogE("Could not parse due to wrong argument count in KeyValue.registerCommandCb from command: "+q);return false}var l=j.parseInt(q[q.idx++]);if(l===undefined){NgLogE("Could not parse response in KeyValue.registerCommandCb from command: "+q);return false}var k=j.parseString(q[q.idx++]);if(k===undefined){NgLogE("Could not parse originalStoreKey in KeyValue.registerCommandCb from command: "+q);return false}var m=j.parseString(q[q.idx++]);if(m===undefined){NgLogE("Could not parse error in KeyValue.registerCommandCb from command: "+q);return false}var p=j.parseString(q[q.idx++]);if(p===undefined){NgLogE("Could not parse storeKey in KeyValue.registerCommandCb from command: "+q);return false}var o=j.parseInt(q[q.idx++]);if(o===undefined){NgLogE("Could not parse preloadDataCount in KeyValue.registerCommandCb from command: "+q);return false}for(var n=0;n<o;n++){h[n]=this._preloadDataRecvGen(q)}h.length=o||0;return this._registerCommandCbRecv(l,k,m,p,o,h)},_preloadDataRecvGen:function(m){if((m.length-m.idx)<2){NgLogE("Could not parse due to wrong argument count in KeyValue.preloadData from command: "+m);return false}var k=j.parseString(m[m.idx++]);if(k===undefined){NgLogE("Could not parse key in KeyValue.preloadData from command: "+m);return false}var l=j.parseString(m[m.idx++]);if(l===undefined){NgLogE("Could not parse value in KeyValue.preloadData from command: "+m);return false}return{key:k,value:l}},_getItemCommandCbRecvGen:function(q){if((q.length-q.idx)!==6){NgLogE("Could not parse due to wrong argument count in KeyValue.getItemCommandCb from command: "+q);return false}var k=j.parseInt(q[q.idx++]);if(k===undefined){NgLogE("Could not parse response in KeyValue.getItemCommandCb from command: "+q);return false}var n=j.parseString(q[q.idx++]);if(n===undefined){NgLogE("Could not parse storeKey in KeyValue.getItemCommandCb from command: "+q);return false}var p=j.parseInt(q[q.idx++]);if(p===undefined){NgLogE("Could not parse callbackId in KeyValue.getItemCommandCb from command: "+q);return false}var l=j.parseString(q[q.idx++]);if(l===undefined){NgLogE("Could not parse error in KeyValue.getItemCommandCb from command: "+q);return false}var m=j.parseString(q[q.idx++]);if(m===undefined){NgLogE("Could not parse key in KeyValue.getItemCommandCb from command: "+q);return false}var o=j.parseString(q[q.idx++]);if(o===undefined){NgLogE("Could not parse value in KeyValue.getItemCommandCb from command: "+q);return false}return this._getItemCommandCbRecv(k,n,p,l,m,o)},_setItemCommandCbRecvGen:function(q){if((q.length-q.idx)!==6){NgLogE("Could not parse due to wrong argument count in KeyValue.setItemCommandCb from command: "+q);return false}var k=j.parseInt(q[q.idx++]);if(k===undefined){NgLogE("Could not parse response in KeyValue.setItemCommandCb from command: "+q);return false}var n=j.parseString(q[q.idx++]);if(n===undefined){NgLogE("Could not parse storeKey in KeyValue.setItemCommandCb from command: "+q);return false}var p=j.parseInt(q[q.idx++]);if(p===undefined){NgLogE("Could not parse callbackId in KeyValue.setItemCommandCb from command: "+q);return false}var l=j.parseString(q[q.idx++]);if(l===undefined){NgLogE("Could not parse error in KeyValue.setItemCommandCb from command: "+q);return false}var m=j.parseString(q[q.idx++]);if(m===undefined){NgLogE("Could not parse key in KeyValue.setItemCommandCb from command: "+q);return false}var o=j.parseString(q[q.idx++]);if(o===undefined){NgLogE("Could not parse value in KeyValue.setItemCommandCb from command: "+q);return false}return this._setItemCommandCbRecv(k,n,p,l,m,o)},_removeItemCbRecvGen:function(p){if((p.length-p.idx)!==5){NgLogE("Could not parse due to wrong argument count in KeyValue.removeItemCb from command: "+p);return false}var k=j.parseInt(p[p.idx++]);if(k===undefined){NgLogE("Could not parse response in KeyValue.removeItemCb from command: "+p);return false}var n=j.parseString(p[p.idx++]);if(n===undefined){NgLogE("Could not parse storeKey in KeyValue.removeItemCb from command: "+p);return false}var o=j.parseInt(p[p.idx++]);if(o===undefined){NgLogE("Could not parse callbackId in KeyValue.removeItemCb from command: "+p);return false}var l=j.parseString(p[p.idx++]);if(l===undefined){NgLogE("Could not parse error in KeyValue.removeItemCb from command: "+p);return false}var m=j.parseString(p[p.idx++]);if(m===undefined){NgLogE("Could not parse key in KeyValue.removeItemCb from command: "+p);return false}return this._removeItemCbRecv(k,n,o,l,m)},_clearCommandCbRecvGen:function(o){if((o.length-o.idx)!==4){NgLogE("Could not parse due to wrong argument count in KeyValue.clearCommandCb from command: "+o);return false}var k=j.parseInt(o[o.idx++]);if(k===undefined){NgLogE("Could not parse response in KeyValue.clearCommandCb from command: "+o);return false}var m=j.parseString(o[o.idx++]);if(m===undefined){NgLogE("Could not parse storeKey in KeyValue.clearCommandCb from command: "+o);return false}var n=j.parseInt(o[o.idx++]);if(n===undefined){NgLogE("Could not parse callbackId in KeyValue.clearCommandCb from command: "+o);return false}var l=j.parseString(o[o.idx++]);if(l===undefined){NgLogE("Could not parse error in KeyValue.clearCommandCb from command: "+o);return false}return this._clearCommandCbRecv(k,m,n,l)},$_createSendGen:function(k){j.appendToCommandString(22282239,[+k])},_destroySendGen:function(){j.appendToCommandString(22216706,this)},_registerCommandSendGen:function(l,k){j.appendToCommandString(22216707,this,[j.encodeString(l),+k])},_getItemSendGen:function(l,m,k){j.appendToCommandString(22216708,this,[j.encodeString(l),+m,j.encodeString(k)])},_setItemSendGen:function(l,n,k,m){j.appendToCommandString(22216709,this,[j.encodeString(l),+n,j.encodeString(k),j.encodeString(m)])},_removeItemSendGen:function(l,m,k){j.appendToCommandString(22216710,this,[j.encodeString(l),+m,j.encodeString(k)])},_clearSendGen:function(k,l){j.appendToCommandString(22216711,this,[j.encodeString(k),+l])},_getItemAsyncSendGen:function(m,n,l,k){j.appendToCommandString(22216719,this,[j.encodeString(m),+n,j.encodeString(l),+k])},_setItemAsyncSendGen:function(m,o,l,n,k){j.appendToCommandString(22216720,this,[j.encodeString(m),+o,j.encodeString(l),j.encodeString(n),+k])},_removeItemAsyncSendGen:function(m,n,l,k){j.appendToCommandString(22216721,this,[j.encodeString(m),+n,j.encodeString(l),+k])},_clearAsyncSendGen:function(l,m,k){j.appendToCommandString(22216722,this,[j.encodeString(l),+m,+k])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[339]=this._instance||this;PROC_METHOD_TABLE[22216712]=this.prototype._getInstanceRecvGen;PROC_METHOD_TABLE[22216713]=this.prototype._registerCommandCbRecvGen;PROC_METHOD_TABLE[22216714]=this.prototype._preloadDataRecvGen;PROC_METHOD_TABLE[22216715]=this.prototype._getItemCommandCbRecvGen;PROC_METHOD_TABLE[22216716]=this.prototype._setItemCommandCbRecvGen;PROC_METHOD_TABLE[22216717]=this.prototype._removeItemCbRecvGen;PROC_METHOD_TABLE[22216718]=this.prototype._clearCommandCbRecvGen},collectDiagnostics:function(l,k){var m={getItem:{count:this._getItemCount},setItem:{count:this._setItemCount},removeItem:{count:this._removeItemCount}};return m}})}};__ngs._11={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var a=__ngs.r_(__ngs._1q).MessageEmitter;var b=__ngs.r_(__ngs._12).ObjectRegistry;var e=__ngs.r_(__ngs._6).Proc;c.LifecycleEmitter=a.singleton({classname:"LifecycleEmitter",initialize:function(){b.register(this);this._createSendGen(this.__objectRegistryId);this.identificationCache={};this.numEngineRequests=0},_lifecycleEventRecv:function(f){this.emit(f);this._lifecycleEventSendGen(f)},$exitProcess:function(){var f=__ngs.r_(__ngs._1k).Analytics._getPipe();f._exitingApp();this._exitProcessSendGen()},$_bgMe:function(){this.__bgMeSendGen()},$pauseGame:function(){NgLogD("+++++++++++++++++++++++++++++++++++++++++Pausing Game");this._pauseGameSendGen();var f=__ngs.r_(__ngs._g)._LocalGameList;f._pausingGame()},$resumeGame:function(){NgLogD("+++++++++++++++++++++++++++++++++++++++++Resuming Game");this._resumeGameSendGen();var f=__ngs.r_(__ngs._g)._LocalGameList;f._resumingGame()},requestEngineKeepAlive:function(g){var f=g;if(g.identification_key!==undefined){f=g.identification_key}this.identificationCache[f]=true;++this.numEngineRequests;this.incrementEngineAlive()},cancelEngineKeepAlive:function(g){var f=g;if(g.identification_key!==undefined){f=g.identification_key}if(this.identificationCache[f]){delete this.identificationCache[f];--this.numEngineRequests;this.decrementEngineAlive()}else{NgLogW("LifecycleEmitter.cancelEngineKeepAlive() Identification Key not found")}},incrementEngineAlive:function(){this._incrementEngineAliveSendGen()},decrementEngineAlive:function(){this._decrementEngineAliveSendGen()},cancelAllEngineRequests:function(){this._cancelAllEngineRequestsSendGen()},_killGameProc:function(){this.__killGameProcSendGen()},Event:{Suspend:0,Resume:1,Terminate:2,KeepAliveWillTerminate:3},_classId:334,_lifecycleEventRecvGen:function(g){if((g.length-g.idx)!==1){NgLogE("Could not parse due to wrong argument count in LifecycleEmitter.lifecycleEvent from command: "+g);return false}var f=e.parseInt(g[g.idx++]);if(f===undefined){NgLogE("Could not parse event in LifecycleEmitter.lifecycleEvent from command: "+g);return false}return this._lifecycleEventRecv(f)},$_createSendGen:function(f){e.appendToCommandString(21954559,[+f])},_lifecycleEventSendGen:function(f){e.appendToCommandString(21889026,this,[+f])},$_exitProcessSendGen:function(){e.appendToCommandString(21954557)},$_pauseGameSendGen:function(){e.appendToCommandString(21954556)},$_resumeGameSendGen:function(){e.appendToCommandString(21954555)},_incrementEngineAliveSendGen:function(){e.appendToCommandString(21889030,this)},_decrementEngineAliveSendGen:function(){e.appendToCommandString(21889031,this)},_cancelAllEngineRequestsSendGen:function(){e.appendToCommandString(21889032,this)},$__killGameProcSendGen:function(){e.appendToCommandString(21954551)},$__bgMeSendGen:function(){e.appendToCommandString(21954550)},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[334]=this._instance||this;PROC_METHOD_TABLE[21889026]=this.prototype._lifecycleEventRecvGen}})}};__ngs._12={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=__ngs.r_(__ngs._t).Class;if(typeof $APP_REQUIREPATHMAP!="undefined"){$APP_REQUIREPATHMAP["NGCore/Client/Core/ObjectRegistry.js"]=c}var a=c.ObjectRegistry=b.singleton({classname:"ObjectRegistry",initialize:function(){this._currentId=0;this._guardId=0;this._objects={}},register:function(e){if(e.__objectRegistryId){throw new Error("ObjectRegistry.register: object already registered")}var f=++this._currentId;e.__objectRegistryId=f;this._objects[f]=e},unregister:function(e){if(!e.__objectRegistryId){throw new Error("ObjectRegistry.unregister: object not registered")}var f=e.__objectRegistryId;e.__objectRegistryId=0;delete this._objects[f]},isObjectRegistered:function(e){if(e.__objectRegistryId){return true}else{return false}},isIdRegistered:function(e){if(this._objects[e]){return true}else{return false}},objectToId:function(e){var f=e.__objectRegistryId;if(!f){throw new Error("ObjectRegistry.objectToId: object not registered")}return f},idToObject:function(e){return this._objects[e]}})}};__ngs._13={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.toMD5=__ngs.r_(__ngs._45).toMD5}};__ngs._14={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var d=__ngs.r_(__ngs._6).Proc;var a=__ngs.r_(__ngs._1q).MessageEmitter;b.OrientationEmitter=a.singleton({classname:"OrientationEmitter",initialize:function(){var e=__ngs.r_(__ngs._12).ObjectRegistry;e.register(this);this._createSendGen(this.__objectRegistryId);this._lastDeviceOrientation=this.Orientation.Portrait;this._lastInterfaceOrientation=this.Orientation.Portrait},getDeviceOrientation:function(){return this._lastDeviceOrientation},getInterfaceOrientation:function(){return this._lastInterfaceOrientation},setInterfaceOrientation:function(e,f){if(!this.isInterfaceOrientation(e)){NgLogE("Unknown orientation specified: "+e);return}if(e!=this._lastInterfaceOrientation){NgLogD("setInterfaceOrientation to "+e);this._setInterfaceOrientationSendGen(e,f);this._lastInterfaceOrientation=e}},isInterfaceOrientation:function(e){return e==this.Orientation.Portrait||e==this.Orientation.PortraitUpsideDown||e==this.Orientation.LandscapeLeft||e==this.Orientation.LandscapeRight},Orientation:{Portrait:0,PortraitUpsideDown:1,LandscapeLeft:2,LandscapeRight:3,FaceUp:4,FaceDown:5},OrientationType:{Device:0,Interface:1},_orientationChangedRecv:function(e){this._lastDeviceOrientation=e;this.emit({type:this.OrientationType.Device,orientation:e});this._orientationChangedSendGen(e)},_interfaceOrientationChangedRecv:function(e){this._lastInterfaceOrientation=e;this.emit({type:this.OrientationType.Interface,orientation:e});this._interfaceOrientationChangedSendGen(e)},_classId:335,_orientationChangedRecvGen:function(f){if((f.length-f.idx)!==1){NgLogE("Could not parse due to wrong argument count in OrientationEmitter.orientationChanged from command: "+f);return false}var e=d.parseInt(f[f.idx++]);if(e===undefined){NgLogE("Could not parse orientation in OrientationEmitter.orientationChanged from command: "+f);return false}return this._orientationChangedRecv(e)},_interfaceOrientationChangedRecvGen:function(f){if((f.length-f.idx)!==1){NgLogE("Could not parse due to wrong argument count in OrientationEmitter.interfaceOrientationChanged from command: "+f);return false}var e=d.parseInt(f[f.idx++]);if(e===undefined){NgLogE("Could not parse orientation in OrientationEmitter.interfaceOrientationChanged from command: "+f);return false}return this._interfaceOrientationChangedRecv(e)},$_createSendGen:function(e){d.appendToCommandString(22020095,[+e])},_orientationChangedSendGen:function(e){d.appendToCommandString(21954562,this,[+e])},_setInterfaceOrientationSendGen:function(e,f){d.appendToCommandString(21954563,this,[+e,(f?1:0)])},_interfaceOrientationChangedSendGen:function(e){d.appendToCommandString(21954564,this,[+e])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[335]=this._instance||this;PROC_METHOD_TABLE[21954562]=this.prototype._orientationChangedRecvGen;PROC_METHOD_TABLE[21954564]=this.prototype._interfaceOrientationChangedRecvGen}})}};__ngs._15={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var e=__ngs.r_(__ngs._6).Proc;var a=__ngs.r_(__ngs._1q).MessageEmitter;var b=__ngs.r_(__ngs._t).Class;c.LocationEmitter=a.singleton({classname:"LocationEmitter",Accuracy:{LOW:0,MEDIUM:1,HIGH:2},Elements:{LATITUDE:1,LONGITUDE:2,ALTITUDE:4,HEADING:8},initialize:function(){var f=__ngs.r_(__ngs._12).ObjectRegistry;f.register(this);this._createSendGen(this.__objectRegistryId);this._lastLocation=undefined;this._forceListeners=[];this.elements=this.Elements.LATITUDE|this.Elements.LONGITUDE|this.Elements.ALTITUDE|this.Elements.HEADING},setProperties:function(g,f){if(typeof g!="number"){g=this.Accuracy.HIGH}if(!f){f=this.Elements.LATITUDE|this.Elements.LONGITUDE|this.Elements.ALTITUDE|this.Elements.HEADING}this.accuracy=g;this.elements=f;this._setPropertiesSendGen(g,f)},addListener:function($super,h,g,j,f){if(j===undefined){this._startUpdatingSendGen(true);this._forceListeners.push(h)}else{this._startUpdatingSendGen(j);if(j===true){this._forceListeners.push(h)}}$super(h,g,f)},removeListener:function($super,g){$super(g);var f=this._forceListeners.indexOf(g);if(f!=-1){this._forceListeners.splice(f,1);if(this._forceListeners.length===0){this._stopUpdatingSendGen()}}},getLastLocation:function(){if(this._lastLocation===undefined||!this._lastLocation.getPosition()){return undefined}return this._lastLocation},_locationUpdatedRecv:function(j,l,h,f,k){var g=__ngs.r_(__ngs._1n).Point;this._lastLocation=new this.Location(new g(l,h),f,this._lastLocation?this._lastLocation.getHeading():undefined,k,j);this.emit(this._lastLocation)},_headingUpdatedRecv:function(h,f,g,j){if((this.elements&this.Elements.HEADING)===0){return}this._lastLocation=new this.Location(this._lastLocation?this._lastLocation.getPosition():undefined,this._lastLocation?this._lastLocation.getAltitude():undefined,f,this._lastLocation?this._lastLocation.getAccuracy():undefined,h);if(f){this.emit(this._lastLocation)}},Location:b.subclass({classname:"Location",initialize:function(g,f,k,j,h){this._position=g;this._altitude=f;this._accuracy=j;this._heading=k;this._timestamp=h},getPosition:function(){return this._position},getAltitude:function(){return this._altitude},getHeading:function(){return this._heading},getAccuracy:function(){return this._accuracy},getTimestamp:function(){return this._timestamp}}),_classId:333,_locationUpdatedRecvGen:function(j){if((j.length-j.idx)!==5){NgLogE("Could not parse due to wrong argument count in LocationEmitter.locationUpdated from command: "+j);return false}var h=e.parseInt(j[j.idx++]);if(h===undefined){NgLogE("Could not parse timestamp in LocationEmitter.locationUpdated from command: "+j);return false}var l=e.parseFloat(j[j.idx++]);if(l===undefined){NgLogE("Could not parse latitude in LocationEmitter.locationUpdated from command: "+j);return false}var g=e.parseFloat(j[j.idx++]);if(g===undefined){NgLogE("Could not parse longitude in LocationEmitter.locationUpdated from command: "+j);return false}var f=e.parseFloat(j[j.idx++]);if(f===undefined){NgLogE("Could not parse altitude in LocationEmitter.locationUpdated from command: "+j);return false}var k=e.parseFloat(j[j.idx++]);if(k===undefined){NgLogE("Could not parse accuracy in LocationEmitter.locationUpdated from command: "+j);return false}return this._locationUpdatedRecv(h,l,g,f,k)},_headingUpdatedRecvGen:function(j){if((j.length-j.idx)!==4){NgLogE("Could not parse due to wrong argument count in LocationEmitter.headingUpdated from command: "+j);return false}var h=e.parseInt(j[j.idx++]);if(h===undefined){NgLogE("Could not parse timestamp in LocationEmitter.headingUpdated from command: "+j);return false}var f=e.parseFloat(j[j.idx++]);if(f===undefined){NgLogE("Could not parse magneticHeading in LocationEmitter.headingUpdated from command: "+j);return false}var g=e.parseFloat(j[j.idx++]);if(g===undefined){NgLogE("Could not parse trueHeading in LocationEmitter.headingUpdated from command: "+j);return false}var k=e.parseFloat(j[j.idx++]);if(k===undefined){NgLogE("Could not parse accuracy in LocationEmitter.headingUpdated from command: "+j);return false}return this._headingUpdatedRecv(h,f,g,k)},$_createSendGen:function(f){e.appendToCommandString(21889023,[+f])},_destroySendGen:function(){e.appendToCommandString(21823490,this)},_startUpdatingLocationSendGen:function(g,f){e.appendToCommandString(21823491,this,[+g,+f])},_stopUpdatingLocationSendGen:function(){e.appendToCommandString(21823492,this)},_locationUpdatedSendGen:function(h,k,g,f,j){e.appendToCommandString(21823493,this,[+h,+k,+g,+f,+j])},_startUpdatingHeadingSendGen:function(f,g){e.appendToCommandString(21823494,this,[+f,+g])},_stopUpdatingHeadingSendGen:function(){e.appendToCommandString(21823495,this)},_headingUpdatedSendGen:function(h,f,g,j){e.appendToCommandString(21823496,this,[+h,+f,+g,+j])},_setPropertiesSendGen:function(g,f){e.appendToCommandString(21823497,this,[+g,+f])},_startUpdatingSendGen:function(f){e.appendToCommandString(21823498,this,[(f?1:0)])},_stopUpdatingSendGen:function(){e.appendToCommandString(21823499,this)},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[333]=this._instance||this;PROC_METHOD_TABLE[21823493]=this.prototype._locationUpdatedRecvGen;PROC_METHOD_TABLE[21823496]=this.prototype._headingUpdatedRecvGen}})}};__ngs._16={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var d=__ngs.r_(__ngs._6).Proc;var a=__ngs.r_(__ngs._1q).MessageEmitter;b.MemoryEmitter=a.singleton({classname:"MemoryEmitter",initialize:function(){var e=__ngs.r_(__ngs._12).ObjectRegistry;e.register(this);this._createSendGen(this.__objectRegistryId);this._summaryStatisticsEmitter=null;this._summaryStatisticsOption=this.StatisticsOption.common;this._summaryStatisticsInterval=1000},_memoryEventRecv:function(){this.emit();this._memoryEventSendGen()},StatisticsOption:{common:1,raw:2},setSummaryStatisticsOption:function(e){this._summaryStatisticsOption=e;if(this._summaryStatisticsEmitter){this._enableSummaryStatisticsSendGen(this._summaryStatisticsOption,this._summaryStatisticsInterval)}},setSummaryStatisticsInterval:function(e){this._summaryStatisticsInterval=e;if(this._summaryStatisticsEmitter){this._enableSummaryStatisticsSendGen(this._summaryStatisticsOption,this._summaryStatisticsInterval)}},addSummaryStatisticsListener:function(f,g,e){if(!this._summaryStatisticsEmitter){this._summaryStatisticsEmitter=new a()}this._summaryStatisticsEmitter.addListener(f,g,e);if(this._summaryStatisticsEmitter.getListenerCount()==1){this._enableSummaryStatisticsSendGen(this._summaryStatisticsOption,this._summaryStatisticsInterval)}},removeSummaryStatisticsListener:function(e){if(this._summaryStatisticsEmitter){this._summaryStatisticsEmitter.removeListener(e);if(this._summaryStatisticsEmitter.getListenerCount()===0){this._enableSummaryStatisticsSendGen(0,0);this._summaryStatisticsEmitter=null}}else{NgLogD("removeRealtimeSummaryStatisticsListener: memoryEmitter does not exist")}},_statisticsRecv:function(f){if(this._summaryStatisticsEmitter){try{this._summaryStatisticsEmitter.emit(JSON.parse(f)||{})}catch(g){NgLogE("_statisticsRecv: error occured while parsing JSON");return}}},_classId:331,_memoryEventRecvGen:function(e){if((e.length-e.idx)!==0){NgLogE("Could not parse due to wrong argument count in MemoryEmitter.memoryEvent from command: "+e);return false}return this._memoryEventRecv()},_statisticsRecvGen:function(f){if((f.length-f.idx)!==1){NgLogE("Could not parse due to wrong argument count in MemoryEmitter.statistics from command: "+f);return false}var e=d.parseString(f[f.idx++]);if(e===undefined){NgLogE("Could not parse data in MemoryEmitter.statistics from command: "+f);return false}return this._statisticsRecv(e)},$_createSendGen:function(e){d.appendToCommandString(21757951,[+e])},_memoryEventSendGen:function(){d.appendToCommandString(21692418,this)},_enableSummaryStatisticsSendGen:function(f,e){d.appendToCommandString(21692419,this,[+f,+e])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[331]=this._instance||this;PROC_METHOD_TABLE[21692418]=this.prototype._memoryEventRecvGen;PROC_METHOD_TABLE[21692420]=this.prototype._statisticsRecvGen}})}};__ngs._17={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var e=__ngs.r_(__ngs._6).Proc;var a=__ngs.r_(__ngs._1q).MessageEmitter;var b=__ngs.r_(__ngs._t).Class;c.MotionEmitter=a.singleton({classname:"MotionEmitter",initialize:function(){var f=__ngs.r_(__ngs._12).ObjectRegistry;f.register(this);this._createSendGen(this.__objectRegistryId);this._lastAccel=null;this._lastGyro=null;this._lastCompass=null},Motion:b.subclass({classname:"Motion",initialize:function(f,g,h){this._accel=f;this._gyro=g;this._compass=h},getAccelData:function(){return this._accel},getGyroData:function(){return this._gyro},getCompassData:function(){return this._compass}}),addListener:function($super,h,g,f){if(this.getListenerCount()===0){this._startMotionSendGen()}$super(h,g,f)},removeListener:function($super,f){$super(f);if(this.getListenerCount()===0){this._stopMotionSendGen()}},_emitMotion:function(){var f=new Device.MotionEmitter.Motion(this._lastAccel,this._lastGyro,this._lastCompass);this.emit(f)},_accelChangedRecv:function(f,h,g){this._lastAccel={x:f,y:h,z:g};this._emitMotion();this._accelChangedSendGen(f,h,g)},_gyroChangedRecv:function(f,h,g){this._lastGyro={x:f,y:h,z:g};this._emitMotion();this._gyroChangedSendGen(f,h,g)},_magneticChangedRecv:function(f,h,g){this._lastCompass={x:f,y:h,z:g};this._emitMotion();this._magneticChangedSendGen(f,h,g)},useCommonAccelerometerMode:function(f){this._useCommonAccelerometerModeSendGen(f)},_classId:330,_accelChangedRecvGen:function(g){if((g.length-g.idx)!==3){NgLogE("Could not parse due to wrong argument count in MotionEmitter.accelChanged from command: "+g);return false}var f=e.parseFloat(g[g.idx++]);if(f===undefined){NgLogE("Could not parse x in MotionEmitter.accelChanged from command: "+g);return false}var j=e.parseFloat(g[g.idx++]);if(j===undefined){NgLogE("Could not parse y in MotionEmitter.accelChanged from command: "+g);return false}var h=e.parseFloat(g[g.idx++]);if(h===undefined){NgLogE("Could not parse z in MotionEmitter.accelChanged from command: "+g);return false}return this._accelChangedRecv(f,j,h)},_gyroChangedRecvGen:function(g){if((g.length-g.idx)!==3){NgLogE("Could not parse due to wrong argument count in MotionEmitter.gyroChanged from command: "+g);return false}var f=e.parseFloat(g[g.idx++]);if(f===undefined){NgLogE("Could not parse x in MotionEmitter.gyroChanged from command: "+g);return false}var j=e.parseFloat(g[g.idx++]);if(j===undefined){NgLogE("Could not parse y in MotionEmitter.gyroChanged from command: "+g);return false}var h=e.parseFloat(g[g.idx++]);if(h===undefined){NgLogE("Could not parse z in MotionEmitter.gyroChanged from command: "+g);return false}return this._gyroChangedRecv(f,j,h)},_magneticChangedRecvGen:function(g){if((g.length-g.idx)!==3){NgLogE("Could not parse due to wrong argument count in MotionEmitter.magneticChanged from command: "+g);return false}var f=e.parseFloat(g[g.idx++]);if(f===undefined){NgLogE("Could not parse x in MotionEmitter.magneticChanged from command: "+g);return false}var j=e.parseFloat(g[g.idx++]);if(j===undefined){NgLogE("Could not parse y in MotionEmitter.magneticChanged from command: "+g);return false}var h=e.parseFloat(g[g.idx++]);if(h===undefined){NgLogE("Could not parse z in MotionEmitter.magneticChanged from command: "+g);return false}return this._magneticChangedRecv(f,j,h)},$_createSendGen:function(f){e.appendToCommandString(21692415,[+f])},_accelChangedSendGen:function(f,h,g){e.appendToCommandString(21626882,this,[+f,+h,+g])},_gyroChangedSendGen:function(f,h,g){e.appendToCommandString(21626883,this,[+f,+h,+g])},_magneticChangedSendGen:function(f,h,g){e.appendToCommandString(21626884,this,[+f,+h,+g])},_startMotionSendGen:function(){e.appendToCommandString(21626885,this)},_stopMotionSendGen:function(){e.appendToCommandString(21626886,this)},_useCommonAccelerometerModeSendGen:function(f){e.appendToCommandString(21626887,this,[(f?1:0)])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[330]=this._instance||this;PROC_METHOD_TABLE[21626882]=this.prototype._accelChangedRecvGen;PROC_METHOD_TABLE[21626883]=this.prototype._gyroChangedRecvGen;PROC_METHOD_TABLE[21626884]=this.prototype._magneticChangedRecvGen}})}};__ngs._18={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var d=__ngs.r_(__ngs._6).Proc;var a=__ngs.r_(__ngs._1q).MessageEmitter;b.NetworkEmitter=a.singleton({classname:"NetworkEmitter",initialize:function(){var e=__ngs.r_(__ngs._12).ObjectRegistry;e.register(this);this._createSendGen(this.__objectRegistryId);this._lastStatus=null;this._perfEmitter=null;this._connEmitter=null;this._minRate=5*1024;this._duration=5000;this._samples=[];this._sum=0;this._unconformFor=0;this._lastSampleAt=0;this._maxConnTime=5000},getLastStatus:function(){return this._lastStatus},Status:{None:0,Cellular:1,Wifi:2},_flags:{enable:1},addPerformanceListener:function(g,e,f){if(!this._perfEmitter){this._perfEmitter=new a()}this._perfEmitter.addListener(g,e,f);NgLogD("addPerformanceListener: count="+this._perfEmitter.getListenerCount());if(this._perfEmitter.getListenerCount()==1){this._enablePerfEmitterSendGen(this._flags.enable,this._minRate,this._duration)}},removePerformanceListener:function(e){if(this._perfEmitter){this._perfEmitter.removeListener(e);NgLogD("removePerformanceListener: count="+this._perfEmitter.getListenerCount());if(this._perfEmitter.getListenerCount()===0){this._enablePerfEmitterSendGen(0,0,0);this._perfEmitter=null}}else{NgLogD("removePerformanceListener: perf-emitter does not exist")}},getPerformanceListenerCount:function(){if(this._perfEmitter){return this._perfEmitter.getListenerCount()}return 0},addConnectionListener:function(f,g,e){if(!this._connEmitter){this._connEmitter=new a()}this._connEmitter.addListener(f,g,e);NgLogD("addConnectionListener: count="+this._connEmitter.getListenerCount());if(this._connEmitter.getListenerCount()==1){this._enableConnEmitterSendGen(this._flags.enable,this._maxConnTime)}},removeConnectionListener:function(e){if(this._connEmitter){this._connEmitter.removeListener(e);NgLogD("removeConnectionListener: count="+this._connEmitter.getListenerCount());if(this._connEmitter.getListenerCount()===0){this._enableConnEmitterSendGen(0,0);this._connEmitter=null}}else{NgLogD("removeConnectionListener: already removed")}},getConnectionListenerCount:function(){if(this._connEmitter){return this._connEmitter.getListenerCount()}return 0},setPerformanceThreshold:function(e){if(e.minRate){this._minRate=e.minRate}if(e.duration){this._duration=e.duration}if(this._perfEmitter){this._enablePerfEmitterSendGen(this._flags.enable,this._minRate,this._duration)}},setConnectionThreshold:function(e){if(e.maxConnTime){this._maxConnTime=e.maxConnTime}if(this._connEmitter){this._enableConnEmitterSendGen(this._flags.enable,this._maxConnTime)}},_statusChangedRecv:function(e){this._lastStatus=e;this.emit(e)},_activityRecv:function(j,r,q,e,s,p,l,h){var n=__ngs.r_(__ngs._1r).Time;var f=n.getRealTime();if(r==e||!r){if(f-this._lastSampleAt>=this._duration){this._samples=[];this._sum=0;this._unconformFor=0}}if(r>0){var k=0;if(this._samples.length==150){k=this._samples.shift();if(this._sum>=k){this._sum-=k}}var g=n.getFrameDelta();var m=(p+l)/(g/1000);this._samples.push(m);this._sum+=m;this._lastSampleAt=f;var o=this._sum/this._samples.length;if(o<this._minRate){this._unconformFor+=g;if(this._unconformFor>=this._duration){if(this._perfEmitter){this._unconformFor=0;this._perfEmitter.emit({actReqs:j,actConns:r,aveRate:o})}}}else{this._unconformFor=0}}if(h>=this._maxConnTime){if(this._connEmitter){this._connEmitter.emit(h)}}},_classId:336,_statusChangedRecvGen:function(f){if((f.length-f.idx)!==1){NgLogE("Could not parse due to wrong argument count in NetworkEmitter.statusChanged from command: "+f);return false}var e=d.parseInt(f[f.idx++]);if(e===undefined){NgLogE("Could not parse status in NetworkEmitter.statusChanged from command: "+f);return false}return this._statusChangedRecv(e)},_activityRecvGen:function(h){if((h.length-h.idx)!==8){NgLogE("Could not parse due to wrong argument count in NetworkEmitter.activity from command: "+h);return false}var e=d.parseInt(h[h.idx++]);if(e===undefined){NgLogE("Could not parse numActiveReqs in NetworkEmitter.activity from command: "+h);return false}var j=d.parseInt(h[h.idx++]);if(j===undefined){NgLogE("Could not parse numActiveConns in NetworkEmitter.activity from command: "+h);return false}var n=d.parseInt(h[h.idx++]);if(n===undefined){NgLogE("Could not parse numOpens in NetworkEmitter.activity from command: "+h);return false}var f=d.parseInt(h[h.idx++]);if(f===undefined){NgLogE("Could not parse numConns in NetworkEmitter.activity from command: "+h);return false}var m=d.parseInt(h[h.idx++]);if(m===undefined){NgLogE("Could not parse numCloses in NetworkEmitter.activity from command: "+h);return false}var l=d.parseInt(h[h.idx++]);if(l===undefined){NgLogE("Could not parse bytesSent in NetworkEmitter.activity from command: "+h);return false}var k=d.parseInt(h[h.idx++]);if(k===undefined){NgLogE("Could not parse bytesRcvd in NetworkEmitter.activity from command: "+h);return false}var g=d.parseInt(h[h.idx++]);if(g===undefined){NgLogE("Could not parse maxConnTime in NetworkEmitter.activity from command: "+h);return false}return this._activityRecv(e,j,n,f,m,l,k,g)},$_createSendGen:function(e){d.appendToCommandString(22085631,[+e])},_enablePerfEmitterSendGen:function(e,g,f){d.appendToCommandString(22020100,this,[+e,+g,+f])},_enableConnEmitterSendGen:function(e,f){d.appendToCommandString(22020101,this,[+e,+f])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[336]=this._instance||this;PROC_METHOD_TABLE[22020098]=this.prototype._statusChangedRecvGen;PROC_METHOD_TABLE[22020099]=this.prototype._activityRecvGen}})}};__ngs._19={_c:null,_d:function(){var g={exports:{}};var c=g.exports;this._c=g;var h=__ngs.r_(__ngs._6).Proc;var b=__ngs.r_(__ngs._12).ObjectRegistry;var a=__ngs.r_(__ngs._1q).MessageEmitter;var f=__ngs.r_(__ngs._w).MessageListener;var e=__ngs.r_(__ngs._17).MotionEmitter;var d=f.subclass({onUpdate:function(){}});c.ShakeEmitter=a.singleton({classname:"ShakeEmitter",initialize:function(){b.register(this);this._createSendGen(this.__objectRegistryId);this._proxyListener=new d()},addListener:function($super,l,k,j){if(this.getListenerCount()===0){e.addListener(this._proxyListener,function(){})}$super(l,k,j)},removeListener:function($super,j){$super(j);if(this.getListenerCount()===0){e.removeListener(this._proxyListener)}},vibrate:function(){this._vibrateSendGen()},_shakeRecv:function(){this.emit();this._shakeSendGen()},_classId:332,_shakeRecvGen:function(j){if((j.length-j.idx)!==0){NgLogE("Could not parse due to wrong argument count in ShakeEmitter.shake from command: "+j);return false}return this._shakeRecv()},$_createSendGen:function(j){h.appendToCommandString(21823487,[+j])},_shakeSendGen:function(){h.appendToCommandString(21757954,this)},$_vibrateSendGen:function(){h.appendToCommandString(21823485)},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[332]=this._instance||this;PROC_METHOD_TABLE[21757954]=this.prototype._shakeRecvGen}})}};__ngs._1a={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var f=__ngs.r_(__ngs._6).Proc;var b=__ngs.r_(__ngs._1q).MessageEmitter;var c=__ngs.r_(__ngs._t).Class;var a=null;d.KeyEmitter=b.singleton({classname:"KeyEmitter",initialize:function(){var g=__ngs.r_(__ngs._12).ObjectRegistry;g.register(this);this._createSendGen(this.__objectRegistryId)},keyCodeToSymbol:function(h){if(!a){a={};for(var g in this.Keycode){a[this.Keycode[g]]=g}}return a[h]||""},KeyEvent:c.subclass({classname:"KeyEvent",initialize:function(h,g,j){this.type=h;this.modifiers=g;this.code=j}}),_onKeyEventRecv:function(h,g,j){var k=new Device.KeyEmitter.KeyEvent(h,g,j);if(!this.chain(k)){this._onKeyEventSendGen(h,g,j)}},EventType:{onUp:0,onDown:1},Modifier:{NONE:0,SYMBOL:1<<0,ALT:1<<1,ALT_LEFT:1<<2,ALT_RIGHT:1<<3,SHIFT:1<<4,SHIFT_LEFT:1<<5,SHIFT_RIGHT:1<<6},Keycode:{a:29,b:30,c:31,d:32,e:33,f:34,g:35,h:36,i:37,j:38,k:39,l:40,m:41,n:42,o:43,p:44,q:45,r:46,s:47,t:48,u:49,v:50,w:51,x:52,y:53,z:54,up:19,down:20,left:21,right:22,enter:66,backspace:67,back:4,backunhandled:84,menu:82},_classId:343,_onKeyEventRecvGen:function(k){if((k.length-k.idx)!==3){NgLogE("Could not parse due to wrong argument count in KeyEmitter.onKeyEvent from command: "+k);return false}var h=f.parseInt(k[k.idx++]);if(h===undefined){NgLogE("Could not parse type in KeyEmitter.onKeyEvent from command: "+k);return false}var g=f.parseInt(k[k.idx++]);if(g===undefined){NgLogE("Could not parse modifiers in KeyEmitter.onKeyEvent from command: "+k);return false}var j=f.parseInt(k[k.idx++]);if(j===undefined){NgLogE("Could not parse code in KeyEmitter.onKeyEvent from command: "+k);return false}return this._onKeyEventRecv(h,g,j)},$_createSendGen:function(g){f.appendToCommandString(22544383,[+g])},_onKeyEventSendGen:function(h,g,j){f.appendToCommandString(22478850,this,[+h,+g,+j])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[343]=this._instance||this;PROC_METHOD_TABLE[22478850]=this.prototype._onKeyEventRecvGen}})}};__ngs._1b={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var d=__ngs.r_(__ngs._5).Core;var c=__ngs.r_(__ngs._6).Proc;a.PushNotificationEmitter=d.MessageEmitter.singleton({classname:"PushNotificationEmitter",initialize:function(){d.ObjectRegistry.register(this);this._createSendGen(this.__objectRegistryId)},_onPushNotificationRecv:function(e){this._lastMsgPayload=e;if(!this.chain(e)){this._onPushNotificationSendGen(e)}},_classId:345,_onPushNotificationRecvGen:function(f){if((f.length-f.idx)!==1){NgLogE("Could not parse due to wrong argument count in PushNotificationEmitter.onPushNotification from command: "+f);return false}var e=c.parseString(f[f.idx++]);if(e===undefined){NgLogE("Could not parse msgPayload in PushNotificationEmitter.onPushNotification from command: "+f);return false}return this._onPushNotificationRecv(e)},$_createSendGen:function(e){c.appendToCommandString(22675455,[+e])},_onPushNotificationSendGen:function(e){c.appendToCommandString(22609922,this,[c.encodeString(e)])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[345]=this._instance||this;PROC_METHOD_TABLE[22609922]=this.prototype._onPushNotificationRecvGen}})}};__ngs._1c={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var d=__ngs.r_(__ngs._5).Core;var c=__ngs.r_(__ngs._6).Proc;a.InAppPurchaseEmitter=d.MessageEmitter.singleton({classname:"InAppPurchaseEmitter",initialize:function(){d.ObjectRegistry.register(this);this._createSendGen(this.__objectRegistryId)},_onPurchaseEventRecv:function(e,f,g){if(!this.chain(e,f,g)){this._onPurchaseEventSendGen(e,f,g)}},_classId:347,_onPurchaseEventRecvGen:function(g){if((g.length-g.idx)!==3){NgLogE("Could not parse due to wrong argument count in InAppPurchaseEmitter.onPurchaseEvent from command: "+g);return false}var e=c.parseString(g[g.idx++]);if(e===undefined){NgLogE("Could not parse err in InAppPurchaseEmitter.onPurchaseEvent from command: "+g);return false}var f=c.parseString(g[g.idx++]);if(f===undefined){NgLogE("Could not parse data in InAppPurchaseEmitter.onPurchaseEvent from command: "+g);return false}var h=c.parseString(g[g.idx++]);if(h===undefined){NgLogE("Could not parse verificationToken in InAppPurchaseEmitter.onPurchaseEvent from command: "+g);return false}return this._onPurchaseEventRecv(e,f,h)},$_createSendGen:function(e){c.appendToCommandString(22806527,[+e])},_onPurchaseEventSendGen:function(e,f,g){c.appendToCommandString(22740994,this,[c.encodeString(e),c.encodeString(f),c.encodeString(g)])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[347]=this._instance||this;PROC_METHOD_TABLE[22740994]=this.prototype._onPurchaseEventRecvGen}})}};__ngs._1d={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var f=__ngs.r_(__ngs._6).Proc;var b=__ngs.r_(__ngs._t).Class;var a=__ngs.r_(__ngs._1k).Analytics;var e=__ngs.r_(__ngs._4);var g=__ngs.r_(__ngs._8).Localization;c.InAppPurchase=b.singleton({classname:"InAppPurchase",initialize:function(){Core.ObjectRegistry.register(this);this._createSendGen(this.__objectRegistryId)},initService:function(n,m,j){NgLogD("initService called");if(this._iapInited){NgLogD("initService has been called");return}if((!this._isIOS())&&(!this._isAndroid())){NgLogE("ERROR: Neither Android nor iOS platform, IAP will not work");m();return}this._initDonecb=m;this._initOrdercb=n;if(j){var l=JSON.parse(j);if(l.service==="boku"){this._paymentProvider="boku"}}if(!this._iapInited){var k=Core.MessageListener.subclass({onPurchaseEvent:this._iapCallback.bind(this)});this.listener=new k();e.Device.InAppPurchaseEmitter.addListener(this.listener,this.listener.onPurchaseEvent)}if(this._isAndroid()){this._iapCallback("morenonces","","");var h=this;Storage.KeyValueCache.local.getItem(this._IAB_ORPHANED,{},function(q,p){NgLogD("_iap getting orphaned order callback");if(p){var o=JSON.parse(p);NgLogD("_iap restoring order");h._restoreOrder(o,j)}else{NgLogD("_iap initService 0");h._initService(j)}})}else{NgLogD("_iap initService 1");this._initService(j)}},launchPurchaseView:function(l,m,j,o,n,k){if(!this._iapInited){a.reportGameEvent("MobaIAPInitFailed");NgLogE("ERROR: function initService must be called and its donecb called back, before launchPurchaseView may be used.");o(false,"failed:initservice_not_done");return}this._currentOrderProductID=l;this._currentOrderCancelcb=n;this._currentOrderFailcb=o;this._currentOrderPurchasecb=j;if(m!==1&&this._isAndroid()){o(false,"failed:unsupported_quantity");a.reportGameEvent("MobaIAPInvalidQuantity");return}if(this._isIOS()||this._isAndroid()){e.Device.InAppPurchase._requestPurchase(l,m,k);return}var h=Core.Capabilities;a.reportGameEvent("MobaIAPUnsupportPlatorm"+h.getPlatformOS());NgLogE("launchPurchaseView failed: only Android and iOS platforms are currently supported.");o(false,"failed:unsupported_platform");return},pushSingleNonce:function(j){var h=[];h.push(j);this._fillIABNoncePool(JSON.stringify(h))},getProductInformation:function(h,j){this._getProductInformationCB=j;this._getProductInformationSendGen(h)},getProductSetInfo:function(h,j){this._getProductSetInfoCB=j;this._getProductSetInfoSendGen(h)},_IAB_PURCHASED:0,_IAB_CANCELED:1,_IAB_REFUNDED:2,_IAB_ORPHANED:"com.ngmoco.in_app_purchase.iab_orphaned_orders",_capIsAndroid:undefined,_capIsIOS:undefined,_currentOrderCancelcb:undefined,_currentOrderFailcb:undefined,_currentOrderProductID:undefined,_currentOrderPurchasecb:undefined,_initDonecb:undefined,_initOrdercb:undefined,_iapInited:false,_generateIABNonce:function(){var k=new Date().getTime();var j=Math.floor(Math.random()*1000);var h=(k*1000)+j;NgLogD("Generated nonce: "+h);return h},_iapCallback:function(m,n,h){NgLogD("8 _iapCallback with err: "+m+" data: "+n+" verficationToken: "+h);if(m=="morenonces"){var p=10;var u=[];while(u.length<p){u.push(this._generateIABNonce())}this._fillIABNoncePool(JSON.stringify(u));return true}if((m=="initdone")||(m=="initcheckdone")){if(typeof this._initDonecb=="function"){this._iapInited=true;this._initDonecb();NgLogD("_iap initService Done")}else{NgLogW("WARN: "+m+" callback with empty donecb")}return true}if(m=="getProductInformationDone"){if(n&&n.length>0){var j=JSON.parse(n);try{this._productInformationExtras=JSON.parse(h)}catch(q){NgLogE("Error parsing Product Information")}this._getProductInformationCB(j.productId)}else{this._getProductInformationCB("","no information on this product")}this._getProductInformationCB=undefined;delete this._productInformationExtras;return true}if(m=="getProductSetInfoDone"){this._getProductSetInfoCB(n);this._getProductSetInfoCB=undefined;return true}var k;var o="";var s,t;if(n&&n.length>0){s=JSON.parse(n);if((s.orders)&&(s.orders.length>0)){this._dumpOrderIds(s.orders);k=s.orders[0].orderId;if(this._isAndroid()&&(!this._currentOrderPurchasecb)){var l=s.orders[0];t={data:n,signature:h};l.receipt=JSON.stringify(t);if(!l.receipt){a.reportGameEvent("NGNILRECEIPT2")}this._initOrdercb(l.productId,l.orderId,l.receipt);return true}}}if(m&&m.length>0){if(m=="cancelled"){if((typeof this._currentOrderCancelcb)=="function"){this._currentOrderCancelcb();this._currentOrderCancelcb=undefined}else{a.reportGameEvent("MobaIAPERR02")}}else{if(m){NgLogD("DEBUG: iapCallback: got error: "+m)}else{NgLogD("DEBUG: iapCallback: got canceled purchaseState.")}if((typeof this._currentOrderFailcb)=="function"){this._currentOrderFailcb(false,m);this._currentOrderFailcb=undefined}else{a.reportGameEvent("MobaIAPERR01")}}return true}if((typeof this._currentOrderPurchasecb)=="function"){var r=h;if(this._isAndroid()){t={data:n,signature:h};r=JSON.stringify(t)}if(!r){a.reportGameEvent("NGNILRECEIPT")}this._currentOrderPurchasecb(o,k,r);this._currentOrderPurchasecb=undefined}else{if((!this._iapInited)&&((typeof this._initOrdercb)=="function")){this._initOrdercb(o,k,h)}else{a.reportGameEvent("MobaIAPERR04")}}return true},_isAndroid:function(){if(typeof this._capIsAndroid!="undefined"){return this._capIsAndroid}var h=Core.Capabilities;if((typeof h.getPlatformOS()!="undefined")&&(h.getPlatformOS().toLowerCase()=="android")){this._capIsAndroid=true}else{this._capIsAndroid=false}return this._capIsAndroid},_isIOS:function(){if(typeof this._capIsIOS!="undefined"){return this._capIsIOS}var h=Core.Capabilities;if((typeof h.getPlatformOS()!="undefined")&&(h.getPlatformOS().toLowerCase()=="iphone os")){this._capIsIOS=true}else{this._capIsIOS=false}return this._capIsIOS},_fillIABNoncePool:function(h){this._fillIABNoncePoolSendGen(h)},_dumpOrderIds:function(k){for(var j=0;j<k.length;j++){var h=k[j];a.reportGameEvent("NGIABRECEIVED",{orderId:h.orderId})}},_filterSuccessOrders:function(l,o,m){var h=[];for(var k in l.orders){if(l.orders[k].purchaseState===this._IAB_PURCHASED){var n=l.orders[k];if(this._isAndroid()){var j={data:m,signature:o};n.receipt=JSON.stringify(j)}else{n.verificationToken=o}h.push(n)}else{this._sendOrderProcessedAck(l.orders[k].notificationId);NgLogD("Sending ACK to google for filterorders")}}NgLogD("successOrders length = "+h.length);return h},_persistOrphanedOrders:function(h){Storage.KeyValueCache.local.getItem(this._IAB_ORPHANED,{},(function(l,s){if(s&&(s.length>0)){var m=JSON.parse(s);for(var q in m){var k=m[q];var n=false;for(var j in h){var r=h[j];if(r.orderId===k.orderId){n=true;break}}if(!n){h.push(m[q])}}}var p=JSON.stringify(h);Storage.KeyValueCache.local.setItem(this._IAB_ORPHANED,p,{},function(){NgLogD("Orphaned orders added to persistent store: "+p);NgLogD("Number of orders: "+h.length)})}).bind(this))},_initService:function(h){if(h){a.reportGameEvent("MobaIAPERR06");this._initService2SendGen(h)}else{NgLogD("_iap calling initServiceSendGen");this._initServiceSendGen()}},_requestPurchase:function(k,j,h){if(h){this._requestPurchase2SendGen(k,j,h)}else{this._requestPurchaseSendGen(k,j)}},_sendOrderProcessedAck:function(j,h){NgLogD("sending ACK to Google with orderId: "+h);a.reportGameEvent("MobaIABACK",{orderId:h});this._sendOrderProcessedAckSendGen(j)},_restoreOrder:function(h,k){var j=this;if(this._isAndroid()){this._initOrdercb(h.productId,h.orderId,h.receipt,h)}else{this._initOrdercb(h.productId,h.orderId,h.verificationToken,h)}Storage.KeyValueCache.local.removeItem(this._IAB_ORPHANED,{},function(){NgLogD("_iap removeItem callback");NgLogD("_iap initService 2");j._initService(k)})},_classId:348,$_createSendGen:function(h){f.appendToCommandString(22872063,[+h])},_initServiceSendGen:function(){f.appendToCommandString(22806530,this)},_requestPurchaseSendGen:function(j,h){f.appendToCommandString(22806531,this,[f.encodeString(j),+h])},_fillIABNoncePoolSendGen:function(h){f.appendToCommandString(22806532,this,[f.encodeString(h)])},_getProductInformationSendGen:function(h){f.appendToCommandString(22806533,this,[f.encodeString(h)])},_sendOrderProcessedAckSendGen:function(h){f.appendToCommandString(22806534,this,[f.encodeString(h)])},_getProductSetInfoSendGen:function(h){f.appendToCommandString(22806535,this,[f.encodeString(h)])},_initService2SendGen:function(h){f.appendToCommandString(22806536,this,[f.encodeString(h)])},_requestPurchase2SendGen:function(k,j,h){f.appendToCommandString(22806537,this,[f.encodeString(k),+j,f.encodeString(h)])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[348]=this._instance||this}})}};__ngs._1e={_c:null,_d:function(){var c={exports:{}};var e=c.exports;this._c=c;var g=__ngs.r_(__ngs._5).Core;var b=__ngs.r_(__ngs._t).Class;var l=__ngs.r_(__ngs._6).Proc;var d=__ngs.r_(__ngs._12).ObjectRegistry;var f=__ngs.r_(__ngs._u).Base64;var k=__ngs.r_(__ngs._1q).MessageEmitter;var a=__ngs.r_(__ngs._z).DownloadFile;var j=__ngs.r_(__ngs._y).Util;var h=__ngs.r_(__ngs._d).FileSystem;e.IPCEmitter=k.singleton({classname:"IPCEmitter",initialize:function(){console.log("IPCEmitter.initialize");this._callbackID=1;this._callbacks=[];this._shouldEmitIntents=false;d.register(this);this._createSendGen(this.__objectRegistryId)},canLaunch:function(m,n){this._callbacks[this._callbackID]=n;this._canLaunchSendGen(m,this._callbackID);this._callbackID++},launch:function(m,n){this._callbacks[this._callbackID]=n;this._launchSendGen(m,this._callbackID);this._callbackID++},launchIntent:function(o,n,m){if(typeof(m)=="string"){if(typeof(n)=="string"){n=JSON.parse(n)}n.packageName=m}if(typeof n=="object"){n=JSON.stringify(n)}this._launchIntentSendGen(o,n)},launchService:function(p,o,n){if(typeof(n)=="string"){var m;if(typeof(o)=="string"){m=JSON.parse(o)}else{m={}}m.packageName=n;o=JSON.stringify(m)}this._launchServiceSendGen(p,o)},launchForSSO:function(m,n){m+="&sso_auth";this.launch(m,n)},getAppSignatures:function(m,n){this._callbacks[this._callbackID]=n;this._getAppSignaturesSendGen(m,this._callbackID);this._callbackID++},getCallingPackage:function(m){this._callbacks[this._callbackID]=m;this._getCallingPackageSendGen(this._callbackID);this._callbackID++},getIsServiceRunning:function(n,m){this._callbacks[this._callbackID]=m;this._getIsServiceRunningSendGen(n,this._callbackID);this._callbackID++},app:function(){return this._app},App:b.subclass({classname:"App",initialize:function(m,n){this._sourceAppID=m;this._intentURL=n},getID:function(){return this._sourceAppID},getURL:function(){return this._intentURL}}),Intent:b.subclass({classname:"Intent",initialize:function(n,m){this._action=n;this._extras=m},getAction:function(){return this._action},getExtras:function(){return this._extras}}),createShortcut:function(n,m,o){this._createShortcutSendGen(n,m,o)},createShortcutByIconUrl:function(q,p,o,s){NgLogD("createShortcutByIconUrl called",q,p,o);var r=new a();var n="shortcut_icon_image"+(new Date().getTime());var m=this;NgLogD("Icon download begin");j.OperationWithRetries(function(t,u){r.start(n,"GET",o,[],function(w,v){NgLogD("Icon download finished status="+w);if(w==200){m.createShortcut(q,p,n);h.deleteFile(n,{},function(){if(s){s(false)}})}else{if(w==404){NgLogE("Unable download icon file: icon_url="+o+", status="+w);u()}else{NgLogE("Unable download icon file: icon_url="+o+", status="+w);t()}}})},function(){NgLogE("Unable download icon file");if(s){s(true)}},true)},_onResumeFromOthersRecv:function(m,n){this._app=new Device.IPCEmitter.App(n,m);this.emit(this._app);this._onResumeFromOthersSendGen(m,n)},_setEmitIntents:function(m){this._shouldEmitIntents=Boolean(m)},_onIntentReceived:function(n,m){console.log("On IntentReceived: "+n+" / "+JSON.stringify(m));if(this._shouldEmitIntents){this.emit(new e.IPCEmitter.Intent(n,m))}},_canLaunchCallbackRecv:function(n,o){var m=o&&this._callbacks[o];if(m){m(n)}},_launchFailedRecv:function(n,o){var m=o&&this._callbacks[o];if(m){m(n)}},_getAppSignaturesCallbackRecv:function(o,n){var m=n&&this._callbacks[n];if(m){m(o.split(","))}},_getCallingPackageCallbackRecv:function(n,o){var m=o&&this._callbacks[o];if(m){m(n)}},_getIsServiceRunningCallbackRecv:function(n,o){var m=o&&this._callbacks[o];if(m){m(n)}},_onIntentReceivedRecv:function(n,m){this._onIntentReceived(n,JSON.parse(m))},Service:{SystemDownloadProvider:1},_classId:349,_onResumeFromOthersRecvGen:function(o){if((o.length-o.idx)!==2){NgLogE("Could not parse due to wrong argument count in IPCEmitter.onResumeFromOthers from command: "+o);return false}var m=l.parseString(o[o.idx++]);if(m===undefined){NgLogE("Could not parse url in IPCEmitter.onResumeFromOthers from command: "+o);return false}var n=l.parseString(o[o.idx++]);if(n===undefined){NgLogE("Could not parse sourceAppID in IPCEmitter.onResumeFromOthers from command: "+o);return false}return this._onResumeFromOthersRecv(m,n)},_launchFailedRecvGen:function(o){if((o.length-o.idx)!==2){NgLogE("Could not parse due to wrong argument count in IPCEmitter.launchFailed from command: "+o);return false}var m=l.parseString(o[o.idx++]);if(m===undefined){NgLogE("Could not parse error in IPCEmitter.launchFailed from command: "+o);return false}var n=l.parseInt(o[o.idx++]);if(n===undefined){NgLogE("Could not parse callbackID in IPCEmitter.launchFailed from command: "+o);return false}return this._launchFailedRecv(m,n)},_canLaunchCallbackRecvGen:function(o){if((o.length-o.idx)!==2){NgLogE("Could not parse due to wrong argument count in IPCEmitter.canLaunchCallback from command: "+o);return false}var m=l.parseBool(o[o.idx++]);if(m===undefined){NgLogE("Could not parse canLaunch in IPCEmitter.canLaunchCallback from command: "+o);return false}var n=l.parseInt(o[o.idx++]);if(n===undefined){NgLogE("Could not parse callbackID in IPCEmitter.canLaunchCallback from command: "+o);return false}return this._canLaunchCallbackRecv(m,n)},_getAppSignaturesCallbackRecvGen:function(n){if((n.length-n.idx)!==2){NgLogE("Could not parse due to wrong argument count in IPCEmitter.getAppSignaturesCallback from command: "+n);return false}var o=l.parseString(n[n.idx++]);if(o===undefined){NgLogE("Could not parse signatures in IPCEmitter.getAppSignaturesCallback from command: "+n);return false}var m=l.parseInt(n[n.idx++]);if(m===undefined){NgLogE("Could not parse callbackID in IPCEmitter.getAppSignaturesCallback from command: "+n);return false}return this._getAppSignaturesCallbackRecv(o,m)},_getCallingPackageCallbackRecvGen:function(o){if((o.length-o.idx)!==2){NgLogE("Could not parse due to wrong argument count in IPCEmitter.getCallingPackageCallback from command: "+o);return false}var m=l.parseString(o[o.idx++]);if(m===undefined){NgLogE("Could not parse packageName in IPCEmitter.getCallingPackageCallback from command: "+o);return false}var n=l.parseInt(o[o.idx++]);if(n===undefined){NgLogE("Could not parse callbackID in IPCEmitter.getCallingPackageCallback from command: "+o);return false}return this._getCallingPackageCallbackRecv(m,n)},_onIntentReceivedRecvGen:function(o){if((o.length-o.idx)!==2){NgLogE("Could not parse due to wrong argument count in IPCEmitter.onIntentReceived from command: "+o);return false}var n=l.parseString(o[o.idx++]);if(n===undefined){NgLogE("Could not parse action in IPCEmitter.onIntentReceived from command: "+o);return false}var m=l.parseString(o[o.idx++]);if(m===undefined){NgLogE("Could not parse extras in IPCEmitter.onIntentReceived from command: "+o);return false}return this._onIntentReceivedRecv(n,m)},_getIsServiceRunningCallbackRecvGen:function(o){if((o.length-o.idx)!==2){NgLogE("Could not parse due to wrong argument count in IPCEmitter.getIsServiceRunningCallback from command: "+o);return false}var m=l.parseBool(o[o.idx++]);if(m===undefined){NgLogE("Could not parse running in IPCEmitter.getIsServiceRunningCallback from command: "+o);return false}var n=l.parseInt(o[o.idx++]);if(n===undefined){NgLogE("Could not parse callbackID in IPCEmitter.getIsServiceRunningCallback from command: "+o);return false}return this._getIsServiceRunningCallbackRecv(m,n)},$_createSendGen:function(m){l.appendToCommandString(22937599,[+m])},_canLaunchSendGen:function(m,n){l.appendToCommandString(22872066,this,[l.encodeString(m),+n])},_launchSendGen:function(m,n){l.appendToCommandString(22872067,this,[l.encodeString(m),+n])},_onResumeFromOthersSendGen:function(m,n){l.appendToCommandString(22872068,this,[l.encodeString(m),l.encodeString(n)])},_getAppSignaturesSendGen:function(m,n){l.appendToCommandString(22872071,this,[l.encodeString(m),+n])},_getCallingPackageSendGen:function(m){l.appendToCommandString(22872073,this,[+m])},_launchIntentSendGen:function(n,m){l.appendToCommandString(22872075,this,[l.encodeString(n),l.encodeString(m)])},_launchServiceSendGen:function(n,m){l.appendToCommandString(22872076,this,[l.encodeString(n),l.encodeString(m)])},_getIsServiceRunningSendGen:function(n,m){l.appendToCommandString(22872078,this,[+n,+m])},_createShortcutSendGen:function(n,m,o){l.appendToCommandString(22872080,this,[l.encodeString(n),l.encodeString(m),l.encodeString(o)])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[349]=this._instance||this;PROC_METHOD_TABLE[22872068]=this.prototype._onResumeFromOthersRecvGen;PROC_METHOD_TABLE[22872069]=this.prototype._launchFailedRecvGen;PROC_METHOD_TABLE[22872070]=this.prototype._canLaunchCallbackRecvGen;PROC_METHOD_TABLE[22872072]=this.prototype._getAppSignaturesCallbackRecvGen;PROC_METHOD_TABLE[22872074]=this.prototype._getCallingPackageCallbackRecvGen;PROC_METHOD_TABLE[22872077]=this.prototype._onIntentReceivedRecvGen;PROC_METHOD_TABLE[22872079]=this.prototype._getIsServiceRunningCallbackRecvGen}})}};__ngs._1f={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var d=__ngs.r_(__ngs._6).Proc;var a=__ngs.r_(__ngs._1q).MessageEmitter;var e=null;b.LayoutEmitter=a.singleton({classname:"LayoutEmitter",initialize:function(){var f=__ngs.r_(__ngs._12).ObjectRegistry;f.register(this);this._createSendGen(this.__objectRegistryId)},_layoutChangedRecv:function(g,f){this.setWidthAndHeight(g,f);this.emit({width:g,height:f});this._layoutChangedSendGen(g,f)},$getWidth:function(){return this._width},$getHeight:function(){return this._height},$_setWindow:function(f){e=f},setWidthAndHeight:function(g,f){this._width=g;this._height=f;if(e){e._setWidthAndHeight(g,f)}},_classId:352,_layoutChangedRecvGen:function(h){if((h.length-h.idx)!==2){NgLogE("Could not parse due to wrong argument count in LayoutEmitter.layoutChanged from command: "+h);return false}var g=d.parseInt(h[h.idx++]);if(g===undefined){NgLogE("Could not parse width in LayoutEmitter.layoutChanged from command: "+h);return false}var f=d.parseInt(h[h.idx++]);if(f===undefined){NgLogE("Could not parse height in LayoutEmitter.layoutChanged from command: "+h);return false}return this._layoutChangedRecv(g,f)},$_createSendGen:function(f){d.appendToCommandString(23134207,[+f])},_layoutChangedSendGen:function(g,f){d.appendToCommandString(23068674,this,[+g,+f])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[352]=this._instance||this;PROC_METHOD_TABLE[23068674]=this.prototype._layoutChangedRecvGen}})}};__ngs._1g={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._t).Class;var e=__ngs.r_(__ngs._5).Core;var d=__ngs.r_(__ngs._6).Proc;b.LocalNotification=e.MessageEmitter.singleton({classname:"LocalNotification",initialize:function(){this._callbackIndexCounter=1;this._callbacks=[];e.ObjectRegistry.register(this);this._createSendGen(this.__objectRegistryId)},showLocalNotification:function(f){this._showLocalNotificationSendGen(f)},schedule:function(f,h){if(!(h instanceof Function)){throw new Error("LocalNotification.schedule requires a callback function, given: "+h)}if(!f.delayTime){throw new Error("LocalNotification.schedule requires a delayTime given in options")}if(!f.aps.alert){throw new Error("LocalNotification.schedule requires an aps.alert given in options")}var g=0;if(h){g=this._callbackIndexCounter++;this._callbacks[g]=h}this._scheduleSendGen(g,f)},_scheduleCommandCbRecv:function(g){var h={};if(!this._scheduleCommandCbRecvGen(g,h)){return}var j=h.callbackId;var f=this._callbacks[j];if(!f){NgLogE("_scheduleCommandCbRecv command : No registered callback found, id = "+j);return}delete this._callbacks[j];f(h.id)},cancel:function(f){this._cancelSendGen(f)},cancelAll:function(){this._cancelAllSendGen()},getAllScheduled:function(g){if(!(g instanceof Function)){throw new Error("LocalNotification.getAllScheduled requires a callback function, given: "+g)}var f=0;if(g){f=this._callbackIndexCounter++;this._callbacks[f]=g}this._getAllScheduledSendGen(f)},_getAllScheduledCommandCbRecv:function(g){var h={};if(!this._getAllScheduledCommandCbRecvGen(g,h)){return}var j=h.callbackId;var f=this._callbacks[j];if(!f){NgLogE("LocalNotificaton._getAllScheduledCommandCbRecv command : No registered callback found, id = "+j);return}delete this._callbacks[j];f(h.response)},retrieveLauncherInfo:function(g){if(!(g instanceof Function)){throw new Error("LocalNotification.retrieveLauncherInfo requires a callback function, given: "+g)}var f=0;if(g){f=this._callbackIndexCounter++;this._callbacks[f]=g}this._retrieveLauncherInfoSendGen(f)},_retrieveLauncherInfoCommandCbRecv:function(g){var h={};if(!this._retrieveLauncherInfoCommandCbRecvGen(g,h)){return}var j=h.callbackId;var f=this._callbacks[j];if(!f){NgLogE("LocalNotificaton._retrieveLauncherInfoCommandCbRecv command : No registered callback found, id = "+j);return}delete this._callbacks[j];f(h.response)},_onNotificationEventRecv:function(f){var g={};if(!this._onNotificationEventRecvGen(f,g)){return}this.emit(g.info)},_classId:354,$_createSendGen:function(f){d.appendToCommandString(23265279,[+f])},_destroySendGen:function(){d.appendToCommandString(23199746,this)},_showLocalNotificationSendGen:function(f){d.appendToCommandString(23199747,this,[d.encodeObject(f)])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[354]=this._instance||this}})}};__ngs._1h={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var e=__ngs.r_(__ngs._6).Proc;var b=__ngs.r_(__ngs._12).ObjectRegistry;var a=__ngs.r_(__ngs._t).Class;c.UsageStats=a.singleton({classname:"UsageStats",initialize:function(){this.requests={};this.cbIdCounter=1;b.register(this);this._createSendGen(this.__objectRegistryId)},getData:function(g){var f=this.cbIdCounter++;this.requests[f]=g;this._getDataSendGen(f)},_getDataCbRecv:function(g,h){var f=g&&this.requests[g];if(f){delete this.requests[g];try{f(JSON.parse(h))}catch(j){NgLogE("UsageStats.getData: exception has occured while parsing JSON or executing callback")}}else{NgLogE("UsageStats.getData:: No registered cb found..cbId is :"+g);return}},_classId:356,_getDataCbRecvGen:function(h){if((h.length-h.idx)!==2){NgLogE("Could not parse due to wrong argument count in UsageStats.getDataCb from command: "+h);return false}var g=e.parseInt(h[h.idx++]);if(g===undefined){NgLogE("Could not parse callbackId in UsageStats.getDataCb from command: "+h);return false}var f=e.parseString(h[h.idx++]);if(f===undefined){NgLogE("Could not parse data in UsageStats.getDataCb from command: "+h);return false}return this._getDataCbRecv(g,f)},$_createSendGen:function(f){e.appendToCommandString(23396351,[+f])},_getDataSendGen:function(f){e.appendToCommandString(23330818,this,[+f])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[356]=this._instance||this;PROC_METHOD_TABLE[23330819]=this.prototype._getDataCbRecvGen}})}};__ngs._1i={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var e=__ngs.r_(__ngs._6).Proc;var a=__ngs.r_(__ngs._1q).MessageEmitter;var d="Device.NotificationEmitter";b.NotificationEmitter=a.singleton({classname:"NotificationEmitter",$getPendingNotification:function(){var f=__ngs.r_(__ngs._7).Capabilities;var g=f._getPendingNotification();if(g){g=this._adjustFormat(g)}return g},initialize:function(){this._callbackIndexCounter=1;this._callbacks={};this._payloadKeys={message:true,badge:true,sound:true,collapseKey:true,style:true,iconUrl:true,extras:true};var f=__ngs.r_(__ngs._12).ObjectRegistry;f.register(this);this._createSendGen(this.__objectRegistryId)},scheduleLocal:function(g,f,j){if(typeof j!="function"){throw new Error(d+".scheduleLocal: requires a callback function, given: "+j)}if(!g.message){j({code:-1,description:d+".scheduleLocal: requires payload.message"});return}if(f instanceof Date){f=f.getTime()/1000}var h=this._callbackIndexCounter++;this._callbacks[h]=j;this._scheduleSendGen(g,~~f,h)},_scheduleCbRecv:function(h,g){var f=this._callbacks[g];if(f){delete this._callbacks[g];f(null,h)}else{NgLogE(d+"._scheduleCbRecv command : No registered callback found, id = "+g);return}},cancelScheduled:function(f){this._cancelScheduledSendGen(f)},cancelAllScheduled:function(){this._cancelAllScheduledSendGen()},getAllScheduled:function(g){var f=this._callbackIndexCounter++;this._callbacks[f]=g;this._getAllScheduledSendGen(f)},_getAllScheduledCbRecv:function(g,h){var f=this._callbacks[h];if(f){delete this._callbacks[h];f(g)}else{NgLogE(d+"._getAllScheduledCbRecvGen command : No registered callback found, id = "+h);return}},addListener:function($super,f,g){$super(f,g)},getAppBadgeCount:function(g){var f=this._callbackIndexCounter++;this._callbacks[f]=g;this._getAppBadgeCountSendGen(f)},_getAppBadgeCountCbRecv:function(g,h,j){var f=this._callbacks[j];if(f){delete this._callbacks[j];f(g&&JSON.parse(g),h)}else{NgLogE(d+"._getAppBadgeCountCbRecv command : No registered callback found, id = "+j);return}},setAppBadgeCount:function(f){this._setAppBadgeCountSendGen(f)},_notificationOccurredRecv:function(g){var f=this._adjustFormat(JSON.parse(g));if(!this.chain(f)){this._notificationOccurredSendGen(g)}},_adjustFormat:function(f){if(f.type!=Device.NotificationEmitter.Type.Remote){return f}if(f.message){return this._adjustC2DM(f)}else{if(f.aps){return this._adjustAPN(f)}else{return f}}},_adjustC2DM:function(l){var k={};for(var g in l){var f=l[g];if(g in this._payloadKeys){if(g=="extras"&&typeof f=="string"){var h=f;if(h!==""){try{k[g]=JSON.parse(decodeURIComponent(h))}catch(j){NgLogE('Unable to parse payload "extras" field (expected JSON string): '+j);k[g]=null}}else{k[g]=null}}else{k[g]=f}}}l.payload=k;return l},_adjustAPN:function(k){var j={};k.payload=j;var f=k.x;k.id=f[1];k.senderId=f[2];if(typeof f[3]=="string"&&f[3]!==""){try{j.extras=JSON.parse(f[3])}catch(h){NgLogE("Unable to parse payload json: "+h);j.extras=null}}else{j.extras=null}k.published=f[4];var g=k.aps;j.message=g.alert;j.badge=g.badge;j.sound=g.sound;return k},Type:{Local:0,Remote:1},_classId:366,_scheduleCbRecvGen:function(g){if((g.length-g.idx)!==2){NgLogE("Could not parse due to wrong argument count in NotificationEmitter.scheduleCb from command: "+g);return false}var h=e.parseObject(g[g.idx++]);if(h===undefined){NgLogE("Could not parse notification in NotificationEmitter.scheduleCb from command: "+g);return false}var f=e.parseInt(g[g.idx++]);if(f===undefined){NgLogE("Could not parse callbackId in NotificationEmitter.scheduleCb from command: "+g);return false}return this._scheduleCbRecv(h,f)},_getAllScheduledCbRecvGen:function(h){if((h.length-h.idx)!==2){NgLogE("Could not parse due to wrong argument count in NotificationEmitter.getAllScheduledCb from command: "+h);return false}var f=e.parseObject(h[h.idx++]);if(f===undefined){NgLogE("Could not parse notifications in NotificationEmitter.getAllScheduledCb from command: "+h);return false}var g=e.parseInt(h[h.idx++]);if(g===undefined){NgLogE("Could not parse callbackId in NotificationEmitter.getAllScheduledCb from command: "+h);return false}return this._getAllScheduledCbRecv(f,g)},_getAppBadgeCountCbRecvGen:function(j){if((j.length-j.idx)!==3){NgLogE("Could not parse due to wrong argument count in NotificationEmitter.getAppBadgeCountCb from command: "+j);return false}var f=e.parseString(j[j.idx++]);if(f===undefined){NgLogE("Could not parse error in NotificationEmitter.getAppBadgeCountCb from command: "+j);return false}var g=e.parseInt(j[j.idx++]);if(g===undefined){NgLogE("Could not parse count in NotificationEmitter.getAppBadgeCountCb from command: "+j);return false}var h=e.parseInt(j[j.idx++]);if(h===undefined){NgLogE("Could not parse callbackId in NotificationEmitter.getAppBadgeCountCb from command: "+j);return false}return this._getAppBadgeCountCbRecv(f,g,h)},_notificationOccurredRecvGen:function(f){if((f.length-f.idx)!==1){NgLogE("Could not parse due to wrong argument count in NotificationEmitter.notificationOccurred from command: "+f);return false}var g=e.parseString(f[f.idx++]);if(g===undefined){NgLogE("Could not parse notification in NotificationEmitter.notificationOccurred from command: "+f);return false}return this._notificationOccurredRecv(g)},$_createSendGen:function(f){e.appendToCommandString(24051711,[+f])},_scheduleSendGen:function(h,g,f){e.appendToCommandString(23986178,this,[e.encodeObject(h),+g,+f])},_getAllScheduledSendGen:function(f){e.appendToCommandString(23986180,this,[+f])},_cancelScheduledSendGen:function(f){e.appendToCommandString(23986182,this,[e.encodeString(f)])},_cancelAllScheduledSendGen:function(){e.appendToCommandString(23986183,this)},_getAppBadgeCountSendGen:function(f){e.appendToCommandString(23986184,this,[+f])},_setAppBadgeCountSendGen:function(f){e.appendToCommandString(23986186,this,[+f])},_notificationOccurredSendGen:function(f){e.appendToCommandString(23986187,this,[e.encodeString(f)])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[366]=this._instance||this;PROC_METHOD_TABLE[23986179]=this.prototype._scheduleCbRecvGen;PROC_METHOD_TABLE[23986181]=this.prototype._getAllScheduledCbRecvGen;PROC_METHOD_TABLE[23986185]=this.prototype._getAppBadgeCountCbRecvGen;PROC_METHOD_TABLE[23986187]=this.prototype._notificationOccurredRecvGen}})}};__ngs._1j={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._5).Core;a.Diagnostics=c.DiagnosticEmitter.singleton({classname:"Device_Diagnostics",initialize:function($super){$super("Device")}})}};__ngs._1k={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var b=__ngs.r_(__ngs._t).Class,d=__ngs.r_(__ngs._46).NgPipe,f=__ngs.r_(__ngs._47).NgPipesRemote;var a=b.singleton({classname:"Analytics",initialize:function(){if(!this._pipe){this._pipe=new d()}},updateGLEXT:function(){try{var h=__ngs.r_(__ngs._7).Capabilities;var g=h.getOglExtensions();if(g.length>2){var n=[];var q=["GL_IMG_texture_compression_pvrtc","GL_AMD_compressed_ATC_texture","GL_OES_compressed_ETC1_RGB8_texture","GL_AMD_compressed_3DC_texture"];for(var l in q){var p=q[l];for(var k in g){if(g[k]===p){var o={};o[h.getDeviceName()]=p;n.push(o)}}}for(l in n){a.reportGameEvent("openglexts",n[l])}}}catch(m){NgLogException(m)}},enable:function(){this._pipe.enable()},disable:function(){this._pipe.disable()},setUrl:function(g){this._pipe.setRemoteUrl(g)},reportNavigation:function(j,h,g){if(!(j&&h)){return false}this._pipe.uiEvent("NAV",{to:h,fro:j,btnid:g});return true},reportGameEvent:function(g,j,h){if(!g){return false}this._pipe.gameEvent(g,j,h);return true},reportPlayerStateChange:function(g,j,h){if(g){this._pipe.playerEvent(g,"PLSTCHANGE",j,h);return true}else{return false}},reportFunnelStage:function(l,g,h,k){var j={};if(!(l)){return false}if(g!==null&&g!==undefined){j.stage=g}else{return false}if(h){j.stageName=h}this._pipe.funnelEvent(l,j,k);return true},reportSocialEvent:function(j,g,h){if(j&&j.length&&g&&g.length){this._pipe.socialEvent(j,g,h);return true}return false},reportError:function(g){if(!g){return false}this._pipe.gameOpsEvent("ERR",{err:g});return true},addTag:function(h){if(h){var g={tag:h};this._pipe.gameEvent("tag",g);return true}return false},_getPipe:function(){return this._pipe},_setNgPipeSocialAnalytics:function(g){if(this._pipe){this._pipe._setSocialAnalytics(g)}}});c.Analytics=a}};__ngs._1l={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Color=__ngs.r_(__ngs._48).Color}};__ngs._1m={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Vector=__ngs.r_(__ngs._49).Vector}};__ngs._1n={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Point=__ngs.r_(__ngs._4a).Point}};__ngs._1o={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Size=__ngs.r_(__ngs._4b).Size}};__ngs._1p={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Rect=__ngs.r_(__ngs._4c).Rect}};__ngs._1q={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.MessageEmitter=__ngs.r_(__ngs._4d).MessageEmitter}};__ngs._1r={_c:null,_d:function(){var b={exports:{}};var e=b.exports;this._c=b;var a=__ngs.r_(__ngs._t).Class;var k=__ngs.r_(__ngs._7).Capabilities;var l=__ngs.r_(__ngs._6).Proc;var d=__ngs.r_(__ngs._12).ObjectRegistry;var h={};var j=0;h.add=function(m){if(typeof m!="function"){return undefined}this[++j]=m;return j};var f=typeof $_GETENGINEENV!=="undefined"?$_GETENGINEENV():undefined;var c=(typeof f=="object"&&f.useCoreTimeout);var g=a.singleton({classname:"Time",mFrameTime:0,mFrameDelta:0,initialize:function(){d.register(this);if(k.meetsBinaryVersion("1.8")){this._createSendGen(this.__objectRegistryId)}var o=__ngs.r_(__ngs._w).MessageListener;var n=__ngs.r_(__ngs._11).LifecycleEmitter;var m=o.subclass({initialize:function(p){n.addListener(this,this.onLifecycleUpdate);this.mTime=p},onLifecycleUpdate:function(p){switch(p){case n.Event.Resume:this.mTime.mFrameTime=0;break}}});this.mLifeListener=new m(this);if(c){NGSetTimeoutInternal=this.setTimeout.bind(this);NGSetIntervalInternal=this.setInterval.bind(this);NGClearTimeoutInternal=this.clearTimeout.bind(this);NGClearIntervalInternal=this.clearInterval.bind(this)}else{this.setTimeout=setTimeout;this.setInterval=setInterval;this.clearTimeout=clearTimeout;this.clearInterval=clearInterval}},getFrameTime:function(){return this.mFrameTime},getFrameDelta:function(){return this.mFrameDelta},getRealTime:function(){return(new Date()).getTime()},$_frameTimeRecv:function(m){this.mFrameDelta=this.mFrameTime?m-this.mFrameTime:1;this.mFrameTime=m;if(this._updateEmitter){this._updateEmitter.emit(this.mFrameDelta)}},setTimeout:function(n,o){var m=h.add(n);if(m){this._setTimeoutSendGen(m,o)}return m},setInterval:function(o,m){var n=h.add(o);if(n){this._setIntervalSendGen(n,m)}return n},clearTimeout:function(m){delete h[m];this._clearSendGen(m)},clearInterval:function(m){delete h[m];this._clearSendGen(m)},_fireTimerRecv:function(o,n){var m=o&&h[o];if(n){delete h[o]}m?m():console.log("Could not find closure for "+o)},_classId:351,$_frameTimeRecvGen:function(m){if((m.length-m.idx)!==1){NgLogE("Could not parse due to wrong argument count in Time.frameTime from command: "+m);return false}var n=l.parseInt(m[m.idx++]);if(n===undefined){NgLogE("Could not parse time in Time.frameTime from command: "+m);return false}return this._frameTimeRecv(n)},_fireTimerRecvGen:function(o){if((o.length-o.idx)!==2){NgLogE("Could not parse due to wrong argument count in Time.fireTimer from command: "+o);return false}var n=l.parseInt(o[o.idx++]);if(n===undefined){NgLogE("Could not parse cbId in Time.fireTimer from command: "+o);return false}var m=l.parseBool(o[o.idx++]);if(m===undefined){NgLogE("Could not parse remove in Time.fireTimer from command: "+o);return false}return this._fireTimerRecv(n,m)},$_createSendGen:function(m){l.appendToCommandString(23068670,[+m])},_setTimeoutSendGen:function(m,n){l.appendToCommandString(23003139,this,[+m,+n])},_setIntervalSendGen:function(n,m){l.appendToCommandString(23003140,this,[+n,+m])},_clearSendGen:function(m){l.appendToCommandString(23003141,this,[+m])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[351]=this._instance||this;PROC_METHOD_TABLE[23068671]=this.prototype._frameTimeRecvGen;PROC_METHOD_TABLE[23003142]=this.prototype._fireTimerRecvGen}});e.Time=g}};__ngs._1s={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._4e);a.SHA1={b64_hmac_sha1:c.b64_hmac_sha1,hex_sha1:c.hex_sha1,b64_sha1:c.b64_sha1}}};__ngs._1t={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var a=__ngs.r_(__ngs._1q).MessageEmitter;var b=__ngs.r_(__ngs._12).ObjectRegistry;var f=__ngs.r_(__ngs._6).Proc;var e=__ngs.r_(__ngs._1r).Time;c.UpdateEmitter=a.singleton({classname:"UpdateEmitter",initialize:function(){Core.ObjectRegistry.register(this);e.getFrameDelta();e._updateEmitter=this;this._createSendGen(this.__objectRegistryId);if(!Core.Capabilities.meetsBinaryVersion("1.8")){this._setListenerCountSendGen=function(){}}this._setListenerCountSendGen(0)},setTickRate:function(g){this._setTickRateSendGen(g)},addListener:function($super,j,h,g){$super(j,h,g);this._setListenerCountSendGen(this.getListenerCount())},removeListener:function($super,g){$super(g);this._setListenerCountSendGen(this.getListenerCount())},_classId:304,$_createSendGen:function(g){f.appendToCommandString(19988479,[+g])},_setTickRateSendGen:function(g){f.appendToCommandString(19922946,this,[+g])},_setListenerCountSendGen:function(g){f.appendToCommandString(19922947,this,[+g])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[304]=this._instance||this}})}};__ngs._1u={_c:null,_d:function(){var c={exports:{}};var a=c.exports;this._c=c;var b;a.NativeAppLaunch=b}};__ngs._1v={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var d=__ngs.r_(__ngs._1w).DiagnosticEmitter;var a=__ngs.r_(__ngs._12).ObjectRegistry;b.Diagnostics=d.singleton({classname:"Core_Diagnostics",initialize:function($super){$super("Core")}})}};__ngs._1w={_c:null,_d:function(){var c={exports:{}};var e=c.exports;this._c=c;var h=__ngs.r_(__ngs._1q).MessageEmitter;var g=__ngs.r_(__ngs._w).MessageListener;var j=__ngs.r_(__ngs._6).Proc;var b=__ngs.r_(__ngs._t).Class;var f=__ngs.r_(__ngs._u).Base64;var d=__ngs.r_(__ngs._12).ObjectRegistry;var a=e.DiagnosticEmitter=h.subclass({classname:"DiagnosticEmitter",initialize:function(k){this.name=k;this.reset();this.listeners=0;this.native_listeners=0;this.collectors=[];this.native_collector=false;this.dirty=false;d.register(this);this._createSendGen(this.__objectRegistryId,k);e.DiagnosticRegistry.registerEmitter(this.name,this)},destroy:function(){e.DiagnosticRegistry.deregisterEmitter(this.name,this);h.prototype.destroy.apply(this);this._destroySendGen();d.unregister(this)},setInterval:function(k){if(k<=0){NgLogE("DiagnosticEmitter "+this.name+": attempt to set invalid interval "+k);return false}this._set_interval(k);return true},pushCollector:function(k){if(k&&!(k instanceof Function)){NgLogE("DiagnosticEmitter "+this.name+": attempt to set invalid collector")}this.collectors.push(k);if(this.getListenerCount()>0){this.update(k(0))}},removeCollector:function(l){for(var k=0;k<this.collectors.length;k++){if(this.collectors[k]==l){this.collectors.splice(k,1);return}}},reset:function(k){this.diags={name:this.name};if(k){this.update(k)}},update:function(l){if(l){this.dirty=true;for(var k in l){if(l.hasOwnProperty(k)){this.diags[k]=l[k]}}}},push:function(){this.emit(this.diags)},pushUpdate:function(k){this.update(k);this.push()},getDiags:function(){return this.diags},curryProducer:function(m,k){var l=this;return function(){if(l.listeners>0){var n=k.apply(m,arguments);l.update(n)}}},$startEvent:function(k){this._startEventSendGen(k,new Date().getTime())},$stopEvent:function(k){this._stopEventSendGen(k,new Date().getTime())},_classId:362,_updateDiagnosticsRecvGen:function(l){if((l.length-l.idx)!==1){NgLogE("Could not parse due to wrong argument count in DiagnosticEmitter.updateDiagnostics from command: "+l);return false}var k=j.parseObject(l[l.idx++]);if(k===undefined){NgLogE("Could not parse jsonData in DiagnosticEmitter.updateDiagnostics from command: "+l);return false}return this._updateDiagnosticsRecv(k)},_nativeCollectorRecvGen:function(l){if((l.length-l.idx)!==1){NgLogE("Could not parse due to wrong argument count in DiagnosticEmitter.nativeCollector from command: "+l);return false}var k=j.parseBool(l[l.idx++]);if(k===undefined){NgLogE("Could not parse exists in DiagnosticEmitter.nativeCollector from command: "+l);return false}return this._nativeCollectorRecv(k)},_nativeListenersRecvGen:function(l){if((l.length-l.idx)!==1){NgLogE("Could not parse due to wrong argument count in DiagnosticEmitter.nativeListeners from command: "+l);return false}var k=j.parseInt(l[l.idx++]);if(k===undefined){NgLogE("Could not parse num in DiagnosticEmitter.nativeListeners from command: "+l);return false}return this._nativeListenersRecv(k)},_tickRecvGen:function(k){if((k.length-k.idx)!==0){NgLogE("Could not parse due to wrong argument count in DiagnosticEmitter.tick from command: "+k);return false}return this._tickRecv()},$_sendStartTimesRecvGen:function(k){if((k.length-k.idx)!==1){NgLogE("Could not parse due to wrong argument count in DiagnosticEmitter.sendStartTimes from command: "+k);return false}var l=j.parseString(k[k.idx++]);if(l===undefined){NgLogE("Could not parse times in DiagnosticEmitter.sendStartTimes from command: "+k);return false}return this._sendStartTimesRecv(l)},$_createSendGen:function(k,l){j.appendToCommandString(23789567,[+k,j.encodeString(l)])},_destroySendGen:function(){j.appendToCommandString(23724034,this)},_currentListenersSendGen:function(k){j.appendToCommandString(23724035,this,[+k])},_collectNativeSendGen:function(k){j.appendToCommandString(23724038,this,[+k])},__runTestsSendGen:function(k){j.appendToCommandString(23724039,this,[j.encodeString(k)])},_setCurrentStateSendGen:function(k){j.appendToCommandString(23724041,this,[j.encodeObject(k)])},$_startEventSendGen:function(k,l){j.appendToCommandString(23789557,[j.encodeString(k),+l])},$_stopEventSendGen:function(k,l){j.appendToCommandString(23789556,[j.encodeString(k),+l])},__set_intervalSendGen:function(k){j.appendToCommandString(23724045,this,[+k])},$_getStartTimesSendGen:function(){j.appendToCommandString(23789554)},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[362]=this._instance||this;PROC_METHOD_TABLE[23724036]=this.prototype._updateDiagnosticsRecvGen;PROC_METHOD_TABLE[23724037]=this.prototype._nativeCollectorRecvGen;PROC_METHOD_TABLE[23724040]=this.prototype._nativeListenersRecvGen;PROC_METHOD_TABLE[23724042]=this.prototype._tickRecvGen;PROC_METHOD_TABLE[23789553]=this.prototype._sendStartTimesRecvGen},_set_interval:function(k){this.__set_intervalSendGen(k)},addListener:function(m,l,k){h.prototype.addListener.apply(this,[m,l,k]);this.listeners=h.prototype.getListenerCount.apply(this);this.sendCurrentListeners(this.listeners)},removeListener:function(k){h.prototype.removeListener.apply(this,[k]);this.listeners=h.prototype.getListenerCount.apply(this);this.sendCurrentListeners(this.listeners)},getListenerCount:function(){return this.listeners+this.native_listeners},sendCurrentListeners:function(k){this._currentListenersSendGen(k)},_updateDiagnosticsRecv:function(k){this.update(k)},_nativeCollectorRecv:function(k){this.native_collector=k},collectNative:function(k){this._collectNativeSendGen(k)},_nativeListenersRecv:function(k){this.native_listeners=k},$getStartTimes:function(k){this.stCallback=k;this._getStartTimesSendGen()},$_sendStartTimesRecv:function(o){if(this.stCallback){var n=JSON.parse(o);var k={};for(var l in n){var m=n[l];k[m.name+(m.isStart?"-start":"-finish")]={time:m.time,resMem:m.resMem}}this.stCallback({startup:k})}},setCurrentState:function(k){this._setCurrentStateSendGen(k)},_tickRecv:function(){if(this.getListenerCount()===0){return}for(var l=0;l<this.collectors.length;l++){var k=this.collectors[l];this.update(k(this.last))}if(this.dirty){this.dirty=false;this.emit(this.diags);this.setCurrentState(this.diags)}},_runTests:function(k){this.__runTestsSendGen(k)}});e.DiagnosticRegistry=b.singleton({classname:"DiagnosticRegistry",initialize:function(){d.register(this);this.registry={}},findEmitter:function(k){return this.registry[k]},createEmitter:function(k){var l=this.findEmitter(k);if(!l){l=new e.DiagnosticEmitter(k)}return l},listEmitters:function(){var l=[];for(var k in this.registry){l.push(k)}return l},registerEmitter:function(k,l){if(this.registry[k]){NgLogE("Duplicate registration of diagnostic emitter "+k);return false}this.registry[k]=l;return true},deregisterEmitter:function(k,l){if(this.registry[k]!=l){NgLogE("Non-registered deregistration attempt of diagnostic emitter "+k);return false}this.registry[k]=undefined;return true}})}};__ngs._1x={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Buffer=__ngs.r_(__ngs._4f).Buffer}};__ngs._1y={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.UTF8=__ngs.r_(__ngs._4g).UTF8}};__ngs._1z={_c:null,_d:function(){var f={exports:{}};var J=f.exports;this._c=f;var L=function(M){return typeof M==="number"&&M===M};var t=function(M){return typeof M==="number"&&((M%1)===0)};var o=function(M){return typeof M==="string"};var u=function(M){return typeof M==="function"};var H=function(M){return typeof M==="boolean"};var x=function(M){return typeof M==="undefined"};var I=function(M){return true};var v=function(M){return function(N){return N instanceof M}};var r={number:L,integer:t,string:o,"function":u,"boolean":H,"undefined":x,any:I};var q=function(M){if(M instanceof Array){return"["+M+"]"}else{if(typeof M==="string"){return"'"+M+"'"}else{if(typeof M==="function"){return"function"}else{return M}}}};var G=function(N,M,O){this.type=N;this.check=M;this.verify=O};G.prototype.toString=function(){return"#TypeDef("+q(this.type)+")"};var m=function(M){var N;if(typeof M==="string"){N=r[M];if(N===undefined){throw new TypeError("Unknown type '"+M+"'")}}else{if(typeof M==="function"){N=v(M)}}return N};var n=function(M,N){var O=m(M);return new G(M,A(O,false),N)};var y=function(M,N){var O=m(M);return new G(M,A(O,true),N)};var z=function(M,N){var O=m(M);return new G(M,C(O,0,false),N)};var d=function(M,N){var O=m(M);return new G(M,C(O,0,true),N)};var l=function(M,N){var O=m(M);return new G(M,C(O,1,false),N)};var k=function(M,N){var O=m(M);return new G(M,C(O,1,true),N)};var c=function(N){this.typeDefs=N;var M=N[N.length-1];if(typeof M==="function"){this.typeDefs=N.slice(0,-1);this.verify=M}else{this.typeDefs=N}};c.prototype.toString=function(){return"#TypeUnion("+this.typeDefs.join(", ")+")"};var b=function(){var M=Array.prototype.slice.call(arguments);return new c(M)};var F=function(N){var M=N[N.length-1];if(typeof M==="function"){this.typeDefs=N.slice(0,-1);this.verify=M}else{this.typeDefs=N}};F.prototype.toString=function(){return"#TypeArray("+this.typeDefs.join(", ")+")"};var g=function(){var M=Array.prototype.slice.call(arguments);return new F(M)};var p=function(N,M){this.obj=N;this.verify=M};p.prototype.toString=function(){return"#TypeObject()"};var s=function(N,M){if(typeof N!=="object"){throw TypeError("Object expected object parameter")}return new p(N,M)};var A=function(N,M){return function(Q,O,P){if(!(M&&x(O))&&!N(O)){if(typeof Q.type==="function"){return P+" "+q(O)+" is not a valid class instance"}else{return P+" "+q(O)+" is not a valid "+Q.type}}}};var C=function(O,N,M){return function(S,P,Q){var R;if(M&&x(P)){return}if(!(P instanceof Array)){return Q+" "+q(P)+" is not an array"}if(P.length<N){return Q+" "+q(P)+" must have at least "+N+" element"+((N!==1)?"s":"")}for(R=0;R<P.length;R++){if(!O(P[R])){return Q+"["+R+"] "+P[R]+" is not a valid "+S.type}}}};var h=function(O,T,M){if(!(T instanceof Array)){return M+" "+T+" is not an array"}var U=O[O.length-1];var Q=O.length;var S;if(typeof U==="function"){var N=O.length-1;S=U}var R;for(var P=0;P<Q;P++){R=B(O[P],T[P],M+"["+P+"]");if(R){return R}}if(S){R=S(T);if(R){return M+" "+R}}};var j=function(Q,M,O){if(typeof M!=="object"){return O+" "+M+" is not an object"}var N;for(var P in Q){N=B(Q[P],M[P],O+"."+P);if(N){return N}}};var K=function(Q,M,O){var N;var P=Q.check;if(!P){throw new TypeError(Q.type+" is not a valid TypeDef type!")}N=P(Q,M,O);if(N){return N}if(Q.verify){N=Q.verify(M);if(N){return O+" "+N}}};var a=function(Q,M,O){var P,N,R=[];for(P=0;P<Q.typeDefs.length;P++){N=B(Q.typeDefs[P],M,O);if(!N){return}R.push(N)}if(R){return R.join(", ")}if(Q.verify){N=Q.verify(M);if(N){return O+" "+N}}};var E=function(Q,M,O){var P,N;for(P=0;P<Q.typeDefs.length;P++){N=B(Q.typeDefs[P],M[P],O);if(N){return N}}if(Q.verify){N=Q.verify(M);if(N){return O+" "+N}}};var D=function(Q,M,O){if(typeof M!=="object"){return O+" "+M+" is not an object"}var N;for(var P in Q.obj){N=B(Q.obj[P],M[P],O+"."+P);if(N){return N}}if(Q.verify){N=Q.verify(M);if(N){return O+" "+N}}};var B=function(R,M,O){var Q,N,P;if(R instanceof Array){return h(R,M,O)}else{if(R instanceof G){return K(R,M,O)}else{if(R instanceof c){return a(R,M,O)}else{if(R instanceof F){return E(R,M,O)}else{if(R instanceof p){return D(R,M,O)}else{if(typeof R==="object"){return j(R,M,O)}}}}}}};var e=function(){var N=Array.prototype.slice.call(arguments);var R=N.shift();R=Array.prototype.slice.call(R);var P=N;var Q=b.apply(undefined,P);var O;var M=B(Q,R,"arguments");if(M){console.log("validateArgs: "+M);O=new TypeError(M);O.stacklevel=2;throw O}};var w=function(N,P){var M=B(P,N,"arguments");var O;if(M){O=new TypeError(M);O.stacklevel=2;throw O}};J.TypeCheck={validate:w,validateArgs:e,Arg:n,OptionalArg:y,ArgArray:z,OptionalArgArray:d,NonEmptyArgArray:l,OptionalNonEmptyArgArray:k,Or:b,Array:g,Object:s}}};__ngs._20={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._5).Core;a.Diagnostics=c.DiagnosticEmitter.singleton({classname:"Audio_Diagnostics",initialize:function($super){$super("Audio");this._includeDetails=false},includeDetails:function(){return this._includeDetails}})}};__ngs._21={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._5).Core;a.Diagnostics=c.DiagnosticEmitter.singleton({classname:"Storage_Diagnostics",initialize:function($super){$super("Storage")}})}};__ngs._22={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var f=__ngs.r_(__ngs._6).Proc;var b=__ngs.r_(__ngs._t).Class;function e(){this.animationCurve="EaseInOut";return this}var a=c.Commands=b.singleton({classname:"Commands",initialize:function(){var g=__ngs.r_(__ngs._12).ObjectRegistry;g.register(this);this.initializeNative(this.__objectRegistryId);this._tempCBs={};this._tempCBCount=0},FitMode:{None:0,Inside:1,Fill:2,Stretch:3,AspectWidth:5,AspectHeight:6,InsideNoUpscaling:7},Scaling:{Pixels:0,Points:1,Unit:2,Percent:3,iPhone:4},FontStyle:{Normal:0,Bold:1,Italic:2,BoldItalic:3},State:{Normal:0,Focused:1,Selected:2,Pressed:4,Checked:8,Custom:16711680,Disabled:1073741824},EnterKeyType:{Return:0,Done:1,Next:2,Submit:3,Go:4,Search:5,Send:6},InputType:{None:0,TextWithCorrection:1,Password:2,Numeric:4,Email:5,URL:6,Date:7,ANDROID_LANDSCAPE_FULLSCREEN:8},ButtonLayout:{CenterTextOver:0,StackImageLeft:1,StackImageTop:2,StackImageRight:3,StackImageBottom:4,CenterImageOver:5},SwipeDirection:{Left:1,Right:2,Up:3,Down:4},OrientationFlag:{Landscape:1,Portrait:2},Autodetect:{None:0,Phone:1},ResourceError:{None:0,Other:-1,File_Not_Found:-2,Out_Of_Memory:-3,Connectivity_Error:-4,Decode_Failed:-5},ScreenshotType:{Normal:0,GLOnly:1,UIOnly:2},_classId:337,$_eventOccurredRecvGen:function(h){if((h.length-h.idx)!==1){NgLogE("Could not parse due to wrong argument count in Commands.eventOccurred from command: "+h);return false}var g=f.parseObject(h[h.idx++]);if(g===undefined){NgLogE("Could not parse eventObject in Commands.eventOccurred from command: "+h);return false}return this._eventOccurredRecv(g)},$initializeNative:function(g){f.appendToCommandString(22151167,[+g])},$create:function(g,h){f.appendToCommandString(22151166,[+g,f.encodeString(h)])},destroy:function(){f.appendToCommandString(22085635,this)},setActive:function(g){f.appendToCommandString(22085636,this,[(g?1:0)])},setTouchable:function(g){f.appendToCommandString(22085637,this,[(g?1:0)])},enableEvent:function(g){f.appendToCommandString(22085638,this,[f.encodeString(g)])},disableEvent:function(g){f.appendToCommandString(22085639,this,[f.encodeString(g)])},setIsVisible:function(g){f.appendToCommandString(22085641,this,[(g?1:0)])},setEnabled:function(g){f.appendToCommandString(22085642,this,[(g?1:0)])},setState:function(g){f.appendToCommandString(22085643,this,[+g])},addSubview:function(g,h){f.appendToCommandString(22085644,this,[+g,+h])},removeFromSuperview:function(){f.appendToCommandString(22085645,this)},$startAnimation:function(g,h){f.appendToCommandString(22151154,[+g,f.encodeString(h)])},$executeAnimation:function(g){f.appendToCommandString(22151153,[f.encodeObject(g)])},setFrame:function(g,l,j,k){f.appendToCommandString(22085648,this,[+g,+l,+j,+k])},setOrigin:function(g,h){f.appendToCommandString(22085649,this,[+g,+h])},setAnchor:function(g,h){f.appendToCommandString(22085650,this,[+g,+h])},setSize:function(g,j){f.appendToCommandString(22085651,this,[+g,+j])},setTransform:function(k,h,m,l,j,g){f.appendToCommandString(22085652,this,[+k,+h,+m,+l,+j,+g])},setBackgroundColor:function(g){f.appendToCommandString(22085653,this,[f.encodeString(g)])},setImage:function(h,g){f.appendToCommandString(22085654,this,[+h,f.encodeString(g)])},setImageBorder:function(g,h){f.appendToCommandString(22085655,this,[+g,f.encodeObject(h)])},setImageFitMode:function(g){f.appendToCommandString(22085656,this,[+g])},setImageGravity:function(g,h){f.appendToCommandString(22085657,this,[+g,+h])},setImageOrigin:function(g,h){f.appendToCommandString(22085658,this,[+g,+h])},setImageAnchor:function(g,h){f.appendToCommandString(22085659,this,[+g,+h])},setImageSize:function(g,j){f.appendToCommandString(22085660,this,[+g,+j])},setImageInsets:function(j,k,g,h){f.appendToCommandString(22085661,this,[+j,+k,+g,+h])},setImageTransform:function(k,h,m,l,j,g){f.appendToCommandString(22085662,this,[+k,+h,+m,+l,+j,+g])},setText:function(g,h){f.appendToCommandString(22085663,this,[+g,f.encodeString(h)])},setTextColor:function(g,h){f.appendToCommandString(22085664,this,[+g,f.encodeString(h)])},setTextFont:function(h,g){f.appendToCommandString(22085665,this,[+h,f.encodeString(g)])},setTextShadow:function(g,h){f.appendToCommandString(22085666,this,[+g,f.encodeString(h)])},setTextSize:function(g){f.appendToCommandString(22085667,this,[+g])},setTextGravity:function(g,h){f.appendToCommandString(22085668,this,[+g,+h])},setTextInsets:function(j,k,g,h){f.appendToCommandString(22085669,this,[+j,+k,+g,+h])},setTextOverflow:function(g){f.appendToCommandString(22085670,this,[+g])},setTextMaxLines:function(g){f.appendToCommandString(22085671,this,[+g])},setTextMinSize:function(g){f.appendToCommandString(22085672,this,[+g])},setTitle:function(g,h){f.appendToCommandString(22085673,this,[+g,f.encodeString(h)])},setTitleColor:function(g,h){f.appendToCommandString(22085674,this,[+g,f.encodeString(h)])},setTitleFont:function(h,g){f.appendToCommandString(22085675,this,[+h,f.encodeString(g)])},setTitleShadow:function(g,h){f.appendToCommandString(22085676,this,[+g,f.encodeString(h)])},setTitleSize:function(g){f.appendToCommandString(22085677,this,[+g])},setTitleGravity:function(g,h){f.appendToCommandString(22085678,this,[+g,+h])},setTitleInsets:function(j,k,g,h){f.appendToCommandString(22085679,this,[+j,+k,+g,+h])},setTitleOverflow:function(g){f.appendToCommandString(22085680,this,[+g])},setTitleMaxLines:function(g){f.appendToCommandString(22085681,this,[+g])},setTitleMinSize:function(g){f.appendToCommandString(22085682,this,[+g])},setGradient:function(g,h){f.appendToCommandString(22085683,this,[+g,f.encodeObject(h)])},setStringValue:function(g){f.appendToCommandString(22085684,this,[f.encodeString(g)])},setFloatValue:function(g){f.appendToCommandString(22085685,this,[+g])},setIntValue:function(g){f.appendToCommandString(22085686,this,[+g])},setBoolValue:function(g){f.appendToCommandString(22085687,this,[(g?1:0)])},setButtonLayout:function(g){f.appendToCommandString(22085688,this,[+g])},setContentInsets:function(j,k,g,h){f.appendToCommandString(22085689,this,[+j,+k,+g,+h])},setBarGradient:function(g,h){f.appendToCommandString(22085690,this,[+g,f.encodeObject(h)])},setPlaceholderText:function(g){f.appendToCommandString(22085691,this,[f.encodeString(g)])},setPlaceholderTextColor:function(g){f.appendToCommandString(22085692,this,[f.encodeString(g)])},setPlaceholderTextShadow:function(g){f.appendToCommandString(22085693,this,[f.encodeString(g)])},setEnterKeyType:function(g){f.appendToCommandString(22085694,this,[+g])},setInputType:function(g){f.appendToCommandString(22085695,this,[+g])},setChecked:function(g){f.appendToCommandString(22085696,this,[(g?1:0)])},setScrollPosition:function(g,h){f.appendToCommandString(22085697,this,[+g,+h])},setScrollableSize:function(g,j){f.appendToCommandString(22085698,this,[+g,+j])},setSections:function(g){f.appendToCommandString(22085699,this,[f.encodeObject(g)])},setTitleView:function(g){f.appendToCommandString(22085700,this,[+g])},setSourceDocument:function(g){f.appendToCommandString(22085701,this,[f.encodeString(g)])},setChoices:function(h,j,g){f.appendToCommandString(22085702,this,[f.encodeObject(h),+j,+g])},show:function(){f.appendToCommandString(22085703,this)},hide:function(){f.appendToCommandString(22085704,this)},setPostData:function(g){f.appendToCommandString(22085705,this,[f.encodeString(g)])},loadPostURL:function(g){f.appendToCommandString(22085706,this,[f.encodeString(g)])},loadGetURL:function(g){f.appendToCommandString(22085707,this,[f.encodeString(g)])},loadURL:function(g,j,h){f.appendToCommandString(22085708,this,[f.encodeString(g),f.encodeObject(j),+h])},stopLoading:function(){f.appendToCommandString(22085709,this)},reload:function(){f.appendToCommandString(22085710,this)},invoke:function(g){f.appendToCommandString(22085711,this,[f.encodeString(g)])},goBack:function(){f.appendToCommandString(22085712,this)},goForward:function(){f.appendToCommandString(22085713,this)},setBasicAuthCredentials:function(g){f.appendToCommandString(22085714,this,[f.encodeObject(g)])},setRightImage:function(h,g){f.appendToCommandString(22085715,this,[+h,f.encodeString(g)])},setRightImageBorder:function(g,h){f.appendToCommandString(22085716,this,[+g,f.encodeObject(h)])},setRightImageFitMode:function(g){f.appendToCommandString(22085717,this,[+g])},setRightImageGravity:function(g,h){f.appendToCommandString(22085718,this,[+g,+h])},setRightImageOrigin:function(g,h){f.appendToCommandString(22085719,this,[+g,+h])},setRightImageAnchor:function(g,h){f.appendToCommandString(22085720,this,[+g,+h])},setRightImageSize:function(g,j){f.appendToCommandString(22085721,this,[+g,+j])},setRightImageInsets:function(j,k,g,h){f.appendToCommandString(22085722,this,[+j,+k,+g,+h])},setRightImageTransform:function(k,h,m,l,j,g){f.appendToCommandString(22085723,this,[+k,+h,+m,+l,+j,+g])},$setStatusBarHidden:function(g){f.appendToCommandString(22151076,[(g?1:0)])},pauseAds:function(){f.appendToCommandString(22085725,this)},resumeAds:function(){f.appendToCommandString(22085726,this)},setAdRefreshRate:function(g){f.appendToCommandString(22085727,this,[+g])},setAdAllowAutoplay:function(g){f.appendToCommandString(22085728,this,[(g?1:0)])},setAlpha:function(g){f.appendToCommandString(22085729,this,[+g])},postURL:function(g,h){f.appendToCommandString(22085730,this,[f.encodeString(g),f.encodeString(h)])},setProgressGradient:function(g,h){f.appendToCommandString(22085731,this,[+g,f.encodeObject(h)])},setSecondaryGradient:function(g,h){f.appendToCommandString(22085732,this,[+g,f.encodeObject(h)])},setProgress:function(g,h){f.appendToCommandString(22085733,this,[+g,+h])},useForUpdateProgress:function(g){f.appendToCommandString(22085734,this,[(g?1:0)])},setDarkStyle:function(g){f.appendToCommandString(22085735,this,[(g?1:0)])},$doCompositeImages:function(g,l,j,k,m){f.appendToCommandString(22151064,[+g,+l,f.encodeString(j),f.encodeObject(k),f.encodeString(m)])},$doChooseCamera:function(g,l,j,k,m){f.appendToCommandString(22151062,[+g,+l,f.encodeString(j),f.encodeObject(k),f.encodeString(m)])},setScrollable:function(g){f.appendToCommandString(22085739,this,[(g?1:0)])},setZoomable:function(g){f.appendToCommandString(22085740,this,[(g?1:0)])},addAnnotation:function(g){f.appendToCommandString(22085741,this,[+g])},removeAnnotation:function(g){f.appendToCommandString(22085742,this,[+g])},selectAnnotation:function(g){f.appendToCommandString(22085743,this,[+g])},setRegion:function(l,k,g,h,j){f.appendToCommandString(22085744,this,[+l,+k,+g,+h,(j?1:0)])},setView:function(g){f.appendToCommandString(22085745,this,[+g])},setCoordinate:function(h,g){f.appendToCommandString(22085746,this,[+h,+g])},setCalloutTitle:function(g){f.appendToCommandString(22085747,this,[f.encodeString(g)])},setCalloutSubtitle:function(g){f.appendToCommandString(22085748,this,[f.encodeString(g)])},setCalloutEnabled:function(g){f.appendToCommandString(22085749,this,[(g?1:0)])},setCalloutLeftView:function(g){f.appendToCommandString(22085750,this,[+g])},setCalloutRightView:function(g){f.appendToCommandString(22085751,this,[+g])},setCenterOffset:function(g,h){f.appendToCommandString(22085752,this,[+g,+h])},$doChoosePhoto:function(g,l,j,k,m,n){f.appendToCommandString(22151047,[+g,+l,f.encodeString(j),f.encodeObject(k),f.encodeString(m),+n])},setScrollIndicatorsVisible:function(g){f.appendToCommandString(22085754,this,[(g?1:0)])},$measureText:function(k,g,l,j,n,m){f.appendToCommandString(22151045,[f.encodeString(k),+g,+l,f.encodeString(j),+n,f.encodeString(m)])},setFocus:function(g){f.appendToCommandString(22085756,this,[(g?1:0)])},setViewportEnabled:function(g){f.appendToCommandString(22085757,this,[(g?1:0)])},clearAnimations:function(){f.appendToCommandString(22085758,this)},setStyle:function(g){f.appendToCommandString(22085759,this,[+g])},setVisibleInOrientations:function(g){f.appendToCommandString(22085760,this,[+g])},setAutodetection:function(g){f.appendToCommandString(22085761,this,[+g])},playVideo:function(h,g){f.appendToCommandString(22085762,this,[f.encodeString(h),f.encodeString(g)])},setLineHeight:function(g){f.appendToCommandString(22085763,this,[+g])},$hideKeyboard:function(){f.appendToCommandString(22151036)},$takeScreenshot:function(g,l,j,k,m){f.appendToCommandString(22151035,[+g,+l,f.encodeString(j),f.encodeObject(k),f.encodeString(m)])},setPluginsEnabled:function(g){f.appendToCommandString(22085766,this,[(g?1:0)])},$sendEmail:function(g,h){f.appendToCommandString(22151033,[f.encodeObject(g),f.encodeString(h)])},$sendSMS:function(g,h){f.appendToCommandString(22151032,[f.encodeObject(g),f.encodeString(h)])},$sendTweet:function(g,h){f.appendToCommandString(22151031,[f.encodeObject(g),f.encodeString(h)])},$getAvailableSharingServices:function(g){f.appendToCommandString(22151030,[f.encodeString(g)])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[337]=this._instance||this;PROC_METHOD_TABLE[22151160]=this.prototype._eventOccurredRecvGen},_eventOccurredRecv:function(g){(a.Window||__ngs.r_(__ngs._b).Window).doCommand(g)},registerTemporaryCallback:function(h){if(typeof h!="function"){return null}var g=(++this._tempCBCount).toString(36);a._tempCBs[g]=h;return g},takeTemporaryCallback:function(h){var g=a._tempCBs[h];delete a._tempCBs[h];return g},animate:function(k,l,m){if(typeof k=="function"){var g=(typeof m=="function")?m:l;var j=(typeof l=="number")?l:m;if(typeof j!="number"){j=400}a.startAnimation(j,a.registerTemporaryCallback(m));var h=new e();k(h);a.executeAnimation(h)}}});c.Commands.instantiate()}};__ngs._23={_c:null,_d:function(){var c={exports:{}};var e=c.exports;this._c=c;var b=__ngs.r_(__ngs._24).Element;var j=__ngs.r_(__ngs._22).Commands;var a=__ngs.r_(__ngs._25).Rect;var d=__ngs.r_(__ngs._12).ObjectRegistry;var h=__ngs.r_(__ngs._4h).Style;var f={normal:j.State.Normal,focused:j.State.Focused,pressed:j.State.Pressed,disabled:j.State.Disabled,selected:j.State.Focused,highlighted:j.State.Pressed};var g=e.AbstractView=b.subclass({type:"AbstractView",initialize:function($super,k){if(g._init){g._init()}this._assignedVisible=true;$super(k)},destroy:function($super){this.removeFromParent();$super()},getParent:function(){return this._parent},addToParent:function(k,l){k.addChild(this,l)},removeFromParent:function(){if(this._parent&&!this._parent._destroyed){this._parent.removeChild(this);this._parent=null}return this},addState:function(k){this.setState(this._state|k)},clearState:function(k){this.setState(this._state&~k)},getRoot:function(){return this._parent?this._parent.getRoot():undefined},getFrameIn:function(s){if(!s){return undefined}if(UI.Window===s){s=UI.Window.document}var n=this.getFrame();if(!n){return undefined}n=[0,0,n[2],n[3]];if(this===s){return n}var m=[];var t={};var w=this;do{t[w]=true;m.push(w);if(w===s){break}w=w.getParent()}while(w);var k=[];w=s;while(w&&!t[w]){k.push(w);w=w.getParent()}if(!w){var x=this.getRoot();if(x&&s.getRoot()){w=x;k.pop()}else{return undefined}}var v=m.indexOf(w);for(var r=v,o=v+k.length;r<o;++r){m[r]=k.pop()}for(var q=0;q<r;++q){var u=m[q].getFrame();if(u){if(typeof m[q].getFrameOffset==="function"){var p=m[q].getFrameOffset();u[0]+=p[0];u[1]+=p[1]}n[0]+=(q<v?u[0]:-u[0]);n[1]+=(q<v?u[1]:-u[1])}else{return undefined}}return n},_setVisible:function(l){var m=l&&this._assignedVisible&&this._parent&&this._parent._visible;if(this._visible!=m){this._visible=m;var k=(l?this.getOnAppear():this.getOnDisappear());if(typeof k=="function"){k.call(this)}}},clearAnimations:j.clearAnimations,$synthesizePropertyWithState:function(o,n){function k(p,t,r){var q="get"+p;var u="set"+p;var v=function(){return this[q].call(this,r)};var s=function(w){return this[u].call(this,w,r)};this.registerAccessors(t+p,v,s)}b.synthesizePropertyWithState.call(this,o,n);var l=o.charAt(0).toUpperCase()+o.substr(1);for(var m in f){k.call(this,l,m,f[m])}}});g._init=function(){delete g._init;if(b._init){b._init()}var n=function(){return this._visible};var m=function(o){this._assignedVisible=o;j.setIsVisible.call(this,o);this._setVisible(o)};g.registerAccessors("visible",n,m);g.synthesizeProperty("backgroundColor",j.setBackgroundColor);g.synthesizeProperty("enabled",function(o){this[(o?"clearState":"setState")](j.State.Disabled)});g.synthesizeProperty("state",j.setState);var l=function(){return this._frame};var k=function(p){if(this.sizeChanged){var o=this._frame?this._frame[2]:0;var q=this._frame?this._frame[3]:0}if(p instanceof a){this._frame=p.array()}else{if(p instanceof Array){this._frame=p}else{this._frame=Array.prototype.slice.call(arguments)}}j.setFrame.apply(this,this._frame);if(this.sizeChanged&&((o^this._frame[2])|(q^this._frame[3]))){this.sizeChanged(this._frame[2],this._frame[3],o,q)}};g.registerAccessors("frame",l,k);g.synthesizePropertyWithState("gradient",j.setGradient);g.synthesizeProperty("touchable",j.setTouchable);g.synthesizeProperty("alpha",j.setAlpha);g.synthesizeProperty("style",function(o){if(o instanceof h){j.setStyle.call(this,d.objectToId(o))}});g.registerEventType("appear");g.registerEventType("disappear");g.registerEventType("click");g.registerEventType("clickDown");g.registerEventType("clickCancel");g.registerEventType("swipe");g.registerEventType("longPress")}}};__ngs._24={_c:null,_d:function(){var f={exports:{}};var e=f.exports;this._c=f;var d=__ngs.r_(__ngs._t).Class;var a=__ngs.r_(__ngs._22).Commands;var c=__ngs.r_(__ngs._12).ObjectRegistry;var b=e.Element=d.subclass({$subclass:function(h){if(typeof this._init=="function"){this._init()}if(!h.classname&&h.type){var g=(""+h.type).replace(/\W/g,"_");h.classname="UI_"+g.charAt(0).toUpperCase()+g.substr(1)}return d.subclass.apply(this,arguments)},classname:"UI_Element",initialize:function(j){if(b._init){b._init()}this.register();var h=this._eventNames;if(h){for(var m in h){if(this[h[m]]){a.enableEvent.call(this,m)}}}var l=this._setters;if(l){for(var g in j){if(typeof l[g]=="function"){try{l[g].call(this,j[g])}catch(m){NgLogD("Unable to set "+this.type+"."+g)}}}}return this},register:function(){try{c.register(this);a.create(this.__objectRegistryId,this.type||this.classname)}catch(g){}finally{return this.__objectRegistryId}},retain:function(){(this.__retainCount)?++this.__retainCount:(this.__retainCount=1);return this},release:function(){if(--this.__retainCount===0){this.destroy()}},getAttribute:function(h){var g=this._getters[h];return(typeof g=="function")?g.call(this):undefined},setAttribute:function(g,h){var j=this._setters[g];if(typeof j=="function"){return j.call(this,h)}else{NgLogD("Unable to set "+this.type+"."+g)}return this},setAttributes:function(l){var h=this._setters;if(h){for(var g in l){if(typeof h[g]=="function"){try{h[g].call(this,l[g])}catch(j){NgLogD("Unable to set "+this.type+"."+g)}}}}return this},getAttributes:function(k){var g={};var j;if(k instanceof Array){for(var h=0;h<k.length;h++){j=k[h];g[j]=this._getters[j].call(this)}}else{for(j in this._getters){g[j]=this._getters[j].call(this)}}return g},enableEvent:a.enableEvent,toString:function(){return this.type+"("+this.__objectRegistryId+")"},destroy:function(){a.destroy.call(this);c.unregister(this);delete this.prototype;var k=function(){var l=new Error("Object is destroyed.");NgLogD(l.stack);throw l};for(var g in this){var h=(g.substring(0,1)==="_"||g.substring(0,2)==="on");if(this.hasOwnProperty(g)||!h){var j=typeof this[g];delete this[g];this[g]=("function"===j?k:undefined)}}this._destroyed=true},registerCallback:function(h,g){var j=++this.callbackCounter;var k=this;this.callbacks[j]=function(n,l){try{h(n,l);if(g){delete n.callbacks[j]}}catch(m){NgHandleException(m)}};return j},performCallback:function(h){var g=this.callbacks[h.callbackId];if(g){g(this,h.arguments)}},performEventCallback:function(j){try{var g=this._eventNames[j.eventType];var h=this["_"+g]||this[g];if(typeof h=="function"){h.call(this,j)}}catch(k){NgHandleException(k)}},$registerAccessors:function(l,r,p,n){var o=l.charAt(0).toUpperCase()+l.substr(1);var k=Boolean(n||false);var j=(this instanceof b)?this:this.prototype;var g;if(typeof r=="function"){if(!j.hasOwnProperty("_getters")){try{g=function(){return this};var q=j.superclass._getters;if(q){g.prototype=q}j._getters=new g()}catch(m){}}if(k){j["get"+o]=function(){NgLogD("WARNING: Use of get"+o+"() is deprecated. "+n);r.apply(this,arguments)}}else{j["get"+o]=r}j._getters[l]=r}if(typeof p=="function"){if(!j.hasOwnProperty("_setters")){try{g=function(){return this};var h=j.superclass._setters;if(h){g.prototype=h}j._setters=new g()}catch(m){}}if(k){j["set"+o]=function(){NgLogD("WARNING: Calling set"+o+"() is deprecated. "+n);p.apply(this,arguments)}}else{j["set"+o]=p}j._setters[l]=p}},$registerEventType:function(l){var n="on"+l.charAt(0).toUpperCase()+l.substr(1);var k="_"+n;var j=this.prototype;var p=function(){return this[k]||this[n]};var o=function(r){var q=(typeof r=="function");if(q){this[k]=r}else{delete this[k]}this.enableEvent(l,q)};if(!j.hasOwnProperty("_eventNames")){try{var h=function(){return this};var g=j.superclass._eventNames;if(g){h.prototype=g}j._eventNames=new h()}catch(m){}}j._eventNames[l]=n;this.registerAccessors(n,p,o);j.__defineGetter__(n.toLowerCase(),p);j.__defineSetter__(n.toLowerCase(),o)},$synthesizePropertyWithState:function(j,g){var l="_"+j+"Map";var h;if(j){h=function(m,n){n|=0;(this[l]||(this[l]={}))[n]=m;g.call(this,n,m);return this}}else{h=function(m,n){g.call(this,(n|0),m);return this}}var k=function(m){return(this[l]||0)[(m|0)]};this.registerAccessors(j,k,h)},$synthesizeCompoundProperty:function(j,g){var k="_"+j;var h;if(g){h=function(l){this[k]=(l instanceof Array)?l:Array.prototype.slice.call(arguments);g.apply(this,this[k]);return this}}else{h=function(l){this[k]=(l instanceof Array)?l:Array.prototype.slice.call(arguments);return this}}this.registerAccessors(j,function(){return this[k]},h)},$synthesizeProperty:function(j,g){var k="_"+j;var h;if(g){h=function(l){this[k]=l;g.apply(this,arguments);return this}}else{h=function(l){this[k]=l;return this}}this.registerAccessors(j,function(){return this[k]},h)},$bindPropertyState:function(j,m,k){var g=j[0].toUpperCase()+j.substr(1);var h="get"+g;var n="set"+g;var o=function(){return this[h].call(this,k)};var l=function(p){return this[n].call(this,p,k)};this.registerAccessors(m+g,o,l)}});b._init=function(){delete b._init;b.registerEventType("load");b.registerEventType("unload")}}};__ngs._25={_c:null,_d:function(){var e={exports:{}};var g=e.exports;this._c=e;var c=__ngs.r_(__ngs._t).Class;var k=__ngs.r_(__ngs._22).Commands;var h=__ngs.r_(__ngs._7).Capabilities;var d=g.ViewGeometry={};var b=d.Scale=g.Scale=c.singleton({initialize:function(){var l=h.getScreenUnits();this.iOSConversion=l;this.pointConversion=this.iOSConversion*160/72},Pixels:k.Scaling.Pixels,Points:k.Scaling.Points,Unit:k.Scaling.Unit,Percent:k.Scaling.Percent,iPhone:k.Scaling.iPhone,pointConversion:1,iOSConversion:1,getScale:function(l,m){switch(+l){case this.Points:return this.pointConversion;case this.Unit:return m;case this.Percent:return m/100;case this.iPhone:return this.iOSConversion}return 1}});var f=d.Gravity=g.Gravity={TopLeft:[0,0],TopCenter:[0.5,0],TopRight:[1,0],Left:[0,0.5],Center:[0.5,0.5],Right:[1,0.5],BottomLeft:[0,1],BottomCenter:[0.5,1],BottomRight:[1,1]};var j=d.FitModes=g.FitModes=k.FitMode;var a=d.Rect=g.Rect=c.subclass({initialize:function(l){if(l instanceof this.constructor){this.x=l.x;this.y=l.y;this.w=l.w;this.h=l.h}else{if(l instanceof Array){if(arguments.length==2&&arguments[0].length>=2&&arguments[1] instanceof Array&&arguments[1].length>=2){this.x=arguments[0][0];this.y=arguments[0][1];this.w=arguments[1][0];this.h=arguments[1][1]}else{if(arguments.length==1&&l.length>=4){this.x=l[0];this.y=l[1];this.w=l[2];this.h=l[3]}else{NgLogD("UI.ViewGeometry.Rect initialized with unparseable Array(s)")}}}else{if(arguments.length==4){this.x=arguments[0];this.y=arguments[1];this.w=arguments[2];this.h=arguments[3]}}}return this},isEmpty:function(){return(this.w*this.h<=0)||isNaN(this.x)||isNaN(this.y)||isNaN(this.w)||isNaN(this.h)},copy:function(){return new (this).constructor(this)},array:function(){return[this.x,this.y,this.w,this.h]},inset:function(p,s,m,n,o){if(arguments.length>4){var u=b.getScale(o,this.w);var q=b.getScale(o,this.h);p=Math.floor(p*q);s=Math.floor(s*u);m=Math.floor(m*q);n=Math.floor(n*u)}if(arguments.length<2){s=p}if(arguments.length<4){m=p;n=s}this.y+=p;this.h-=p+m;this.x+=n;this.w-=n+s;return this},sliceVertical:function(l,m){if(arguments.length>1){l=Math.floor(l*b.getScale(m,this.h))}var n=this.copy();if(l<0){n.h=-l;this.h+=l;n.y+=this.h}else{n.h=l;this.y+=l;this.h-=l}return n},sliceHorizontal:function(n,l){if(arguments.length>1){n=Math.floor(n*b.getScale(l,this.w))}var m=this.copy();if(n<0){m.w=-n;this.w+=n;m.x+=this.w}else{m.w=n;this.x+=n;this.w-=n}return m},toString:function(){return"Rect: {"+this.array().join(",")+"}"},getGrid:function(v,p,m){m=(m===true);var o=Math.floor(this.w/p);var u=Math.floor(this.h/v);var n=[];for(var t=0;t<v;t++){var s=[];for(var q=0;q<p;q++){var l=new this.constructor(this.x+q*o,this.y+t*u,o,u);(m?n:s).push(l)}if(!m){n.push(s)}}return n}})}};__ngs._26={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var b=__ngs.r_(__ngs._24).Element;var d=__ngs.r_(__ngs._4i).ViewParent;var a=__ngs.r_(__ngs._22).Commands;var f=c.WindowLayer=b.subclass({type:"windowlayer",initialize:function($super,g){if(f.init){f.init()}$super(g);if(f._init){f._init()}d.initialize.call(this);this._visible=true},getRoot:function(){return this},getParent:function(){return undefined},getChildCount:d.getChildCount,getChildren:d.getChildren,addChild:d.addChild,removeChild:d.removeChild});f.init=function(){delete f._init;if(b._init){b._init()}f.synthesizeProperty("level",a.setIntValue)}}};__ngs._27={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;
/*!
sprintf() for JavaScript 0.6

Copyright (c) Alexandru Marasteanu <alexaholic [at) gmail (dot] com>
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:
    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.
    * Neither the name of sprintf() for JavaScript nor the
      names of its contributors may be used to endorse or promote products
      derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL Alexandru Marasteanu BE LIABLE FOR ANY
DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


Changelog:
2007.04.03 - 0.1:
 - initial release
2007.09.11 - 0.2:
 - feature: added argument swapping
2007.09.17 - 0.3:
 - bug fix: no longer throws exception on empty paramenters (Hans Pufal)
2007.10.21 - 0.4:
 - unit test and patch (David Baird)
2010.05.09 - 0.5:
 - bug fix: 0 is now preceeded with a + sign
 - bug fix: the sign was not at the right position on padded results (Kamal Abdali)
 - switched from GPL to BSD license
2010.05.22 - 0.6:
 - reverted to 0.4 and fixed the bug regarding the sign of the number 0
 Note:
 Thanks to Raphael Pigulla <raph (at] n3rd [dot) org> (http://www.n3rd.org/)
 who warned me about a bug in 0.5, I discovered that the last update was
 a regress. I appologize for that.
**/
a.sprintf=function(){var r=function(f,c){for(var p=[];c>0;p[--c]=f){}return p.join("")};var h=[];var k=false;var l=1;var j;if(typeof(arguments[0])=="object"&&arguments[0].length){k=true;for(j=0;j<arguments[0].length;++j){h[j]=arguments[0][j]}}else{for(j=0;j<arguments.length;++j){h[j]=arguments[j]}}j=0;var u,n=h[j++],e=[],g,d,q,t,v="";while(n){if(g=/^[^\x25]+/.exec(n)){e.push(g[0])}else{if(g=/^\x25{2}/.exec(n)){e.push("%")}else{if(g=/^\x25(?:(\d+)\$)?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(n)){if(((u=h[g[1]||j++])===null)||(u===undefined)){throw ("Too few arguments.")}if(/[^s]/.test(g[7])&&(typeof(u)!="number")){throw ("Expecting number but found "+typeof(u))}switch(g[7]){case"b":u=u.toString(2);break;case"c":u=String.fromCharCode(u);break;case"d":u=parseInt(u,10);break;case"e":u=g[6]?u.toExponential(g[6]):u.toExponential();break;case"f":u=g[6]?parseFloat(u).toFixed(g[6]):parseFloat(u);break;case"o":u=u.toString(8);break;case"s":u=((u=String(u))&&g[6]?u.substring(0,g[6]):u);break;case"u":u=Math.abs(u);break;case"x":u=u.toString(16);break;case"X":u=u.toString(16).toUpperCase();break}u=(/[def]/.test(g[7])&&g[2]&&u>=0?"+"+u:u);q=g[3]?g[3]=="0"?"0":g[3].charAt(1):" ";t=g[5]-String(u).length-v.length;d=g[5]?r(q,t):"";e.push(v+(g[4]?u+d:d+u));if(k){++l}}else{throw ("Huh ?!")}}}n=n.substring(g[0].length)}if(k&&l>0){arguments[0].splice(0,l)}return e.join("")}}};__ngs._28={_c:null,_d:function(){var c={exports:{}};var r=c.exports;this._c=c;var a=__ngs.r_(__ngs._4j);var t=__ngs.r_(__ngs._5);var e=__ngs.r_(__ngs._4).Device;var n=__ngs.r_(__ngs._o);var k=__ngs.r_(__ngs._s).Network;var b=__ngs.r_(__ngs._n).LocalizedString;var q=__ngs.r_(__ngs._n).Localization;var p=__ngs.r_(__ngs._2j).Logger;var j=__ngs.r_(__ngs._1k).Analytics;var o=__ngs.r_(__ngs._q).MobageAnalytics;var m=r.PRLogD=function(u){if(p.shouldLog(null,"PlusRequest")){var v=Array.prototype.slice.call(arguments);v.unshift("PlusRequest: ");p.debug.apply(p,v)}};var l=r.PRLogE=function(u){var v=Array.prototype.slice.call(arguments);v.unshift("PlusRequest: ");p.error.apply(p,v)};var g=true;var d=function(x,v){var w=function(z){var y=""+z.substr(0,1).toUpperCase()+z.substr(1,z.length-1);x.prototype["set"+y]=function(A){this[z]=A};x.prototype["get"+y]=function(){return this[z]}};for(var u=0;u<v.length;u++){w(v[u])}};var f=function(){f._initialize();this.secure=(f.getServerMode()==f.serverModes.production);this.apiMethod="";this.attachments=[];this.httpMethod="GET";this.httpHeaders={};this.authenticationType=f.authenticationTypes.OAuth1};f.newBankRequest=function(){var v=new f();var u=(f.apiDomain.match(/\-sandbox\./)!==null);var w="bank";if(u){w=w+"-sandbox"}var x=f.getServerMode();if(x==f.serverModes.integration){v.setApiDomain(w+".integration.mobage.com")}else{if(x==f.serverModes.staging){v.setApiDomain(w+".staging.mobage.com")}else{if(x==f.serverModes.production){v.setApiDomain(w+".mobage.com")}else{v.setApiDomain("bank-sandbox.mobage.com")}}}v.setAuthenticationType(f.authenticationTypes.OAuth2);v.setSecure(true);return v};f._initialize=function(){var v=NgApplication.getInstance();var u=t.Core.Capabilities;m("Got capabilities! "+u);if(!f.apiDomain){NgLogD("Plus: Could not find Plus server url in configuration.json. Defaulting to partner.");if(u.getSocialServer()){f.apiDomain=u.getSocialServer();NgLogD("PlusRequest: Social server! "+f.apiDomain)}else{f.setServerMode(f.serverModes.partner)}}f._initialize=function(){}};d(f,["apiMethod","entityTag","secure","httpHeaders","httpMethod","postBody","apiDomain","authenticationType"]);f.apiVersion="1";f.ERROR_NO_CONNECTION="No internet connection";f.platformAccessToken=null;f.platformAccessSecret=null;f.platformConsumerKey=null;f.platformConsumerSecret=null;f.__defineSetter__("apiDomain",function(u){if(u||!f._apiDomain){f._apiDomain=u}});f.__defineGetter__("apiDomain",function(){var u=f._apiDomain;if(!u){u="app.mobage.com"}return u});f.apiDomain=null;f.serverModes={staging:"staging",integration:"integration",partner:"sandbox",sandbox:"sandbox",production:"production",unknown:"unknown"};f.authenticationTypes={OAuth1:"OAuth1",OAuth2:"OAuth2",None:"None"};f.getServerMode=function(){f._initialize();var w=f.apiDomain;var u=f.serverModes;var x=u.unknown;var v=NgLogD;if(w=="staging.plusplus.com"||w=="app-staging.mobage.com"||w=="app.staging.mobage.com"||w=="app-sandbox.staging.mobage.com"){x=u.staging}else{if(w=="partner.plusplus.com"||w=="app-sandbox.mobage.com"){x=u.partner}else{if(w=="integration.plusplus.com"||w=="app-staging.mobage.com"||w=="app.integration.mobage.com"||w=="app-sandbox.integration.mobage.com"){x=u.integration}else{if(w=="app.plusplus.com"||w=="app.mobage.com"){x=u.production;v=m}}}}v("Getting server mode: "+x);return x};f.setServerMode=function(v){var u=f.serverModes;if(v==u.staging){f.apiDomain="app.staging.mobage.com"}else{if(v==u.partner){f.apiDomain="app-sandbox.mobage.com"}else{if(v==u.integration){f.apiDomain="app.integration.mobage.com"}else{if(v==u.production){f.apiDomain="app.mobage.com"}}}}};f.serverModeIsProduction=function(){return(f.getServerMode()===f.serverModes.production)};f.prototype.sendRetry=function(u){this.send(function(w,x,y,v){if(v===401){n.Session.getCurrentSession().loginWithExistingSession(function(){NgLogD("Mobage/PluseRequest login/send request");this.send(u)}.bind(this))}else{u(w,x,y,v)}}.bind(this))};f.prototype.send=function(u){u=u||f.noOp;var v=this._prepareRequest();this.sendAux(v,u)};f.prototype.sendAux=function(v,u){u=u||f.noOp;var x=e.NetworkEmitter.getLastStatus();if(x===e.NetworkEmitter.Status.None){u(f.ERROR_NO_CONNECTION);return}var y;var w=this._getRequestURL();NgLogD("PlusRequest: URL "+w);v.onreadystatechange=function(){if(v.readyState==4){y=v.getUnflattenedResponseHeaders();var B=v.responseText;var z=v.error;var D=v.getResponseHeader("Content-Type")||"text";NgLogD("PlusRequest: got a Network.XHR response for "+w);m("Network.XHR response for "+w+" is:\n"+B);NgLogD("Request status = "+v.status);if(D.indexOf("application/json")!=-1){try{B=JSON.parse(B)}catch(C){NgLogE("EXCEPTION - Could not parse JSON data: "+C+" - "+B);NgLogD("PlusRequest: headers:"+JSON.stringify(y));z=C}if(B&&B.error_msg){z=B.error_msg}}v.statusClass=v.status-(v.status%100);if(v.statusClass!==200&&v.status!==304){z=b("Please check your network connection settings.");var A=w?w.split("?")[0]:"";o.reportEvent("PlatformServerErr",{status:v.status,endpoint:A})}if(z){NgLogE("PlusRequest: Error '"+z+"' in Network.XHR response: "+JSON.stringify(B))}u(z,B,y,v.status)}};if(this._sendComposition){v.sendComposition(this._sendComposition)}else{m("Network.XHR request to "+w);v.send(this._postData)}if((typeof f.mockXHR)!="undefined"){v.mockCallBack(u)}};f.prototype.addAttachmentWithNameAndFilenameOfType=function(x,v,u,w){if(!x&&!u){return}if(!v&&u){v=u}else{if(!u&&v){u=v}else{if(!v&&!u){v=u="value"}}}if(!w){w="application/octet-stream"}this.attachments.push({data:x,name:v,filename:u,type:w})};f.appKey=function(){return n.Session.getCurrentSession().appKey()};f.appVersion=function(){return n.Session.getCurrentSession().appVersion()};f.getPlatformVersion=function(){return"1.0"};f.getPlatformOAuthInfo=function(){return n.Session.getCurrentSession().OAuthConsumerInfo()};f.checkSessionStatus=function(u){u=u||f.noOp;var v=new f();v.setApiMethod("session");v.setHttpMethod("GET");v.setPostBody(n.Session.getCurrentSession()._loginParameters());v.setSecure(false);v.send(function(w,x){u(w,x)});return v};f._checkSessionStatusSecure=function(u){u=u||f.noOp;var v=new f();v.setApiMethod("session");v.setHttpMethod("GET");v.setPostBody(n.Session.getCurrentSession()._loginParameters());v.setSecure(true);v.send(function(w,x){u(w,x)});return v};f.loginWithUsernameAndPassword=function(w,v,u){n.Session.getCurrentSession().loginWithUsernameAndPassword(w,v,u)};f.loginWithSession=function(u){n.Session.getCurrentSession().loginWithSession(u)};f.sendPasswordResetEmailWithAddress=function(v,u){u=u||f.noOp;if(!v){u(b("No email address"),null);return}else{if(!this.emailAddressIsValid(v)){u(b("Please enter a valid email address."),null);return}}var w=new f();w.setSecure(true);w.setApiMethod("users/reset_password");w.setHttpMethod("POST");w.setPostBody({email:v});w.send(function(x,y){if(x||(y&&!y.success)){u(x,null)}else{u(null,y)}})};f.emailAddressIsValid=function(u){return((u||"").toUpperCase().match(/\b[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b/)!==null)};f.getSessionTokensForConsumerKey=function(w,u){u=u||f.noOp;var v=new f();v.setApiMethod("oauth/authorize_new");v.setHttpMethod("POST");v.setPostBody({key:w});v.send(function(x,y){NgLogD("getSessionTokensForConsumerKey *"+x+"* - **"+y+"**");u(x,y)});return v};f.updateSessionDeviceToken=function(A,v){v=v||f.noOp;var u,x,w,z,y;u=t.Core.Capabilities;if(u.isPlatformAndroid()){if(u.meetsBinaryVersion&&u.meetsBinaryVersion("1.10")){z="GCM"}else{z="C2DM"}}else{if(u.isPlatformIOS()){z="APNS"}else{v("Provider is not defined for this platform",null);return null}}y=new Date().getTimezoneOffset()*-60;x=new f();x.setApiMethod("opensocial/remote_notification/@me/@self/@app");x.setHttpMethod("POST");w={token:A,provider:z,utc_offset:y,locale:u.getLocale()};x.setPostBody(w);x.send(function(B,C){v(B,C)});return x};f.prototype._getRequestURL=function(){var u=f.appKey();var w=[(this.apiDomain||f.apiDomain),f.apiVersion,u,this.apiMethod];var v=""+(this.secure?"https":"http")+"://"+w.join("/");return v};f.prototype._prepareRequest=function(){var N;var v=this.getHttpMethod();var G=this._getRequestURL();this._postData=this.postBody;var u={};var K=this.httpHeaders["Content-Type"];if(!K&&(v==="POST")){K="application/x-www-form-urlencoded"}if((v!=="POST")||(K==="application/x-www-form-urlencoded")){this._flattenedResultsForPostData(this._postData,"",true,u)}var L=f.getPlatformOAuthInfo();var C={action:G,method:v,parameters:u};var A=null;if(this.authenticationType==f.authenticationTypes.OAuth1){a.OAuth.completeRequest(C,L);A=a.OAuth.getAuthorizationHeader(undefined,C.parameters)}else{if(this.authenticationType==f.authenticationTypes.OAuth2){A="bearer: "+n.Session.getCurrentSession().OAuth2Token();NgLogD("authorizationHeader =  "+A)}}if(v=="GET"||v=="DELETE"){var F=[];for(N in this.postBody){if(this.postBody.hasOwnProperty(N)){N=a.OAuth.percentEncode(N);var I=a.OAuth.percentEncode(this.postBody[N]);F.push(""+N+"="+I)}}if(F.length>0){G=G+"?"+F.join("&")}m("New URL: "+G)}if((typeof f.mockXHR)=="undefined"){this.request=new k.XHR()}else{this.request=f.mockXHR}this.request.open(C.method,G,true);if(A){this.request.setRequestHeader("Authorization",A)}var M=""+f.appKey()+"/"+f.appVersion()+" Mobage/"+f.getPlatformVersion();this.request.setRequestHeader("User-Agent",M);this.request.setRequestHeader("Accept","application/json");var x=t.Core.Capabilities;var y=false;if((typeof x.getPlatformOS()=="undefined")||(!x.isPlatformAndroid()&&!x.isPlatformFlash())){m("GZIP supported on "+x.getPlatformOS());y=true}this.request.setRequestHeader("Accept-Encoding",(y?"gzip":""));this.request.setRequestHeader("Accept-Language",q.getAcceptLanguage());if(this.httpHeaders){for(N in this.httpHeaders){if(this.httpHeaders.hasOwnProperty(N)){this.request.setRequestHeader(N,this.httpHeaders[N])}}}if(!t.Core.Analytics._getPipe().getMeta("sid")){t.Core.Analytics._getPipe()._setUnsetMetaKeys()}this.request.setRequestHeader("X-Stat-Session",t.Core.Analytics._getPipe().getMeta("sid"));if(this.entityTag){this.request.setRequestHeader("If-None-Match",this.entityTag)}if(this._postData&&this.httpMethod!="GET"){if(this.attachments.length>0){var J="---ABlkjasfdkjsdifsdf098asdfa3lka90aflallyourbasekjas09ds0fjasdkal3lj0sa";var H="\r\n";var D="--"+J+H;var E=[];E.push({str:this._multipartPostBodyFromDataWithBoundary(this._postData,J)});for(var z in this.attachments){var B=this.attachments[z];var w=B.type;if(!w){w="application/octet-stream"}E.push({str:D});E.push({str:'Content-Disposition: form-data; name="'+B.name+'"; filename="'+B.filename+'"'+H});E.push({str:"Content-Type: "+w+H+H});if(B.data){E.push({str:B.data})}else{E.push({file:B.filename})}E.push({str:H})}E.push({str:"--"+J+"--"+H});this._sendComposition=E;this.request.setRequestHeader("Content-Type","multipart/form-data; boundary="+J)}else{if(!this.request.getRequestHeader("Content-Type")){this.request.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}this._postData=this._getStringRepresentationOfPostData()}}return this.request};f.prototype._multipartPostBodyFromDataWithBoundary=function(z,A){var v="\r\n";var w="--"+A+v;var u=[];for(var x in z){var y=z[x];u.push(w);u.push('Content-Disposition: form-data; name="'+x+'"'+v+v);u.push(y);u.push(v)}return u.join("")};f.prototype._getStringRepresentationOfPostData=function(w,v){if(w===null){return""}if(w===undefined){w=w||this.postBody}if(typeof w!=="string"){var u=this._flattenedResultsForPostData(w,"",undefined,undefined,true);w=u.join("&")}return w};f.prototype._flattenedResultsForPostData=function(z,y,v,B,A){var u=(typeof B=="undefined"?(v===true?{}:[]):B);for(var w in z){if(z.hasOwnProperty(w)){var x=z[w];if(y&&y.length>0){w=""+y+"["+w+"]"}m("Getting "+w+": "+(typeof x));if(typeof x=="object"){this._flattenedResultsForPostData(x,w,v,u,A)}else{if(v===true){u[w]=x}else{u.push(""+encodeURIComponent(w)+"="+encodeURIComponent(x))}}}}return u};for(var s in f.prototype){if(f.prototype.hasOwnProperty(s)){var h=f.prototype[s];h.displayName="PlusRequest."+s+"()"}}f.noOp=function(){};r.PlusRequest=f}};__ngs._29={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._42).Class;var d=__ngs.r_(__ngs._5).Core;b.AppConfig=a.singleton({initialize:function(){this._audioEnabled=true;this._usePlatformSpecificAppId=false},audioEnabled:function(){return this._audioEnabled},setAudioEnabled:function(e){this._audioEnabled=e},getJSUpdateWaitPeriodInMS:function(){return 0},getJSUpdateIntervalInMS:function(){return 15*60*1000},isLocalizationEnabled:function(){var f=d.Capabilities.getConfigs();var e=true;if(f&&f.hasOwnProperty("localizationEnabled")){e=f.localizationEnabled}return e},getMaxNavStackDepth:function(){return 10},getPlatformVersion:function(){var e=d.Capabilities.getConfigs();var f="unknown";if(e&&e.hasOwnProperty("platformVersion")){f=e.platformVersion}return f},getMinBinaryVersion:function(){var f=d.Capabilities.getConfigs();var e=null;if(f&&f.hasOwnProperty("minBinaryVersion")){e=f.minBinaryVersion}return e},usePlatformSpecificAppId:function(){return this._usePlatformSpecificAppId},setUsePlatformSpecificAppId:function(e){if(e&&e.usePlatformSpecificAppId){this._usePlatformSpecificAppId=e.usePlatformSpecificAppId}else{this._usePlatformSpecificAppId=false}}})}};__ngs._2a={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Destinations=new (__ngs.r_(__ngs._2b).InterfaceLoader)({AcknowledgementsWebScreen:["_4k",function(c){return c.AcknowledgementsWebScreen}],BankController:["_4l",function(c){return c.BankController}],Catalog:["_4m",function(c){return c.Catalog}],FindFriends:["_4n",function(c){return c.FindFriends}],ForgotPassword:["_4o",function(c){return c.ForgotPassword}],GameProfile:["_4p",function(c){return c.GameProfile}],Home:["_4q",function(c){return c.Home}],MyPage:["_4r",function(c){return c.MyPage}],Settings:["_4s",function(c){return c.Settings}],SupportWebScreen:["_4t",function(c){return c.SupportWebScreen}],UserProfilePage:["_4u",function(c){return c.UserProfilePage}],Registration:["_4v",function(c){return c.Registration}],GamePlaceholder:["_4w",function(c){return c.GamePlaceholder}],SystemInfoScreen:["_4x",function(c){return c.SystemInfoScreen}]},{pushScreen:function(c,f,e,d,g){this.loadThenAct(f,function(h){var k=false;if(c._host&&c._host.showLoadingHelper){k=true}var j=function(){c.pushViewController(h.initWithJSON(e),d,function(l){if(k){c._host.hideLoadingLabel()}if(g){g(l)}})};if(k){c._host.showLoadingHelper(j)}else{j()}})}})}};__ngs._2b={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var e=__ngs.r_(__ngs._f);var a=new (e.RequireLoader)({Proc:function(){return __ngs.r_(__ngs._6).Proc},_Router:function(){return __ngs.r_(__ngs._4y)}});var c=function(h,f){var g=f;if(f instanceof Array){g=function(){return f[1](require(f[0]))}}else{delete this.map[h]}return function(){delete this[h];return this[h]=g.call(this)}};b.InterfaceLoader=function(h,g){this.map=h;e.RequireLoaderGen(c).call(this,h);if(g){for(var f in g){this[f]=g[f]}}};b.InterfaceLoader.prototype={classname:"InterfaceLoader",isLoaded:function(f){return !(this.map[f])&&this.hasOwnProperty(f)},loadThenAct:function(g,h){if(this.map.hasOwnProperty(g)){NgLogD("loadThenAct loading "+g);var f=this.map[g];a.Proc.load(f[0],function(j){if(this.map[g]){delete this[g];delete this.map[g];this[g]=f[1].call(this,j)}h(this[g])}.bind(this))}else{if(this.hasOwnProperty(g)){NgLogI("loadThenAct already loaded "+g);h(this[g])}else{throw new Error("InterfaceLoader::loadThenAct was provided a non-existent property: "+g)}}},dispatchCommand:function(f,j){var g=null;if(f.length){g=f.shift();var h=function(k){a._Router._dispatchHelper(this[g],f,j)}.bind(this);this.loadThenAct(g,h)}}}}};__ngs._2c={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._o);a.Analytics={getUserId:function(){var e=this._getSession(),d=null;if(e){d=(e.user()||{}).recordID}return d},getUsername:function(){var e=this._getSession(),d=null;if(e){d=(e.user()||{}).gamertag}return d},getPlatformVersion:function(){var d=this._getSession(),e=null;if(d){e=d.platformVersion()}return e},getServiceId:function(){return"US"},_getSession:function(){return c.Session.getCurrentSession()}}}};__ngs._2d={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var c=new (__ngs.r_(__ngs._f).RequireLoader)({AlertDialog:function(){return __ngs.r_(__ngs._i).AlertDialog},Toast:function(){return __ngs.r_(__ngs._j).Toast}});var b=__ngs.r_(__ngs._n).LocalizedString;var a=d.UIUtils={showAlert:function(h,g,k,j){if(!k||k instanceof Function){j=k;k=[b("OK")]}var f=(new c.AlertDialog({title:h,text:g,choices:k,onChoice:function(l){f.destroy();if(j){j(l)}}}));f.show();return f},showToast:function(h,g){var f=new c.Toast({text:h});f.ondisappear=function(){if(g){g()}f.destroy()};f.show();return f}}}};__ngs._2e={_c:null,_d:function(){var c={exports:{}};var g=c.exports;this._c=c;var h=__ngs.r_(__ngs._5).Core;var b=__ngs.r_(__ngs._4).Device;var a=new (__ngs.r_(__ngs._2b).InterfaceLoader)({DataModel:function(){return __ngs.r_(__ngs._3h).DataModel},Session:function(){return __ngs.r_(__ngs._o).Session},PlusRequest:function(){return __ngs.r_(__ngs._28).PlusRequest},AllGamesList:function(){return __ngs.r_(__ngs._4z).AllGamesList},FeaturedGamesList:function(){return __ngs.r_(__ngs._50).FeaturedGamesList},CpiProductsList:function(){return __ngs.r_(__ngs._51).CpiProductsList},_LocalGameList:function(){return __ngs.r_(__ngs._g)._LocalGameList},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities},Assets:function(){return __ngs.r_(__ngs._2z).Assets},AppConfig:function(){return __ngs.r_(__ngs._29).AppConfig},GameLaunchingProgress:function(){return __ngs.r_(__ngs._52).GameLaunchingProgress},GameLaunchedEmitter:function(){return __ngs.r_(__ngs._2g).GameLaunchedEmitter},AlertDialog:function(){return __ngs.r_(__ngs._i).AlertDialog},LifecycleManagedTimeout:function(){return __ngs.r_(__ngs._53).LifecycleManagedTimeout},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics},ServiceHost:["_2v",function(l){return l.ServiceHost}]});var d=__ngs.r_(__ngs._2a).Destinations;var j=__ngs.r_(__ngs._n).LocalizedString;var e=50*1024*1024;var f=g.Game=a.DataModel.subclass({classname:"Game",etagsToGames:{},initialize:function($super,l){$super(l);this._downloading=false;this._downloadProgress=0;this._downloadListeners=[];this._queryingUpdate=false;this._updateInfoReceived=false;this._updateAvailable=false;this._downloadSize=-1;this._updateListeners=[];this._marketAppDownloadListeners=[];this._marketAppDownloadWatchId=null;this._marketAppDownloadWatchTime=1000},loadData:function(l,m){this.beginChanges();l=l||{};m=m||{};this.name=l.name||this.name;this.publisher=l.publisher||this.publisher;this.category=l.category||this.category;this.featured=l.featured||this.featured;this.numberOfLeaderboards=l.leaderboards_count||this.numberOfLeaderboards||0;this.numberOfAchievements=l.achievements_count||this.numberOfAchievements||0;this.productID=l.id||this.productID;this.masterProductID=l.master_product_id||this.masterProductID;this.iconURL=l.icon_url||this.iconURL;this.appStoreURL=l.app_store_url||this.appStoreURL;this.feedURL=l.feed_url||this.feedURL;this.catalogURL=l.catalog_url||this.catalogURL;this.description=l.description||this.description;this.phone_screenshot_urls=l.phone_screenshot_urls||this.phone_screenshot_urls;this.phone_thumbnail_urls=l.phone_thumbnail_urls||this.phone_thumbnail_urls;this.ngcore_url=l.ngcore_url||this.ngcore_url;this.promotionalImage=l.promotion_image_url||this.promotionalImage;this.endChanges()},getGameData:function(l){var m=new a.PlusRequest();m.setApiMethod("games/"+this.recordID);m.setHttpMethod("GET");m.setEntityTag(this.entityTag);m.send(f._responderWithCallback(l))},getGameURL:function(){var l=h.Capabilities.getStartingServer();if(!l||l===""){l=h.Capabilities._getBootServer()}NgLogD("mobage/Game: ngcore url for game: "+this.ngcore_url);return this.ngcore_url},isAvailableLocally:function(){return false},queryUpdateInfo:function(){if(!this._queryingUpdate){a._LocalGameList.updateAvailable(this.getGameURL(),function(n,m){this._updateAvailable=n;this._downloadSize=m;this._updateInfoReceived=true;this._queryingUpdate=false;for(var l=0;l<this._updateListeners.length;l++){this._updateListeners[l].updateInfoReceived(this)}}.bind(this),function(l){this._queryingUpdate=false;for(var m=0;m<this._updateListeners.length;m++){this._updateListeners[m].updateInfoError(this,l)}}.bind(this));this._queryingUpdate=true}},isQueryingUpdate:function(){return this._queryingUpdate},hasUpdateInfo:function(){return this._updateInfoReceived},isUpdateAvailable:function(){if(!this._updateInfoReceived){throw new Error("Update information not available yet.")}return this._updateAvailable},getDownloadSize:function(){if(!this._updateInfoReceived){throw new Error("Download information not available yet.")}return this._downloadSize},addUpdateListener:function(l){if(!(l.updateInfoReceived instanceof Function)){throw new Error("updateInfoReceived() member expected.")}if(!(l.updateInfoError instanceof Function)){throw new Error("updateInfoError() member expected.")}this._updateListeners.push(l)},removeUpdateListener:function(m){for(var l=0;l<this._updateListeners.length;l++){if(this._updateListeners[l]==m){this._updateListeners.splice(l,1);return}}throw new Error("Update listener not found.")},canLaunch:function(l,m){if(h.Capabilities.isPlatformIOS()){return this._iosCanLaunch(l)}else{return this._androidMarketCanPlay(l,m)}},_getIOSLaunchSchema:function(){var l=this.recordID.replace(/[^a-zA-Z 0-9]+/g,"").toLowerCase();return l+"://"},_iosCanLaunch:function(l){var m=this._getIOSLaunchSchema();b.IPCEmitter.canLaunch(m,function(n){NgLogD("Can we launch iOS Game with schema URL: "+m+"? "+n);l(n)})},goToAppStore:function(){a.MobageAnalytics.reportEvent("JSGameSentToAppStore",{game:this.recordID});if(h.Capabilities.isPlatformIOS()){b.IPCEmitter.launch(this.appStoreURL)}else{this.startWatchingForMarketAppDownload();var l="";try{l=h.Capabilities.getBinaryDistributionName();if(!l){l=h.Capabilities.getDistributionName()}}catch(m){l=h.Capabilities.getDistributionName()}if(l=="mobagegamehub-gs2"){b.IPCEmitter.launch(this._samsungAppsURL())}else{b.IPCEmitter.launchIntent(this._androidMarketIntentURL())}}},_iosLaunchGame:function(){if(this._switchToGameIfRunning()){return true}var l=this._getIOSLaunchSchema();NgLogD("Game.iosLaunchGame - launching game with schema URL: "+l);b.IPCEmitter.launch(l);return false},_androidMarketPackageName:function(){var l=["com","mobage","ww","a"+this.productID,this.recordID.replace(/-/g,"_")].join(".");NgLogD("Package name for "+this.recordID+": "+l);return l},_androidMarketCanPlay:function(l,m){if(typeof this._androidMarketCouldPlay=="undefined"||m){this._internalAndroidMarketCanPlay(l)}else{l(this._androidMarketCouldPlay)}},_internalAndroidMarketCanPlay:function(l){var n=this._androidMarketCanLaunchURL();var m=this;b.IPCEmitter.canLaunch(n,function(o){NgLogD("Can we launch market URL: "+n+"? "+o);m._androidMarketCouldPlay=o;l(o)})},_androidMarketCanLaunchURL:function(){var l="x-mobage-game://"+this._androidMarketPackageName()+"/launch";return l},_androidMarketIntentURL:function(){return"market://details?id="+this._androidMarketPackageName()},_androidMarketURL:function(){return"http://market.android.com/details?id="+this._androidMarketPackageName()},_samsungAppsURL:function(){return a.Assets.getSamsungAppsUrl()+this._androidMarketPackageName()},isWatchingForMarketAppDownload:function(){if(h.Capabilities.isPlatformIOS()||h.Capabilities.isPlatformFlash()){return false}else{return this._marketAppDownloadWatchId!==null}},addMarketAppDownloadWatcher:function(l){if(this._marketAppDownloadListeners.indexOf(l)!=-1){return}if(!(l.onMarketAppDownloaded instanceof Function)){throw new Error("onMarketAppDownloaded() member expected.")}if(!(l.beganWatchingMarketAppDownload instanceof Function)){throw new Error("beganWatchingMarketAppDownload() member expected.")}this._marketAppDownloadListeners.push(l)},removeMarketAppDownloadWatcher:function(m){var l=this._marketAppDownloadListeners.indexOf(m);if(l!=-1){this._marketAppDownloadListeners.splice(l,1);if(this._marketAppDownloadListeners.length===0){this._marketAppDownloadWatchTime=1000;if(this._marketAppDownloadWatchId){clearTimeout(this._marketAppDownloadWatchId);this._marketAppDownloadWatchId=null}}}},startWatchingForMarketAppDownload:function(){if(this._marketAppDownloadWatchId===null){for(var l=0;l<this._marketAppDownloadListeners.length;l++){this._marketAppDownloadListeners[l].beganWatchingMarketAppDownload(this)}this._marketAppDownloadWatchId=setTimeout(this._checkForMarketAppDownload.bind(this),this._marketAppDownloadWatchTime)}},_checkForMarketAppDownload:function(){NgLogD("_checkForMarketAppDownload - checking for game "+this.recordID);this._internalAndroidMarketCanPlay(this.bind(function(m){if(m){this._marketAppDownloadWatchTime=1000;this._marketAppDownloadWatchId=null;for(var l=0;l<this._marketAppDownloadListeners.length;l++){this._marketAppDownloadListeners[l].onMarketAppDownloaded(this)}}else{if(this._marketAppDownloadWatchTime<10000){this._marketAppDownloadWatchTime+=1000}this._marketAppDownloadWatchId=setTimeout(this._checkForMarketAppDownload.bind(this),this._marketAppDownloadWatchTime)}}))},checkUpdateAndStartGame:function(){if(h.Capabilities.isPlatformIOS()){if(this._iosLaunchGame()){return}}else{if(f._currentlyLaunchingGame!==null){NgLogD("Game.checkUpdateAndStartGame - A game is already being started.");return}if(this._switchToGameIfRunning()){return}if(!f._gameLaunchedListener){f._gameLaunchedListener=new h.MessageListener();a.GameLaunchedEmitter.addListener(f._gameLaunchedListener,function(){if(f._currentlyLaunchingGame!==null){a.GameLaunchingProgress.hideDialog(f._currentlyLaunchingGame);f._currentlyLaunchingGame=null}})}a.GameLaunchingProgress.showDialog(this,this.name);f._currentlyLaunchingGame=this;this._start();return}},_switchToGameIfRunning:function(){var l=a.Session.getCurrentSession();var m=l?l.appKey():null;NgLogD("Game._switchToGameIfRunning - appKey="+m+" this.recordID="+this.recordID);if(m&&m==this.recordID){d.loadThenAct("GamePlaceholder",function(n){n.switchToRunningGame()});if(f._currentlyLaunchingGame&&f._currentlyLaunchingGame.is(this)){f._currentlyLaunchingGame=null;a.GameLaunchingProgress.hideDialog(this)}return true}return false},_start:function(){if(this._switchToGameIfRunning()){return}var m=this;NgLogD("Game._start - Cannot download directly");m._waitingForMarketAppBounce=true;NgLogD("Game._start - Launching other game.");a.MobageAnalytics.reportEvent("JSGameIntentLaunchSent",{game:this.recordID});this.gameLaunchingDialogTimeout=new a.LifecycleManagedTimeout(function(){if(f._currentlyLaunchingGame&&f._currentlyLaunchingGame.recordID==m.recordID){NgLogD("Game._start - Game failed to launch when we sent intent to launch, giving up!");a.MobageAnalytics.reportEvent("JSGameIntentLaunchFailed",{error:"launch via intent failed",game:m.recordID});f._currentlyLaunchingGame=null;a.GameLaunchingProgress.hideDialog(m);a.UIUtils.showToast(j("Couldn't find %1s",m.name))}},10*1000);var n=new h.MessageListener();var l=function(o){if(o===b.LifecycleEmitter.Event.Suspend){if(f._currentlyLaunchingGame&&f._currentlyLaunchingGame.recordID==m.recordID){f._currentlyLaunchingGame=null;a.GameLaunchingProgress.hideDialog(m)}}b.LifecycleEmitter.removeListener(n);return true};b.LifecycleEmitter.addListener(n,l.bind(this));b.IPCEmitter.launchIntent("com.mobage.ww.PLAY",{},m._androidMarketPackageName())},_actuallyStart:function(){d.loadThenAct("GamePlaceholder",function(l){l.launchGameAndSwitch(this)}.bind(this));if(f._currentlyLaunchingGame&&f._currentlyLaunchingGame.recordID==this.recordID){f._currentlyLaunchingGame=null;a.GameLaunchingProgress.hideDialog(this)}},isDownloading:function(){return this._downloading},getDownloadProgress:function(){if(!this._downloading){throw new Error("Game is not downloading.")}return this._downloadProgress},addDownloadListener:function(l){this._downloadListeners.push(l)},hasDownloadListener:function(m){for(var l=0;l<this._downloadListeners.length;l++){if(this._downloadListeners[l]==m){return true}}return false},removeDownloadListener:function(m){for(var l=0;l<this._downloadListeners.length;l++){if(this._downloadListeners[l]==m){this._downloadListeners.splice(l,1);return}}throw new Error("Download listener not found.")},getDefinedIcon:function(){var l=this.iconURL;if(!l||l=="/images/app-default.png"){l=a.Assets.image("no-game-icon.png")}return l},_isLaunchable:false,loadLaunchable:function(l){this.canLaunch(function(m){this._isLaunchable=m;l()}.bind(this),true)},isLaunchable:function(){return this._isLaunchable}});a.DataModel.defineSetterCallbacks(f,["name","publisher","category","featured","numberOfLeaderboards","numberOfAchievements","masterProductID","iconURL","appStoreURL","feedURL","catalogURL","description","productID","phone_screenshot_urls","phone_thumbnail_urls","promotionalImage","ngcore_url","androidMarketIntentURL"]);f.prototype.__defineGetter__("androidMarketIntentURL",f.prototype._androidMarketIntentURL);f.getGameWithData=function(p,l){if(!p){return undefined}var o=p.app_key;if(!o){return undefined}var n=a.Session.getCurrentSession().dataCache();var m=n.getObjectWithRecordID(f.classname,o);if(m===null){m=new f(o)}m.entityTag=l;if(m.loadData){m.loadData(p)}else{NgLogD("TODO: NOTICE @SSTREZA FIGURE OUT WHY THIS IS A HACK.")}return m};f._responderWithCallback=function(l){l=l||a.PlusRequest.noOp;return function(o,q,m,p){NgLogD("Got a Game: "+o+" "+JSON.stringify(q));var s=null;var u=null;var r=m?m.etag:undefined;if(o){l(o,null)}else{if(p==304){l(null,f.etagsToGames[m.etag])}else{if(q){if(!q.success){if(q.error){l(q.error,null)}else{l("unknown error",null)}}else{if(q.games){var n=[];for(var t=0;t<q.games.length;t++){s=q.games[t];u=f.getGameWithData(s,r);if(u){n.push(u)}}if(r){f.etagsToGames[r]=n}l(null,n)}else{if(q.game){s=q.game;u=f.getGameWithData(s,r);if(r){f.etagsToGames[r]=u}l(null,u)}else{l("unknown error",null)}}}}else{l("unknown error",null)}}}}};f.getAllGamesList=function(){if(!this._allGamesList){this._allGamesList=new a.AllGamesList(this)}return this._allGamesList};f.getFeaturedGamesList=function(){if(!this._featuredGamesList){this._featuredGamesList=new a.FeaturedGamesList()}return this._featuredGamesList};f.callOnAllGamesList=function(){this.getAllGamesList().handleCallFromPublicAPI.apply(this.getAllGamesList(),arguments)};f.getGameWithAppKey=function(o,l){l=l||a.PlusRequest.noOp;if(!o){l("No app key",l);return}var n=a.Session.getCurrentSession().dataCache();var m=n.getObjectWithRecordID(f.classname,o);if(m===null){m=new f(o)}m.getGameData(l)};f.getGameWithProductID=function(m,l){l=l||a.PlusRequest.noOp;if(!m&&m!==0){l("No product ID",l);return}var n=new a.PlusRequest();n.setApiMethod("games/"+m);n.setHttpMethod("GET");n.send(f._responderWithCallback(l))};f._getGameWithAndroidPackageName=function(m,l){if(!m){l("Invalid package name",null);return}var o=m.split(".");if(o.length==5){var p=o[3];var n=parseInt(p.replace("a",""),10);NgLogD("Product ID of "+n+" for package name "+m);f.getGameWithProductID(n,l)}else{l("Invalid package name",null)}};f.getCurrentGame=function(l){return f.getGameWithAppKey(a.Session.getCurrentSession().appKey(),l)};f.getDownloadCount=function(){return f._downloadCount};f._downloadCount=0;f._currentlyLaunchingGame=null;f.isGameLaunching=function(){return f._currentlyLaunchingGame!==null};f.isCurrentlyLaunchingGame=function(l){return f._currentlyLaunchingGame.recordID===l.recordID};var k=h.Class.subclass({initialize:function(m,l){this.message="Download too large.";this.gameSize=m;this.maxSize=l},getGameSize:function(){return this.gameSize},getMaxSize:function(){return this.maxSize},toString:function(){return this.message}});f.GameSizeError=k;f._globalDownloadEmitter=null;f.addGlobalDownloadListener=function(m,n,l){if(!f._globalDownloadEmitter){f._globalDownloadEmitter=new h.MessageEmitter()}f._globalDownloadEmitter.addListener(m,n,l)};f.removeGlobalDownloadListener=function(l){if(f._globalDownloadEmitter){f._globalDownloadEmitter.removeListener(l)}}}};__ngs._2f={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var a=__ngs.r_(__ngs._54);var c=new (__ngs.r_(__ngs._f).RequireLoader)({Privileged:function(){return __ngs.r_(__ngs._r).Social},PlusRequest:function(){return __ngs.r_(__ngs._28).PlusRequest},Session:function(){return __ngs.r_(__ngs._o).Session}});var b=d.Dispatcher={classname:"Dispatcher",callbackUIDCounter:0,callbacks:{"-2":{},"-1":{}},cache:function(){return c.Session.getCurrentSession().dataCache()},sendSession:function(h){var g={apiURL:"US.Dispatcher.receiveSession",data:{platformVersion:c.PlusRequest.getPlatformVersion(),serverMode:c.PlusRequest.getServerMode(),appId:c.PlusRequest.appKey(),appVersion:c.PlusRequest.appVersion()}};var f=h.user();if(f){g.data.userID=f.recordID;g.data.userData=f._serializedHash()}a.getRouterInstance().sendCommandToGame(g)},getSessionForPublic:function(g){var f=c.Session.getCurrentSession();if(!f){g("Warning: No session in Session available to get.")}else{b.sendSession(f)}},callClassMethodOnLocalObject:function(j){var h=j.classname;var g=j.methodName;if(h&&g){var f=function(k){this._callClassMethodOnLocalObject(k,h,g,j)}.bind(b);if(c.Privileged.US.hasOwnProperty(h)){c.Privileged.US.loadThenAct(h,f)}else{c.Privileged.US.Service.loadThenAct(h,f)}}},_callClassMethodOnLocalObject:function(k,h,o,j){b.beginBatching();if(k){var m=false;var l;var f;if(o instanceof Array){var g=k;for(var n=0;n<o.length;n++){if(typeof g[o[n]]=="function"){l=b.convertArgumentsArrayFromJSON(j.arguments[n]||[]);f=g[o[n]].apply(g,l);g=f}else{m=true;break}}}else{if(typeof k[o]=="function"){l=b.convertArgumentsArrayFromJSON(j.arguments||[]);f=k[o].apply(k,l)}else{m=true}}if(m){NgLogD("ERROR: Invalid methods for calling on local Class: "+h+" "+o)}else{if(j.callback){var p=b.convertFunctionFromJSON(j.callback);if(p){p(f)}}}}b.endBatching()},callMethodOnRemoteObject:function(j,g,h,f){if(!j||!g){NgLogD("Privileged.Dispatcher.callMethodOnRemoteObject - bailing");if(f){f()}return}h=b.convertArgumentsArrayToJSON(h||[]);var k={apiURL:"US.Dispatcher.callMethodOnLocalObject",recordID:j.recordID,classname:(j.classname?j.classname:j),methodName:g,arguments:h,callback:b.convertFunctionToJSON(f)};a.getRouterInstance().sendCommandToGame(k)},callMethodOnLocalObject:function(j){b.beginBatching();var l=j.recordID;var h=j.classname;var k=b.cache().getObjectWithRecordID(h,l);if(k){var p=j.methodName;var n=false;var m;var f;if(p instanceof Array){var g=k;for(var o=0;o<p.length;o++){if(typeof g[p[o]]=="function"){m=b.convertArgumentsArrayFromJSON(j.arguments[o]||[]);f=g[p[o]].apply(g,m);g=f}else{n=true;break}}}else{if(typeof k[p]=="function"){m=b.convertArgumentsArrayFromJSON(j.arguments||[]);f=k[p].apply(k,m)}else{n=true}}if(n){NgLogD("ERROR: Invalid methods for calling on local object: "+j.recordID+" "+p)}else{if(j.callback){var q=b.convertFunctionFromJSON({callbackUID:j.callback});if(q){q(f)}}}}b.endBatching()},callMethodOnRemoteObject:function(k,g,h,f){if(!k||!g){NgLogD("Privileged.Dispatcher.callMethodOnRemoteObject - bailing");if(f){f()}return}h=b.convertArgumentsArrayToJSON(h||[]);var j={apiURL:"US.Dispatcher.callClassMethodOnLocalObject",classname:(k.classname?k.classname:k),methodName:g,arguments:h,callback:b.convertFunctionToJSON(f)};a.getRouterInstance().sendCommandToGame(j)},sendCallbackToRemote:function(f,g){g=b.convertArgumentsArrayToJSON(g||[]);var h={apiURL:"US.Dispatcher.receiveCallbackFromRemote",callbackUID:f,arguments:g,zone:a.getRouterInstance().zone};a.getRouterInstance().sendCommandToGame(h)},receiveCallbackFromRemote:function(g){var h=b.callbacks[a.getRouterInstance().zone][g.callbackUID];if(!h){return}var f=b.convertArgumentsArrayFromJSON(g.arguments||[]);h.apply(h,f)},convertArgumentsArrayFromJSON:function(j){var h=[];for(var g=0;g<j.length;g++){var f=j[g];if(f&&((f.recordID&&f.classname)||f instanceof Array)){h[g]=b.convertModelObjectFromJSON(f)}else{if(f&&f.callbackUID){h[g]=b.convertFunctionFromJSON(f)}else{h[g]=f}}}return h},convertArgumentsArrayToJSON:function(j){var h=[];for(var g=0;g<j.length;g++){var f=j[g];if(f&&(f.recordID&&f._classname&&typeof f._classname=="function"&&f._classname())){b.sendObjectImmediately(f);f=b.convertModelObjectToJSON(f);h[g]=f}else{if(f&&f instanceof Array){f=b.convertArgumentsArrayToJSON(f);h[g]=f}else{if(f&&typeof f=="function"){h[g]=b.convertFunctionToJSON(f)}else{h[g]=f}}}}return h},convertModelObjectToJSON:function(f){if(f&&f.recordID&&f._classname()){f={classname:f._classname(),recordID:f.recordID}}return f},convertModelObjectFromJSON:function(j){var h=j;if(j.recordID&&j.classname){var k=b.cache().getObjectWithRecordID(j.classname,j.recordID);if(k){h=k}}else{if(j instanceof Array){for(var g=0;g<j.length;g++){var f=j[g];f=this.convertModelObjectFromJSON(f);j[g]=f}}}return h},convertFunctionToJSON:function(h){if(h&&typeof h=="function"){var g=++b.callbackUIDCounter;var f=a.getRouterInstance().zone;b.callbacks[f][g]=h;h={callbackUID:g,zone:f}}return h},convertFunctionFromJSON:function(h){var j=h;var g=j.callbackUID;var f=j.zone;if(g&&f){var k=b.callbacks[f][g];if(k&&f==a.getRouterInstance().zone){j=k;delete b.callbacks[f][g]}else{j=b.generateCallbackForUID(g)}return j}else{return undefined}},generateCallbackForUID:function(f){if(f.callbackUID){f=f.callbackUID}return function(){var h=[];for(var g=0;g<arguments.length;g++){h[g]=arguments[g]}b.sendCallbackToRemote(f,h)}},_batchCount:0,_queuedObjects:[],beginBatching:function(){++b._batchCount},endBatching:function(){if((--b._batchCount)===0){for(var f in b._queuedObjects){var g=b._queuedObjects[f];b._queuedObjects[f]=undefined;b.sendObjectImmediately(g)}}},sendObjectImmediately:function(g){if(!g){return}var f={apiURL:"US.Dispatcher.receiveObject",data:g._serializedHash()};a.getRouterInstance().sendCommandToGame(f)},sendObject:function(g){if(b._queuedObjects.indexOf(g)==-1){b.beginBatching();var f=""+g.classname+"---"+g.recordID;b._queuedObjects[f]=g;b.endBatching()}},receiveObject:function(g){var f=((g||{data:{classname:null}}).data||{classname:null}).classname;if(f&&!c.Privileged.US.isLoaded(f)){c.Privileged.US.loadThenAct(f,function(){this._receiveObject(g)}.bind(b))}else{b._receiveObject(g)}},_receiveObject:function(m){b.beginBatching();var k=m.data;var g=k.recordID;var j=k.classname;var f=k.data;NgLogD("Privileged Dispatcher: Received object "+j+" "+g+": "+JSON.stringify(m));var h=b.cache();if(g&&j&&h){NgLogD("Got a "+j+" object with "+g);var l=h.getObjectWithRecordID(j,g);if(!l){var n=c.Privileged.US[j];l=new n(g);h.addObject(l)}l._deserializeFromHash(f)}b.endBatching()}}}};__ngs._2g={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._1q).MessageEmitter;b.GameLaunchedEmitter=a.singleton({onGameLaunched:function(){this.emit()}})}};__ngs._2h={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var c=__ngs.r_(__ngs._t).Class;var b=new (__ngs.r_(__ngs._f).RequireLoader)({Game:function(){return __ngs.r_(__ngs._2e).Game},PlusRequest:function(){return __ngs.r_(__ngs._28).PlusRequest},AlertDialog:function(){return __ngs.r_(__ngs._i).AlertDialog},IPCEmitter:function(){return __ngs.r_(__ngs._1e).IPCEmitter},DeepLinking:function(){return __ngs.r_(__ngs._2o).DeepLinking},ServiceLinkEmitter:function(){return __ngs.r_(__ngs._2o).ServiceLinkEmitter},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},KeyValueCache:function(){return __ngs.r_(__ngs._10).KeyValueCache},Updater:function(){return __ngs.r_(__ngs._31).Updater}});var a=__ngs.r_(__ngs._n).LocalizedString;d.SystemMessagesStack=c.singleton({_messageQueue:null,_messageDialog:null,_waitingOnDialog:false,initialize:function(){this._messageQueue=[]},onSystemMessage:function(f){var g=this;var j=f.times_to_display;var l=function(){var m={title:f.title,text:f.text,linkUrl:f.url,useAlert:f.alert,useWebView:f.web_view};NgLogD("SystemMessagesStack: Got new System message: "+JSON.stringify(m));g._messageQueue.push(m);g._tryDisplayMessage()};if(j&&j>0){var h=f.id;var k=b.KeyValueCache.global("Social.US.MessageHistory");k.getItem(h,function(n,o){var m=o?parseInt(o,10):0;if(m<j){l();k.setItem(h,m+1)}})}else{l()}},onCPIMessage:function(f){var g=this;var h=function(){var j={title:f.title,text:f.text,labelYES:f.yes_button_label,labelNO:f.no_button_label,appKey:f.app_key,userID:f.user_id,offerID:f.offer_id,useAlert:true};NgLogD("SystemMessagesStack: Got new CPI message: "+JSON.stringify(j));g._messageQueue.push(j);g._tryDisplayMessage()};h()},_tryDisplayMessage:function(){if(this._waitingOnDialog||this._messageQueue.length===0){return}var f=this._messageQueue[0];NgLogD("SystemMessagesStack: Displaying: "+JSON.stringify(f));if(f.useAlert||f.offerID){this._showDialog(f)}else{b.UIUtils.showToast(f.text);this._messageQueue.splice(0,1);this._tryDisplayMessage()}},_showDialog:function(j){if(this._messageDialog){this._messageDialog.destroy()}var f=this;this._waitingOnDialog=true;this._messageDialog=new b.AlertDialog();this._messageDialog.setTitle(j.title);this._messageDialog.setText(j.text);if(j.linkUrl&&j.useAlert){var h=b.DeepLinking.parseMobageWWLink(j.linkUrl);if(h){h.noDialog=true;this._messageDialog.setChoices([a("View"),a("Skip")]);this._messageDialog.onchoice=function(k){if(k.choice===0){b.ServiceLinkEmitter.onLink(h)}f._onDialogClosed()}}else{this._messageDialog.setChoices([a("View"),a("Skip")]);this._messageDialog.onchoice=function(k){if(k.choice===0){b.IPCEmitter.launch(j.linkUrl,function(l){console.log("SystemMessageStack URL Callback")})}f._onDialogClosed()}}this._messageDialog.show()}else{if(j.offerID){var g=new b.PlusRequest();g.setApiMethod("cpi/display?o="+j.offerID+"&u="+j.userID);g.setHttpMethod("GET");g.send(function(l,m,n,k){console.log("Mobage/CPI: Message shown. Reported to Server");if(k===200){f._messageDialog.setChoices([a(j.labelYES),a(j.labelNO)]);f._messageDialog.onchoice=function(q){if(q.choice===0){var o=new b.PlusRequest();o.setApiMethod("cpi/click?o="+j.offerID+"&u="+j.userID);o.setHttpMethod("GET");o.send(function(s,t,u,r){console.log("Mobage/CPI: cpi/click status is: "+r);if(r==200&&j.appKey){b.Game.getGameWithAppKey(j.appKey,function(w,v){if(!w&&v){NgLogD("Mobage/CPI: User Responded Yes, CPI/click success, found game, Sending to Android Market. Game: "+v.recordID);v.goToAppStore();setTimeout(function(){b.Updater.checkNow()},3000)}else{NgLogD("Mobage/CPI dialog: Couldnt find game, err: "+w)}})}});f._onDialogClosed()}else{f._onDialogClosed();var p=new b.PlusRequest();p.setApiMethod("cpi/dismiss?o="+j.offerID+"&u="+j.userID);p.setHttpMethod("GET");p.send(function(s,t,u,r){console.log("Mobage/CPI: User Responded NO. Reported to Server")})}};f._messageDialog.show()}else{console.log("Mobage/CPI: Display failed, skipping");f._messageDialog.destroy();f._onDialogClosed();return}})}else{this._messageDialog.setChoices([a("OK")]);this._messageDialog.onchoice=function(k){f._onDialogClosed()};this._messageDialog.show()}}},_onDialogClosed:function(){this._waitingOnDialog=false;this._messageQueue.splice(0,1);this._tryDisplayMessage()}})}};__ngs._2i={_c:null,_d:function(){var d={exports:{}};var e=d.exports;this._c=d;var h=__ngs.r_(__ngs._5).Core;var m=__ngs.r_(__ngs._a).Storage;var k=__ngs.r_(__ngs._11).LifecycleEmitter;var f=__ngs.r_(__ngs._h)._int_LGL;var g=__ngs.r_(__ngs._g)._LocalGameList;var a=new (__ngs.r_(__ngs._2b).InterfaceLoader)({AlertDialog:function(){return __ngs.r_(__ngs._i).AlertDialog},ProgressDialog:function(){return __ngs.r_(__ngs._55).ProgressDialog},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics},ServiceHost:["_2v",function(n){return n.ServiceHost}]});var c=__ngs.r_(__ngs._l).CheckBinaryVersion;var b=__ngs.r_(__ngs._29).AppConfig;var l=__ngs.r_(__ngs._n).LocalizedString;var j=e.AppUpdater=h.Class.singleton({classname:"AppUpdater",initialize:function(){this._objectsBlockingUpdating=[]},updateServiceJS:function(o){var n=this;NgLogD("Mobage/AppUpdater: Downloading game service updates...");g.updateGame(o,-1,function(p,r){c.checkForBinaryUpdates(o);if(r){NgLogE("Mobage/AppUpdater: Error updating game service! "+o+": "+r)}else{if(p){a.MobageAnalytics.reportEvent("MobageUpdateAvailable");var t=h.MessageListener.subclass({_onEvent:function(u){if(u===k.Event.Suspend){if(n.shouldApplyJSUpdates()){NgLogD("Mobage/AppUpdater: Applying service update.");m.KeyValueCache.local.setItem("Mobage_DidJSUpdate","1");f.launch(o,f.ProcID.Persist)}}return true}});var q=new t();k.addListener(q,q._onEvent)}else{NgLogD("Mobage/AppUpdater: Game Service is up-to-date.")}}var s=b.getJSUpdateIntervalInMS();NgLogD("Mobage/AppUpdater: Scheduling next update check in "+s+"ms.");setTimeout(function(){n.updateServiceJS(o)},s)},false,true)},_initForcedJSUpdateButton:function(p){if(h.Capabilities.isPlatformIOS()){return}var q=new a.AlertDialog();q.setTitle(l("Update Available"));q.setText(l("An update to Mobage has been downloaded. Please restart to apply the update."));q.setChoices([l("Restart Mobage")]);var o=new a.ProgressDialog();o.setText(l("Restarting Mobage…"));var n=function(r){a.MobageAnalytics.reportEvent("MobageForcedJSUpdateDialogRestartClicked");o.show();g.setProgressText(l("Restarting Mobage…"));g.setSplashVisible(true);if(r.isRunningActiveGame()){k.pauseGame()}setTimeout(function(){f.launch(p,f.ProcID.Persist)},10)};q.onchoice=function(){a.loadThenAct("ServiceHost",n)};q.show();a.MobageAnalytics.reportEvent("MobageForcedJSUpdateDialogShow")},blockApplyingJSUpdates:function(o){var n=this._objectsBlockingUpdating.indexOf(o);if(n!==-1){NgLogW("Mobage/AppUpdater: Object "+o+" over-requested blockApplyingJSUpdates");return}NgLogD("Mobage/AppUpdater: Blocking app update due to object "+o);this._objectsBlockingUpdating.push(o)},allowApplyingJSUpdates:function(o){var n=this._objectsBlockingUpdating.indexOf(o);if(n===-1){NgLogW("Mobage/AppUpdater: Object "+o+" tried to allow updates but wasn't blocking");return}NgLogD("Mobage/AppUpdater: Object "+o+" is allowing app update once again");this._objectsBlockingUpdating.splice(n,1)},shouldApplyJSUpdates:function(){return false}})}};__ngs._2j={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var c=__ngs.r_(__ngs._2z).Assets;var e=null;var f=null;var a=b.Logger=(__ngs.r_(__ngs._t).Class).singleton({$ReleaseConfiguration:true,$DisableMethodLogging:false,$DisableExceptionCallstack:false,$DisableDebugLogging:false,$DisableErrorLogging:false,$DisableAll:false,$MethodSeparatorChar:"/",$decorate:function(j,h){if(a.DisableAll||(a.DisableMethodLogging&&a.DisableExceptionCallstack)){return j}if(!j){NgLogE("Logger Error: ","Can't decorate undefined subclassHash.");return null}for(var g in j){if(j.hasOwnProperty(g)&&typeof j[g]==="function"&&(!h||h===g)){j[g]=f(j.classname,g,j[g])}}return j},$decorateDescendants:function(g){if(!g){NgLogE("Logger Error: ","Can't decorateDescendants for an undefined Class.");return}if(!g.prototype.classname){NgLogD("Logger DecoratingDescendants for: "+g.prototype.classname);for(var h in g.prototype){if(g.prototype.hasOwnProperty(h)){NgLogD("\t"+h)}}}if(!g._LoggerDescendantsDecorated&&!a.DisableAll){g._LoggerDescendants_OldSubclass=g.subclass;g.subclass=function(k){a.decorate(k);var j=this._LoggerDescendants_OldSubclass.apply(this,[k]);return j}}a.addLogHelpers(g);g._LoggerDescendantsDecorated=true},$addLogHelpers:function(g){if(!g){NgLogE("Logger Error: ","Can't addLogHelpers for an undefined Class.");return}if(g._LoggerDescendantsDecorated){return}g.prototype.logv=function(){if(!a.shouldLog(this,this.classname)){return}var h=Array.prototype.slice.call(arguments);h.unshift(": ");h.unshift(this.classname);a.debug.apply(a,h)};g.prototype.logd=function(){var h=Array.prototype.slice.call(arguments);h.unshift(": ");h.unshift(this.classname);a.debug.apply(a,h)};g.prototype.loge=function(){var h=Array.prototype.slice.call(arguments);h.unshift(" Error: ");h.unshift(this.classname);a.error.apply(a,h)}},shouldLog:function(h,k,j){if(a.DisableAll){return false}if(k&&k.search(this._classMatchRegex)!=-1){return true}else{if(j&&j instanceof Array){for(var g in j){if(j.hasOwnProperty(g)){if(j[g] in this._activeSubsystems){return true}}}}else{if(j&&typeof j==="string"&&j in this._activeSubsystems){return true}}}return false},d:function(g){this.debug.apply(this,Array.prototype.slice.call(arguments))},debug:function(g){if(a.DisableAll||a.DisableDebugLogging){return}if(arguments.length>1){g=Array.prototype.slice.call(arguments)}NgLogD((g&&g instanceof Array)?g.join(" "):g)},e:function(g){this.error.apply(this,Array.prototype.slice.call(arguments))},error:function(g){if(a.DisableAll||a.DisableErrorLogging){return}if(arguments.length>1){g=Array.prototype.slice.call(arguments)}NgLogE((g&&g instanceof Array)?g.join(" "):g)},v:function(g){this.debug.apply(this,Array.prototype.slice.call(arguments))},verbose:function(g){if(a.DisableAll||a.DisableVerboseLogging){return}if(arguments.length>1){g=Array.prototype.slice.call(arguments)}NgLogD((g&&g instanceof Array)?g.join(" "):g)},initialize:function($super){if($super&&typeof"$super"==="function"){$super()}if(a.ReleaseConfiguration){a.DisableMethodLogging=true;a.DisableExceptionCallstack=true;a.DisableDebugLogging=true}this._activeClasses=[];this._activeClassRegexes=[];this._pubInit()},_pubInit:function(){this._isPriv=false;(__ngs.r_(__ngs._d).FileSystem).readFile("logger_settings.json",this.bind(this._incomingConfigFile))},_privInit:function(){this._isPriv=true;(__ngs.r_(__ngs._d).FileSystem).readFile(c.loggerSettingsPath(),this.bind(this._incomingConfigFile))},_incomingConfigFile:function(g,j){if(g){return}this.d("Logger: Incoming Config File for ",(this._isPriv)?"priviledged interpreter":"public interpreter"," err",g," data ",j);var l;try{l=JSON.parse(j)}catch(k){this.d("Logger: Got an unparseable Config File");return}var m;var h="^$";if(l.MethodSeparatorChar){a.MethodSeparatorChar=l.MethodSeparatorChar}if(l.hasOwnProperty("DisableMethodLogging")&&l.DisableMethodLogging){a.DisableMethodLogging=l.DisableMethodLogging}if(l.ActiveClasses){for(m in l.ActiveClasses){if(l.ActiveClasses.hasOwnProperty(m)&&l.ActiveClasses[m]){h+="|^"+m+"$"}}}if(l.ActiveClassRegexes){for(m in l.ActiveClassRegexes){if(l.ActiveClassRegexes.hasOwnProperty(m)&&l.ActiveClassRegexes[m]){h+="|"+m+""}}}this.d("Logger regexStr: ",h);this._classMatchRegex=new RegExp(h)},methodLog:function(g,l,h,j,k){if(a.DisableAll||a.DisableMethodLogging){return}if(!l){if(g.classname){l="AnonymousLayer("+g.classname+")"}l="AnonymousClass"}if(!this.shouldLog(g,l,k)){return}if(j&&j instanceof Array){j=j.join("")}this.debug(l,a.MethodSeparatorChar,h,": ",j)},subsystem:function(h,g){if(!h){return}if(h){this.d("UNIMPLEMENTED")}},_anonymousLogEnabled:true,_classMatchRegex:null,_activeSubsystems:null});a.instantiate();e=function(g){var h=g.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return h.length==1&&!h[0]?[]:h};f=function(l,g,k){var j=e(k);var h=(j.length)?("$super"===j[0]):false;if(h){return function($super){if(!a.DisableMethodLogging){a.methodLog(this,l,g," begin")}try{var m=k.apply(this,Array.prototype.slice.call(arguments))}catch(n){if(!a.DisableExceptionCallstack){a.error("except-stack:\t\t",l,a.MethodSeparatorChar,g)}throw n}if(!a.DisableMethodLogging){a.methodLog(this,l,g," end")}return m}}return function(){if(!a.DisableMethodLogging){a.methodLog(this,l,g," begin")}try{var m=k.apply(this,Array.prototype.slice.call(arguments))}catch(n){if(!a.DisableExceptionCallstack){a.error("except-stack:\t\t",l,a.MethodSeparatorChar,g)}throw n}if(!a.DisableMethodLogging){a.methodLog(this,l,g," end")}return m}}}};__ngs._2k={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._5).Core;a.isWhitelisted=function(e){var f="";try{f=c.Capabilities.getBinaryDistributionName();if(!f){f=c.Capabilities.getDistributionName()}}catch(d){f=c.Capabilities.getDistributionName()}if(f=="mobagegamehub-gs2"){return true}switch(e){case"PC36100":case"ADR6300":case"HTC Desire":case"Desire HD":case"HTC Desire HD A9191":case"HTC Glacier":case"DROIDX":case"DROID2":case"SCH-I500":case"SAMSUNG-SGH-I897":case"Nexus S":case"Nexus S 4G":case"Galaxy Nexus":case"GT-P6800":case"ADR6425LVW":case"DROID BIONIC":case"DROID3":case"MB855":case"MB865":case"GT-N7000":case"SHV-E160K":case"SHV-E160L":case"SHV-E160S":case"SAMSUNG-SGH-I927":case"SAMSUNG-SGH-I927R":case"GT-I9100":case"SGH-T989":case"SPH-D710":case"SAMSUNG-SGH-I777":case"SAMSUNG-SGH-I727":case"SHW-M250K":case"SHW-M250S":case"iPod3,1":case"iPhone2,1":case"iPhone3,1":case"iPhone3,3":case"iPhone4,1":case"iPad1,1":case"iPad2,1":case"iPad2,2":case"iPad2,3":case"x86_64":case"x86_32":return true;default:return false}}}};__ngs._2l={_c:null,_d:function(){var f={exports:{}};var d=f.exports;this._c=f;var b=__ngs.r_(__ngs._54);var e=__ngs.r_(__ngs._28);var a=__ngs.r_(__ngs._7).Capabilities;var g=__ngs.r_(__ngs._56).OpenSocial;var c=new (__ngs.r_(__ngs._2b).InterfaceLoader)({NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils}});var h=d.AB={_getRequest:function(){var j=a.getAppReleaseVersion();var k=new e.PlusRequest();var l="ab/application_variants";if(j){l=l+"?release_id="+j}k.setApiMethod(l);k.setHttpMethod("GET");return k},getCurrentVariants:function(k){var j=this._getRequest();j.send(function(o,q,r,m){var n=g.populateErrors(o,q,r,m);var l=null;var p=m-m%100;if(p==200){if(q.ab){l=q.ab}if(q.service){}}b.getRouterInstance().sendCommandToGame({callbackId:k.callbackId,error:n.error,callbackData:l})})},getMobageBootVariants:function(j){var k=this._getRequest();k.send(function(m,o,q,l){var p;var n=l-l%100;if(n==200){p=o.mobageBoot}if(typeof j==="function"){j(p)}})},getServiceVariants:function(j){if(h._serviceVariants){j(null,h._serviceVariants);return}var l=c.NetworkUtils.getDeviceIdForPlatformServer();var k=new e.PlusRequest();k.setApiMethod("ab/service_variants");k.setHttpMethod("GET");k.setPostBody({device_id:l});k.send(function(n,o,p,m){if(n){j(n,null)}else{h._serviceVariants=o;j(null,o)}})}}}};__ngs._2m={_c:null,_d:function(){var d={exports:{}};var f=d.exports;this._c=d;var g=__ngs.r_(__ngs._5).Core;var c=__ngs.r_(__ngs._4).Device;var j=__ngs.r_(__ngs._s).Network;var b=__ngs.r_(__ngs._10).KeyValueCache;var a=new (__ngs.r_(__ngs._2b).InterfaceLoader)({AlertDialog:function(){return __ngs.r_(__ngs._i).AlertDialog},Session:function(){return __ngs.r_(__ngs._o).Session},PlusRequest:function(){return __ngs.r_(__ngs._28).PlusRequest},FacebookWebview:function(){return __ngs.r_(__ngs._57).FacebookWebview},LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics},User:function(){return __ngs.r_(__ngs._30).User}});var h=f.FacebookConsts={ANDROID_ACTIVITY_REQUEST_CODE:"fb_native_sso",REDIRECT_URI:"fbconnect://success",CANCEL_URI:"fbconnect://cancel",TOKEN:"access_token",EXPIRES:"expires_in",SINGLE_SIGN_ON_DISABLED:"service_disabled",FORCE_DIALOG_AUTH:-1,LOGIN_ACTION:"oauth",DIALOG_BASE_URL:"https://m.facebook.com/dialog/",GRAPH_BASE_URL:"https://graph.facebook.com/",RESTSERVER_URL:"https://api.facebook.com/restserver.php",MOBAGE_APP_ID:"180566588646375",APP_SIGNATURE:"30820268308201d102044a9c4610300d06092a864886f70d0101040500307a310b3009060355040613025553310b3009060355040813024341311230100603550407130950616c6f20416c746f31183016060355040a130f46616365626f6f6b204d6f62696c653111300f060355040b130846616365626f6f6b311d301b0603550403131446616365626f6f6b20436f72706f726174696f6e3020170d3039303833313231353231365a180f32303530303932353231353231365a307a310b3009060355040613025553310b3009060355040813024341311230100603550407130950616c6f20416c746f31183016060355040a130f46616365626f6f6b204d6f62696c653111300f060355040b130846616365626f6f6b311d301b0603550403131446616365626f6f6b20436f72706f726174696f6e30819f300d06092a864886f70d010101050003818d0030818902818100c207d51df8eb8c97d93ba0c8c1002c928fab00dc1b42fca5e66e99cc3023ed2d214d822bc59e8e35ddcf5f44c7ae8ade50d7e0c434f500e6c131f4a2834f987fc46406115de2018ebbb0d5a3c261bd97581ccfef76afc7135a6d59e8855ecd7eacc8f8737e794c60a761c536b72b11fac8e603f5da1a2d54aa103b8a13c0dbc10203010001300d06092a864886f70d0101040500038181005ee9be8bcbb250648d3b741290a82a1c9dc2e76a0af2f2228f1d9f9c4007529c446a70175c5a900d5141812866db46be6559e2141616483998211f4a673149fb2232a10d247663b26a9031e15f84bc1c74d141ff98a02d76f85b2c8ab2571b6469b232d8e768a7f7ca04f7abe4a775615916c07940656b58717457b42bd928a2",REFRESH_TOKEN_BARRIER:24*60*60*1000,LOCAL_CACHE_KEY:"com.mobage.ww.facebookCache",ACCESS_TOKEN_STORE_KEY:"com.mobage.ww.facebook.access_token_pair_"};var k=f.Facebook={authorizing_session:null,_getFBCache:function(){var l=b.global(h.LOCAL_CACHE_KEY);if(!l){b.init();l=b.global(h.LOCAL_CACHE_KEY)}return l},_saveAccessToken:function(m,n,l){k._getFBCache().setItem(h.ACCESS_TOKEN_STORE_KEY+m,n+","+l,{},function(){})},_loadAccessToken:function(l,m){k._getFBCache().getItem(h.ACCESS_TOKEN_STORE_KEY+l,{},function(q,p){if(!q){var o=p.split(",");var r=o[0];var n=o[1];m(null,r,n)}else{m(q,null,null)}})},_clearStoredAccessToken:function(l){k._getFBCache().removeItem(h.ACCESS_TOKEN_STORE_KEY+l,{},function(){})},_handleAndroidFBSSOResult:function(n){NgLogD("Facebook._handleAndroidFBSSOResult: Got back result: "+JSON.stringify(n));var l=false;var p=false;if(n.errorCode===0){p=true}else{if(n.errorCode===-1){l=true}else{var m=n.error;if(!m){m=n.error}if(m){if(m==h.SINGLE_SIGN_ON_DISABLED){l=true}else{if(m=="access_denied"){p=true}else{NgLogE("Facebook._handleAndroidFBSSOResult - Encountered error: "+m);var o=new a.AlertDialog();o.setTitle(a.LocText("Error logging in with Facebook"));o.setText(a.LocText("There was an error logging in with Facebook. You may need to try again later."));o.setChoices([a.LocText("OK")]);o.show();p=true}}}}}if(p){NgLogD("Facebook._handleAndroidFBSSOResult - Aborting auth")}else{if(k.authorizing_session){if(l){NgLogD("Facebook._handleAndroidFBSSOResult - Showing webview");k.authorizing_session._startDialogAuth()}else{NgLogD("Facebook._handleAndroidFBSSOResult - Authorized OK");k.authorizing_session.access_token=n.access_token;k.authorizing_session.expires_in=parseInt(n.expires_in,10)+(new Date().getTime());k._saveAccessToken(k.authorizing_session._facebookAppId,k.authorizing_session.access_token,k.authorizing_session.expires_in);if(k.authorizing_session._onFinishedCb){k.authorizing_session._onFinishedCb()}}}}},_handleIOSFBSSOResult:function(q){NgLogD("Facebook._handleIOSFBSSOResult: Got back result: "+q);if(k.authorizing_session){var n=q.split("#");if(n.length<2){n=q.split("?")}var p=null;if(n.length>=2){p={};var o=n[1].split("&");for(var m=0;m<o.length;m++){var l=o[m].split("=");p[l[0]]=l[1]}}if(p){if(p.access_token){NgLogD("Facebook._handleIOSFBSSOResult - Authorized OK");k.authorizing_session.access_token=p.access_token;k.authorizing_session.expires_in=parseInt(p.expires_in,10)+(new Date().getTime());k._saveAccessToken(k.authorizing_session._facebookAppId,k.authorizing_session.access_token,k.authorizing_session.expires_in);if(k.authorizing_session._onFinishedCb){k.authorizing_session._onFinishedCb()}}else{if(p.error){if(p.error=="service_disabled_use_browser"){NgLogD("Facebook._handleIOSFBSSOResult - Showing webview");k.authorizing_session._startDialogAuth()}else{if(p.error=="service_disabled"){}else{if(p.error_code){}else{}}}}}}}},getSession:function(l){if(!k._session){k._session=new e(l)}else{l(k._session)}},getPhotoUrlForUser:function(l){return"https://graph.facebook.com/"+l+"/picture"}};var e=g.Class.subclass({classname:"FacebookSession",permissions:["email"],initialize:function(l){this.access_token=null;this.expires_in=null;this._onFinishedCb=null;this._facebookAppId=null;g._LocalGameList.getGameConfig(g.Capabilities.getGameDir(),true,function(n){if(n&&n.facebookAppId){this._facebookAppId=n.facebookAppId}else{this._facebookAppId=g.Capabilities.getConfigs().mobageFacebookAppId?g.Capabilities.getConfigs().mobageFacebookAppId:h.MOBAGE_APP_ID}if(!a.Session.getCurrentSession()||!a.Session.getCurrentSession().isSomeoneLoggedIn()){l(this)}else{var m=this;k._loadAccessToken(this._facebookAppId,function(p,q,o){if(!p){m.access_token=q;m.expires_in=o}else{NgLogE("Facebook - Encountered error trying to load stored access token: "+p)}l(m)})}}.bind(this))},destroy:function(){},authorize:function(o,p,n){k.authorizing_session=this;var m=g.Capabilities.meetsBinaryVersion("1.7.5");var l=true&&m;this._onFinishedCb=function(){if(p){p()}this.request("me",function(q,r){if(!q){this._fbUserData=r;o()}else{if(n){n()}}}.bind(this))}.bind(this);if(l){this._startSingleSignOn()}else{this._startDialogAuth()}},getAccessToken:function(){return this.access_token},getUserData:function(){return this._fbUserData},_startSingleSignOn:function(m){var p=true;var l=this;if(g.Capabilities.getPlatformOS().toLowerCase()!="android"){g._LocalGameList.getGameConfig(g.Capabilities.getGameDir(),true,function(q){if(!q){l._startDialogAuth()}else{var r=q.appId?q.appId.replace(/[^A-Za-z0-9]+/g,"").toLowerCase():"";var s="fbauth://authorize?client_id="+l._facebookAppId+"&local_client_id="+r+"&type=user_agent&redirect_uri=fbconnect://success&display=touch&sdk=ios";if(e.permissions.length>0){s+="&scope="+e.permissions.join(",")}c.IPCEmitter.canLaunch(s,function(t){if(t){NgLogD("Facebook._startSingleSignOn: Sending launch URL to FB native app: "+s);a.MobageAnalytics.reportLoginRegEvent("RegDataLaunchNativeApp");c.IPCEmitter.launch(s)}else{l._startDialogAuth()}})}})}else{if(c.NetworkEmitter.getLastStatus()===c.NetworkEmitter.Status.None){var o=new a.AlertDialog();o.setTitle(a.LocText("We're not able to connect"));o.setText(a.LocText("Please check your network settings and try again."));o.setChoices([a.LocText("OK")]);o.show()}else{var n={requestToken:h.ANDROID_ACTIVITY_REQUEST_CODE,client_id:l._facebookAppId,_packageSignature:h.APP_SIGNATURE,_className:"com.facebook.katana.ProxyAuth",packageName:"com.facebook.katana"};if(e.permissions.length>0){n.scope=e.permissions.join(",")}a.MobageAnalytics.reportLoginRegEvent("RegDataLaunchNativeApp");c.IPCEmitter.launchIntent("",JSON.stringify(n))}}},_startDialogAuth:function(){a.MobageAnalytics.reportLoginRegEvent("RegDataLaunchFBWebview");var m={};if(e.permissions.length>0){m.scope=e.permissions.join(",")}var l=this;this.dialog(h.LOGIN_ACTION,m,function(n){l.access_token=n.access_token;l.expires_in=parseInt(n.expires_in,10)+(new Date().getTime());k._saveAccessToken(l._facebookAppId,l.access_token,l.expires_in);if(l._onFinishedCb){l._onFinishedCb()}},function(){},function(n){})},dialog:function(p,q,m,o,n){if(!m||!o||!n){NgLogE("Facebook.dialog - All 3 callbacks are required.");return}q.display="touch";q.redirect_uri=h.REDIRECT_URI;if(p==h.LOGIN_ACTION){q.type="user_agent";q.client_id=this._facebookAppId}else{q.app_id=this._facebookAppId}if(this.isSessionValid()){q[h.TOKEN]=this.getAccessToken()}var l=h.DIALOG_BASE_URL+p;l=this._encodeURL(l,q);a.FacebookWebview.show(l,m,o,n)},isSessionValid:function(){if(this.access_token===null){return false}if((new Date().getTime())>this.expires_in){return false}return true},request:function(n,q){var l=n.httpMethod;var p=n.params;var o=n.graphPath;if(typeof n=="string"){o=n}else{if(typeof n=="object"){l=n.httpMethod;p=n.params;o=n.graphPath}else{NgLogW("Facebook.request - called with bad request param: "+n);return}}if(!l){l="GET"}if(!p){p={}}p.format="json";if(this.isSessionValid()){p[h.TOKEN]=this.getAccessToken()}var m=(o!==null)?h.GRAPH_BASE_URL+o:h.RESTSERVER_URL;this._openURL(m,l,p,q)},_encodeURL:function(m,o){var n=true;for(var l in o){m=m+(n?"?":"&")+l+"="+encodeURIComponent(o[l]);n=false}return m},_encodePostBody:function(n,o){if(!n){return""}var l="";var m;for(m in n){l+='Content-Disposition: form-data; name="'+m+'"\r\n\r\n'+n[m];l+="\r\n--"+o+"\r\n"}return l},_openURL:function(l,m,q,u){var s="3i2ndDfv2rTHiSisAbouNdArYfORhtTPEefj3q2f";var o="\r\n";var n=undefined;var v=new j.XHR();if(m=="GET"){l=this._encodeURL(l,q)}else{if(!q){q={}}var p=q;q.method=m;if(q.access_token){q.access_token=decodeURIComponent(q.access_token)}v.setRequestHeader("Content-Type","multipart/form-data;boundary="+s);v.setRequestHeader("Connection","Keep-Alive");n="";n+="--"+s+o;n+=this._encodePostBody(q,s);n+=o+"--"+s+o;var t;for(t in p){n+='Content-Disposition: form-data; filename="'+t+'"'+o;n+="Content-Type: content/unknown"+o+o;n+=t;n+=o+"--"+s+o}}var r=this;v.open(m,l,true);v.onreadystatechange=function(){if(v.readyState==4){var w=null;var y=null;var x=v.status-(v.status%100);if(x!==200&&v.status!==304){NgLogD("FB  Request got error. Status: "+v.status+" UGH "+JSON.stringify(v));w=a.LocText("Please check your network connection settings.")}else{var z=r._parseJSON(v.responseText);w=z.error;y=z.data}u(w,y)}};v.send(q)},_parseJSON:function(l){if(l=="false"){a.MobageAnalytics.reportLoginRegEvent("RegDataFBParseJSONERR",{Error:"RequestFailed"});return{error:"request failed",data:null}}if(l=="true"){l="{value: true}"}try{var m=JSON.parse(l)}catch(n){NgLogException(n);a.MobageAnalytics.reportLoginRegEvent("RegDataFBParseJSONERR",{Error:"BadResponseJSON"});return{error:"mobage: bad response json",data:null}}if(m.error){a.MobageAnalytics.reportLoginRegEvent("RegDataFBParseJSONERR",{Error:"ErrorType: "+m.error.type+", msg: "+m.error.message});return{error:"Error type "+m.error.type+" - "+m.error.message,data:null}}if(m.error_code&&m.error_msg){a.MobageAnalytics.reportLoginRegEvent("RegDataFBParseJSONERR",{Error:"Code: "+m.error_code+", msg: "+m.error_msg});return{error:"Error "+m.error_code+" - "+m.error_msg,data:null}}if(m.error_code){a.MobageAnalytics.reportLoginRegEvent("RegDataFBParseJSONERR",{Error:"Code: "+m.error_code+", request failed"});return{error:"Error "+m.error_code+" - request failed",data:null}}if(m.error_msg){a.MobageAnalytics.reportLoginRegEvent("RegDataFBParseJSONERR",{Error:"Error msg: "+m.error_msg});return{error:"Error - "+m.error_msg,data:null}}if(m.error_reason){a.MobageAnalytics.reportLoginRegEvent("RegDataFBParseJSONERR",{Error:"Error reason: "+m.error_reason});return{error:"Error - "+m.error_reason,data:null}}a.MobageAnalytics.reportLoginRegEvent("RegDataFBParseJSONERR",{Error:"Error: "+m});return{error:null,data:m}},loginToMobage:function(q,l,p){if(this.isSessionValid()){var n=a.Session.getCurrentSession();var m=new a.PlusRequest();m.setApiMethod("session");m.setHttpMethod("POST");var o=n._loginParameters();o.social_token=this.getAccessToken();o.social_id=q;o.social_type="facebook";o.email=l;m.setPostBody(o);m.send(function(s,t,u,r){if(t&&t.error===117){p(null,{emailIsNew:true})}else{if(t&&t.error===106){p(null,{foundMobageEmail:true,userImage:t.photo_url,userName:t.fullname,userGamertag:t.gamertag})}else{if(s){p(s,null)}else{n._handleLoginResponse(s,t,u,r,function(v,w){if(!v){p(null,{didLogIn:true,mobageSession:n})}else{p(v,null)}})}}}})}else{p("No facebook session, need to be logged in",null)}},linkMobageAccount:function(r){if(this.isSessionValid()){var p=a.Session.getCurrentSession();if(p){var n=this._fbUserData.id;var m=this._fbUserData.first_name;var q=this._fbUserData.last_name;var l=k.getPhotoUrlForUser(n);var o=new a.PlusRequest();o.setHttpMethod("PUT");o.setApiMethod("users/"+p.user().recordID);o.setPostBody({social_account:{social_type:"facebook",social_id:n,social_token:this.getAccessToken()},first_name:m,last_name:q,social_photo_url:l});o.send(function(s,t){p.user().firstName=m;p.user().lastName=q;p.user().photoId=l;r(s,t)})}else{r("No mobage session, need to be logged in",null)}}else{r("No facebook session, need to be logged in",null)}},seeIfUpgradeable:function(q,l,p){if(this.isSessionValid()){var n=a.Session.getCurrentSession();var m=new a.PlusRequest();m.setApiMethod("session");m.setHttpMethod("POST");var o=n._loginParameters();o.social_token=this.getAccessToken();o.social_id=q;o.social_type="facebook";o.email=l;m.setPostBody(o);m.send(function(s,t,u,r){if(t&&t.error===117){p(null,true,false)}else{if(t&&t.error===106){p(null,true,true)}else{if(s){p(s,false,false)}else{p(null,false,false)}}}})}else{p("No facebook session, need to be logged in",false,false)}},upgradeGuestAccount:function(v,q,t){if(this.isSessionValid()){var p=a.Session.getCurrentSession();if(p){if(p.user()){var n=p.user();if(n.grade===1){var s=this._fbUserData.id;var o=this._fbUserData.first_name;var u=this._fbUserData.last_name;var r=this._fbUserData.email;var l=k.getPhotoUrlForUser(s);var m=new a.PlusRequest();m.setHttpMethod("PUT");m.setApiMethod("users/"+p.user().recordID);m.setPostBody({social_account:{social_type:"facebook",social_id:s,social_token:this.getAccessToken()},first_name:o,last_name:u,social_photo_url:l,gamertag:v,email:r,opt_in:q});m.send(function(w,x){if(w){t(w,null)}else{n.verifyUpgraded(function(y){if(y){t(y,null)}else{NgLogD("Mobage/user - Upgraded user OK!");p.user().firstName=o;p.user().lastName=u;p.user().photoId=l;p.user().gamertag=v;p.user().emailAddress=r;p.user().emailHash=a.User.hashForEmail(r);p.user().optsIn=q;t(null,p)}})}})}else{t("Logged in user isn't a guest user",null)}}else{t("No user on current session",null)}}else{t("No mobage session, need to be logged in",null)}}else{t("No facebook session, need to be logged in",null)}},getUserDataAsync:function(q){if(!a.Session.getCurrentSession()||!a.Session.getCurrentSession().isSomeoneLoggedIn()){q("must be logged in to mobage first",null)}else{var l=this;var m=function(){l.request({httpMethod:"GET",params:{},graphPath:"me"},function(s,r){if(s){q(s,null)}else{q(null,r)}})};if(this.isSessionValid()){m()}else{var p=function(){};var o=function(){m()};var n=function(){q("auth interrupted",null)};this.authorize(p,o,n)}}},getFacebookFriends:function(r,p,s){if(!a.Session.getCurrentSession()||!a.Session.getCurrentSession().isSomeoneLoggedIn()){s("must be logged in to mobage first",null)}else{var l=this;var m=function(){l.request({httpMethod:"GET",params:{offset:r,limit:p},graphPath:"me/friends"},function(u,t){if(u){s(u,null)}else{s(null,t.data)}})};if(this.isSessionValid()){m()}else{var q=function(){};var o=function(){m()};var n=function(){s("auth interrupted",null)};this.authorize(q,o,n)}}}})}};__ngs._2n={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var f=__ngs.r_(__ngs._o);var e=__ngs.r_(__ngs._5).Core;var b=new (__ngs.r_(__ngs._f).RequireLoader)({Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics}});var a=c.Push={_listeningForPush:false,_currentDeviceToken:null,_handlePushNotification:function(s){var w=(b.Capabilities.meetsBinaryVersion&&b.Capabilities.meetsBinaryVersion("1.7"));var u,p,k,m,v;if(w){u=s;p=JSON.stringify(u);m=u.extras;k=m.openurl;v=u.message}else{p=s;u={};try{u=JSON.parse(p)}catch(o){NgLogE("GameService/Push: Push Error: _handlePushNotification got an unparseable push payload.")}k=u.openurl;m=u;v=u.aps.alert}var l=null;var j={gameAppId:f.Session.getCurrentSession().appKey()};if(k){l=k}else{for(var t in m){if(t!==""&&t!=="aps"){l=t;break}}for(var r in u){if(r==="pcid"){j.pcid=u[r];break}}}if(l){j.payload=l}if(u&&u.aps&&u.aps.alert){j.alert=u.aps.alert}b.MobageAnalytics.reportEvent("NTFYACT",j);if(l){NgLogD("GameService/Push: Got push: "+p+" - Push payload = "+l);var q=(__ngs.r_(__ngs._2o).DeepLinking).parseMobageWWLink(l);var n=(__ngs.r_(__ngs._2o).DeepLinking).parseMarketLink(l);if(q){if(e.Capabilities.getIsDisaggregated()&&q.launchGame){var h=q.launchGame.replace("-iOS","").replace("-Android","");var g=f.Session.getCurrentSession().appKey().replace("-iOS","").replace("-Android","");if(h==g){__ngs.r_(__ngs._3u).GameLaunchPayload.onGameLaunchPayload(q.gamePayload)}else{q.alertText=v;(__ngs.r_(__ngs._2o).ServiceLinkEmitter).onLink(q)}}else{q.alertText=v;(__ngs.r_(__ngs._2o).ServiceLinkEmitter).onLink(q)}}else{if(n){NgLogD("GameService/Push/isMarketIntent: With Payload: "+l);if(e.Capabilities.isPlatformIOS()){NgLogD("GameService/Push/isMarketIntent/iOS");(__ngs.r_(__ngs._4).Device).IPCEmitter.launch(l)}else{if(e.Capabilities.isPlatformAndroid()){NgLogD("GameService/Push/isMarketIntent/Android");(__ngs.r_(__ngs._4).Device).IPCEmitter.launchIntent(l)}}}}}else{NgLogD("GameService/Push: Got push: "+p+" - No push payload")}return false},_registerAppForPush:function(h){NgLogD("GameService/Push: Registering for push notifications.");var g=function(j){NgLogD("GameService/Push: About to update session with device token: "+j);(__ngs.r_(__ngs._28)).PlusRequest.updateSessionDeviceToken(j,function(k,l){if(typeof k!="undefined"||typeof l=="undefined"||l.success===false){NgLogD("GameService/Push: Device update token encountered err: "+k)}else{NgLogD("GameService/Push: Device token update succeeded...");a.beginListeningForPushNotifications()}})};if(a._currentDeviceToken){g(a._currentDeviceToken)}else{(__ngs.r_(__ngs._1)).SystemBinding.getDeviceToken(function(j){if(j.success===true){g(j.devicetoken)}else{NgLogD("GameService/Push: Unable to obtain device token, NOT updating session... Err: "+j.error);NgLogD("GameService/Push: Retrying push reg in 5 seconds...");if(!h){h=1}else{h++}if(h<3){setTimeout(function(){a._registerAppForPush(h)},5000)}}})}},beginListeningForPushNotifications:function(){if(a._listeningForPush){return}var h=(b.Capabilities.meetsBinaryVersion&&b.Capabilities.meetsBinaryVersion("1.7"));NgLogD("GameService/Push: Listening for push notification events.");var g=new e.MessageListener();g.destroy=function(){if(h){(__ngs.r_(__ngs._4).Device).NotificationEmitter.removeListener(g)}else{(__ngs.r_(__ngs._4).Device).PushNotificationEmitter.removeListener(g)}};g.onPushRecivedFn=function(j){if(h){return c.Push._handlePushNotification(j.payload)}else{return c.Push._handlePushNotification(j)}};if(h){(__ngs.r_(__ngs._4).Device).NotificationEmitter.addListener(g,g.onPushRecivedFn)}else{(__ngs.r_(__ngs._4).Device).PushNotificationEmitter.addListener(g,g.onPushRecivedFn)}a._listeningForPush=true},enablePushRegistration:function(){NgLogD("GameService/Push: Enabling push registration begin");c.Push.onLoginListener=new e.MessageListener();c.Push.onLoginListener.onLogin=function(g){NgLogD("GameService/Push: Session login listener got msg, registering for push again.");c.Push._registerAppForPush()};c.Push.onSessionListener=new e.MessageListener();c.Push.onSessionListener.onSession=function(g){NgLogD("GameService/Push: Got a new session. Adding listener to it.");g.session.removeListener(c.Push.onLoginListener);g.session.addListener(c.Push.onLoginListener,c.Push.onLoginListener.onLogin);if(g.session.user()){NgLogD("GameService/Push: New session has a user, so let's register right now.");c.Push._registerAppForPush()}};f.Session.addCurrentSessionListener(c.Push.onSessionListener,c.Push.onSessionListener.onSession);if(f.Session.getCurrentSession()){if(f.Session.getCurrentSession().user()){NgLogD("GameService/Push: Already has a session with a user!, registering right now");c.Push._registerAppForPush()}NgLogD("GameService/Push: Adding listener to initial session as well...");c.Push.onSessionListener.onSession({session:f.Session.getCurrentSession()})}}}}};__ngs._2o={_c:null,_d:function(){var c={exports:{}};var a=c.exports;this._c=c;var b=a.DeepLinking={parseMobageWWLink:function(r){var n="mobage-ww-";var o=r.search(n);if(o!==-1){r=r.substring(o+n.length,r.length);var l="://";var A=r.search(l);if(A!=-1){var u=r.substring(0,A);r=r.substring(A+l.length,r.length);var v=r.split("/");if(v.length<3){return null}var q=v[0];var j=v[1];var m=v[2];var p;if(m==="ServiceUI"){var g=v[3].split("?");var h=g[0];var z={};if(g.length>1){var y=g[1].split(",");for(p=0;p<y.length;p++){if(y[p].search("payload=")===0){var f=y[p].split("=");try{z=JSON.parse(f[1])}catch(x){NgLogE("DeepLinking failed to parse a Page payload.")}}}}return{alertText:"<Forgot alertText!>",app_key:q,version:j,page:h,json:z}}else{if(m==="LaunchGame"){var w=v[3].split("?");var B=w[0];var k=__ngs.r_(__ngs._29).AppConfig;var t={};if(w.length>1){var d=w[1].split(",");for(p=0;p<d.length;p++){if(d[p].search("payload=")===0){var s=d[p].split("=");try{t=JSON.parse(s[1])}catch(x){NgLogE("DeepLinking failed to parse a Game payload.")}}}}return{alertText:"<Forgot alertText!>",app_key:q,version:j,launchGame:B,gamePayload:t}}}}}return null},parseMarketLink:function(d){return(d.search("market://")===0||d.search("http://")===0||d.search("https://")===0)}};a.ServiceLinkEmitter=(__ngs.r_(__ngs._t).Class).singleton({initialize:function(){},addListener:function(f,d){var e=false;if(!this._messageEmitter){e=true;this._messageEmitter=new (__ngs.r_(__ngs._1q).MessageEmitter)()}this._messageEmitter.addListener(f,d);if(e&&this._launchServiceLink){this._messageEmitter.emit(this._launchServiceLink);this._launchServiceLink=null}},onLink:function(d){if(this._messageEmitter){this._messageEmitter.emit(d)}else{this._launchServiceLink=d}}})}};__ngs._2p={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=new (__ngs.r_(__ngs._2b).InterfaceLoader)({NuxController:["_2x",function(d){return d.NuxController}]});b.ButtonOverlays={showCommunityButton:function(f){NgLogD("Privileged - showCommunityButton");var j=f.gravity||[0,0];if((j[0]!==0&&j[0]!==1)||(j[1]!==0&&j[1]!==1)){NgLogException(new Error("showCommunityButton: Illegal/Out-of-Bounds parameter: gravity "+JSON.stringify(j)));j=[(j[0]||0)%1,(j[1]||0)%1]}var g=f.theme;var d=null;if(f&&f.hasOwnProperty("callbackId")){d=function(){(__ngs.r_(__ngs._54)).getRouterInstance().sendCommandToGame({callbackId:f.callbackId})}}var e=__ngs.r_(__ngs._58).CommunityButtonController;e.destroyInstance();var h=new e();h.setThemeAndGravity(g,j);if(d){d()}},hideCommunityButton:function(e){NgLogD("Privileged - hideCommunityButton");var d=null;if(e&&e.hasOwnProperty("callbackId")){d=function(){(__ngs.r_(__ngs._54)).getRouterInstance().sendCommandToGame({callbackId:e.callbackId})}}(__ngs.r_(__ngs._58).CommunityButtonController).destroyInstance(d)},showBalanceButton:function(j){NgLogD("Privileged - showBalanceButton");var k=__ngs.r_(__ngs._59).UI;var h=new k.ViewGeometry.Rect(50,50,0,0);if(j.hasOwnProperty("rect")){h=j.rect}var d=null;if(j.hasOwnProperty("callbackId")){d=function(){(__ngs.r_(__ngs._54)).getRouterInstance().sendCommandToGame({callbackId:j.callbackId})}}var g="";if(j.hasOwnProperty("sourcePage")){g=j.sourcePage}var f=__ngs.r_(__ngs._5a).BalanceButtonController;f.destroyInstance();var e=new f(h,d,g)},hideBalanceButton:function(e){NgLogD("Privileged - hideBalanceButton");var d=null;if(e&&e.hasOwnProperty("callbackId")){d=function(){(__ngs.r_(__ngs._54)).getRouterInstance().sendCommandToGame({callbackId:e.callbackId})}}(__ngs.r_(__ngs._5a).BalanceButtonController).destroyInstance(d)},refreshBalanceButton:function(d){NgLogD("Privileged - showBalanceButton");(__ngs.r_(__ngs._5a).BalanceButtonController).refreshBalance()},hideAllButtons:function(){for(var d in this){if(typeof this[d]==="function"&&d.match(/^hide/)&&d!=="hideAllButtons"){this[d]()}}}}}};__ngs._2q={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var a=new (__ngs.r_(__ngs._f).RequireLoader)({LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},FileSystem:function(){return __ngs.r_(__ngs._d).FileSystem},Assets:function(){return __ngs.r_(__ngs._2z).Assets}});var f=__ngs.r_(__ngs._59).UI;var b=__ngs.r_(__ngs._t).Class;var e=c.EditTextLimits=b.singleton({classname:"EditTextLimits",initialize:function(){this.loadStrings();this.loadLimitFile()},loadStrings:function(){this.limits={report_reason:{underMinLengthMessage:a.LocText("Please enter a reason to report this user.")},current_password_field:{underMinLengthMessage:a.LocText("Please enter Current Password.")},new_password_field:{overMaxLengthMessage:a.LocText("Password can't be more than 25 characters"),underMinLengthMessage:a.LocText("Password must be at least 8 characters"),doesNotValidateMessage:a.LocText("Password cannot contain spaces."),placeholder:a.LocText("At least 8 characters")},gamer_password:{overMaxLengthMessage:a.LocText("Password can't be more than 25 characters"),underMinLengthMessage:a.LocText("Password must be at least 8 characters"),doesNotValidateMessage:a.LocText("Password cannot contain spaces."),placeholder:a.LocText("Password (min. 8 characters)")},email_address:{underMinLengthMessage:a.LocText("Email address must be at least 3 characters"),overMaxLengthMessage:a.LocText("Email address can't be more than 100 characters"),doesNotValidateMessage:a.LocText("Please enter a valid email address.")},gamer_email_address:{doesNotValidateMessage:a.LocText("Email address cannot contain spaces."),placeholder:a.LocText("Enter email here")},forgot_password_email_address:{doesNotValidateMessage:a.LocText("Email address cannot contain spaces.")},first_name:{placeholder:a.LocText("First Name"),doesNotValidateMessage:a.LocText("Your first name must consist of only letters, numbers, spaces, and hyphens, and must not end with a space."),underMinLengthMessage:a.LocText("Your first name must contain at least one character.")},last_name:{placeholder:a.LocText("Last Name"),doesNotValidateMessage:a.LocText("Your last name must consist of only letters, numbers, spaces, and hyphens, and must not end with a space."),underMinLengthMessage:a.LocText("Your last name must contain at least one character.")},user_search:{placeholder:a.LocText("Name, Mobage name, or email"),underMinLengthMessage:a.LocText("Who are you looking for?")},gamer_name:{doesNotValidateMessage:a.LocText("Mobage name must not contain spaces or tabs."),underMinLengthMessage:a.LocText("Mobage name must be at least 8 characters."),overMaxLengthMessage:a.LocText("Mobage name can't be more than 15 characters."),placeholder:a.LocText("Username (new, existing or Plus+)")},wall_post:{placeholderText:a.LocText("What are you playing?")},wall_post_cur_user:{placeholder:a.LocText("What's happening?")}};this.defaultLimits={overMaxLengthMessage:a.LocText("Only %1d characters are allowed. Extra characters will be truncated.")}},_constructRegExp:function(g){if(typeof g==="string"){return new RegExp(g)}else{return new RegExp(g[0],g[1])}},loadLimitFile:function(){a.FileSystem.readFile(a.Assets.loadEditTextLimitsPath(),this.bind(this._incomingConfigFile))},_incomingConfigFile:function(j,l){if(j){NgLogD("EditTextLimits ERROR: "+j);return}var n;try{n=JSON.parse(l)}catch(m){NgLogD("EditTextLimits: Got an unparseable Config File : "+l);return}var g;var h;var k;for(g in n){if(n.hasOwnProperty(g)){h=n[g];for(k in h){if(h.hasOwnProperty(k)){this.limits[g][k]=h[k]}}}}},$find:function(j){var g=this.variant(this.defaultLimits,this.limits[j]);if(g.inputTypeString){try{g.inputType=f.Commands.InputType[g.inputTypeString]}catch(h){g.inputType=f.Commands.InputType.None;NgLogE("Interface Limits Data File has a bad value for input type string: "+g.inputTypeString)}}if(g.enterKeyTypeString){try{g.enterKeyType=f.Commands.EnterKeyType[g.enterKeyTypeString]}catch(h){g.enterKeyType=f.Commands.EnterKeyType.Done;NgLogE("Interface Limits Data File has a bad value for enter key type string: "+g.enterKeyTypeString)}}if(g.goodRegex){g.goodRegexpObj=this._constructRegExp(g.goodRegex)}if(g.badRegex){g.badRegexpObj=this._constructRegExp(g.badRegex)}g.validate=function(k){if(this.goodRegexpObj){if(!this.goodRegexpObj.test(k)){return false}}if(this.badRegexpObj){if(this.badRegexpObj.test(k)){return false}}return true}.bind(g);return g},$variant:function(l,j){var h={};var g;for(g in l){if(l.hasOwnProperty(g)){h[g]=l[g]}}for(g in j){if(j.hasOwnProperty(g)){h[g]=j[g]}}return h}})}};__ngs._2r={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=__ngs.r_(__ngs._2a).Destinations;var e=__ngs.r_(__ngs._5).Core;var a=new __ngs.r_(__ngs._f).RequireLoader({UI:function(){return __ngs.r_(__ngs._59).UI},_int_LGL:function(){return __ngs.r_(__ngs._h)._int_LGL},_LocalGameList:function(){return __ngs.r_(__ngs._g)._LocalGameList},LocalGameList:function(){return __ngs.r_(__ngs._3).LocalGameList},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities},GSNavController:function(){return __ngs.r_(__ngs._5b).GSNavController},LifecycleEmitter:function(){return __ngs.r_(__ngs._11).LifecycleEmitter},Device:function(){return __ngs.r_(__ngs._4).Device},Session:function(){return __ngs.r_(__ngs._o).Session},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},CredentialsHost:function(){return __ngs.r_(__ngs._2s).CredentialsHost},RegistrationController:function(){return __ngs.r_(__ngs._4v).Registration},NavPlaceholder:function(){return __ngs.r_(__ngs._4w).GamePlaceholder},LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics}});c.Credentials={showLogin:function(g){NgLogD("Private call showLogin");var f=new a.LoginController(function(h){NgLogD("Mobage/Credentials/showLogin callback begin user="+h);var j=new a.NavPlaceholder(a.CredentialsHost,"AhabTester_hardcoded");a.CredentialsHost.navController.pushViewController(j);a.CredentialsHost.navController.removeUntilViewController(a.CredentialsHost.navController.getBottomViewController());a.CredentialsHost.hide();if(g){g(h)}});a.CredentialsHost.navController.pushViewController(f)},showRegistration:function(j,k,g,n,m,f){NgLogT("@@@ mobage Credentials.showRegistration");if(g){var l=a.Session.getCurrentSession();if(l.user()){if(l.user().grade!==1){j(null,"error, current user is not a guest user");return}}else{j(null,"error, no user present to upgrade");return}}var h=a.RegistrationController.initWithJSON({cb:function(o,p){NgLogD("Mobage/Credentials/showRegistration callback begin user="+o+", error="+p);a.CredentialsHost.hide();if(j){j(o,p)}},useFacebook:k,showUpgradeFlow:g,regFlowVariant:n,startView:m,regReferrer:f});a.CredentialsHost.reloadView();a.CredentialsHost.navController.pushViewController(h)},askUserForLogout:function(f){var g=new a.UI.AlertDialog();g.setTitle(a.LocText("Logout"));g.setText(a.LocText("Are you sure you want to log out and quit?"));g.setChoices([a.LocText("Yes"),a.LocText("No")]);g.show();g.onchoice=function(j){if(j.choice===0){NgLogD("AccountSettingsController - User is being logged out");g.hide();var h=new a.UI.ProgressDialog();h.setText(a.LocText("Logging out..."));h.show();this.logout(function(){h.hide();f()})}}.bind(this)},logout:function(f){var g=a.Session.getCurrentSession();if(g.user()&&g.user().usesGuestLogin()){return}f();g._clearAuthToken(function(){a.MobageAnalytics.reportEvent("UserLogOut");setTimeout(function(){a.Device.LifecycleEmitter.exitProcess()},100)})},clearGuestUser:function(){var f=a.Session.getCurrentSession();if(f.user()&&!f.user().usesGuestLogin()){return}f._clearAuthToken(function(){f._clearGuestCredentials(function(){a.MobageAnalytics.reportEvent("GuestAccountCleared");setTimeout(function(){a.Device.LifecycleEmitter.exitProcess()},100)})})}}}};__ngs._2s={_c:null,_d:function(){var c={exports:{}};var g=c.exports;this._c=c;var d=__ngs.r_(__ngs._59).UI;var b=__ngs.r_(__ngs._4).Device;var h=__ngs.r_(__ngs._5).Core;var j=__ngs.r_(__ngs._5c).LayoutMethods;var e=__ngs.r_(__ngs._5d).Host;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Assets:function(){return __ngs.r_(__ngs._2z).Assets},MobageNavLogic:function(){return __ngs.r_(__ngs._5e).MobageNavLogic},GamePlaceholder:function(){return __ngs.r_(__ngs._4w).GamePlaceholder},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},CredentialsHostView:function(){return __ngs.r_(__ngs._5f).CredentialsHostView},DisaggregatedCredentialsHostView:function(){return __ngs.r_(__ngs._5g).DisaggregatedCredentialsHostView}});var f=g.CredentialsHost=e.singleton({classname:"CredentialsHost",initialize:function($super){$super();this.setShouldAutoRotate(false);this.navLogic=(new a.MobageNavLogic.CredentialsBackPreservingNav(this)).retain();this.navController.setDelegate(this.navLogic);this.navController._dontAnimateTransitions=true;this._layoutML=j.createLayoutListener(this,this.layoutChanged)},destroy:function(){this._layoutML.destroy()},loadView:function(){NgLogD("mobage-CredentialsHost-loadView: Loading the mobage service container.");this.setView(new a.DisaggregatedCredentialsHostView());var k=this.navController.view();this.view().removeChild(k);this.view().setNavControllerView(k);this.view().setFrame(d.Window.getFrame());this.view().backButton.DisaggregatedCredentialsHostViewonclick=function(){NgLogD("mobage-CredentialsHost: Back Button Tapped - transitioning? "+this.navController._isTransitioningViews);if(!this.navController._isTransitioningViews){this.navController.back()}}.bind(this);this.navController.pushViewController(new a.GamePlaceholder(this,"AhabTester_hardcoded"))},layoutChanged:function(k){},setIsFooterEnabled:function(k){},setRegHeaderEnabled:function(k,l){},setMarketAppID:function(k){this.view().credentialsHeaderView.setGameIcon(k)},show:function($super,k){NgLogD("mobage-CredentialsHost-show");if(!this.view().getParent()){d.Window.document.addChild(this.view());this.resurfaceControls()}a.ServiceHost.closeMenuDrawer();$super(k)},hide:function($super){NgLogD("mobage-CredentialsHost: hide");if(!this||!this._showing){NgLogD("mobage-CredentialsHost-hide: No Service Instance, or not currently showing");return}$super();this.view().removeFromParent();this.resurfaceControls(true)},resurfaceControls:function(k){},onNavTransition:function(n,k,l,m){},editMode:function(l,k){this.view().editMode(l,k)},isSupportedOrientation:function(k){return true}})}};__ngs._2t={_c:null,_d:function(){var c={exports:{}};var d=c.exports;this._c=c;var f=__ngs.r_(__ngs._5).Core;var h=__ngs.r_(__ngs._s).Network;var j=__ngs.r_(__ngs._a).Storage;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Assets:function(){return __ngs.r_(__ngs._2z).Assets}});var b=f.Class.subclass({classname:"KVFlatFileStore",initialize:function(k,l){this.path=k;this.data={};this.initialCallback=l;j.FileSystem.readFile(this.path,false,this._loadFileCb.bind(this))},getItem:function(k){return this.data[k]},setItem:function(k,l){this.data[k]=l},deleteItem:function(k){delete this.data[k]},save:function(){if(!this.saveInFlight){j.FileSystem.writeFile(this.path,JSON.stringify(this.data),false,this._saveFileCb.bind(this));this.pendingWriteRequest=false;this.saveInFlight=true}else{this.pendingWriteRequest=true}},_loadFileCb:function(l,m){var k=false;if(l){NgLogI("KVFlatFileStore: failed to load cache from disk, creating new one: "+this.path);k=true}else{try{this.data=JSON.parse(m);NgLogI("KVFlatFileStore: Successfully loaded cache from disk: "+this.path)}catch(n){NgLogI("KVFlatFileStore: corrupt disk cache, creating new one: "+this.path);k=true}}if(k){this.data={}}this.initialCallback()},_saveFileCb:function(k){this.saveInFlight=false;if(k){NgLogE("KVFlatFileStore Error: Catastrophic Failure writing cache status to disk. Undefined behavior ahead.")}if(this.pendingWriteRequest){this.save()}}});var e=f.Class.subclass({classname:"RemoteFileCache",fetchFileForURL:function(l,m){var k=this._fileIdForURL(l);if(!k){return}this._storeCallback(k,m);this._checkAndProcessFileId(k)},initialize:function(k,m,l){this.cbIdGen=0;this.highWaterMark=m||10;this.lowWaterMark=l||0;this._observers={};this.kvStoreDir=k;this._loadKV()},_loadKV:function(){this.kv=new b(this.kvStoreDir+"index.json",this.bind(function(){this.mapping=this.kv.getItem("mapping");if(!this.mapping){this.kv.setItem("mapping",this.mapping={})}else{var m;for(var l in this.mapping){if(this.mapping.hasOwnProperty(l)){if((m=this.kv.getItem(l))){delete m.inFlight;delete m.failed;delete m.lastError}}}}NgLogI("RemoteFileCache: loaded index");this._storeCacheState()}))},_checkAndProcessFileId:function(k){var l=this.kv.getItem(k);if(!l){this.kv.setItem(k,l={})}if(l.inFlight){return}if(l.diskPath&&!this.shouldRefresh(k,l)){this._respondForFile(k,l);return}this._beginFetch(k,l)},_beginFetch:function(k,l){l.inFlight=true;l.failed=false;delete l.lastError;var m=new h.DownloadFile();l.tmpPath=this.kvStoreDir+k;h.Util.OperationWithRetries(this.bind(function(n,p){var o=[{item:"If-None-Match",content:l.md5}];NgLogI("RemoteFileCache: "+l.tmpPath+" Fetching: "+this.mapping[k]);m.start(l.tmpPath,"GET",this.mapping[k],o,this.bind(function(q,r){if(q==200){NgLogI("RemoteFileCache: HTTP 200");this._receivedFileToTmp(k,l,r);return}else{if(q==304){NgLogI("RemoteFileCache: HTTP 304 - Not Modified!");this._respondForFile(k,l);return}else{NgLogE("RemoteFileCache: HTTP "+q+" ???");l.lastError={httpCode:q};n()}}}))}),this.bind(function(){NgLogE("RemoteFileCache: Giving up downloading due to too many errors!");l.failed=true;this._respondForFile(k,l)}));this._storeCacheState()},_receivedFileToTmp:function(k,m,l){m.diskPath=m.tmpPath;m.md5=l;delete m.tmpPath;this._respondForFile(k,m)},_respondForFile:function(k,m){m.lastUsed=(new Date()).getTime();m.inFlight=false;if(!m.failed){delete m.lastError}this._storeCacheState();if(this._observers[k]){var n=this._observers[k];this._observers[k]=[];for(var l=0;l<n.length;l++){if(typeof n[l]==="function"){n[l](m.lastError,m.diskPath)}}}if(this.shouldShrinkCache()){this._recycle()}},_fileIdForURL:function(k){if(!k){return null}if(!this.mapping[k]){this.mapping[k]=f.toMD5(k);this.mapping[this.mapping[k]]=k;this._storeCacheState()}return this.mapping[k]},_storeCallback:function(k,l){l=l||function(){};if(!this._observers[k]){this._observers[k]=[]}this._observers[k].push(l)},_storeCacheState:function(){this.kv.save()},shouldShrinkCache:function(){if(this.mapping&&Object.keys(this.mapping).length>this.highWaterMark*2){return true}return false},_recycle:null,$RecyclingStyles:{lru:function(){var n=Object.keys(this.mapping);var p=[];var o,q,m;for(m=0;m<n.length;m++){o=n[m];if((q=this.kv.getItem(o))&&q.lastUsed){p.push(o)}}var l=function(s,r){return this.kv.getItem(r).lastUsed-this.kv.getItem(s).lastUsed};p.sort(l);var k=p.slice(this.lowWaterMark);for(m=0;m<k.length;m++){this._destroyItem(k[m])}this._storeCacheState()},fastest:function(){var m=Object.keys(this.mapping);var o=[];var n,p,l;for(l=0;l<m.length;l++){n=m[l];if((p=this.kv.getItem(n))&&!p.inFlight){o.push(n)}}var k=o.slice(this.lowWaterMark);for(l=0;l<k.length;l++){this._destroyItem(k[l])}this._storeCacheState()}},_destroyItem:function(k){var l=this.kv.getItem(k);if(l.diskPath){j.FileSystem.deleteFile(l.diskPath)}delete this.mapping[this.mapping[k]];delete this.mapping[k];this.kv.deleteItem(k)}});var g=d.GameCarouselCache=e.singleton({classname:"GameCarouselCache",addGame:function(k,l){if(!k||!k.promotionalImage){return}this.fetchFileForURL(k.promotionalImage,this.bind(function(n,m){if(n){NgLogE("GameCarouselCache Error: failed to fetch image for game: "+k.name+" "+k.promotionalImage);NgLogI("GameCarouselCache: Error was: "+JSON.stringify(n))}else{NgLogI("GameCarouselCache: Successfully got image: "+m);if(f.Capabilities.getPlatformOS().toLowerCase()!=="flash"){m=m.slice(m.indexOf("/")+1)}this.images[k.recordID]=m;l()}}))},readyImageForGame:function(k){return this.images[k.recordID]},shouldRefresh:function(k,l){if(this._freshCache[l.md5]!=k){this._freshCache[l.md5]=k;return true}return false},initialize:function($super){var k=a.Assets.privSandboxPath();if(!k[k.length-1]=="/"){k+="/"}this._freshCache={};this.images={};$super(k+"GameCarouselCache/",30,10);this._recycle=e.RecyclingStyles.lru}})}};__ngs._2u={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var f=__ngs.r_(__ngs._59).UI;var a=__ngs.r_(__ngs._7).Capabilities;var b=new (__ngs.r_(__ngs._f).RequireLoader)({MobageBrandStyle:function(){return __ngs.r_(__ngs._5h).MobageBrandSlideIn}});var e=function(l,k,h){var n=false;var m=function(){if(!n){n=true;h(true)}};var j=function(){if(!n){n=true;h(false)}};setTimeout(m,k*1.5);f.animate(l,k,j)};var g=c.MobageBrandSlideIn=f.Button.subclass({classname:"MobageBrandSlideIn",initialize:function($super,h,j){$super(h);this.touchable=false;b.MobageBrandStyle.applyTo(this);this.transitionAnimationTime=600;this._prepareLayout();j.addChild(this)},_prepareLayout:function(){var k=new f.ViewGeometry.Rect((16/480)*a.getScreenWidth(),(379/800)*a.getScreenHeight(),(448/480)*a.getScreenWidth(),(415/800)*a.getScreenHeight());var j=a.getScreenWidth();this.centerFrame=k;var h=k.copy();h.x+=j;this.finalFrame=k.copy();this.finalFrame.x-=j;this.setFrame(h);this.setTextInsets(0,0,k.h/2.1,0)},slideInAndOut:function(h){this.slideIn(function(){setTimeout(function(){this.slideOut(h)}.bind(this),2*this.transitionAnimationTime)}.bind(this))},slideIn:function(h){NgLogD("@@@ mobage MobageBrandSlideIn.slideIn");var j=function(k){if(k){this.setFrame(this.centerFrame)}h()}.bind(this);e(function(){this.setFrame(this.centerFrame)}.bind(this),this.transitionAnimationTime,j)},slideOut:function(h){NgLogD("@@@ mobage MobageBrandSlideIn.slideOut");var j=function(k){if(k){this.setFrame(this.finalFrame)}h()}.bind(this);e(function(){this.setFrame(this.finalFrame)}.bind(this),this.transitionAnimationTime,j)}})}};__ngs._2v={_c:null,_d:function(){var d={exports:{}};var g=d.exports;this._c=d;var f=__ngs.r_(__ngs._59).UI;var b=__ngs.r_(__ngs._4).Device;var h=__ngs.r_(__ngs._5).Core;var e=__ngs.r_(__ngs._2a).Destinations;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Assets:function(){return __ngs.r_(__ngs._2z).Assets},_LocalGameList:function(){return __ngs.r_(__ngs._g)._LocalGameList},Host:function(){return __ngs.r_(__ngs._5d).Host},MobageNavLogic:function(){return __ngs.r_(__ngs._5e).MobageNavLogic},MobagePauseGame:function(){return __ngs.r_(__ngs._5i).MobagePauseGame},ServiceLinkEmitter:function(){return __ngs.r_(__ngs._2o).ServiceLinkEmitter},GameLaunchedEmitter:function(){return __ngs.r_(__ngs._2g).GameLaunchedEmitter},Session:function(){return __ngs.r_(__ngs._o).Session},Game:function(){return __ngs.r_(__ngs._2e).Game},User:function(){return __ngs.r_(__ngs._30).User},GameLaunchPayload:function(){return __ngs.r_(__ngs._3u).GameLaunchPayload},ServiceHostView:function(){return __ngs.r_(__ngs._5j).ServiceHostView},CustomModalDialog:function(){return __ngs.r_(__ngs._5k).CustomModalDialog},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics}});var k=__ngs.r_(__ngs._n).LocalizedString;var l=__ngs.r_(__ngs._5c).LayoutMethods;var c=h.MessageListener.subclass({classname:"GSNavController_orientationListener"});var j=g.ServiceHost=a.Host.singleton({classname:"ServiceHost",_runningActiveGame:false,_layoutListenerInstance:null,_oldOrientation:null,_oldActiveGame:null,_gameSuspended:false,initialize:function($super){$super();this.navLogic=(new a.MobageNavLogic.ServiceNavLogic(this)).retain();this.navController.setDelegate(this.navLogic);this.navController.setLandscapeOnly(true);this.navController.view().setFrame(l.guessLandscapeFrameHack());this._isInServiceUI=true;var m=this;this._layoutListenerInstance=l.createLayoutListener(this,function(o){if(o.width>o.height){this.view().setFrame(0,0,o.width,o.height);this.view().layoutSubviews()}this.view().layoutMenuDrawer(o.width,o.height)});this.setShouldAutoRotate(true);a._LocalGameList.setFinishGameHandler(this.bind(function(){this.navController.back()}));var n=h.MessageListener.subclass({_onLifecycleEvent:function(o){if(o===b.LifecycleEmitter.Event.Suspend){m.closeMenuDrawer();m._gameSuspended=true}else{if(o===b.LifecycleEmitter.Event.Resume){m._gameSuspended=false}}return true},destroy:function(){b.LayoutEmitter.removeListener(this)}});this._lifecycleListenerInstance=new n();b.LifecycleEmitter.addListener(this._lifecycleListenerInstance,this._lifecycleListenerInstance._onLifecycleEvent);this._globalDownloadListener=new h.MessageListener();a.Game.addGlobalDownloadListener(this._globalDownloadListener,this.onGlobalDownloadStatus.bind(this));NgLogD("ServiceHost/initialize - going to start listening for service links");setTimeout(function(){if(!this._serviceLinkListener){this._setupServiceLinkListener()}}.bind(this),100)},destroy:function(){this.navLogic.release();if(this._serviceHostDlg){this._serviceHostDlg.destroy()}this._layoutListenerInstance.destroy();this._lifecycleListenerInstance.destroy();this._globalDownloadListener.destroy()},_followServiceLink:function(n){var m=this;if(n.launchGame){a.Game.getGameWithAppKey(n.launchGame,function(p,o){if(!p){if(o.isAvailableLocally()){a.GameLaunchPayload.onGameLaunchPayload(n.gamePayload)}e.loadThenAct("GameProfile",function(q){q.startGameOrGoToProfile(o,"JSGamePlayDeepLink")})}})}else{if(n.json.user){a.User.getUserWithGamertag(n.json.user,function(o,p){if(!o){n.json.user=p;e.pushScreen(m.navController,n.page,n.json)}})}else{if(n.json.game){a.Game.getGameWithAppKey(n.json.game,function(o,p){if(!o){n.json.game=p;e.pushScreen(m.navController,n.page,n.json)}})}else{e.pushScreen(this.navController,n.page,n.json)}}}},_setupServiceLinkListener:function(){NgLogD("_setupServiceLinkListener "+this);if(!this._serviceLinkListener){NgLogD("_setupServiceLinkListener... doing setup "+this);var m=this;this._serviceLinkListener=new c();this._serviceLinkListener._onServiceLinkRecieved=function(n){a.MobageAnalytics.reportEvent("MobageServiceLaunchedFromPush",{link:n});if(n.noDialog||a.Capabilities.isPlatformAndroid()||m._suppressServiceLinkDialog){NgLogD("ServiceHost: Got service link at startup: "+JSON.stringify(n));m._followServiceLink(n)}else{NgLogD("ServiceHost: Got service link: "+JSON.stringify(n));if(!m._serviceHostDlg){m._serviceHostDlg=new f.AlertDialog()}m._serviceHostDlg.setTitle(k("New Notification"));m._serviceHostDlg.setText(k(n.alertText));m._serviceHostDlg.setChoices([k("Later"),k("View")]);m._serviceHostDlg.onchoice=function(o){m._serviceHostDlg.hide();if(o.choice===1){m._followServiceLink(n)}};m._serviceHostDlg.show()}};this._suppressServiceLinkDialog=true;a.ServiceLinkEmitter.addListener(this._serviceLinkListener,this._serviceLinkListener._onServiceLinkRecieved);setTimeout(function(){m._suppressServiceLinkDialog=false},100)}},setBackButtonFunction:function(m){if(typeof m=="function"){this.view().backButton.onclick=m}else{this.view().backButton.onclick=this.bind(function(){this.logd("Back Button Tapped");if(this.navController._isTransitioningViews){NgLogD("ServiceHost-backButton tapped but is transitioning views, so no dice!")}else{this.navController.back()}})}},loadView:function($super){this.setView((new a.ServiceHostView()).retain());this.view().setNavControllerView(this.navController.view());var m=new f.ViewGeometry.Rect(l.guessLandscapeFrameHack());this.view().setFrame(m);this.view().layoutSubviews();this.setupForHomeScreen(false);this.view().iOSLogoShift=true;this.setBackButtonFunction();this.view().activeGameButton.onclick=this.bind(function(){this.logd("ActiveGame Button Tapped");if(this.navController._isTransitioningViews){this.logd("ActiveGameButton Tapped, but navController is animating another event. Prevent the button click")}else{this.showLoadingHelper(function(){this.navController.popToViewController(this.navController.getBottomViewController())}.bind(this))}});e.pushScreen(this.navController,"GamePlaceholder",{host:this,game:"AhabTester_hardcoded"})},show:function($super,o){if(this._showing){this.logd("service instance already showing.");return}this.view().setAlpha(1);NgLogD("ServiceHost-show");if(a.Session.getCurrentSession()&&a.Session.getCurrentSession()._appKey){var p=a.Session.getCurrentSession()._appKey;this._runningActiveGame=p&&p!=="default-Dev"&&p.search("mobage-Dev")==-1&&p.search("mobageBoot")==-1;this._oldActiveGame=p}else{NgLogE("ERROR: ServiceHost.show() - was unable to get the appKey from imports.Session!");this._runningActiveGame=true}if(this._runningActiveGame){a.MobagePauseGame.pauseGame(this)}if(!this.view().getParent()){f.Window.document.addChild(this.view())}$super(o);this.resurfaceControls();var n=b.OrientationEmitter.Orientation.LandscapeLeft;if(this._shouldAutoRotate){var m=b.OrientationEmitter.getDeviceOrientation();if(this.isSupportedOrientation(m)){n=m}}if(a.Capabilities.isPlatformIOS()){this._oldOrientation=b.OrientationEmitter.getInterfaceOrientation();NgLogD("mobage service host opening: rotating to landscape."+this._oldOrientation);this._setOrientation(n)}else{setTimeout(this.bind(function(){this._oldOrientation=b.OrientationEmitter.getInterfaceOrientation();NgLogD("mobage service host opening: rotating to landscape."+this._oldOrientation);this._setOrientation(n)}),1)}h.Analytics._getPipe().sessionStartEvent()},hide:function($super){if(!this||!this._showing){this.logd("hide: No Service Instance, or not currently showing");return}$super();this.view().setAlpha(254/255);this.view().removeFromParent();this.resurfaceControls(true);h.Analytics._getPipe().sessionEndEvent();if(this._runningActiveGame){var m=a.Session.getCurrentSession()._appKey;if(m==this._oldActiveGame){setTimeout(this.bind(function(){NgLogD("mobage service host closing. Restoring Orientation to "+this._oldOrientation);this._setOrientation(this._oldOrientation)}),1)}a.MobagePauseGame.resumeGame(this)}},_setOrientation:function(m,q){var p,o,n;o=b.OrientationEmitter.getInterfaceOrientation();if(o!=m){n=true;p=new h.MessageListener();b.OrientationEmitter.addListener(p,function(r){if(r.type===b.OrientationEmitter.OrientationType.Interface&&r.orientation===m){this.view().hideFullScreenLoadingSpinner();n=false;b.OrientationEmitter.removeListener(p)}}.bind(this));setTimeout(function(){if(n){this.view().hideFullScreenLoadingSpinner()}}.bind(this),5000)}b.OrientationEmitter.setInterfaceOrientation(m)},getGameOrientation:function(){return this._oldOrientation},isGameSuspended:function(){return this._gameSuspended},isRunningActiveGame:function(){return this._runningActiveGame},setIsRunningActiveGame:function(m){this._runningActiveGame=m},resurfaceControls:function($super,m){if(!this._showing||m){this.view().mobageButton.removeFromParent();this.view().backButton.removeFromParent();this.view().activeGameButton.removeFromParent();this.view().doneButton.removeFromParent();this.view().cancelButton.removeFromParent();this.view().currentDownload.setFrame(this.view()._currentDownloadRect);this.view().hideTitleBar(true)}else{this.view().hideTitleBar(false);this.view().mobageButton.removeFromParent();this.view().backButton.removeFromParent();this.view().activeGameButton.removeFromParent();this.view().currentDownload.setFrame(this.view()._currentDownloadRect);if(this._runningActiveGame){this.view().addChild(this.view().activeGameButton);this.view().currentDownload.setFrame(this.view()._currentDownloadRectWithGame)}if(this._showNavButtons){this.view().addChild(this.view().backButton);this.view().addChild(this.view().cancelButton);this.view().addChild(this.view().doneButton);this.view().addChild(this.view().mobageButton);this.view().shiftMobageLogo();this.view().iOSLogoShift=true}else{this.view().addChild(this.view().mobageButton);this.view().resetShiftMobageLogo();this.view().iOSLogoShift=false}}},hideControls:function(){this.view().mobageButton.removeFromParent();this.view().backButton.removeFromParent();this.view().activeGameButton.removeFromParent();this.view().currentDownload.setFrame(this.view()._currentDownloadRect)},showLoadingHelper:function(m){this.showLoadingLabel();setTimeout(function(){m()},1)},showLoadingLabel:function(){this.view().spinner.setVisible(true);this.view().loadingLabel.setVisible(true)},hideLoadingLabel:function(){this.view().spinner.setVisible(false);this.view().loadingLabel.setVisible(false)},editMode:function(n,m){if(this._showNavButtons){this.view().editMode(n,m)}},setEditMode:function(m){this.view().setEditMode(m)},isSupportedOrientation:function(m){if(m==b.OrientationEmitter.Orientation.LandscapeLeft||m==b.OrientationEmitter.Orientation.LandscapeRight){return true}return false},setupForHomeScreen:function(m){if(this.view()){if(this.view().mobageButton){if(m){this.view().mobageButton.setImage(a.Assets.image("mobagelogotm.png"));this.view().mobageButton.setImage(a.Assets.image("mobagelogotm.png"),f.State.Pressed);this.view().mobageButton.onclick=null}else{this.view().mobageButton.setImage(a.Assets.image("mobagelogotm.png"));this.view().mobageButton.setImage(a.Assets.image("mobagelogotm_down.png"),f.State.Pressed);this.view().mobageButton.onclick=this.bind(function(){NgLogD("Mobage Jump to Home button has been clicked");var n=this;this.showLoadingHelper(function(){n.logd("Home button tapped.");n.popToHome()})})}}}},onGlobalDownloadStatus:function(o){var m=a.Session.getCurrentSession()?a.Session.getCurrentSession().user():null;if(m&&this._isInServiceUI&&this._showing&&o.downloading===false&&o.error===null){var n=o.game;var p=new f.AlertDialog();p.setTitle(k("Ready to Play"));p.setText(k("Play %1s now!",n.name));p.setChoices([k("Play"),k("Not Now")]);p.onchoice=function(q){if(q.choice===0){a.MobageAnalytics.reportEvent("JSGamePlayDLCompleteDlg",{game:n.recordID});n.checkUpdateAndStartGame()}p.hide()};p.show()}},setIsInServiceUI:function(m){this._isInServiceUI=m},showService:function(){if(this.navController.getTopViewController() instanceof e.GamePlaceholder){var n=false;for(var m=0;m<this.navController.length;m++){if(e.isLoaded("Home")&&this.navController.viewControllerAtIndex(m) instanceof e.Home){n=true;break}}if(n){this.navController.back()}else{e.pushScreen(this.navController,"Home",{})}}},hideService:function(){if(!(this.navController.getTopViewController() instanceof e.GamePlaceholder)){this.showLoadingHelper(function(){this.navController.popToViewController(this.navController.getBottomViewController())}.bind(this))}},menuKeyPressed:function(){if(this.view()){return this.view().menuKeyPressed()}return false},closeMenuDrawer:function(n,m){if(this.view()){this.view().closeMenuDrawer(n,m)}},isMenuDrawerClosedOrClosing:function(){if(this.view()){return this.view().isMenuDrawerClosedOrClosing()}return true},popToHome:function(){e.pushScreen(this.navController,"Home",{})},credentialCheckCB:function(m,n){return function(){var o=a.Session.getCurrentSession()?a.Session.getCurrentSession().user():null;if(o){m()}else{if(!a.CustomModalDialog.currentDialog){var p=new a.CustomModalDialog()}if(n){n()}}}},credentialCheck:function(){return a.Session.getCurrentSession()&&a.Session.getCurrentSession().user()}})}};__ngs._2w={_c:null,_d:function(){var f={exports:{}};var c=f.exports;this._c=f;var e=__ngs.r_(__ngs._w).MessageListener;var d=__ngs.r_(__ngs._4).Device;var b=new (__ngs.r_(__ngs._f).RequireLoader)({Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities},AlertDialog:function(){return __ngs.r_(__ngs._i).AlertDialog},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics}});var a=__ngs.r_(__ngs._n).LocalizedString;c.QuitOnBackListener=e.singleton({_confirmDialog:null,initialize:function($super){$super();b.UnspammableButton.addDeviceKeyListener(this,function(g){return this.confirmExit(g)}.bind(this),1)},_instantiateView:function(){if(!this._confirmDialog){var g=this;this._confirmDialog=new b.AlertDialog();this._confirmDialog.setTitle(a("Goodbye"));this._confirmDialog.setText(a("Would you like to quit?"));var j=1;var h=[a("No"),a("Yes")];if(b.Capabilities.isPlatformAndroid()){h=[a("Yes"),a("No")];j=0}this._confirmDialog.setChoices(h);this._confirmDialog.onchoice=function(k){if(k.choice===j){b.MobageAnalytics.reportEvent("UserInitiatedMobageQuit");d.LifecycleEmitter.exitProcess()}else{g._confirmDialog.hide()}}}},confirmExit:function(g){if((g.code===d.KeyEmitter.Keycode.backunhandled)||(g.code===d.KeyEmitter.Keycode.back&&b.ServiceHost.isShowing())){this._instantiateView();this._confirmDialog.show();return true}return false}})}};__ngs._2x={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var h=__ngs.r_(__ngs._5m).ModalDialog;var f=__ngs.r_(__ngs._59).UI;var c=__ngs.r_(__ngs._4).Device;var g=__ngs.r_(__ngs._5).Core;var a=new (__ngs.r_(__ngs._f).RequireLoader)({MessageListener:function(){return __ngs.r_(__ngs._w).MessageListener},NuxView:function(){return __ngs.r_(__ngs._5n).NuxView},Session:function(){return __ngs.r_(__ngs._o).Session},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics},Main:function(){return __ngs.r_(__ngs._m).Main},UnspammableButton:function(){return __ngs.r_(__ngs._5l).UnspammableButton}});var e=b.NuxController=h.subclass({classname:"NuxController",_totalStates:4,initialize:function(){NgLogD("NUX CONTROLLER INIT");NgLogD("NUX ADD LAYOUT LISTENER");this.addLayoutListener();NgLogD("NUX ADD KEY LISTENER");this.addKeyListener()},$setupNux:function(){NgLogD("SETUP NUX");if(e.wasSetup){NgLogD("NuxController was Setup");return}this.user=a.Session.getCurrentSession().user();if(!this.user){NgLogD("NuxController !User Error");return}if(this.user.isNuxComplete){NgLogD("NuxController NUX COMPLETE TRUE");return}var n=function(q,p){var r=q[p];return r===null||typeof r==="undefined"||r===""};e.firstName=this.user.firstName;e.lastName=this.user.lastName;e.motto=this.user.motto;e.photoId=this.user.photoId;e.friendCount=0;e.sessionKill=false;NgLogD("************SESSION DATA: "+this.user.sessionCount+" | "+this.user.isNuxComplete);e.isProfile=false;e.isFriends=false;e.isGames=false;e.progress=false;var l=0;var k=this;if(this.user.sessionCount>0&&!this.user.isNuxComplete){var m=new e();var o=function(p){if(k.user.new_user_experience_complete||(p.buddies==1&&e.friendCount==1)||e.sessionKill){NgLogD("//NUX KILL, new user exp complete var is true, or you have already fulfilled the buddy require_ment on this session");return}m.show(k.user)};var j=function(p){e.progress=false;NgLogD("//PROFILE BOOLS: firstname: "+!n(e,"firstName")+", lastname: "+!n(e,"lastName")+", motto: "+!n(e,"motto")+", photo_url:"+!n(e,"photoId"));NgLogD("//PROFILE BOOLS: firstname: "+!n(p,"firstName")+", lastname: "+!n(p,"lastName")+", motto: "+!n(p,"motto")+", photo_url:"+!n(p,"photoId"));if(p.buddies!==1&&e.wasSetup){NgLogD("//NUX not a buddy call check if user has updates against session data");if((!n(p,"firstName"))==(!n(e,"firstName"))&&(!n(p,"lastName"))==(!n(e,"lastName"))&&(!n(p,"motto"))==(!n(e,"motto"))&&(!n(p,"photoId"))==(!n(e,"photoId"))){NgLogD("//NUX KILL, not a friend list update and no user changes");return}else{e.progress=true}}if(!n(p,"firstName")||!n(p,"lastName")||!n(p,"motto")||!n(p,"photoId")){e.isProfile=true}k.user.getFollowersList().forAll(function(r,q){if(q){NgLogD("//NUX FOUND FRIEND REQUEST");e.isFriends=true;r(false)}else{NgLogD("//HIT");r(true)}},function(q){k.user.getOwnedGamesList().forAll(function(s,t,r){l++;s(true)},function(r){if(l<2){NgLogD("//GAMES: "+l)}else{e.isGames=true;NgLogD("//GAMES TRUE: "+l)}NgLogD("LAUNCH NUX?");o(p)});if(e.isFriends){if(e.isFriends===0){e.progress=true}e.friendCount=1}})};this.dataListener=new a.MessageListener();this.user.addListener(this.dataListener,function(p){if(!p||!(p.buddies||p.firstName||p.lastName||p.motto)){return}NgLogD("NuxListener: user or buddy data changed. Recheck if we need to show!");j(p)});j(this.user)}e.wasSetup=true},removeEventListeners:function(){if(this.layoutListenerInstance){NgLogD("//NUX REMOVE LAYOUT LISTENER");c.LayoutEmitter.removeListener(this.layoutListenerInstance);this.layoutListenerInstance=undefined}if(this.dataListener&&this.user){NgLogD("//NUX REMOVE DATA LISTENER");this.user.removeListener(this.dataListener);this.dataListener=undefined}this.removeKeyListeners()},removeKeyListeners:function(){if(this.keyListenerInstance){NgLogD("//NUX REMOVE KEY LISTENER");c.KeyEmitter.removeListener(this.keyListenerInstance);this.keyListenerInstance.destroy()}},addKeyListener:function(){var j=this;j.removeKeyListeners();NgLogD("adding the device keyEmitter event..");var k=g.MessageListener.subclass({classname:"NuxKeyListener"});j.keyListenerInstance=new k();a.UnspammableButton.addDeviceKeyListener(j.keyListenerInstance,j.onKeyPressed.bind(j),99999)},onKeyPressed:function(j){if(j.code===c.KeyEmitter.Keycode.back){var k=e.getCompletedStates();if(k>=this._totalStates){NgLogD("Mobage/Analytics: Sending NUXCLICKBACKCOMPLETE event of clicking back button in Nux view");a.MobageAnalytics.reportEvent("NUXCLICKBACKCOMPLETE");this._setNuxComplete()}else{NgLogD("Mobage/Analytics: Sending NUXCLICKBACKHIDE event of clicking back button in Nux view");a.MobageAnalytics.reportEvent("NUXCLICKBACKHIDE");this.hide()}return true}return false},$getCompletedStates:function(){var j=1;if(e.isProfile){j++}if(e.isFriends){j++}if(e.isGames){j++}return j},addLayoutListener:function(){var k=this;var j=g.MessageListener.subclass({_onLayoutEvent:function(l){NgLogD("emitting layout with "+l.width+", and height: "+l.height);k.layoutViews(l.width,l.height)}});this.layoutListenerInstance=new j();c.LayoutEmitter.addListener(this.layoutListenerInstance,this.layoutListenerInstance._onLayoutEvent)},layoutViews:function(k,j){this.NuxModal.layoutViews(k,j);this.view().setFrame(0,0,k,j)},loadView:function($super){this.setView(this.NuxModal=new a.NuxView(a.Session.getCurrentSession(),this._totalStates));$super()},show:function($super,j){a.MobageAnalytics.reportEvent("NUXSHOW",{NUXGOAL_PROFILE:e.isProfile,NUXGOAL_FRIENDS:e.isFriends,NUXGOAL_GAMES:e.isGames});this.view().setFrame(f.Window.getFrame());f.Window._getLayer(1).addChild(this.view());this.NuxModal.setStates(e.isProfile,e.isFriends,e.isGames,false,j.firstName);$super()},hide:function($super){$super();this.removeKeyListeners();this.view().removeFromParent()},_setNuxComplete:function(){a.Session.getCurrentSession().user().setNuxComplete(1,(function(j,k){NgLogD("SET NUX COMPLETE");e.sessionKill=true;this.removeEventListeners();this.destroy();if(j){NgLogD("NUX Complete Save State Failed")}}).bind(this))}})}};__ngs._2y={_c:null,_d:function(){var c={exports:{}};var u=c.exports;this._c=c;var o=__ngs.r_(__ngs._4l).BankController;var l=__ngs.r_(__ngs._5o).Balance;var a=__ngs.r_(__ngs._5).Core;var q=__ngs.r_(__ngs._4);var g=__ngs.r_(__ngs._28).PlusRequest;var b=__ngs.r_(__ngs._n).LocalizedString;var k=__ngs.r_(__ngs._5p).Transaction;var d=__ngs.r_(__ngs._2v).ServiceHost;var m=__ngs.r_(__ngs._o).Session;var t=__ngs.r_(__ngs._a).Storage;var h=__ngs.r_(__ngs._59).UI;var n=__ngs.r_(__ngs._5q).DataType;var j=__ngs.r_(__ngs._5r).PreparedAction;var s=__ngs.r_(__ngs._5k).CustomModalDialog;var e=__ngs.r_(__ngs._4).Device;var r=__ngs.r_(__ngs._5m).NoMobacoinModal;var p=new (__ngs.r_(__ngs._f).RequireLoader)({PlusRequest:function(){return __ngs.r_(__ngs._28).PlusRequest},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities}});u.Purchase=a.Class.singleton({classname:"Purchase",_cache:null,$_ASYNC_TXNS_KEY:"com.mobage.ww.purchase.asycntxns",$_CREATE_TXN_LOCK:null,initialize:function(){},cache:function(){if(this._cache===null){this._cache={}}return this._cache},createTxn:function(v,y,B){NgLogD("Mobage/Purchase: createTxn");if(u.Purchase._CREATE_TXN_LOCK){NgLogD("Mobage/Purchase - CREATE_TXN_LOCK is taken");return}else{u.Purchase._CREATE_TXN_LOCK=v;setTimeout(function(){u.Purchase._CREATE_TXN_LOCK=null},1000)}var A=new Array();var D;for(var x=0;x<v.length;x++){var z=new n.Bank.BillingItem(v[x]);if(!z.isValid()){NgLogD("Mobage/Debit: cb for createTxn invaliditem");B({errorCode:400,description:z.getErr()},null);return}D={id:z.getItemId(),quantity:z.getQuantity()};A.push(D)}var w=y;var C=this;NgLogD("Mobage/Debit: getDebitItems - invoked");C.getDebitItems(A,function(M,F){if(M){NgLogD("Mobage/Debit: server error = "+JSON.stringify(M));B(M);return}var L=0;var G="";var H="";var J=false;var O="";for(var I=0,N;N=A[I];I++){var K=F[N.id];if(!K){var E=(new h.AlertDialog()).retain();E.setTitle(b("Error"));E.setText(b("Sorry, this item is currently not available."));E.setChoices([b("OK")]);E.onchoice=function(P){NgLogD("Mobage/Debit: cb for createTxn unavailableitem = "+N.id);B({errorCode:404,description:"Unavailable Item"});E.release();E=null};E.show();return}O=K.name;NgLogD("Mobage/Purchase itemName = "+O);L=L+K.price*N.quantity;if(N.quantity===1){if(G){G=G+" "+K.name}else{G=K.name}}else{G=G+" "+N.quantity+" "+K.name}H=N.id;J=K.iap_enabled}if(J&&k._isIOS()){NgLogD("Mobage/Purchase - LaunchPurchaseView for sku "+H);C._launchIAPPurchaseView(H,B)}else{NgLogD("Mobage/Debit: Balance - invoked");l.get(function(T,V,U,R){NgLogD("Mobage/Debit: Balance - cb "+T);if(T||(!V)){var Q=(new h.AlertDialog()).retain();Q.setTitle(b("No Network Connection"));Q.setText(b("Please check your network connection settings."));Q.setChoices([b("OK")]);Q.onchoice=function(W){NgLogD("Mobage/Debit: cb for createTxn unavailablebalance:"+T);B({errorCode:400,description:("Unavailable Balance"+T)});Q.release();Q=null};Q.show();return}if(U>=L){NgLogD("DebitAPI: sufficient balance: "+U+" requested: "+L);NgLogD("Mobage/Debit: Transaction.create - invoked");k.create(v,w,function(Y,X){if(Y||(!X)){NgLogD("Mobage/Debit: Transaction.create - cb with err = "+JSON.stringify(Y));B(Y);return}var Z=b("%1s for %2d %3s",G,L,R);var W=function(ab,aa){B(ab,aa)};C._showConfirmDialog(Z,X,W,U,R)})}else{NgLogD("DebitAPI: insufficient balance: "+U+" requested: "+L);B({errorCode:-1,description:"usercanceled"});var S=new f();S.prepare();p.MobageAnalytics.reportEvent("BankNeedMobaDlgShow");if(a.Capabilities.getPlatformOS().toLowerCase()=="iphone os"){var P=(new h.AlertDialog()).retain();if(R){P.setTitle(b("Require amount: %1d %2s",L,R));P.setText(b("Your balance of %1d %2s is insufficient. Get more!",U,R))}else{P.setTitle(b("Require amount: %1d",L));P.setText(b("Your balance of %1d is insufficient. Get more!",U))}P.setChoices([b("OK")]);P.onchoice=function(W){S.execute();P.release();P=null};P.show()}else{this._noMobacoinObj=new r(function(W){S.execute();p.MobageAnalytics.reportEvent("BankNeedMobaSentToBank");W.destroy()})}}})}})},openTxn:function(x,w){var v=this;k.open(x,function(z,A,y){if(z){w(z,A);return}v.updateAndGetTxn(A,y,w)})},continueTxn:function(y,x){var w=this;var v=x;this.updateAndGetTxn(y,"SAME_STATE",function(B,D){if(B){v(B,D)}else{var z=D.item;var A=Math.abs(z.value);var C=b("%1s for %2d",z.display_name,A);l.get(function(I,K,J,G){NgLogD("Mobage/Debit: Balance - cb "+I);if(I||(!K)){var F=(new h.AlertDialog()).retain();F.setTitle(b("No Network Connection"));F.setText(b("Please check your network connection settings."));F.setChoices([b("OK")]);F.onchoice=function(L){NgLogD("Mobage/Debit: cb for createTxn unavailablebalance:"+I);v({errorCode:-1,description:"usercanceled"});F.release();F=null};F.show();return}if(J<A){NgLogD("DebitAPI: insufficient balance: "+J+" requested: "+Math.abs(z.value));var H=new f();H.prepare();p.MobageAnalytics.reportEvent("BankNeedMobaDlgShow");var E=(new h.AlertDialog()).retain();if(G){E.setTitle(b("Require amount of %3s: %1d %2s",A,G,z.display_name));E.setText(b("Your balance of %1d %2s is insufficient. Get more!",J,G))}else{E.setTitle(b("Require amount of %2s: %1d",A,z.display_name));E.setText(b("Your balance of %1d is insufficient. Get more!",J))}E.setChoices([b("OK")]);E.onchoice=function(L){v({errorCode:-1,description:"usercanceled"});H.execute();E.release();E=null};E.show()}else{w._showConfirmDialog(C,y,v,J,G)}})}})},closeTxn:function(x,w){var v=this;k.close(x,function(z,A,y){if(z){NgLogD("Mobage/Purchase: closeTxn received error "+JSON.stringify(z));w(z,A);return}v.updateAndGetTxn(A,y,w)})},_getOSParam:function(){if(k._isIOS()){return"?os=ios"}else{return"?os=Android"}},getOpenTxns:function(x){var v=this;var w=g.newBankRequest();w.setApiMethod("bank/debit"+v._getOSParam());w.setHttpMethod("GET");w.setHttpHeaders({"Content-Type":"application/json; charset=utf-8"});w.sendRetry(function(B,C,D,z){var y=undefined;var A=undefined;if(C&&C.success){y=C.transactions}if(x&&typeof x=="function"){x(v.getError(B,C,z),y)}})},getError:function(x,y,v){var w=undefined;if(y.success){return w}if(y&&!y.success){w={errorCode:y.error,description:y.error_msg}}else{w={errorCode:999,description:"failed:status="+v+"&err="+x}}return w},getTxn:function(w,v){return this.updateAndGetTxn(w,"SAME_STATE",v)},updateAndGetTxn:function(B,x,A){NgLogD("Mobage/Purchase: updateAndGetTxn entry with txn "+B+" and state "+x);if(x===undefined){NgLogD("Mobage/Purchase: cb for updateAndGetTxn (undef)");A(undefined,undefined);return}var v=this;var z=v.cache();var y=z[B];if(y===undefined){var w=g.newBankRequest();w.setApiMethod("bank/debit/"+B+v._getOSParam());w.setHttpMethod("GET");w.setHttpHeaders({"Content-Type":"application/json; charset=utf-8"});NgLogD("Mobage/Purchase: http request to update cache");w.sendRetry(function(D,E,F,C){NgLogD("Mobage/Purchase: update cache callback "+D);if(E&&E.success){NgLogD("Mobage/Purchase: update cache data: "+JSON.stringify(E));NgLogD("data = "+JSON.stringify(E));y=E.transaction;z[B]=y}if(A&&typeof A=="function"){NgLogD("Mobage/Purchase: cb for updateAndGetTxn (debitget)");A(v.getError(D,E,C),y)}})}else{if(x==="SAME_STATE"){NgLogD("Mobage/Purchase: cb for updateAndGetTxn (samestate)");A(undefined,y)}else{NgLogD("DebitAPI: Getting transaction object from cache");z[B].state=x;if(x.toLowerCase()==="canceled"||x.toLowerCase()==="closed"){delete z[B]}if(A&&typeof A=="function"){NgLogD("Mobage/Purchase: cb for updateAndGetTxn (cache)");A(undefined,y)}}}},cancelTxn:function(x,w){var v=this;k.cancel(x,function(z,A,y){if(z){w(z,A);return}v.updateAndGetTxn(A,y,w)})},getDebitItems:function(y,v){var x=this;var w={};var z=y.length;var B=0;for(var A=0;A<y.length;A++){var C=y[A].id;this.getItem(C,function(E,D){if(D){w[D.id]={price:D.price,name:D.name,iap_enabled:D.iap_enabled};B=B+1;if(B===z){v(E,w)}}else{v({errorCode:400,description:"ItemNotFound:"+C},w);return}})}},getIAPItems:function(w,v){NgLogD("Mobage/getIAPItems");var x=undefined;if(a.Capabilities.getPlatformOS().toLowerCase()!=="iphone os"){x={errorCode:"400",description:"method only supported in iOS"};v(x,undefined)}if(w){var z={items:w};var y=JSON.stringify(z);NgLogD("Mobage/Purchase : getProductSetInfo = "+y);p.MobageAnalytics.reportEvent("BankGetIAPInfo");q.Device.InAppPurchase.getProductSetInfo(y,function(A){NgLogD("Mobage/Purchase : iapDataStr = "+A);var D=undefined;var B=undefined;if(A){try{D=JSON.parse(A)}catch(C){D=undefined}}if(!D){B={errorCode:"400",description:"IAP retrive failed"}}v(B,D)})}},getItem:function(y,v){var w=this;var x=g.newBankRequest();NgLogD("Mobage/Purchase OS param = "+w._getOSParam());x.setApiMethod("bank/items/"+y+w._getOSParam());x.setHttpMethod("GET");x.setHttpHeaders({"Content-Type":"application/json; charset=utf-8"});x.sendRetry(function(B,C,D,z){NgLogD("data = "+JSON.stringify(C));var A=undefined;if(C&&(C.item)){A={id:C.item.sku,price:C.item.value,description:C.item.description,imageUrl:C.item.image_url,name:C.item.display_name,iap_enabled:C.item.iap_enabled}}if(A&&A.iap_enabled){q.Device.InAppPurchase.getProductInformation(y,function(F){var E=F;if(q.Device.InAppPurchase._productInformationExtras){E=q.Device.InAppPurchase._productInformationExtras.formatted}NgLogD("Mobage/Purchase: product information = "+F);A.price=E;if(v&&((typeof v)==="function")){v(w.getError(B,C,z),A)}})}else{if(v&&((typeof v)==="function")){v(w.getError(B,C,z),A)}}})},_showUnavailbeBankDialog:function(w){if(w){NgLogD("Mobage/Purchase err = "+JSON.stringify(w))}var v=(new h.AlertDialog()).retain();v.setTitle(b("Error"));v.setText(b("Sorry, the Bank is not available. Please try again later."));v.setChoices([b("OK")]);v.onchoice=function(x){v.release();v=null};v.show()},filterItems:function(y,D){var A=new Array();if(y&&D){for(var B=0,z;z=D[B];B++){for(var w=0,v;v=y[w];w++){if(v.sku===z.id){var x="ios_"+v.price;var C="bank_"+z.origin_price;p.MobageAnalytics.reportEvent("iOSIAPPrice1And2",{iapPrice:x,bankPrice:C});A.push(z);z.origin_price=v.formatted;break}}}}return A},invokeIAP:function(y,v,w,x){this._invokeIAPAux(y,v,w,x);return},$_handleFailedCredit:function(z,w,x,v){var y=t.KeyValueCache.local;if(!y){t.KeyValueCache.init();y=t.KeyValueCache.local}y.getItem(u.Purchase._ASYNC_TXNS_KEY,function(D,C){var B=[];if(p.Capabilities.isPlatformIOS()){try{if(C){B=JSON.parse(C)}}catch(E){NgLogE("Purchase.$_retryOneFailedCredit failed to parse JSON data.")}}var F={productIdentifier:z,orderId:w,receipt:x};B.push(F);var A=JSON.stringify(B);y.setItem(u.Purchase._ASYNC_TXNS_KEY,A,{},function(){NgLogD("Mobage/Purchase: after saving failed order for "+z+", list size is "+B.length);v()})})},$_popTheLastReceipt:function(){var v=t.KeyValueCache.local;if(!v){t.KeyValueCache.init();v=t.KeyValueCache.local}v.getItem(u.Purchase._ASYNC_TXNS_KEY,{},function(z,y){var x=[];if(p.Capabilities.isPlatformIOS()){try{if(y){x=JSON.parse(y)}}catch(A){NgLogE("Purchase.$_retryOneFailedCredit failed to parse JSON data.")}}if(x.length>0){x.pop();NgLogD("Mobage/Purchase: pop up last receipt from queue");var w=JSON.stringify(x);v.setItem(u.Purchase._ASYNC_TXNS_KEY,w,{},function(){NgLogD("Mobage/Purchase: saved uncredit receipt, list size is "+x.length)})}})},_invokeIAPAux:function(B,v,y,z){var x=this;var A=e.NetworkEmitter.getLastStatus();if(A===e.NetworkEmitter.Status.None){var w=(new h.AlertDialog()).retain();w.setTitle(b("No Network Connection"));w.setText(b("Please check your network connection settings."));w.setChoices([b("OK")]);w.onchoice=function(C){w.release();w=null;if(typeof v=="function"){v("cancelled")}};w.show();return}this._launchPurchaseView(B,v,y,z)},_launchIAPPurchaseView:function(x,v){NgLogD("IAP about to launch with: "+x);p.MobageAnalytics.reportEvent("MobaiOSIAPPreDialog",{prodid:x});var w=this;q.Device.InAppPurchase.launchPurchaseView(x,1,function(z,A,y){NgLogD("IAP received order "+A+" for "+x);p.MobageAnalytics.reportEvent("MobaiOSIAPReceivedTxn",{prodid:x,orderid:A});k.credit("",x,1,y,function(B,C){p.MobageAnalytics.reportEvent("MobaiOSIAPForwardedTxn",{orderid:A});if(B){NgLogD("Mobage/Purchase credit error :"+JSON.stringify(B));p.MobageAnalytics.reportEvent("MobaiOSIAPCreditFailed",{orderid:A})}else{k.authorize(C.id,function(E,F,D){NgLogD("Mobage/Debit: Transaction.authorize - cb "+JSON.stringify(E));if(E||(!F)){NgLogD("Mobage/Debit: cb for createTxn not authorized: "+JSON.stringify(E));v(E,F);return}else{w.updateAndGetTxn(F,D,v)}})}})},function(z,y){NgLogD("_invokeIAPAux failed for "+x);p.MobageAnalytics.reportEvent("MobaiOSIAPFailed",{prodid:x});v({errorCode:102,description:"iapfailed"})},function(){NgLogD("_invokeIAPAux cancelled for "+x);p.MobageAnalytics.reportEvent("MobaiOSIAPCancelled",{prodid:x});v({errorCode:101,description:"usercanceled"})})},_launchPurchaseView:function(y,v,w,x){NgLogD("_invokeIAPAux about to launch with: "+y);p.MobageAnalytics.reportEvent("MobaIAPConfirmShown",{prodid:y});l.get(function(B,C,A,z){NgLogD("_credit previous balance = "+A);q.Device.InAppPurchase.launchPurchaseView(y,1,function(E,F,D){NgLogD("_invokeIAPAux received order "+F+" for "+y);p.MobageAnalytics.reportEvent("MobaReceivedTxn",{prodid:y,orderid:F});if(D){u.Purchase._handleFailedCredit(y,F,D,function(){});k.credit("",y,1,D,function(H,I,G){l.get(function(L,P,O,J){NgLogD("_credit current balance = "+O);p.MobageAnalytics.reportEvent("MobaForwardedTxn",{orderid:F});if(G>=200&&G<300){p.MobageAnalytics.reportEvent("MobaForwardedTxnOK",{orderid:F,success:I.success})}if(O<=A){NgLogD("_invokeIAPAux forwarded order err: "+H.description);NgLogD("Mobage/Purchase credit error :"+JSON.stringify(H));p.MobageAnalytics.reportEvent("MobaCreditFailed",{orderid:F,error:H.description});var N=(new h.AlertDialog()).retain();N.setTitle(b("Error"));N.setText(b("Order was charged but there was an error fulfilling it. The system will retry your order next time you restart the game."));N.setChoices([b("OK")]);N.onchoice=function(Q){N.release();N=null;v("recreditLater")};N.show()}else{u.Purchase._popTheLastReceipt();v(undefined,I);if(!k._isIOS()){var K=JSON.parse(D);var M=JSON.parse(K.data);u.Purchase._sendAckToGoogle(M.orders)}}})},w,x)}else{NgLogD("xxx empty receipt xxx");p.MobageAnalytics.reportEvent("MobaNilReceipt",{orderid:F})}},function(E,D){NgLogD("_invokeIAPAux failed for "+y);p.MobageAnalytics.reportEvent("MobaIAPFailed",y);v("failed:"+D+",noMoreRetry:"+E)},function(){NgLogD("_invokeIAPAux cancelled for "+y);p.MobageAnalytics.reportEvent("MobaIAPCancelled",y);v("cancelled")})})},_showConfirmDialog:function(A,x,B,z,v){var y=(new h.AlertDialog()).retain();var w=this;y.setTitle(b("Are you sure you want to purchase this item?"));if(z&&v){y.setText(A+"\nBalance : "+z+" "+v)}else{y.setText(A)}y.setChoices([b("Yes"),b("No")]);y.onchoice=function(C){NgLogD("createTransaction: User chose "+JSON.stringify(C));if(C.choice!==0){k.cancel(x,function(E,F,D){if(E||(!F)){B(E,F);return}w.updateAndGetTxn(F,D,function(H,G){NgLogD("Mobage/Debit: cb for createTxn userrefused:"+H);B({errorCode:-1,description:"usercanceled"})})});return}y.release();y=null;NgLogD("Mobage/Debit: Transaction.authorize - invoked");k.authorize(x,function(E,F,D){NgLogD("Mobage/Debit: Transaction.authorize - cb with state: "+D);if(E||(!F)){NgLogD("Mobage/Debit: cb for createTxn not authorized: "+JSON.stringify(E));B(E,F);return}w.updateAndGetTxn(F,D,B)})};y.show()},_showLocalNotification:function(v){if(p.Capabilities.meetsBinaryVersion&&p.Capabilities.meetsBinaryVersion("1.7")){q.Device.NotificationEmitter.scheduleLocal({message:v,extras:{openurl:"mobage-ww-mobageBoot://mobageBoot/1/ServiceUI/Catalog"}},0,function(w,x){if(w){NgLogE("Couldn't schedule the notification. Error: "+w.description)}else{NgLogD("Notification scheduled with systemId: "+x.id)}})}else{q.Device.LocalNotification.showLocalNotification({openurl:"mobage-ww-mobageBoot://mobageBoot/1/ServiceUI/Catalog",aps:{alert:v}})}},$_bankIsAvailable:function(){if(!k._isIOS()){return true}var v=m.getCurrentSession().appKey();return(v!="mobageBoot")&&(v!="mobage-Dev")},$_sendAckToGoogle:function(x,w){if(!x||x.length<=0){if(w){w()}return}var v=x.pop();u.Purchase._sendAckToGoogle(x,function(){if(v.notificationId){q.Device.InAppPurchase._sendOrderProcessedAck(v.notificationId,v.orderId);if(w){w()}}})},$retryFailedCredits:function(){q.Device.InAppPurchase.initService(function(x,v,w){NgLogD("Saving async order "+v+" for "+x);if(w){p.MobageAnalytics.reportEvent("MobaReceivedTxn2",{prodid:x,orderid:v});u.Purchase._handleFailedCredit(x,v,w,function(){u.Purchase.retryFailedCreditsAux()})}else{p.MobageAnalytics.reportEvent("MobaNilReceipt2",{orderid:v})}},function(){NgLogD("Finished initService");u.Purchase.retryFailedCreditsAux()})},$retryFailedCreditsAux:function(){if(u.Purchase._retryFailedCreditsInProgress){NgLogD("Mobage/Purchase: NOT retrying previous orders - another in progress");return}NgLogD("Mobage/Purchase: START retrying previous orders");u.Purchase._retryFailedCreditsInProgress=true;var v=t.KeyValueCache.local;if(!v){t.KeyValueCache.init();v=t.KeyValueCache.local}if(p.Capabilities.isPlatformIOS()){u.Purchase._retryOneFailedCredits(v)}else{u.Purchase._retryIABFailedCredits(v)}},$_retryFailedCreditsInProgress:false,$_dumpOrderIds:function(y,B){var v=B.orderId;var A=B.receipt;if(p.Capabilities.isPlatformIOS()){p.MobageAnalytics.reportEvent(y,{orderId:v})}else{var D=JSON.parse(A);var C=JSON.parse(D.data);var w=C.orders;for(var x=0;x<w.length;x++){var z=w[x];p.MobageAnalytics.reportEvent(y,{orderId:z.orderId})}}},$_wipeOutStorage:function(w){var v=[];w.setItem(u.Purchase._ASYNC_TXNS_KEY,JSON.stringify(v),function(){NgLogD("Mobage/Purchase: wipe out storage for "+u.Purchase._ASYNC_TXNS_KEY)})},$_retryOneFailedCredits:function(v){v.getItem(u.Purchase._ASYNC_TXNS_KEY,function(z,x){if(!x||(x.length<=0)){NgLogD("Mobage/Purchase: STOP retrying previous orders - no order found");u.Purchase._retryFailedCreditsInProgress=false;return}var w=[];try{w=JSON.parse(x)}catch(A){NgLogE("Purchase.$_retryOneFailedCredit failed to parse JSON data.")}if(isNaN(w.length)||w.length<=0){NgLogD("Mobage/Purchase: STOP retrying previous orders - empty list");u.Purchase._retryFailedCreditsInProgress=false;return}NgLogD("Mobage/Purchase: will retry "+w.length+" previous order(s).");var y=w.pop();p.MobageAnalytics.reportEvent("MobaIOSRetryTxn2",{prodid:y.productIdentifier});if(!y.receipt){p.MobageAnalytics.reportEvent("MobaIOSRetryNilReceipt",{prodid:y.productIdentifier})}else{k.credit("",y.productIdentifier,1,y.receipt,function(D,F,C){u.Purchase._dumpOrderIds("MobaIOSForwardedTxn2",y);if(C>=200&&C<300){u.Purchase._dumpOrderIds("MobaIOSIAP2OK",y);if(F&&F.success){u.Purchase._dumpOrderIds("MobaIOSIAP2SUCCESS",y);var E=b("Your previous order is now successfully credited.");NgLogD("Mobage/Purchase: _credit  show local notification");u.Purchase._showLocalNotification(E)}if((D&&D.description==="bank.errors.invalid_payment")||(F&&F.success)){var B=JSON.stringify(w);v.setItem(u.Purchase._ASYNC_TXNS_KEY,B,function(){NgLogD("Mobage/Purchase: retry successful for product "+y.productIdentifier+", will retry another "+w.length+" previous order(s).");u.Purchase._retryOneFailedCredits(v)})}else{u.Purchase._dumpOrderIds("MobaIOSIAP2Failed",y);u.Purchase._retryFailedCreditsInProgress=false;return}}else{u.Purchase._dumpOrderIds("MobaIOSIAP2Failed",y);u.Purchase._retryFailedCreditsInProgress=false;return}})}})},$_retryIABFailedCredits:function(v){u.Purchase._retryFailedCreditsInProgress=false;v.getItem(u.Purchase._ASYNC_TXNS_KEY,function(z,x){var w=[];try{if(x){w=JSON.parse(x)}}catch(A){NgLogE("Purchase.$_retryOneFailedCredit failed to parse JSON data.");u.Purchase._wipeOutStorage(v);return}if(isNaN(w.length)||w.length<=0){NgLogD("Mobage/Purchase: STOP retrying previous orders - empty list");u.Purchase._wipeOutStorage(v);return}NgLogD("Mobage/Purchase: _credit will retry "+w.length+" previous order(s).");var y=w.pop();NgLogD("txn receipt = "+y.receipt);if(!y.receipt){u.Purchase._wipeOutStorage(v);p.MobageAnalytics.reportEvent("MobaNilReceipt3")}else{u.Purchase._dumpOrderIds("MobaRetryTxn2",y);k.credit("",y.productIdentifier,1,y.receipt,function(E,G,B){u.Purchase._dumpOrderIds("MobaForwardedTxn2",y);if(B>=200&&B<300){u.Purchase._dumpOrderIds("MobaIAP2OK",y);if(G&&G.success){u.Purchase._dumpOrderIds("MobaIAP2SUCCESS",y);var F=b("Your previous order is now successfully credited.");NgLogD("Mobage/Purchase: _credit  show local notification");u.Purchase._showLocalNotification(F)}if((E&&E.description==="bank.errors.invalid_payment")||(G&&G.success)){var C=JSON.parse(y.receipt);var D=JSON.parse(C.data);u.Purchase._sendAckToGoogle(D.orders);u.Purchase._wipeOutStorage(v)}}else{u.Purchase._dumpOrderIds("MobaIAP2Failed",y)}})}})}});var f=u.ShowBankAction=j.subclass({classname:"ShowBankAction",$PreparedState:{NotPrepared:0,NotCredentialed:1,ComingSoon:2,Unsupported:3,Unavailable:4,Successful:5},_preparedState:0,_bankController:null,initialize:function($super){$super()},onPrepare:function(){NgLogD("Mobage/Purchase ShowBankAction onPrepare start");this._preparedState=f.PreparedState.NotPrepared;if(!d.credentialCheck()){this._preparedState=f.PreparedState.NotCredentialed;this.prepared()}else{if(!u.Purchase._bankIsAvailable()){this._preparedState=f.PreparedState.Unsupported;this.prepared()}else{var v=this;k.getItems(true,function(C,w){if(C||(!w)||(w.length<=0)){if(C){NgLogD("Mobage/Purchase err = "+C)}v._preparedState=f.PreparedState.Unavailable;v.prepared()}else{if(p.Capabilities.isPlatformIOS()){var x=new Array();for(var A=0,B;B=w[A];A++){x.push(B.id)}var z={items:x};var y=JSON.stringify(z);NgLogD("Mobage/Purchase : getProductSetInfo = "+y);q.Device.InAppPurchase.getProductSetInfo(y,function(E){NgLogD("Mobage/Purchase : iapDataStr = "+E);if(E){p.MobageAnalytics.reportEvent("iOSIAPDATATRUE");var G=JSON.parse(E);if(G.length<=0){p.MobageAnalytics.reportEvent("iOSIAPDATAINVALID1");v._preparedState=f.PreparedState.Unavailable;v.prepared()}else{var H=G.items.length;var D=u.Purchase.filterItems(G.items,w);var F=G.items.length;p.MobageAnalytics.reportEvent("iOSIAPDATA",{currency:G.currency,itemCount:H,shownItemsCount:F});v._bankController=new o(D,function(L,I,J,K){NgLogD("User tapped Buy for credit item "+L);u.Purchase.invokeIAP(L,I,J,K)},function(){NgLogD("Exited Bank Controller")},G.currency);v._preparedState=f.PreparedState.Successful;v.prepared()}}else{p.MobageAnalytics.reportEvent("iOSIAPDATAINVALID2");v._preparedState=f.PreparedState.Unavailable;v.prepared()}})}else{v._bankController=new o(w,function(G,D,E,F){NgLogD("User tapped Buy for credit item "+G);u.Purchase.invokeIAP(G,D,E,F)},function(){NgLogD("Exited Bank Controller")});v._preparedState=f.PreparedState.Successful;v.prepared()}}})}}},onExecute:function(){switch(this._preparedState){case f.PreparedState.NotPrepared:throw new Error("Bank Action not Prepared!");break;case f.PreparedState.NotCredentialed:if(!s.currentDialog){new s()}break;case f.PreparedState.ComingSoon:d.hideLoadingLabel();p.UIUtils.showToast(b("Coming soon!"));break;case f.PreparedState.Unsupported:var v=(new h.AlertDialog()).retain();v.setTitle(b("Error"));v.setText(b("Sorry, the Bank is not supported."));v.setChoices([b("OK")]);v.show();v.onchoice=function(){v.release();v=null};break;case f.PreparedState.Unavailable:var w=(new h.AlertDialog()).retain();w.setTitle(b("Error"));w.setText(b("Sorry, the Bank is not available. Please try again later."));w.setChoices([b("OK")]);w.onchoice=function(x){w.release();w=null};w.show();if(a.Capabilities.getPlatformOS().toLowerCase()!="iphone os"){p.MobageAnalytics.reportEvent("MobaBankUnvaliable")}break;case f.PreparedState.Successful:d.navController.pushViewController(this._bankController);break;default:throw new Error("JSLint Sucks");break}d.hideLoadingLabel();this.executed();this._isPrepared=false;this._hasExecuted=false},cancel:function(){this._preparing=false;this._isPrepared=false;this._preparedState=f.PreparedState.NotPrepared}})}};__ngs._2z={_c:null,_d:function(){var c={exports:{}};var a=c.exports;this._c=c;var e=__ngs.r_(__ngs._5).Core;var b=__ngs.r_(__ngs._s).Network;var d=__ngs.r_(__ngs._a).Storage;a.Assets=e.Class.singleton({initialize:function(){this._base=this._initRootHack();this._assetsBase="Assets/";this._distributionName="";try{this._distributionName=e.Capabilities.getBinaryDistributionName();if(!this._distributionName){this._distributionName=e.Capabilities.getDistributionName()}}catch(f){this._distributionName=e.Capabilities.getDistributionName()}if(this._distributionName=="mobagegamehub-gs2"){if(!this.supportGamesJSON){this.loadSamsungAppsGames()}}},loadSamsungAppsGames:function(){var f=this;var h="SamsungApps.json";f.displaySize=e.Capabilities.getScreenWidth()+"x"+e.Capabilities.getScreenHeight();NgLogD("Samsung Display Size: "+f.displaySize);NgLogD("Assets File Path: "+f._base+h);d.FileSystem.readFile(f._base+h,{blocking:true},function(j,k){if(j){return}if(k){NgLogD("Assets Cache: "+k);f.supportGamesJSON=JSON.parse(k)}});var g=new b.XHR();g.open("GET","http://gamehub.mobage.com/app/1.0s/gamehub/configuration.json",true);g.onreadystatechange=function(){if(g.readyState==4){NgLogD("Assets Debug xhr: "+g.responseText);var k=JSON.parse(g.responseText);var j=new b.XHR();j.open("GET",k.contentUrl+"/Content/conf/"+h,true);j.onreadystatechange=function(){if(j.readyState==4){f.supportGamesJSON=JSON.parse(j.responseText);d.FileSystem.writeFile(f._base+h,j.responseText,{blocking:true},function(l){})}};j.send()}};g.send()},localizationsPath:function(){return this._base+this._assetsBase+"Localizations/"},image:function(f){return this._base+this._assetsBase+"Images/"+f},isSupportGame:function(h){if(this._distributionName!="mobagegamehub-gs2"){return true}if(!this.supportGamesJSON){return false}if(!this.supportGamesJSON[h]){return false}if(!this.supportGamesJSON[h].display[this.displaySize]){return false}var g;try{g=e.Capabilities.getSimCountryCode().toLowerCase();if(this.supportGamesJSON[h].unsupport[g]){return false}}catch(f){try{g=e.Capabilities.getNetworkCountryCode().toLowerCase();if(this.supportGamesJSON[h].unsupport[g]){return false}}catch(f){}}return true},getSamsungAppsUrl:function(){if(!this.supportGamesJSON){return"market://details?id="}var f=this.supportGamesJSON.SamsungAppsUrl;if(f){return f}return"market://details?id="},loggerSettingsPath:function(){return this._base+this._assetsBase+"logger_settings.json"},loadPhasesPath:function(){return this._base+"load_phases.json"},loadEditTextLimitsPath:function(){return this._base+this._assetsBase+"interface_limits.json"},privSandboxPath:function(){return this._base},_initRootHack:function(){var h=e.Capabilities._getBootServer();if(!h.match(/.*\/$/)){h+="/"}var g=h+e.Capabilities._getBoot();g=b.Util.NormalizeUrl(g);var f=b.Util.GetMD5HashDirectoryFromUrl(g)+"/";return f}})}};__ngs._30={_c:null,_d:function(){var d={exports:{}};var E=d.exports;this._c=d;var g=new (__ngs.r_(__ngs._2b).InterfaceLoader)({NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils},Credentials:function(){return __ngs.r_(__ngs._2r).Credentials}});var D=__ngs.r_(__ngs._54);var f=__ngs.r_(__ngs._28);var p=__ngs.r_(__ngs._3h);var m=__ngs.r_(__ngs._4d);var t=__ngs.r_(__ngs._44).MessageListener;var K=__ngs.r_(__ngs._1s).SHA1;var n=__ngs.r_(__ngs._7).Capabilities;var G=__ngs.r_(__ngs._o);var k=__ngs.r_(__ngs._2e);var F=__ngs.r_(__ngs._5s).UserBuddiesList;var h=__ngs.r_(__ngs._5t).UserGameFriendsList;var x=__ngs.r_(__ngs._5u).FeaturedUsersList;var l=__ngs.r_(__ngs._5v).OwnedGamesList;var u=__ngs.r_(__ngs._2z).Assets;var B=__ngs.r_(__ngs._n).LocalizedString;var y=__ngs.r_(__ngs._5w).AchievementsList;var A="com.ngmoco.authentication.auth_key";var q="com.ngmoco.authentication.username";var z="com.ngmoco.authentication.avatar_id";var v="com.ngmoco.authentication.lastUserObject";var H="CurrentUser";var o="CurrentUserFriends";var s="CurrentUserFollowers";var j="user";var w="error";var J="list";var e="target";var a="action";var C="user_id";var c=p.DMLogD;var b=p.DMLogE;var r=p.DataModel.subclass({classname:"User",initialize:function($super,L,M){$super(L);this.gamertag=null;this.avatarId=null;this.motto="";this.relation=null;this.photoId=null;this.emailAddress="";this.emailHash="";this.phoneNumber="";this.password=null;this.firstName=null;this.lastName=null;this.hideFullName=false;this.ageRestricted=false;this.isNewRelationship=false;this.isMutualFriend=false;this.showsPresence=false;this.onlyShowFriendNotifications=false;this.optsIn=false;this.allowFriendPostsOnly=true;this.isMobageUser=false;this.isGameHubUser=false;this.gamerscore=0;this.gamerLevel=0;this.gamerLevelName=null;this.gamerLevelScore=0;this.gamerNextLevelScore=0;this.games=[];this.lastPlayedGame=null;this.unreadWallPostCount=0;this.entityTag=null;this.sparse=true;this.sessionCount=0;this.isNuxComplete=0;this.ignoreFriendRequests=0;this._updating=false;this._loadData(M,{})},_loadData:function(Q,P){Q=Q||{};P=P||{};this.beginChanges();this.gamertag=Q[r.GamertagKey]||this.gamertag;this.avatarId=Q[r.AvatarKey]||this.avatarId;this.relation=Q[r.RelationKey]||this.relation;this.photoId=Q[r.PhotoKey]||this.photoId;this.emailAddress=Q[r.EmailAddressKey]||this.emailAddress;this.emailHash=r.EmailHashKey in Q?Q[r.EmailHashKey].toLowerCase():this.emailHash;this.phoneNumber=Q[r.PhoneNumberKey]||this.phoneNumber;this.password=Q[r.PasswordKey]||this.password;this.firstName=Q[r.FirstNameKey]||this.firstName;this.lastName=Q[r.LastNameKey]||this.lastName;this.hideFullName=r.PrivacyKey in Q?Q[r.PrivacyKey]:this.hidesFullName;this.ageRestricted=r.AgeRangeKey in Q?Q[r.AgeRangeKey]:this.ageRestricted;this.isNewRelationship=r.NewBuddyKey in Q?Q[r.NewBuddyKey]:this.isNewRelationship;this.isMutualFriend=r.IsMutualFriendKey in Q?Q[r.IsMutualFriendKey]:this.isMutualFriend;if(this.ageRestricted){this.motto=""}else{this.motto=Q[r.MottoKey]||this.motto}c("Got some user stuff: "+this.hideFullName+" "+this.ageRestricted+" "+this.isNewRelationship+" "+r.PrivacyKey+" "+r.AgeRangeKey+" "+r.NewBuddyKey+" "+Q[r.PrivacyKey]+" "+Q[r.AgeRangeKey]+" "+Q[r.NewBuddyKey]);this.showsPresence=r.HidePresenceKey in Q?!Q[r.HidePresenceKey]:this.showsPresence;this.onlyShowFriendNotifications=r.OnlyShowFriendNotificationsKey in Q?Q[r.OnlyShowFriendNotificationsKey]:this.onlyShowFriendNotifications;this.optsIn=r.SpamKey in Q?Q[r.SpamKey]:this.optsIn;this.allowFriendPostsOnly=r.AllowFriendPostsOnlyKey in Q?Q[r.AllowFriendPostsOnlyKey]:this.allowFriendPostsOnly;this.isMobageUser=r.IsMobageUser in Q?Q[r.IsMobageUser]:this.isMobageUser;this.isGameHubUser=r.IsGameHubUser in Q?Q[r.IsGameHubUser]:this.isGameHubUser;this.sessionCount=r.SessionCountKey in Q?Q[r.SessionCountKey]:this.sessionCount;this.isNuxComplete=r.IsNuxCompleteKey in Q?Q[r.IsNuxCompleteKey]:this.isNuxComplete;this.ignoreFriendRequests=r.IgnoreFriendRequestsKey in Q?Q[r.IgnoreFriendRequestsKey]:this.ignoreFriendRequests;this.grade=r.GradeKey in Q?Q[r.GradeKey]:(r.CommonGradeKey in Q?Q[r.CommonGradeKey]:this.grade);this.gamerscore=r.GamerScoreKey in Q?Q[r.GamerScoreKey]:this.gamerscore;this.gamerLevel=r.LevelNumberKey in Q?Q[r.LevelNumberKey]:this.gamerLevel;this.gamerLevelName=r.LevelNameKey in Q?Q[r.LevelNameKey]:this.gamerLevelName;this.gamerLevelScore=r.CurrentLevelScoreKey in Q?Q[r.CurrentLevelScoreKey]:this.gamerLevelScore;this.gamerNextLevelScore=r.NextLevelScoreKey in Q?Q[r.NextLevelScoreKey]:this.gamerNextLevelScore;this.unreadWallPostCount=r.UnreadWallPostCountKey in Q?Q[r.UnreadWallPostCountKey]:this.unreadWallPostCount;if(Q[r.GamesKey]){var O=[];this.games=this.games||[];for(var N in Q[r.GamesKey]){if(Q[r.GamesKey].hasOwnProperty(N)){var M=Q[r.GamesKey][N];var L=(M&&M.hasOwnProperty("product"))?k.Game.getGameWithData(M.product):k.Game.getGameWithData(M);if(this.games.indexOf(L)!==-1){this.games.splice(this.games.indexOf(L),1)}if(L){O.push(L)}}}this.games=O.concat(this.games);this.lastPlayedGame=(this.games.length)?this.games[0]:null}this.entityTag=P.etag||this.entityTag;this._updateSparseFlag();this.endChanges()},_updateSparseFlag:function(){if(this.photoId!==null&&this.firstName!==null&&this.lastName!==null&&this.gamerLevelName!==null){this.sparse=false}else{this.sparse=true}},getFullName:function(){var L=[];if(this.firstName){L.push(this.firstName)}if(this.lastName){L.push(this.lastName)}return L.join(" ")},addBuddy:function(O,L){L=L||f.PlusRequest.noOp;if(!O){L("No user",null);return null}if(!this._invitingList){this._invitingList={}}this._invitingList[O.recordID]=O;var M=this;var N=new f.PlusRequest();N.setApiMethod("users/"+M.recordID+"/buddies");N.setHttpMethod("POST");N.setPostBody({id:O.recordID,enemy:"false"});N.send(function(P,Q){delete M._invitingList[O.recordID];if(!P){M.emit({buddies:1})}L(P,Q)});return N},isInviting:function(L){return this._invitingList&&this._invitingList[L.recordID]},getAvatars:function(L){L=L||f.PlusRequest.noOp;var M=this;var N=new f.PlusRequest();N.setApiMethod("badges");N.setHttpMethod("GET");N.send(function(R,S){var U=[];if(!R){var T=S?S.success:false;if(T){for(var O in S.list){if(S.list.hasOwnProperty(O)){var Q=S.list[O];if(Q.name==="Mobage"||Q.name==="General"){for(var P in Q.badges){U.push(Q.badges[P].icon_url)}}}}}}L(R,U)})},deleteBuddy:function(O,L){L=L||f.PlusRequest.noOp;if(!O){L("No user",null);return null}var M=this;var N=new f.PlusRequest();N.setApiMethod("users/"+M.recordID+"/buddies/"+O.recordID);N.setHttpMethod("DELETE");N.send(function(P,Q){if(!P){O.isMutualFriend=false;M.emit({buddies:1})}L(P,Q)});return N},ignoreBuddy:function(O,L){L=L||f.PlusRequest.noOp;if(!O){L("No user",null);return null}var M=this;var N=new f.PlusRequest();N.setApiMethod("users/"+M.recordID+"/buddies/"+O.recordID+"?relation=followers");N.setHttpMethod("DELETE");N.send(function(P,Q){if(!P){O.isMutualFriend=false;M.emit({buddies:1})}else{NgLogD("ERR!")}L(P,Q)});return N},getUserDetails:function(L){L=L||f.PlusRequest.noOp;var N=this;var M=G.Session.getCurrentSession().dataCache().getObjectWithRecordID(r.classname,N.recordID);if(M!==null&&M.sparse===false){L(undefined,M);return null}var O=new f.PlusRequest();O.setApiMethod("users/"+N.recordID);O.setHttpMethod("GET");O.setEntityTag(this.entityTag);O.send(function(R,S,P,T){var Q=null;if(!R){if(P==304){Q=r.getUserWithRecordID(N.recordID)}else{Q=r.getUserWithData(S);Q._loadData(S)}if(L){L(null,Q)}}});return O},getUnreadWallPostCount:function(L){L=L||f.PlusRequest.noOp;if(this!=G.Session.getCurrentSession().user()){L("Cannot get unread wall post count for non-logged-in users",false);return null}var M=this;var N=new f.PlusRequest();N.setApiMethod("users/unread_wall_count");N.setHttpMethod("GET");N.send(function(O,P){if(O){L(O,null);return}else{if(P&&P.success===true){NgLogD("Got data: "+JSON.stringify(P));M.unreadWallPostCount=P.count;L(null,M.unreadWallPostCount)}else{L("Error connecting to server",null)}}});return N},clearUnreadWallPostCount:function(L){L=L||f.PlusRequest.noOp;if(this!=G.Session.getCurrentSession().user()){L("Cannot clear unread wall post count for non-logged-in users",false);return null}var M=this;var N=new f.PlusRequest();N.setApiMethod("users/clear_unread_wall_count");N.setHttpMethod("PUT");N.send(function(O,P){if(O){L(O,false);return}else{if(P&&P.success===true){M.unreadWallPostCount=0;L(null,true)}else{L("Error connecting to server",false)}}});return N},inviteToCurrentGame:function(L){L=L||f.PlusRequest.noOp;var M=new f.PlusRequest();M.setHttpMethod("POST");M.setApiMethod("invitations");M.setPostBody({recipient_id:this.recordID});M.send(L)},getInvitesList:function(){if(!this._followersList){this._followersList=new F(r,this.recordID,"followers")}return this._followersList},getFriendsList:function(){if(!this._buddiesList){this._buddiesList=new F(r,this.recordID,"buddies")}return this._buddiesList},getMutualFriendsList:function(){if(!this._mutualFriendsList){this._mutualFriendsList=new F(r,this.recordID,"mutual")}return this._mutualFriendsList},getFriendsListForGame:function(L){return new F(r,this.recordID,"mutual",L)},getBlockedUserList:function(){if(!this._enemiesList){this._enemiesList=new F(r,this.recordID,"enemies")}return this._enemiesList},getFollowersList:function(){if(!this._friendsList){this._friendsList=new F(r,this.recordID,"friends")}return this._friendsList},getFeaturedUsersList:function(){if(!this._featuredUsersList){this._featuredUsersList=new x(r,this.recordID)}return this._featuredUsersList},getOwnedGamesList:function(){if(!this._ownedGamesList){this._ownedGamesList=new l(k.Game,this.recordID)}return this._ownedGamesList},getAchievementsList:function(){if(!this._achievementsList){this._achievementsList=new y(this.recordID)}return this._achievementsList},getGameFriendsList:function(M,N){if(!this._gameFriendsLists){this._gameFriendsLists={}}if(!M){M="friends"}var L=(N||"___unnamedGroup")+"-"+M;if(!this._gameFriendsLists[L]){this._gameFriendsLists[L]=new h(r,this.recordID,M,N)}return this._gameFriendsLists[L]},addGameFriend:function(P,Q,M){M=M||f.PlusRequest.noOp;if(!P){M("No user",null);return null}var L={gamertag:P.gamertag};if(Q){L.group=Q}var N=this;var O=new f.PlusRequest();O.setApiMethod("users/"+N.recordID+"/friends");O.setHttpMethod("POST");O.setPostBody(L);O.send(function(R,S){if(!R){N.emit({buddies:1})}M(R,S)});return O},removeGameFriend:function(O,L){L=L||f.PlusRequest.noOp;if(!O){L("No user",null);return null}var M=this;var N=new f.PlusRequest();N.setApiMethod("users/"+M.recordID+"/friends/"+O.gamertag);N.setHttpMethod("DELETE");N.send(function(P,Q){if(!P){M.emit({buddies:1})}L(P,Q)});return N},report:function(O,L,P){L=L||f.PlusRequest.noOp;if(!O||O.length===0){L("No reason to report this user",null);return null}var M=this;var N=new f.PlusRequest();N.setApiMethod("users/"+M.recordID+"/flags");N.setHttpMethod("POST");if(P){P.reason=O;N.setPostBody(P)}else{N.setPostBody({reason:O})}N.send(function(Q,R){c("Reporting user: "+JSON.stringify(Q)+" "+JSON.stringify(R));L(Q,(R&&R.success===true))});return N},sendNotificationToUser:function(P,L,O,M){var N=new f.PlusRequest();N.setApiMethod("notifications");N.setHttpMethod("POST");N.setPostBody({user_id:this.recordID,payload:{alert:P,badge:L,sound:O,extra_data:M}});N.send(function(R,S,Q,T){if(R||typeof S==="undefined"){if(!R||R===""){R="<No error information! :( >"}b("GameService: sendPushNotificationToUser: Error sending push request:"+JSON.stringify(R))}else{if(S.success===false){b("GameService: sendPushNotificationToUser: Failed sending push request:"+JSON.stringify(S))}else{c("GameService: sendPushNotificationToUser: Success.")}}});return N},setEmailAddress:function(M,L){if(!r.emailAddressLooksValid(M)){L(B("Please enter a valid email address"),null);return null}return this._updateValues({email:M},L,{emailAddress:M,emailHash:r.hashForEmail(M)},"GameService: setEmailAddress: Error setting email address:")},setIgnoreFriendRequests:function(M,L){return this._updateValues({ignore_friend_requests:M},L,{ignoreFriendRequests:M},"GameService: setIgnoreFriendRequests: Error setting ignoreFriendRequests:")},setNuxComplete:function(M,L){return this._updateValues({new_user_experience_complete:M},L,{isNuxComplete:M},"GameService: setNux: Error setting isNuxComplete:")},setOnlyShowFriendNotifications:function(M,L){return this._updateValues({friend_only_notification:M},L,{onlyShowFriendNotifications:M},"GameService: setOnlyShowFriendNotifications: Error setting notifications as friends only:")},setOptsIn:function(M,L){return this._updateValues({opt_in:M},L,{optsIn:M},"GameService: setOptsIn: Error setting opts in:")},setAllowFriendPostsOnly:function(N,L){var M=N?1:0;return this._updateValues({friend_only_wallpost:M},L,{allowFriendPostsOnly:N},"GameService: setAllowFriendPostsOnly: Error setting wall posting for friends only:")},setAvatarImage:function(M,L){return this._updateValues({badge_id:M},function(O,P){if(!O){if(this.photoId){L=L||f.PlusRequest.noOp;var N=new f.PlusRequest();N.setHttpMethod("DELETE");N.setApiMethod("users/"+this.recordID+"/photo");N.setPostBody({});N.send(this.bind(function(S,Q,T,R){if(!S){this.photoId=null}L(S,Q)}));this._updateValues({social_photo_url:""},function(){},{photoId:null},"GameService: setAvatarImage: Error clearing social photo url:")}else{L(O,P)}}else{L(O,P)}}.bind(this),{avatarId:M},"GameService: setAvatarImage: Error setting avatarImage:")},setMotto:function(M,L){return this._updateValues({motto:M},L,{motto:M},"GameService: setMotto: Error setting motto:")},setFirstName:function(M,L){return this._updateValues({first_name:M},L,{firstName:M},"GameService: setFirstName: Error setting first name:")},setLastName:function(M,L){return this._updateValues({last_name:M},L,{lastName:M},"GameService: setLastName: Error setting last name:")},setPassword:function(N,M,L){return this._updateValues({password:N,password_confirmation:M},L,{password:N},"GameService: setPassword: Error setting password:")},setGamertag:function(M,L){return this._updateValues({gamertag:M},L,{gamertag:M},"GameService: setGamertag: Error setting gamertag:")},updatePassword:function(O,N,M,L){return this._updateValues({current_password:O,password:N,password_confirmation:M},L,{password:N},"GameService: setPassword: Error setting password:")},setSocialPhotoUrl:function(M,L){return this._updateValues({social_photo_url:M},L,{photoId:M},"GameService: setSocialPhotoUrl: Error setting social photo url:")},setBlocked:function(N,L){L=L||f.PlusRequest.noOp;var M=this;if(!M){L("No user",null);return null}var O=new f.PlusRequest();if(N){O.setApiMethod("users/"+G.Session.getCurrentSession().user().recordID+"/buddies");O.setPostBody({id:M.recordID,enemy:"true"});O.setHttpMethod("POST")}else{O.setApiMethod("users/"+G.Session.getCurrentSession().user().recordID+"/buddies/"+M.recordID);O.setHttpMethod("DELETE")}O.send(function(Q,R){if(R&&R.buddy){var P=r.getUserWithData(R.buddy);L(Q,P)}else{L(Q,null)}G.Session.getCurrentSession().user().emit({buddies:1,blocked:M})});return O},getOriginOfRegistration:function(L){L=L||f.PlusRequest.noOp;var N=this;var M=null;var O=null;if(N){if(N.isGameHubUser){M="SamsungGameHub"}else{if(N.isMobageUser){M="MobageFromAndroidMarket"}else{M="UNKNOWN"}}}else{O="No user"}L(O,M)},usesGuestLogin:function(){return(typeof this.grade=="number"&&this.grade===1)},batchUpdate:function(M,L){this._updateBody={};this._updatingSetters={};this._updatingErrors={};this._updating=true;try{M()}catch(N){console.log("Error processing batch update: "+N)}this.finishUpdating(this._updateBody,this._updatingSetters,this._updatingErrors,L)},finishUpdating:function(M,O,P,L){this._updating=false;var N=new f.PlusRequest();N.setHttpMethod("PUT");N.setApiMethod("users/"+this.recordID);N.setPostBody(M);N.send(this.bind(function(R,S){c("err = "+JSON.stringify(R));c("data = "+JSON.stringify(S));NgLogD("%$%$%$data = "+JSON.stringify(S));if(r._callBackIsOK(R,S,P)){if(O){var Q;for(Q in O){if(Q!="password"){this[Q]=O[Q]}}}}L(R,S)}));return N},upgradeGuestUserWithUsernameAndPassword:function(M,Q,P,O,L){if(!this.usesGuestLogin()){L("not a guest user");return}var N=this;N.batchUpdate(function(){N.setGamertag(M);N.setPassword(Q,Q);N.setEmailAddress(P);N.setOptsIn(O)},function(R,S){if(R){L(R)}else{N.verifyUpgraded(function(T){if(T){L(T)}else{NgLogD("Mobage/user - Upgraded user OK!");G.Session._clearGuestCredentials();L(null)}})}})},verifyUpgraded:function(M){var L=this;var N=new f.PlusRequest();N.setApiMethod("users/"+this.recordID);N.setHttpMethod("GET");N.send(function(O,P){if(O){M(O)}else{L.grade=r.GradeKey in P?P[r.GradeKey]:(r.CommonGradeKey in P?P[r.CommonGradeKey]:L.grade);if(L.grade===1){M("Did not upgrade")}else{M(null)}}})},_combineHashes:function(L,N){for(var M in N){if(N.hasOwnProperty(M)){L[M]=N[M]}}return L},_updateValues:function(N,L,O,M){L=L||f.PlusRequest.noOp;if(this._updating){this._updateBody=this._combineHashes(this._updateBody,N);this._updatingSetters=this._combineHashes(this._updatingSetters,O);this._updatingErrors=this._updatingErrors+", "+M}else{this.finishUpdating(N,O,M,L)}},getDefinedIcon:function(){return this.photoId||this.avatarId||u.image("no-user-icon.png")},setPhoto:function(N,L){L=L||f.PlusRequest.noOp;var M=new f.PlusRequest();M.setHttpMethod("POST");M.setApiMethod("users/"+this.recordID+"/photo");M.setPostBody({});M.addAttachmentWithNameAndFilenameOfType(null,"photo",N,null);M.send(this.bind(function(P,Q,R,O){if(!P){this._updateValues({social_photo_url:""},function(){},{},"GameService: setPhoto: Error clearing social photo url:");if(Q.photo_url===""){P="Did not upload photo"}if(r._callBackIsOK(P,Q,"Failed photo upload")){this.photoId=Q.photo_url}}L(P,Q)}));return M},addAsBuddyAndUpdateLocalRelation:function(L){G.Session.getCurrentSessionUser().addBuddy(this,function(M,N){if(M){L(M)}else{this.invited=true;this.updateLocalRelation(L)}}.bind(this))},updateLocalRelation:function(L){if(!this.localRelation){this.localRelation="stranger"}var M=G.Session.getCurrentSessionUser();M.getMutualFriendsList().forAll(function(O,N){if(this.is(N)){this.localRelation="friend";O(false);return}O(true)}.bind(this),function(N){if(this.isMutualFriend){L();return}M.getInvitesList().forAll(function(P,Q,O){if(this.is(Q)){this.localRelation=(Q.isMutualFriend)?"friend":"follower";P(false);return}P(true)}.bind(this),function(O){L()}.bind(this));M.getFollowersList().forAll(function(P,Q,O){if(this.is(Q)){this.localRelation=(Q.isMutualFriend)?"friend":"requested";P(false);return}P(true)}.bind(this),function(O){L()}.bind(this))}.bind(this))}});p.DataModel.defineSetterCallbacks(r,["gamertag","avatarId","motto","relation","sparse","photoId","emailAddress","emailHash","phoneNumber","password","firstName","lastName","hideFullName","ageRestricted","isNewRelationship","isMutualFriend","showsPresence","onlyShowFriendNotifications","allowFriendPostsOnly","capabilities","gamerscore","gamerLevel","gamerLevelName","gamerLevelScore","gamerNextLevelScore","games","isMobageUser","isGameHubUser","optsIn","motto","firstName","lastName","password","unreadWallPostCount","isNuxComplete","ignoreFriendRequests","grade"]);r.getUserWithID=function(O,L){L=L||f.PlusRequest.noOp;if(!O){L("No user ID",null);return null}var N=G.Session.getCurrentSession().dataCache();var M=N.getObjectWithRecordID(r.classname,O);if(M){L(null,M);return null}var P=new f.PlusRequest();P.setApiMethod("users/"+O);P.setHttpMethod("GET");P.send(function(R,S,T,Q){if(!R&&S){M=r.getUserWithData(S);L(null,M)}else{L(R,S)}});return P};r.getUserWithGamertag=r.getUserWithID;r._loopUsersDetails=function(N,O,T,R,P,M,Q){if(M.length<=0){N(O,Q,T,R,P);return}var S=M.pop();if(S.sparse){var L=function(U,V){if(!U){Q.unshift(V);r._loopUsersDetails(N,O,T,R,P,M,Q)}else{Q.unshift(S);r._loopUsersDetails(N,U,T,R,P,M,Q)}};S.getUserDetails(L)}else{Q.unshift(S);r._loopUsersDetails(N,O,T,R,P,M,Q)}};r.findUsersWithEmailHashes=function(S,M){M=M||f.PlusRequest.noOp;var N=[];S=S||[];while(S.length>0){if(S.length>100){N.push(S.splice(0,100))}else{N.push(S.splice(0,S.length))}}var L=0;var O=[];var T=function(V,W){L--;for(var U=0;U<W.length;U++){O[W.offset+U]=W[U]}if(L===0){M(V,O)}};for(var R=0;R<N.length;R++){var P=N[R];var Q=P.join(",");L++;r.findUsersWithEmail(Q,T)}};r.findUsersWithEmail=function(M,L){L=L||f.PlusRequest.noOp;if(!M){L("No email",null);return null}var N=new f.PlusRequest();N.setHttpMethod("GET");N.setApiMethod("users/search");N.setPostBody({email_hash:r.emailAddressLooksValid(M)?r.hashForEmail(M):M});N.send(function(S,T){if(!(T&&!S&&T.success===true)){T={profiles:[],total:0,offset:0}}var P=T.list;var U=[];for(var O in P){var R=P[O];var Q=r.getUserWithData(R);U.push(Q)}U.offset=T.offset;U.total=T.total;L(S,U)});return N};r.findUsersWithFuzzySearch=function(M,L){L=L||f.PlusRequest.noOp;if(!M){L("No search string",null);return null}var N=new f.PlusRequest();N.setHttpMethod("GET");N.setApiMethod("users/search");if(r.emailAddressLooksValid(M)){N.setPostBody({email_hash:r.hashForEmail(M)})}else{N.setPostBody({combined:M})}N.send(function(S,U){var T=S;if((!S)&&U&&(!U.success)){T=U.error_msg}if(!(U&&!T&&U.success===true)){U={profiles:[],total:0,offset:0}}var P=U.list;var V=[];for(var O in P){var R=P[O];var Q=r.getUserWithData(R);V.push(Q)}V.offset=U.offset;V.total=U.total;L(T,V)});return N};r.findUsersFromContactList=function(T,M){M=M||f.PlusRequest.noOp;if(!T){M("No contacts",null,null);return}var U=[];var L={};for(var S in T){var Q=T[S];var P=Q.lowercaseEmails||[];for(var N=0;N<P.length;N++){var R=P[N];var O=r.hashForEmail(R);if(!L[O]){L[O]=[];U.push(O)}L[O].push(Q)}}r.findUsersWithEmailHashes(U,function(Y,ac){for(var V=0;V<ac.length;V++){var W=ac[V];var Z=W.emailHash;var aa=L[Z];for(var ab=0;ab<aa.length;ab++){var X=aa[ab];W.displayName=X.displayName;T.splice(T.indexOf(X),1)}}M(Y,T,ac)})};r.emailAddressLooksValid=function(L){return((L||"").toUpperCase().match(/\b[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b/)!==null)};r.hashForEmail=function(L){if(!L){return null}return K.hex_sha1(L)};r.sendFriendInviteToEmail=function(M,L){L=L||f.PlusRequest.noOp;if(!M){L("No email",null);return null}var N=new f.PlusRequest();N.setHttpMethod("POST");N.setApiMethod("invitations");N.setPostBody({email:M});N.send(L);return N};r._callBackIsOK=function(M,N,L){if((M&&M.length>0)||typeof N==="undefined"){if(L){c(L+"'"+JSON.stringify(M)+"'");c("In error, data is :"+JSON.stringify(N))}return false}if(N.success===false){if(L){b(L,JSON.stringify(N.error))}return false}return true};r.GamertagKey="gamertag";r.AvatarKey="badge_id";r.MottoKey="motto";r.RelationKey="relation";r.FirstNameKey="first_name";r.LastNameKey="last_name";r.BirthdateKey="birth_date";r.GenderKey="gender";r.PrivacyKey="fullname_privacy";r.PhotoKey="photo_url";r.EmailAddressKey="email";r.EmailHashKey="email_hash";r.PhoneNumberKey="phone_number";r.AgeRangeKey="age_restricted";r.SpamKey="opt_in";r.IsMobageUser="mobage_user";r.IsGameHubUser="gamehub_user";r.PasswordKey="password";r.PasswordConfirmKey="password_confirmation";r.GamesKey="games";r.CapabilitiesKey="capabilities";r.NewBuddyKey="new_buddy";r.IsMutualFriendKey="mutual_friends";r.HidePresenceKey="hide_presence";r.OnlyShowFriendNotificationsKey="friend_only_notification";r.AllowFriendPostsOnlyKey="friend_only_wallpost";r.GamerScoreKey="gamerscore";r.LevelNumberKey="level_position";r.LevelNameKey="level_name";r.CurrentLevelScoreKey="level_points";r.NextLevelScoreKey="level_next_points";r.UnreadWallPostCountKey="unread_wall_count";r.IsNuxCompleteKey="new_user_experience_complete";r.SessionCountKey="num_session";r.IgnoreFriendRequestsKey="ignore_friend_requests";r.GradeKey="grade";r.CommonGradeKey="userGrade";r.NonSparseKeys=[r.PhotoKey,r.EmailAddressKey,r.EmailHashKey,r.PhoneNumberKey,r.PasswordKey,r.FirstNameKey,r.LastNameKey,r.PrivacyKey,r.NewBuddyKey,r.CapabilitiesKey,r.HidePresenceKey,r.OnlyShowFriendNotificationsKey,r.AllowFriendPostsOnlyKey,r.GamerScoreKey,r.LevelNumberKey,r.LevelNameKey,r.CurrentLevelScoreKey,r.NextLevelScoreKey,r.GamesKey,r.IsNuxCompleteKey,r.SessionCountKey,r.IgnoreFriendRequestsKey];r.ContextSensitiveKeys=[r.IsMutualFriendKey];r.currentUser=function(){return G.Session.getCurrentSession().user()};r.setCurrentUser=function(L){b("*** User.setCurrentUser is DEPRECATED, do not use it! ***")};r.getFeaturedUsersList=function(){if(!r._featuredUsersList){r._featuredUsersList=new x(r)}return r._featuredUsersList};r.addCurrentUserListener=function(M,N,L){G.Session.getCurrentSession.addListener(M,N,L)};r.removeCurrentUserListener=function(L){G.Session.getCurrentSession.removeListener(L)};r.getUserWithData=function(P){var O=P[C];var N=G.Session.getCurrentSession().dataCache();var M=N.getObjectWithRecordID(r.classname,O);if(M!==null){M._loadData(P);return M}var L=new r(O,P);M=N.addObject(L);return M};r.purgeContextSensitiveKeysFromDictionary=function(M){if(!M||!(M instanceof Object)){return}for(var L in r.ContextSensitiveKeys){if(r.ContextSensitiveKeys.hasOwnProperty(L)){delete M[r.ContextSensitiveKeys[L]]}}};r.getNumberOfUsersForThisDevice=function(L){L=L||f.PlusRequest.noOp;var N=g.NetworkUtils.getDeviceIdForPlatformServer();var M=new f.PlusRequest();M.setHttpMethod("GET");M.setApiMethod("users/device_accounts/"+N);M.send(function(P,Q){if(P){L(P,null)}else{if(!Q||!Q.success){L("no data",null)}else{var O={};for(key in Q){if(key.indexOf("grade_")===0){O[key]=Q[key]}}L(null,O)}}})};r.hasNonGuestUsersForDevice=function(L){L=L||f.PlusRequest.noOp;r.getNumberOfUsersForThisDevice(function(M,N){if(M){L(M,null,null)}else{for(key in N){if(key!="grade_0"&&key!="grade_1"&&N[key]>0){L(null,true,N);return}}L(null,false,N)}})};r.showAccountUpgrade=function(L){L=L||f.PlusRequest.noOp;g.Credentials.showRegistration(function(M,N){L(N)},true,true,"tiered",null,"gamePublicAPI")};E.User=r;var I=E.UserListener=t.subclass({callback:null,_user:null,initialize:function($super,M,L){$super();this.callback=M;this._user=L;this._user.addListener(this,this._onEvent.bind(this))},_onEvent:function(L){if(typeof this.callback=="function"){this.callback(L)}},destroy:function(){if(this._user){this._user.removeListener(this);this._user=null}this.callback=null}})}};__ngs._31={_c:null,_d:function(){var d={exports:{}};var e=d.exports;this._c=d;var h=__ngs.r_(__ngs._5).Core;var b=__ngs.r_(__ngs._o);var c=__ngs.r_(__ngs._28);var g=__ngs.r_(__ngs._2h).SystemMessagesStack;var a=5;var j=240;var f=e.Updater=h.Class.singleton({classname:"Updater",_running:false,_requestedIntervals:{},_updateTimer:{uid:null,time:null},_updateInterval:{minimum:a,maximum:j,current:a},initialize:function(){},start:function(){if(!this._running){this._running=true;this._scheduleCheck()}},stop:function(){if(this._running){this._running=false;this._stopTimer()}},checkNow:function(){NgLogD("PlusUpdater: Checking");this._stopTimer();var k=new c.PlusRequest();k.setApiMethod("user_updates");k.setHttpMethod("GET");k.send(this.bind(this.handleUpdates))},handleUpdates:function(o,p){if(p&&p.success){this._updateInterval.minimum=(p.update_interval||this._updateInterval.minimum);var m=[];for(var k in p.online_friends){var n=p.online_friends[k];m.push(b.Session.getCurrentSession().dataCache().getObjectWithRecordID("User",n))}var l=[];if(p.updates){NgLogD("user_updates: Got data.updates: "+JSON.stringify(p.updates));for(var q=0;q<p.updates.length;q++){var r=p.updates[q];if(r.key=="com.plusplus.system_message"){g.onSystemMessage(r.data)}if(r.key=="com.mobage.cpi.offer"){console.log("Length of Offer Array........."+l.length);if(r.data.offer_id&&(l.indexOf(r.data.offer_id)===-1)){g.onCPIMessage(r.data)}else{console.log("Message Already shown");continue}l.push(r.data.offer_id);console.log("Updated Length of Offer Array........."+l.length)}if(r.key=="com.mobage.cpi.redeem"){g.onCPIMessage(r.data)}}}if(p.update_interval){this._updateInterval.minimum=p.update_interval}this._recalculateInterval();this._scheduleCheck()}},updateInterval:function(){var k=this._updateInterval;return(k.current>k.minimum?k.current:k.minimum)},pushUpdateInterval:function(k){var l=(this._requestedIntervals[k]||0);this._requestedIntervals[k]=l+1;this._recalculateInterval()},popUpdateInterval:function(k){var l=this._requestedIntervals[k];if(l){this._requestedIntervals[k]=l-1}this._recalculateInterval()},_scheduleCheck:function(l){if(!l){l=this._updateInterval.current}this._stopTimer();var k=this;this._updateTimer.uid=setTimeout(function(){k.checkNow()},l*1000);NgLogD("PlusUpdater: Updating in "+l+"s")},_stopTimer:function(){if(this._updateTimer.uid){clearTimeout(this._updateTimer.uid);this._updateTimer.uid=null}},_recalculateInterval:function(){var l=this.updateInterval();var n=j;for(var m=0;m<this._requestedIntervals.length;m++){var k=this._requestedIntervals[m];if(k<n){n=k}}this._updateInterval.current=n}})}};__ngs._32={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var a=__ngs.r_(__ngs._54);var g=__ngs.r_(__ngs._5).Core;var b=__ngs.r_(__ngs._a);var e=__ngs.r_(__ngs._5x);var f=c.Cache=g.Class.subclass({namespace:"Default",classname:"Cache",inMemoryObjects:{},caches:{},lastAccessDates:{},maxSize:400,stats:{hits:0,misses:0},initialize:function(k){this.namespace=k||f.namespace;var h=["AppData","Game","Leaderboard","Score","User"];for(var j in h){this.cacheForClassname(h[j])}},_isObjectExpired:function(h){return false},cacheForClassname:function(h){if(h){var j=this.caches[h];if(!j){var k="Social.US.Data."+this.namespace+"."+h;NgLogD("Cache for classname "+h+" at "+k);j=b.Storage.KeyValueCache.global(k);this.caches[h]=j}return j}else{return null}},inMemoryObjectsBucketForClassname:function(h){return this.inMemoryObjects},getObjectWithRecordID:function(m,j){var k=""+m+"-"+j;var l=this.inMemoryObjectsBucketForClassname(m);if(l){var h=l[k]||null;if(h&&!this._isObjectExpired(h)){h.lastAccessed=new Date().getTime()}if(h){this.stats.hits++;return h.value}else{this.stats.misses++;return null}}else{return null}},addObject:function(n){var m=n._classname();var l=this.inMemoryObjectsBucketForClassname(m);var k=""+m+"-"+n.recordID;var j=l[k];if(j){return j.value}else{j=l[k]={key:k,value:n,lastAccessed:new Date().getTime()};var h=this;setTimeout(function(){h._purge()},100);return j.value}},removeObject:function(m){var l=m._classname();var j=""+l+"-"+m.recordID;var k=this.inMemoryObjectsBucketForClassname(l);if(k){delete k[j]}var h=this.cacheForClassname(l);if(h){h.removeItem(m.recordID)}},isObjectCached:function(k){var j=k._classname();var h=this.inMemoryObjectsBucketForClassname(j);return(h&&(h[k.recordID]==k))},_purge:function(){if(this.inMemoryObjects.length<=this.maxSize){return}var l=[];for(var j in this.inMemoryObjects){var k=this.inMemoryObjects[j];if(this._isObjectExpired(k)){this.removeObject(k)}else{l.push(k)}}if(l.length>this.maxSize){l=l.sort(function(n,m){return m.lastAccessed-n.lastAccessed});while(l.length>this.maxSize){var h=l.pop();this.removeObject(h.value)}}},saveCache:function(n){var t=0;var w=function(){if((--t)===0){n()}};var l={};for(var j in this.inMemoryObjects){var v=this.inMemoryObjects[j];var o=v.value;var r=o.classname;var h=this.cacheForClassname(r);var k=l[r];if(!k){k=l[r]=[]}var u=o.recordID;var q=o._serializedHash();if(q){t++;h.setItem(u,JSON.stringify(q),w);k.push(u)}}for(var m in l){var s=l[m];var p=this.cacheForClassname(m);t++;h.setItem("recordIDs",JSON.stringify(k),w)}},loadCache:function(j){var o=[];var n=this;var l=0;var k=function(){if((--l)===0){n.loadCacheFromJSONArray(o,j)}};for(var h in this.caches){var m=this.cacheForClassname(h);(function(q,p){q.getItem("recordIDs",function(v,u){if(u){var s=null;try{s=JSON.parse(u)}catch(w){NgLogE("DataModel::Cache error loading recordIDs from cache")}if(s&&!(s instanceof Array)){s=[s]}for(var r=0;r<(s||[]).length;r++){var t=s[r];l++;q.getItem(t,function(x,y){o.push(y);k()})}}})})(m,h)}},loadCacheFromJSONArray:function(m,h){var q=[];for(var p=0;p<m.length;p++){var j=m[p];if(j&&j.hasOwnProperty("classname")&&j.hasOwnProperty("recordID")){var k=j.classname;var o=e.Social.US[k];var n=j.recordID;if(o&&n){var l=this.getObjectWithRecordID(k,n);if(!l){l=new o(n,{})}l._deserializeFromHash(j);this.addObject(l)}}}h(null,this)}})}};__ngs._33={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Network:function(){return __ngs.r_(__ngs._s).Network},PlusRequest:function(){return __ngs.r_(__ngs._28).PlusRequest},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities},Session:function(){return __ngs.r_(__ngs._o).Session},NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils}});var d=b.N0kler={$_gotRegisterVerifiedCBCallback:false,getConsumerInfo:function(m,f){NgLogD("N0kler getConsumerInfo started");NgLogD("N0kler appId = "+m);if(!m){if(f){f(a.Session.NO_KEYS_ERR);return}}NgLogD("N0kler getConsumerInfo step 1");var k=new a.PlusRequest();k.setAuthenticationType(a.PlusRequest.authenticationTypes.None);k.setApiMethod("keys");k.setHttpMethod("POST");var e="sandbox";if(a.PlusRequest.serverModeIsProduction()){e="service";k.setSecure(true)}var g=a.NetworkUtils.getDeviceIdForPlatformServer();var j=this.salts(e);var l=Math.round((new Date().getTime())/1000);var h="app_key="+m+"&device_id="+g+"&salt="+j+"&timestamp="+l+"&version=1.0";NgLogD("N0kler getConsumerInfo step 2");a.Network._int_Util.sign(h,e,function(n){if(n===false){NgLogD("Mobage getConsumerInfo - Signing is not already ready. Waiting for CB.");a.Network._int_Util.registerVerifiedCB(function(){if(d._gotRegisterVerifiedCBCallback===true){NgLogD("Mobage getConsumerInfo - Got _int_Util.registerVerifiedCB callback after already called, ignoring...");return}d._gotRegisterVerifiedCBCallback=true;a.Network._int_Util.sign(h,e,function(o){NgLogD("Mobage getConsumerInfo - Got signature. Trying again.");k.setPostBody({signature:o,device_id:g,timestamp:l,version:"1.0"});NgLogT("@@@ mobage N0kler.js getConsumerInfo PlusRequest");k.send(f)})})}else{k.setPostBody({signature:n,device_id:g,timestamp:l,version:"1.0"});NgLogT("@@@ mobage N0kler.js getConsumerInfo PlusRequest");k.send(f)}});NgLogD("N0kler getConsumerInfo finished")},serverModes:function(){return{staging:"sandbox",integration:"sandbox",partner:"sandbox",sandbox:"sandbox",production:"service",unknown:"sandbox"}},salts:function(e){var f={sandbox:"rALEAy8rjDuF5T8mhlNqsg==",service:"iLz75dKRPzeKYbOAeOdIHQ=="};return f[e]}}}};__ngs._34={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=new (__ngs.r_(__ngs._f).RequireLoader)({UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},Device:function(){return __ngs.r_(__ngs._4).Device},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities},PlusRequest:function(){return __ngs.r_(__ngs._28).PlusRequest}});var a=__ngs.r_(__ngs._n).LocalizedString;var e=c.NetworkUtils={wasNetworkDown:function(g){var f=b.Device.NetworkEmitter.getLastStatus();if(f===b.Device.NetworkEmitter.Status.None){b.UIUtils.showAlert(a("No Network Connection"),a("Please check your network connection settings."),function(h){if(typeof g=="function"){g(b.PlusRequest.ERROR_NO_CONNECTION)}});return true}return false},getDeviceIdForPlatformServer:function(){var f=b.Capabilities._getDeviceIds();if(f.AID){return"aid:"+f.AID}else{if(f.IFV&&f.IFV!="00000000-0000-0000-0000-000000000000"){return"ifv:"+f.IFV}else{if(f.UDID){return"udid:"+f.UDID}}}NgLogE("getDeviceIdForPlatformServer - _getDeviceIds returned unexpected result, no ID for server can be found!");return""}}}};__ngs._35={_c:null,_d:function(){var c={exports:{}};var g=c.exports;this._c=c;var f=__ngs.r_(__ngs._59).UI;var k=__ngs.r_(__ngs._5y).NavigableViewController;var h=__ngs.r_(__ngs._5z).VerticalTabView;var a=__ngs.r_(__ngs._25).Rect;var j=__ngs.r_(__ngs._60).Style;var d=__ngs.r_(__ngs._q).MobageAnalytics;var b=__ngs.r_(__ngs._2a).Destinations;var e=g.VerticalTabController=k.subclass({classname:"VerticalTabController",$TabStateSelected:65537,initialize:function($super){$super();return this},loadView:function($super){if(!this._view){this.setView(new h())}$super()},curSelectedTab:null,selectTabAtIndex:function(l){this.logd("selectTabAtIndex "+l);var m=this.tabPairAtIndex(l);this.selectTabByView(m.tabView)},selectTabByView:function(p,n){if(n&&!this._interfaceActive){return}this.logd("selectTabByView ("+p.type+")");var q=null;var m=null;var l=(this.curSelectedTab===null);if(p===this.curSelectedTab){return}var o=this._tabPairForTabView(p);q=o.contentView;if(!q){return}if(this.curSelectedTab&&(m=this._tabPairForTabView(this.curSelectedTab))){if(m.contentView.controller){m.contentView.controller.willDeactivateTab()}}this.view().getContentView().setSelectedTab(p);this.view().getContentView().setContentView(q);if(q.controller){q.controller.parentController=this;q.controller.willActivateTab()}this._tabSelectionChange(this.curSelectedTab,p);if(!l&&m&&m.contentView.controller){m.contentView.controller.didDeactivateTab()}if(!l&&q.controller){q.controller.didActivateTab()}this._updateDynamicTitleAndImage()},_tabSelectionChange:function(n,o){if(n){if(n.setSelected){n.setSelected(false)}else{n.setState(f.State.Normal)}if(n.staticTitle){n.setText(n.staticTitle)}}var m=this._tabPairForTabView(n);this.curSelectedTab=o;this.curSelectedView=this._tabPairForTabView(o).contentView;if(o){if(o.setSelected){o.setSelected(true)}else{o.setState(e.TabStateSelected)}var l;if((l=this.curSelectedView.controller.getDynamicTabTitle())){o.staticTitle=this.curSelectedTab.getText();o.setText(l)}}if(m){d.logNavEvent(m.contentView.controller,this.curSelectedView.controller)}},_tabPairForTabView:function(n){var m=null;var l=null;for(l in this.view().tabContent){if(this.view().tabContent.hasOwnProperty(l)){m=this.view().tabContent[l];if(m.tabView===n){return m}}}return null},_tabPairForContentView:function(n){var m=null;var l=null;for(l in this.view().tabContent){if(this.view().tabContent.hasOwnProperty(l)){m=this.view().tabContent[l];if(m.contentView===n){return m}}}return null},_updateDynamicTitleAndImage:function(){var n;if(this.curSelectedTab&&(n=this._tabPairForTabView(this.curSelectedTab))){if(!this._staticTitle){this._staticTitle=this.getTitle();this._staticTitleImage=this.getTitleImage()}var l=n.contentView.controller.getDynamicPageTitle();this.setTitle(l||this._staticTitle);var m=n.contentView.controller.getDynamicPageTitleImage();this.setTitleImage(m||this._staticTitleImage)}},batchChangeMode:false,insertTabPairAtIndex:function(l,m){var n=this.view().tabContent.indexOf(l);if(n!==-1){this.loge("inserting a tab more than once. Are you sure? -- removing from old location.");this.removeTabAtIndex(n)}this.view().tabContent.splice(m,0,l);if(!this.batchChangeMode){this.view().layoutButtonContainer()}},insertTabAndContentAtIndex:function(n,o,m){var l={tabView:n,contentView:o};this.insertTabPairAtIndex(l,m);if(o.controller){o.controller.parentController=this}if(!this.batchChangeMode){this.view().layoutButtonContainer()}},addTabPair:function(l){this.insertTabPairAtIndex(l,this.view().tabContent.length);return this.view().tabContent.length-1},tabPairAtIndex:function(l){return this.view().tabContent[l]},removeTabAtIndex:function(l){this.view().tabContent.splice(l,1);if(!this.batchChangeMode){this.view().layoutButtonContainer()}},getTabs:function(){return this.view().tabContent.slice(0)},willPush:function($super,l){$super(l);this._vtabAdjustFrame();var m;if(this.curSelectedTab&&(m=this._tabPairForTabView(this.curSelectedTab))){m.contentView.controller.willActivateTab()}},didPush:function($super,l){$super(l);var m;if(this.curSelectedTab&&(m=this._tabPairForTabView(this.curSelectedTab))){m.contentView.controller.didActivateTab()}},willReshow:function($super,l){$super(l);this._vtabAdjustFrame();var m;if(this.curSelectedTab&&(m=this._tabPairForTabView(this.curSelectedTab))){m.contentView.controller.willActivateTab()}},didReshow:function($super,l){$super(l);this.view().layoutSubviews();var m;NgLogD("About to reshow content controller");if(this.curSelectedTab&&(m=this._tabPairForTabView(this.curSelectedTab))){m.contentView.controller.didActivateTab()}else{NgLogD("Not showing content controller")}},willPop:function($super,l){$super(l);var m;if(this.curSelectedTab&&(m=this._tabPairForTabView(this.curSelectedTab))){m.contentView.controller.willDeactivateTab()}},didPop:function($super,l){$super(l);var m;if(this.curSelectedTab&&(m=this._tabPairForTabView(this.curSelectedTab))){m.contentView.controller.didDeactivateTab()}},willHide:function($super,l){$super(l);var m;if(this.curSelectedTab&&(m=this._tabPairForTabView(this.curSelectedTab))){m.contentView.controller.willDeactivateTab()}},didHide:function($super,l){$super(l);var m;if(this.curSelectedTab&&(m=this._tabPairForTabView(this.curSelectedTab))){m.contentView.controller.didDeactivateTab()}},_vtabAdjustFrame:function(){var l=new a(this.navController.view().getFrame());if(l.isEmpty()){this.loge("unrecoverable frame error in adjustFrame");return}this.view().setFrame(l)}})}};__ngs._36={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=new (__ngs.r_(__ngs._f).RequireLoader)({GSGlobals:function(){return __ngs.r_(__ngs._54)},PlusRequest:function(){return __ngs.r_(__ngs._28).PlusRequest},OpenSocial:function(){return __ngs.r_(__ngs._56).OpenSocial}});b.Reward={_getActiveCampaigns:function(e){var d=new a.PlusRequest();d.setApiMethod("rewards/campaigns?exclude_offline=1");d.setHttpMethod("GET");d.send(function(h,k,m,f){var g=a.OpenSocial.populateErrors(h,k,m,f);var l=null;var j=f-f%100;if(j==200){l=k}e(l)})},getActiveCampaigns:function(d){this._getActiveCampaigns(function(e){a.GSGlobals.getRouterInstance().sendCommandToGame({callbackId:d.callbackId,error:parsed.error,callbackData:e})})},redeem:function(e){var f=e.id;var d=new a.PlusRequest();d.setApiMethod("rewards/codes/redeem/"+f);d.setHttpMethod("POST");d.send(function(k,m,n,g){var h=a.OpenSocial.populateErrors(k,m,n,g);var j=null;var l=g-g%100;if(l==200){j=m}a.GSGlobals.getRouterInstance().sendCommandToGame({callbackId:e.callbackId,error:h.error,callbackData:j})})}}}};__ngs._37={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Bank=__ngs.r_(__ngs._3n).Banking}};__ngs._38={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var a=__ngs.r_(__ngs._54);var c=__ngs.r_(__ngs._61).DonkeyRequest;var e=__ngs.r_(__ngs._56).OpenSocial;b.Appdata={getEntries:function(h){var g=new c("opensocial/appdata/@me/@self/@app","GET");var f=h.keys;if(f&&f.length>0){g.setQueryParams({fields:f.join(",")})}g.send(function(m,o,p,k){var l=e.populateErrors(m,o,p,k);var j=null;if(k===200){var n=e.keys(o.entry)[0];j=o.entry[n]}a.getRouterInstance().sendCommandToGame({callbackId:h.callbackId,error:l.error,callbackData:j})})},updateEntries:function(h){var f=h.entries;var g=new c("opensocial/appdata/@me/@self/@app","POST");g.setHttpHeaders({"Content-Type":"application/json"});if(f){g.setQueryParams({fields:e.keys(f).join(",")});g.setPostBody(JSON.stringify(f))}g.send(function(l,m,o,j){var k=e.populateErrors(l,m,o,j);var n=null;if((j===201)&&(typeof f==="object")){n=e.keys(f)}else{if(j===201){n=[]}}a.getRouterInstance().sendCommandToGame({callbackId:h.callbackId,error:k.error,callbackData:n})})},deleteEntries:function(h){var g=h.keys;var f=new c("opensocial/appdata/@me/@self/@app","DELETE");if(g&&g.length>0){f.setQueryParams({fields:g.join(",")})}else{a.getRouterInstance().sendCommandToGame({callbackId:h.callbackId,error:"Keys to delete are a required parameter",callbackData:null})}f.send(function(l,m,o,j){var k=e.populateErrors(l,m,o,j);var n=null;if(j===202){n=g}a.getRouterInstance().sendCommandToGame({callbackId:h.callbackId,error:k.error,callbackData:n})})}}}};__ngs._39={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var a=__ngs.r_(__ngs._54);var c=__ngs.r_(__ngs._61).DonkeyRequest;b.Auth={authorizeToken:function(h){var f=h.token;var e="oauth/authorize";var g=new c(e,"POST");g.setPostBody({authorize:1,oauth_token:f});g.send(function(k,l,m,j){if(!l||!l.success){NgLogD("DATA: "+JSON.stringify(l));NgLogD("ERRO: "+JSON.stringify(k))}a.getRouterInstance().sendCommandToGame({callbackId:h.callbackId,error:k,callbackData:l&&l.success?l.oauth_verifier:false})})}}}};__ngs._3a={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var a=__ngs.r_(__ngs._54);var f=__ngs.r_(__ngs._28);var c=__ngs.r_(__ngs._61).DonkeyRequest;var e=__ngs.r_(__ngs._56).OpenSocial;b.Blacklist={checkBlacklist:function(m){var k=m.userId;var h=m.targetUserId;var j=m.opt;var n={};var g="opensocial/blacklist/"+k+"/@all";if(h){g+="/"+h}else{if(j&&j.count){n.count=j.count}if(j&&j.start){n.startIndex=j.start}}var l=new c(g,"GET");if(e.keys(n).length>0){l.setQueryParams(n)}l.send(function(r,s,u,p){var q={error:null};var t=[];var o={total:0,start:1,count:0};if(p===404){r=null}else{q=e.populateErrors(r,s,u,p);t=e.stripBlacklist(q.data);o={total:s.totalResults||t.length,start:s.startIndex||1,count:s.itemsPerPage||t.length}}a.getRouterInstance().sendCommandToGame({callbackId:m.callbackId,error:q.error,callbackData:{users:t,result:o}})})},isBlockedUser:function(k,j,g){var h="opensocial/blacklist/"+k+"/@all/"+j;var l=new c(h,"GET");l.send(function(o,p,r,m){var n={error:null};var q=[];if(m===404){g(o,false)}else{n=e.populateErrors(o,p,r,m);q=e.stripBlacklist(n.data);g(undefined,q.length>0)}})}}}};__ngs._3b={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._o).Session;a.Config={getServerEnvironment:function(){var e=c.getCurrentSession();if(!e){return"unknown"}var d=c.getCurrentSession().serverMode();if(d==c.serverModes.production){return"production"}else{if(d==c.serverModes.sandbox){return"sandbox"}else{return"unknown"}}}}}};__ngs._3c={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._54);var e=__ngs.r_(__ngs._28);var d=__ngs.r_(__ngs._56).OpenSocial;b.People={getUser:function(j){var h=new e.PlusRequest();var g=j.userId;h.setApiMethod("opensocial/people/"+g+"/@self");h.setHttpMethod("GET");var f=d.populatePeopleFields(j.fields);h.setPostBody({fields:f.join(",")});h.send(function(n,o,p,k){var m=d.populateErrors(n,o,p,k);var l=null;if(k===200){l=o}a.getRouterInstance().sendCommandToGame({callbackId:j.callbackId,error:m.error,callbackData:l})})},getUsers:function(q){var k=new e.PlusRequest();var f=[];var g=q.userIds;k.setHttpMethod("GET");var n=d.populatePeopleFields(q.fields);k.setPostBody({fields:n.join(",")});var m=g.length;if(m>25){m=25}var j=null;var p=null;var h=m;var o=null;for(var l=0;l<m;l++){o=g[l];k.setApiMethod("opensocial/people/"+o+"/@self");var r=null;k.send(function(u,v,w,s){h--;var t=null;r=d.populateErrors(u,v,w,s);if(r.error){p=r.error}if(s===200){t=v;f.push(t)}if(h===0){a.getRouterInstance().sendCommandToGame({callbackId:q.callbackId,error:p,callbackData:{users:f,results:null}})}})}},getCurrentUser:function(h){var g=new e.PlusRequest();g.setApiMethod("opensocial/people/@me/@self");g.setHttpMethod("GET");var f=d.populatePeopleFields(h.fields);g.setPostBody({fields:f.join(",")});g.send(function(m,n,o,j){var l=d.populateErrors(m,n,o,j);var k=null;if(j===200){k=n}a.getRouterInstance().sendCommandToGame({callbackId:h.callbackId,error:l.error,callbackData:k})})},getFriends:function(k){var j=new e.PlusRequest();var h=k.userId;var m=null;j.setApiMethod("opensocial/people/"+h+"/@friends");j.setHttpMethod("GET");var f=d.populatePeopleFields(k.fields);var g=k.opt;var l={};if(f&&f.length>0){l.fields=f.join(",")}if(g&&g.count){l.count=g.count}if(g&&g.start){l.startIndex=g.start}if(d.keys(l).length>0){j.setPostBody(l)}j.send(function(q,r,s,o){var p=d.populateErrors(q,r,s,o);var n=null;if(o===200){m=r.entry;n={total:r.totalResults,start:r.startIndex,count:r.itemsPerPage}}a.getRouterInstance().sendCommandToGame({callbackId:k.callbackId,error:p.error,callbackData:{users:m,result:n}})})},getFriendsWithGame:function(k){var j=new e.PlusRequest();var h=k.userId;j.setApiMethod("opensocial/people/"+h+"/@friends");j.setHttpMethod("GET");var f=d.populatePeopleFields(k.fields);var g=k.opt;var l=l={filterBy:"hasApp",filterOp:"equals",filterValue:"true"};if(f&&f.length>0){l.fields=f.join(",")}if(g&&g.count){l.count=g.count}if(g&&g.start){l.startIndex=g.start}j.setPostBody(l);j.send(function(p,q,r,n){var s=null;var m=null;var o=d.populateErrors(p,q,r,n);if(n===200){s=q.entry;m={total:q.totalResults,start:q.startIndex,count:q.itemsPerPage}}a.getRouterInstance().sendCommandToGame({callbackId:k.callbackId,error:o.error,callbackData:{users:s,result:m}})})}}}};__ngs._3d={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._54);var e=__ngs.r_(__ngs._28);var d=__ngs.r_(__ngs._56).OpenSocial;b.Profanity={checkProfanity:function(g){var f=new e.PlusRequest();f.setApiMethod("opensocial/ngword");f.setHttpMethod("GET");var h=g.text;f.setPostBody({data:h});f.send(function(m,o,p,j){var n=null;var k=d.populateErrors(m,o,p,j);if(j===200){n=o.valid}var l=n;a.getRouterInstance().sendCommandToGame({callbackId:g.callbackId,error:k.error,callbackData:{profanity:l}})})}}}};__ngs._3e={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var a=__ngs.r_(__ngs._54);var c=__ngs.r_(__ngs._28);var e=__ngs.r_(__ngs._56).OpenSocial;b.Leaderboard={getLeaderboard:function(f){f.leaderboardIds=[f.leaderboardIds];f.method="getLeaderboard";b.Leaderboard.getLeaderboards(f)},getLeaderboards:function(j){var h=j.leaderboardIds;if(typeof h==="undefined"){h=""}else{if(h&&typeof h!="string"){h=h.join(",");h="/"+h}}var f=j.fields;var g=new c.PlusRequest();g.setApiMethod("opensocial/leaderboards/@app"+h);g.setHttpMethod("GET");if(f&&f.length>0){g.setPostBody({fields:f.join(",")})}g.send(function(m,o,p,k){var l=e.populateErrors(m,o,p,k);var n=null;if(k==200){if(j.method=="getLeaderboard"){n=o}else{n=o.entry||[o]}}a.getRouterInstance().sendCommandToGame({callbackId:j.callbackId,error:l.error,callbackData:n})})},getAllLeaderboards:function(f){b.Leaderboard.getLeaderboards(f)},getTopScoresList:function(l){var k=l.leaderboardIds;var f=l.fields;var j=l.opts;var g;if(!k){g={errorCode:400,description:"leaderboard ID must be present"}}if(j&&typeof j!="object"){g={errorCode:400,description:"If request opts are supplied, they must be encapsulated in an Object"}}if(g){a.getRouterInstance().sendCommandToGame({callbackId:l.callbackId,error:g,callbackData:null})}else{var m={sortBy:"rank",sortOrder:"ascending",count:50,startIndex:1};if(f&&f.length>0){m.fields=f.join(",")}if(j){if(j.count){m.count=j.count}if(j.startIndex){m.startIndex=j.startIndex}if(j.sortBy){m.sortBy=j.sortBy}if(j.sortOrder){m.sortOrder=j.sortOrder}}var h=new c.PlusRequest();h.setApiMethod("opensocial/leaderboards/@app/"+k+"/@me/@all");h.setHttpMethod("GET");h.setPostBody(m);h.send(function(p,q,s,n){var o=e.populateErrors(p,q,s,n);var r=null;if(n==200){r=q.entry||[q]}a.getRouterInstance().sendCommandToGame({callbackId:l.callbackId,error:o.error,callbackData:r})})}},getFriendsScoresList:function(m){var l=m.leaderboardIds;var h=m.userId;var f=m.fields;var k=m.opts;var g;if(!l){g={errorCode:400,description:"Leaderboard ID must be present"}}if(!h){g={errorCode:400,description:"User ID must be a non-null string"}}if(k&&typeof k!="object"){g={errorCode:400,description:"If request opts are supplied, they must be encapsulated in an Object"}}if(g){a.getRouterInstance().sendCommandToGame({callbackId:m.callbackId,error:g,callbackData:null})}else{var n={sortBy:"rank",sortOrder:"ascending",count:50,startIndex:1};if(f&&f.length>0){n.fields=f.join(",")}if(k){if(k.count){n.count=k.count}if(k.startIndex){n.startIndex=k.startIndex}if(k.sortBy){n.sortBy=k.sortBy}if(k.sortOrder){n.sortOrder=k.sortOrder}}var j=new c.PlusRequest();j.setApiMethod("opensocial/leaderboards/@app/"+l+"/@me/@friends");j.setHttpMethod("GET");j.setPostBody(n);j.send(function(q,r,t,o){var p=e.populateErrors(q,r,t,o);var s=null;if(o==200){s=r.entry||[r]}a.getRouterInstance().sendCommandToGame({callbackId:m.callbackId,error:p.error,callbackData:s})})}},getScore:function(l){var k=l.leaderboardIds;var h=l.userId;var f=l.fields;var g;if(!k){g={errorCode:400,description:"Leaderboard ID must be present"}}if(!h){g={errorCode:400,description:"User ID must be a non-null string"}}if(g){a.getRouterInstance().sendCommandToGame({callbackId:l.callbackId,error:g,callbackData:null})}else{var j=new c.PlusRequest();j.setApiMethod("opensocial/leaderboards/@app/"+k+"/"+h+"/@self");j.setHttpMethod("GET");if(f&&f.length>0){j.setPostBody({fields:f.join(",")})}j.send(function(o,p,r,m){var n=e.populateErrors(o,p,r,m);var q=null;if(m==200){q=p}a.getRouterInstance().sendCommandToGame({callbackId:l.callbackId,error:n.error,callbackData:q})})}},updateCurrentUserScore:function(k){var g=k.leaderboardId;var j=k.value;var f;if(!g){f={errorCode:400,description:"Leaderboard ID must be present"}}if(f){a.getRouterInstance().sendCommandToGame({callbackId:k.callbackId,error:f,callbackData:null})}else{var h=new c.PlusRequest();h.setApiMethod("opensocial/leaderboards/@app/"+g+"/@me/@self?fields=value");h.setHttpMethod("PUT");h.setPostBody({value:j});h.send(function(n,o,q,l){var m=e.populateErrors(n,o,q,l);var p=null;if(l==202){p=o}a.getRouterInstance().sendCommandToGame({callbackId:k.callbackId,error:m.error,callbackData:p})})}},deleteCurrentUserScore:function(j){var h=j.leaderboardIds;var f;if(!h){f={errorCode:400,description:"Leaderboard ID must be present"}}if(f){a.getRouterInstance().sendCommandToGame({callbackId:j.callbackId,error:f,callbackData:null})}else{var g=new c.PlusRequest();g.setApiMethod("opensocial/leaderboards/@app/"+h+"/@me/@self");g.setHttpMethod("DELETE");g.send(function(m,n,o,k){var l=e.populateErrors(m,n,o,k);a.getRouterInstance().sendCommandToGame({callbackId:j.callbackId,error:l.error,callbackData:null})})}}}}};__ngs._3f={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var a=__ngs.r_(__ngs._54);var c=__ngs.r_(__ngs._28);var e=__ngs.r_(__ngs._56).OpenSocial;b.RemoteNotification={send:function(j){var h=j.recipientId;var k=j.payload;var f;if(!h){f={errorCode:400,description:"recipient ID must be present"}}if(!k){f={errorCode:400,description:"supplied payload must be an Object"}}if(f){a.getRouterInstance().sendCommandToGame({callbackId:j.callbackId,error:f,callbackData:null})}else{var g=new c.PlusRequest();g.setApiMethod("opensocial/remote_notification/@app/@all/"+h);g.setHttpMethod("POST");NgLogD("payload"+JSON.stringify(k));g.setPostBody({payload:JSON.stringify(k)});g.send(function(n,o,q,l){var m=e.populateErrors(n,o,q,l);var p=null;if(l==201){p=o}a.getRouterInstance().sendCommandToGame({callbackId:j.callbackId,error:m.error,callbackData:p})})}},getRemoteNotificationsEnabled:function(g){var f=new c.PlusRequest();f.setApiMethod("opensocial/remote_notification/@me/@self/@app");f.setHttpMethod("GET");f.send(function(k,n,o,h){var j=e.populateErrors(k,n,o,h);var m=false;var l=h-h%100;if(l==200){if(n&&n.enabled){m=!!n.enabled}}a.getRouterInstance().sendCommandToGame({callbackId:g.callbackId,error:j.error,callbackData:m})})},setRemoteNotificationsEnabled:function(h){var f=h.enabled;var g=new c.PlusRequest();g.setApiMethod("opensocial/remote_notification/@me/@self/@app");if(f){g.setHttpMethod("PUT")}else{g.setHttpMethod("DELETE")}g.send(function(l,m,n,j){var k=e.populateErrors(l,m,n,j);a.getRouterInstance().sendCommandToGame({callbackId:h.callbackId,error:k.error,callbackData:f})})}}}};__ngs._3g={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b}};__ngs._3h={_c:null,_d:function(){var d={exports:{}};var f=d.exports;this._c=d;var j=__ngs.r_(__ngs._62);var l=__ngs.r_(__ngs._54);var k=__ngs.r_(__ngs._5).Core;var n=__ngs.r_(__ngs._5x);var a=k;var b=__ngs.r_(__ngs._o);var e=__ngs.r_(__ngs._2f);var c=__ngs.r_(__ngs._2j).Logger;var h=f.DMLogD=function(o){if(c.shouldLog(null,"DataModel")){var p=Array.prototype.slice.call(arguments);p.unshift("DataModel: ");c.debug.apply(c,p)}};var g=f.DMLogE=function(o){var p=Array.prototype.slice.call(arguments);p.unshift("DataModel: ");c.error.apply(c,p)};var m=f.DataModel=a.MessageEmitter.subclass({initialize:function(o){this.recordID=o;this.entityTag=null;this._cache()},beginChanges:function(){e.Dispatcher.beginBatching()},endChanges:function(){e.Dispatcher.endBatching()},is:function(o){if(o&&o.classname&&o.recordID){return((o.classname===this.classname)&&(o.recordID===this.recordID))}return false},_cache:function(){if(!this._dataCache){var p=b.Session.getCurrentSession();if(p){var o=p.dataCache();if(o){o.addObject(this);this._dataCache=o}}}return this._dataCache},_classname:function(){var o=this.classname;return o},$_serializedDataModel:function(o){if(o instanceof (m)){o={classname:o.classname,recordID:o.recordID}}return o},$_deserializedDataModel:function(s,q){if(s&&s.hasOwnProperty&&s.hasOwnProperty("classname")&&s.hasOwnProperty("recordID")){var p=s.classname;var t=n.Social.US[p];var o=s.recordID;if(t&&o){var r=q.getObjectWithRecordID(p,o);if(!r){r=new t(o)}r._deserializeFromHash(s.data);q.addObject(r);s=r}}return s},_serializedHash:function(){var u=this.constructor;var t={classname:u.classname,recordID:this.recordID};t.data={};var r=this.constructor._serializableProperties||[];for(var o=0;o<r.length;o++){var q=r[o];var p=this[q];if(p instanceof (Array)){for(var s=0;s<p.length;s++){p[s]=m._serializedDataModel(p[s])}}else{p=m._serializedDataModel(p)}t.data[q]=p}h("Serialized from privileged!");if(this.entityTag){t._entityTag=this.entityTag}return t},_deserializeFromHash:function(r){if(!r){return}this.beginChanges();this.entityTag=r._entityTag;var o=this._cache();for(var p in r){var q=r[p];if(q instanceof (Array)){for(var s=0;s<q.length;s++){q[s]=m._deserializedDataModel(q[s],o)}}else{q=m._deserializedDataModel(q,o)}this[p]=q}this.endChanges()}});m.defineSetterCallbacks=function(r,q){for(var o=0;o<q.length;o++){var p=q[o];(function(s){r.prototype.__defineSetter__(s,function(t){this["___"+s]=t;var u={};u[""+s]=t;this.emit(u);e.Dispatcher.sendObject(this)});r.prototype.__defineGetter__(s,function(t){return this["___"+s]})})(p)}r._serializableProperties=q}}};__ngs._3i={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=__ngs.r_(__ngs._3h);var f=__ngs.r_(__ngs._28);var e=__ngs.r_(__ngs._o).Session;var a=b.DataModel.subclass({classname:"AppData"});b.DataModel.defineSetterCallbacks(a,["data","key","user","permissions"]);a.getKeysForUser=function(h,g){g=g||f.PlusRequest.noOp;if(!h){g("No user",null);return null}var j=new f.PlusRequest();j.setApiMethod("users/"+h.recordID+"/user_data");j.setHttpMethod("GET");j.send(function(k,l){if(l&&(l.success===true)&&(l.datas!=undefined)){g(k,l.datas)}else{g(k,null)}});return j};a.getAppDataWithData=function(j,l,h){if(!j){NgLogD("AppData.getAppDataWithData: No user");return null}if(!l){NgLogD("AppData.getAppDataWithData: No key");return null}var k=j.recordID+"--"+l;var g=e.getCurrentSession().dataCache().getObjectWithRecordID(a.classname,k);if(g!==null){return g}var m=new a(k);m.user=j;m.key=l;m.data=h;return m};a.getDataForUserWithKey=function(k,m,g){g=g||f.PlusRequest.noOp;if(!k){g("No user",null);return null}if(!m){g("No key",null);return null}var l=k.recordID+"--"+m;var j=e.getCurrentSession().dataCache();var o=j.getObjectWithRecordID("AppData",l);var h=(o?o.entityTag:null);var n=new f.PlusRequest();n.setApiMethod("users/"+k.recordID+"/user_data/"+m);n.setHttpMethod("GET");n.setHttpHeaders({Accept:"application/octet-stream"});n.setEntityTag(h);n.send(function(r,p,t,q){if(r){if(q===404){r="Sorry, we can't find this player's data."}g(r,null)}else{if(p){var s=a.getAppDataWithData(k,m,p);s.permissions=p.privacy;s.entityTag=t.etag;s.data=p;g(null,s)}else{if(q==304&&o){g(null,o)}else{g("unknown error",null)}}}});return n};a.setDataForUserWithKeyAndPermissions=function(m,h,j,k,g){g=g||f.PlusRequest.noOp;if(!h){g("No user",null);return null}if(!j){g("No key",null);return null}if(!k){k=a.Permissions.Private}var l=new f.PlusRequest();l.setApiMethod("users/"+h.recordID+"/user_data");l.setHttpMethod("POST");l.setPostBody({key:j,privacy:k});l.addAttachmentWithNameAndFilenameOfType(m,"value","value",null);l.send(function(q,o,r,p){if(o&&o.success===true){var n=a.getAppDataWithData(h,j,m);g(null,n)}else{g(q,null)}});return l};a.Permissions={Private:0,FriendsReadOnly:1,PublicReadOnly:2};c.AppData=a}};__ngs._3j={_c:null,_d:function(){var c={exports:{}};var f=c.exports;this._c=c;var g=__ngs.r_(__ngs._28).PlusRequest;var b=__ngs.r_(__ngs._o);var l=__ngs.r_(__ngs._3h).DataModel;var j=__ngs.r_(__ngs._30).User;var a=__ngs.r_(__ngs._3l).Score;var d=__ngs.r_(__ngs._2e).Game;var h=__ngs.r_(__ngs._63).ScoresList;var e=__ngs.r_(__ngs._2z).Assets;var k=f.Leaderboard=l.subclass({classname:"Leaderboard",initialize:function($super,m,n){$super(m);this._loadData(n)},_loadData:function(m){this.beginChanges();this.level=m.level||this.level||0;this.title=m.title||this.title||null;this.iconURL=m.icon_url||this.iconURL||null;this.game=m.game||this.game;if(m&&m.score){this.gamertag=m.score.gamertag||this.gamertag||null;this.badgeId=m.score.badge_id||this.badgeId||null;this.userId=m.score.userId||this.userId||null}else{this.gamertag=this.gamertag||null;this.badgeId=this.badgeId||null;this.userId=this.userId||null}this.endChanges()},getDefinedIcon:function(){return this.iconURL||this.game.iconURL||e.image("no-user-icon.png")},submitScoreWithPoints:function(q,n){n=n||g.noOp;if(!q&&q!==0){n("No points",null);return null}var m=this;var o=b.Session.getCurrentSession().user();var r=new g();r.setApiMethod("games/"+this.game.recordID+"/leaderboards/"+this.level+"/scores");r.setHttpMethod("POST");var p={score:q};p[j.GamertagKey]=o.gamertag;r.setPostBody(p);r.send(function(s,t){if(!s&&t&&t.success===true){var u=a.getScoreWithDataAndLeaderboard(t,m);n(s,u)}else{n(s,null)}});return r},getTopScores:function(n,o,m){this.getScoresWithBody(undefined,undefined,n,o,{},m)},getFriendsScores:function(n,o,m){this.getScoresWithBody(undefined,undefined,n,o,{relation:"friends"},m)},getTopScoresList:function(){if(!this._topScoresList){NgLogD("Getting Top Scores List "+this+" "+this.game);this._topScoresList=new h(this,null,false)}return this._topScoresList},getFriendsScoresList:function(){if(!this._friendsScoresList){this._friendsScoresList=new h(this,null,true)}return this._friendsScoresList},getScoresWithBody:function(r,u,o,q,s,n){n=n||g.noOp;var v=this;if(!r){r=b.Session.getCurrentSession().user()}if(!u){u=this.game}if(!s){s={}}if(!o){o=100}if(!q){q=0}var m={};for(var t in s){m[t]=s[t]}var p=new g();p.setApiMethod("games/"+u.recordID+"/leaderboards/"+this.level+".json");p.setHttpMethod("GET");p.setPostBody(m);p.setEntityTag(this.entityTag);p.send(function(A,C,x,B){if(!A){var F={};var z=[];var G=null;if(B==304){F=v.scoreInfo}else{if(C&&C.success===true){v.beginChanges();var D=C.leaderboard;for(var E=0;E<D.length;E++){var w=D[E];var y=a.getScoreWithDataAndLeaderboard(w,v);z.push(y)}v.entityTag=x.etag||v.entityTag;G=(C.user_score?new a(C.user_score,v):undefined);F.leaderboard=v;F.userScore=G;F.scores=z;v.scoreInfo=F;v.endChanges()}}n(A,z,G,v)}else{NgLogD("Error getting scores: "+A);n(A,null,null,v)}})}});l.defineSetterCallbacks(k,["level","title","game","iconURL"]);k.getLeaderboardWithData=function(p){var o="Leaderboard-"+p.game.recordID+"-"+p.level;var n=b.Session.getCurrentSession().dataCache().getObjectWithRecordID(k.classname,o);if(n!==null){n._loadData(p);return n}var m=new k(o,p);return m};k.getLeaderboards=function(m){m=m||g.noOp;d.getCurrentGame(function(p,n){if(p){m(p);return}var o=new g();o.setApiMethod("games/"+n.recordID+"/leaderboards.json?top_player=true");o.setHttpMethod("GET");o.send(function(t,u){var w=null;if(!t&&u&&u.success){w=[];var v=u.leaderboards;for(var r=0;r<v.length;r++){var s=v[r];s.game=n;var q=k.getLeaderboardWithData(s);w.push(q)}m(t,w);return}if(!t){t=u.error}if(!t){t="unknown error"}m(t,w)})})};k.getLeaderboardScores=function(o,r,p,m){m=m||g.noOp;this.index=o;var n=this;var q=100;d.getCurrentGame(function(u,s){if(u){m(u);return}var t=new g();var v="";if(p){v="games/"+s.recordID+"/leaderboards/"+n.index+".json?relation=friend&count="+q+"&offset="+r}else{v="games/"+s.recordID+"/leaderboards/"+n.index+".json?count="+q+"&offset="+r}t.setApiMethod(v);t.setHttpMethod("GET");t.send(function(z,A){var C=null;if(!z&&A&&A.success){C=[];var B=A.leaderboard;var x=A.user_score||null;for(var w=0;w<B.length;w++){var y=B[w];y.game=s;C.push(y)}m(z,C,x,A.title);return}if(!z){z=A.error}if(!z){z="unknown error"}m(z,C,x)})})}}};__ngs._3k={_c:null,_d:function(){var f={exports:{}};var c=f.exports;this._c=f;var e=__ngs.r_(__ngs._28).PlusRequest;var a=__ngs.r_(__ngs._o);var b=__ngs.r_(__ngs._3h);var d=c.Achievement=b.DataModel.subclass({classname:"Achievement",initialize:function($super,g,h){$super(g);this._loadData(h)},_loadData:function(g){this.beginChanges();this.description=g.description||this.description||null;this.points=g.points||this.points||0;this.category=g.category||this.category||null;this.unlocked=g.unlocked||this.unlocked||false;this.name=g.name||this.name||null;this.index=g.index||this.index||-1;this.icon_url=g.icon_url||this.icon_url||null;this.endChanges()},unlockAchievement:function(g){g=g||e.noOp;var j=a.Session.getCurrentSession();if(j&&j.user()){var h=new e();h.setHttpMethod("POST");h.setApiMethod("users/"+j.user().recordID+"/achievements");h.setPostBody({index:this.index});h.send(g)}},$getAchievementWithData:function(k,m){var l=k+"-"+m.index;var j=a.Session.getCurrentSession().dataCache();var h=j.getObjectWithRecordID(d.classname,l);if(h!==null){h._loadData(m);return h}var g=new d(l,m);h=j.addObject(g);return h}});b.DataModel.defineSetterCallbacks(d,["description","points","category","unlocked","name","index","icon_url"])}};__ngs._3l={_c:null,_d:function(){var d={exports:{}};var a=d.exports;this._c=d;var c=__ngs.r_(__ngs._3h).DataModel;var f=__ngs.r_(__ngs._30).User;var e=__ngs.r_(__ngs._o);var b=a.Score=c.subclass({classname:"Score",initialize:function($super,j,g){var h=g.game.recordID+"-"+g.recordID+"-"+j.gamertag;$super(h);this._loadData(j,g)},_loadData:function(k,h){this.beginChanges();k=k||{};var g={user_id:k.user_id,gamertag:k.gamertag,badge_id:k.badge_id};var j=f.getUserWithData(g);this.user=j;this.points=k.score;this.displayScore=k.formatted_score||this.score;this.rank=k.rank;this.level=k.level;this.endChanges()}});c.defineSetterCallbacks(b,["points","displayScore","rank","level","user"]);b.getScoreWithDataAndLeaderboard=function(k,g){var j=g.game.recordID+"-"+g.recordID+"-"+k.gamertag;var h=e.Session.getCurrentSession().dataCache();var m=h.getObjectWithRecordID(b.classname,j);if(m!==null){m._loadData(k,g);return m}var l=new b(k,g);m=h.addObject(l);return m}}};__ngs._3m={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=new (__ngs.r_(__ngs._f).RequireLoader)({DataModel:function(){return __ngs.r_(__ngs._3h).DataModel},User:function(){return __ngs.r_(__ngs._30).User},Session:function(){return __ngs.r_(__ngs._o).Session},UI:function(){return __ngs.r_(__ngs._59).UI},FullGamercardController:function(){return __ngs.r_(__ngs._64).FullGamercardController},GamercardExtras:function(){return __ngs.r_(__ngs._65).Gamercard.extras}});var a=b.DataModel.subclass({classname:"FullGamercard",_controller:null,initialize:function($super){$super("FullGamercard-xyzzy");this._controller=new b.FullGamercardController();this.visible=false;this._controller.setOnClose(this.hide.bind(this))},destroy:function(){this._controller=null},show:function(){if(!this._controller.getUser()){throw new Error("No valid user was set for the gamercard.")}this._controller.show();this.visible=true},hide:function(){this._controller.hide();this.visible=false},set:function(h,j,k){j=typeof j=="function"?j:function(){};k=typeof k=="function"?k:function(){};var e=function(l){this.hide();k(l)}.bind(this);var g=null;if(h.hasOwnProperty("user")){var f=h.user;delete h.user;this._loadUser(f,function(m,l){if(!m){h.user=l}this._controller.set(h,e);this._controller.reset();j(m)}.bind(this))}else{this._controller.set(h,e);this._controller.reset();j(null)}},$_loadUser:function(f,e){var j=true;var h=function(k){b.User.getUserWithGamertag(k,function(l,m){if(l){e("Unable to get user "+k+". ["+l+"]",null)}else{e(null,m)}}.bind(this))};if(typeof f=="string"){h(f)}else{if(f.hasOwnProperty("recordID")&&typeof f.recordID=="number"){f.user_id=f.recordID;var g=b.User.getUserWithData(f);if(!g.entityTag){if(f.hasOwnProperty("gamertag")){h(f.gamertag)}else{e("Invalid user object.",null)}}else{e(null,g)}}else{e("Invalid user object.",null)}}}});b.DataModel.defineSetterCallbacks(a,["visible"]);a.getFullGamercard=function(e){if(typeof e!="function"){e=function(){}}var f=b.Session.getCurrentSession().dataCache();var g=f.getObjectWithRecordID(a.classname,"FullGamercard-xyzzy");if(!g){g=new a();f.addObject(g)}e(g)};a.getFullGamercardAndSetUser=function(f,e){if(typeof e!="function"){e=function(){}}a.getFullGamercard(function(g){a._loadUser(f,function(j,h){if(j){e(j,null)}else{g._controller.set({user:h},null);e(null,g)}})})};a.getFullGamercardAndSetCurrentUser=function(e){a.getFullGamercardAndSetUser(b.Session.getCurrentSession().user(),e)};c.FullGamercard=a}};__ngs._3n={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=new (__ngs.r_(__ngs._2b).InterfaceLoader)({GSGlobals:function(){return __ngs.r_(__ngs._54)},BankLegacy:["_66",function(d){return d.BankLegacy}],Purchase:["_2y",function(d){return d.Purchase}]});b.Banking={};b.Banking.Legacy={asyncFulfill:function(d){b.Banking.Legacy._asyncFulfillCurrCommand=d;b.Banking.Legacy._asyncFulfillCBList=[];a.loadThenAct("BankLegacy",function(e){e.asyncFulfill(function(j,f,k,g,h){b.Banking.Legacy._asyncFulfillOrderCB(j,f,k,g,h)},function(){b.Banking.Legacy._asyncFulfillDoneCB()})})},launchPurchaseView:function(d){var e=d.data["sku"];a.loadThenAct("BankLegacy",function(f){f.launchPurchaseView(e,function(j,k,l,h,g){if(d.hasOwnProperty("callbackId")){a.GSGlobals.getRouterInstance().sendCommandToGame({callbackId:d.callbackId,callbackData:{itemID:k,orderid:l,receipt:h,jsonorder:g},error:j})}})})},_asyncFulfillContinue:function(f){b.Banking.Legacy._asyncFulfillCurrCommand=f;if(typeof b.Banking.Legacy._asyncFulfillCurrCB=="function"){NgLogD("_asyncFulfillContinue: ordercb invoked.");b.Banking.Legacy._asyncFulfillCurrCB()}var d=b.Banking.Legacy._asyncFulfillCurrCommand;if(d&&d.hasOwnProperty("callbackId")&&(b.Banking.Legacy._asyncFulfillCBList.length>0)){var e=b.Banking.Legacy._asyncFulfillCBList.shift();a.GSGlobals.getRouterInstance().sendCommandToGame(e);b.Banking.Legacy._asyncFulfillCurrCommand=undefined}},_asyncFulfillDoneCB:function(){var e={callbackData:{cbtype:"donecb"},error:undefined};b.Banking.Legacy._asyncFulfillCBList.push(e);var d=b.Banking.Legacy._asyncFulfillCurrCommand;if(d&&d.hasOwnProperty("callbackId")){e=b.Banking.Legacy._asyncFulfillCBList.shift();e.callbackId=d.callbackId;a.GSGlobals.getRouterInstance().sendCommandToGame(e)}else{NgLogW("WARNING - donecb is ignored")}b.Banking.Legacy._asyncFulfillCurrCommand=undefined},_asyncFulfillOrderCB:function(j,d,k,f,h){var g={callbackData:{cbtype:"ordercb",prodId:j,orderId:d,verificationToken:k,jsonorder:f},error:undefined};b.Banking.Legacy._asyncFulfillCBList.push(g);var e=b.Banking.Legacy._asyncFulfillCurrCommand;b.Banking.Legacy._asyncFulfillCurrCB=h;if(e&&e.hasOwnProperty("callbackId")){g=b.Banking.Legacy._asyncFulfillCBList.shift();g.callbackId=e.callbackId;a.GSGlobals.getRouterInstance().sendCommandToGame(g)}else{NgLogW("WARNING - ordercb is ignored for orderId "+d)}b.Banking.Legacy._asyncFulfillCurrCommand=undefined}};b.Banking.Legacy._asyncFulfillCurrCommand=undefined;b.Banking.Legacy._asyncFulfillCurrCB=undefined;b.Banking.Legacy._asyncFulfillCBList=undefined;b.Banking.Purchase={createTransaction:function(d){a.loadThenAct("Purchase",function(e){e.createTxn(d.data["billingItems"],d.data["comment"],function(f,g){if(d.hasOwnProperty("callbackId")){a.GSGlobals.getRouterInstance().sendCommandToGame({callbackId:d.callbackId,callbackData:{transaction:g},error:f})}})})},openTransaction:function(d){a.loadThenAct("Purchase",function(e){e.openTxn(d.data["transactionId"],function(f,g){if(d.hasOwnProperty("callbackId")){a.GSGlobals.getRouterInstance().sendCommandToGame({callbackId:d.callbackId,callbackData:{transaction:g},error:f})}})})},getTransaction:function(d){a.loadThenAct("Purchase",function(e){e.getTxn(d.data["transactionId"],function(f,g){if(d.hasOwnProperty("callbackId")){a.GSGlobals.getRouterInstance().sendCommandToGame({callbackId:d.callbackId,callbackData:{transaction:g},error:f})}})})},continueTransaction:function(d){a.loadThenAct("Purchase",function(e){e.continueTxn(d.data["transactionId"],function(f,g){if(d.hasOwnProperty("callbackId")){a.GSGlobals.getRouterInstance().sendCommandToGame({callbackId:d.callbackId,callbackData:{transaction:g},error:f})}})})},cancelTransaction:function(d){a.loadThenAct("Purchase",function(e){e.cancelTxn(d.data["transactionId"],function(f,g){if(d.hasOwnProperty("callbackId")){a.GSGlobals.getRouterInstance().sendCommandToGame({callbackId:d.callbackId,callbackData:{transaction:g},error:f})}})})},closeTransaction:function(d){a.loadThenAct("Purchase",function(e){e.closeTxn(d.data["transactionId"],function(f,g){if(d.hasOwnProperty("callbackId")){a.GSGlobals.getRouterInstance().sendCommandToGame({callbackId:d.callbackId,callbackData:{transaction:g},error:f})}})})},getPendingTransactions:function(d){a.loadThenAct("Purchase",function(e){e.getOpenTxns(function(f,g){if(d.hasOwnProperty("callbackId")){a.GSGlobals.getRouterInstance().sendCommandToGame({callbackId:d.callbackId,callbackData:{openTransactions:g},error:{error:f}})}})})},getIAPItems:function(d){a.loadThenAct("Purchase",function(e){e.getIAPItems(d.data["itemId"],function(f,g){if(d.hasOwnProperty("callbackId")){a.GSGlobals.getRouterInstance().sendCommandToGame({callbackId:d.callbackId,callbackData:{item:g},error:f})}})})},getItem:function(d){a.loadThenAct("Purchase",function(e){e.getItem(d.data["itemId"],function(f,g){if(d.hasOwnProperty("callbackId")){a.GSGlobals.getRouterInstance().sendCommandToGame({callbackId:d.callbackId,callbackData:{item:g},error:f})}})})}}}};__ngs._3o={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var a=new (__ngs.r_(__ngs._f).RequireLoader)({MessageListener:function(){return __ngs.r_(__ngs._w).MessageListener},Destinations:function(){return __ngs.r_(__ngs._2a).Destinations},FriendpickerViewController:function(){return __ngs.r_(__ngs._67).FriendpickerViewController},GameLaunchedEmitter:function(){return __ngs.r_(__ngs._2g).GameLaunchedEmitter},shouldShowGameRequestedUI:function(){return __ngs.r_(__ngs._68).shouldShowGameRequestedUI},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost}});var b;c.Friends={showFindFriends:function(f){if(!a.shouldShowGameRequestedUI()){NgLogD("Not showing FindFriends because game is button spamming.");return}NgLogD("Showing Find Friends");var e=f.data;if(!e){e={}}a.Destinations.pushScreen(a.ServiceHost.navController,"FindFriends",e,e)},_gameLaunchedListener:null,_friendPicker:null,showFriendPicker:function(e,f){if(!this._gameLaunchedListener){this._gameLaunchedListener=new a.MessageListener();a.GameLaunchedEmitter.addListener(this._gameLaunchedListener,b.bind(this))}b.call(this);this._friendPicker=new a.FriendpickerViewController(e,f,function(g){NgLogD("Privileged sent inviteToGame for friend "+g?g.gamertag:JSON.stringify(g));g.inviteToCurrentGame(function(h,j){NgLogD("Invite to game request sent: "+JSON.stringify(j))})})}};b=function(){NgLogD("FriendPicker Cleanup, possibly on new game launch!");if(this._friendPicker&&!this._friendPicker._destroyed){this._friendPicker.destroy();this._friendPicker=null}}}};__ngs._3p={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=new (__ngs.r_(__ngs._2b).InterfaceLoader)({LeaderboardViewController:["_69",function(d){return d.LeaderboardViewController}]});b.Leaderboards={showLeaderboards:function(){a.loadThenAct("LeaderboardViewController",function(d){this._leaderboards=new d()})}}}};__ngs._3q={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._4p).GameProfile;a.Games={showProfile:function(d){(__ngs.r_(__ngs._2e).Game).getCurrentGame(function(g,e){d.data["game"]=e;var f=c.initWithJSON(d.data);(__ngs.r_(__ngs._2v).ServiceHost).navController.pushViewController(f)})},showCatalog:function(f){var e=f.data;if(!e){e={}}var d=(__ngs.r_(__ngs._4m).Catalog).initWithJSON(e);(__ngs.r_(__ngs._2v).ServiceHost).navController.pushViewController(d)}}}};__ngs._3r={_c:null,_d:function(){var f={exports:{}};var c=f.exports;this._c=f;var b=__ngs.r_(__ngs._2a).Destinations;var a=__ngs.r_(__ngs._2g).GameLaunchedEmitter;var d=__ngs.r_(__ngs._4w).InterstitialSplashScreen;var e=__ngs.r_(__ngs._28).PlusRequest;c.Home={showMobage:function(j){var k=__ngs.r_(__ngs._2v).ServiceHost;NgLogD("Showing Mobage");var g=null;if(j&&j.hasOwnProperty("callbackId")){g=function(){(__ngs.r_(__ngs._54)).getRouterInstance().sendCommandToGame({callbackId:j.callbackId})}}var h=null;h=new d(function(){b.loadThenAct("Home",function(){k.navController.pushViewController(new b.Home(g))})}).retain();h.onDidHide=function(){setTimeout(h.zombieSafeCallback(function(){k.navController.removeViewController(h);h.release()}),10)};k.navController.pushViewController(h,"",function(m){if(m==e.ERROR_NO_CONNECTION){var l=__ngs.r_(__ngs._11).LifecycleEmitter;l.exitProcess()}});a.onGameLaunched()}}}};__ngs._3s={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Destinations:function(){return __ngs.r_(__ngs._2a).Destinations},shouldShowGameRequestedUI:function(){return __ngs.r_(__ngs._68).shouldShowGameRequestedUI},ServiceHost:function(){return __ngs.r_(__ngs._2v).ServiceHost},User:function(){return __ngs.r_(__ngs._30).User},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils}});b.Profile={showUserProfile:function(f){if(!a.shouldShowGameRequestedUI()){NgLogD("Not showing UserProfile because game is button spamming.");return}NgLogD("Showing UserProfile");var e=f.data;var d;if(e&&(e.user)){d=e.user.recordID}else{NgLogE("NOT showing UserProfile, missing user parameter");return}a.User.getUserWithID(d,function(h,g){if(h){NgLogE("NOT showing UserProfile, error getting user object with id: "+d+". Error: "+h);return}var j={user:g,tab:e.tab};a.Destinations.pushScreen(a.ServiceHost.navController,"UserProfilePage",j,j)})},showMyPage:function(e){if(!a.shouldShowGameRequestedUI()){NgLogD("Not showing MyPage because game is button spamming.");return}NgLogD("Showing MyPage");var d=e.data;if(!d){d={}}a.Destinations.pushScreen(a.ServiceHost.navController,"MyPage",d,d)},showAccountSettings:function(d,e){NgLogD("Showing Account Settings -- incomplete")},showUserGamercard:function(d){a.UIUtils.showAlert("Gamercard not implemented yet!")},showMyGamercard:function(){a.UIUtils.showAlert("Gamercard not implemented yet!")}}}};__ngs._3t={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._2r).Credentials;var d=__ngs.r_(__ngs._n).Localization;a.Tests={showPrivilegedToastWithMessage:function(f){NgLogD("Privileged intercepted showPrivilegedToastWithMessage");var g=__ngs.r_(__ngs._59).UI;var e=new g.Toast();e.setText(f.data);e.show();if(f.hasOwnProperty("callbackId")){(__ngs.r_(__ngs._54)).getRouterInstance().sendCommandToGame({callbackId:f.callbackId})}},doGlobalsTest:function(e){GameService_globalsTest_globalVar=e.data;if(e.hasOwnProperty("callbackId")){(__ngs.r_(__ngs._54)).getRouterInstance().sendCommandToGame({callbackId:e.callbackId})}},doWindowExaminationTest:function(e){var f=__ngs.r_(__ngs._59).UI;var g=(f.Window.document._children.length==0);if(e.hasOwnProperty("callbackId")){f.Window.document.addChild(new f.View());(__ngs.r_(__ngs._54)).getRouterInstance().sendCommandToGame({callbackId:e.callbackId,callbackData:{success:g}})}},doSquareViewLayeringTest:function(h){NgLogD("In Privileged Interpreter, creating Views");var f={corners:"8 8 8 8",outerLine:"00 1.5",gradient:["FFFF0000 0.0","FFFF0000 1.0"]};var e={corners:"8 8 8 8",outerLine:"00 1.5",gradient:["FF0000FF 0.0","FF0000FF 1.0"]};var j=__ngs.r_(__ngs._59).UI;var g=new j.View();var k=new j.View();g.setFrame([70,20,100,100]);k.setFrame([150,100,100,100]);g.setGradient(f);k.setGradient(e);j.Window.document.addChild(g,0);j.Window.document.addChild(k,-1);if(h.hasOwnProperty("callbackId")){(__ngs.r_(__ngs._54)).getRouterInstance().sendCommandToGame({callbackId:h.callbackId})}},pushNotifTestPrivSetup:function(g){var j=__ngs.r_(__ngs._59).UI;var f=__ngs.r_(__ngs._4).Device;var e=new Core.MessageListener();e.destroy=function(){f.NotificationEmitter.removeListener(e)};e.onPushRecivedFn=function(m){pushAlert=new j.AlertDialog();pushAlert.setTitle("GameService Push Test: Got Push!");pushAlert.setText(JSON.stringify(m.payload));pushAlert.setChoices(["OK"]);pushAlert.show();return false};f.NotificationEmitter.addListener(e,e.onPushRecivedFn);var l=g.hasOwnProperty("loginUser")?g.loginUser:"mt000";var k=g.hasOwnProperty("loginPw")?g.loginPw:"mt000";var h=g.hasOwnProperty("loginServer")?g.loginServer:"staging";if(g.hasOwnProperty("gameData")){(__ngs.r_(__ngs._28)).PlusRequest.setServerMode(h);(__ngs.r_(__ngs._o).Session).beginGameSessionWithData(g.gameData,function(m,n){n.loginWithUsernameAndPassword(l,k,function(o,p){if(o){NgLogD("pushNotifTestPrivSetup: Failed login! Err: "+o);var r=new j.AlertDialog();r.setTitle("Priv: Failed to log in");r.setText("Err: "+o);r.setChoices(["OK"]);r.show()}else{NgLogD("pushNotifTestPrivSetup: Successful login!");var q=new j.Toast();q.setText("Priv: Logged in as "+l);q.show()}})})}},doShowLoginTest:function(e){NgLogD("Privileged call doShowLoginTest");c.showLogin()},doShowRegistrationTest:function(e){NgLogD("Privileged call doShowRegistrationTest");c.showRegistration()},setupSession:function(f){NgLogD("Privileged Interface setupSession");var e=f.data;(__ngs.r_(__ngs._o).Session).beginGameSessionWithData(e,function(g,h){NgLogD("Began session. "+g+" "+h);(__ngs.r_(__ngs._54)).getRouterInstance().sendCommandToGame({callbackId:f.callbackId})})},bankGetBalance:function(e){NgLogD("Privileged interface bankGetBalance");(__ngs.r_(__ngs._5o).Balance).get(function(h,k,j,g,f){if(e.hasOwnProperty("callbackId")){(__ngs.r_(__ngs._54)).getRouterInstance().sendCommandToGame({callbackId:e.callbackId,callbackData:{success:k,balance:j,currency:g,currencyIconURL:f},error:h})}})},getCreditItems:function(e){(__ngs.r_(__ngs._5p).Transaction).getItems(true,function(g,f){if(e.hasOwnProperty("callbackId")){(__ngs.r_(__ngs._54)).getRouterInstance().sendCommandToGame({callbackId:e.callbackId,callbackData:{items:f},error:g})}})},logMissingLocalizationStrings:function(e){d.printMissingStrings()}}}};__ngs._3u={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=b.GameLaunchPayload={_lastGamePayload:null,onGameLaunchPayload:function(d){a._lastGamePayload=d;var e={apiURL:"US.Service.GameLaunchPayload.onGameLaunchPayload",data:{payload:d}};(__ngs.r_(__ngs._54)).getRouterInstance().sendCommandToGame(e)},getLastPayload:function(d){(__ngs.r_(__ngs._54)).getRouterInstance().sendCommandToGame({callbackId:d.callbackId,error:null,callbackData:{payload:a._lastGamePayload}})}}}};__ngs._3v={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Achievements={showAchievementsScreen:function(d){NgLogD("Privileged - showAchievementsScreen");var c=__ngs.r_(__ngs._6a).AchievementsController;c.showAchievementsScreen()}}}};__ngs._3w={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var c=__ngs.r_(__ngs._12).ObjectRegistry;var b=__ngs.r_(__ngs._t).Class;var f=__ngs.r_(__ngs._6).Proc;var a=d._int_Util=b.singleton({classname:"_int_Util",initialize:function(){this._callbackID=0;this._callbacks=[];this.valid=!Core.Capabilities.meetsBinaryVersion("1.3.5.10");Core.ObjectRegistry.register(this);this._createSendGen(this.__objectRegistryId)},ProcID:{Persist:-1,Game:-2},_classId:350,_signCallbackRecvGen:function(j){if((j.length-j.idx)!==2){NgLogE("Could not parse due to wrong argument count in _int_Util.signCallback from command: "+j);return false}var g=f.parseString(j[j.idx++]);if(g===undefined){NgLogE("Could not parse signature in _int_Util.signCallback from command: "+j);return false}var h=f.parseInt(j[j.idx++]);if(h===undefined){NgLogE("Could not parse callbackID in _int_Util.signCallback from command: "+j);return false}return this._signCallbackRecv(g,h)},$_verifiedRecvGen:function(h){if((h.length-h.idx)!==1){NgLogE("Could not parse due to wrong argument count in _int_Util.verified from command: "+h);return false}var g=f.parseInt(h[h.idx++]);if(g===undefined){NgLogE("Could not parse b in _int_Util.verified from command: "+h);return false}return this._verifiedRecv(g)},$_msgFromBuilderRecvGen:function(h){if((h.length-h.idx)!==1){NgLogE("Could not parse due to wrong argument count in _int_Util.msgFromBuilder from command: "+h);return false}var g=f.parseString(h[h.idx++]);if(g===undefined){NgLogE("Could not parse data in _int_Util.msgFromBuilder from command: "+h);return false}return this._msgFromBuilderRecv(g)},$_createSendGen:function(g){f.appendToCommandString(23003135,[+g])},_destroySendGen:function(){f.appendToCommandString(22937602,this)},_signSendGen:function(h,j,g){f.appendToCommandString(22937603,this,[f.encodeString(h),+j,f.encodeString(g)])},$_adTapjoySendActionCompleteSendGen:function(g){f.appendToCommandString(23003131,[f.encodeString(g)])},$_msgToBuilderSendGen:function(g){f.appendToCommandString(23003129,[f.encodeString(g)])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[350]=this._instance||this;PROC_METHOD_TABLE[22937604]=this.prototype._signCallbackRecvGen;PROC_METHOD_TABLE[23003130]=this.prototype._verifiedRecvGen;PROC_METHOD_TABLE[23003128]=this.prototype._msgFromBuilderRecvGen},$_verifiedRecv:function(g){this.valid=true;if(this._verifiedCallback){this._verifiedCallback()}},sign:function(h,g,j){if(this.valid){this._callbacks[this._callbackID]=j;this._signSendGen(h,this._callbackID++,g)}else{j(false)}},_signCallbackRecv:function(g,j){var h=this._callbacks[parseInt(j)];if(h){h(g)}},signable:function(){return this.valid},registerVerifiedCB:function(g){if(this.valid){g()}else{this._verifiedCallback=g}},$msgToBuilder:function(g,h){h.target=g;this._msgToBuilderSendGen(JSON.stringify(h))},$_msgFromBuilderRecv:function(h){var j=JSON.parse(h);var g=this.builderCom[j.target];if(typeof g=="function"){g(j)}},registerBuilderListener:function(h,g){if(!this.builderCom){this.builderCom={}}this.builderCom[h]=g},$adTapjoySendActionComplete:function(g){console.log("_int_Util.adTapjoysendActionComplete: "+g);this._adTapjoySendActionCompleteSendGen(g)}})}};__ngs._3x={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var f=__ngs.r_(__ngs._6).Proc;var a=__ngs.r_(__ngs._t).Class;var c=__ngs.r_(__ngs._7).Capabilities;var e=64*1024;b.Socket=a.subclass({classname:"Socket",initialize:function(j,h){this._protocol=(j===undefined)?this.Protocol.TCP4:j;this._security=(h===undefined)?this.Security.SecNone:h;this._isStream=(this._protocol!=this.Protocol.UDP4);this._isServer=false;this._state=this.State.CLOSED;this._maxSndBufSize=e;this._curSndBufSize=0;this._rcvBuf="";this._rcvBufInfo=[];this._EOS=false;this._localAddr=null;this._peerAddr=null;this._nextCbId=1;this._pendingChildren=[];this._cb={};this._onReadable=null;this._onWritable=null;this._onError=null;this._storeCb=function(k){var l=-1;if(k){l=this._nextCbId++;this._cb[l]=k?k:function(){}}return l};this._restoreCb=function(l){var k=this._cb[l];delete this._cb[l];return k};if(this._parentId===undefined||this._childId===undefined){this._parentId=-1;this._childId=-1}else{this._state=this.State.READY;this._isServer=true}var g=__ngs.r_(__ngs._12).ObjectRegistry;g.register(this);this._createSendGen(this.__objectRegistryId,this._protocol,this._security,this._parentId,this._childId)},setOption:function(k,j,g){if(k===this.Option.OpUnboundedSendBuf){this._maxSndBufSize=j?0:e}var h=this._storeCb(g);this._setOptionSendGen(k,j,"",h)},getOption:function(j,g){var h=this._storeCb(g);this._getOptionSendGen(j,h)},setOnReadable:function(g){this._onReadable=g},setOnWritable:function(g){this._onWritable=g},setOnError:function(g){this._onError=g},bind:function(g,j){if(this._state==this.State.CLOSED){var h=this._storeCb(j);this._bindSendGen(g,0,h)}},addMembership:function(l,j,m){if(!this._isStream){var h=0;var g=1;if(typeof(j)=="object"){if(j){if(j.loop){h|=this.MulticastFlag.loop}if(j.ttl){g=j.ttl}}}else{m=j}var k=this._storeCb(m);this._addMembershipSendGen(l,h,g,k)}},dropMembership:function(h,j){if(!this._isStream){var g=this._storeCb(j);this._dropMembershipSendGen(h,g)}},connect:function(g){if(this._isStream){if(this._state==this.State.CLOSED){this._state=this.State.CONNECTING;if(!g.cn){g.cn=""}this._connectSendGen(g.host,g.port,g.cn)}}else{if(this._state==this.State.CLOSED||this._state==this.State.READY){if(!this._peerAddr){this._state=this.State.CONNECTING}this._connectSendGen(g.host,g.port,"")}}},listen:function(){if(this._state==this.State.CLOSED){if(this._isStream){var g=8;this._state=this.State.LISTENING;this._listenSendGen(g)}}},accept:function(){var g=null;if(this._isStream&&this._state==this.State.LISTENING){var h=this._pendingChildren.shift();if(h){g=new TcpServerSocket(this._protocol,this._security,h.parentId,h.childId);g._peerAddr={host:h.host,port:h.port};g._localAddr=this._localAddr}}return g},send:function(h,g,l){if(this._isStream){if(this._state!=this.State.READY){return this.Error.Invalid}}else{if(this._state==this.State.CLOSED){this._state=this.State.READY}else{if(this._state!=this.State.CONNECTING&&this._state!=this.State.READY){return this.Error.Invalid}}}if(g===undefined){g=-1}else{if(typeof(g)=="object"){l=g;g=-1}}if(g<0||g>h.getSize()){g=h.getSize()}if(this._maxSndBufSize){var k=this._maxSndBufSize-this._curSndBufSize;if(g>k){if(!this._isStream){return b.Socket.Error.TryAgain}g=k;if(!g){return 0}}}var j=h.readBytes(g);if(!l){l={host:"",port:0}}this._curSndBufSize+=j.length;this._sendSendGen(j,l.host,l.port);return j.length},recv:function(h,g,l){if(this._state!=this.State.READY&&this._state!=this.State.CLOSING){return this.Error.Invalid}if(g===undefined){g=-1}else{if(typeof(g)=="object"){l=g;g=-1}}var j=h.getSize();if(this._isStream){if(!this._rcvBuf.length){return this._EOS?0:b.Socket.Error.TryAgain}if(g<0||g>=this._rcvBuf.length){h.writeBytes(this._rcvBuf);this._rcvBuf=""}else{h.writeBytes(this._rcvBuf.slice(0,g));this._rcvBuf=this._rcvBuf.slice(g)}if(l){l.host=this._peerAddr.host;l.port=this._peerAddr.port}}else{if(!this._rcvBufInfo.length){this._rcvBuf="";return b.Socket.Error.TryAgain}var k=this._rcvBufInfo.shift();g=k.size;if(g>0){h.writeBytes(this._rcvBuf.slice(0,g));this._rcvBuf=this._rcvBuf.slice(g)}if(l){l.host=k.host;l.port=k.port}}if(h.getSize()>0){this._updateSendGen(this.UpdateId.U_SizeRcvd,h.getSize(),"")}return h.getSize()-j},shutdown:function(){if(this._state==this.State.READY){this._state=this.State.CLOSING;this._shutdownSendGen(0)}},close:function(){this._closeSendGen();this._state=this.State.CLOSED;var g=__ngs.r_(__ngs._12).ObjectRegistry;g.unregister(this)},getState:function(){return this._state},getSizeWritable:function(){if(this._maxSndBufSize){return this._maxSndBufSize-this._curSndBufSize}if(e>this._curSndBufSize){return e-this._curSndBufSize}return 0},getSizeReadable:function(){return this._rcvBuf.length},getBufferedSize:function(){return this._curSndBufSize},getPeerAddr:function(){return this._peerAddr},getLocalAddr:function(){return this._localAddr},_onSetOptionCbRecv:function(h,k,j,m){if(h===this.Option.OpUnboundedSendBuf&&c.compareBinaryVersion(1,8)<0){j=0}var g=k&&this._restoreCb(k);if(g){var l=j?{code:j,description:m}:null;g(l,this)}},_onGetOptionCbRecv:function(h,o,k,l,j,n){if(h===this.Option.OpUnboundedSendBuf){if(c.compareBinaryVersion(1,8)<0){j=0}o=this._maxSndBufSize?0:1}var g=l&&this._restoreCb(l);if(g){var m=j?{code:j,description:n}:null;g(m,this,o)}},_onBindCbRecv:function(l,h,k,j,n){if(!j){this._localAddr={host:l,port:h}}var o=!j&&!this._isStream&&this._state==this.State.CLOSED;if(o){this._state=this.State.READY}var g=k&&this._restoreCb(k);if(g){var m=j?{code:j,description:n}:null;g(m,this,h)}o=o&&this._state==this.State.READY&&this._curSndBufSize==0;if(o&&this._onWritable){this._onWritable(this)}},_onConnectRecv:function(h,g){if(this._state==this.State.CONNECTING){this._state=this.State.READY;this._peerAddr={host:h,port:g};if(this._onWritable&&this._curSndBufSize==0){this._onWritable(this)}}},_onAcceptRecv:function(j,g,k,h){this._pendingChildren.push({host:j,port:g,parentId:k,childId:h});if(this._onReadable){this._onReadable(this)}},_onReceiveRecv:function(g,j,h){var k=g.length;if(k>0){this._rcvBuf+=g}if(this._isStream){if(!k){this._EOS=true}}else{this._rcvBufInfo.push({size:k,host:j,port:h})}if(this._onReadable){this._onReadable(this)}},_onErrorRecv:function(g,j){var h=g?{code:g,description:j}:null;if(this._onError&&h){this._onError(h,this)}},_onUpdateRecv:function(h,j,g){switch(h){case this.UpdateId.U_SizeSent:this._curSndBufSize-=j;if(this._onWritable&&this._curSndBufSize==0&&this._state==this.State.READY){this._onWritable(this)}break;default:NgLogE("Unknown OnUpdate ID "+h)}},_onMembershipCbRecv:function(j,h,l){var g=j&&this._restoreCb(j);if(g){var k=h?{code:h,description:l}:null;g(k,this)}},Protocol:{UDP4:0,TCP4:1},Security:{SecNone:0,SecSSL:1},State:{CLOSED:0,CONNECTING:1,LISTENING:2,READY:3,CLOSING:4},Option:{OpSendBufSize:0,OpRecvBufSize:1,OpNoDelay:2,OpConnectionTimeout:3,OpShutdownTimeout:4,OpReuseAddr:5,OpUnboundedSendBuf:6},Error:{Unknown:-1,Invalid:-2,NotSupported:-3,TryAgain:-4,AddrInUse:-5,NoMemory:-6,NotConnected:-7,ConnectionTimeout:-8,ShutdownTimeout:-9,SSLError:-10,Unreachable:-11,ConnectionRefused:-12},MulticastFlag:{McLoop:1},UpdateId:{U_NOP:0,U_SizeSent:1,U_SizeRcvd:1},_classId:360,_onSetOptionCbRecvGen:function(l){if((l.length-l.idx)!==4){NgLogE("Could not parse due to wrong argument count in Socket.onSetOptionCb from command: "+l);return false}var g=f.parseInt(l[l.idx++]);if(g===undefined){NgLogE("Could not parse opId in Socket.onSetOptionCb from command: "+l);return false}var j=f.parseInt(l[l.idx++]);if(j===undefined){NgLogE("Could not parse cbId in Socket.onSetOptionCb from command: "+l);return false}var h=f.parseInt(l[l.idx++]);if(h===undefined){NgLogE("Could not parse errCode in Socket.onSetOptionCb from command: "+l);return false}var k=f.parseString(l[l.idx++]);if(k===undefined){NgLogE("Could not parse errStr in Socket.onSetOptionCb from command: "+l);return false}return this._onSetOptionCbRecv(g,j,h,k)},_onGetOptionCbRecvGen:function(m){if((m.length-m.idx)!==6){NgLogE("Could not parse due to wrong argument count in Socket.onGetOptionCb from command: "+m);return false}var g=f.parseInt(m[m.idx++]);if(g===undefined){NgLogE("Could not parse opId in Socket.onGetOptionCb from command: "+m);return false}var n=f.parseInt(m[m.idx++]);if(n===undefined){NgLogE("Could not parse numVal in Socket.onGetOptionCb from command: "+m);return false}var j=f.parseString(m[m.idx++]);if(j===undefined){NgLogE("Could not parse strVal in Socket.onGetOptionCb from command: "+m);return false}var k=f.parseInt(m[m.idx++]);if(k===undefined){NgLogE("Could not parse cbId in Socket.onGetOptionCb from command: "+m);return false}var h=f.parseInt(m[m.idx++]);if(h===undefined){NgLogE("Could not parse errCode in Socket.onGetOptionCb from command: "+m);return false}var l=f.parseString(m[m.idx++]);if(l===undefined){NgLogE("Could not parse errStr in Socket.onGetOptionCb from command: "+m);return false}return this._onGetOptionCbRecv(g,n,j,k,h,l)},_onBindCbRecvGen:function(m){if((m.length-m.idx)!==5){NgLogE("Could not parse due to wrong argument count in Socket.onBindCb from command: "+m);return false}var k=f.parseString(m[m.idx++]);if(k===undefined){NgLogE("Could not parse lhost in Socket.onBindCb from command: "+m);return false}var g=f.parseInt(m[m.idx++]);if(g===undefined){NgLogE("Could not parse lport in Socket.onBindCb from command: "+m);return false}var j=f.parseInt(m[m.idx++]);if(j===undefined){NgLogE("Could not parse cbId in Socket.onBindCb from command: "+m);return false}var h=f.parseInt(m[m.idx++]);if(h===undefined){NgLogE("Could not parse errCode in Socket.onBindCb from command: "+m);return false}var l=f.parseString(m[m.idx++]);if(l===undefined){NgLogE("Could not parse errStr in Socket.onBindCb from command: "+m);return false}return this._onBindCbRecv(k,g,j,h,l)},_onConnectRecvGen:function(h){if((h.length-h.idx)!==2){NgLogE("Could not parse due to wrong argument count in Socket.onConnect from command: "+h);return false}var j=f.parseString(h[h.idx++]);if(j===undefined){NgLogE("Could not parse rhost in Socket.onConnect from command: "+h);return false}var g=f.parseInt(h[h.idx++]);if(g===undefined){NgLogE("Could not parse rport in Socket.onConnect from command: "+h);return false}return this._onConnectRecv(j,g)},_onAcceptRecvGen:function(h){if((h.length-h.idx)!==4){NgLogE("Could not parse due to wrong argument count in Socket.onAccept from command: "+h);return false}var k=f.parseString(h[h.idx++]);if(k===undefined){NgLogE("Could not parse rhost in Socket.onAccept from command: "+h);return false}var g=f.parseInt(h[h.idx++]);if(g===undefined){NgLogE("Could not parse rport in Socket.onAccept from command: "+h);return false}var l=f.parseInt(h[h.idx++]);if(l===undefined){NgLogE("Could not parse parentId in Socket.onAccept from command: "+h);return false}var j=f.parseInt(h[h.idx++]);if(j===undefined){NgLogE("Could not parse childId in Socket.onAccept from command: "+h);return false}return this._onAcceptRecv(k,g,l,j)},_onReceiveRecvGen:function(j){if((j.length-j.idx)!==3){NgLogE("Could not parse due to wrong argument count in Socket.onReceive from command: "+j);return false}var g=f.parseBinary(j[j.idx++]);if(g===undefined){NgLogE("Could not parse buf in Socket.onReceive from command: "+j);return false}var k=f.parseString(j[j.idx++]);if(k===undefined){NgLogE("Could not parse rhost in Socket.onReceive from command: "+j);return false}var h=f.parseInt(j[j.idx++]);if(h===undefined){NgLogE("Could not parse rport in Socket.onReceive from command: "+j);return false}return this._onReceiveRecv(g,k,h)},_onErrorRecvGen:function(j){if((j.length-j.idx)!==2){NgLogE("Could not parse due to wrong argument count in Socket.onError from command: "+j);return false}var g=f.parseInt(j[j.idx++]);if(g===undefined){NgLogE("Could not parse errCode in Socket.onError from command: "+j);return false}var h=f.parseString(j[j.idx++]);if(h===undefined){NgLogE("Could not parse errStr in Socket.onError from command: "+j);return false}return this._onErrorRecv(g,h)},_onUpdateRecvGen:function(j){if((j.length-j.idx)!==3){NgLogE("Could not parse due to wrong argument count in Socket.onUpdate from command: "+j);return false}var h=f.parseInt(j[j.idx++]);if(h===undefined){NgLogE("Could not parse updateId in Socket.onUpdate from command: "+j);return false}var k=f.parseInt(j[j.idx++]);if(k===undefined){NgLogE("Could not parse val in Socket.onUpdate from command: "+j);return false}var g=f.parseString(j[j.idx++]);if(g===undefined){NgLogE("Could not parse optional in Socket.onUpdate from command: "+j);return false}return this._onUpdateRecv(h,k,g)},_onMembershipCbRecvGen:function(k){if((k.length-k.idx)!==3){NgLogE("Could not parse due to wrong argument count in Socket.onMembershipCb from command: "+k);return false}var h=f.parseInt(k[k.idx++]);if(h===undefined){NgLogE("Could not parse cbId in Socket.onMembershipCb from command: "+k);return false}var g=f.parseInt(k[k.idx++]);if(g===undefined){NgLogE("Could not parse errCode in Socket.onMembershipCb from command: "+k);return false}var j=f.parseString(k[k.idx++]);if(j===undefined){NgLogE("Could not parse errStr in Socket.onMembershipCb from command: "+k);return false}return this._onMembershipCbRecv(h,g,j)},$_createSendGen:function(g,j,h,l,k){f.appendToCommandString(23658495,[+g,+j,+h,+l,+k])},_setOptionSendGen:function(g,k,h,j){f.appendToCommandString(23592962,this,[+g,+k,f.encodeString(h),+j])},_getOptionSendGen:function(g,h){f.appendToCommandString(23592963,this,[+g,+h])},_bindSendGen:function(h,g,j){f.appendToCommandString(23592964,this,[+h,+g,+j])},_connectSendGen:function(h,g,j){f.appendToCommandString(23592965,this,[f.encodeString(h),+g,f.encodeString(j)])},_listenSendGen:function(g){f.appendToCommandString(23592966,this,[+g])},_sendSendGen:function(g,j,h){f.appendToCommandString(23592967,this,[f.encodeBinary(g),f.encodeString(j),+h])},_shutdownSendGen:function(g){f.appendToCommandString(23592968,this,[+g])},_closeSendGen:function(){f.appendToCommandString(23592969,this)},_addMembershipSendGen:function(k,h,g,j){f.appendToCommandString(23592970,this,[f.encodeString(k),+h,+g,+j])},_dropMembershipSendGen:function(h,g){f.appendToCommandString(23592971,this,[f.encodeString(h),+g])},_updateSendGen:function(h,j,g){f.appendToCommandString(23592972,this,[+h,+j,f.encodeString(g)])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[360]=this._instance||this;PROC_METHOD_TABLE[23592973]=this.prototype._onSetOptionCbRecvGen;PROC_METHOD_TABLE[23592974]=this.prototype._onGetOptionCbRecvGen;PROC_METHOD_TABLE[23592975]=this.prototype._onBindCbRecvGen;PROC_METHOD_TABLE[23592976]=this.prototype._onConnectRecvGen;PROC_METHOD_TABLE[23592977]=this.prototype._onAcceptRecvGen;PROC_METHOD_TABLE[23592978]=this.prototype._onReceiveRecvGen;PROC_METHOD_TABLE[23592979]=this.prototype._onErrorRecvGen;PROC_METHOD_TABLE[23592980]=this.prototype._onUpdateRecvGen;PROC_METHOD_TABLE[23592981]=this.prototype._onMembershipCbRecvGen}});TcpServerSocket=b.Socket.subclass({classname:"TcpServerSocket",initialize:function($super,j,h,k,g){this._parentId=k;this._childId=k;$super(j,h)}})}};__ngs._3y={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var d=__ngs.r_(__ngs._6).Proc;var a=__ngs.r_(__ngs._t).Class;b.DNS=a.singleton({classname:"DNS",initialize:function(){this._nextCbId=1;this._cb={};this._storeCb=function(f){var g=-1;if(f){g=this._nextCbId++;this._cb[g]=f?f:function(){}}return g};this._restoreCb=function(g){var f=this._cb[g];delete this._cb[g];return f};var e=__ngs.r_(__ngs._12).ObjectRegistry;e.register(this);this._createSendGen(this.__objectRegistryId)},resolve:function(g,e){var f=this._storeCb(e);this._resolveSendGen(g,0,f)},_onResolveCbRecv:function(h,g,f,j){var e=h&&this._restoreCb(h);if(e){if(f){e({code:f,description:j},[])}else{e(null,g?JSON.parse(g):[])}}else{NgLogE("Callback not found for DNS.resolve, id: "+h)}},Error:{Unknown:-100,Invalid:-101,NotSupported:-102,NotFound:-103},_classId:361,_onResolveCbRecvGen:function(j){if((j.length-j.idx)!==4){NgLogE("Could not parse due to wrong argument count in DNS.onResolveCb from command: "+j);return false}var g=d.parseInt(j[j.idx++]);if(g===undefined){NgLogE("Could not parse cbId in DNS.onResolveCb from command: "+j);return false}var f=d.parseString(j[j.idx++]);if(f===undefined){NgLogE("Could not parse addrs in DNS.onResolveCb from command: "+j);return false}var e=d.parseInt(j[j.idx++]);if(e===undefined){NgLogE("Could not parse errCode in DNS.onResolveCb from command: "+j);return false}var h=d.parseString(j[j.idx++]);if(h===undefined){NgLogE("Could not parse errStr in DNS.onResolveCb from command: "+j);return false}return this._onResolveCbRecv(g,f,e,h)},$_createSendGen:function(e){d.appendToCommandString(23724031,[+e])},_resolveSendGen:function(g,e,f){d.appendToCommandString(23658498,this,[d.encodeString(g),+e,+f])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[361]=this._instance||this;PROC_METHOD_TABLE[23658499]=this.prototype._onResolveCbRecvGen}})}};__ngs._3z={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var c=__ngs.r_(__ngs._5).Core;a.Diagnostics=c.DiagnosticEmitter.singleton({classname:"Network_Diagnostics",initialize:function($super){$super("Network")}})}};__ngs._40={_c:null,_d:function(){var f={exports:{}};var x=f.exports;this._c=f;var b=__ngs.r_(__ngs._5).Core;var o=__ngs.r_(__ngs._s).Network;var l={DEFAULT_HTTP_PORT:80,DEFAULT_HTTPS_PORT:443,WS_GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",CRLF:"\r\n",UNI_SUR_HIGH_START:55296,UNI_SUR_LOW_END:57343,UNI_REPLACEMENT_CHAR:65533,UNI_MAX_LEGAL_UTF32:1114111,TrailingUTF8Bytes:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,5,5,5,5],OffsetsFromUTF8:[0,12416,925824,63447168,4194836608,2181570688]};var w={Continuation:0,Text:1,Binary:2,Close:8,Ping:9,Pong:10};var n={SyntaxError:"SyntaxError",SecurityError:"SecurityError",InvalidAccessError:"InvalidAccessError",InvalidStateError:"InvalidStateError"};var e=function(B){var A=b.toMD5(B);var y=[];for(var z=0;z<16;++z){y.push(String.fromCharCode(parseInt(A.substr(z*2,2),16)))}return y.join("")};var c=function(B){var A=b.SHA1.hex_sha1(B);var y=[];for(var z=0;z<20;++z){y.push(String.fromCharCode(parseInt(A.substr(z*2,2),16)))}return y.join("")};var p=function(y){var z=e(Math.random().toString(16)+(new Date()).getTime().toString(16));return b.Base64.encodeBinary(z)};var j=function(y){var z=c(y.concat(l.WS_GUID));return b.Base64.encodeBinary(z)};var h=function(z,A){var y=new b.Buffer();y.writeUint16(s.StatusCode.Normal,0);y.writeBytes(b.UTF8.encode(A),2);return y};var m=function(y){var A={};var z=new b.Buffer(y);A.code=z.readUint16();A.reason=b.UTF8.decode(z.toString());return A};var u=function(y){if(!y){NgLogE("buffer is null");return false}if(!(y instanceof b.Buffer)){NgLogE("not an instance of Core.Buffer");return false}for(var z=0;z<y.getSize();z++){var A=0;var B=l.TrailingUTF8Bytes[y.get(z)];if(B+z>=y.getSize()){console.log("isValidUTF8: error 1, i="+z);return false}if(!r(y,z,B+1)){console.log("isValidUTF8: error 2, i="+z);return false}switch(B){case 5:A+=y.get(z);z++;A<<=6;case 4:A+=y.get(z);z++;A<<=6;case 3:A+=y.get(z);z++;A<<=6;case 2:A+=y.get(z);z++;A<<=6;case 1:A+=y.get(z);z++;A<<=6;case 0:A+=y.get(z);break;default:break}A-=l.OffsetsFromUTF8[B];if(A<=l.UNI_MAX_LEGAL_UTF32){if(A>=l.UNI_SUR_HIGH_START&&A<=l.UNI_SUR_LOW_END){console.log("isValidUTF8: error 3");return false}}else{console.log("isValidUTF8: error 4");return false}}return true};var r=function(z,B,A){var y;var C=B+A;switch(A){default:return false;case 4:if((y=(z.get(--C)))<128||y>191){return false}case 3:if((y=(z.get(--C)))<128||y>191){return false}case 2:if((y=(z.get(--C)))>191){return false}switch(z.get(B)){case 224:if(y<160){return false}break;case 237:if(y>159){return false}break;case 240:if(y<144){return false}break;case 244:if(y>143){return false}break;default:if(y<128){return false}}case 1:if(z.get(B)>=128&&z.get(B)<194){return false}}if(z.get(B)>244){return false}return true};var k=function(y,z){z.forEach(function(B,A){return(B^y[A%4])})};var g=k;var v=function(y){if(y<=999){return false}if(y<=2999){switch(y){case s.StatusCode.Normal:case s.StatusCode.GoingAway:case s.StatusCode.ProtocolError:case s.StatusCode.NotSupported:case s.StatusCode.Inconsistent:case s.StatusCode.NotAcceptable:case s.StatusCode.MessageTooLarge:case s.StatusCode.NoExtensionReply:case s.StatusCode.UnexpectedError:return true;default:break}return false}if(y<=4999){return true}return false};var t=function(E,C,y){var A=(!C||C.getSize()<126)?0:((C.getSize()<65536)?2:8);var D=new b.Buffer();D.writeUint8((E.fin?128:0)|E.opcode);switch(A){case 0:D.writeUint8((y?128:0)|(C?C.getSize():0));break;case 2:D.writeUint8((y?128:0)|126);D.writeUint16(C.getSize());break;default:D.writeUint8((y?128:0)|127);D.writeUint32(Math.floor(C.getSize()/4294967296));D.writeUint32(Math.floor(C.getSize()%4294967296));break}if(y){var B=[];var z;for(z=0;z<4;++z){B.push(Math.floor(Math.random()*256))}for(z=0;z<B.length;++z){D.writeUint8(B[z])}if(C){k(B,C)}}if(C){D.writeBytes(C)}return D};var q=b.Class.subclass({classname:"FrameParser",State:{HEAD:0,PLEN:1,MKEY:2,BODY:3},initialize:function(y){this._wsId=y;this._state=this.State.HEAD;this._subIdx=0;this._plen=0;this._plenwidth=0;this._masked=false;this._payload=new b.Buffer();this._keys=[];this._header={fin:false,opcode:w.Continuation,clear:function(){this.fin=false;this.opcode=w.Continuation}};this._defrag={clear:function(){this.opcode=w.Continuation;this.frame=null},push:function(A,z){if(!this.frame){this.frame=new b.Buffer();this.opcode=A}if(this.opcode!==w.Continuation){this.frame.writeBytes(z)}else{NgLogE("invalid opcode "+this.opcode)}},join:function(A){if(!this.frame){this.frame=new b.Buffer()}this.frame.writeBytes(A);var z=this.frame;this.clear();return z},hasFragments:function(){return this.frame?true:false}};this._defrag.clear();this._onWsFrame=null;this._onWsError=null},reset:function(){this._state=this.State.HEAD;this._subIdx=0;this._plen=0;this._plenwidth=0;this._masked=false;this._payload.clear();this._keys=[];this._header.clear()},setOnFrame:function(y){this._onWsFrame=y},setOnError:function(y){this._onWsError=y},_processFrame:function(){if(this._masked&&this._payload.getSize()>0){g(this._keys,this._payload)}var B=null;var y;var A=this._header.opcode;if(this._header.fin){if(A==w.Continuation){if(this._defrag.opcode!==w.Continuation){A=this._defrag.opcode;B=this._defrag.join(this._payload);this._defrag.clear()}else{NgLogE("a continuation has no previous fragment");if(this._onWsError){this._onWsError(s.StatusCode.UnexpectedError,"received continuation frame while no previous fragment")}return false}}else{if(A==w.Text||A==w.Binary){if(this._defrag.hasFragments()){NgLogW("unfragmented non-control frame has previous fragment");this._defrag.clear();if(this._onWsError){this._onWsError(s.StatusCode.UnexpectedError,"received unfragmented non-control frame while there is previous fragment(s)")}return false}B=this._payload}else{B=this._payload}}}else{if(A==w.Continuation){if(this._defrag.hasFragments()){this._defrag.push(A,this._payload)}else{if(this._onWsError){this._onWsError(s.StatusCode.UnexpectedError,"received a continuation frame while there is no previous fragment(s)")}return false}}else{if(A==w.Text||A==w.Binary){if(this._defrag.hasFragments()){if(this._onWsError){this._onWsError(s.StatusCode.UnexpectedError,"received a fragment with illegal opcode while there is previous fragment(s)")}return false}this._defrag.push(A,this._payload)}else{NgLogE("received fragmented control frame: opcode="+A);if(this._onWsError){this._onWsError(s.StatusCode.UnexpectedError,"received fragmented control frame")}return false}}}if(B!==null){switch(A){case w.Text:if(u(B)){this._onWsFrame({opcode:A,data:b.UTF8.decode(B.toString())})}else{if(this._onWsError){this._onWsError(s.StatusCode.UnexpectedError,"received frame contains invalid UTF8)")}return false}break;case w.Binary:this._onWsFrame({opcode:A,data:B});break;case w.Close:NgLogD("case: OpCode.Close: frameSize="+B.getSize());if(B.getSize()>0){if(B.getSize()<2){if(this._onWsError){this._onWsError(s.StatusCode.ProtocolError,"data field in close frame too short")}return false}var z=B.readUint16();if(u(B)){if(v(z)){this._onWsFrame({opcode:A,code:z,data:b.UTF8.decode(B.toString())})}else{if(this._onWsError){this._onWsError(s.StatusCode.ProtocolError,"close frame contains invalid status code "+z)}return false}}else{if(this._onWsError){this._onWsError(s.StatusCode.ProtocolError,"data field in close frame contains invalid utf8")}return false}}else{this._onWsFrame({opcode:A,code:null,data:null})}break;case w.Ping:case w.Pong:this._onWsFrame({opcode:A,data:B});break;default:NgLogW("opcode="+A+" not supported");break}}else{NgLogD("WS("+this._wsId+"): current frame is null: opcode="+A)}this.reset();return true},parse:function(y){while(y.getSize()>0){var A;var z;switch(this._state){case this.State.HEAD:A=y.readUint8();if(A&112){NgLogE("illegal non-zero reserved bits");y.clear();this.reset();if(this._onWsError){this._onWsError(s.StatusCode.ProtocolError,"illegal non-zero reserved bits")}break}this._header.fin=(A&128)?true:false;this._header.opcode=(A&15);if((this._header.opcode>=3&&this._header.opcode<=7)||(this._header.opcode>=11&&this._header.opcode<=15)){NgLogE("illegal use of reserved opcode");y.clear();this.reset();if(this._onWsError){this._onWsError(s.StatusCode.ProtocolError,"illegal use of reserved opcode");break}break}this._state=this.State.PLEN;break;case this.State.PLEN:A=y.readUint8();if(this._plenwidth===0){this._masked=(A&128)?true:false;this._plen=(A&127);if(this._plen<126){if(this._masked){this._state=this.State.MKEY}else{this._state=this.State.BODY;if(this._plen===0){this._payload.clear();if(!this._processFrame()){y.clear();this.reset();break}}}}else{if(this._header.opcode!=w.Continuation&&this._header.opcode!=w.Text&&this._header.opcode!=w.Binary){NgLogE("WS("+this._wsId+"): illegal control frame length: "+this._plen);y.clear();this.reset();if(this._onWsError){this._onWsError(s.StatusCode.ProtocolError,"control frame too long")}break}if(this._plen==126){this._plen=0;this._plenwidth=2;this._subIdx=0}else{this._plen=0;this._plenwidth=8;this._subIdx=0}}}else{this._plen=(this._plen*256)+A;this._subIdx++;if(this._subIdx==this._plenwidth){this._subIdx=0;if(this._masked){this._state=this.State.MKEY}else{this._state=this.State.BODY;if(this._plen===0){this._payload.clear();if(!this._processFrame()){y.clear();this.reset();break}}}}}break;case this.State.MKEY:this._keys[this._subIdx]=y.readUint8();this._subIdx++;if(this._subIdx==4){this._state=this.State.BODY;if(this._plen===0){this._payload.clear();if(!this._processFrame()){y.clear();this.reset();break}}}break;case this.State.BODY:z=this._plen-this._payload.getSize();if(z>y.getSize()){z=y.getSize()}this._payload.writeBytes(y.readBytes(z));if(this._plen==this._payload.getSize()){if(!this._processFrame()){y.clear();this.reset();break}}break;default:NgLogE("unknown parsing state");break}}}});var a=b.Class.subclass({classname:"HttpParser",State:{StatusLine:0,Headers:1,Content:2},initialize:function(){this._state=this.State.StatusLine;this._line="";this._pending="";this._headers={};this._onStatusLine=null;this._onHeaders=null;this._onContent=null},setOnStatusLine:function(y){this._onStatusLine=y},setOnHeaders:function(y){this._onHeaders=y},setOnContent:function(y){this._onContent=y},parse:function(A){var D,z,B,C;var y=function(E){return E.replace(/^\s+|\s+$/g,"")};if(this._pending.length>0){A=this._pending.concat(A);this._pending=""}while(A.length>0){switch(this._state){case this.State.StatusLine:D=A.indexOf(l.CRLF);if(D<0){this._pending=A;return 0}this._line+=A.substring(0,D);A=A.substr(D+2);this._state=this.State.Headers;D=this._line.indexOf(" ");z=this._line.substring(0,D);this._line=this._line.substr(D+1);D=this._line.indexOf(" ");B=parseInt(y(this._line.substring(0,D)),10);this._line=this._line.substr(D+1);this._onStatusLine(y(z),B,y(this._line));this._line="";break;case this.State.Headers:D=A.indexOf(l.CRLF);if(D<0){this._pending=A;return 0}this._line+=A.substring(0,D);A=A.substr(D+2);if(this._line.length>0){C=this._line.split(":");this._line="";this._headers[y(C[0]).toLowerCase()]=y(C[1])}else{this._onHeaders(this._headers);this._state=this.State.Content}break;case this.State.Content:this._onContent(A);A="";break;default:NgLogD("WS: unexpected state");return -1}}return 0},getHeader:function(y){return this._headers[y.toLowerCase()]}});var d=0;var s=x.WS=b.Class.subclass({classname:"WS",initialize:function(y,z){this._wsId=d++;this._readyState=s.CONNECTING;this._bufferedAmount=0;this._extensions="";this._protocol="";this._url=y;this.__defineGetter__("url",function(){return this._url});this.__defineGetter__("readyState",function(){return this._readyState});this.__defineGetter__("bufferedAmount",function(){return this._getBufferedSize()});this.__defineGetter__("extensions",function(){return this._extensions});this.__defineGetter__("protocol",function(){return this._protocol});this._clearEvHandles=function(){this.onopen=null;this.onerror=null;this.onclose=null;this.onmessage=null};this._clearEvHandles();this._protocols=z;this._soc=null;this._handshaking=false;this._httpStatus=0;this._wsKey="";this._httpParser=new a();this._httpParser.setOnStatusLine(this._onHttpStatusLine.bind(this));this._httpParser.setOnHeaders(this._onHttpHeaders.bind(this));this._httpParser.setOnContent(this._onHttpContent.bind(this));this._frameParser=new q(this._wsId);this._frameParser.setOnFrame(this._onWsFrame.bind(this));this._frameParser.setOnError(this._onWsError.bind(this));this._uri=o.URL.parse(y);if(!this._uri.port){if(this._uri.protocol==="ws:"){this._uri.port=80}else{if(this._uri.protocol==="wss:"){this._uri.port=443}else{NgLogE("WS("+this._wsId+"): invaid scheme: "+this._uri.protocol)}}}NgLogD("WS("+this._wsId+"): uri="+JSON.stringify(this._uri));if(b.Capabilities.getPlatformOS()==="flash"){this._connect(this._uri.hostname)}else{o.DNS.resolve(this._uri.hostname,this._onResolverComplete.bind(this))}},CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3,StatusCode:{Normal:1000,GoingAway:1001,ProtocolError:1002,NotSupported:1003,ClosedAbnormally:1006,Inconsistent:1007,NotAcceptable:1008,MessageTooLarge:1009,NoExtensionReply:1010,UnexpectedError:1011},close:function(A,B){if(!this._soc){return}if(this._readyState==s.CLOSED){return}if(this._readyState==s.CLOSING){return}if(this._readyState==s.CONNECTING&&!this._handshaking){NgLogD("WS("+this._wsId+"): closing underlying socket");this._soc.close();this._soc=null;this._readyState=s.CLOSED;return}this._readyState=s.CLOSING;var y=null;if(A&&B){y=h(A,B)}var z=t({fin:true,opcode:w.Close},y,true);this._soc.send(z);this._soc.shutdown()},send:function(z){var A=null;if(!this._soc){return}if(typeof z==="string"){var y=new b.Buffer(b.UTF8.encode(z));A=t({fin:true,opcode:w.Text},y,true)}else{A=t({fin:true,opcode:w.Binary},z,true)}this._soc.send(A)},_onHttpStatusLine:function(y,A,z){NgLogD("WS("+this._wsId+"): onStatusLine(): ver="+y+" sc="+A+" "+z);this._httpStatus=A},_onHttpHeaders:function(){NgLogD("WS("+this._wsId+"): onHeaders()");var y;if(this._httpStatus==101){y=this._httpParser.getHeader("sec-websocket-accept");if(y!=j(this._wsKey)){this._readyState=s.CLOSED;NgLogD("WS("+this._wsId+"): closing underlying socket");this._soc.close();this._soc=null;if(this.onerror){this.onerror("Sec-WebSocket-Accept header is missing or invalid")}this._clearEvHandles();return}y=this._httpParser.getHeader("sec-websocket-protocol");if(y){this._protocol=y}this._readyState=s.OPEN;if(this.onopen){this.onopen()}}else{this._readyState=s.CLOSED;NgLogD("WS("+this._wsId+"): closing underlying socket");this._soc.close();this._soc=null;if(this.onerror){this.onerror("Failed to upgrade to WebSocket ("+this._httpStatus+")")}this._clearEvHandles()}},_onHttpContent:function(y){NgLogD("WS("+this._wsId+"): content "+y.length+" bytes");if(this._readyState==s.OPEN){this._frameParser.parse(new b.Buffer(y))}},_onWsFrame:function(B){NgLogD("WS("+this._wsId+"): opcode="+B.opcode+" readyState="+this._readyState);var z;if(B.opcode==w.Text){if(this.onmessage){this.onmessage({data:B.data})}}else{if(B.opcode==w.Binary){if(this.onmessage){this.onmessage({data:B.data})}}else{if(B.opcode==w.Close){NgLogD("WS("+this._wsId+"): ev="+JSON.stringify(B));var A=(B.code!==null)?B.code:s.StatusCode.Normal;var C=(B.data!==null)?B.data:"Normal closure";if(this._readyState==s.OPEN){if(this._soc){var y=null;if(A&&C){y=h(A,C)}z=t({fin:true,opcode:w.Close},y,true);this._soc.send(z);this._soc.shutdown()}}this._readyState=s.CLOSED;if(this._soc){NgLogD("WS("+this._wsId+"): closing underlying socket on Close frame");this._soc.close();this._soc=null}if(this.onclose){this.onclose({wasClean:true,code:A,reason:C})}this._clearEvHandles()}else{if(B.opcode==w.Ping){NgLogD("WS("+this._wsId+"): received Ping with data: "+(B.data!==null)?B.data.toString():"");if(this._readyState==s.OPEN){z=t({fin:true,opcode:w.Pong},B.data,true);this._soc.send(z)}}else{if(B.opcode==w.Pong){NgLogD("WS("+this._wsId+"): received Pong with data: "+(B.data!==null)?B.data.toString():"")}else{NgLogD("WS("+this._wsId+"): opcode="+B.opcode+" not supported")}}}}}},_onWsError:function(y,z){this._readyState=s.CLOSED;if(this._soc){NgLogD("WS("+this._wsId+"): closing underlying socket on error");this._soc.close();this._soc=null}if(this.onclose){this.onclose({wasClean:true,code:y,reason:z})}this._clearEvHandles()},_onResolverComplete:function(z,y){if(z){NgLogE("DNS error: "+z);if(this.onerror){this.onerror("Failed to locate server at "+this._uri.host+", "+z)}this._clearEvHandles();return}this._connect(y[0])},_connect:function(B){var y=this;var A=new b.Buffer();var z=false;NgLogD("WS("+y._wsId+"): connecting to "+B+":"+y._uri.port);if(this._uri.protocol==="wss:"){y._soc=new o.Socket(o.Socket.Protocol.TCP4,o.Socket.Security.SecSSL)}else{y._soc=new o.Socket(o.Socket.Protocol.TCP4)}y._soc.setOption(o.Socket.Option.OpUnboundedSendBuf,1);y._soc.setOnWritable(function(C){if(!z){NgLogD("WS("+y._wsId+"): socket connected");z=true;y._handshaking=true;y._wsKey=p();A.writeBytes("GET "+(y._uri.path?y._uri.path:"/")+" HTTP/1.1\r\nHost: "+y._uri.host+"\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-WebSocket-Key: "+y._wsKey+"\r\nSec-WebSocket-Version: 13\r\n");if(y._protocols){A.writeBytes("Sec-WebSocket-Protocol: ");if(typeof(y._protocols)==="string"){A.writeBytes(y._protocols+"\r\n")}else{A.writeBytes(y._protocols.join(", ")+"\r\n")}}A.writeBytes("\r\n");console.log("Sending data:",A);y._soc.send(A)}else{if(A.getSize()>0){y._soc.send(A)}}});y._soc.setOnReadable(function(E){var D=new b.Buffer();var C=y._soc.recv(D);if(C<0){NgLogD("WS("+y._wsId+"): connection reset");if(y._readyState!=s.CLOSED){y._readyState=s.CLOSED;NgLogD("WS("+this._wsId+"): closing underlying socket");y._soc.close();y._soc=null;if(y.onclose){y.onclose({wasClean:false,code:s.StatusCode.ClosedAbnormally,reason:"Connection closed abnormally"})}y._clearEvHandles()}return}if(C===0){NgLogD("WS("+y._wsId+"): end-of-stream: state="+y._readyState);if(y._soc){NgLogD("WS("+this._wsId+"): closing underlying socket");y._soc.close();y._soc=null}if(y._readyState!=s.CLOSED){y._readyState=s.CLOSED;if(y.onclose){y.onclose({wasClean:false,code:s.StatusCode.ClosedAbnormally,reason:"Connection closed abnormally"})}y._clearEvHandles()}return}NgLogD("WS("+y._wsId+"): received "+D.getSize()+" bytes, state="+y._readyState);if(y._readyState==s.CONNECTING){if(y._handshaking){y._httpParser.parse(D.toString())}}else{if(y._readyState==s.OPEN||y._readyState==s.CLOSING){y._frameParser.parse(D)}}});y._soc.setOnError(function(D,C){NgLogD("WS("+y._wsId+"): socket error: "+D.description);NgLogD("WS("+this._wsId+"): closing underlying socket");y._soc.close();y._soc=null;if(y._readyState!=s.CLOSED){y._readyState=s.CLOSED;if(y.onclose){y.onclose({wasClean:false,code:s.StatusCode.ClosedAbnormally,reason:"err.description"})}y._clearEvHandles()}});if(this._uri.protocol!=="wss:"){y._soc.connect({host:B,port:y._uri.port})}else{y._soc.connect({host:B,port:y._uri.port,cn:this._uri.hostname})}},_getBufferedSize:function(){if(!this._soc){return 0}return this._soc.getBufferedSize()}})}};__ngs._41={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var a=__ngs.r_(__ngs._t).Class;var d={"http:":{slashes:true},"https:":{slashes:true},"ws:":{slashes:true},"wss:":{slashes:true},"file:":{slashes:true},"mailto:":{slashes:false}};b.URL=a.singleton({initialize:function(){},parse:function(f){var e={};var h;var g;h=f.indexOf(":");if(h>=0){e.protocol=f.slice(0,h+1).toLowerCase();g=d[e.protocol];if(g){f=f.slice(h+(g.slashes?3:1))}else{if(f.substr(h+1,2)==="//"){f=f.slice(h+3)}else{f=f.slice(h+1)}}h=f.search(/[\/?]/);if(h<0){e.host=f;f=""}else{e.host=f.slice(0,h);f=f.slice(h+((f[h]==="?")?0:1))}h=e.host.indexOf("@");if(h>=0){e.auth=e.host.slice(0,h);e.host=e.host.slice(h+1)}g=e.host.split(":");e.hostname=g[0];if(g[1]){e.port=parseInt(g[1],10)}}g=f.split("?");e.pathname=((g[0].length===0||g[0][0]!=="/")?"/":"")+g[0];if(g[1]){e.search="?"+g[1]}e.path=e.pathname+(e.search?e.search:"");return e}})}};__ngs._0={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;var e=false;var c={};var f=0;a.NGSetTimeoutRunTimers=function(){if(e){var j=[];var k=new Date().getTime();for(var g in c){if(c.hasOwnProperty(g)&&c[g].shouldExecute(k)){j.push(c[g])}}for(var h in j){if(j.hasOwnProperty(h)){j[h].execute()}}}};if(typeof(setTimeout)!="function"){setTimeout=function(h,g){return 0};clearTimeout=function(g){};setInterval=function(h,g){return 0};clearInterval=function(g){};e=true}NGSetTimeoutOld=setTimeout;NGClearTimeoutOld=clearTimeout;NGSetIntervalOld=setInterval;NGClearIntervalOld=clearInterval;NGSetTimeoutInternal=function(h,g){return NGSetTimeoutOld(h,g)};NGClearTimeoutInternal=function(g){NGClearTimeoutOld(g)};NGSetIntervalInternal=function(h,g){return NGSetIntervalOld(h,g)};NGClearIntervalInternal=function(g){NGClearIntervalOld(g)};setTimeout=function(h,g){return NGSetTimeoutInternal(h,g)};clearTimeout=function(g){NGClearTimeoutInternal(g)};setInterval=function(h,g){return NGSetIntervalInternal(h,g)};clearInterval=function(g){NGClearIntervalInternal(g)};if(e){var d=function(g,h){this.uid=f++;if(f==Infinity){f=0}this.fptr=g;this.interval=h;this.requestedTime=new Date().getTime()+h};d.prototype.shouldExecute=function(g){if(g<this.requestedTime){return false}return true};d.prototype.execute=function(){delete c[this.uid];this.fptr()};NGSetTimeoutInternal=function(g,j){if(j<0||typeof(j)!="number"){j=0}var h=new d(g,j);c[h.uid]=h;return h.uid};NGClearTimeoutInternal=function(g){if(c.hasOwnProperty(g)){delete c[g]}};NGSetIntervalInternal=function(g,j){if(j<0||typeof(j)!="number"){j=0}var h=new d(g,j);h.execute=function(){this.requestedTime=new Date().getTime()+this.interval;this.fptr()};c[h.uid]=h;return h.uid};NGClearIntervalInternal=function(g){NGClearTimeoutInternal(g)}}}};__ngs._1={_c:null,_d:function(){var e={exports:{}};var b=e.exports;this._c=e;var d=__ngs.r_(__ngs._t);var g=__ngs.r_(__ngs._u).Base64;var h=__ngs.r_(__ngs._v);var c={HandleAction:0};var a=d.Class.subclass({classname:"SystemBinding",callbacks:{},callbacksUidGenerator:0,_contResultSets:{},_contResultSetIdxs:{}});var f=d.Class.subclass({classname:"ResultSet",initialize:function(j){this.items=[];this._continueId=j;this.totalLength=Number.MAX_VALUE},getMore:function(j){return a._getMoreContacts(this,j)},closeResultSet:function(){a._closeContactsResultSet(this)}});a._pushContactsCmd=function(l,j,n){var m=a.callbacksUidGenerator++;if(!!!j){j=function(){}}a.callbacks[m]=j;var k={name:l,callbackId:m};if(typeof n!="undefined"){k.continueId=n}k=JSON.stringify(k);NgPushCommand3(NgEntityTypes.NgSystemBinding,c.HandleAction,g.encode(k))};a._closeContactsResultSetfunction=function(k){var j=function(){};a._pushContactsCmd("closecontacts",j,k._continueId)};a._getMoreContacts=function(k,j){if((typeof k._continueId!="undefined")&&(k.items.length<k.totalLength)){a._pushContactsCmd("morecontacts",j,k._continueId);return true}return false};a.getContacts=function(j){a._pushContactsCmd("contacts",j,undefined)};a.getDeviceToken=function(j){var l=a.callbacksUidGenerator++;if(!!!j){j=function(){}}a.callbacks[l]=j;var k={name:"devicetoken",callbackId:l};k=JSON.stringify(k);NgPushCommand3(NgEntityTypes.NgSystemBinding,c.HandleAction,g.encode(k))};a.handleCommand=function(q){var k=NgParseCommand2(q,NgParseInt,NgParseBase64);var n=JSON.parse(k[1]);if(n.name=="callback"){var j=a.callbacks[n.callbackId];if(typeof j=="function"){if(n.callbackname=="contacts"){var p=a._contResultSets[n.continueId];if(typeof p=="undefined"){p=new h.ResultSet(n.continueId);a._contResultSets[n.continueId]=p;a._contResultSetIdxs[n.continueId]=0}var o=n.list.length;while(n.list.length>0){var m=n.list.shift();p.items.push(m)}var l=a._contResultSetIdxs[n.continueId];if((typeof l)!="undefined"){a._contResultSetIdxs[n.continueId]=l+o}if((typeof n.total!="undefined")||(typeof n.rsclosed!="undefined")){if(typeof n.total!="undefined"){p.totalLength=n.total}delete p._continueId;delete a._contResultSets[n.continueId];delete a._contResultSetIdxs[n.continueId]}delete a.callbacks[n.callbackId];if(n.success){j(undefined,p,l,o)}else{j(n.error,p,l,o)}}else{delete a.callbacks[n.callbackId];j(n)}}}};b.SystemBinding=a}};__ngs._2={_c:null,_d:function(){var c={exports:{}};var e=c.exports;this._c=c;var b=__ngs.r_(__ngs._t).Class;var g=__ngs.r_(__ngs._w).MessageListener;var f=__ngs.r_(__ngs._x).XHR;var l=__ngs.r_(__ngs._y).Util;var a=__ngs.r_(__ngs._z).DownloadFile;var j=__ngs.r_(__ngs._d).FileSystem;var m=__ngs.r_(__ngs._3).LocalGameList;var h=__ngs.r_(__ngs._7).Capabilities;var d=true;var k=b.subclass({classname:"Manifest",initialize:function(){this.mNumAdded=0;this.mNumRemoved=0},reset:function(){this.mJson=null;this.mArchives=null},initWithJsonText:function(p,n){try{this.mJson=JSON.parse(p);if(!this.mJson){this.mJson={}}}catch(o){this.mJson={}}if("__archives" in this.mJson){this.mArchives=this.mJson.__archives.files;delete this.mJson.__archives}else{this.mArchives=[]}},foreach:function(o,n){var r=this.mJson;var q=o.mJson;var p;for(p in q){this.handleItem(p,r,q,n)}for(p in r){if(!(p in q)){this.handleItem(p,r,q,n)}}},handleItem:function(p,r,q,n){var o=n(p,r,q);if(o){if(o<0){this.mNumRemoved++;delete r[p]}else{this.mNumAdded++}}},isModified:function(){return(this.mNumAdded>0||this.mNumRemoved>0)},_hasItems:function(){return Object.keys(this.mJson).length>0},write:function(q,p){var n=function(r){if(r){console.log("Error writing manifest! "+r)}if(p){p(r)}};if(this.mJson){var o=JSON.stringify(this.mJson);j._safeWrite(q,o,{},n)}else{p()}}});e.DownloadManifest=g.subclass({classname:"DownloadManifest",MAX_CONCURRENT_REQUESTS:6,initialize:function(){this.mCompletedPaths={};this.mCompletionCallbacks={};this.mConnections=[];this.mPendingItems=[];this.mActiveRequests=[];this.reset();this._progressIsTotal=false},_clearConnections:function(){for(var n in this.mConnections){if(this.mConnections.hasOwnProperty(n)){this.mConnections[n].abort()}}this.mConnections.length=0},_sortPendingItems:function(){var o;var n;this.mPendingItems.sort(function(q,p){o=(q.priority!==undefined)?q.priority:0;n=(p.priority!==undefined)?p.priority:0;return n-o})},reset:function(){this.mConcurrentRequests=this.MAX_CONCURRENT_REQUESTS;this.mManifest=null;this.mRemoteUrl=null;this.mLocalPath=null;this.mLocalRoot=null;this.mLocalText=null;this.mRemoteText=null;this.mProgressCb=function(){};this.mDoneCb=function(){};this.mPaused=false;this.mValid=false;this._clearConnections();this.mPendingItems.length=0;this.mCompleteBytes=0;this.mTotalBytes=0;this.mSpaceNeeded=0;this.mNumRemoteManifestBytes=0;this.mDownloadArchives=true;this.mActiveRequests.length=0;this.mLocalGameList=m;this.mRetrySchedule=l.RetrySchedule(50,2000);this.mManifestRetrySchedule=this.mRetrySchedule.slice(0);if(this._statusListener){this._statusListener.destroy();this._statusListener=null}this.mCheckUpdateOnly=false;this.mCheckUpdateCallback=null;this.mDecompCtxId=0;this.mFlushing=false},_ensureTrailingSlashes:function(n,p,o){this.mRemoteUrl=n.match(/.*\/$/)?n:n+"/";this.mLocalRoot=(p.match(/.*\/$/)||(!p))?p:p+"/";this._secureContentUrl=((!o)||o.match(/.*\/$/))?o:o+"/"},_readLocalManifest:function(){j.readFile(this.mLocalPath,{},this._onReadLocalManifest.bind(this))},_setRemotePath:function(n){if(this._secureContentUrl){this.mRemotePath=this._secureContentUrl+n}else{this.mRemotePath=this.mRemoteUrl+n}},_parseManifestNames:function(n){if(typeof n==="string"){var o={};o[n]=n;n=o}return n},isUpdated:function(p,s,r,n,q){this.mCheckUpdateOnly=true;this.mCheckUpdateCallback=n;this.mDoneCb=(typeof q==="function")?q:function(){};this.mProgressCb=function(u,v){};var t=0;var o=p+"/configuration.json"+l.getCacheBustingString();l.OperationWithRetries((function(u,v){var w=new f();w.onreadystatechange=(function(){if(w.readyState===4&&this.mValid){this.mManifest=new k();var x=null;var C=(w.status===404);if(C||(w.status===200&&w.responseText)){var y;if(!C){y=JSON.parse(w.responseText);x=y.contentUrl}if(!r){r={"webgame.ngmanifest":__ngs.r_(__ngs._h)._int_LGL.getManifestName(y)}}if(!x){x=p}r=this._parseManifestNames(r);var B;var A;for(var z in r){if(r.hasOwnProperty(z)){B=r[z];A=z;break}}this._ensureTrailingSlashes(x,s);this.mLocalPath=this.mLocalRoot+A;this._setRemotePath(B);this._readLocalManifest()}else{t=w.status;u()}}}).bind(this);w.open("GET",o,true);w.send()}).bind(this),(function(){console.log("Exceeded maximum number of manifest download retires, failing");this._processError("Failed to download manifest ("+t+") at "+o,false)}).bind(this),this.mFailEarly);this.mValid=true},useTotalProgress:function(){this._progressIsTotal=true},setOptions:function(n){if(n.incremental){this._incremental=true}if(n.useTotalProgress){this._progressIsTotal=true}},_notifyFileReady:function(q,p){if(this.mCompletedPaths[q]===undefined){this.mCompletedPaths[q]=true}var o=this.mCompletionCallbacks[q];if(o){for(var n=0;n<o.length;n++){o[n](q)}o.length=0;delete this.mCompletionCallbacks[q];if(this._incremental){this._flushManifest()}}},onNotifyFileReady:function(r,s){if(typeof s!=="function"){return}if(this.mCompletedPaths[r]!==undefined){s(r)}else{if(this.mCompletionCallbacks[r]===undefined){this.mCompletionCallbacks[r]=[]}this.mCompletionCallbacks[r].push(s);var q=this.mPendingItems.length;if(!q){console.log("onNotifyFileReady called before mPendingItems populated! Saving "+r);if(!this.prioritizePending){this.prioritizePending=[]}this.prioritizePending.push({path:r,cb:s});return}for(var o=0;o<q;o++){var p=this.mPendingItems[o];if(p.files){for(var n=0;n<p.files.length;n++){if(p.files[n].name===r){if(p.priority===undefined){p.priority=0}p.priority+=1;this._sortPendingItems();break}}}else{if(p.name===r){if(p.priority===undefined){p.priority=0}p.priority=this.mCompletionCallbacks[r].length;this._sortPendingItems();break}}}this._downloadPendingItems()}},start:function(o,s,p,n,w,q,t){this.mCheckUpdateOnly=false;p=this._parseManifestNames(p);var z;var y;for(var x in p){if(p.hasOwnProperty(x)){z=p[x];y=x;break}}console.log("DownloadManifest.start(",o,s,z,")");if(!o||!s||o===""||s===""){throw new Error("invalid arguments: "+JSON.stringify(arguments))}this.mManifest=new k();var u=h.getPlatformOS()==="flash";if(q||u){this.mDownloadArchives=false;if(u){console.log("Flash does not yet support archive downloads")}}this._ensureTrailingSlashes(o,s,this._secureContentUrl);this._setRemotePath(z);this.mLocalPath=this.mLocalRoot+y;this.mCacheKey=this.mLocalPath;this.mFailEarly=t;this.mProgressCb=function(A,C){try{n(A,C)}catch(B){NgLogException(B)}};var v=this;this.mDoneCb=function(C,D,A){try{j._safeWrite(v.mLocalRoot+"/.nomedia","",{});this.mProgressCb=function(){};this.mDoneCb=function(){};this._setLifecycleListening(false);w(C,D,A)}catch(B){NgLogException(B)}};var r=__ngs.r_(__ngs._10).KeyValue;this.kvCache=new r();this.kvCache.registerForKey("manifest");this.kvCache.getItem(this.mCacheKey,{},function(B,D,A){try{if(!B&&D){this.mCacheHeadersIn=JSON.parse(D)}}catch(C){NgLogException(C)}this._readLocalManifest();this._setLifecycleListening(true);this.mValid=true}.bind(this))},abort:function(){this.mCompletedPaths={};this.mCompletionCallbacks={};if(this.mManifest){this._writeManifest()}this.reset();if(this.kvCache){this.kvCache.removeItem(this.mCacheKey,{})}},pause:function(){this._clearConnections();this.mPendingItems=this.mPendingItems.concat(this.mActiveRequests);this.mDecompCtxId++;this.mActiveRequests.length=0;this.mPaused=true},resume:function(){if(this.mPaused){this.mPaused=false;this._downloadPendingItems()}},_setLifecycleListening:function(o){var n=__ngs.r_(__ngs._11).LifecycleEmitter;if(o&&!this.lifeListening){n.addListener(this,function(p){switch(p){case n.Event.Suspend:case n.Event.Terminate:this._writeManifest();break}});this.lifeListening=true}else{if(this.lifeListening){n.removeListener(this);this.lifeListening=false}}},_theQuestion:function(n){return n|!n},_setConfig:function(n){this._Config=n;this._noJS=n.omitJsUpdate;this._secureContentUrl=n.secureContentUrl},_onReadLocalManifest:function(o,p){if(this.mValid){try{if(!o){this.mLocalText=p}else{this.mLocalText="{}";this.mCacheHeadersIn=null}this._downloadManifest()}catch(n){NgLogException(n);this._processError("Error reading local manifest err: "+o,false)}}},_downloadManifest:function(){var n=0;l.OperationWithRetries((function(o,p){var q=new f();var r=this.mConnections.push(q)-1;q.onreadystatechange=(function(){if(q.readyState===4&&this.mValid){delete this.mConnections[r];n=q.status;if(n===200){this.mRemoteText=q.responseText;this.mCacheHeadersOut={};var s=q.getResponseHeader("ETag");if(s){this.mCacheHeadersOut["If-None-Match"]=s}var w=q.getResponseHeader("Last-Modified");if(w){this.mCacheHeadersOut["If-Modified-Since"]=w}this._checkItems();if(this.mCheckUpdateOnly){this._checkUpdate()}else{this._evalManifests()}}else{if(n===304){console.log("304 for manifest at "+this.mRemotePath);var u;try{u=JSON.parse(this.mLocalText);for(var t in u){if(u.hasOwnProperty(t)){this._notifyFileReady(t,true)}}this.mCacheHeadersOut={};var s=q.getResponseHeader("ETag");if(s){this.mCacheHeadersOut["If-None-Match"]=s}var w=q.getResponseHeader("Last-Modified");if(w){this.mCacheHeadersOut["If-Modified-Since"]=w}this.mDoneCb(0,u,true)}catch(v){console.log("Unable to parse: "+this.mLocalText);NgLogException(v);this.kvCache.removeItem(this.mCacheKey,{});this.mCacheHeadersIn=null;this._downloadManifest()}}else{console.log("Download of manifest at "+this.mRemotePath+l.getCacheBustingString()+" failed: "+n+" "+q.responseText);if(n===404){p()}else{o()}}}}}).bind(this);q.open("GET",this.mRemotePath+l.getCacheBustingString(),true);q.send()}).bind(this),(function(){this._processError("Failed to download manifest ("+n+")",false)}).bind(this),this.mFailEarly)},_processError:function(o,n){if(n&&this.mManifest){this._writeManifest()}if(this.mValid){this.mDoneCb(o,null,this.mLocalText?this.mLocalText.length>2:false);this.reset()}},_checkItems:function(){this.mManifest.initWithJsonText(this.mLocalText,true);var n=new k();n.initWithJsonText(this.mRemoteText);this.mManifest.foreach(n,this._compareItems.bind(this));this._sortPendingItems()},_checkUpdate:function(){this.mPendingItems.length=0;this.mCheckUpdateCallback(this.mTotalBytes>0,this.mTotalBytes)},_evalManifests:function(){try{this.mSpaceNeeded=this.mTotalBytes;var n=new k();n.initWithJsonText(this.mRemoteText);if(!n.mArchives){this.mDownloadArchives=false}this._prepareForArchiveDownload(n.mArchives,!this.mDownloadArchives);var o=this._progressIsTotal?this.mNumRemoteManifestBytes:this.mTotalBytes;this.mProgressCb(this.mCompleteBytes,o);this.mLocalGameList.freeSpace(this.mSpaceNeeded,(function(u){if(u){this._processError(u,false);return}var r=this.mPendingItems.length;if(r){console.log("Going to download %d items.",r);if(r<10){console.log("Items: "+JSON.stringify(this.mPendingItems))}if(this.prioritizePending){var q=this.prioritizePending.length;for(var s=0;s<q;++s){var t=this.prioritizePending[s];this.onNotifyFileReady(t.path,t.cb)}}}this._downloadPendingItems()}).bind(this))}catch(p){NgLogException(p);this.mDoneCb("Failed processing manifests!",null)}},_prepareForArchiveDownload:function(z,o){console.log("DownloadManfiest._prepareForArchiveDownload onlyForcedFiles:",o);var w=[];var q={};var s=0;var t=0;var u=this.mPendingItems;var n=[];var y=false;var v;for(var r=0;r<u.length;++r){v=u[r];if(!v.arcn){w.push(v);s+=v.size;continue}var p=v.arcn;var x=z[p];if(x){if(!x.files){x.files=[v]}else{x.files.push(v)}}else{NgLogE("Could not find pending file's archive in manifest archives");continue}if(q[p]){continue}if(o&&!v.arcForce){n.push(v);continue}if(this.mCompletionCallbacks[v.name]&&this.mCompletionCallbacks[v.name].length>0){if(!x.priority){x.priority=0}x.priority+=this.mCompletionCallbacks[v.name].length;y=true}w.push(x);q[p]=true;s+=x.expSize;t+=x.arcSize}for(r=0;r<n.length;++r){v=n[r];if(q[v.arcn]){continue}w.push(v);s+=v.size}this.mPendingItems=w;this.mTotalBytes=s;this.mSpaceNeeded=s+t;if(y){this._sortPendingItems()}},_compareItems:function(u,t,n){var q=t[u];var v=n[u];if(!v){var o=this.mLocalRoot+u;var r=function(w){if(w){console.log("Error deleting "+o+" error: "+w)}};j.deleteFile(o,{},r);if("pending" in q){o=o+".tmp";j.deleteFile(o,{},r)}return -1}var p=this._extensionMatch(u,"js");if(this._noJS&&(p||u==="index.html"||u==="index.json")){this._notifyFileReady(u);return 0}v.name=u;this.mNumRemoteManifestBytes+=v.size;if(!q||q.hash!==v.hash){this.mTotalBytes+=v.size;var s=this.mCompletionCallbacks[v.name];if(s&&s.length>0){v.priority=s.length}this.mPendingItems.push(v);return 1}else{if(this._progressIsTotal){console.log("adding completed bytes");this.mCompleteBytes+=v.size}}this._notifyFileReady(v.name);return 0},_extensionMatch:function(q,o){var p=new RegExp("^.*\\.("+o+")$","i");var n=q.match(p);return n},_downloadPendingItems:function(){if(this.mValid&&!this.mPaused){if(this.mPendingItems.length===0&&this.mActiveRequests.length===0){var n=function(p){if(!p){this.kvCache.setItem(this.mCacheKey,JSON.stringify(this.mCacheHeadersOut),{},function(r,q){if(r!==""){console.log("setItem callback: err="+r);return}})}else{console.log("received error! "+p)}this._writeConfig(function(){this.mDoneCb(null,this.mManifest);this.reset()}.bind(this))}.bind(this);if(this.mManifest&&this.mManifest.isModified()){this._writeManifest(n)}else{j.registerManifest(this.mLocalPath);n()}return}while(this.mPendingItems.length&&this.mActiveRequests.length<this.mConcurrentRequests){if(this._incremental===true){var o=this.mPendingItems[0];if(typeof o.priority==="number"&&o.priority>0){var o=this.mPendingItems.shift();o.retrySchedule=this.mRetrySchedule.slice(0);this._downloadItem(o)}if(this.mCompletionCallbacks&&Object.keys(this.mCompletionCallbacks).length===this.mActiveRequests.length){break}}else{var o=this.mPendingItems.shift();o.retrySchedule=this.mRetrySchedule.slice(0);this._downloadItem(o)}}this._flushManifest()}},_flushManifest:function(){var o=this;var n=function(p){o.mFlushing=false};if(!this.mFlushing&&this.mManifest._hasItems()){this.mFlushing=true;console.log("Manifest download progress, saving manifest state.");this._writeManifest(n)}},_downloadItem:function(p){this.mActiveRequests.push(p);var n=this.mRemoteUrl+p.name;if(p.mangled){var o=n.lastIndexOf(".");n=n.substr(0,o)+"-"+n.substr(o+1)+".bin"}l.OperationWithRetries((function(r){var q=new a();var s=this.mConnections.push(q)-1;if(p.files&&d){q.setOption(a.Option.VerificationHash,a.HashType.MD5,p.hash);q.setOption(a.Option.AutoDecompress,1,this.mLocalRoot)}q.start(this.mLocalRoot+p.name,"GET",n+l.getCacheBustingString(),[],this._onDownloadItemComplete.bind(this,p,r,s))}).bind(this),(function(){console.log("Manifest download failed. Too many failed download attempts for "+p.name);this._processError("Could not download file "+p.name,true)}).bind(this),this.mFailEarly)},_removeActiveRequest:function(o){for(var n in this.mActiveRequests){if(o===this.mActiveRequests[n]){this.mActiveRequests.splice(n,1);break}}},_onDownloadItemComplete:function(x,q,o,r,t,p,n){var y=this.mDecompCtxId;try{delete this.mConnections[o];if(r!==200||x.hash!==t){console.log("Download failed.  Retrying "+x.name);console.log("Status: "+r+" manifest hash: "+JSON.stringify(x.hash)+" actual hash: "+JSON.stringify(t));q();return}var w;if(x.files){this._downloadPendingItems();if(n instanceof Array){for(var s=0;s<x.files.length;++s){var u=x.files[s];this.mManifest.mJson[u.name]={size:u.size,hash:u.hash};if(typeof u.encryption!=="undefined"){this.mManifest.mJson[u.name].encryption=u.encryption}if(typeof u.is_code!=="undefined"){this.mManifest.mJson[u.name].is_code=u.is_code}}this._removeActiveRequest(x);this.mCompleteBytes+=Number(x.expSize);w=this._progressIsTotal?this.mNumRemoteManifestBytes:this.mTotalBytes;this.mProgressCb(this.mCompleteBytes,w);this._downloadPendingItems()}else{++this.mConcurrentRequests;j.decompressFile(this.mLocalRoot+x.name,this.mLocalRoot,{returnFiles:false},(function(B,A){--this.mConcurrentRequests;if(!this.mValid||y!==this.mDecompCtxId){return}j.deleteFile(this.mLocalRoot+"/"+x.name,{});if(B){console.log("Decompress failed.  Retrying "+x.name);q()}else{for(var z=0;z<x.files.length;++z){var C=x.files[z];this.mManifest.mJson[C.name]={size:C.size,hash:C.hash};if(typeof C.encryption!=="undefined"){this.mManifest.mJson[C.name].encryption=C.encryption}if(typeof C.is_code!=="undefined"){this.mManifest.mJson[C.name].is_code=C.is_code}this._notifyFileReady(C.name)}this._removeActiveRequest(x);this.mCompleteBytes+=Number(x.expSize);w=this._progressIsTotal?this.mNumRemoteManifestBytes:this.mTotalBytes;this.mProgressCb(this.mCompleteBytes,w);this._downloadPendingItems()}}).bind(this))}}else{this.mManifest.mJson[x.name]={size:x.size,hash:x.hash};if(typeof x.encryption!=="undefined"){this.mManifest.mJson[x.name].encryption=x.encryption}if(typeof x.is_code!=="undefined"){this.mManifest.mJson[x.name].is_code=x.is_code}this._removeActiveRequest(x);this.mCompleteBytes+=Number(x.size);w=this._progressIsTotal?this.mNumRemoteManifestBytes:this.mTotalBytes;this.mProgressCb(this.mCompleteBytes,w);this._notifyFileReady(x.name);this._downloadPendingItems()}}catch(v){NgLogException(v);this._processError("Error after finishing the download of item "+x+". status is "+r,true)}},_writeManifest:function(p){try{if(this.mManifest){var o=function(){j.registerManifest(this.mLocalPath);if(p){p.apply(this,arguments)}};this.mManifest.write(this.mLocalPath,o.bind(this))}}catch(n){NgLogException(n)}},_writeConfig:function(o){try{if(this._Config){j._safeWrite(this.mLocalRoot+h._getConfigFile(),JSON.stringify(this._Config),{},function(p){console.log(p);if(o){o()}})}else{if(o){o()}}}catch(n){NgLogException(n)}}})}};__ngs._3={_c:null,_d:function(){var b={exports:{}};var e=b.exports;this._c=b;var n=__ngs.r_(__ngs._6).Proc;var a=__ngs.r_(__ngs._t).Class;var h=__ngs.r_(__ngs._w).MessageListener;var c=__ngs.r_(__ngs._12).ObjectRegistry;var k=__ngs.r_(__ngs._7).Capabilities;var g=__ngs.r_(__ngs._u).Base64;var j=__ngs.r_(__ngs._13).toMD5;var m=__ngs.r_(__ngs._y).Util;var l=__ngs.r_(__ngs._11).LifecycleEmitter;var d=__ngs.r_(__ngs._14).OrientationEmitter;var f=h.subclass({initialize:function(o){l.addListener(this,this.onLifecycleUpdate);this._listener=o},destroy:function(){l.removeListener(this)},onLifecycleUpdate:function(o){switch(o){case Device.LifecycleEmitter.Event.Resume:this._listener.onResume();break}}});e.LocalGameList=a.singleton({classname:"LocalGameList",initialize:function(){c.register(this);this._createSendGen(this.__objectRegistryId);new f(this);this.mRefCount=1;this.mRefTable=[];this.mSpaceAvailable=0;this.mRequiredAvailableSpace=0;this.mSpaceCB=[];this._getRepoSpaceSendGen();var o=this;var p=__ngs.r_(__ngs._10).KeyValueCache;this.mGameStore=p.global("Core.GameList");this.mActiveGameKey="activeGames";this.onResume()},onResume:function(){this._reloadGameList()},_reloadGameList:function(){this.mGameStore.getItem(this.mActiveGameKey,{},(function(o,q){var p;if(q){p=JSON.parse(q)}else{p=[]}this.mGameList=p;if(typeof this.mListListen=="function"){this.mListListen()}}).bind(this),true)},setListListener:function(o){this.mListListen=o},_classId:302,_updateDoneRecvGen:function(p){if((p.length-p.idx)!==2){NgLogE("Could not parse due to wrong argument count in LocalGameList.updateDone from command: "+p);return false}var q=n.parseInt(p[p.idx++]);if(q===undefined){NgLogE("Could not parse id in LocalGameList.updateDone from command: "+p);return false}var o=n.parseString(p[p.idx++]);if(o===undefined){NgLogE("Could not parse error in LocalGameList.updateDone from command: "+p);return false}return this._updateDoneRecv(q,o)},_repoSpaceRecvGen:function(p){if((p.length-p.idx)!==1){NgLogE("Could not parse due to wrong argument count in LocalGameList.repoSpace from command: "+p);return false}var o=n.parseInt(p[p.idx++]);if(o===undefined){NgLogE("Could not parse space in LocalGameList.repoSpace from command: "+p);return false}return this._repoSpaceRecv(o)},_updateProgressRecvGen:function(r){if((r.length-r.idx)!==4){NgLogE("Could not parse due to wrong argument count in LocalGameList.updateProgress from command: "+r);return false}var p=n.parseString(r[r.idx++]);if(p===undefined){NgLogE("Could not parse url in LocalGameList.updateProgress from command: "+r);return false}var s=n.parseInt(r[r.idx++]);if(s===undefined){NgLogE("Could not parse cur in LocalGameList.updateProgress from command: "+r);return false}var q=n.parseInt(r[r.idx++]);if(q===undefined){NgLogE("Could not parse total in LocalGameList.updateProgress from command: "+r);return false}var o=n.parseBool(r[r.idx++]);if(o===undefined){NgLogE("Could not parse error in LocalGameList.updateProgress from command: "+r);return false}return this._updateProgressRecv(p,s,q,o)},$_createSendGen:function(o){n.appendToCommandString(19857407,[+o])},_updateGameSendGen:function(o,p){n.appendToCommandString(19791874,this,[n.encodeString(o),+p])},_getRepoSpaceSendGen:function(){n.appendToCommandString(19791876,this)},_deleteGameSendGen:function(o){n.appendToCommandString(19791878,this,[n.encodeString(o)])},__setUpdateProgressVisibleSendGen:function(o){n.appendToCommandString(19791879,this,[(o?1:0)])},__setUpdateProgressBoundsSendGen:function(o,r,p,q){n.appendToCommandString(19791880,this,[+o,+r,+p,+q])},_pauseUpdateSendGen:function(o){n.appendToCommandString(19791881,this,[n.encodeString(o)])},_resumeUpdateSendGen:function(o){n.appendToCommandString(19791882,this,[n.encodeString(o)])},_cancelUpdateSendGen:function(o){n.appendToCommandString(19791883,this,[n.encodeString(o)])},_runGameSendGen:function(o){n.appendToCommandString(19791885,this,[n.encodeString(o)])},_finishGameSendGen:function(){n.appendToCommandString(19791886,this)},__forwardExceptionSendGen:function(o){n.appendToCommandString(19791887,this,[n.encodeString(o)])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[302]=this._instance||this;PROC_METHOD_TABLE[19791875]=this.prototype._updateDoneRecvGen;PROC_METHOD_TABLE[19791877]=this.prototype._repoSpaceRecvGen;PROC_METHOD_TABLE[19791884]=this.prototype._updateProgressRecvGen},_setProgressVisible:function(o){this.progressVisible=o;this.__setUpdateProgressVisibleSendGen(o)},_setProgressBounds:function(o){this.__setUpdateProgressBoundsSendGen(o[0],o[1],o[2],o[3])},restartGame:function(){this.runGame(k.getServer()+"/"+k.getGame())},runGame:function(o){console.log("Calling runGame with "+o);if(!o){console.log("Finishing");this._finishGame()}else{this._runGameSendGen(m.NormalizeUrl(o))}},_finishGame:function(){this._finishGameSendGen()},listenUpdates:function(o){this.mUpdateListener=o},stopUpdateListening:function(){delete this.mUpdateListener},pauseUpdate:function(o){this._pauseUpdateSendGen(m.NormalizeUrl(o))},resumeUpdate:function(o){this._resumeUpdateSendGen(m.NormalizeUrl(o))},cancelUpdate:function(o){this._cancelUpdateSendGen(m.NormalizeUrl(o))},updateGame:function(p,o){var q=this.mRefCount;this.mRefTable[this.mRefCount++]=o;this._updateGameSendGen(m.NormalizeUrl(p),q);return q},updateAndRestartCurrentGame:function(){this.runUpdatedGame(k.getUrl());d.setInterfaceOrientation(d.Orientation.Portrait,false)},runUpdatedGame:function(o){if(!o){this._finishGame();return}this.updateGame(o,(function(p){if(p){NgLogE("LGL Error updating game! "+p);m.showFatalErrorDialog()}else{this.runGame(o)}}).bind(this))},_updateProgressRecv:function(p,r,q,o){if(this.mUpdateListener){this.mUpdateListener(p,r,q,o)}},_updateDoneRecv:function(q,p){this._reloadGameList();var o=q&&this.mRefTable[q];if(o){delete this.mRefTable[q];o(p)}this._getRepoSpaceSendGen()},_repoSpaceRecv:function(r){this.mSpaceAvailable=r-7340032;if(this.mRequiredAvailableSpace>this.mSpaceAvailable){var q=__ngs.r_(__ngs._i).AlertDialog;var o=new q();o.setText(Core.Localization.getString("SD card is full"));o.setChoices([Core.Localization.getString("Exit")]);o.game=this.game;o.onchoice=function(s){o.hide();l.exitProcess()};o.show()}else{for(var p=0;p<this.mSpaceCB.length;++p){this.mSpaceCB[p]()}this.mSpaceCB=[];this.mRequiredAvailableSpace=0}},getGameList:function(){return this.mGameList},updateGameList:function(o){this.mGameList=o},freeSpace:function(p,o){this.mRequiredAvailableSpace+=p;this.mSpaceCB.push(o);console.log("LocalGameList.freeSpace space=",this.mRequiredAvailableSpace);if(this.mSpaceCB.length==1){console.log("LocalGameList.sending request to native");this._getRepoSpaceSendGen()}},deleteGame:function(r){r=m.NormalizeUrl(r);var v=j(r);this._deleteGameSendGen(v);var p=this;var o=function(){NgLogD("LocalGameList finished deleting game from "+p.mActiveGameKey+" for "+v)};if(this.mGameList){var u=this.mGameList;var s=false;var t;var q=[];for(t=0;t<u.length;++t){if(u[t].name==v){s=true}else{q.push(u[t])}}if(s){NgLogD("LocalGameList found and removed "+v);this.mGameList=q}else{NgLogD("LocalGameList failed to find and remove "+v)}}else{NgLogD("LocalGameList cache not warm, can't remove "+v)}},updateAvailable:function(p,o,q){var r=__ngs.r_(__ngs._h)._int_LGL;r.updateAvailable(p,o,q)},_forwardException:function(o){this.__forwardExceptionSendGen(o)}})}};__ngs._4={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;function c(e){this.add=function(g,f){this.__defineGetter__(g,function(){delete this[g];return this[g]=f()})};for(var d in e){if(e.hasOwnProperty(d)){this.add(d,e[d])}}}a.Device=new c({LifecycleEmitter:function(){return __ngs.r_(__ngs._11).LifecycleEmitter},LocationEmitter:function(){return __ngs.r_(__ngs._15).LocationEmitter},MemoryEmitter:function(){return __ngs.r_(__ngs._16).MemoryEmitter},MotionEmitter:function(){return __ngs.r_(__ngs._17).MotionEmitter},NetworkEmitter:function(){return __ngs.r_(__ngs._18).NetworkEmitter},OrientationEmitter:function(){return __ngs.r_(__ngs._14).OrientationEmitter},ShakeEmitter:function(){return __ngs.r_(__ngs._19).ShakeEmitter},KeyEmitter:function(){return __ngs.r_(__ngs._1a).KeyEmitter},PushNotificationEmitter:function(){return __ngs.r_(__ngs._1b).PushNotificationEmitter},InAppPurchaseEmitter:function(){return __ngs.r_(__ngs._1c).InAppPurchaseEmitter},InAppPurchase:function(){return __ngs.r_(__ngs._1d).InAppPurchase},IPCEmitter:function(){return __ngs.r_(__ngs._1e).IPCEmitter},LayoutEmitter:function(){return __ngs.r_(__ngs._1f).LayoutEmitter},LocalNotification:function(){return __ngs.r_(__ngs._1g).LocalNotification},UsageStats:function(){return __ngs.r_(__ngs._1h).UsageStats},NotificationEmitter:function(){return __ngs.r_(__ngs._1i).NotificationEmitter}});a.Device.__defineGetter__("NotificationEmitter",function(){delete this.UsageStats;return this.UsageStats=__ngs.r_(__ngs._1i).NotificationEmitter});a.Device.__defineGetter__("Diagnostics",function(){delete this.Diagnostics;return this.Diagnostics=__ngs.r_(__ngs._1j).Diagnostics})}};__ngs._5={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;function c(e){this.add=function(g,f){this.__defineGetter__(g,function(){delete this[g];return this[g]=f()})};for(var d in e){if(e.hasOwnProperty(d)){this.add(d,e[d])}}}if(typeof $APP_REQUIREPATHMAP!="undefined"){$APP_REQUIREPATHMAP["NGCore/Client/Core.js"]=a}a.Core=new c({Analytics:function(){return __ngs.r_(__ngs._1k).Analytics},Base64:function(){return __ngs.r_(__ngs._u).Base64},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities},Class:function(){return __ngs.r_(__ngs._t).Class},Color:function(){return __ngs.r_(__ngs._1l).Color},Vector:function(){return __ngs.r_(__ngs._1m).Vector},Point:function(){return __ngs.r_(__ngs._1n).Point},Size:function(){return __ngs.r_(__ngs._1o).Size},Rect:function(){return __ngs.r_(__ngs._1p).Rect},MessageEmitter:function(){return __ngs.r_(__ngs._1q).MessageEmitter},MessageListener:function(){return __ngs.r_(__ngs._w).MessageListener},ObjectRegistry:function(){return __ngs.r_(__ngs._12).ObjectRegistry},Time:function(){return __ngs.r_(__ngs._1r).Time},toMD5:function(){return __ngs.r_(__ngs._13).toMD5},SHA1:function(){return __ngs.r_(__ngs._1s).SHA1},UpdateEmitter:function(){return __ngs.r_(__ngs._1t).UpdateEmitter},Proc:function(){return __ngs.r_(__ngs._6).Proc},Logger:function(){return __ngs.r_(__ngs._c).Logger},LocalGameList:function(){return __ngs.r_(__ngs._3).LocalGameList},Localization:function(){return __ngs.r_(__ngs._8).Localization},_LocalGameList:function(){return __ngs.r_(__ngs._g)._LocalGameList},NativeAppLaunch:function(){return __ngs.r_(__ngs._1u).NativeAppLaunch},ErrorEmitter:function(){return __ngs.r_(__ngs._e).ErrorEmitter},Diagnostics:function(){return __ngs.r_(__ngs._1v).Diagnostics},DiagnosticEmitter:function(){return __ngs.r_(__ngs._1w).DiagnosticEmitter},DiagnosticRegistry:function(){return __ngs.r_(__ngs._1w).DiagnosticRegistry},Buffer:function(){return __ngs.r_(__ngs._1x).Buffer},UTF8:function(){return __ngs.r_(__ngs._1y).UTF8},TypeCheck:function(){return __ngs.r_(__ngs._1z).TypeCheck}})}};__ngs._6={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var b=__ngs.r_(__ngs._t).Class;var h=__ngs.r_(__ngs._u).Base64;var a=__ngs.r_(__ngs._12).ObjectRegistry;var f="";var d={strPreCat:function(l,n,k){var m;if(l<<16<0){m="";k=n}else{m=","+n.__objectRegistryId}l=":"+(l>>16)+","+(l<<16>>16);switch(k?k.length:0){case 0:f+=l+m+",";break;case 1:f+=l+m+","+k[0];break;case 2:f+=l+m+","+k[0]+","+k[1];break;case 3:f+=l+m+","+k[0]+","+k[1]+","+k[2];break;case 4:f+=l+m+","+k[0]+","+k[1]+","+k[2]+","+k[3];break;case 5:f+=l+m+","+k[0]+","+k[1]+","+k[2]+","+k[3]+","+k[4];break;case 6:f+=l+m+","+k[0]+","+k[1]+","+k[2]+","+k[3]+","+k[4]+","+k[5];break;case 7:f+=l+m+","+k[0]+","+k[1]+","+k[2]+","+k[3]+","+k[4]+","+k[5]+","+k[6];break;case 8:f+=l+m+","+k[0]+","+k[1]+","+k[2]+","+k[3]+","+k[4]+","+k[5]+","+k[6]+","+k[7];break;case 9:f+=l+m+","+k[0]+","+k[1]+","+k[2]+","+k[3]+","+k[4]+","+k[5]+","+k[6]+","+k[7]+","+k[8];break;case 10:f+=l+m+","+k[0]+","+k[1]+","+k[2]+","+k[3]+","+k[4]+","+k[5]+","+k[6]+","+k[7]+","+k[8]+","+k[9];break;case 11:f+=l+m+","+k[0]+","+k[1]+","+k[2]+","+k[3]+","+k[4]+","+k[5]+","+k[6]+","+k[7]+","+k[8]+","+k[9]+","+k[10];break;case 12:f+=l+m+","+k[0]+","+k[1]+","+k[2]+","+k[3]+","+k[4]+","+k[5]+","+k[6]+","+k[7]+","+k[8]+","+k[9]+","+k[10]+","+k[11];break;case 13:f+=l+m+","+k[0]+","+k[1]+","+k[2]+","+k[3]+","+k[4]+","+k[5]+","+k[6]+","+k[7]+","+k[8]+","+k[9]+","+k[10]+","+k[11]+","+k[12];break;default:f+=l+m+","+k[2]+","+k[3]+","+k[4]+","+k[5]+","+k[6]+","+k[7]+","+k[8]+","+k[9]+","+k[10]+","+k[11]+","+k[12];for(var j=13;j<k.length;j++){f+=","+k[j]}}},strMulCat:function(l,n,k){var m;if(l<<16<0){m="";k=n}else{m=","+n.__objectRegistryId}l=":"+(l>>16)+","+(l<<16>>16);switch(k?k.length:0){case 0:f+=l;f+=m;break;case 1:f+=l;f+=m;f+=k[0];break;case 2:f+=l;f+=m;f+=k[0];f+=",";f+=k[1];break;case 3:f+=l;f+=m;f+=k[0];f+=",";f+=k[1];f+=",";f+=k[2];break;case 4:f+=l;f+=m;f+=k[0];f+=",";f+=k[1];f+=",";f+=k[2];f+=",";f+=k[3];break;case 5:f+=l;f+=m;f+=k[0];f+=",";f+=k[1];f+=",";f+=k[2];f+=",";f+=k[3];f+=",";f+=k[4];break;case 6:f+=l;f+=m;f+=k[0];f+=",";f+=k[1];f+=",";f+=k[2];f+=",";f+=k[3];f+=",";f+=k[4];f+=",";f+=k[5];break;case 7:f+=l;f+=m;f+=k[0];f+=",";f+=k[1];f+=",";f+=k[2];f+=",";f+=k[3];f+=",";f+=k[4];f+=",";f+=k[5];f+=",";f+=k[6];break;case 8:f+=l;f+=m;f+=k[0];f+=",";f+=k[1];f+=",";f+=k[2];f+=",";f+=k[3];f+=",";f+=k[4];f+=",";f+=k[5];f+=",";f+=k[6];f+=",";f+=k[7];break;case 9:f+=l;f+=m;f+=k[0];f+=",";f+=k[1];f+=",";f+=k[2];f+=",";f+=k[3];f+=",";f+=k[4];f+=",";f+=k[5];f+=",";f+=k[6];f+=",";f+=k[7];f+=",";f+=k[8];break;case 10:f+=l;f+=m;f+=k[0];f+=",";f+=k[1];f+=",";f+=k[2];f+=",";f+=k[3];f+=",";f+=k[4];f+=",";f+=k[5];f+=",";f+=k[6];f+=",";f+=k[7];f+=",";f+=k[8];f+=",";f+=k[9];break;case 11:f+=l;f+=m;f+=k[0];f+=",";f+=k[1];f+=",";f+=k[2];f+=",";f+=k[3];f+=",";f+=k[4];f+=",";f+=k[5];f+=",";f+=k[6];f+=",";f+=k[7];f+=",";f+=k[8];f+=",";f+=k[9];f+=",";f+=k[10];break;case 12:f+=l;f+=m;f+=k[0];f+=",";f+=k[1];f+=",";f+=k[2];f+=",";f+=k[3];f+=",";f+=k[4];f+=",";f+=k[5];f+=",";f+=k[6];f+=",";f+=k[7];f+=",";f+=k[8];f+=",";f+=k[9];f+=",";f+=k[10];f+=",";f+=k[11];break;case 13:f+=l;f+=m;f+=k[0];f+=",";f+=k[1];f+=",";f+=k[2];f+=",";f+=k[3];f+=",";f+=k[4];f+=",";f+=k[5];f+=",";f+=k[6];f+=",";f+=k[7];f+=",";f+=k[8];f+=",";f+=k[9];f+=",";f+=k[10];f+=",";f+=k[11];f+=",";f+=k[12];break;default:f+=l;f+=m;f+=",";f+=k[0];f+=",";f+=k[1];f+=",";f+=k[2];f+=",";f+=k[3];f+=",";f+=k[4];f+=",";f+=k[5];f+=",";f+=k[6];f+=",";f+=k[7];f+=",";f+=k[8];f+=",";f+=k[9];f+=",";f+=k[10];f+=",";f+=k[11];f+=",";f+=k[12];for(var j=13;j<k.length;j++){f+=",";f+=k[j]}}},strLoop:function(n,q,m){var p;if(n<<16<0){p="";m=q}else{p=","+q.__objectRegistryId}n=":"+(n>>16)+","+(n<<16>>16);var k=n+p;if(m){for(var o=0,j=m.length;o<j;o++){k+=","+m[o]}}f+=k}};var g=c.Proc=b.singleton({classname:"Proc",initialize:function(){var l=typeof $_GETENGINEENV!=="undefined"?$_GETENGINEENV():undefined;var k=typeof l=="object"?l.engine:undefined;if(typeof l=="object"&&typeof l.boundFunctions=="object"){var j=l.boundFunctions;if(j.queueCommand){this.appendToCommandString=j.queueCommand}if(j.queueSubcommand){this.appendSubcommandToCommandString=j.queueSubcommand}if(j.getCommand){this.getCommandString=j.getCommand}if(j.clearCommand){this.clearCommandString=j.clearCommand}if(j.parseInt){this.parseInt=j.parseInt}if(j.parseFloat){this.parseFloat=j.parseFloat}if(j.parseString){this.parseString=j.parseString}if(j.parseObject){this.parseObject=j.parseObject}if(j.parseBinary){this.parseBinary=j.parseBinary}if(j.encodeString){this.encodeString=j.encodeString}if(j.encodeObject){this.encodeObject=j.encodeObject}if(j.encodeBinary){this.encodeBinary=j.encodeBinary}}else{switch(k){case"v8":case"spiderMonkey":this.appendToCommandString=d.strLoop;break;case"webCore":this.appendToCommandString=d.strPreCat;break;default:this.appendToCommandString=d.strLoop}this.appendSubcommandToCommandString=function(m){f+=","+m.join()}}this.clearCommandString()},appendToCommandString:function(j){this.appendToCommandString.apply(this,arguments)},getCommandString:function(){return f},clearCommandString:function(){f=""},encodeString:h.encode,encodeBinary:h.encodeBinary,encodeObject:function(j){return this.encodeString(JSON.stringify(j))},parseBool:function(j){return j==1?true:false},parseInt:function(j){return parseInt(j,10)},parseFloat:parseFloat,parseString:h.decode,parseBinary:h.decodeBinary,parseObject:function(j){return JSON.parse(this.parseString(j))},setPrivileged:function(){this._privileged=true},isPrivileged:function(){return this._privileged?true:false},_classId:355,_classRecvGen:function(o){o.idx=1;var n=parseInt(o[0],10);var m=parseInt(o[1],10);var p=PROC_METHOD_TABLE[n<<16|(m&65535)];if(p){o.idx++;var j=(m<0)?PROC_CLASS_TABLE[n]:a.idToObject(parseInt(o[o.idx++],10));if(j){p.call(j,o)}else{NgLogW("Object instance could not be found for command "+o+" in _classRecvGen")}}else{var l=PROC_DISPATCH_TABLE[n];if(l){try{l(o)}catch(k){NgHandleException(k)}}else{NgLogE("Unknown class id "+n+" in _classRecvGen")}}},$_commandRecvGen:(function(){var j=(function(n){var l=g.parseInt(n[n.idx++],10);if(l>0){var m=g.parseInt(n[n.idx++],10);var k=a.idToObject(m);if(!k){NgLogE("Object instance could not be found for command "+n+". It may have been destroyed this frame.");return}switch(l){default:NgLogE("Unknown instance method id "+l+" in Proc._commandRecvGen from command: "+n);return}}else{switch(l){case -4:g.__loadScriptsCompleteRecv(n);break;default:NgLogE("Unknown static method id "+l+" in Proc._commandRecvGen from command: "+n);return}}});if(typeof(PROC_DISPATCH_TABLE)==="undefined"){PROC_DISPATCH_TABLE={}}PROC_DISPATCH_TABLE[355]=j;return j})(),$__loadScriptsCompleteRecvGen:function(j,k){if((j.length-j.idx)!==2){NgLogE("Could not parse due to wrong argument count in Proc._loadScriptsComplete from command: "+j);return false}k.callbackId=g.parseString(j[j.idx++]);if(k.callbackId===undefined){NgLogE("Could not parse callbackId in Proc._loadScriptsComplete from command: "+j);return false}k.error=g.parseString(j[j.idx++]);if(k.error===undefined){NgLogE("Could not parse error in Proc._loadScriptsComplete from command: "+j);return false}return true},$_setCoreJSVersionSendGen:function(j){this.appendToCommandString(23330815,[+j])},$__loadScriptsSendGen:function(j,k){this.appendToCommandString(23330814,[g.encodeString(j),+k])},$__loadScripts_pushSendGen:function(j){this.appendSubcommandToCommandString([g.encodeString(j)])},$_loadScripts:function(k,l){if(!this._codeAddingCallbacks){this._codeAddingCallbacks={uidGenerator:1}}this._codeAddingCallbacks[++this._codeAddingCallbacks.uidGenerator]=l;this.__loadScriptsSendGen(this._codeAddingCallbacks.uidGenerator,k.length);for(var j=0;j<k.length;j++){this.__loadScripts_pushSendGen(k[j])}},$__loadScriptsCompleteRecv:function(l,k){var j=l&&this._codeAddingCallbacks[l];if(j){j(k);delete this._codeAddingCallbacks[l]}},$load:function(j,k){setTimeout(k.bind(null,require(j)),1)}})}};__ngs._7={_c:null,_d:function(){var c={exports:{}};var f=c.exports;this._c=c;var a=__ngs.r_(__ngs._t).Class;var e=__ngs.r_(__ngs._12).ObjectRegistry;var l=__ngs.r_(__ngs._6).Proc;function d(p,o,n,m,q){if(p instanceof Array){return d.apply(null,p)}return p<<24|o<<18|n<<12|m<<6|q}function g(m){return[m>>24&63,m>>18&63,m>>12&63,m>>6&63,m&63]}function h(m){return d.apply(null,m.split(/\D/))}function k(m){if(typeof m=="number"){m=g(m)}while(m.length&&(0|m[m.length-1])===0){m.pop()}return m.length?m.join("."):"Invalid Version"}var j=f.Capabilities=a.singleton({classname:"Capabilities",_configFile:"configuration.json",_binaryVersion:0,_effectiveVersion:0,initialize:function(){e.register(this);this._createSendGen(this.__objectRegistryId);this._fields={version:"1.10.1.2",buildDate:"20130311",buildHash:"ga3e5944"}},_getConfigFile:function(){return this._configFile},_getAccts:function(){return this._fields._accts},compareBinaryVersion:function(n){var m=(arguments.length==1&&typeof n=="string")?h(n):d.apply(null,arguments);return this._binaryVersion-m},meetsBinaryVersion:function(m){return this.compareBinaryVersion(m)>=0},getConfigs:function(){return this._configuration},getSDKVersion:function(){return this._fields.version},getSDKBuildDate:function(){return this._fields.buildDate},getSDKBuildHash:function(){return this._fields.buildHash},getBinaryVersion:function(){return this._fields.binaryVersion},getApplicationVersion:function(){return this._fields.applicationVersion},getApplicationVersionCode:function(){return this._fields.applicationVersionCode},getBinaryBuildDate:function(){return this._fields.binaryBuildDate},getBinaryBuildHash:function(){return this._fields.binaryBuildHash},getUniqueId:function(){return this._fields.advertisingIdentifier||this._fields.uniqueId},_getClusterFID:function(){return this._fields.uniqueId},isAdTrackingEnabled:function(){return this._fields.adTrackEnabled},getLifetimeName:function(){return this._fields.identifierForVendor||this._fields.lifetimeName},_getDeviceIds:function(){return this._fields.deviceIds},getDeviceName:function(){return this._fields.deviceName},getPlatformOS:function(){return this._fields.platformOs},getPlatformOSVersion:function(){return this._fields.platformOsVersion},getPlatformHW:function(){return this._fields.platformHw},getPhysicalMem:function(){return this._fields.physicalMemory},getPhysicalCpus:function(){return this._fields.physicalCpus},getActiveCpus:function(){return this._fields.activeCpus},getLanguage:function(){return this._fields.language},_getBoot:function(){return this._fields.boot},_getBootServer:function(){return this._fields.bootServer},getBootDir:function(){return this._fields.bootDir},getGameDir:function(){return this._fields.gameDir},getProductName:function(){return this._fields.prodName},_getReferrer:function(){return this._fields.referrer},getContentUrl:function(){return this._fields.contentUrl},getBootGame:function(){return this._fields.bootgame},getStartingServer:function(){return this._fields.startingServer},getBundleGame:function(){return this._fields.bundleGame},getBundleServer:function(){return this._fields.bundleServer},getBundleIdentifier:function(){return this._fields.bundleIdentifier},getGame:function(){return this._fields.game},getServer:function(){return this._fields.server},getUrl:function(){return this._fields.url},getScreenWidth:function(){return this._fields.screenWidth},getScreenHeight:function(){return this._fields.screenHeight},getScreenUnits:function(){return this._fields.screenUnits},getScreenPixelUnits:function(){return this._fields.screenPixelUnits},getMaxTextureSize:function(){return b.getMaxTextureSize()},getMaxTextureUnits:function(){return b.getMaxTextureUnits()},getOglExtensions:function(){return b.getExtensions()},getTmpDir:function(){return this._fields.tmpDir},getHasAccel:function(){return this._fields.hasAccel},getHasGyro:function(){return this._fields.hasGyro},getHasTouch:function(){return this._fields.hasTouch},getHasMultiTouch:function(){return this._fields.hasMultiTouch},getHasGps:function(){return this._fields.hasGps},getHasCompass:function(){return this._fields.hasCompass},getHasHwKeyboard:function(){return this._fields.hasHwKeyboard},getHasBackButton:function(){return this._fields.hasBackButton},getHasCamera:function(){return this._fields.hasCamera},getHasWwan:function(){return this._fields.hasWwan},getHasWifi:function(){return this._fields.hasWifi},getCarrier:function(){return this._fields.carrier},getIntentUrl:function(){return this._fields.intentUrl},getIntentAction:function(){return this._fields.intentAction},getStatusBarHeight:function(){return this._fields.statusBarHeight},getLocale:function(){return this._fields.locale},getAvailableFonts:function(){return this._deserializedFonts||(this._deserializedFonts=JSON.parse(this._fields.availableFonts))},getAutorotateDisabled:function(){return this._fields.autorotateDisabled||false},getInstallReferrer:function(){return this._fields.installReferrer},getSocialServer:function(){return this.socialServer},getDistributionName:function(){return this._fields.distributionName},getBinaryDistributionName:function(){return this._fields.binaryDistributionName},getSourceAppID:function(){return this._fields.sourceAppID},getAppSignatures:function(){return this._fields.appSignatures},getAppReleaseVersion:function(){return this._releaseVersion},getSimCountryCode:function(){return this._fields.simCountryCode},getNetworkCountryCode:function(){return this._fields.networkCountryCode},getIsDisaggregated:function(){return this._fields.isDisaggregated},_getLogToFile:function(){return this._fields.logToFile},getUdpAvailable:function(){if(this.getPlatformOS()=="Android"||this.getPlatformOS()=="iPhone OS"){if(this.compareBinaryVersion(1,6,5)>=0){return true}}return false},getTcpAvailable:function(){if(this.compareBinaryVersion(1,6,5)>=0){return true}return false},getSslAvailable:function(){if(this.compareBinaryVersion(1,6,5)>=0){return true}return false},_getPendingNotification:function(){var m=this._fields.pendingNotification;this._fields.pendingNotification=null;if(m){return JSON.parse(m)}return null},_init:function(r){var q=[];NgParseCommandDictionary(r,2,this._fields,q);try{var m=/(https?:\/\/.+?)\/(.*)/.exec(this._fields.url);this._fields.server=m[1];this._fields.game=m[2]}catch(p){NgLogException(p)}if(!this._fields.intentUrl){this._fields.intentUrl=""}if(this._fields._accts){try{this._fields._accts=JSON.parse(this._fields._accts)}catch(p){NgLogE("Unable to parse Accounts! "+this._fields._accts);NgLogException(p)}}try{this._configuration=JSON.parse(this._fields.configJSON);this._fields.contentUrl=this._configuration.contentUrl;this.socialServer=this._configuration.socialServer;this._releaseVersion=this._configuration.releaseVersion}catch(p){NgLogE("Unable to parse config!! ("+this._fields.configJSON+")");NgLogException(p)}try{var o=h((this.getSDKVersion()||"1.0").match(/[\.\d]+$/)[0]);l._setCoreJSVersionSendGen(o);this._binaryVersion=h((this.getBinaryVersion()||"1.0").match(/[\.\d]+$/)[0]);this._effectiveVersion=Math.min(this._binaryVersion,o)}catch(p){NgLogE("Unable to parse version strings!");NgLogException(p)}try{var n;if(this.getPlatformOS()=="Android"){n={AID:this._fields.lifetimeName,TID:this._fields.uniqueId};if(this._fields.installReferrer){n.RID=this._fields.installReferrer}}else{if(this._fields.advertisingIdentifier&&this._fields.identifierForVendor&&!this._fields.identifierForVendor.match("0+-0+-0+-0+-0+")&&!this._fields.advertisingIdentifier.match("0+-0+-0+-0+-0+")){n={IFA:this._fields.advertisingIdentifier,IFV:this._fields.identifierForVendor,UDID:this._fields.uniqueId}}else{n={UDID:this._fields.uniqueId}}}this._fields.deviceIds=n;console.log("dict : deviceIds : "+JSON.stringify(this._getDeviceIds()))}catch(p){NgLogE("dict : Unable to set up device identifiers!!");NgLogException(p)}console.log("dict : JS version : "+this.getSDKVersion());console.log("dict : JS build date : "+this.getSDKBuildDate());console.log("dict : JS build hash : "+this.getSDKBuildHash());console.log("dict : contentUrl : "+this._fields.contentUrl);console.log("dict : socialServer : "+this.socialServer);console.log("dict : releaseVersion : "+this._releaseVersion)},_classId:301,$_createSendGen:function(m){l.appendToCommandString(19791871,[+m])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[301]=this._instance||this}});var b=f.Capabilities.OpenGL=a.singleton({getExtensions:function(){if(!this._extensions&&j._fields.oglExtensions){this._extensions=JSON.parse(j._fields.oglExtensions)}return this._extensions},getMaxTextureSize:function(){return j._fields.oglMaxTextureSize},getMaxTextureUnits:function(){return j._fields.oglMaxTextureUnits},getVendor:function(){return j._fields.oglVendor}})}};__ngs._8={_c:null,_d:function(){var f={exports:{}};var c=f.exports;this._c=f;var a=__ngs.r_(__ngs._7).Capabilities;var b=__ngs.r_(__ngs._1q).MessageEmitter;var d=__ngs.r_(__ngs._d).FileSystem;var e=c.LocalizationEngine=b.subclass({classname:"Localization",directoryPath:null,languageFilePath:null,initialize:function(g){if(!g){g="./Content/Localization/"}NgLogD("Localization : init ("+g+")");this.directoryPath=g;this.setLanguage(a.getLanguage())},setLanguage:function(j){var h=this.languageFilePath=this.directoryPath+j+".json";var g=this;NgLogD("Localization : reading json file "+h);NgLogT("@@@ Localization.setLanguage readFile "+h+" +");d.readFile(h,{},function(k,l){NgLogT("@@@ Localization.setLanguage readFile "+h+" -");if(k===""){NgLogD("Localization : successfully read json file "+h);g.setDictionary(j,JSON.parse(l))}else{NgLogD("Localization: unable to read json file "+h+", use default english setting instead");g.setDictionary(j,null)}})},setDictionary:function(g,h){this._lang=g;this._dictionary=h;this.emit(this._lang)},getString:function(h){if(this._dictionary&&typeof this._dictionary==="object"){var g=this._dictionary[h];if(g&&typeof g!=="undefined"){return g}}return this.unknownString(h)},unknownString:function(g){NgLogD("Localization: ... No localization for "+g+" in "+this._lang);return g}});c.Localization=e.singleton({})}};__ngs._9={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var e=__ngs.r_(__ngs._6).Proc;var a=__ngs.r_(__ngs._t).Class;var d=__ngs.r_(__ngs._20).Diagnostics;b.Device=a.singleton({classname:"Device",initialize:function(){var f=__ngs.r_(__ngs._7).Capabilities;var h=__ngs.r_(__ngs._12).ObjectRegistry;h.register(this);this._createSendGen(this.__objectRegistryId);this._volume=(f.getPlatformOS().toLowerCase()=="flash")?1:undefined;var k=__ngs.r_(__ngs._10).KeyValueCache;var j=k.global("Audio.Device.InitialValues");var g=this;j.getItem("effectsVolume",{},function(l,m){if(l){NgLogW("Audio.Device: failed in getting device volume: "+l);g._volume=1}else{g._volume=parseFloat(m)}});this.resetEffectsRequests={};this.cbIdCounter=1;this.effectCount=0;this.effectList=[];d.pushCollector(this.collectDeviceInfo.bind(this))},getEffectsVolume:function(){return this._volume},setEffectsVolume:function(f){if(f<0){f=0}if(f>1){f=1}this._volume=f;this._setEffectsVolumeSendGen(f);return this},playDetached:function(f){this._playDetachedSendGen(f);return this},resetEffects:function(g){var h=0;var f=__ngs.r_(__ngs._7).Capabilities;if(f.getPlatformOS().toLowerCase()=="android"){if(g){h=this.cbIdCounter++;this.resetEffectsRequests[h]=g}this._resetEffectsSendGen(h)}else{if(typeof(g)=="function"){g()}}return this},_resetEffectsCbRecv:function(g){var f=g&&this.resetEffectsRequests[g];if(f){delete this.resetEffectsRequests[g];f()}else{NgLogE("Audio Device command : No registered cb found..cbId is :"+g);return}},effectCreated:function(f){this.effectCount++;this.effectList.push(f)},effectDestroyed:function(){var f=this.effectList.indexOf(this._path);if(f>=0){this.effectList.splice(f,1)}this.effectCount--},collectDeviceInfo:function(g,f){var h={volume:this._volume};if(d.includeDetails()){h.effects={count:this.effectCount,effectPaths:this.effectList}}else{h.effects={count:this.effectCount}}return h},_setInitialVolume:function(f){this._volume=f},_classId:327,_resetEffectsCbRecvGen:function(g){if((g.length-g.idx)!==1){NgLogE("Could not parse due to wrong argument count in Device.resetEffectsCb from command: "+g);return false}var f=e.parseInt(g[g.idx++]);if(f===undefined){NgLogE("Could not parse callbackId in Device.resetEffectsCb from command: "+g);return false}return this._resetEffectsCbRecv(f)},$_createSendGen:function(f){e.appendToCommandString(21495807,[+f])},_setEffectsVolumeSendGen:function(f){e.appendToCommandString(21430274,this,[+f])},_playDetachedSendGen:function(f){e.appendToCommandString(21430275,this,[e.encodeString(f)])},_resetEffectsSendGen:function(f){e.appendToCommandString(21430276,this,[+f])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[327]=this._instance||this;PROC_METHOD_TABLE[21430277]=this.prototype._resetEffectsCbRecvGen}})}};__ngs._a={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;function c(e){this.add=function(g,f){this.__defineGetter__(g,function(){delete this[g];return this[g]=f()})};for(var d in e){if(e.hasOwnProperty(d)){this.add(d,e[d])}}}a.Storage=new c({KeyValue:function(){return __ngs.r_(__ngs._10).KeyValue},KeyValueCache:function(){return __ngs.r_(__ngs._10).KeyValueCache},FileSystem:function(){return __ngs.r_(__ngs._d).FileSystem},Diagnostics:function(){return __ngs.r_(__ngs._21).Diagnostics}})}};__ngs._b={_c:null,_d:function(){var d={exports:{}};var f=d.exports;this._c=d;var b=__ngs.r_(__ngs._t).Class;var j=__ngs.r_(__ngs._22).Commands;var g=__ngs.r_(__ngs._7).Capabilities;var e=__ngs.r_(__ngs._12).ObjectRegistry;var h=__ngs.r_(__ngs._23).AbstractView;var c=__ngs.r_(__ngs._24).Element;var a=__ngs.r_(__ngs._25).Rect;var k=__ngs.r_(__ngs._26).WindowLayer;j.Window=f.Window=b.singleton({_outerWidth:0,_outerHeight:0,_width:0,_height:0,initialize:function(){if(!this._outerWidth||!this._outerHeight){this.setWidthAndHeight(g.getScreenWidth(),g.getScreenHeight())}if(!this._width||!this._height){this._setWidthAndHeight(g.getScreenWidth(),g.getScreenHeight())}j.instantiate();Device.LayoutEmitter._setWindow(this);NgLogD("window: outer = "+this._outerWidth+" × "+this._outerHeight+" frame = "+this._width+" × "+this._height)},document:k.singleton({type:"document",register:function(){this.__objectRegistryId=0}}),_layers:{},_getLayer:function(l){return this._layers[l]||(this._layers[l]=new k({level:l||0}))},destroyObject:function(l){l.removeFromParent();j.destroy.call(l);e.unregister(l)},handleCommand:function(m){var l=NgParseCommand2(m,NgParseInt,NgParseBase64);this.doCommand(l[1])},setStatusBarHidden:function(l){j.setStatusBarHidden(l);this._outerHeight=g.getScreenHeight()-(l?0:(g.getStatusBarHeight()||0))},doCommand:function(o){var r=typeof o=="string"?JSON.parse(o):o;if(r.name=="callback"){var l=j.takeTemporaryCallback(r.callback_id);if(typeof l=="function"){l(r)}}else{var m=e.idToObject(r.objId);if(m instanceof c){switch(r.name){case"event":m.performEventCallback(r);break;case"update":var n=r.properties||{};for(var p in n){try{var s=m["update"+p.charAt(0).toUpperCase()+p.substr(1)];if(typeof s=="function"){s.apply(m,[n[p]])}else{m["_"+p]=n[p]}}catch(q){}}break;default:m.handleCommand(r)}}else{console.log("Message received for non-element object with id "+r.objId);return}}},log:function(l){NgLogD(l.toString())},getWidth:function(){return this._width},getHeight:function(){return this._height},getOuterWidth:function(){return this._outerWidth},getOuterHeight:function(){return this._outerHeight},getFrame:function(){return new a(0,0,this._width,this._height)}});j.Window.__defineGetter__("outerWidth",function(){return this.getOuterWidth()});j.Window.__defineGetter__("outerHeight",function(){return this.getOuterHeight()});j.Window._setWidthAndHeight=function(m,l){console.log("window: set layout size to: "+m+" × "+l);this._width=m;this._height=l};j.Window.setWidthAndHeight=function(m,l){console.log("window: set outer size to: "+m+" × "+l);this._outerWidth=m;this._outerHeight=l}}};__ngs._c={_c:null,_d:function(){var e={exports:{}};var d=e.exports;this._c=e;var c=__ngs.r_(__ngs._t).Class;var g=__ngs.r_(__ngs._6).Proc;var b=__ngs.r_(__ngs._12).ObjectRegistry;var h=__ngs.r_(__ngs._27).sprintf;var f=__ngs.r_(__ngs._u).Base64;var a=c.singleton({classname:"Logger",initialize:function(){b.register(this);this._createSendGen(this.__objectRegistryId);timingLog=function(k,j){}},_disable:function(){console.log("Logger : javascript logging disabled");console.log=a.log=function(k,j){};timingLog=function(k,j){}},_enable:function(j){timingLog=function(o,l){var m;if(arguments.length>1){try{var q=[];for(m=0;m<arguments.length;++m){q[m]=arguments[m]}var k=h(q);q.unshift(k);o=q.join(" ")}catch(n){var p=[];for(m=0;m<arguments.length;++m){p[m]=arguments[m]}o=p.join(" ")}}__underscore_SysLog(o)};if(j){return}console.log=a.log=function(o,l){if(arguments.length>1){var m;try{var q=[];for(m=0;m<arguments.length;++m){q[m]=arguments[m]}var k=h(q);q.unshift(k);o=q.join(" ")}catch(n){var p=[];for(m=0;m<arguments.length;++m){p[m]=arguments[m]}o=p.join(" ")}}if(typeof o!=="string"){o=""+o}__underscore_SysLog(o)};console.log("Logger : javascript logging enabled")},log:function(k,j){},_classId:305,$_createSendGen:function(j){g.appendToCommandString(20054015,[+j])},_logSendGen:function(j){g.appendToCommandString(19988482,this,[g.encodeString(j)])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[305]=this._instance||this}});a.instantiate();__underscore_SysLog=function(j){a._logSendGen(j)};if(typeof(_NG_TARGET_FLASH)=="undefined"){console.log=a.log}d.Logger=a}};__ngs._d={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var g=__ngs.r_(__ngs._6).Proc;var b=__ngs.r_(__ngs._t).Class;var a=__ngs.r_(__ngs._7).Capabilities;var f=__ngs.r_(__ngs._21).Diagnostics;var e=function(j,h){this.code=j;this.description=h;return this};e.prototype={classname:"FileSystemError",toString:function(){return this.className+" "+this.code+": "+this.description}};c.FileSystem=b.singleton({classname:"FileSystem",_options:{blocking:1,binary:2,useBinaryCb:4,returnFiles:256,returnMd5:512},initialize:function(){this.readRequests={};this.writeRequests={};this.statRequests={};this.cbIdCounter=1;var h=__ngs.r_(__ngs._12).ObjectRegistry;h.register(this);this._createSendGen(this.__objectRegistryId);this._readCount=0;this._writeCount=0;this._deleteCount=0;this._renameCount=0;this._decompressCount=0;this._statCount=0;f.pushCollector(this.collectDiagnostics.bind(this))},readFile:function(k,j,h){this.readFileIn(this.Store.Local,k,j,h)},readFileIn:function(j,o,k,h){var n,l=0;this._readCount++;if(typeof(k)!=="object"){NgLogW("FileSystem.readFile/readFileIn(): using deprecated function signature");var m=k;if(typeof(m)=="function"){h=m;m=false}m=m||false;if(h){l=this.cbIdCounter++;this.readRequests[l]=h}n=this._options.blocking;if(m){n|=this._options.binary|this._options.useBinaryCb}this._readFileAsyncSendGen(l,j,o,n)}else{n=0;if(k.blocking){n|=this._options.blocking}if(k.binary){n|=this._options.binary|this._options.useBinaryCb}if(h){l=this.cbIdCounter++;this.readRequests[l]=h}this._readFileAsyncSendGen(l,j,o,n)}},writeFile:function(l,k,j,h){this.writeFileIn(this.Store.Local,l,k,j,h)},_safeWrite:function(n,m,j,h){var l=n+".fstmp"+Math.random();var k=function(o){if(o){h(o)}else{this.renameFile(l,n,j,h)}}.bind(this);this.writeFile(l,m,j,k)},writeFileIn:function(j,p,m,k,h){var l=0;this._writeCount++;if(typeof(k)!=="object"){NgLogW("FileSystem.writeFile/writeFileIn(): using deprecated function signature");var o=k;if(typeof(o)=="function"){h=o;o=false}o=o||false;if(h){l=this.cbIdCounter++;this.writeRequests[l]=h}this._writeFileSendGen(l,j,p,m,o)}else{var n=0;if(k.blocking){n|=this._options.blocking}if(k.binary){n|=this._options.binary}if(h){l=this.cbIdCounter++;this.writeRequests[l]=h}if((n&this._options.binary)!==0&&a.compareBinaryVersion(1,4)>=0){this._writeFileAsyncBinarySendGen(l,j,p,m,n)}else{this._writeFileAsyncSendGen(l,j,p,m,n)}}},deleteFile:function(k,j,h){this.deleteFileIn(this.Store.Local,k,j,h)},deleteFileIn:function(j,n,k,h){var l=0;this._deleteCount++;if(typeof(k)!=="object"){NgLogW("FileSystem.deleteFile/deleteFileIn(): using deprecated function signature");h=k;if(h){l=this.cbIdCounter++;this.writeRequests[l]=h}this._deleteFileSendGen(l,j,n)}else{var m=0;if(k.blocking){m|=this._options.blocking}if(h){l=this.cbIdCounter++;this.writeRequests[l]=h}this._deleteFileAsyncSendGen(l,j,n,m)}},decompressFile:function(l,j,k,h){this.decompressFileIn(this.Store.Local,l,j,k,h)},decompressFileIn:function(k,p,j,l,h){var n=0;this._decompressCount++;if(typeof(l)!=="object"){NgLogW("FileSystem.decompressFile/decompressFileIn(): using deprecated function signature");var m=l;if(h){n=this.cbIdCounter++;this.writeRequests[n]=h}this._decompressFileSendGen(n,k,p,j,m)}else{var o=0;if(l.blocking){o|=this._options.blocking}if(l.returnFiles){o|=this._options.returnFiles}if(h){n=this.cbIdCounter++;this.writeRequests[n]=h}this._decompressFileAsyncSendGen(n,k,p,j,o)}},renameFile:function(l,k,j,h){this.renameFileIn(this.Store.Local,l,k,j,h)},renameFileIn:function(j,o,m,k,h){var l=0;var n=0;this._renameCount++;if(a.compareBinaryVersion(1,4)<0){if(typeof(k)=="function"){h=k}if(h){h("Not supported")}return}if(typeof(k)!=="object"){h=k}else{if(k.blocking){n|=this._options.blocking}}if(h){l=this.cbIdCounter++;this.writeRequests[l]=h}this._renameFileAsyncSendGen(l,j,o,m,n)},unpack:function(j,h){this.stat(j,{},h)},stat:function(k,j,h){this.statIn(this.Store.Local,k,j,h)},statIn:function(j,l,k,h){var m=0;var n=0;this._statCount++;if(a.compareBinaryVersion(1,6)<0){if(typeof(k)=="function"){h=k}if(h){h(new e(this.ErrorCode.Unsupported,"Not Supported"))}return}if(typeof(k)!=="object"){h=k}else{if(k.blocking){n=this._options.blocking}if(k.returnMd5){n|=this._options.returnMd5}}if(h){m=this.cbIdCounter++;this.statRequests[m]=h}this._statAsyncSendGen(m,j,l,n)},registerManifest:function(j,h){if(h){h("")}},_readFileCbRecv:function(k,j,h){this._readFileCbRecvCore(k,j,h)},_readFileBinaryCbRecv:function(k,j,h){this._readFileCbRecvCore(k,j,h)},_readFileCbRecvCore:function(k,l,j){var h=k&&this.readRequests[k];if(h){delete this.readRequests[k];h(j,l)}else{NgLogE("FileSystem.onReadFile: No callback found for id :"+k)}},_writeFileCbRecv:function(k,j){var h=k&&this.writeRequests[k];if(h){delete this.writeRequests[k];h(j)}else{NgLogE("FileSystem onWriteFile : No callback found for id :"+k)}},_deleteFileCbRecv:function(k,j){var h=k&&this.writeRequests[k];if(h){delete this.writeRequests[k];h(j)}else{NgLogE("FileSystem onDeleteFile : No callback found for id :"+k)}},_decompressFileCbRecv:function(k,l,j){var h=k&&this.writeRequests[k];if(h){try{l=JSON.parse(l)}catch(m){NgLogE("FileSystem onDecompressFile : Could not parse response :"+l);j="Could not parse files";l=[]}delete this.writeRequests[k];try{h(j,l)}catch(m){console.log("Error calling back on decompressFile!");NgLogException(m)}}else{NgLogE("FileSystem onDecompressFile : No callback found for id :"+k)}},_renameFileCbRecv:function(k,j){var h=k&&this.writeRequests[k];if(h){delete this.writeRequests[k];h(j)}else{NgLogE("FileSystem onRenameFile : No callback found for id :"+k)}},_statCbRecv:function(k,l,j){var h=k&&this.statRequests[k];if(h){delete this.statRequests[k];h(j?JSON.parse(j):null,l?JSON.parse(l):null)}else{NgLogE("FileSystem onStatFile : No callback found for id :"+k)}},_registerManifestCbRecv:function(k,j){var h=k&&this.registerManifestRequests[k];if(h){delete this.registerManifestRequests[k];h(j)}else{NgLogE(" FileSystem onRegisterManifest : No callback found for id :"+k)}},_readLineRangeFromFile:function(h,p,o,q,j,l,k){if(!a.meetsBinaryVersion("1.8.5")){k("incompatible binary");return}var m,n=0;this._readCount++;if(typeof(p)!=="object"){m=this._options.blocking}else{m=0;if(p.blocking){m|=this._options.blocking}}if(k){n=this.cbIdCounter++;this.readRequests[n]=k}this._readLineRangeFromFileAsyncSendGen(n,this.Store.Local,h,o,q,j,l,m)},Store:{Temp:0,Local:1},ErrorCode:{Unknown:-1,NotFound:-2,Unsupported:-3},_classId:338,_readFileCbRecvGen:function(l){if((l.length-l.idx)!==3){NgLogE("Could not parse due to wrong argument count in FileSystem.readFileCb from command: "+l);return false}var k=g.parseInt(l[l.idx++]);if(k===undefined){NgLogE("Could not parse callbackId in FileSystem.readFileCb from command: "+l);return false}var j=g.parseString(l[l.idx++]);if(j===undefined){NgLogE("Could not parse data in FileSystem.readFileCb from command: "+l);return false}var h=g.parseString(l[l.idx++]);if(h===undefined){NgLogE("Could not parse error in FileSystem.readFileCb from command: "+l);return false}return this._readFileCbRecv(k,j,h)},_writeFileCbRecvGen:function(k){if((k.length-k.idx)!==2){NgLogE("Could not parse due to wrong argument count in FileSystem.writeFileCb from command: "+k);return false}var j=g.parseInt(k[k.idx++]);if(j===undefined){NgLogE("Could not parse callbackId in FileSystem.writeFileCb from command: "+k);return false}var h=g.parseString(k[k.idx++]);if(h===undefined){NgLogE("Could not parse error in FileSystem.writeFileCb from command: "+k);return false}return this._writeFileCbRecv(j,h)},_deleteFileCbRecvGen:function(k){if((k.length-k.idx)!==2){NgLogE("Could not parse due to wrong argument count in FileSystem.deleteFileCb from command: "+k);return false}var j=g.parseInt(k[k.idx++]);if(j===undefined){NgLogE("Could not parse callbackId in FileSystem.deleteFileCb from command: "+k);return false}var h=g.parseString(k[k.idx++]);if(h===undefined){NgLogE("Could not parse error in FileSystem.deleteFileCb from command: "+k);return false}return this._deleteFileCbRecv(j,h)},_decompressFileCbRecvGen:function(l){if((l.length-l.idx)!==3){NgLogE("Could not parse due to wrong argument count in FileSystem.decompressFileCb from command: "+l);return false}var k=g.parseInt(l[l.idx++]);if(k===undefined){NgLogE("Could not parse callbackId in FileSystem.decompressFileCb from command: "+l);return false}var j=g.parseString(l[l.idx++]);if(j===undefined){NgLogE("Could not parse files in FileSystem.decompressFileCb from command: "+l);return false}var h=g.parseString(l[l.idx++]);if(h===undefined){NgLogE("Could not parse error in FileSystem.decompressFileCb from command: "+l);return false}return this._decompressFileCbRecv(k,j,h)},_readFileBinaryCbRecvGen:function(l){if((l.length-l.idx)!==3){NgLogE("Could not parse due to wrong argument count in FileSystem.readFileBinaryCb from command: "+l);return false}var k=g.parseInt(l[l.idx++]);if(k===undefined){NgLogE("Could not parse callbackId in FileSystem.readFileBinaryCb from command: "+l);return false}var j=g.parseBinary(l[l.idx++]);if(j===undefined){NgLogE("Could not parse data in FileSystem.readFileBinaryCb from command: "+l);return false}var h=g.parseString(l[l.idx++]);if(h===undefined){NgLogE("Could not parse error in FileSystem.readFileBinaryCb from command: "+l);return false}return this._readFileBinaryCbRecv(k,j,h)},_renameFileCbRecvGen:function(k){if((k.length-k.idx)!==2){NgLogE("Could not parse due to wrong argument count in FileSystem.renameFileCb from command: "+k);return false}var j=g.parseInt(k[k.idx++]);if(j===undefined){NgLogE("Could not parse callbackId in FileSystem.renameFileCb from command: "+k);return false}var h=g.parseString(k[k.idx++]);if(h===undefined){NgLogE("Could not parse error in FileSystem.renameFileCb from command: "+k);return false}return this._renameFileCbRecv(j,h)},_registerManifestCbRecvGen:function(k){if((k.length-k.idx)!==2){NgLogE("Could not parse due to wrong argument count in FileSystem.registerManifestCb from command: "+k);return false}var j=g.parseInt(k[k.idx++]);if(j===undefined){NgLogE("Could not parse callbackId in FileSystem.registerManifestCb from command: "+k);return false}var h=g.parseString(k[k.idx++]);if(h===undefined){NgLogE("Could not parse error in FileSystem.registerManifestCb from command: "+k);return false}return this._registerManifestCbRecv(j,h)},_statCbRecvGen:function(l){if((l.length-l.idx)!==3){NgLogE("Could not parse due to wrong argument count in FileSystem.statCb from command: "+l);return false}var k=g.parseInt(l[l.idx++]);if(k===undefined){NgLogE("Could not parse callbackId in FileSystem.statCb from command: "+l);return false}var j=g.parseString(l[l.idx++]);if(j===undefined){NgLogE("Could not parse data in FileSystem.statCb from command: "+l);return false}var h=g.parseString(l[l.idx++]);if(h===undefined){NgLogE("Could not parse error in FileSystem.statCb from command: "+l);return false}return this._statCbRecv(k,j,h)},$_createSendGen:function(h){g.appendToCommandString(22216703,[+h])},_readFileSendGen:function(k,h,j,l){g.appendToCommandString(22151170,this,[+k,+h,g.encodeString(j),(l?1:0)])},_writeFileSendGen:function(l,h,j,k,m){g.appendToCommandString(22151171,this,[+l,+h,g.encodeString(j),g.encodeString(k),(m?1:0)])},_deleteFileSendGen:function(k,h,j){g.appendToCommandString(22151172,this,[+k,+h,g.encodeString(j)])},_decompressFileSendGen:function(m,j,k,h,l){g.appendToCommandString(22151173,this,[+m,+j,g.encodeString(k),g.encodeString(h),(l?1:0)])},_readFileAsyncSendGen:function(l,h,j,k){g.appendToCommandString(22151178,this,[+l,+h,g.encodeString(j),+k])},_writeFileAsyncSendGen:function(m,h,j,l,k){g.appendToCommandString(22151179,this,[+m,+h,g.encodeString(j),g.encodeString(l),+k])},_deleteFileAsyncSendGen:function(l,h,j,k){g.appendToCommandString(22151180,this,[+l,+h,g.encodeString(j),+k])},_decompressFileAsyncSendGen:function(m,j,k,h,l){g.appendToCommandString(22151181,this,[+m,+j,g.encodeString(k),g.encodeString(h),+l])},_writeFileAsyncBinarySendGen:function(m,h,j,l,k){g.appendToCommandString(22151183,this,[+m,+h,g.encodeString(j),g.encodeBinary(l),+k])},_renameFileAsyncSendGen:function(l,h,m,k,j){g.appendToCommandString(22151184,this,[+l,+h,g.encodeString(m),g.encodeString(k),+j])},_registerManifestSendGen:function(j,h){g.appendToCommandString(22151186,this,[+j,g.encodeString(h)])},_statAsyncSendGen:function(l,h,k,j){g.appendToCommandString(22151188,this,[+l,+h,g.encodeString(k),+j])},_readLineRangeFromFileAsyncSendGen:function(n,j,k,p,h,m,o,l){g.appendToCommandString(22151190,this,[+n,+j,g.encodeString(k),+p,+h,+m,+o,+l])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[338]=this._instance||this;PROC_METHOD_TABLE[22151174]=this.prototype._readFileCbRecvGen;PROC_METHOD_TABLE[22151175]=this.prototype._writeFileCbRecvGen;PROC_METHOD_TABLE[22151176]=this.prototype._deleteFileCbRecvGen;PROC_METHOD_TABLE[22151177]=this.prototype._decompressFileCbRecvGen;PROC_METHOD_TABLE[22151182]=this.prototype._readFileBinaryCbRecvGen;PROC_METHOD_TABLE[22151185]=this.prototype._renameFileCbRecvGen;PROC_METHOD_TABLE[22151187]=this.prototype._registerManifestCbRecvGen;PROC_METHOD_TABLE[22151189]=this.prototype._statCbRecvGen},collectDiagnostics:function(j,h){var k={readFile:{count:this._readCount},writeFile:{count:this._writeCount},deleteFile:{count:this._deleteCount},renameFile:{count:this._renameCount},decompressFile:{count:this._decompressCount},stat:{count:this._statCount}};return k}})}};__ngs._e={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var a=__ngs.r_(__ngs._1q).MessageEmitter;var b=__ngs.r_(__ngs._12).ObjectRegistry;var e=__ngs.r_(__ngs._6).Proc;c.ErrorEmitter=a.singleton({classname:"ErrorEmitter",initialize:function(){b.register(this);this._createSendGen(this.__objectRegistryId);this._errorReportPostUrl=null},setErrorReportPostUrl:function(f){this._errorReportPostUrl=f},_raiseRecv:function(f){this.emit(f)},_handleUncaughtException:function(f){var g=this;if(this._hasErrorReportUrl()){this._checkUserHasAcceptedSendingErrorReport(function(h){if(h){g._sendErrorReport(f);return}g._checkUserHasAskedForPermission(function(j){if(j){return}g._showErrorReportAskPermissionDialog(function(k){if(k){g._setUserAcceptedSendingErrorReport();g._sendErrorReport(f)}else{g._setAlreadyAsked()}})})})}this.emit(f)},_hasErrorReportUrl:function(){return this._errorReportPostUrl!==null},_checkUserHasAcceptedSendingErrorReport:function(h){var g=__ngs.r_(__ngs._10).KeyValueCache;var f=g.global("ErrorReporter");return f.getItem("userHasAcceptedSendingErrorReport",{},function(j,k){h(j?false:k)})},_checkUserHasAskedForPermission:function(h){var g=__ngs.r_(__ngs._10).KeyValueCache;var f=g.global("ErrorReporter");return f.getItem("userHasAskedForPermission",{},function(j,k){h(j?false:k)})},_setAlreadyAsked:function(){var g=__ngs.r_(__ngs._10).KeyValueCache;var f=g.global("ErrorReporter");f.setItem("userHasAskedForPermission","true",{},function(){})},_setUserAcceptedSendingErrorReport:function(){var g=__ngs.r_(__ngs._10).KeyValueCache;var f=g.global("ErrorReporter");f.setItem("userHasAcceptedSendingErrorReport","true",{},function(){})},_showErrorReportAskPermissionDialog:function(h){var g=__ngs.r_(__ngs._i).AlertDialog;var f=new g({title:"Application has a problem",text:"Send an error report to the developer?",choices:["No","Yes"]});f.setOnChoice(function(j){f.hide();h(j.choice===1)});f.show()},_sendErrorReport:function(j){var f=this._gatherEnvironmentInfo();var k=JSON.stringify({environment:f,error:j});var h=__ngs.r_(__ngs._x).XHR;var g=new h();g.open("POST",this._errorReportPostUrl,true);g.onreadystatechange=function(){};g.send(k)},_gatherEnvironmentInfo:function(){var f=__ngs.r_(__ngs._7).Capabilities;var g={SDKVersion:f.getSDKVersion(),SDKBuildDate:f.getSDKBuildDate(),SDKBuildHash:f.getSDKBuildHash(),BinaryVersion:f.getBinaryVersion(),BinaryBuildDate:f.getBinaryBuildDate(),DeviceName:f.getDeviceName(),PlatformOS:f.getPlatformOS(),PlatformOsVersion:f.getPlatformOSVersion(),PlatformHW:f.getPlatformHW(),PhysicalMem:f.getPhysicalMem(),PhysicalCpus:f.getPhysicalCpus(),ActiveCpus:f.getActiveCpus(),Language:f.getLanguage(),BootDir:f.getBootDir(),GameDir:f.getGameDir(),ProductName:f.getProductName(),ContentUrl:f.getContentUrl(),BootGame:f.getBootGame(),StartingServer:f.getStartingServer(),BundleGame:f.getBundleGame(),BundleServer:f.getBundleServer(),BundleIdentifier:f.getBundleIdentifier(),Game:f.getGame(),Server:f.getServer(),Url:f.getUrl(),ScreenWidth:f.getScreenWidth(),ScreenHeight:f.getScreenHeight(),ScreenUnits:f.getScreenUnits(),ScreenPixelUnits:f.getScreenPixelUnits(),MaxTextureSize:f.getMaxTextureSize(),MaxTextureUnits:f.getMaxTextureUnits(),OglExtentions:f.getOglExtensions(),HasAccel:f.getHasAccel(),HasGyro:f.getHasGyro(),HasTouch:f.getHasTouch(),HasMultiTouch:f.getHasMultiTouch(),HasGps:f.getHasGps(),HasCompass:f.getHasCompass(),HasHwKeyboard:f.getHasHwKeyboard(),HasBackButton:f.getHasBackButton(),HasCamera:f.getHasCamera(),HasWwan:f.getHasWwan(),HasWifi:f.getHasWifi(),Career:f.getCarrier(),Locale:f.getLocale(),AppReleaseVersion:f.getAppReleaseVersion(),SimCountryCode:f.getSimCountryCode(),NetworkCountryCode:f.getNetworkCountryCode(),UdpAvailable:f.getUdpAvailable(),TcpAvailable:f.getTcpAvailable(),SslAvailable:f.getSslAvailable()};return g},_classId:359,_raiseRecvGen:function(g){if((g.length-g.idx)!==1){NgLogE("Could not parse due to wrong argument count in ErrorEmitter.raise from command: "+g);return false}var f=e.parseString(g[g.idx++]);if(f===undefined){NgLogE("Could not parse errorMessage in ErrorEmitter.raise from command: "+g);return false}return this._raiseRecv(f)},$_createSendGen:function(f){e.appendToCommandString(23592959,[+f])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[359]=this._instance||this;PROC_METHOD_TABLE[23527426]=this.prototype._raiseRecvGen}})}};__ngs._f={_c:null,_d:function(){var c={exports:{}};var a=c.exports;this._c=c;function b(e,d){return function(){delete this[e];return this[e]=d.call(this)}}a.RequireLoaderGen=function(d){return function(f){if(f instanceof Object){for(var e in f){this.__defineGetter__(e,d.call(this,e,f[e]))}}return this}};a.RequireLoader=a.RequireLoaderGen(b);a.RequireLoader.prototype={load:function(d){this[d]}}}};__ngs._g={_c:null,_d:function(){var b={exports:{}};var d=b.exports;this._c=b;var a=__ngs.r_(__ngs._t).Class;var l=__ngs.r_(__ngs._6).Proc;var c=__ngs.r_(__ngs._12).ObjectRegistry;var j=__ngs.r_(__ngs._7).Capabilities;var g=__ngs.r_(__ngs._1r).Time;var h=__ngs.r_(__ngs._13).toMD5;var k=__ngs.r_(__ngs._y).Util;var f=__ngs.r_(__ngs._u).Base64;var e=d._LocalGameList=a.singleton({classname:"_LocalGameList",initialize:function(){c.register(this);this._createSendGen(this.__objectRegistryId);this.mGameList=[];var m=__ngs.r_(__ngs._a).Storage;this.mFile=m.FileSystem;this.mGameStore=m.KeyValueCache.global("Core.GameList");this.mLoadingGames={};this.mActiveGameKey="activeGames";this.mRequiredAvailableSpace=0;this.mSpaceAvailable=0;this.mSpaceFreeCallbacks=[];this._firstBootGameLaunch=true;this._getRepoSpaceSendGen();this._setStage(this.ProgressStage.BootFirst);this._reloadGameList();this._allowDeterminateProgress=true},ProgressStage:{BootFirst:{boot:[-1,0],progressBar:[0,0.25]},CheckConfiguration:{boot:[-1,0],progressBar:[0.25,0.25]},CheckManifest:{boot:[-1,0],progressBar:[0.25,0.25]},DownloadFiles:{boot:[0.1,0.9],progressBar:[0.25,0.75]},Launching:{boot:[-1,0],progressBar:[0.75,1]}},_setStage:function(m){this._progressStage=m;if(typeof m=="object"){this._progressMin=this._progressStage[this._hasProgressBar?"progressBar":"boot"][0];this._progressRange=this._progressStage[this._hasProgressBar?"progressBar":"boot"][1]}else{this._progressMin=-1;this._progressRange=0}console.log("min:",this._progressMin,"range:",this._progressRange);this._setProgress(0)},_nextStage:function(){switch(this._progressStage){case this.ProgressStage.BootFirst:this._setStage(this.ProgressStage.CheckConfiguration);break;case this.ProgressStage.CheckConfiguration:this._setStage(this.ProgressStage.CheckManifest);break;case this.ProgressStage.CheckManifest:this._setStage(this.ProgressStage.DownloadFiles);break;case this.ProgressStage.DownloadFiles:this._setStage(this.ProgressStage.Launching);break}},_classId:303,_updateGameRecvGen:function(n){if((n.length-n.idx)!==2){NgLogE("Could not parse due to wrong argument count in _LocalGameList.updateGame from command: "+n);return false}var m=l.parseString(n[n.idx++]);if(m===undefined){NgLogE("Could not parse url in _LocalGameList.updateGame from command: "+n);return false}var o=l.parseInt(n[n.idx++]);if(o===undefined){NgLogE("Could not parse id in _LocalGameList.updateGame from command: "+n);return false}return this._updateGameRecv(m,o)},_repoSpaceRecvGen:function(n){if((n.length-n.idx)!==1){NgLogE("Could not parse due to wrong argument count in _LocalGameList.repoSpace from command: "+n);return false}var m=l.parseInt(n[n.idx++]);if(m===undefined){NgLogE("Could not parse space in _LocalGameList.repoSpace from command: "+n);return false}return this._repoSpaceRecv(m)},_deleteGameRecvGen:function(n){if((n.length-n.idx)!==2){NgLogE("Could not parse due to wrong argument count in _LocalGameList.deleteGame from command: "+n);return false}var o=l.parseString(n[n.idx++]);if(o===undefined){NgLogE("Could not parse mdFive in _LocalGameList.deleteGame from command: "+n);return false}var m=l.parseString(n[n.idx++]);if(m===undefined){NgLogE("Could not parse game in _LocalGameList.deleteGame from command: "+n);return false}return this._deleteGameRecv(o,m)},_pauseUpdateRecvGen:function(n){if((n.length-n.idx)!==1){NgLogE("Could not parse due to wrong argument count in _LocalGameList.pauseUpdate from command: "+n);return false}var m=l.parseString(n[n.idx++]);if(m===undefined){NgLogE("Could not parse url in _LocalGameList.pauseUpdate from command: "+n);return false}return this._pauseUpdateRecv(m)},_resumeUpdateRecvGen:function(n){if((n.length-n.idx)!==1){NgLogE("Could not parse due to wrong argument count in _LocalGameList.resumeUpdate from command: "+n);return false}var m=l.parseString(n[n.idx++]);if(m===undefined){NgLogE("Could not parse url in _LocalGameList.resumeUpdate from command: "+n);return false}return this._resumeUpdateRecv(m)},_cancelUpdateRecvGen:function(n){if((n.length-n.idx)!==1){NgLogE("Could not parse due to wrong argument count in _LocalGameList.cancelUpdate from command: "+n);return false}var m=l.parseString(n[n.idx++]);if(m===undefined){NgLogE("Could not parse url in _LocalGameList.cancelUpdate from command: "+n);return false}return this._cancelUpdateRecv(m)},_allowBGUpdatesRecvGen:function(n){if((n.length-n.idx)!==1){NgLogE("Could not parse due to wrong argument count in _LocalGameList.allowBGUpdates from command: "+n);return false}var m=l.parseBool(n[n.idx++]);if(m===undefined){NgLogE("Could not parse allow in _LocalGameList.allowBGUpdates from command: "+n);return false}return this._allowBGUpdatesRecv(m)},_runGameRecvGen:function(n){if((n.length-n.idx)!==1){NgLogE("Could not parse due to wrong argument count in _LocalGameList.runGame from command: "+n);return false}var m=l.parseString(n[n.idx++]);if(m===undefined){NgLogE("Could not parse url in _LocalGameList.runGame from command: "+n);return false}return this._runGameRecv(m)},_finishGameRecvGen:function(m){if((m.length-m.idx)!==0){NgLogE("Could not parse due to wrong argument count in _LocalGameList.finishGame from command: "+m);return false}return this._finishGameRecv()},_exceptionForwardedRecvGen:function(m){if((m.length-m.idx)!==1){NgLogE("Could not parse due to wrong argument count in _LocalGameList.exceptionForwarded from command: "+m);return false}var n=l.parseString(m[m.idx++]);if(n===undefined){NgLogE("Could not parse exceptionString in _LocalGameList.exceptionForwarded from command: "+m);return false}return this._exceptionForwardedRecv(n)},_setHasCustomProgressBarRecvGen:function(n){if((n.length-n.idx)!==1){NgLogE("Could not parse due to wrong argument count in _LocalGameList.setHasCustomProgressBar from command: "+n);return false}var m=l.parseBool(n[n.idx++]);if(m===undefined){NgLogE("Could not parse hasProgressBar in _LocalGameList.setHasCustomProgressBar from command: "+n);return false}return this._setHasCustomProgressBarRecv(m)},$_gameUnbundledRecvGen:function(m){if((m.length-m.idx)!==0){NgLogE("Could not parse due to wrong argument count in _LocalGameList.gameUnbundled from command: "+m);return false}return this._gameUnbundledRecv()},$_createSendGen:function(m){l.appendToCommandString(19922943,[+m])},_updateDoneSendGen:function(n,m){l.appendToCommandString(19857411,this,[+n,l.encodeString(m)])},_getRepoSpaceSendGen:function(){l.appendToCommandString(19857412,this)},_setUpdateProgressSendGen:function(m){l.appendToCommandString(19857415,this,[+m])},_updateProgressSendGen:function(n,p,o,m){l.appendToCommandString(19857419,this,[l.encodeString(n),+p,+o,(m?1:0)])},_setProgressTextSendGen:function(m){l.appendToCommandString(19857423,this,[l.encodeString(m)])},_setSplashVisibleSendGen:function(m){l.appendToCommandString(19857424,this,[(m?1:0)])},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[303]=this._instance||this;PROC_METHOD_TABLE[19857410]=this.prototype._updateGameRecvGen;PROC_METHOD_TABLE[19857413]=this.prototype._repoSpaceRecvGen;PROC_METHOD_TABLE[19857414]=this.prototype._deleteGameRecvGen;PROC_METHOD_TABLE[19857416]=this.prototype._pauseUpdateRecvGen;PROC_METHOD_TABLE[19857417]=this.prototype._resumeUpdateRecvGen;PROC_METHOD_TABLE[19857418]=this.prototype._cancelUpdateRecvGen;PROC_METHOD_TABLE[19857420]=this.prototype._allowBGUpdatesRecvGen;PROC_METHOD_TABLE[19857421]=this.prototype._runGameRecvGen;PROC_METHOD_TABLE[19857422]=this.prototype._finishGameRecvGen;PROC_METHOD_TABLE[19857425]=this.prototype._exceptionForwardedRecvGen;PROC_METHOD_TABLE[19857426]=this.prototype._setHasCustomProgressBarRecvGen;PROC_METHOD_TABLE[19922925]=this.prototype._gameUnbundledRecvGen},_updateGameRecv:function(m,n){this._getRepoSpaceSendGen();if(m in this.mLoadingGames){this.mLoadingGames[m].id=n;this.mLoadingGames[m].dlman.resume()}else{this.updateGame(m,n,(function(o,q,p){n=this.mLoadingGames[o].id;this._updateDoneSendGen(n,p||"")}).bind(this,m))}},mobageRunGame:function(m){this._gameRunner=m},_runGameRecv:function(m){if(this._gameRunner){console.log("_LGL running gameRunner "+m);this._gameRunner(m)}else{console.log("_LGL running game "+m);var n=__ngs.r_(__ngs._h)._int_LGL;n.launch(m,n.ProcID.Game)}},setFinishGameHandler:function(m){this._finishGameHandler=m},_finishGameRecv:function(){if(this._finishGameHandler){this._finishGameHandler()}else{console.log("_LocalGameList: finishGameHandler is not set")}},_repoSpaceRecv:function(n){this.mSpaceAvailable=n;console.log("SD card space available(b): "+this.mSpaceAvailable);for(var m=0;m<this.mSpaceFreeCallbacks.length;m++){(this.mSpaceFreeCallbacks[m])()}this.mSpaceFreeCallbacks.length=0},_deleteGameRecv:function(o,n){if(!n.match("http://games.mobage.com")){NgLogD("Deleting "+o);this.deleteGameFiles(o);var m=(function(){NgLogD("Finished deleting game from "+this.mActiveGameKey+" for "+o)}).bind(this);this._deleteGameFromStorage(o,m)}else{NgLogE("_LocalGameList unauthorized call to deleteGame from "+obj.game+"!")}},_deleteGameFromStorage:function(o,m){var n=this;this.mGameStore.getItem(this.mActiveGameKey,{},function(q,u){var t=JSON.parse(u);var r=false;var s;var p=[];for(s=0;s<t.length;++s){if(t[s].name==o){r=true}else{p.push(t[s])}}if(r){NgLogD("_LocalGameList found and removed "+o);n.mGameStore.setItem(n.mActiveGameKey,JSON.stringify(p),{blocking:true},m)}else{NgLogD("_LocalGameList failed to find and remove "+o);m("Could not remove item: "+q)}},true)},getGameConfig:function(n,m,q){if(typeof m=="function"){q=m;m=false}var p;if(m){p=n}else{var r=__ngs.r_(__ngs._y).Util;var o=r.NormalizeUrl(n);p=h(o)}NgLogT("@@@ _LocalGameList.getGameConfig readFile +");this.mFile.readFile(p+"/"+j._getConfigFile(),{},function(u,t){NgLogT("@@@ _LocalGameList.getGameConfig readFile -");var s={};if(u||!t){console.log("Could not get config from %s! err: %s",n,u)}else{s=JSON.parse(t)}q(s)})},getRepoSpace:function(){return this.mSpaceAvailable},getConfig:function(s,n,r,q){var o=__ngs.r_(__ngs._x).XHR;var p=__ngs.r_(__ngs._y).Util;var m=0;p.OperationWithRetries(function(t){var u=new o();u.onreadystatechange=function(){if(u.readyState==4){m=u.status;if(m==200){r(u.responseText)}else{if(m==404){console.log("no configuration file found at %s, using root server",s+n);r("{}")}else{t()}}}};u.setRequestHeader("X-Distribution",j.getDistributionName());u.open("GET",s+n+p.getCacheBustingString(),true);u.send()},function(){r(null,true,m)},q)},updateGame:function(v,o,p,t,x){var A=new RegExp(".*"+j.getBootGame());var u=v.match(A);if(u){this._firstBootGameLaunch=false}var y=__ngs.r_(__ngs._y).Util;v=y.NormalizeUrl(v);var n=y.GetMD5HashDirectoryFromUrl(v);this.mLoadingGames[v]={id:o};NgLogI("_LocalGameList.updateGame(): url = "+v+" name = "+n);var r={Android:"android","iPhone OS":"ios",flash:""};var s=__ngs.r_(__ngs._7).Capabilities;var z="/"+r[s.getPlatformOS()];this._setStage(this.ProgressStage.CheckConfiguration);var w="";var q=n+"/"+s._getConfigFile();this.mFile.readFile(q,{},function(B,C){if(C){var D=JSON.parse(C);w=D.contentUrl}});var m=v+z+"/"+s._getConfigFile();NgLogI("_LocalGameList.updateGame(): downloading configuration.json, url = "+m);this.getConfig(v+z,"/"+s._getConfigFile(),(function(D,C,B){if(C){NgLogI("_LocalGameList.updateGame(): ERROR downloading configuration.json, url = "+m);this._setStage(-1);p(0,C);delete this.mLoadingGames[v]}else{var E=JSON.parse(D);if(!E.contentUrl){E.contentUrl=v+z}else{if(E.contentUrl==w){NgLogI("_LocalGameList.updateGame(): Game is up to date! url = "+m);this._setStage(this.ProgressStage.Launching);this.mFile.writeFile(q,JSON.stringify(E),{},(function(F){if(F){NgLogE("gameUpdate failed to write config:"+F)}p(0,F);delete this.mLoadingGames[v]}).bind(this));return}}NgLogI("_LocalGameList.updateGame(): Downloading game! url = "+m);this._setStage(this.ProgressStage.CheckManifest);this._callDownloadManifest(E,v,n,t,x,(function(F,G){NgLogI("_LocalGameList.updateGame(): Finished Downloading game! url = "+m);if(!G){var H=this;this._reloadGameList({name:n,url:v},function(){if(p&&(typeof p=="function")){p(F,G);delete H.mLoadingGames[v]}})}else{p(F,G);delete this.mLoadingGames[v]}}).bind(this))}}).bind(this),t)},_allowBGUpdatesRecv:function(m){this._pauseOrResumeAll(m)},_pauseOrResumeAll:function(n){for(var m in this.mLoadingGames){if(n){console.log("Resuming download of "+m);this.resumeUpdate(m)}else{console.log("Pausing download of "+m);this.pauseUpdate(m)}}},pauseUpdate:function(m){if(this.mLoadingGames[m]){if(this.mLoadingGames[m].dlman){this.mLoadingGames[m].dlman.pause();this.mLoadingGames[m].userPause=true}}},_pauseUpdateRecv:function(m){this.pauseUpdate(m)},resumeUpdate:function(m){if(this.mLoadingGames[m]){if(this.mLoadingGames[m].dlman){this.mLoadingGames[m].dlman.resume();this.mLoadingGames[m].userPause=false}}},_resumeUpdateRecv:function(m){this.resumeUpdate(m)},cancelUpdate:function(n){if(this.mLoadingGames[n]){if(this.mLoadingGames[n].dlman){this.mLoadingGames[n].dlman.abort()}delete this.mLoadingGames[n];var m=__ngs.r_(__ngs._11).LifecycleEmitter;m.cancelEngineKeepAlive(e.classname+name)}},_cancelUpdateRecv:function(m){this.cancelUpdate(m)},_setProgress:function(m){if(m>1){m=1}if(m<0){m=-1}this._progress=m;if(m>=0&&this._allowDeterminateProgress){this._setUpdateProgressSendGen(this._progressMin+m*this._progressRange)}else{this._setUpdateProgressSendGen(-1)}},_setAllowDeterminateProgress:function(m){this._allowDeterminateProgress=m;this._setProgress(this._progress)},listenToProgress:function(m){this._privListener=m},_updateProgress:function(m,p,o,n){if(this._privListener){this._privListener(m,p,o,n)}if(this.mLoadingGames[m]&&this.mLoadingGames[m].id>=0){this._updateProgressSendGen(m,p,o,n)}},_callDownloadManifest:function(p,t,n,r,u,o){var q=p.contentUrl;var s=0;var w=this;var x=__ngs.r_(__ngs._2).DownloadManifest;var v=__ngs.r_(__ngs._h)._int_LGL.getManifestName(p);(function m(){var z=new x();z.mLocalGameList=w;var A=true;var y=__ngs.r_(__ngs._11).LifecycleEmitter;y.requestEngineKeepAlive(e.classname+n);p.omitJsUpdate=p.omitJsUpdate&&(j.getPlatformOS()=="iPhone OS");z._setConfig(p);z.start(q,n,{"webgame.ngmanifest":v},function(B,C){if(A){A=false;w._setStage(B<C?w.ProgressStage.DownloadFiles:w.ProgressStage.Launching);s=C}else{w._setProgress(B/C)}w._updateProgress(t,B,C)},function(C,D,B){y.cancelEngineKeepAlive(e.classname+n);if(u){if(o){o(s,C)}}else{if(C){NgLogE("Error: "+C);w._updateProgress(t,0,0,C);o(0,C)}else{if(o){o(s)}}}},false,r);if(w.mLoadingGames[t]){w.mLoadingGames[t].dlman=z}})()},freeSpace:function(n,m){this.mRequiredAvailableSpace=n;this.mSpaceFreeCallbacks.push((function(){if(this.mRequiredAvailableSpace>this.mSpaceAvailable){if(this._privListener){this._privListener("",0,0,"SD card is full")}else{console.log("Warning!! Mobage is not handling SD card full error!");var o=function(){if(this.mRequiredAvailableSpace>this.mSpaceAvailable){this.pruneGames(1);this.mSpaceFreeCallbacks.push(o)}else{m()}};o()}}else{m()}}).bind(this));this._getRepoSpaceSendGen()},pruneGames:function(o){var m=this;var n=function(p,q){return q.lastRun-p.lastRun};this.mGameStore.getItem(this.mActiveGameKey,{},function(q,s){var r=JSON.parse(s);r.sort(n);while(o--&&(r.length-1)){var p=r.pop();if(!(p.name in m.mLoadingGames)){m.deleteGameFiles(p.name)}else{r.push(p)}}m.mGameStore.setItem(m.mActiveGameKey,JSON.stringify(r),{})},true)},deleteGame:function(m,o){var q=__ngs.r_(__ngs._y).Util;var n=q.NormalizeUrl(m);var p=h(n);this.deleteGameFiles(p);this._deleteGameFromStorage(p,o)},deleteGameKeyValue:function(n){var m=__ngs.r_(__ngs._a).KeyValueCache;m.global(n).clear({})},deleteGameFiles:function(n){var m=this;m.mFile.deleteFile(n,{},function(o){if(o===""){NgLogI("Deleted")}else{NgLogD("Could not delete game")}m._getRepoSpaceSendGen()})},getGameList:function(){return this.mGameList},clearWatch:function(){var m=__ngs.r_(__ngs._d).FileSystem;m.deleteFile(".watch",{})},_reloadGameList:function(n,m){this.mGameStore.getItem(this.mActiveGameKey,{},(function(o,s){var r;if(s){r=JSON.parse(s)}else{r=[]}if(n){var q=true;for(var p in r){if(r[p].name==n.name){q=false;n.lastRun=r[p].lastRun;r[p]=n;break}}if(q){r.push(n)}this.mGameStore.setItem(this.mActiveGameKey,JSON.stringify(r),{})}this.mGameList=r;if(typeof m=="function"){m()}}).bind(this),true)},_getRunningGame:function(n){var m=function(o,p){return p.lastRun-o.lastRun};this._reloadGameList(false,(function(p){var r=this.mGameList;r.sort(m);var s=null;var o=r.length;for(var q=0;q<o;++q){if(r[q].lastRun){s=r[q];break}}if(s&&s.url){p(s.url)}}).bind(this,n))},_pausingGame:function(){this._pauseOrResumeAll(true)},_resumingGame:function(){this._getRunningGame((function(m){this.getGameConfig(m,(function(n){if(n.noBackgroundUpdates){this._pauseOrResumeAll(false)}}).bind(this))}).bind(this))},setSplashVisible:function(m){this._setSplashVisibleSendGen(m)},setProgressText:function(m){this._progressText=m;this._setProgressTextSendGen(m)},updateAvailable:function(n,m,o){var p=__ngs.r_(__ngs._h)._int_LGL;p.updateAvailable(n,m,o)},setExceptionHandler:function(m){this._exceptionHandler=m},_exceptionForwardedRecv:function(o){var m={};try{m=JSON.parse(o)}catch(n){console.log("ERROR: Unparseable exception: "+o)}if(this._exceptionHandler){this._exceptionHandler(m)}},_setHasCustomProgressBarRecv:function(m){this._hasProgressBar=m},registerUnbundleListener:function(m){if(this.unbundled){m()}else{this.unbundleListener=m}},$_gameUnbundledRecv:function(){this.unbundled=true;if(this.unbundleListener){this.unbundleListener()}}})}};__ngs._h={_c:null,_d:function(){var c={exports:{}};var e=c.exports;this._c=c;var a=__ngs.r_(__ngs._t).Class;var j=__ngs.r_(__ngs._6).Proc;var g=__ngs.r_(__ngs._u).Base64;function b(){var k=Capabilities.getPlatformOS();switch(k){case"Android":return"android";case"iPhone OS":return"ios"}return k}function h(k){var l={pvr:"GL_IMG_texture_compression_pvrtc",atc:"GL_AMD_compressed_ATC_texture",etc1:"GL_OES_compressed_ETC1_RGB8_texture","3dc":"GL_AMD_compressed_3DC_texture"};return l[k]||k}var d={isMatch:function(m,l){var k;switch(m.charAt(0)){case">":k=(m.charAt(1)=="=")?">=":">";break;case"<":k=(m.charAt(1)=="=")?"<=":"<";break}if(k){m=m.slice(k.length)}else{k="="}if(m==l){return(k=="="||k=="<="||k==">=")}else{if(m<l){return(k=="<"||k=="<=")}else{return(k==">"||k==">=")}}},isVersionMatch:function(n,s){var o;if(n.length>0){switch(n.charAt(0)){case">":o=(n.charAt(1)=="=")?">=":">";break;case"<":o=(n.charAt(1)=="=")?"<=":"<";break;case"=":o=(n.charAt(1)=="=")?"==":"=";break}}if(o){n=n.slice(o.length)}else{o="="}var k=n.split(".");var m=s.split(".");var p=Math.max(k.length,m.length);for(var r=0;r<p;r++){var t="0."+(k[r]||0);var q="0."+(m[r]||0);if(t==q){continue}if(t<q){return(o=="<"||o=="<=")}else{return(o==">"||o==">=")}}return true},sdkVersion:function(k){return this.isVersionMatch(""+k,Capabilities.getSDKVersion())},binaryVersion:function(k){return this.isVersionMatch(""+k,Capabilities.getBinaryVersion())},platformOS:function(k){return k==b()},platformOSVersion:function(k){return this.isVersionMatch(""+k,Capabilities.getPlatformOSVersion())},platformHW:function(k){return k==Capabilities.getPlatformHW()},physicalMem:function(k){return this.isMatch(k,Capabilities.getPhysicalMem())},physicalCpus:function(k){return this.isMatch(k,Capabilities.getPhysicalCpus())},activeCpus:function(k){return this.isMatch(k,Capabilities.getActiveCpus())},language:function(k){return k==Capabilities.getLanguage()},textureMatch:"none",textureCompression:function(l){var k=Capabilities.getOglExtensions().indexOf(h(l))>-1;if(k){this.textureMatch=l}return k},screenWidth:function(k){return this.isMatch(k,Capabilities.getScreenWidth())},screenHeight:function(k){return this.isMatch(k,Capabilities.getScreenHeight())},screenResolution:function(k){return k==(Capabilities.getScreenWidth()+"x"+Capabilities.getScreenHeight())},screenUnits:function(k){return this.isMatch(k,Capabilities.getScreenUnits())},screenPixelUnits:function(k){return this.isMatch(k,Capabilities.getScreenPixelUnits())},maxTextureSize:function(k){return this.isMatch(k,Capabilities.getMaxTextureSize())},reset:function(k){this.textureMatch="none"}};var f=a.singleton({classname:"_int_LGL",initialize:function(){this._loadCallbacks={}},launch:function(l,k){var n=__ngs.r_(__ngs._y).Util;if(!k){k=f.ProcID.Game}l=n.NormalizeUrl(l);var m=(function(){gNgShutdownPending=true;this._launchSendGen(l,k)}).bind(this);if(k==f.ProcID.Game){this.updateGameUse(l,m)}else{m()}},getCorrectedPlatformOS:function(){return b()},loadGame:function(k,m){var l=__ngs.r_(__ngs._y).Util;k=l.NormalizeUrl(k);this._loadCallbacks[k]=m;this._loadGameSendGen(k)},_gameLoadedRecv:function(l){if(this._loadCallbacks[l]){var k=this._loadCallbacks[l];delete this._loadCallbacks[l];k()}},launchLoadedGame:function(){this._launchLoadedGameSendGen()},updateAvailable:function(u,m,r){var k=u;if(!k.match(/^\//)&&!k.match(/https?:\/\//)){k="/"+k}var p=__ngs.r_(__ngs._7).Capabilities;var l="";if(p.getUrl()!=u){var s=__ngs.r_(__ngs._y).Util;k=s.NormalizeUrl(k);l=s.GetMD5HashDirectoryFromUrl(k)}var n={Android:"android","iPhone OS":"ios",flash:""};var t="/"+n[p.getPlatformOS()];var o=__ngs.r_(__ngs._2).DownloadManifest;var q=new o();q.isUpdated(k+t,l,false,m,r)},updateGameUse:function(m,k){var q=__ngs.r_(__ngs._y).Util;var o=q.NormalizeUrl(m);var n=q.GetMD5HashDirectoryFromUrl(o);var l=this;var p=__ngs.r_(__ngs._10).KeyValueCache;this.mGameStore=p.global("Core.GameList");this.mActiveGameKey="activeGames";this.mGameStore.getItem(this.mActiveGameKey,{},function(r,v){var u;if(v){u=JSON.parse(v)}else{u=[]}var t;for(var s in u){if(u[s].name==n){t=u[s];break}}if(!t){t={name:n};u.push(t)}t.lastRun=(new Date()).getTime();t.url=m;l.mGameStore.setItem(l.mActiveGameKey,JSON.stringify(u),{});LocalGameList.updateGameList(u);k()},true)},getManifestName:function(l){var z="webgame.ngmanifest";if(l&&l.manifestOverrides){try{var v=l.manifestOverrides;for(var o=0;o<v.length;o++){var k=v[o];if(k&&k.criteria){d.reset();var s=k.criteria;var w,r=true;for(w in s){if(!s.hasOwnProperty(w)){continue}var u=s[w];var p=d[w];if(typeof p!="function"){console.log("ERROR! Undefined criterion "+w+" in configuration.json");r=false;break}var n=false;if(u instanceof Array){for(var m=0;m<u.length;m++){n|=p.call(d,u[m]);if(n){break}}}else{n=p(u)}if(!n){r=false;break}}if(r){console.log("MATCHED Override: "+JSON.stringify(k));var t=k.manifest.slice(0);for(var y=1;y<t.length;y++){w=t[y];switch(w){case"textureCompression":t[y]=d.textureMatch;break;case"platformOS":t[y]=b();break;default:var x=Capabilities["get"+w.charAt(0).toUpperCase()+w.slice(1)]();t[y]=x.replace(" ","_")}}return __ngs.r_(__ngs._27).sprintf(t)}else{console.log("DID NOT MATCH Override: "+JSON.stringify(k))}}}}catch(q){console.log("ERROR! Exception occurred in manifest overrides: "+q)}}return z},ProcID:{Persist:-1,Game:-2},_classId:342,$_gameLoadedRecvGen:function(l){if((l.length-l.idx)!==1){NgLogE("Could not parse due to wrong argument count in _int_LGL.gameLoaded from command: "+l);return false}var k=j.parseString(l[l.idx++]);if(k===undefined){NgLogE("Could not parse url in _int_LGL.gameLoaded from command: "+l);return false}return this._gameLoadedRecv(k)},$_launchSendGen:function(l,k){j.appendToCommandString(22478847,[j.encodeString(l),+k])},$_loadGameSendGen:function(k){j.appendToCommandString(22478846,[j.encodeString(k)])},$_launchLoadedGameSendGen:function(){j.appendToCommandString(22478844)},__load:function(){if(typeof PROC_CLASS_TABLE=="undefined"){PROC_CLASS_TABLE={}}if(typeof PROC_METHOD_TABLE=="undefined"){PROC_METHOD_TABLE={}}PROC_CLASS_TABLE[342]=this._instance||this;PROC_METHOD_TABLE[22478845]=this.prototype._gameLoadedRecvGen}});e._int_LGL=f}};__ngs._i={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=__ngs.r_(__ngs._24).Element;var a=__ngs.r_(__ngs._22).Commands;var e=c.AlertDialog=b.subclass({type:"alertdialog",initialize:function($super,f){if(e._init){e._init()}$super(f)},show:a.show,hide:a.hide});e._init=function(){delete e._init;if(b._init){b._init()}e.synthesizePropertyWithState("title",a.setTitle);e.synthesizePropertyWithState("text",a.setText);var f=function(){return this._choices};var g=function(k,j,h){this._choices=k;a.setChoices.call(this,k,j||0,h||0);return this};e.registerAccessors("choices",f,g);e.registerEventType("choice")}}};__ngs._j={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var b=__ngs.r_(__ngs._24).Element;var a=__ngs.r_(__ngs._22).Commands;var e=c.Toast=b.subclass({type:"toast",initialize:function($super,f){if(e._init){e._init()}$super(f)},show:a.show});e._init=function(){delete e._init;if(b._init){b._init()}e.synthesizePropertyWithState("text",a.setText);e.registerEventType("disappear")}}};__ngs._k={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities}});var c={_platform:{_ios:{name:"iPhone OS",isIOS:true,isAndroid:false,isFlash:false},_android:{name:"Android",isAndroid:false,isAndroid:true,isFlash:false},_flash:{name:"Flash",isFlash:false,isAndroid:false,isFlash:true},_unknown:{name:"Unknown"}},_currentPlatform:null,initCapabilitiesAdditions:function(){this._currentPlatform=this.getPlatform(a.Capabilities.getPlatformOS())},getPlatform:function(e){if((typeof e!=="undefined")&&e!==null){e=e.toLowerCase()}switch(e){case this._platform._ios.name.toLowerCase():return this._platform._ios;case this._platform._android.name.toLowerCase():return this._platform._android;case this._platform._flash.name.toLowerCase():return this._platform._flash;default:NgLogD("Unable to retrieve the information of platform OS.");break}return this._platform._unknown},isPlatformIOS:function(){return this._currentPlatform.isIOS},isPlatformAndroid:function(){return this._currentPlatform.isAndroid},isPlatformFlash:function(){return this._currentPlatform.isFlash}};b.AugmentCapabilities=function(){a.Capabilities.instantiate();for(var e in c){a.Capabilities[e]=c[e]}a.Capabilities.initCapabilitiesAdditions()}}};__ngs._l={_c:null,_d:function(){var d={exports:{}};var b=d.exports;this._c=d;var a=__ngs.r_(__ngs._7).Capabilities;var c=b.CheckBinaryVersion={classname:"CheckBinaryVersion",checkForBinaryUpdates:function(e){NgLogD("Mobage/checkForBinaryUpdates - Checking...");if(!e){var f=a._getBootServer();if(!f.match(/.*\/$/)){f+="/"}e=f+a._getBoot()}if(!c._doesBinaryMeetMinimumVersion()){if(a.isPlatformIOS()){return false}c._initForcedBinaryUpdateButton(e);return true}return false},asyncCheckForBinaryUpdatesIOS:function(m,f){NgLogD("Mobage/checkForBinaryUpdatesIOS - Checking...");if(!a.isPlatformIOS()){f(false);return}if(!c._doesBinaryMeetMinimumVersion()){__ngs.r_(__ngs._5);__ngs.r_(__ngs._t);var g=__ngs.r_(__ngs._i).AlertDialog;var n=__ngs.r_(__ngs._n).LocalizedString;var e=__ngs.r_(__ngs._q).MobageAnalytics;var k=__ngs.r_(__ngs._11).LifecycleEmitter;var j=n("App Store");var o=[n("Quit"),n("Get the Update")];var l=1;var h=new g();h.setTitle(n("Update Available"));h.setText(n("A critical update is available in the %1s. Please download the new version from the %1s to continue playing.",j));h.setChoices(o);h.onchoice=function(r){if(r.choice===l){e.reportEvent("MobageForcedBinaryUpdateDialogGetUpdateClicked");try{NgLogD("Mobage/checkForBinaryUpdatesIOS - appid: "+m);NgLogD("Mobage/checkForBinaryUpdatesIOS - plus request ");var p=__ngs.r_(__ngs._28).PlusRequest;NgLogD("Mobage/checkForBinaryUpdatesIOS - plus request import "+p);var q=new p();NgLogD("Mobage/checkForBinaryUpdatesIOS - plus request new  "+q);q.setApiMethod("games/"+m);q.setHttpMethod("GET");q.send(function(w,x,y,t){NgLogD("Mobage/checkForBinaryUpdatesIOS - plus request returned "+JSON.stringify(x));if(x){var u=x.game;NgLogD("Mobage/checkForBinaryUpdatesIOS - game:"+u);if(u){var v=u.app_store_url;NgLogD("Mobage/checkForBinaryUpdatesIOS - get appstore url:"+v);if(v){__ngs.r_(__ngs._1e).IPCEmitter.launch(v)}}}k.exitProcess();f(true)})}catch(s){NgLogD("Mobage/checkForBinaryUpdatesIOS - Error while going to appstore."+s);k.exitProcess();f(true)}}else{e.reportEvent("MobageForcedBinaryUpdateDialogQuitClicked");k.exitProcess();f(true)}h.destroy()};h.show();e.reportEvent("MobageForcedBinaryUpdateDialogShow")}else{f(false)}},_doesBinaryMeetMinimumVersion:function(){var e=__ngs.r_(__ngs._29).AppConfig.getMinBinaryVersion();NgLogD("Mobage/CheckBinaryVersion: minVersion="+e);return a.meetsBinaryVersion(e)},_initForcedBinaryUpdateButton:function(h){__ngs.r_(__ngs._5);var j=__ngs.r_(__ngs._i).AlertDialog;var f=__ngs.r_(__ngs._n).LocalizedString;var g=__ngs.r_(__ngs._q).MobageAnalytics;var m=f("App Store");var l=[f("Quit"),f("Get the Update")];var e=1;if(a.isPlatformAndroid()){m=f("Android Market");l=[f("Get the Update"),f("Quit")];e=0}var k=new j();k.setTitle(f("Update Available"));k.setText(f("A critical Mobage update is available in the %1s. Please update to continue using the service.",m));k.setChoices(l);k.onchoice=function(o){if(o.choice===e){g.reportEvent("MobageForcedBinaryUpdateDialogGetUpdateClicked");var n=__ngs.r_(__ngs._1e).IPCEmitter;n.launchIntent("market://details?id="+a.getBundleIdentifier())}else{g.reportEvent("MobageForcedBinaryUpdateDialogQuitClicked")}k.destroy();__ngs.r_(__ngs._11).LifecycleEmitter.exitProcess()};k.show();g.reportEvent("MobageForcedBinaryUpdateDialogShow")}}}};__ngs._m={_c:null,_d:function(){var e={exports:{}};var c=e.exports;this._c=e;var g=__ngs.r_(__ngs._5).Core;var d=__ngs.r_(__ngs._4).Device;var b=__ngs.r_(__ngs._2a).Destinations;var a=new (__ngs.r_(__ngs._2b).InterfaceLoader)({_LocalGameList:function(){return __ngs.r_(__ngs._g)._LocalGameList},_int_LGL:function(){return __ngs.r_(__ngs._h)._int_LGL},Analytics:function(){return __ngs.r_(__ngs._1k).Analytics},PrivAnalytics:function(){return __ngs.r_(__ngs._2c).Analytics},AlertDialog:function(){return __ngs.r_(__ngs._i).AlertDialog},UIUtils:function(){return __ngs.r_(__ngs._2d).UIUtils},Game:function(){return __ngs.r_(__ngs._2e).Game},Dispatcher:function(){return __ngs.r_(__ngs._2f).Dispatcher},Session:function(){return __ngs.r_(__ngs._o).Session},GameLaunchedEmitter:function(){return __ngs.r_(__ngs._2g).GameLaunchedEmitter},SystemMessagesStack:function(){return __ngs.r_(__ngs._2h).SystemMessagesStack},AppConfig:function(){return __ngs.r_(__ngs._29).AppConfig},AppUpdater:function(){return __ngs.r_(__ngs._2i).AppUpdater},CheckBinaryVersion:function(){return __ngs.r_(__ngs._l).CheckBinaryVersion},Storage:function(){return __ngs.r_(__ngs._a).Storage},Logger:function(){return __ngs.r_(__ngs._2j).Logger},Localization:function(){return __ngs.r_(__ngs._n).Localization},LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},isWhitelisted:function(){return __ngs.r_(__ngs._2k).isWhitelisted},AB:function(){return __ngs.r_(__ngs._2l).AB},FacebookReq:function(){return __ngs.r_(__ngs._2m)},Push:["_2n",function(h){return h.Push}],ServiceLinkEmitter:["_2o",function(h){return h.ServiceLinkEmitter}],Window:["_b",function(h){return h.Window}],ButtonOverlays:["_2p",function(h){return h.ButtonOverlays}],EditTextLimits:["_2q",function(h){return h.EditTextLimits}],Credentials:["_2r",function(h){return h.Credentials}],CredentialsHost:["_2s",function(h){return h.CredentialsHost}],GameCarouselCache:["_2t",function(h){return h.GameCarouselCache}],MobageBrandSlideIn:["_2u",function(h){return h.MobageBrandSlideIn}],ServiceHost:["_2v",function(h){return h.ServiceHost}],QuitOnBackListener:["_2w",function(h){return h.QuitOnBackListener}],NuxController:["_2x",function(h){return h.NuxController}],Purchase:["_2y",function(h){return h.Purchase}],Network:function(){return __ngs.r_(__ngs._s).Network},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics}});var f=c.Main={_nuxEnabled:true,_facebookEnabled:"enabled",_initialSessionRetryTime:5000,gameServiceMain:function(k,j,h){f._gameServiceMain(k,j,h)},_gameServiceMain:function(m,k,h){NgLogT("@@@ mobage Main.js _gameServiceMain +");NgLogD("Mobage/Main: Executing Game Service Main, isDisaggregated = "+g.Capabilities.getIsDisaggregated());a.Logger._privInit();this.loadAnalytics();d.LifecycleEmitter.addListener(new g.MessageListener(),function(o){NgLogD("Mobage/Main: DEBUG - lifecycle emitter got event "+o);if(g.Capabilities._getLogToFile()&&!this._logSent&&o==d.LifecycleEmitter.Event.Suspend){this.sendLogToServer();this._logSent=true}}.bind(this));NgLogD("@@- mobage Main.js _gameServiceMain after Analytics._setNgPipeSocialAnalytics");NgLogD("@@- mobage Main.js _gameServiceMain do handleFirstLaunchIntent");f.handleFirstLaunchIntent();NgLogD("Mobage/Main: Instantiating our localization system.");NgLogT("@@@ mobage Main.js _gameServiceMain Localization.instantiate +");var l=new g.MessageListener();a.Localization.instantiate();NgLogT("@@@ mobage Main.js _gameServiceMain Localization.instantiate -");if(!m||m===""){NgLogD("Mobage/Main: No game detected. Showing quit dialog.");var n=new a.AlertDialog();n.setTitle(a.LocText("No game detected"));n.setText(a.LocText("Mobage no longer supports running without a game. Please re-run with a game, or if you are building ngCore, check your build configuration."));n.setChoices([a.LocText("Quit")]);n.show();n.onchoice=function(o){d.LifecycleEmitter.exitProcess()}}else{NgLogT("@@@ mobage Main.js _gameServiceMain getGameConfig +");var j=function(o){a.MobageAnalytics.setGameSkuForPlatformEvents(o.appId);a.MobageAnalytics.beginHeartbeat();NgLogT("@@@ mobage Main.js _gameServiceMain getGameConfig -");NgLogD("Mobage/Main: Booting session with game, url="+m+", config="+JSON.stringify(o));f._setupSessionAndLaunchApp(o,k,true)};if(h){j(h)}else{a._LocalGameList.getGameConfig(m,false,j)}}NgLogT("@@@ mobage Main.js _gameServiceMain -")},loadApiPhase:function(j){var k=g.Capabilities.getConfigs();if(!k.hasOwnProperty("disablePushNotifications")||!k.disablePushNotifications){NgLogD("Mobage/Main: Register for push & listen.");a.loadThenAct("Push",function(l){NgLogD("Enabling push registration");l.enablePushRegistration()})}NgLogD("Mobage/Main: Instantiate ServiceLinkEmitter");a.loadThenAct("ServiceLinkEmitter",function(l){l.instantiate()});NgLogD("Mobage/Main: Instantiate SystemMessagesStack (If not already instantiated)");a.SystemMessagesStack.instantiate();var h=new g.MessageListener();a.GameLaunchedEmitter.addListener(h,function(){if(a._LocalGameList.clearWatch){a._LocalGameList.clearWatch()}if(!g.Capabilities.isPlatformIOS()){setTimeout(function(){a.AppUpdater.updateServiceJS(f.getGameServiceUrl())},a.AppConfig.getJSUpdateWaitPeriodInMS())}}.bind(this));setTimeout(function(){f.loadHostsPhase(j)},10)},loadHostsPhase:function(j){var h=j.postHostsLoad;delete j.postHostsLoad;NgLogD("Mobage/Main: Instantiate Quit Key Listener");a.loadThenAct("QuitOnBackListener",function(k){k.instantiate()});NgLogD("@@- mobage Main.js loadHostsPhase before GameCarouselCache.instantiate");a.loadThenAct("GameCarouselCache",function(k){k.instantiate()});if(d.IPCEmitter._setEmitIntents){d.IPCEmitter._setEmitIntents(true)}d.IPCEmitter.addListener(new g.MessageListener(),function(k){NgLogD("Mobage/Main: Received an intent!"+JSON.stringify(k));f.onIntentEmit(k)});NgLogD("Mobage/Main: Instantiating hosts");NgLogT("@@@ mobage Main.js loadHostsPhase ServiceHost instantiate +");a.loadThenAct("ServiceHost",function(k){k.instantiate()});NgLogT("@@@ mobage Main.js loadHostsPhase ServiceHost instantiate -");NgLogT("@@@ mobage Main.js loadHostsPhase CredentialsHost instantiate +");a.loadThenAct("CredentialsHost",function(k){k.instantiate()});NgLogT("@@@ mobage Main.js loadHostsPhase CredentialsHost instantiate -");a.loadThenAct("EditTextLimits",function(k){k.instantiate()});if(h){h()}setTimeout(function(){f.loadAllPhase(j)},10)},loadAllPhase:function(h){NgLogD("Mobage/Main: retry failed credits");NgLogT("@@@ mobage Main.js _setupSessionAndLaunchApp Purchase.retryFailedCredits +");a.loadThenAct("Purchase",function(j){j.retryFailedCredits()});NgLogT("@@@ mobage Main.js _setupSessionAndLaunchApp Purchase.retryFailedCredits -")},loadAnalytics:function(){NgLogD("@@- mobage Main.js _gameServiceMain before Analytics._setNgPipeSocialAnalytics");if((typeof a.Analytics._setNgPipeSocialAnalytics)=="function"){NgLogD("Mobage/Main: Setting ngCore Analytics to use Privileged Social imports.Analytics");a.Analytics._setNgPipeSocialAnalytics(a.PrivAnalytics)}},onIntentEmit:function(l){NgLogD("Mobage/Main/onIntentEmit: Intent emit: "+JSON.stringify(l));if(l){var j=l instanceof d.IPCEmitter.Intent&&l.getExtras&&l.getAction;var h=j?l.getExtras():null;if(g.Capabilities.isPlatformIOS()&&l._sourceAppID===""){if(typeof l._intentURL=="string"){if(l._intentURL.indexOf("fb")===0&&l._intentURL.indexOf("://authorize")!==-1){l._sourceAppID="com.facebook.Facebook"}}}if(h&&h.requestToken==a.FacebookReq.FacebookConsts.ANDROID_ACTIVITY_REQUEST_CODE){a.FacebookReq.Facebook._handleAndroidFBSSOResult(l._extras);return}if(l._sourceAppID=="com.facebook.Facebook"){a.FacebookReq.Facebook._handleIOSFBSSOResult(l._intentURL);return}var k=a.Session.getCurrentSession();if(k&&!k.isSomeoneLoggedIn()){NgLogD("Mobage/Main/onIntentEmit: Hit early out on no login case...");return}if(j&&h&&h.isMobagePush){NgLogD("Mobage/Main/onIntentEmit: Intent wants us to show service UI");a.loadThenAct("ServiceHost",function(m){m.showService()});return}if(j&&l.getAction()=="com.mobage.ww.PLAY"){NgLogD("Mobage/Main/onIntentEmit: Intent was game launched, hiding service");a.loadThenAct("ServiceHost",function(m){m.hideService()});return}if(l._intentURL){NgLogD("Mobage/Main/onIntentEmit: Handling _intentURL on intent: "+l._intentURL);f.handleIntentWithUrl(l._intentURL)}}},handleIntentWithUrl:function(h){if(h==this._mobageShortcutIntentUrl){a.loadThenAct("ServiceHost",function(j){b.pushScreen(j.navController,"Home",{},{analyticsName:"MobageShortcutIntentUrl"})})}},handleFirstLaunchIntent:function(){if(f._isLaunch){d.IPCEmitter.getCallingPackage(function(h){NgLogD("Mobage: Main.handleFirstLaunchIntent ("+g.Capabilities.getIntentAction()+", "+h+")")});if(g.Capabilities.getIntentUrl()==f._mobageShortcutIntentUrl){NgLogD("Mobage: Main.handleFirstLaunchIntent Detected shortcut launch");f._isLaunchIntoServiceUI=true}f._isLaunch=false}},_showStartupFailureDialog:function(h){var j=new a.AlertDialog();j.setTitle(a.LocText("We're not able to connect"));j.setText(a.LocText("Please check your network settings and try again."));j.setChoices([a.LocText("Quit"),a.LocText("Try Again")]);j.show();j.onchoice=function(k){if(k.choice===0){d.LifecycleEmitter.exitProcess()}else{h()}}},_setupSessionAndLaunchApp:function(l,m,q){if(!l){NgLogD("mobage Main.js !!!!!configuration.json file is empty !!!!!!");l={}}if(!l.requireMobageLogin){a.UIUtils.showToast("Skipping mobage login");m();return}a.MobageAnalytics.logStartupFlowEvent("InitialSetupSession");var j=15000;var h;var r;var k=false;var o=g.Capabilities.meetsBinaryVersion("1.7.5");if(o&&l.hasOwnProperty("bootGameImmediately")&&(l.bootGameImmediately===true||l.bootGameImmediately=="true")){k=true;var p=function(){r.show()};r=new a.AlertDialog();r.setTitle(a.LocText("We're not able to connect"));r.setText(a.LocText("Please check your network settings and try again."));r.setChoices([a.LocText("Quit"),a.LocText("Try Again")]);r.onchoice=function(s){if(s.choice===0){d.LifecycleEmitter.exitProcess()}else{h=setTimeout(p,j)}};h=setTimeout(p,j)}var n=function(){NgLogT("@@@ mobage Main.js _setupSessionAndLaunchApp beginGameSessionWithConfig +");a.Session.beginGameSessionWithConfig(l,function(s,t){NgLogT("@@@ mobage Main.js _setupSessionAndLaunchApp beginGameSessionWithConfig -");NgLogD("Began session. "+s+" "+t+" "+(t?t._user:"[session was undefined, so is _user]"));if(t&&s!=a.Session.NO_KEYS_ERR&&t.appKey()!="default-Dev"){if(k){if(r){r.destroy();r=undefined}if(h){clearTimeout(h);h=undefined}}g.Analytics._getPipe().sessionStartEvent();NgLogT("@@@ mobage Main.js _setupSessionAndLaunchApp _checkSessionStatusSecure +");a.Session._checkSessionStatusSecure(function(v,w){NgLogT("@@@ mobage Main.js _setupSessionAndLaunchApp _checkSessionStatusSecure -");if(w!=undefined&&w.configuration!=undefined&&w.configuration.nux_enabled!=undefined){f._nuxEnabled=w.configuration.nux_enabled}if(w!=undefined&&w.configuration!=undefined&&w.configuration.social!=undefined&&w.configuration.social.facebook!=undefined&&w.configuration.social.facebook.registrationLogin!=undefined){f._facebookEnabled=w.configuration.social.facebook.registrationLogin}NgLogD("/// data.configuration.social.facebook.registrationLogin: "+JSON.stringify(f._facebookEnabled));var u=function(){if(!t.isSomeoneLoggedIn()){NgLogT("@@@ mobage Main.js Registering Blocked on Localization +");var y=function(){NgLogT("@@@ mobage Main.js Registering Blocked on Localization -");if(q){a.AB.getServiceVariants(function(z,C){var B=null;if(C){B=C.regFlow}g.LocalGameList._setProgressVisible(false);var A=function(D){a.Credentials.showRegistration(function(){if(m){m();g.LocalGameList._setProgressVisible(true)}},f._facebookEnabled,false,B,null,"startup")};a.loadThenAct("Window",function(D){A(D)})})}else{if(m){m()}}};var x=function(){if(!a.Localization._lang){NgLogT("@@@ Main.js adding Localization Listener");a.Localization.addListener(new g.MessageListener(),y)}else{y()}};f.loadApiPhase({postHostsLoad:x})}else{if(t.user().usesGuestLogin()){a.UIUtils.showToast("Welcome "+t.user().gamertag+" !")}f.loadApiPhase({loggedIn:true,postHostsLoad:function(){a.loadThenAct("ServiceHost",function(z){z.closeMenuDrawer(false,false)})}});NgLogD("Initialize with menu");a.MobageAnalytics.logStartupFlowEvent("ReturningUserLoggedIn");a.ServiceHost.closeMenuDrawer(false,false);if(m){m()}}};a.CheckBinaryVersion.asyncCheckForBinaryUpdatesIOS(l.appId,function(x){if(x){return}u()})})}else{if(k){NgLogD("Mobage/Main - Initial session failed, trying again in "+f._initialSessionRetryTime);setTimeout(function(){n()},f._initialSessionRetryTime);if(f._initialSessionRetryTime<60000){f._initialSessionRetryTime=f._initialSessionRetryTime*2}}else{f._showStartupFailureDialog(n)}}})};n()},getGameServiceUrl:function(){var h=g.Capabilities._getBootServer();if(!h.match(/.*\/$/)){h+="/"}return h+g.Capabilities._getBoot()},switchToGame:function(j,h){if(typeof(h)!="function"){if(h!==undefined){throw new Error("Function expected for onDoneCB argument.")}else{h=function(){}}}a.loadThenAct("ButtonOverlays",function(k){k.hideAllButtons()});a.loadThenAct("ServiceHost",function(k){k.setIsRunningActiveGame(true)});a._LocalGameList.getGameConfig(j,function(k){if(!k||!k.appId||!k.requireMobageLogin){NgLogD("Mobage: Skipping session switch because configuration.json does not indicate a use of the Social components.");a._int_LGL.launch(j);h(null)}else{a.Session.switchToSessionWithConfig(k,function(p,r){if(p){NgLogD("Mobage: Error running game! Couldn't begin game imports.Session: "+p);h(p)}else{NgLogD("Mobage: Launching game at url "+j+" with appID: "+r.appKey());var m="com.mobage.ww.local_last_played_game.";var q=a.Storage.KeyValueCache.local;if(!q){a.Storage.KeyValueCache.init();q=a.Storage.KeyValueCache.local}var s=a.Session.getCurrentSession();var l=s?s.user():null;var n=l?l.gamertag:"nobody";var o=m+n;q.setItem(o,r.appKey());a._int_LGL.launch(j);if(!r.isSomeoneLoggedIn()){NgLogD("Mobage: Got login");throw new Error("MULTISTAGE BOOT WORK IN PROGRESS")}else{NgLogD("Initialize with menu");a.loadThenAct("ServiceHost",function(t){t.closeMenuDrawer(false,false)})}h(null)}})}})},_isLaunchIntoServiceUI:false,_delayedLaunchGameCb:null,_delayedLaunchGameUrl:null,isLaunchIntoServiceUI:function(){return f._isLaunchIntoServiceUI},finishShortcutLaunch:function(h,j){a.ServiceHost.navController.pushViewController(new b.Home());f._delayedLaunchGameCb=h;f._delayedLaunchGameUrl=j},onGameStart:function(){NgLogD("Mobage: onGameStart called, session="+a.Session.getCurrentSession());if(g.Capabilities.getIntentUrl()==this._mobageShortcutIntentUrl){console.log("Mobage: Launch Intent received from the mobage shortcut");a.loadThenAct("ServiceHost",function(h){b.pushScreen(h.navController,"Home",{},{analyticsName:"MobageShortcutIntentUrl"})})}if(a.Session.getCurrentSession()){a.Dispatcher.sendSession(a.Session.getCurrentSession())}(a.GameLaunchedEmitter).onGameLaunched()},_isLaunch:true,_newLaunchGame:null,_mobageShortcutIntentUrl:"mobage-service:home",getNewLaunchGame:function(){return this._newLaunchGame},setNewLaunchGame:function(h){this._newLaunchGame=h},_logSent:false,sendLogToServer:function(){var l="http://tps.mobage.com:8081/";var j=g.Capabilities.getBootGame();j=j.replace(/\//g,"_");var h=g.Capabilities.getPlatformHW();var n=g.Capabilities.getPlatformOSVersion();var m=g.Capabilities.getDeviceName();var k=l+j+"/"+h+"/"+n+"/"+m;k=k.replace(/ /g,"_");k=k.replace(/,/g,"_");k=encodeURI(k);this.sendFileToServer(k,"console.log")},sendFileToServer:function(j,l){NgLogD("Mobage: sendFileToServer url: "+j+" fileName: "+l);var k=new a.Network.XHR();k.open("POST",j,true);k.onreadystatechange=function(){if(k.readyState==4&&k.error){NgLogE("Mobage: sendFileToServer response error="+k.error)}};var h=[{file:l}];k.sendComposition(h)}}}};__ngs._n={_c:null,_d:function(){var d={exports:{}};var g=d.exports;this._c=d;var h=__ngs.r_(__ngs._8).LocalizationEngine;var c=__ngs.r_(__ngs._29).AppConfig;var a=new (__ngs.r_(__ngs._f).RequireLoader)({Assets:function(){return __ngs.r_(__ngs._2z).Assets}});function e(k,n,p,l){var m=k.substring(0,p);var o=k.substring(p+l,k.length);return m+n+o}var f=[];function b(k){return f[k]||(f[k]=new RegExp("%"+k+"(?:;([^a-z]+))?([sd])"))}var j=h.subclass({_language:"en",setLanguage:function($super,k){if(!c.isLocalizationEnabled()){NgLogD("Device requested language: '"+k+"' but unfortunately localization is disabled for Mobage.US ");this._language="en";$super("en")}else{this._language=k;$super(k)}},trackMissingStrings:false,logMissingStrings:true,_missingStrings:[],initialize:function($super){var k=a.Assets.localizationsPath();NgLogD("Narwhal Localization: "+k);$super(k)},getLanguage:function(){return this._language},getAcceptLanguage:function(){return this._language},getFormattedString:function(l){var o=this.getString(l);for(var m=1;m<arguments.length;m++){var k=b(m).exec(o);if(k){try{o=e(o,this._formatPattern(k[2],k[1],arguments[m]),k.index,k[0].length)}catch(n){}}}return o},_formatPattern:function(m,k,l){if(m=="s"){return String(l)}else{if(m=="d"){if(k){if(isNaN(Number(k))){throw new Error("Pattern parameters parse error")}return this.getNumber(l,Number(k))}else{return this.getNumber(l)}}}throw new Error("Unrecognized format pattern.")},getNumber:function(s,l){if(typeof s!="number"){var n=parseInt(s,10);if(isNaN(n)){NgLogE("Error: Localization.getNumber could not use value: '"+s+"' -- Invalid Format!");return s}if(s.indexOf(",")!==-1||s.indexOf(".")!==-1){NgLogE("Error: Localization.getNumber could not use value: '"+s+"' -- because it already contained separators!");return s}s=n}var t=l===undefined?String(s):s.toFixed(l);var r=/(-?)(\d+)(?:\.(\d+))?(e[+-]\d+)?/.exec(t);if(!r){return t}var m=r[2];var q=[];for(var o=m.length-3;o>-3;o-=3){q.unshift(m.substr(Math.max(o,0),Math.min(3+o,3)))}var k=this.getString("digit_group_separator");var p=this.getString("decimal_mark");if(k=="digit_group_separator"){k=","}if(p=="decimal_mark"){p="."}return r[1]+q.join(k)+(r[3]?p+r[3]:"")+(r[4]||"")},formatDateFromServerString:function(o){var l=0;var k=o.indexOf("-",l);var n=o.substring(l,k);l=k+1;k=o.indexOf("-",l);var p=o.substring(l,k);l=k+1;k=o.indexOf("T",l);var m=o.substring(l,k);return this.getFormattedString("%1s/%2s/%3s",p,m,n)},unknownString:function(k){if(this.logMissingStrings){NgLogE("Narwhal Localization: Missing String for key '"+k+"' for "+this._lang+"("+this._missingStrings.length+")")}if(this.trackMissingStrings&&k&&!(k in this._missingStrings)){this._missingStrings.push(k)}return k},printMissingStrings:function(){NgLogD("Narwhal Localization discovered "+this._missingStrings.length+" unlocalized strings in this run. They are listed as follows: ");for(var k in this._missingStrings){if(!this._missingStrings.hasOwnProperty(k)){continue}NgLogD('\t"'+this._missingStrings[k]+'"')}NgLogD("Narwhal Localization missing string listing finished.")}});g.Localization=j.singleton({});g.LocalizedString=function(k){return g.Localization.getFormattedString.apply(g.Localization,Array.prototype.slice.call(arguments))};g.LocalizedDate=function(k){return g.Localization.formatDateFromServerString(k)}}};__ngs._o={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var f=__ngs.r_(__ngs._5).Core;var a=new (__ngs.r_(__ngs._2b).InterfaceLoader)({CoreReq:function(){return __ngs.r_(__ngs._5)},FileSystem:function(){return __ngs.r_(__ngs._d).FileSystem},Storage:function(){return __ngs.r_(__ngs._a).Storage},PlusRequestReq:function(){return __ngs.r_(__ngs._28)},UserReq:function(){return __ngs.r_(__ngs._30)},UpdaterReq:function(){return __ngs.r_(__ngs._31)},MessageEmitterReq:function(){return __ngs.r_(__ngs._1q)},NetworkUtil:function(){return __ngs.r_(__ngs._y).Util},Capabilities:function(){return __ngs.r_(__ngs._7).Capabilities},CacheReq:function(){return __ngs.r_(__ngs._32)},Dispatcher:function(){return __ngs.r_(__ngs._2f).Dispatcher},toMD5:function(){return __ngs.r_(__ngs._13).toMD5},AppConfig:function(){return __ngs.r_(__ngs._29).AppConfig},Credentials:["_2r",function(g){return g.Credentials}],SystemMessagesStack:function(){return __ngs.r_(__ngs._2h).SystemMessagesStack},N0kler:function(){return __ngs.r_(__ngs._33).N0kler},NetworkUtils:function(){return __ngs.r_(__ngs._34).NetworkUtils}});var d=b.Session=a.MessageEmitterReq.MessageEmitter.subclass({classname:"Session",$NO_KEYS_ERR:"Warning, cannot find consumer keys and appId for game.",oauth2Token:null,userID:null,initialize:function(g){this.gameData=g||{};this._consumerKey=this.gameData.consumerKey||null;this._consumerSecret=this.gameData.consumerSecret||null;this._appKey=this.gameData.appId||null;this._appVersion=this.gameData.appVersion||null;this._config=g.config;if(this.gameData.serverMode){a.PlusRequestReq.PlusRequest.setServerMode(this.gameData.serverMode||a.PlusRequestReq.PlusRequest.serverModes.production)}this.accessToken=null;this.accessSecret=null;this._user=null},dataCache:function(){if(!this._cache){this._cache=new a.CacheReq.Cache(this.userID);this._cache.loadCache(function(g){NgLogD("Loaded cache: "+g)})}return this._cache},hasGameCurrency:function(){if(!a.Capabilities.isPlatformIOS()){return true}else{return(this.currency&&this.currencyURL)}},setCurrency:function(h,g){this.currency=h;this.currencyURL=g},loginWithExistingSession:function(g){g=g||a.PlusRequestReq.PlusRequest.noOp;var k=a.Storage.KeyValueCache.local;if(!k){a.Storage.KeyValueCache.init();k=a.Storage.KeyValueCache.local}NgLogT("@@@ mobage Session.js loginWithExistingSession localCache.getItem +");var j=this;var h="com.ngmoco.plus.session.auth_token."+a.PlusRequestReq.PlusRequest.getServerMode()+"."+this.appKey();NgLogD("Getting existing session for server "+h);k.getItem(h,function(n,o){NgLogT("@@@ mobage Session.js loginWithExistingSession localCache.getItem -");if(!o){if(j.gameData.triedHardcodedUsernameAndPassword!==true&&j.gameData.username&&j.gameData.password){NgLogD("Privileged Session: Doing manual hardcoded login for "+j.gameData.username);var q=j.gameData.username;var l=j.gameData.password;j.gameData.triedHardcodedUsernameAndPassword=true;j.loginWithUsernameAndPassword(q,l,g)}else{g("No auth_token",j);return}}NgLogD("Logging in with existing session");var m=new a.PlusRequestReq.PlusRequest();m.setApiMethod("session");m.setHttpMethod("POST");m.setHttpHeaders(j._getABHeaders(j));var p=j._loginParameters();p.auth_token=o;m.setPostBody(p);NgLogT("@@@ mobage Session.js loginWithExistingSession localCache.getItem PlusRequest +");m.send(function(s,t,u,r){NgLogT("@@@ mobage Session.js loginWithExistingSession localCache.getItem PlusRequest -");j._handleLoginResponse(s,t,u,r,g)})})},loginWithUsernameAndPassword:function(n,j,g){g=g||a.PlusRequestReq.PlusRequest.noOp;var l=this;var k=new a.PlusRequestReq.PlusRequest();k.setApiMethod("session");k.setHttpMethod("POST");k.setHttpHeaders(l._getABHeaders(l));var m=l._loginParameters();if(n.indexOf("@")!==-1){m.email=n}else{m.gamertag=n}m.password=j;k.setPostBody(m);var h=this;k.send(function(p,q,r,o){h._handleLoginResponse(p,q,r,o,g)})},newSessionWithUsernameAndPassword:function(k,h,g){var j=new d({consumerKey:this._consumerKey,consumerSecret:this._consumerSecret,appId:this.appKey(),appVersion:this.appVersion()});j.loginWithUsernameAndPassword(k,h,function(l,n,m){if(!l&&n.user()){d._currentSession=n;if(d._emitter){d._emitter.emit({session:n})}g(null,n)}else{g(l,null,m)}})},loginWithPasswordAsGuest:function(j,g){g=g||a.PlusRequestReq.PlusRequest.noOp;var l=a.CoreReq.Core.Capabilities.getUniqueId();var k=new a.PlusRequestReq.PlusRequest();k.setApiMethod("users");k.setHttpMethod("POST");k.setPostBody({user:{password:j,password_confirmation:j,lite:true},id:l});var h=this;k.send(function(n,o,p,m){h._handleLoginResponse(n,o,p,m,g)})},newSessionAsGuest:function(h){var j=new d({consumerKey:this._consumerKey,consumerSecret:this._consumerSecret,appId:this.appKey(),appVersion:this.appVersion()});var g="12345678";j.loginWithPasswordAsGuest(g,function(k,l){if(!k&&l.user()){d._currentSession=l;if(d._emitter){d._emitter.emit({session:l})}d._storeGuestCredentials(l.user().gamertag,g,function(m){if(m){h(m,null)}else{h(null,l)}})}else{h(k,null)}})},upgradeGuestUserWithUsernameAndPassword:function(h,l,k,j,g){if(!this._user){throw"User should be valid."}g=g||a.PlusRequestReq.PlusRequest.noOp;this._user.upgradeGuestUserWithUsernameAndPassword(h,l,k,j,function(m){if(!m&&d._emitter){d._emitter.emit({session:this})}g(m)}.bind(this))},loginWithStoredGuest:function(g){d._retreiveGuestCredentials(function(j,l,h){if(j){g(j,null)}else{var k=d.getCurrentSession();if(l&&h){k.newSessionWithUsernameAndPassword(l,h,function(n,m,o){if(o&&o.error===100){NgLogD("Mobage/loginWithStoredGuest - Invalid guest credentials, clearing...");d._clearGuestCredentials();g("No auth_token",k)}else{g(n,m)}})}else{g("No auth_token",k)}}})},getSessionTokensForConsumerKey:function(h,g){return a.PlusRequestReq.PlusRequest.getSessionTokensForConsumerKey(h,g)},user:function(){return this._user},appKey:function(){return this._appKey},appVersion:function(){return this._appVersion||"1.0"},platformVersion:function(){return a.AppConfig.getPlatformVersion()},OAuthConsumerInfo:function(){return{token:this.accessToken,tokenSecret:this.accessSecret,consumerKey:this._consumerKey,consumerSecret:this._consumerSecret}},$OAuth2Token:function(){return d.oauth2Token},$OAuth2TokenHeaders:function(){return{oauth2_token:d.OAuth2Token()}},OAuth2Token:function(){return d.OAuth2Token()},OAuth2TokenHeaders:function(){return d.OAuth2TokenHeaders()},_handleLoginResponse:function(m,r,g,o,k){k=k||a.PlusRequestReq.PlusRequest.noOp;var j=null;var h=0;try{j=a.CoreReq.Core.Analytics._getPipe();h=r.configuration["current_time"];j._setUTC(h*1000)}catch(t){NgLogException(t)}var u=this;if(!m&&r&&r.success===true){NgLogD("_handleLoginResponse success");this.userID=r.user_id;if(this._cache){delete this._cache;this._cache=null}this.accessToken=r.oauth_token;this.accessSecret=r.oauth_secret;d.oauth2Token=r.oauth2_token;NgLogD("UserLogin: Get user with data "+JSON.stringify(r?r.profile:"No Profile Information"));NgLogD("UserLogin: Got OAuth 2 token with length:"+d.oauth2Token.length);NgLogT("@@@ mobage Session.js _handleLoginResponse getUserWithData +");var n=a.UserReq.User.getUserWithData(r.profile);NgLogT("@@@ mobage Session.js _handleLoginResponse getUserWithData -");if(!n){k("Could not get user from good data",null);return}if(r.messages){NgLogD("UserLogin: Have messages waiting... "+JSON.stringify(r.messages));for(var q=0;q<r.messages.length;q++){a.SystemMessagesStack.onSystemMessage(r.messages[q])}}n.entityTag=g.etag||n.entityTag;a.UpdaterReq.Updater.stop();if(this._cache){this._cache.saveCache(function(x,w){NgLogD("Old cache saved with err "+x)});this._cache=null}a.UserReq.User.setCurrentUser(n);this._user=n;this.emit({user:n});a.UpdaterReq.Updater.start();if(j){j.setMeta("uid",n.recordID);j.setMeta("plus",n.gamertag);if(n.grade){j.setMeta("grade",n.grade.toString())}}var l=d._authTokenKeyForServerModeAndAppKey(a.PlusRequestReq.PlusRequest.getServerMode(),this.appKey());var s=r.auth_token;NgLogD("Setting local storage - '"+l+"': '"+s+"'");NgLogT("@@@ mobage Session.js _handleLoginResponse imports.Storage.KeyValueCache.local.setItem +");a.Storage.KeyValueCache.local.setItem(l,s,function(){NgLogT("@@@ mobage Session.js _handleLoginResponse imports.Storage.KeyValueCache.local.setItem -");k(m,u)});if(this==d.getCurrentSession()){a.Dispatcher.sendSession(this)}}else{if(u.gameData&&u.gameData.triedHardcodedUsernameAndPassword!==true&&u.gameData.username&&u.gameData.password){NgLogD("Privileged Session: Doing manual hardcoded login for "+u.gameData.username);var p=u.gameData.username;var v=u.gameData.password;u.gameData.triedHardcodedUsernameAndPassword=true;u.loginWithUsernameAndPassword(p,v,k)}else{m=(r&&r.error_msg)?r.error_msg:m;k(m,u,r)}}},$_authTokenKeyForServerModeAndAppKey:function(h,j){var g="com.ngmoco.plus.session.auth_token."+h+"."+j;return g},_loginParameters:function(){NgLogD("_loginParameters");var k={};var o=a.NetworkUtils.getDeviceIdForPlatformServer();if(o){k.id=o}var g=a.Capabilities.getDeviceName();if(g){k.device_type=g}var r="";try{r=a.Capabilities.getBinaryDistributionName();if(!r){r=a.Capabilities.getDistributionName()}}catch(n){r=a.Capabilities.getDistributionName()}if(r){k.distribution_name=r}var j=a.Capabilities.getCarrier();if(j){k.carrier=j}var m=a.Capabilities.getPlatformOS();var p=a.Capabilities.getPlatformOSVersion();var q=m+"/"+p;if(a.Capabilities.isPlatformAndroid()||a.Capabilities.isPlatformFlash()){q="Android/"+p}else{if(a.Capabilities.isPlatformIOS()){q="iOS/"+p}}k.os_version=q;k.locale=a.Capabilities.getLocale();var h=new Date();var l=0-h.getTimezoneOffset()*60;k.timezone="offset "+l;NgLogD("ret.timezone");NgLogD(k.timezone);return k},end:function(){},isSomeoneLoggedIn:function(){return !(this._user===undefined||this._user===null)},$_checkSessionStatusSecure:function(g){a.PlusRequestReq.PlusRequest._checkSessionStatusSecure(g)},$_sendPasswordResetEmailWithAddress:function(h,g){a.PlusRequestReq.PlusRequest.sendPasswordResetEmailWithAddress(h,g)},$_isLocalDevelopmentMode:function(){return false},$getConsumerInfo:function(m,h,g){g=g||a.PlusRequestReq.PlusRequest.noOp;var j=d._currentSession;var l={consumerKey:"",consumerSecret:"",appId:m,appVersion:"1.0"};var k=new d(l);d._currentSession=k;NgLogT("@@@ mobage Session.js $getConsumerInfo imports.N0kler.getConsumerInfo +");a.N0kler.getConsumerInfo(d.getCurrentSession().appKey(),function(p,q,r,n){NgLogT("@@@ mobage Session.js $getConsumerInfo imports.N0kler.getConsumerInfo -");d._currentSession=j;if((!p)&&(q)&&(q.success===true)){g(null,q.consumer_key,q.consumer_secret)}else{var o=d.NO_KEYS_ERR+" AppId="+m+" Error: "+p;NgLogE(o);g(d.NO_KEYS_ERR)}})},$switchToSessionWithConfig:function(h,g){a.AppConfig.setUsePlatformSpecificAppId(h);g=g||a.PlusRequestReq.PlusRequest.noOp;NgLogD("Mobage/Session: Switching to session for "+JSON.stringify(h));var j=a.PlusRequestReq.PlusRequest.apiDomain;if(h.hasOwnProperty("socialServer")&&h.hasOwnProperty("socialConsumerKey")&&h.hasOwnProperty("socialConsumerSecret")&&h.hasOwnProperty("username")&&h.hasOwnProperty("password")){d.beginGameSessionWithConfig(h,g);return}d.getConsumerInfo(h.appId,h,function(n,k,m){if(n){a.PlusRequestReq.PlusRequest.apiDomain=j;g(n);return}var l={consumerKey:k,consumerSecret:m,appId:h.appId,appVersion:"1.0"};var o=d.getCurrentSession();var q=new d(l);var p=function(){d._currentSession=q;a.Dispatcher.sendSession(q);if(d._emitter){d._emitter.emit({session:q})}g(null,q)};if(!o.user()){if(h.requireMobageLogin){NgLogD("Mobage/Session: No existing user, forcing login "+JSON.stringify(h));d._currentSession=q;p()}else{NgLogD("Mobage/Session: No user logged in, skipping delegated OAuth login");p()}}else{a.PlusRequestReq.PlusRequest.getSessionTokensForConsumerKey(k,function(r,s){NgLogD("Mobage/Session/getSessionTokensForConsumerKey returned err="+r);if(r||!s||!s.success){a.PlusRequestReq.PlusRequest.apiDomain=j;g(r);return}q.accessToken=s.oauth_token;q.accessSecret=s.oauth_secret;q._user=d._currentSession.user();p()})}})},_clearAuthToken:function(g){var h=d._authTokenKeyForServerModeAndAppKey(a.PlusRequestReq.PlusRequest.getServerMode(),this.appKey());var j=undefined;a.Storage.KeyValueCache.local.setItem(h,j,function(){g()})},$_storeGuestCredentials:function(j,l,g){g=g||a.PlusRequestReq.PlusRequest.noOp;var k=f.Capabilities.getGameDir()+"/.shortbus";var h=37;var n=j+":"+l;for(var m=0;m<n.length;m++){n[m]=String.fromCharCode(h^n.charCodeAt(m))}a.Storage.FileSystem.writeFile(k,n,{blocking:true},function(o){if(o){NgLogE("ERROR storing guest credentials: "+o)}g(o)})},$_retreiveGuestCredentials:function(g){var j=f.Capabilities.getGameDir()+"/.shortbus";var h=37;a.Storage.FileSystem.readFile(j,{blocking:true},function(n,o){if(n){if(n.indexOf("Could not read file")===0){NgLogD("Mobage/_retreiveGuestCredentials: No credentials found");g(null,null,null)}else{NgLogE("Mobage/_retreiveGuestCredentials: Error getting guest credentials: "+n);g(n,null,null)}return}var m=o;if(m===null||typeof m!="string"||m.length<3){NgLogE("Mobage/_retreiveGuestCredentials: ERROR getting guest credentials, data was invalid");g("stored guest credentials corrupted",null,null);return}for(var l=0;l<m.length;l++){m[l]=String.fromCharCode(h^m.charCodeAt(l))}var k=m.split(":");if(k.length<2){NgLogE("Mobage/_retreiveGuestCredentials: ERROR getting guest credentials, data was invalid");g("stored guest credentials corrupted",null,null);return}NgLogE("Mobage/_retreiveGuestCredentials: Got username and password for guest user OK.");g(null,k[0],k[1])})},$_clearGuestCredentials:function(g){g=g||a.PlusRequestReq.PlusRequest.noOp;var h=f.Capabilities.getGameDir()+"/.shortbus";NgLogD("Mobage: Deleting guest user credentials now.");a.Storage.FileSystem.deleteFile(h,{blocking:true},function(j){if(j){NgLogE("ERROR clearing guest credentials: "+j)}else{NgLogD("Mobage: Finished deleting guest credentials!")}g()})},$_forceLogin:function(g){a.loadThenAct("Credentials",function(h){h.showLogin(function(){a.Dispatcher.sendSession(d.getCurrentSession());g()})})},_getABHeaders:function(g){var j="";var h="";if(a.Capabilities.getAppReleaseVersion()){h=a.Capabilities.getAppReleaseVersion()}if(g&&g.gameData&&g.gameData.config&&g.gameData.config.releaseVersion){j=g.gameData.config.releaseVersion}NgLogD("X-Mobage-Release-Id: "+h+", X-Game-Release-Id: "+j);return{"X-Mobage-Release-Id":h,"X-Game-Release-Id":j}}});d.beginGameSessionWithData=function(j,g){a.AppConfig.setUsePlatformSpecificAppId(j);g=g||a.PlusRequestReq.PlusRequest.noOp;if(!j){throw"Missing game data, cannot connect to Plus"}var n=j.consumerKey;var k=j.consumerSecret;var m=j.appId;var h=j.appVersion;if(!n){throw"Missing consumerKey, cannot connect to Plus+"}if(!k){throw"Missing consumerSecret, cannot connect to Plus+"}if(!m){throw"Missing appId, cannot connect to Plus+"}if(!h){throw"Missing appVersion, cannot connect to Plus+"}var l=new d(j);d._currentSession=l;if(d._emitter){d._emitter.emit({session:l})}a.Dispatcher.sendSession(l);l.loginWithExistingSession(g||function(){})};d.beginGameSessionWithConfig=function(h,g){a.AppConfig.setUsePlatformSpecificAppId(h);g=g||a.PlusRequestReq.PlusRequest.noOp;var j=a.PlusRequestReq.PlusRequest.apiDomain;if(h.hasOwnProperty("socialServer")){a.PlusRequestReq.PlusRequest.apiDomain=h.socialServer}else{a.PlusRequestReq.PlusRequest.apiDomain="app-sandbox.mobage.com"}NgLogD("Mobage/Session: setting Plus server to "+a.PlusRequestReq.PlusRequest.apiDomain);NgLogD("Mobage/Session: Beginning game session with config: "+JSON.stringify(h));d.getConsumerInfo(h.appId,h,function(n,k,m){if(n){a.PlusRequestReq.PlusRequest.apiDomain=j;g(n);return}var l={username:h.username,password:h.password,consumerKey:k,consumerSecret:m,appId:h.appId,appVersion:"1.0",config:h};var o=new d(l);d._currentSession=o;if(d._emitter){d._emitter.emit({session:o})}a.Dispatcher.sendSession(o);o.loginWithExistingSession(function(q,p){if(q){o.loginWithStoredGuest(g||function(){})}else{if(g){g(q,p)}}})})};d.endGameSession=function(){};d.getCurrentSession=function(){return d._currentSession};d.isCurrentSessionValid=function(){return(d._currentSession)?!!d._currentSession.user():false};d.getCurrentSessionUser=function(){return(d._currentSession)?d._currentSession.user():null};d.isCurrentSessionUser=function(g){if(!d._currentSession||!d._currentSession.user()){return false}return d._currentSession.user().is(g)};d._emitter=null;d.addCurrentSessionListener=function(h,j,g){if(!d._emitter){d._emitter=new a.MessageEmitterReq.MessageEmitter()}d._emitter.addListener(h,j,g)};d.removeCurrentSessionListener=function(g){if(d._emitter){d._emitter.removeListener(g)}};d.addCurrentSessionListener(new a.CoreReq.Core.MessageListener(),function(){a.Dispatcher.sendSession(d.getCurrentSession())});var e=b.SessionListener=a.CoreReq.Core.MessageListener.subclass({callback:null,initialize:function($super,g){$super();this.callback=g;d.addCurrentSessionListener(this,this._onEvent.bind(this))},_onEvent:function(g){if(g&&g.session&&typeof this.callback=="function"){this.callback(g.session)}},destroy:function(){d.removeCurrentSessionListener(this);this.callback=null}})}};__ngs._p={_c:null,_d:function(){var c={exports:{}};var b=c.exports;this._c=c;var e=__ngs.r_(__ngs._5).Core;var a=new (__ngs.r_(__ngs._f).RequireLoader)({_LocalGameList:function(){return __ngs.r_(__ngs._g)._LocalGameList},AlertDialog:function(){return __ngs.r_(__ngs._i).AlertDialog},NetworkEmitter:function(){return __ngs.r_(__ngs._18).NetworkEmitter}});var d=b.StartupNetworkListener=e.MessageListener.singleton({classname:"StartupNetworkListener",start:function(){if(!this.LocText){this.LocText=__ngs.r_(__ngs._n).LocalizedString}this.slowText=this.mediumText=null;this.connectionState=0;this._aveRates=[];a.NetworkEmitter.setPerformanceThreshold({minRate:(5<<30),duration:5000});a.NetworkEmitter.addPerformanceListener(this,this.onPerformanceAlert.bind(this));a.NetworkEmitter.setConnectionThreshold({maxConnTime:5000});a.NetworkEmitter.addConnectionListener(this,this.onConnectionAlert.bind(this))},stop:function(){a.NetworkEmitter.removePerformanceListener(this);a.NetworkEmitter.removeConnectionListener(this)},showPendingError:function(){if(this._pendingErrorCb){this._pendingErrorCb();this._pendingErrorCb=null}},onConnectionAlert:function(f){NgLogI("StartupNetworkListener Connection Alert: "+JSON.stringify(f));switch(this.connectionState){case 0:this._showSlowMessage();this.connectionState=1;a.NetworkEmitter.setConnectionThreshold({maxConnTime:10000});break;case 1:this._showMediumMessage();this.connectionState=2;a.NetworkEmitter.setConnectionThreshold({maxConnTime:20000});break;case 2:this._showHardDialog();this.connectionState=3;a.NetworkEmitter.removeConnectionListener(this);break;default:NgLogE("Error: MobageBoot is still showing ongoing network issues")}},onPerformanceAlert:function(f){NgLogI("StartupNetworkListener Performance Alert: "+JSON.stringify(f));this._aveRates.push(f.aveRate);if(this._failsRate(1<<10,4)){this._showHardDialog()}else{if(this._failsRate(1<<10,2)){this._showMediumMessage()}else{if(this._failsRate(5<<10,1)){this._showSlowMessage()}}}},_showSlowMessage:function(){if(!this.slowText){this.slowText=this.LocText("Slow connection. Please wait…")}NgLogD("StartupNetworkListener: Slow Performance");this._showMessageFor(this.slowText,2000)},_showMediumMessage:function(){if(!this.mediumText){this.mediumText=this.LocText("You may want to find better signal…")}NgLogD("StartupNetworkListener: Really Slow Performance");this._showMessageFor(this.mediumText,2000)},_showHardDialog:function(){NgLogD("StartupNetworkListener: Horrible Performance");if(!this._showingDialog){this._showingDialog=true;var f=function(){var h=new a.AlertDialog({title:this.LocText("Unable to connect"),text:this.LocText("Please check that your network settings are correct and that you have a good signal.")});h.setChoices(["OK"]);var g=this;h.onchoice=function(j){g._showingDialog=false;h.destroy()};h.show();setTimeout(function(){if(!h._destroyed){g._showingDialog=false;h.destroy()}},10000)}.bind(this);if(e.LocalGameList.progressVisible){f()}else{this._pendingErrorCb=f}}},_failsRate:function(h,f){for(var g=this._aveRates.length-1;g>=this._aveRates.length-f;g--){if(this._aveRates[g]>h){return false}}return true},_showMessageFor:function(f,g){if(this.oldText||!f||!g){return}this.oldText=a._LocalGameList._progressText;a._LocalGameList.setProgressText(f);if(this.oldText){setTimeout(function(){if(a._LocalGameList._progressText==f&&this.oldText){a._LocalGameList.setProgressText(this.oldText);delete this.oldText}}.bind(this),g)}}})}};__ngs._q={_c:null,_d:function(){var d={exports:{}};var c=d.exports;this._c=d;var g=__ngs.r_(__ngs._5).Core;var a=new (__ngs.r_(__ngs._f).RequireLoader)({AppConfig:function(){return __ngs.r_(__ngs._29).AppConfig},VerticalTabController:function(){return __ngs.r_(__ngs._35).VerticalTabController},AB:function(){return __ngs.r_(__ngs._2l).AB},LifecycleEmitter:function(){return __ngs.r_(__ngs._11).LifecycleEmitter}});var f=function(j){if(j=="_BACKBUTTON"){return j}else{if(j&&j.analyticsName){var h=j.analyticsName;if(typeof h=="function"){h=h()}return h}else{if(j&&j.classname){return j.classname}}}return"UNKNOWN"};var e={_heartbeatTickRate:30000,_heartbeatCount:0,tickHeartbeat:function(){var h=new Date().getTime();if(!e._lastHeartbeatTime||h-e._lastHeartbeatTime>=e._heartbeatTickRate-100){e._lastHeartbeatTime=h;if(e._scheduledHeartbeat){clearTimeout(e._scheduledHeartbeat)}var j={evid:"SHB",evcl:"PLUS",srcty:"PC",hwty:g.Capabilities.getDeviceName(),hwrev:g.Capabilities.getPlatformHW(),osrev:""+g.Capabilities.getPlatformOS()+" "+g.Capabilities.getPlatformOSVersion(),lang:g.Capabilities.getLanguage(),evpl:{heartbeat_num:e._heartbeatCount}};g.Analytics._getPipe()._queueMessage(j,b.platformGameSku);e._heartbeatCount++;e._scheduledHeartbeat=setTimeout(e.tickHeartbeat,e._heartbeatTickRate)}}};var b=c.MobageAnalytics=g.Class.singleton({classname:"MobageAnalytics",setGameSkuForPlatformEvents:function(h){b.platformGameSku=h},reportEvent:function(h,j){g.Analytics._getPipe().plusEvent(h,j,b.platformGameSku)},beginHeartbeat:function(){if(b.doingHeartbeat){return}b.doingHeartbeat=true;var h=g.MessageListener.subclass({_onLifecycleEvent:function(j){if(j===a.LifecycleEmitter.Event.Resume){e.tickHeartbeat()}return true},destroy:function(){a.LifecycleEmitter.removeListener(this)}});b._lifecycleListenerInstance=new h();a.LifecycleEmitter.addListener(b._lifecycleListenerInstance,b._lifecycleListenerInstance._onLifecycleEvent);e.tickHeartbeat()},logNavEvent:function(n,m,j){if(n&&n instanceof a.VerticalTabController&&n.curSelectedView&&n.curSelectedView.controller){n=n.curSelectedView.controller||n}if(m&&m instanceof a.VerticalTabController&&m.curSelectedView&&m.curSelectedView.controller){m=m.curSelectedView.controller||m}var h=f(m);var k=f(n);var l=f(j);if(k||h){b.reportEvent("MOBAGENAV",{to:h,from:k,btnid:l})}},setLoginRegEventingSession:function(j,h){b.loginRegSession=j;b.loginRegReferrer=h},reportLoginRegEvent:function(j,h){if(!h){h={}}h.Version=a.AppConfig.getPlatformVersion();h.AppKey=b.platformGameSku;h.regSession=b.loginRegSession;h.regReferrer=b.loginRegReferrer;a.AB.getServiceVariants(function(k,l){if(l){if(l.regFlow){h.serviceVariantRegFlow=l.regFlow}if(l.regFlowTieredVariant){h.regFlowTieredVariant=l.regFlowTieredVariant}}h=b.addOptionalPayloadValue(h);b.reportEvent(j,h)})},logStartupFlowEvent:function(h,j){if(!b.sentStartupEvents){b.sentStartupEvents={}}if(!b.sentStartupEvents[h]){b.sentStartupEvents[h]=true;if(!j){j={}}j=this.addOptionalPayloadValue(j);NgLogD('Mobage/Analytics: Sending startup funnel event "'+h+'" with payload: '+JSON.stringify(j));b.reportEvent(h,j)}},logStartupFlowError:function(j,h,k){if(!k){k={}}k=this.addOptionalPayloadValue(k);NgLogD('Mobage/Analytics: Startup funnel error for step: "'+j+'", error is: '+h+", additional payload: "+JSON.stringify(k));k.error=h;b.reportEvent(j+"Err",k)},addOptionalPayloadValue:function(k){k.bundle=g.Capabilities.getBundleIdentifier();var h="";try{h=g.Capabilities.getBinaryDistributionName();if(!h){h=g.Capabilities.getDistributionName()}}catch(j){h=g.Capabilities.getDistributionName()}k.distribution=h;k.carrier=g.Capabilities.getCarrier();try{k.netcountry=g.Capabilities.getNetworkCountryCode();k.simcountry=g.Capabilities.getSimCountryCode()}catch(j){}return k}})}};__ngs._r={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;a.Social={};a.Social.Common=new (__ngs.r_(__ngs._2b).InterfaceLoader)({Appdata:["_38",function(c){return c.Appdata}],Auth:["_39",function(c){return c.Auth}],Blacklist:["_3a",function(c){return c.Blacklist}],Config:["_3b",function(c){return c.Config}],People:["_3c",function(c){return c.People}],Profanity:["_3d",function(c){return c.Profanity}],Leaderboard:["_3e",function(c){return c.Leaderboard}],RemoteNotification:["_3f",function(c){return c.RemoteNotification}],Request:["_3g",function(c){return c.Request}]});a.Social.US=new (__ngs.r_(__ngs._2b).InterfaceLoader)({DataModel:["_3h",function(c){return c.DataModel}],AppData:["_3i",function(c){return c.AppData}],Game:["_2e",function(c){return c.Game}],Leaderboard:["_3j",function(c){return c.Leaderboard}],Achievement:["_3k",function(c){return c.Achievement}],Score:["_3l",function(c){return c.Score}],User:["_30",function(c){return c.User}],FullGamercard:["_3m",function(c){return c.FullGamercard}],Cache:["_32",function(c){return c.Cache}],Session:function(){return __ngs.r_(__ngs._o).Session},Dispatcher:function(){return __ngs.r_(__ngs._2f).Dispatcher},AB:function(){return __ngs.r_(__ngs._2l).AB},Reward:function(){return __ngs.r_(__ngs._36).Reward}});a.Social.US.Service=new (__ngs.r_(__ngs._2b).InterfaceLoader)({Banking:["_3n",function(c){return c.Banking}],Friends:["_3o",function(c){return c.Friends}],Leaderboards:["_3p",function(c){return c.Leaderboards}],Games:["_3q",function(c){return c.Games}],Home:["_3r",function(c){return c.Home}],Profile:["_3s",function(c){return c.Profile}],ButtonOverlays:["_2p",function(c){return c.ButtonOverlays}],Tests:["_3t",function(c){return c.Tests}],GameLaunchPayload:["_3u",function(c){return c.GameLaunchPayload}],Achievements:["_3v",function(c){return c.Achievements}]});a.__defineGetter__("Bank",function(){delete a.Bank;return a.Bank=__ngs.r_(__ngs._37).Bank})}};__ngs._s={_c:null,_d:function(){var b={exports:{}};var a=b.exports;this._c=b;function c(e){this.add=function(g,f){this.__defineGetter__(g,function(){delete this[g];return this[g]=f()})};for(var d in e){if(e.hasOwnProperty(d)){this.add(d,e[d])}}}a.Network=new c({XHR:function(){return __ngs.r_(__ngs._x).XHR},DownloadFile:function(){return __ngs.r_(__ngs._z).DownloadFile},DownloadManifest:function(){return __ngs.r_(__ngs._2).DownloadManifest},Util:function(){return __ngs.r_(__ngs._y).Util},_int_Util:function(){return __ngs.r_(__ngs._3w)._int_Util},Socket:function(){return __ngs.r_(__ngs._3x).Socket},DNS:function(){return __ngs.r_(__ngs._3y).DNS},Diagnostics:function(){return __ngs.r_(__ngs._3z).Diagnostics},WS:function(){return __ngs.r_(__ngs._40).WS},URL:function(){return __ngs.r_(__ngs._41).URL}})}};(function(){if(!Function.prototype.hasOwnProperty("bind")){var a=Array.prototype.slice;Function.prototype.bind=function(c){var d=this;if(arguments.length>1){var b=a.call(arguments,1);return function(){if(arguments.length){var e=b.concat(a.call(arguments));return d.apply(c,e)}else{return d.apply(c,b)}}}else{return function(){if(arguments.length){return d.apply(c,arguments)}else{return d.call(c)}}}}}})();(function(){if(!Array.prototype.hasOwnProperty("indexOf")){Array.prototype.indexOf=function(c){var a=this.length;for(var b=0;b<this.length;++b){if(c===this[b]){return b}}return -1}}})();var $APP_REQUIREPATHMAP={};function userGameInit(){console.log("ngCore calling main()");main()}var NGSetTimeoutRunTimers=__ngs.r_(__ngs._0).NGSetTimeoutRunTimers;var SystemBinding=__ngs.r_(__ngs._1).SystemBinding;var Downloader=__ngs.r_(__ngs._2).Downloader;var LocalGameList=__ngs.r_(__ngs._3).LocalGameList;var Device=__ngs.r_(__ngs._4).Device;var Core=__ngs.r_(__ngs._5).Core;var Proc=__ngs.r_(__ngs._6).Proc;var Capabilities=__ngs.r_(__ngs._7).Capabilities;var Localization=__ngs.r_(__ngs._8).Localization;var Audio_Device=__ngs.r_(__ngs._9).Device;var Storage=__ngs.r_(__ngs._a).Storage;var NgProcID={PersistProc:-1,GameProc:-2};var gNgShutdownPending=false;var gNgEngineEntities;var gNgAddedEngineEntities;var gNgRemovedEngineEntities;var gNgUpdateEngineEntities;var gNgTouchEngineEntities;var gNgKeyPressEngineEntities;function NgEngineInitPrivate(){NgLogInit();NgApplication.getInstance().restart();gNgEngineEntities=[];gNgAddedEngineEntities=[];gNgRemovedEngineEntities=[];gNgUpdateEngineEntities=[];gNgTouchEngineEntities=[];gNgKeyPressEngineEntities=[]}function NgEngineProcessEntityAddRemove(){var a,b;for(a in gNgAddedEngineEntities){b=gNgAddedEngineEntities[a];if(b.mIsUpdatable){gNgUpdateEngineEntities[b.mId]=b}}gNgAddedEngineEntities=[];for(a in gNgRemovedEngineEntities){b=gNgRemovedEngineEntities[a];if(b.mIsUpdatable){delete gNgUpdateEngineEntities[b.mId]}}gNgRemovedEngineEntities=[]}function NgHandleException(a){if(Core.Proc.isPrivileged()){NgLogException(a)}else{NgLogException(a);var b=JSON.stringify(a);Core.LocalGameList._forwardException(b)}}function NgEngineInit(a){NgLogD("NgEngineInit beg");try{NgEngineInitPrivate();NgLogD("KeyValue Storage initializing...");Storage.KeyValueCache.init();NgLogD("KeyValue Storage initialized...");Core.Time.instantiate();NgLogD("Instantiate the Localization context (singleton), depends on Capabilities");Localization.instantiate()}catch(b){try{NgHandleException(b)}catch(c){console.log("ERROR! NgEngineInit NgHandleException exception!")}}NgLogD("NgEngineInit end");return NgEngineUpdate(a)}function NgPreInit(a){NgLogD("Localization NgPreInit beg");return update(a)}function NgGameInit(a){NgLogD("NgGameInit beg");Core.Analytics.instantiate();try{userGameInit()}catch(b){NgHandleException(b)}NgLogD("NgGameInit end");return update(a)}function update(a){return NgEngineUpdate(a)}var NGSetTimeoutRunTimers=__ngs.r_(__ngs._0).NGSetTimeoutRunTimers;var setTimeoutOrig=setTimeout;setTimeout=function(a,b){return setTimeoutOrig(function(){try{a()}catch(c){NgHandleException(c)}},b)};var setIntervalOrig=setInterval;setInterval=function(a,b){return setIntervalOrig(function(){try{a()}catch(c){NgHandleException(c)}},b)};var NgEngineUpdate=(function(){var a=__ngs.r_(__ngs._5).Core;return function(c){var f;try{NGSetTimeoutRunTimers();if(typeof c==="function"){c()}else{if(c.length){NgEngineProcessEntityAddRemove();var b=c.split(":");for(f=0;f<b.length;++f){var j=b[f];if(0===j.length){continue}switch(parseInt(j)){case NgEntityTypes.App:NgApplication.getInstance().handleCommand(j);break;case NgEntityTypes.NgFileSys:NgApplication.getInstance().getFileSys().handleCommand(j);break;case NgEntityTypes.Storage:NgLogD("Command for storage is "+j);Storage.getInstanceForCommand(j).handleCommand(j);break;case NgEntityTypes.NgUI:var g=__ngs.r_(__ngs._b).Window;g.handleCommand(j);break;case NgEntityTypes.NgSystemBinding:SystemBinding.handleCommand(j);break;case 3117:console.log("got leet response");if(typeof(_WifiDiagCallback)!="undefined"){_WifiDiagCallback(j)}break;default:a.Proc._classRecvGen(j.split(","));break}}}}if(gNgShutdownPending){gNgShutdownPending=false}else{NgEngineProcessEntityAddRemove();for(f in gNgUpdateEngineEntities){var d=gNgUpdateEngineEntities[f];if(!d.mRegistered){continue}d.onUpdate()}}}catch(e){NgHandleException(e)}var h=a.Proc.getCommandString()+NgFlushCommandsToString();a.Proc.clearCommandString();return h}})();var Capabilities=__ngs.r_(__ngs._7).Capabilities;var Logger=__ngs.r_(__ngs._c).Logger;var NgApplicationCommands={Caps:0,Debug:1,FrameTime:2,FrameRate:3,Start:4,DeviceOrientation:10,SetOrientation:11,BackPress:12,OnBackPressed:13,LaunchExternalNativeApp:15,ExitSystemProcess:16};var NgApplicationOrientation={Portrait:0,PortraitUpsideDown:1,LandscapeLeft:2,LandscapeRight:3,FaceUp:4,FaceDown:5};function NgApplication(){this.mFileSys=Storage.FileSystem;this.mFrameTime=0;this.mObservers=[]}NgApplication.sInstance=null;NgApplication.getInstance=function(){if(NgApplication.sInstance===null){NgApplication.sInstance=new NgApplication()}return NgApplication.sInstance};NgApplication.prototype={mFileSys:null,mObservers:[],mFrameTime:0,restart:function(){},handleCommand:function(b){var a=NgPeekCommandId(b);switch(a){case NgApplicationCommands.FrameTime:this.parseFrameTime(b);break;case NgApplicationCommands.Start:this.onApplicationStart();break;case NgApplicationCommands.OnBackPressed:this.onApplicationBackPressed();break;default:NgLogE("NgApplication command unknown: "+b);break}},getFileSys:function(){return this.mFileSys},ngLog:function(b,a){NgPushCommand4(NgEntityTypes.App,NgApplicationCommands.Debug,Core.Base64.encode(a),b)},parseFrameTime:function(c){var a=NgParseCommand2(c,parseInt,parseFloat);var b=a[1];if(this.mFrameDelta===undefined){this.mFrameDelta=0}else{this.mFrameDelta=b-this.mFrameTime}this.mFrameTime=b},getFrameTime:function(){return this.mFrameTime},getFrameDelta:function(){return this.mFrameDelta},setFrameRate:function(a){NgPushCommand3(NgEntityTypes.App,NgApplicationCommands.FrameRate,a)},setOrientation:function(a){NgPushCommand3(NgEntityTypes.App,NgApplicationCommands.SetOrientation,a)},registerObserver:function(a){a.index=this.mObservers.push(a)},unregisterObserver:function(a){if(a.index){delete this.mObservers[a.index-1]}},onApplicationStart:function(){for(var a in this.mObservers){this.mObservers[a].onApplicationStart()}},onApplicationReceivedCustomMessage:function(b){for(var a in this.mObservers){this.mObservers[a].onApplicationReceivedCustomMessage(b)}},onApplicationBackPressed:function(){var b=false;for(var a in this.mObservers){if(this.mObservers[a].onApplicationBackPressed()){b=true;break}}if(!b){NgPushCommand2(NgEntityTypes.App,NgApplicationCommands.BackPress)}},exitSystemProcess:function(){NgLogD("pushing exit command");NgPushCommand2(NgEntityTypes.App,NgApplicationCommands.BackPress);NgLogD("pushed exit command")}};function NgApplicationObserver(){}NgApplicationObserver.prototype={index:0,onApplicationStart:function(){},onApplicationReceivedCustomMessage:function(a){},onApplicationDeviceOrientation:function(a){},onApplicationBackPressed:function(){return false}};var NgEntityTypes={App:1,NgTouchEvent:2,NgKeyPressEvent:3,Accel:4,NgTextInputBox2D:5,Animation:6,Sound:7,NgEngineEntity:8,NgDrawableEntity2D:9,NgCanvas2D:10,NgCamera2D:11,NgSprite2D:12,NgText2D:13,NgWebView2D:14,NgGroup2D:16,NgPhysics2D:17,NgPrimitive2D:18,NgFileSys:19,Gyro:22,NgUI:23,Storage:24,NgSystemBinding:25,NgCustomMessage:50,LoadApp:100};var NgEngineEntityCommandIDs={SetNativeTouchType:1};function NgEngineEntity(){this.mId=0;this.mTouchPriority=0;this.mKeyPressPriority=0;this.mIsTouchable=false;this.mIsKeyable=false;this.mIsUpdatable=false;this.mNativeTouchType=NgEngineEntity.NativeTouchType.Enable;this.mRegistered=false}NgEngineEntity.NativeTouchType={None:0,Enable:1,EnableBounds:2};NgEngineEntity.engineCurrentId=1;NgEngineEntity.newEngineId=function(){return NgEngineEntity.engineCurrentId++};NgEngineEntity.deleteEngineId=function(){};NgEngineEntity.prototype.newEntity=function(){};NgEngineEntity.prototype.deleteEntity=function(){};NgEngineEntity.prototype.onTouch=function(a){return false};NgEngineEntity.prototype.onNativeTouch=function(a){};NgEngineEntity.prototype.onKeyPress=function(a){return false};NgEngineEntity.prototype.onUpdate=function(){};NgEngineEntity.prototype.register=function(){this.mParents=[];if(this.mId>=0){this.mId=NgEngineEntity.newEngineId()}this.mRegistered=true;gNgEngineEntities[this.mId]=this;gNgAddedEngineEntities[this.mId]=this;this.newEntity()};NgEngineEntity.prototype.unregister=function(){var a=this.mParents.concat([]);for(var b in a){NgLogD("Removing child "+this.mId+" from parent Group "+a[b].mId+" because the Entity was unregistered");a[b].removeChild(this)}this.mRegistered=false;delete gNgEngineEntities[this.mId];gNgRemovedEngineEntities[this.mId]=this;this.deleteEntity();if(this.mId>=0){NgEngineEntity.deleteEngineId(this.mId)}};NgEngineEntity.prototype.toggleUpdatable=function(){if(this.mIsUpdatable){delete gNgUpdateEngineEntities[this.mId]}else{gNgUpdateEngineEntities[this.mId]=this}this.mIsUpdatable=!this.mIsUpdatable};NgEngineEntity.prototype.setNativeTouchType=function(a){this.mNativeTouchType=a;NgPushCommand4(NgEntityTypes.NgDrawableEntity2D,NgEngineEntityCommandIDs.SetNativeTouchType,this.mId,this.mNativeTouchType)};var Core=__ngs.r_(__ngs._5).Core;var gNgCommandStrings=[];var gNgCommandString="";var gNgCommandMode=2;function NgQueueCommandText(a){switch(gNgCommandMode){case 0:case 1:gNgCommandStrings.push(a);break;case 2:gNgCommandString+=a;break}}function NgFlushCommandsToString(){var c="";switch(gNgCommandMode){case 0:for(var b=0,a=gNgCommandStrings.length;b<a;++b){c+=gNgCommandStrings[b]}break;case 1:c=String.prototype.concat.apply(gNgCommandStrings);break}switch(gNgCommandMode){case 0:case 1:gNgCommandStrings=[];break;case 2:c=gNgCommandString;gNgCommandString="";break}return c}function NgParseString(a){return a}function NgParseBase64(a){if(a){return Core.Base64.decode(a)}else{return""}}function NgParseBool(a){return parseInt(a)?true:false}function NgParseInt(a){return parseInt(a,10)}function NgKVArrayToCmd(b){var a="";var d=0;for(var c in b){var e=b[c];a+=","+c+","+Core.Base64.encode(e);++d}return d+a}function NgPushCommand1(a){gNgCommandString+=":"+a}function NgPushCommand2(b,a){gNgCommandString+=":"+b+","+a}function NgPushCommand3(c,b,a){gNgCommandString+=":"+c+","+b+","+a}function NgPushCommand4(d,c,b,a){gNgCommandString+=":"+d+","+c+","+b+","+a}function NgPushCommand5(d,c,b,a,e){gNgCommandString+=":"+d+","+c+","+b+","+a+","+e}function NgPushCommand6(d,c,b,a,f,e){gNgCommandString+=":"+d+","+c+","+b+","+a+","+f+","+e}function NgPushCommand7(d,c,b,a,g,f,e){gNgCommandString+=":"+d+","+c+","+b+","+a+","+g+","+f+","+e}function NgPushCommand8(d,c,b,a,h,g,f,e){gNgCommandString+=":"+d+","+c+","+b+","+a+","+h+","+g+","+f+","+e}function NgPushCommand9(j,h,g,f,e,d,c,b,a){gNgCommandString+=":"+j+","+h+","+g+","+f+","+e+","+d+","+c+","+b+","+a}function NgPushCommandN(){var a=arguments;var d=a.length;var c=":";if(d>0){c+=a[0];for(var b=1;b<d;++b){c+=","+a[b]}}gNgCommandString+=c}function NgPeekCommandId(b){var a=b.split(",",2);if(a.length==2){return parseInt(a[1])}else{return null}}function NgPeekClassAndCommandId(b){var a=b.split(",",2);if(a.length==2){a[0]=parseInt(a[0]);a[1]=parseInt(a[1]);return a}else{return null}}function NgParseCommandToStrings(a){return a.split(",")}function NgParseCommand1(d,b){var c=[];var a=d.split(",");c[0]=b(a[1]);return c}function NgParseCommand2(e,c,b){var d=[];var a=e.split(",");d[0]=c(a[1]);d[1]=b(a[2]);return d}function NgParseCommand3(f,d,c,b){var e=[];var a=f.split(",");e[0]=d(a[1]);e[1]=c(a[2]);e[2]=b(a[3]);return e}function NgParseCommand4(f,d,c,b,g){var e=[];var a=f.split(",");e[0]=d(a[1]);e[1]=c(a[2]);e[2]=b(a[3]);e[3]=g(a[4]);return e}function NgParseCommand5(g,d,c,b,h,f){var e=[];var a=g.split(",");e[0]=d(a[1]);e[1]=c(a[2]);e[2]=b(a[3]);e[3]=h(a[4]);e[4]=f(a[5]);return e}function NgParseCommandN(f){var d=[];var b=arguments;var e=b.length;var a=f.split(",");for(var c=1;c<e;++c){d[c-1]=b[c](a[c])}return d}function NgParseCommandDictionary(a,g,m,d){var k=true;var j=a.split(",");var f=j.length;var h;if(d){for(h=0;h<g;++h){d[h]=j[h]}}for(h=g;h<f;){var l=j[h++];var b=j[h++];var c=j[h++];var e=true;switch(l){case"i":c=parseInt(c);break;case"f":c=parseFloat(c);break;case"s":break;case"S":c=Core.Base64.decode(c);break;case"b":c=parseInt(c)?true:false;break;default:k=false;e=false;break}if(e){m[b]=c;NgLogD("dict: "+b+" : "+m[b])}else{NgLogD("dict: could not process "+l)}}return k}var Capabilities=__ngs.r_(__ngs._7).Capabilities;var FileSystem=__ngs.r_(__ngs._d).FileSystem;var gNgTrace=null;var NgDebugModes={BrowserTrace:{},NgCommand:{},NgCommandDocLoc:{}};var NgLogLevel={Verbose:5,Debug:4,Info:3,Warning:2,Error:1};var NgLogStr=["","e","w","i","d","v"];function NgSetDebugDefaultDestination(){if(typeof navigator=="undefined"){return NgDebugModes.NgCommand}var a=navigator.userAgent.toLowerCase();if(!((a.indexOf("iphone")>=0)||(a.indexOf("ipad")>=0))){return NgDebugModes.BrowserTrace}else{return NgDebugModes.NgCommand}}var gNgDebugMode=NgSetDebugDefaultDestination();function NgLogInit(){if(gNgDebugMode==NgDebugModes.BrowserTrace){gNgTrace=document.getElementById("trace")}}var NgDoVerboseLog=function(a){NgLog(NgLogLevel.Verbose,a)};var NgDoDebugLog=function(a){NgLog(NgLogLevel.Debug,a)};var NgDoInfoLog=function(a){NgLog(NgLogLevel.Info,a)};var NgDoWarningLog=function(a){NgLog(NgLogLevel.Warning,a)};var NgDoErrorLog=function(a){NgLog(NgLogLevel.Error,a)};var NgDoTimingLog=function(a){timingLog(a)};var NgNoLog=function(){};var NgLogV=NgDoVerboseLog;var NgLogD=NgDoDebugLog;var NgLogI=NgDoInfoLog;var NgLogW=NgDoWarningLog;var NgLogE=NgDoErrorLog;var NgLogT=NgDoTimingLog;function NgLogSetLevel(a){switch(a){case NgLogLevel.Debug:NgLogV=NgNoLog;NgLogD=NgDoDebugLog;NgLogI=NgDoInfoLog;NgLogW=NgDoWarningLog;NgLogE=NgDoErrorLog;NgLogT=NgDoTimingLog;break;case NgLogLevel.Info:NgLogV=NgNoLog;NgLogD=NgNoLog;NgLogI=NgDoInfoLog;NgLogW=NgDoWarningLog;NgLogE=NgDoErrorLog;NgLogT=NgDoTimingLog;break;case NgLogLevel.Warning:NgLogV=NgNoLog;NgLogD=NgNoLog;NgLogI=NgNoLog;NgLogW=NgDoWarningLog;NgLogE=NgDoErrorLog;NgLogT=NgDoTimingLog;break;case NgLogLevel.Error:NgLogV=NgNoLog;NgLogD=NgNoLog;NgLogI=NgNoLog;NgLogW=NgNoLog;NgLogE=NgDoErrorLog;NgLogT=NgDoTimingLog;break;default:case NgLogLevel.Verbose:NgLogV=NgDoVerboseLog;NgLogD=NgDoDebugLog;NgLogI=NgDoInfoLog;NgLogW=NgDoWarningLog;NgLogE=NgDoErrorLog;NgLogT=NgDoTimingLog;break}}NgLogSetLevel(NgLogLevel.Verbose);var useConsole=((typeof console!="undefined")&&(typeof console.log=="function"));function NgLog(b,a){console.log(NgLogStr[b]+": "+a)}function _exceptionNameDemangleHelper(c,b){try{var a=exception_demangle_require(c[b]);return a}catch(d){}return""}var NgLogException=(function(){var b=function(k,j,l){NgLogV(l);return j(k)};var d=function(r,m,n,p,q,l){n=n||"";p=p||"";q=q||"";l=+(l||0);if(parseInt(l,10)<=1){NgLogV("Line breaks in source may have been removed, source dump not shown");return m(r)}if(p===""||n===""||l<=0){var j="source dump error: Could not read '"+p+"' at "+l+"\n";return b(r,m,j)}var o=8;var s=l-o-1;var k=l+o-1;if(s<0){s=0}FileSystem._readLineRangeFromFile(n,{},s,0,k,-1,function(A,v){if(A){return b(r,m,"source dump error: "+A+"\n")}if(!v||v.length===0){return b(r,m,"source dump error: no data found in line range "+s+" to "+k+"\n")}var z=new Array(50).join("*");var x="".concat(z+"\n","File: "+p+"\n",q?"Function: "+q+"\n":"","Line: "+l+"\n","\n");var B=v.split("\n");var y=B[B.length-1];if(!y||y.length===0){B.length--}s++;for(var w=0;w<B.length;++w){var u=s+w;var t=B[w];x=x.concat(u,u===l?"> ":": ",t,"\n")}x+=z+"\n";m(r,x)})};function e(l,k){var j=l.stack||"";var m=/^([^\(\s]*)\(.*\)@([^:]*\/([^\/]+\.[^\.:]*)):(\d+)$/m.exec(j);l.stackWithParams=l.stack;l.stack=l.toString()+"\n"+l.stack.replace(/([^\(\s]*)\(.*\)@([^:]*\/([^\/]+\.[^\.:]*)):(\d+)/g,"\t at $1 ($2:$4)");if(m){return d(l,k,m[3],m[2],m[1],m[4])}else{return k(l)}}function c(r,l){var j=r.sourceURL||"";var n=".js";var p=j.lastIndexOf(n);if(p<0){return l(r)}p=p+n.length;var o="/";var k=j.lastIndexOf(o,p);var s=k<0?0:k+o.length;var m=j.substring(s,p);var q=j.substring(0,p);return d(r,l,m,q,r.sourceURL,r.line)}function g(l,k){var j=l.stack||"";var m=/^\s*at\s+([^\(\/]*)\s?\(?([^:]*\/([^\/]+\.js)):(\d+):\d+\)?\s*$/m.exec(j);if(m){return d(l,k,m[3],m[2],m[1],m[4])}else{return k(l)}}function h(l,k){var j=l.stack||"";var m=/^\s*at\s+([^\(\/]*)\s?\(?([^\?]*\/([^\/]+\.js)\?h=[^:]*):(\d+):\d+\)?\s*$/m.exec(j);if(m){return d(l,k,m[3],m[2],m[1],m[4])}else{return k(l)}}function a(p){var r=p.stacklevel;if(p.stack&&r&&r>0){var q=/^[^\(\s]*\(.*\)@[^:]*\/[^\/]+\.[^\.:]*:\d+$/;var n=/^\s*at\s+[^\(\/]*\s?\(?[^:]*\/[^\/]+\.js:\d+:\d+\)?\s*$/;var m=p.stack.split("\n");for(var o=0,k=m.length;o<k;++o){var j=m[o];if((j.match(q)||j.match(n))&&(o+r)<k){m.splice(o,r);p.stack=m.join("\n");break}}}}function f(n,m){var k;if(!n){k="NgLogException called with nil exception.\n";n={toString:function(){return k}}}else{if(n.stack){k=n.stack;if(k.charAt(k.length-1)!=="\n"){k+="\n"}}else{k=n.toString()+"\n[NO STACK TRACE AVAILABLE]\n"}}var p="";var q="";var o="\n\nEXCEPTION: "+k;if(Capabilities.getPlatformOS().match(/android/i)){NgLogE(o);q+=o;p+="\n"}else{p+=o}for(var r in ["sourceFile","sourceURL","fileName"]){if(n[r]){p+=_exceptionNameDemangleHelper(n,r)+"\n";break}}if(n.relatedFile){p+="\trelated to file: "+_exceptionNameDemangleHelper(n,"relatedFile")+"\n"}p+=m||"";if(typeof n==="object"){for(var j in n){if(j!=="stack"){p+="PROPERTY: "+j+" VALUE: ["+n[j]+"]\n"}}p+="\n"}NgLogE(p);q+=p;if(!Core.Proc.isPrivileged()){var l=__ngs.r_(__ngs._e).ErrorEmitter;l._handleUncaughtException(q)}}return function(k){var l=Capabilities.getPlatformOS();var j=function(n,m){m(n,"")};a(k);if(l.match(/iphone/i)){if(k.stack){j=e}else{j=c}}else{if(l.match(/android/i)){j=g}else{if(l.match(/flash/i)){j=h}else{j=g}}}j(k,f)}})();var Core=__ngs.r_(__ngs._5).Core;var imports=new (__ngs.r_(__ngs._f).RequireLoader)({_LocalGameList:function(){return __ngs.r_(__ngs._g)._LocalGameList},_int_LGL:function(){return __ngs.r_(__ngs._h)._int_LGL},Storage:function(){return __ngs.r_(__ngs._a).Storage},AlertDialog:function(){return __ngs.r_(__ngs._i).AlertDialog},Toast:function(){return __ngs.r_(__ngs._j).Toast},AugmentCapabilities:function(){return __ngs.r_(__ngs._k).AugmentCapabilities},CheckBinaryVersion:function(){return __ngs.r_(__ngs._l).CheckBinaryVersion},GameServiceMain:function(){return __ngs.r_(__ngs._m).Main},LocText:function(){return __ngs.r_(__ngs._n).LocalizedString},Session:function(){return __ngs.r_(__ngs._o).Session},StartupNetworkListener:function(){return __ngs.r_(__ngs._p).StartupNetworkListener},MobageAnalytics:function(){return __ngs.r_(__ngs._q).MobageAnalytics},PrivSocial:function(){return __ngs.r_(__ngs._r).Social}});function main(){NgLogD("@@@ mobage main +");imports.MobageAnalytics.logStartupFlowEvent("MobageBootMain");imports._LocalGameList.setProgressText(imports.LocText("Connecting to network…"));imports.AugmentCapabilities();var c=imports.CheckBinaryVersion.checkForBinaryUpdates();if(!c){var h=imports.GameServiceMain.switchToGame;imports._LocalGameList.mobageRunGame(h);var g=Core.Capabilities._getBootServer();if(!g.match(/.*\/$/)){g+="/"}var b=Core.Capabilities.getStartingServer();if(!b.match(/.*\/$/)){b+="/"}NgLogD("@@@ mobage main NGCore boot +");boot(g,Core.Capabilities._getBoot(),b,Core.Capabilities.getBootGame());NgLogD("@@@ mobage main NGCore boot -")}var a=Core.Capabilities._getReferrer();if(a){try{var f={};if(a.substring(0,4)==="lsm="){f.ref="AndroidMarket";f.mrkt=a}else{f.ref=a}imports._LocalGameList.getGameConfig(Core.Capabilities.getGameDir(),true,function(j){try{Core.Analytics._getPipe().plusEvent("referrer",a,j.appId)}catch(k){NgLogException(k)}})}catch(d){NgLogException(d)}}NgLogD("@@@ mobage main -")}function runGame(a){for(var c in Capabilities){if(typeof c==="function"){NgLogD("   : FN = "+c)}}if(!a||a===""){NgLogD("MobageBoot: bypassing game launch and running the game service...");startMobage(a,function(){Core.Proc.load("NGCore/Client/Social/_Internal/US/Interface/Privileged/Service/Home",function(d){setTimeout(d.Home.showMobage,500)})})}else{if(Core.Capabilities.getIsDisaggregated()){runGameDisaggregated(a)}else{if(imports.Session._isLocalDevelopmentMode()||!isGameBundled(a)){NgLogD("In local development mode or game is not bundled, updating game ,url="+a);imports._LocalGameList.updateGame(a,-1,function(d,f){if(f){NgLogE("Error updating game! "+f);(__ngs.r_(__ngs._s).Network).Util.showFatalErrorDialog()}else{var e=function(){imports._int_LGL.launch(a,imports._int_LGL.ProcID.Game)};startMobage(a,e)}},true)}else{NgLogD("In production mode and running bundled game, running game first, update later...");var b=function(){imports._int_LGL.launch(a,imports._int_LGL.ProcID.Game)};startMobage(a,b)}}}}function runGameDisaggregated(a){imports._LocalGameList.setSplashVisible(true);var m=function(){imports.MobageAnalytics.logStartupFlowEvent("MobageBootLaunchGame");if(imports.PrivSocial.Main&&imports.PrivSocial.Main.isLaunchIntoServiceUI){if(imports.PrivSocial.Main.isLaunchIntoServiceUI()){imports.PrivSocial.Main.finishShortcutLaunch(function(n){imports._LocalGameList.setSplashVisible(true);launchGame(n)},a)}else{launchGame(a)}}else{launchGame(a)}};var e=false;var l=Core.Capabilities.getGameDir()+"/.unbundled";var h=false;var c=false;var g=false;var j=0;var d=function(){if(!g&&c&&j&&!h){g=true;imports._LocalGameList.setProgressText("Getting new content…");imports.StartupNetworkListener.showPendingError()}};var k=function(n){imports._LocalGameList.listenToProgress(function(p,r,q,o){if(o){return}if(j==0&&q>(20<<20)){new imports.Toast({text:imports.LocText("Switching to Wi-Fi is recommended"),onDisappear:function(){this.destroy()}}).show()}j=q;d()});NgLogD("@@@ mobage main.js runGameDisaggregated updateGame +");imports.MobageAnalytics.logStartupFlowEvent("MobageBootStartUpdateGame");imports._LocalGameList.updateGame(a,-1,function(o,p){NgLogD("Mobage/runGame: updateGame done. "+(c?"login done":"login NOT done"));if(p){NgLogE("Mobage/runGame: Error updating game! "+p);(__ngs.r_(__ngs._s).Network).Util.showFatalErrorDialog()}else{imports.MobageAnalytics.logStartupFlowEvent("MobageBootUpdateGameComplete");h=true;NgLogT("@@@ mobage main.js runGameDisaggregated updateGame -");if(e){imports.Storage.FileSystem.deleteFile(l,{},function(q){if(q){NgLogE("ERROR deleting unbundled marker file: "+q)}})}if(c||n){m()}}})};var b=function(n){if(n&&n.hasOwnProperty("bootGameImmediately")&&(n.bootGameImmediately===true||n.bootGameImmediately=="true")){imports.Storage.FileSystem.stat(l,{},function(p,o){if(p&&p.code===-2){imports.MobageAnalytics.logStartupFlowEvent("MobageBootSkipGameUpdate");m()}else{e=true;k(true)}})}else{k(false)}NgLogT("@@@ mobage main.js runGameDisaggregated startMobage +");startMobage(a,function(){NgLogT("@@@ mobage main.js runGameDisaggregated startMobage -");NgLogD("Mobage/runGame: login done. "+(h?"update done":"update NOT done"));c=true;if(h){m()}else{d()}})};var f=Core.Capabilities.meetsBinaryVersion("1.7.5");if(f&&a&&a!=""){imports._LocalGameList.getGameConfig(a,false,b)}else{b(null)}imports.StartupNetworkListener.start()}function launchGame(a){imports._LocalGameList.setProgressText(imports.LocText("Launching…",Core.Capabilities.getProductName()));imports._int_LGL.launch(a,imports._int_LGL.ProcID.Game);imports._LocalGameList._setProgress(-1)}function runBoot(c,b,a){if(imports.Session._isLocalDevelopmentMode()){NgLogD("In local development mode, updating boot, url="+c);imports._LocalGameList.setProgressText("[Updating Mobage]");NgLogT("@@@ mobage main.js runBoot updating boot in dev mode +");imports._LocalGameList.updateGame(c,-1,function(d,e){NgLogT("@@@ mobage main.js runBoot updating boot in dev mode -");if(e){NgLogE("Error updating! "+c+": "+e);var f=new imports.AlertDialog();f.setTitle("Error Updating Boot");f.setText("Could not get update at "+c);f.setChoices(["Try Again","Ignore"]);f.show();f.onchoice=function(g){if(g.choice===0){runBoot(c,b,a)}else{setTimeout(runGame.bind(undefined,a),500)}f.hide()};f.show()}else{if(d){NgLogT("@@@ mobage main.js runBoot new content _int_LGL.launch self +");imports._int_LGL.launch(c,imports._int_LGL.ProcID.Persist);NgLogT("@@@ mobage main.js runBoot new content _int_LGL.launch self -")}else{NgLogT("@@@ mobage main.js runBoot runGame +");runGame(a);NgLogT("@@@ mobage main.js runBoot runGame -")}}},true,true)}else{NgLogD("In production mode, save boot update for later...");NgLogT("@@@ mobage main.js runBoot not dev mode runGame +");runGame(a);NgLogT("@@@ mobage main.js runBoot not dev mode runGame -")}}function startMobage(b,a){if(imports.GameServiceMain&&imports.GameServiceMain.gameServiceMain){imports._LocalGameList.setSplashVisible(true);imports.GameServiceMain.gameServiceMain(b,function(){imports.MobageAnalytics.logStartupFlowEvent("MobageBootLoginDone");imports._LocalGameList._setAllowDeterminateProgress(true);a.apply(this,Array.prototype.slice.call(arguments));setTimeout(function(){imports._LocalGameList.setSplashVisible(false)},200)})}else{a()}}function boot(f,d,c,b){imports._LocalGameList.setSplashVisible(true);imports._LocalGameList._setAllowDeterminateProgress(false);var e;if(b){e=c+b}else{e=""}NgLogD("Game: "+e);var a=f+d;NgLogD("Boot: "+a);if(f=="ngmoco:)/"){runGame(e)}else{runBoot(a,b,e)}imports._LocalGameList.setSplashVisible(false)}function isGameBundled(a){NgLogD("MobageBoot/isGameBundled: currently returning false for all games, regardless of bundling");return false}function NgMobageGameStart(){try{imports._LocalGameList.setSplashVisible(false);imports.StartupNetworkListener.stop();if(imports.GameServiceMain&&imports.GameServiceMain.onGameStart){imports.GameServiceMain.onGameStart()}}catch(a){NgLogException(a)}return NgEngineUpdate("")};